(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function e(e){for(var a,i,s=e[0],l=e[1],c=e[2],p=0,u=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(n[a]=l[a]);for(d&&d(e);u.length;)u.shift()();return o.push.apply(o,c||[]),t()}function t(){for(var n,e=0;e<o.length;e++){for(var t=o[e],a=!0,s=1;s<t.length;s++){var l=t[s];0!==r[l]&&(a=!1)}a&&(o.splice(e--,1),n=i(i.s=t[0]))}return n}var a={},r={1:0},o=[];function i(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.e=function(n){var e=[],t=r[n];if(0!==t)if(t)e.push(t[2]);else{var a=new Promise((function(e,a){t=r[n]=[e,a]}));e.push(t[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(n){return i.p+"assets/js/"+({}[n]||n)+"."+{2:"604e56ea",3:"bbf7c2c7",4:"e5c81a93",5:"e9b01ef0",6:"fe4b6fe2",7:"3a487f9a",8:"c944f066",9:"2ad96cd8",10:"aa4eb0a1",11:"422adc61",12:"10334e95",13:"012d1e50",14:"6f0a2a5b",15:"1c77c22d",16:"4fd3525c",17:"217e38b9",18:"659d3d37",19:"e80afa6e",20:"9139e280",21:"10b172f8",22:"34ea571d",23:"138b35dc",24:"21c40e06",25:"5ca101aa",26:"aa0459b9",27:"31c0ed2a",28:"ceae43cc",29:"609ae9eb",30:"5b8d6841",31:"391c4a7f",32:"443a9301",33:"df735b9d",34:"d191f3e0",35:"281471e2",36:"cf77c6fa",37:"53b63146",38:"4da53f4c",39:"852a90d7",40:"084d8c1d",41:"53829a8c",42:"ae751da7",43:"7751b9a8",44:"a4810927",45:"1312b3c9",46:"e6bc055c",47:"18bee4c5",48:"9f656bee",49:"da4c46c5",50:"cfc199d6",51:"127a05ac",52:"633f5b3b",53:"ddd52237",54:"2a49467c",55:"94a84abb",56:"65a6cf9b",57:"ac756580",58:"66ea8998",59:"a888705f",60:"78f4b8bd",61:"e0383d44",62:"825d9207",63:"03fa7d9a",64:"475fe16b",65:"dc316c26",66:"d8e2fe6a",67:"8ca17ad8",68:"28ac914f",69:"af110c89",70:"2203d85c",71:"b533ed03",72:"3d9b90b3",73:"72e1a805",74:"870299c6",75:"6749a9b9",76:"1d514dca",77:"af4dc008",78:"9e830fa7",79:"cc70fb45",80:"5a560ea2",81:"f005b264",82:"75c0cb1b",83:"02e320c4",84:"0908d51b",85:"7c368752",86:"274b50ae",87:"3682de75",88:"af0b698f",89:"11a63b60",90:"06f487da",91:"ec9044a0",92:"208a9d92",93:"43e7fa8d",94:"d5b898f0",95:"bad0da9f",96:"a95dff03",97:"d7a433e6",98:"66ebf4b1",99:"2904f4b0",100:"e0982e8f",101:"0fd8df8f",102:"254e5733",103:"0f450abe",104:"068362bb",105:"f93efa4b",106:"fc600d71",107:"d3248776",108:"7eca1198",109:"60e835c6",110:"76a0db62",111:"a36f567a",112:"d14be259",113:"daf919ff",114:"b31bf64d",115:"2ae6963e",116:"7a9dbf0a",117:"d99a1526",118:"15a2f063",119:"adfcc31f",120:"fe2ffab5",121:"3643e944",122:"cf337595",123:"ff5b2675",124:"6c3159a5",125:"b0c7f558",126:"2c46ced5",127:"04650369",128:"bf298103",129:"2252deae",130:"ae0e6a61"}[n]+".js"}(n);var l=new Error;o=function(e){s.onerror=s.onload=null,clearTimeout(c);var t=r[n];if(0!==t){if(t){var a=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;l.message="Loading chunk "+n+" failed.\n("+a+": "+o+")",l.name="ChunkLoadError",l.type=a,l.request=o,t[1](l)}r[n]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(e)},i.m=n,i.c=a,i.d=function(n,e,t){i.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},i.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,e){if(1&e&&(n=i(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)i.d(t,a,function(e){return n[e]}.bind(null,a));return t},i.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(e,"a",e),e},i.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},i.p="/",i.oe=function(n){throw console.error(n),n};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;o.push([102,0]),t()}([function(n,e,t){var a=t(55),r=a.all;n.exports=a.IS_HTMLDDA?function(n){return"function"==typeof n||n===r}:function(n){return"function"==typeof n}},function(n,e,t){var a=t(27),r=Function.prototype,o=r.call,i=a&&r.bind.bind(o,o);n.exports=a?i:function(n){return function(){return o.apply(n,arguments)}}},function(n,e){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,e){var t=function(n){return n&&n.Math==Math&&n};n.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(n,e,t){var a=t(2);n.exports=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(n,e){var t=Array.isArray;n.exports=t},function(n,e,t){var a=t(69),r="object"==typeof self&&self&&self.Object===Object&&self,o=a||r||Function("return this")();n.exports=o},function(n,e,t){"use strict";function a(n,e,t,a,r,o,i,s){var l,c="function"==typeof n?n.options:n;if(e&&(c.render=e,c.staticRenderFns=t,c._compiled=!0),a&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),i?(l=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(i)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(n,e){return l.call(e),d(n,e)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,l):[l]}return{exports:n,options:c}}t.d(e,"a",(function(){return a}))},function(n,e,t){var a=t(1),r=t(32),o=a({}.hasOwnProperty);n.exports=Object.hasOwn||function(n,e){return o(r(n),e)}},function(n,e,t){var a=t(0),r=t(55),o=r.all;n.exports=r.IS_HTMLDDA?function(n){return"object"==typeof n?null!==n:a(n)||n===o}:function(n){return"object"==typeof n?null!==n:a(n)}},function(n,e,t){var a=t(163),r=t(166);n.exports=function(n,e){var t=r(n,e);return a(t)?t:void 0}},function(n,e,t){"use strict";t.d(e,"e",(function(){return a})),t.d(e,"b",(function(){return o})),t.d(e,"j",(function(){return i})),t.d(e,"g",(function(){return l})),t.d(e,"h",(function(){return c})),t.d(e,"i",(function(){return d})),t.d(e,"c",(function(){return p})),t.d(e,"f",(function(){return u})),t.d(e,"l",(function(){return h})),t.d(e,"m",(function(){return m})),t.d(e,"d",(function(){return g})),t.d(e,"k",(function(){return v})),t.d(e,"n",(function(){return b})),t.d(e,"a",(function(){return k}));t(16);const a=/#.*$/,r=/\.(md|html)$/,o=/\/$/,i=/^[a-z]+:/i;function s(n){return decodeURI(n).replace(a,"").replace(r,"")}function l(n){return i.test(n)}function c(n){return/^mailto:/.test(n)}function d(n){return/^tel:/.test(n)}function p(n){if(l(n))return n;if(!n)return"404";const e=n.match(a),t=e?e[0]:"",r=s(n);return o.test(r)?n:r+".html"+t}function u(n,e){const t=n.hash,r=function(n){const e=n&&n.match(a);if(e)return e[0]}(e);if(r&&t!==r)return!1;return s(n.path)===s(e)}function h(n,e,t){if(l(e))return{type:"external",path:e};t&&(e=function(n,e,t){const a=n.charAt(0);if("/"===a)return n;if("?"===a||"#"===a)return e+n;const r=e.split("/");t&&r[r.length-1]||r.pop();const o=n.replace(/^\//,"").split("/");for(let n=0;n<o.length;n++){const e=o[n];".."===e?r.pop():"."!==e&&r.push(e)}""!==r[0]&&r.unshift("");return r.join("/")}(e,t));const a=s(e);for(let e=0;e<n.length;e++)if(s(n[e].regularPath)===a)return Object.assign({},n[e],{type:"page",path:p(n[e].path)});return console.error(`[vuepress] No matching page found for sidebar item "${e}"`),{}}function m(n,e,t,a){const{pages:r,themeConfig:o}=t,i=a&&o.locales&&o.locales[a]||o;if("auto"===(n.frontmatter.sidebar||i.sidebar||o.sidebar))return f(n);const s=i.sidebar||o.sidebar;if(s){const{base:t,config:a}=function(n,e){if(Array.isArray(e))return{base:"/",config:e};for(const a in e)if(0===(t=n,/(\.html|\/)$/.test(t)?t:t+"/").indexOf(encodeURI(a)))return{base:a,config:e[a]};var t;return{}}(e,s);return"auto"===a?f(n):a?a.map(n=>function n(e,t,a,r=1){if("string"==typeof e)return h(t,e,a);if(Array.isArray(e))return Object.assign(h(t,e[0],a),{title:e[1]});{r>3&&console.error("[vuepress] detected a too deep nested sidebar group.");const o=e.children||[];return 0===o.length&&e.path?Object.assign(h(t,e.path,a),{title:e.title}):{type:"group",path:e.path,title:e.title,sidebarDepth:e.sidebarDepth,initialOpenGroupIndex:e.initialOpenGroupIndex,children:o.map(e=>n(e,t,a,r+1)),collapsable:!1!==e.collapsable}}}(n,r,t)):[]}return[]}function f(n){const e=g(n.headers||[]);return[{type:"group",collapsable:!1,title:n.title,path:null,children:e.map(e=>({type:"auto",title:e.title,basePath:n.path,path:n.path+"#"+e.slug,children:e.children||[]}))}]}function g(n){let e;return(n=n.map(n=>Object.assign({},n))).forEach(n=>{2===n.level?e=n:e&&(e.children||(e.children=[])).push(n)}),n.filter(n=>2===n.level)}function v(n){return Object.assign(n,{type:n.items&&n.items.length?"links":"link"})}function b(n){return Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase()}function y(n){let e=n.frontmatter.date||n.lastUpdated||new Date,t=new Date(e);return"Invalid Date"==t&&e&&(t=new Date(e.replace(/-/g,"/"))),t.getTime()}function k(n,e){return y(e)-y(n)}},function(n,e){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,e,t){var a=t(15),r=t(148),o=t(149),i=a?a.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":i&&i in Object(n)?r(n):o(n)}},function(n,e,t){var a=t(4),r=t(17),o=t(35);n.exports=a?function(n,e,t){return r.f(n,e,o(1,t))}:function(n,e,t){return n[e]=t,n}},function(n,e,t){var a=t(6).Symbol;n.exports=a},function(n,e,t){"use strict";var a=t(26),r=t(32),o=t(33),i=t(127),s=t(129);a({target:"Array",proto:!0,arity:1,forced:t(2)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}}()},{push:function(n){var e=r(this),t=o(e),a=arguments.length;s(t+a);for(var l=0;l<a;l++)e[t]=arguments[l],t++;return i(e,t),t}})},function(n,e,t){var a=t(4),r=t(64),o=t(98),i=t(25),s=t(54),l=TypeError,c=Object.defineProperty,d=Object.getOwnPropertyDescriptor;e.f=a?o?function(n,e,t){if(i(n),e=s(e),i(t),"function"==typeof n&&"prototype"===e&&"value"in t&&"writable"in t&&!t.writable){var a=d(n,e);a&&a.writable&&(n[e]=t.value,t={configurable:"configurable"in t?t.configurable:a.configurable,enumerable:"enumerable"in t?t.enumerable:a.enumerable,writable:!1})}return c(n,e,t)}:c:function(n,e,t){if(i(n),e=s(e),i(t),r)try{return c(n,e,t)}catch(n){}if("get"in t||"set"in t)throw l("Accessors not supported");return"value"in t&&(n[e]=t.value),n}},function(n,e,t){var a=t(1),r=a({}.toString),o=a("".slice);n.exports=function(n){return o(r(n),8,-1)}},function(n,e,t){var a=t(153),r=t(154),o=t(155),i=t(156),s=t(157);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e,t){var a=t(71);n.exports=function(n,e){for(var t=n.length;t--;)if(a(n[t][0],e))return t;return-1}},function(n,e,t){var a=t(10)(Object,"create");n.exports=a},function(n,e,t){var a=t(175);n.exports=function(n,e){var t=n.__data__;return a(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(n,e,t){var a=t(45);n.exports=function(n){if("string"==typeof n||a(n))return n;var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(n,e,t){var a,r;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(r="function"==typeof(a=function(){var n,e,t={version:"0.2.0"},a=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function r(n,e,t){return n<e?e:n>t?t:n}function o(n){return 100*(-1+n)}t.configure=function(n){var e,t;for(e in n)void 0!==(t=n[e])&&n.hasOwnProperty(e)&&(a[e]=t);return this},t.status=null,t.set=function(n){var e=t.isStarted();n=r(n,a.minimum,1),t.status=1===n?null:n;var l=t.render(!e),c=l.querySelector(a.barSelector),d=a.speed,p=a.easing;return l.offsetWidth,i((function(e){""===a.positionUsing&&(a.positionUsing=t.getPositioningCSS()),s(c,function(n,e,t){var r;return(r="translate3d"===a.positionUsing?{transform:"translate3d("+o(n)+"%,0,0)"}:"translate"===a.positionUsing?{transform:"translate("+o(n)+"%,0)"}:{"margin-left":o(n)+"%"}).transition="all "+e+"ms "+t,r}(n,d,p)),1===n?(s(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout((function(){s(l,{transition:"all "+d+"ms linear",opacity:0}),setTimeout((function(){t.remove(),e()}),d)}),d)):setTimeout(e,d)})),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout((function(){t.status&&(t.trickle(),n())}),a.trickleSpeed)};return a.trickle&&n(),this},t.done=function(n){return n||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(n){var e=t.status;return e?("number"!=typeof n&&(n=(1-e)*r(Math.random()*e,.1,.95)),e=r(e+n,0,.994),t.set(e)):t.start()},t.trickle=function(){return t.inc(Math.random()*a.trickleRate)},n=0,e=0,t.promise=function(a){return a&&"resolved"!==a.state()?(0===e&&t.start(),n++,e++,a.always((function(){0==--e?(n=0,t.done()):t.set((n-e)/n)})),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");c(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=a.template;var r,i=e.querySelector(a.barSelector),l=n?"-100":o(t.status||0),d=document.querySelector(a.parent);return s(i,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),a.showSpinner||(r=e.querySelector(a.spinnerSelector))&&u(r),d!=document.body&&c(d,"nprogress-custom-parent"),d.appendChild(e),e},t.remove=function(){d(document.documentElement,"nprogress-busy"),d(document.querySelector(a.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&u(n)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var n=document.body.style,e="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return e+"Perspective"in n?"translate3d":e+"Transform"in n?"translate":"margin"};var i=function(){var n=[];function e(){var t=n.shift();t&&t(e)}return function(t){n.push(t),1==n.length&&e()}}(),s=function(){var n=["Webkit","O","Moz","ms"],e={};function t(t){return t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,e){return e.toUpperCase()})),e[t]||(e[t]=function(e){var t=document.body.style;if(e in t)return e;for(var a,r=n.length,o=e.charAt(0).toUpperCase()+e.slice(1);r--;)if((a=n[r]+o)in t)return a;return e}(t))}function a(n,e,a){e=t(e),n.style[e]=a}return function(n,e){var t,r,o=arguments;if(2==o.length)for(t in e)void 0!==(r=e[t])&&e.hasOwnProperty(t)&&a(n,t,r);else a(n,o[1],o[2])}}();function l(n,e){return("string"==typeof n?n:p(n)).indexOf(" "+e+" ")>=0}function c(n,e){var t=p(n),a=t+e;l(t,e)||(n.className=a.substring(1))}function d(n,e){var t,a=p(n);l(n,e)&&(t=a.replace(" "+e+" "," "),n.className=t.substring(1,t.length-1))}function p(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function u(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return t})?a.call(e,t,e,n):a)||(n.exports=r)},function(n,e,t){var a=t(9),r=String,o=TypeError;n.exports=function(n){if(a(n))return n;throw o(r(n)+" is not an object")}},function(n,e,t){var a=t(3),r=t(51).f,o=t(14),i=t(110),s=t(37),l=t(65),c=t(123);n.exports=function(n,e){var t,d,p,u,h,m=n.target,f=n.global,g=n.stat;if(t=f?a:g?a[m]||s(m,{}):(a[m]||{}).prototype)for(d in e){if(u=e[d],p=n.dontCallGetSet?(h=r(t,d))&&h.value:t[d],!c(f?d:m+(g?".":"#")+d,n.forced)&&void 0!==p){if(typeof u==typeof p)continue;l(u,p)}(n.sham||p&&p.sham)&&o(u,"sham",!0),i(t,d,u,n)}}},function(n,e,t){var a=t(2);n.exports=!a((function(){var n=function(){}.bind();return"function"!=typeof n||n.hasOwnProperty("prototype")}))},function(n,e,t){var a=t(47),r=t(52);n.exports=function(n){return a(r(n))}},function(n,e,t){var a=t(3),r=t(0),o=function(n){return r(n)?n:void 0};n.exports=function(n,e){return arguments.length<2?o(a[n]):a[n]&&a[n][e]}},function(n,e,t){var a=t(0),r=t(108),o=TypeError;n.exports=function(n){if(a(n))return n;throw o(r(n)+" is not a function")}},function(n,e,t){var a=t(3),r=t(61),o=t(8),i=t(63),s=t(59),l=t(58),c=a.Symbol,d=r("wks"),p=l?c.for||c:c&&c.withoutSetter||i;n.exports=function(n){return o(d,n)||(d[n]=s&&o(c,n)?c[n]:p("Symbol."+n)),d[n]}},function(n,e,t){var a=t(52),r=Object;n.exports=function(n){return r(a(n))}},function(n,e,t){var a=t(121);n.exports=function(n){return a(n.length)}},function(n,e,t){var a=t(27),r=Function.prototype.call;n.exports=a?r.bind(r):function(){return r.apply(r,arguments)}},function(n,e){n.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(n,e,t){var a=t(3),r=t(37),o=a["__core-js_shared__"]||r("__core-js_shared__",{});n.exports=o},function(n,e,t){var a=t(3),r=Object.defineProperty;n.exports=function(n,e){try{r(a,n,{value:e,configurable:!0,writable:!0})}catch(t){a[n]=e}return e}},function(n,e,t){var a=t(147),r=t(12),o=Object.prototype,i=o.hasOwnProperty,s=o.propertyIsEnumerable,l=a(function(){return arguments}())?a:function(n){return r(n)&&i.call(n,"callee")&&!s.call(n,"callee")};n.exports=l},function(n,e,t){var a=t(10)(t(6),"Map");n.exports=a},function(n,e){n.exports=function(n){var e=typeof n;return null!=n&&("object"==e||"function"==e)}},function(n,e,t){var a=t(167),r=t(174),o=t(176),i=t(177),s=t(178);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n){t[++e]=n})),t}},function(n,e){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,e,t){var a=t(5),r=t(45),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;n.exports=function(n,e){if(a(n))return!1;var t=typeof n;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=n&&!r(n))||(i.test(n)||!o.test(n)||null!=e&&n in Object(e))}},function(n,e,t){var a=t(13),r=t(12);n.exports=function(n){return"symbol"==typeof n||r(n)&&"[object Symbol]"==a(n)}},function(n,e){n.exports=function(n){return n}},function(n,e,t){var a=t(1),r=t(2),o=t(18),i=Object,s=a("".split);n.exports=r((function(){return!i("z").propertyIsEnumerable(0)}))?function(n){return"String"==o(n)?s(n,""):i(n)}:i},function(n,e){n.exports={}},function(n,e){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,e){var t=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),d=Object.prototype.toString,p=Math.max,u=Math.min,h=function(){return c.Date.now()};function m(n){var e=typeof n;return!!n&&("object"==e||"function"==e)}function f(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==d.call(n)}(n))return NaN;if(m(n)){var e="function"==typeof n.valueOf?n.valueOf():n;n=m(e)?e+"":e}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(t,"");var s=r.test(n);return s||o.test(n)?i(n.slice(2),s?2:8):a.test(n)?NaN:+n}n.exports=function(n,e,t){var a,r,o,i,s,l,c=0,d=!1,g=!1,v=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function b(e){var t=a,o=r;return a=r=void 0,c=e,i=n.apply(o,t)}function y(n){return c=n,s=setTimeout(x,e),d?b(n):i}function k(n){var t=n-l;return void 0===l||t>=e||t<0||g&&n-c>=o}function x(){var n=h();if(k(n))return w(n);s=setTimeout(x,function(n){var t=e-(n-l);return g?u(t,o-(n-c)):t}(n))}function w(n){return s=void 0,v&&a?b(n):(a=r=void 0,i)}function S(){var n=h(),t=k(n);if(a=arguments,r=this,l=n,t){if(void 0===s)return y(l);if(g)return s=setTimeout(x,e),b(l)}return void 0===s&&(s=setTimeout(x,e)),i}return e=f(e)||0,m(t)&&(d=!!t.leading,o=(g="maxWait"in t)?p(f(t.maxWait)||0,e):o,v="trailing"in t?!!t.trailing:v),S.cancel=function(){void 0!==s&&clearTimeout(s),c=0,a=l=r=s=void 0},S.flush=function(){return void 0===s?i:w(h())},S}},function(n,e,t){var a=t(4),r=t(34),o=t(104),i=t(35),s=t(28),l=t(54),c=t(8),d=t(64),p=Object.getOwnPropertyDescriptor;e.f=a?p:function(n,e){if(n=s(n),e=l(e),d)try{return p(n,e)}catch(n){}if(c(n,e))return i(!r(o.f,n,e),n[e])}},function(n,e,t){var a=t(53),r=TypeError;n.exports=function(n){if(a(n))throw r("Can't call method on "+n);return n}},function(n,e){n.exports=function(n){return null==n}},function(n,e,t){var a=t(105),r=t(56);n.exports=function(n){var e=a(n,"string");return r(e)?e:e+""}},function(n,e){var t="object"==typeof document&&document.all,a=void 0===t&&void 0!==t;n.exports={all:t,IS_HTMLDDA:a}},function(n,e,t){var a=t(29),r=t(0),o=t(57),i=t(58),s=Object;n.exports=i?function(n){return"symbol"==typeof n}:function(n){var e=a("Symbol");return r(e)&&o(e.prototype,s(n))}},function(n,e,t){var a=t(1);n.exports=a({}.isPrototypeOf)},function(n,e,t){var a=t(59);n.exports=a&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(n,e,t){var a=t(60),r=t(2);n.exports=!!Object.getOwnPropertySymbols&&!r((function(){var n=Symbol();return!String(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&a&&a<41}))},function(n,e,t){var a,r,o=t(3),i=t(106),s=o.process,l=o.Deno,c=s&&s.versions||l&&l.version,d=c&&c.v8;d&&(r=(a=d.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!r&&i&&(!(a=i.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=i.match(/Chrome\/(\d+)/))&&(r=+a[1]),n.exports=r},function(n,e,t){var a=t(62),r=t(36);(n.exports=function(n,e){return r[n]||(r[n]=void 0!==e?e:{})})("versions",[]).push({version:"3.29.1",mode:a?"pure":"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(n,e){n.exports=!1},function(n,e,t){var a=t(1),r=0,o=Math.random(),i=a(1..toString);n.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+i(++r+o,36)}},function(n,e,t){var a=t(4),r=t(2),o=t(97);n.exports=!a&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(n,e,t){var a=t(8),r=t(116),o=t(51),i=t(17);n.exports=function(n,e,t){for(var s=r(e),l=i.f,c=o.f,d=0;d<s.length;d++){var p=s[d];a(n,p)||t&&a(t,p)||l(n,p,c(e,p))}}},function(n,e,t){var a=t(120);n.exports=function(n){var e=+n;return e!=e||0===e?0:a(e)}},function(n,e,t){var a=t(133),r=t(25),o=t(134);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,e=!1,t={};try{(n=a(Object.prototype,"__proto__","set"))(t,[]),e=t instanceof Array}catch(n){}return function(t,a){return r(t),o(a),e?n(t,a):t.__proto__=a,t}}():void 0)},function(n,e){n.exports=function(n,e){for(var t=-1,a=e.length,r=n.length;++t<a;)n[r+t]=e[t];return n}},function(n,e){var t="object"==typeof global&&global&&global.Object===Object&&global;n.exports=t},function(n,e,t){var a=t(19),r=t(158),o=t(159),i=t(160),s=t(161),l=t(162);function c(n){var e=this.__data__=new a(n);this.size=e.size}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=l,n.exports=c},function(n,e){n.exports=function(n,e){return n===e||n!=n&&e!=e}},function(n,e,t){var a=t(13),r=t(40);n.exports=function(n){if(!r(n))return!1;var e=a(n);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,e){var t=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return t.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,e,t){var a=t(179),r=t(12);n.exports=function n(e,t,o,i,s){return e===t||(null==e||null==t||!r(e)&&!r(t)?e!=e&&t!=t:a(e,t,o,i,n,s))}},function(n,e,t){var a=t(76),r=t(182),o=t(77);n.exports=function(n,e,t,i,s,l){var c=1&t,d=n.length,p=e.length;if(d!=p&&!(c&&p>d))return!1;var u=l.get(n),h=l.get(e);if(u&&h)return u==e&&h==n;var m=-1,f=!0,g=2&t?new a:void 0;for(l.set(n,e),l.set(e,n);++m<d;){var v=n[m],b=e[m];if(i)var y=c?i(b,v,m,e,n,l):i(v,b,m,n,e,l);if(void 0!==y){if(y)continue;f=!1;break}if(g){if(!r(e,(function(n,e){if(!o(g,e)&&(v===n||s(v,n,t,i,l)))return g.push(e)}))){f=!1;break}}else if(v!==b&&!s(v,b,t,i,l)){f=!1;break}}return l.delete(n),l.delete(e),f}},function(n,e,t){var a=t(41),r=t(180),o=t(181);function i(n){var e=-1,t=null==n?0:n.length;for(this.__data__=new a;++e<t;)this.add(n[e])}i.prototype.add=i.prototype.push=r,i.prototype.has=o,n.exports=i},function(n,e){n.exports=function(n,e){return n.has(e)}},function(n,e,t){var a=t(192),r=t(198),o=t(82);n.exports=function(n){return o(n)?a(n):r(n)}},function(n,e,t){(function(n){var a=t(6),r=t(194),o=e&&!e.nodeType&&e,i=o&&"object"==typeof n&&n&&!n.nodeType&&n,s=i&&i.exports===o?a.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;n.exports=l}).call(this,t(49)(n))},function(n,e){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(n,e){var a=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==a||"symbol"!=a&&t.test(n))&&n>-1&&n%1==0&&n<e}},function(n,e,t){var a=t(195),r=t(196),o=t(197),i=o&&o.isTypedArray,s=i?r(i):a;n.exports=s},function(n,e,t){var a=t(72),r=t(43);n.exports=function(n){return null!=n&&r(n.length)&&!a(n)}},function(n,e,t){var a=t(10)(t(6),"Set");n.exports=a},function(n,e,t){var a=t(40);n.exports=function(n){return n==n&&!a(n)}},function(n,e){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},function(n,e,t){var a=t(87),r=t(23);n.exports=function(n,e){for(var t=0,o=(e=a(e,n)).length;null!=n&&t<o;)n=n[r(e[t++])];return t&&t==o?n:void 0}},function(n,e,t){var a=t(5),r=t(44),o=t(209),i=t(212);n.exports=function(n,e){return a(n)?n:r(n,e)?[n]:o(i(n))}},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){var a=t(145),r=t(150),o=t(221),i=t(229),s=t(238),l=t(101),c=o((function(n){var e=l(n);return s(e)&&(e=void 0),i(a(n,1,s,!0),r(e,2))}));n.exports=c},function(n,e,t){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var a=/["'&<>]/;n.exports=function(n){var e,t=""+n,r=a.exec(t);if(!r)return t;var o="",i=0,s=0;for(i=r.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==i&&(o+=t.substring(s,i)),s=i+1,o+=e}return s!==i?o+t.substring(s,i):o}},function(n,e,t){"use strict";t.r(e);var a={name:"CodeBlock",props:{title:{type:String,required:!0},active:{type:Boolean,default:!1}}},r=(t(241),t(7)),o=Object(r.a)(a,(function(){return(0,this._self._c)("div",{staticClass:"theme-code-block",class:{"theme-code-block__active":this.active}},[this._t("default")],2)}),[],!1,null,"4f1e9d0c",null);e.default=o.exports},function(n,e,t){"use strict";t.r(e);var a={name:"CodeGroup",data:()=>({codeTabs:[],activeCodeTabIndex:-1}),watch:{activeCodeTabIndex(n){this.codeTabs.forEach(n=>{n.elm.classList.remove("theme-code-block__active")}),this.codeTabs[n].elm.classList.add("theme-code-block__active")}},mounted(){this.codeTabs=(this.$slots.default||[]).filter(n=>Boolean(n.componentOptions)).map((n,e)=>(""===n.componentOptions.propsData.active&&(this.activeCodeTabIndex=e),{title:n.componentOptions.propsData.title,elm:n.elm})),-1===this.activeCodeTabIndex&&this.codeTabs.length>0&&(this.activeCodeTabIndex=0)},methods:{changeCodeTab(n){this.activeCodeTabIndex=n}}},r=(t(242),t(7)),o=Object(r.a)(a,(function(){var n=this,e=n._self._c;return e("div",{staticClass:"theme-code-group"},[e("div",{staticClass:"theme-code-group__nav"},[e("ul",{staticClass:"theme-code-group__ul"},n._l(n.codeTabs,(function(t,a){return e("li",{key:t.title,staticClass:"theme-code-group__li"},[e("button",{staticClass:"theme-code-group__nav-tab",class:{"theme-code-group__nav-tab-active":a===n.activeCodeTabIndex},on:{click:function(e){return n.changeCodeTab(a)}}},[n._v("\n            "+n._s(t.title)+"\n          ")])])})),0)]),n._v(" "),n._t("default"),n._v(" "),n.codeTabs.length<1?e("pre",{staticClass:"pre-blank"},[n._v("// Make sure to add code blocks to your code group")]):n._e()],2)}),[],!1,null,"2f5f1757",null);e.default=o.exports},function(n,e){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,e,t){var a=t(3),r=t(9),o=a.document,i=r(o)&&r(o.createElement);n.exports=function(n){return i?o.createElement(n):{}}},function(n,e,t){var a=t(4),r=t(2);n.exports=a&&r((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(n,e,t){var a=t(61),r=t(63),o=a("keys");n.exports=function(n){return o[n]||(o[n]=r(n))}},function(n,e,t){var a=t(1),r=t(8),o=t(28),i=t(118).indexOf,s=t(48),l=a([].push);n.exports=function(n,e){var t,a=o(n),c=0,d=[];for(t in a)!r(s,t)&&r(a,t)&&l(d,t);for(;e.length>c;)r(a,t=e[c++])&&(~i(d,t)||l(d,t));return d}},function(n,e){n.exports=function(n){var e=null==n?0:n.length;return e?n[e-1]:void 0}},function(n,e,t){n.exports=t(247)},function(n,e,t){"use strict";var a=t(26),r=t(124).left,o=t(125),i=t(60);a({target:"Array",proto:!0,forced:!t(126)&&i>79&&i<83||!o("reduce")},{reduce:function(n){var e=arguments.length;return r(this,n,e,e>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var a={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!a.call({1:2},1);e.f=o?function(n){var e=r(this,n);return!!e&&e.enumerable}:a},function(n,e,t){var a=t(34),r=t(9),o=t(56),i=t(107),s=t(109),l=t(31),c=TypeError,d=l("toPrimitive");n.exports=function(n,e){if(!r(n)||o(n))return n;var t,l=i(n,d);if(l){if(void 0===e&&(e="default"),t=a(l,n,e),!r(t)||o(t))return t;throw c("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(n,e)}},function(n,e){n.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},function(n,e,t){var a=t(30),r=t(53);n.exports=function(n,e){var t=n[e];return r(t)?void 0:a(t)}},function(n,e){var t=String;n.exports=function(n){try{return t(n)}catch(n){return"Object"}}},function(n,e,t){var a=t(34),r=t(0),o=t(9),i=TypeError;n.exports=function(n,e){var t,s;if("string"===e&&r(t=n.toString)&&!o(s=a(t,n)))return s;if(r(t=n.valueOf)&&!o(s=a(t,n)))return s;if("string"!==e&&r(t=n.toString)&&!o(s=a(t,n)))return s;throw i("Can't convert object to primitive value")}},function(n,e,t){var a=t(0),r=t(17),o=t(111),i=t(37);n.exports=function(n,e,t,s){s||(s={});var l=s.enumerable,c=void 0!==s.name?s.name:e;if(a(t)&&o(t,c,s),s.global)l?n[e]=t:i(e,t);else{try{s.unsafe?n[e]&&(l=!0):delete n[e]}catch(n){}l?n[e]=t:r.f(n,e,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return n}},function(n,e,t){var a=t(1),r=t(2),o=t(0),i=t(8),s=t(4),l=t(112).CONFIGURABLE,c=t(113),d=t(114),p=d.enforce,u=d.get,h=String,m=Object.defineProperty,f=a("".slice),g=a("".replace),v=a([].join),b=s&&!r((function(){return 8!==m((function(){}),"length",{value:8}).length})),y=String(String).split("String"),k=n.exports=function(n,e,t){"Symbol("===f(h(e),0,7)&&(e="["+g(h(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!i(n,"name")||l&&n.name!==e)&&(s?m(n,"name",{value:e,configurable:!0}):n.name=e),b&&t&&i(t,"arity")&&n.length!==t.arity&&m(n,"length",{value:t.arity});try{t&&i(t,"constructor")&&t.constructor?s&&m(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch(n){}var a=p(n);return i(a,"source")||(a.source=v(y,"string"==typeof e?e:"")),n};Function.prototype.toString=k((function(){return o(this)&&u(this).source||c(this)}),"toString")},function(n,e,t){var a=t(4),r=t(8),o=Function.prototype,i=a&&Object.getOwnPropertyDescriptor,s=r(o,"name"),l=s&&"something"===function(){}.name,c=s&&(!a||a&&i(o,"name").configurable);n.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},function(n,e,t){var a=t(1),r=t(0),o=t(36),i=a(Function.toString);r(o.inspectSource)||(o.inspectSource=function(n){return i(n)}),n.exports=o.inspectSource},function(n,e,t){var a,r,o,i=t(115),s=t(3),l=t(9),c=t(14),d=t(8),p=t(36),u=t(99),h=t(48),m=s.TypeError,f=s.WeakMap;if(i||p.state){var g=p.state||(p.state=new f);g.get=g.get,g.has=g.has,g.set=g.set,a=function(n,e){if(g.has(n))throw m("Object already initialized");return e.facade=n,g.set(n,e),e},r=function(n){return g.get(n)||{}},o=function(n){return g.has(n)}}else{var v=u("state");h[v]=!0,a=function(n,e){if(d(n,v))throw m("Object already initialized");return e.facade=n,c(n,v,e),e},r=function(n){return d(n,v)?n[v]:{}},o=function(n){return d(n,v)}}n.exports={set:a,get:r,has:o,enforce:function(n){return o(n)?r(n):a(n,{})},getterFor:function(n){return function(e){var t;if(!l(e)||(t=r(e)).type!==n)throw m("Incompatible receiver, "+n+" required");return t}}}},function(n,e,t){var a=t(3),r=t(0),o=a.WeakMap;n.exports=r(o)&&/native code/.test(String(o))},function(n,e,t){var a=t(29),r=t(1),o=t(117),i=t(122),s=t(25),l=r([].concat);n.exports=a("Reflect","ownKeys")||function(n){var e=o.f(s(n)),t=i.f;return t?l(e,t(n)):e}},function(n,e,t){var a=t(100),r=t(96).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return a(n,r)}},function(n,e,t){var a=t(28),r=t(119),o=t(33),i=function(n){return function(e,t,i){var s,l=a(e),c=o(l),d=r(i,c);if(n&&t!=t){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((n||d in l)&&l[d]===t)return n||d||0;return!n&&-1}};n.exports={includes:i(!0),indexOf:i(!1)}},function(n,e,t){var a=t(66),r=Math.max,o=Math.min;n.exports=function(n,e){var t=a(n);return t<0?r(t+e,0):o(t,e)}},function(n,e){var t=Math.ceil,a=Math.floor;n.exports=Math.trunc||function(n){var e=+n;return(e>0?a:t)(e)}},function(n,e,t){var a=t(66),r=Math.min;n.exports=function(n){return n>0?r(a(n),9007199254740991):0}},function(n,e){e.f=Object.getOwnPropertySymbols},function(n,e,t){var a=t(2),r=t(0),o=/#|\.prototype\./,i=function(n,e){var t=l[s(n)];return t==d||t!=c&&(r(e)?a(e):!!e)},s=i.normalize=function(n){return String(n).replace(o,".").toLowerCase()},l=i.data={},c=i.NATIVE="N",d=i.POLYFILL="P";n.exports=i},function(n,e,t){var a=t(30),r=t(32),o=t(47),i=t(33),s=TypeError,l=function(n){return function(e,t,l,c){a(t);var d=r(e),p=o(d),u=i(d),h=n?u-1:0,m=n?-1:1;if(l<2)for(;;){if(h in p){c=p[h],h+=m;break}if(h+=m,n?h<0:u<=h)throw s("Reduce of empty array with no initial value")}for(;n?h>=0:u>h;h+=m)h in p&&(c=t(c,p[h],h,d));return c}};n.exports={left:l(!1),right:l(!0)}},function(n,e,t){"use strict";var a=t(2);n.exports=function(n,e){var t=[][n];return!!t&&a((function(){t.call(null,e||function(){return 1},1)}))}},function(n,e,t){var a=t(18);n.exports="undefined"!=typeof process&&"process"==a(process)},function(n,e,t){"use strict";var a=t(4),r=t(128),o=TypeError,i=Object.getOwnPropertyDescriptor,s=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}();n.exports=s?function(n,e){if(r(n)&&!i(n,"length").writable)throw o("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e}},function(n,e,t){var a=t(18);n.exports=Array.isArray||function(n){return"Array"==a(n)}},function(n,e){var t=TypeError;n.exports=function(n){if(n>9007199254740991)throw t("Maximum allowed index exceeded");return n}},function(n,e,t){var a=t(26),r=t(3),o=t(131),i=t(132),s=r.WebAssembly,l=7!==Error("e",{cause:7}).cause,c=function(n,e){var t={};t[n]=i(n,e,l),a({global:!0,constructor:!0,arity:1,forced:l},t)},d=function(n,e){if(s&&s[n]){var t={};t[n]=i("WebAssembly."+n,e,l),a({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:l},t)}};c("Error",(function(n){return function(e){return o(n,this,arguments)}})),c("EvalError",(function(n){return function(e){return o(n,this,arguments)}})),c("RangeError",(function(n){return function(e){return o(n,this,arguments)}})),c("ReferenceError",(function(n){return function(e){return o(n,this,arguments)}})),c("SyntaxError",(function(n){return function(e){return o(n,this,arguments)}})),c("TypeError",(function(n){return function(e){return o(n,this,arguments)}})),c("URIError",(function(n){return function(e){return o(n,this,arguments)}})),d("CompileError",(function(n){return function(e){return o(n,this,arguments)}})),d("LinkError",(function(n){return function(e){return o(n,this,arguments)}})),d("RuntimeError",(function(n){return function(e){return o(n,this,arguments)}}))},function(n,e,t){var a=t(27),r=Function.prototype,o=r.apply,i=r.call;n.exports="object"==typeof Reflect&&Reflect.apply||(a?i.bind(o):function(){return i.apply(o,arguments)})},function(n,e,t){"use strict";var a=t(29),r=t(8),o=t(14),i=t(57),s=t(67),l=t(65),c=t(135),d=t(136),p=t(137),u=t(141),h=t(142),m=t(4),f=t(62);n.exports=function(n,e,t,g){var v=g?2:1,b=n.split("."),y=b[b.length-1],k=a.apply(null,b);if(k){var x=k.prototype;if(!f&&r(x,"cause")&&delete x.cause,!t)return k;var w=a("Error"),S=e((function(n,e){var t=p(g?e:n,void 0),a=g?new k(n):new k;return void 0!==t&&o(a,"message",t),h(a,S,a.stack,2),this&&i(x,this)&&d(a,this,S),arguments.length>v&&u(a,arguments[v]),a}));if(S.prototype=x,"Error"!==y?s?s(S,w):l(S,w,{name:!0}):m&&"stackTraceLimit"in k&&(c(S,k,"stackTraceLimit"),c(S,k,"prepareStackTrace")),l(S,k),!f)try{x.name!==y&&o(x,"name",y),x.constructor=S}catch(n){}return S}}},function(n,e,t){var a=t(1),r=t(30);n.exports=function(n,e,t){try{return a(r(Object.getOwnPropertyDescriptor(n,e)[t]))}catch(n){}}},function(n,e,t){var a=t(0),r=String,o=TypeError;n.exports=function(n){if("object"==typeof n||a(n))return n;throw o("Can't set "+r(n)+" as a prototype")}},function(n,e,t){var a=t(17).f;n.exports=function(n,e,t){t in n||a(n,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})}},function(n,e,t){var a=t(0),r=t(9),o=t(67);n.exports=function(n,e,t){var i,s;return o&&a(i=e.constructor)&&i!==t&&r(s=i.prototype)&&s!==t.prototype&&o(n,s),n}},function(n,e,t){var a=t(138);n.exports=function(n,e){return void 0===n?arguments.length<2?"":e:a(n)}},function(n,e,t){var a=t(139),r=String;n.exports=function(n){if("Symbol"===a(n))throw TypeError("Cannot convert a Symbol value to a string");return r(n)}},function(n,e,t){var a=t(140),r=t(0),o=t(18),i=t(31)("toStringTag"),s=Object,l="Arguments"==o(function(){return arguments}());n.exports=a?o:function(n){var e,t,a;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(t=function(n,e){try{return n[e]}catch(n){}}(e=s(n),i))?t:l?o(e):"Object"==(a=o(e))&&r(e.callee)?"Arguments":a}},function(n,e,t){var a={};a[t(31)("toStringTag")]="z",n.exports="[object z]"===String(a)},function(n,e,t){var a=t(9),r=t(14);n.exports=function(n,e){a(e)&&"cause"in e&&r(n,"cause",e.cause)}},function(n,e,t){var a=t(14),r=t(143),o=t(144),i=Error.captureStackTrace;n.exports=function(n,e,t,s){o&&(i?i(n,e):a(n,"stack",r(t,s)))}},function(n,e,t){var a=t(1),r=Error,o=a("".replace),i=String(r("zxcasd").stack),s=/\n\s*at [^:]*:[^\n]*/,l=s.test(i);n.exports=function(n,e){if(l&&"string"==typeof n&&!r.prepareStackTrace)for(;e--;)n=o(n,s,"");return n}},function(n,e,t){var a=t(2),r=t(35);n.exports=!a((function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",r(1,7)),7!==n.stack)}))},function(n,e,t){var a=t(68),r=t(146);n.exports=function n(e,t,o,i,s){var l=-1,c=e.length;for(o||(o=r),s||(s=[]);++l<c;){var d=e[l];t>0&&o(d)?t>1?n(d,t-1,o,i,s):a(s,d):i||(s[s.length]=d)}return s}},function(n,e,t){var a=t(15),r=t(38),o=t(5),i=a?a.isConcatSpreadable:void 0;n.exports=function(n){return o(n)||r(n)||!!(i&&n&&n[i])}},function(n,e,t){var a=t(13),r=t(12);n.exports=function(n){return r(n)&&"[object Arguments]"==a(n)}},function(n,e,t){var a=t(15),r=Object.prototype,o=r.hasOwnProperty,i=r.toString,s=a?a.toStringTag:void 0;n.exports=function(n){var e=o.call(n,s),t=n[s];try{n[s]=void 0;var a=!0}catch(n){}var r=i.call(n);return a&&(e?n[s]=t:delete n[s]),r}},function(n,e){var t=Object.prototype.toString;n.exports=function(n){return t.call(n)}},function(n,e,t){var a=t(151),r=t(207),o=t(46),i=t(5),s=t(218);n.exports=function(n){return"function"==typeof n?n:null==n?o:"object"==typeof n?i(n)?r(n[0],n[1]):a(n):s(n)}},function(n,e,t){var a=t(152),r=t(206),o=t(85);n.exports=function(n){var e=r(n);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(t){return t===n||a(t,n,e)}}},function(n,e,t){var a=t(70),r=t(74);n.exports=function(n,e,t,o){var i=t.length,s=i,l=!o;if(null==n)return!s;for(n=Object(n);i--;){var c=t[i];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++i<s;){var d=(c=t[i])[0],p=n[d],u=c[1];if(l&&c[2]){if(void 0===p&&!(d in n))return!1}else{var h=new a;if(o)var m=o(p,u,d,n,e,h);if(!(void 0===m?r(u,p,3,o,h):m))return!1}}return!0}},function(n,e){n.exports=function(){this.__data__=[],this.size=0}},function(n,e,t){var a=t(20),r=Array.prototype.splice;n.exports=function(n){var e=this.__data__,t=a(e,n);return!(t<0)&&(t==e.length-1?e.pop():r.call(e,t,1),--this.size,!0)}},function(n,e,t){var a=t(20);n.exports=function(n){var e=this.__data__,t=a(e,n);return t<0?void 0:e[t][1]}},function(n,e,t){var a=t(20);n.exports=function(n){return a(this.__data__,n)>-1}},function(n,e,t){var a=t(20);n.exports=function(n,e){var t=this.__data__,r=a(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}},function(n,e,t){var a=t(19);n.exports=function(){this.__data__=new a,this.size=0}},function(n,e){n.exports=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}},function(n,e){n.exports=function(n){return this.__data__.get(n)}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e,t){var a=t(19),r=t(39),o=t(41);n.exports=function(n,e){var t=this.__data__;if(t instanceof a){var i=t.__data__;if(!r||i.length<199)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new o(i)}return t.set(n,e),this.size=t.size,this}},function(n,e,t){var a=t(72),r=t(164),o=t(40),i=t(73),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,p=c.hasOwnProperty,u=RegExp("^"+d.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!o(n)||r(n))&&(a(n)?u:s).test(i(n))}},function(n,e,t){var a,r=t(165),o=(a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";n.exports=function(n){return!!o&&o in n}},function(n,e,t){var a=t(6)["__core-js_shared__"];n.exports=a},function(n,e){n.exports=function(n,e){return null==n?void 0:n[e]}},function(n,e,t){var a=t(168),r=t(19),o=t(39);n.exports=function(){this.size=0,this.__data__={hash:new a,map:new(o||r),string:new a}}},function(n,e,t){var a=t(169),r=t(170),o=t(171),i=t(172),s=t(173);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var a=n[e];this.set(a[0],a[1])}}l.prototype.clear=a,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=i,l.prototype.set=s,n.exports=l},function(n,e,t){var a=t(21);n.exports=function(){this.__data__=a?a(null):{},this.size=0}},function(n,e){n.exports=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}},function(n,e,t){var a=t(21),r=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;if(a){var t=e[n];return"__lodash_hash_undefined__"===t?void 0:t}return r.call(e,n)?e[n]:void 0}},function(n,e,t){var a=t(21),r=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;return a?void 0!==e[n]:r.call(e,n)}},function(n,e,t){var a=t(21);n.exports=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=a&&void 0===e?"__lodash_hash_undefined__":e,this}},function(n,e,t){var a=t(22);n.exports=function(n){var e=a(this,n).delete(n);return this.size-=e?1:0,e}},function(n,e){n.exports=function(n){var e=typeof n;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n}},function(n,e,t){var a=t(22);n.exports=function(n){return a(this,n).get(n)}},function(n,e,t){var a=t(22);n.exports=function(n){return a(this,n).has(n)}},function(n,e,t){var a=t(22);n.exports=function(n,e){var t=a(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}},function(n,e,t){var a=t(70),r=t(75),o=t(183),i=t(186),s=t(202),l=t(5),c=t(79),d=t(81),p="[object Object]",u=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,h,m,f){var g=l(n),v=l(e),b=g?"[object Array]":s(n),y=v?"[object Array]":s(e),k=(b="[object Arguments]"==b?p:b)==p,x=(y="[object Arguments]"==y?p:y)==p,w=b==y;if(w&&c(n)){if(!c(e))return!1;g=!0,k=!1}if(w&&!k)return f||(f=new a),g||d(n)?r(n,e,t,h,m,f):o(n,e,b,t,h,m,f);if(!(1&t)){var S=k&&u.call(n,"__wrapped__"),T=x&&u.call(e,"__wrapped__");if(S||T){var C=S?n.value():n,j=T?e.value():e;return f||(f=new a),m(C,j,t,h,f)}}return!!w&&(f||(f=new a),i(n,e,t,h,m,f))}},function(n,e){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length;++t<a;)if(e(n[t],t,n))return!0;return!1}},function(n,e,t){var a=t(15),r=t(184),o=t(71),i=t(75),s=t(185),l=t(42),c=a?a.prototype:void 0,d=c?c.valueOf:void 0;n.exports=function(n,e,t,a,c,p,u){switch(t){case"[object DataView]":if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=e.byteLength||!p(new r(n),new r(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+n,+e);case"[object Error]":return n.name==e.name&&n.message==e.message;case"[object RegExp]":case"[object String]":return n==e+"";case"[object Map]":var h=s;case"[object Set]":var m=1&a;if(h||(h=l),n.size!=e.size&&!m)return!1;var f=u.get(n);if(f)return f==e;a|=2,u.set(n,e);var g=i(h(n),h(e),a,c,p,u);return u.delete(n),g;case"[object Symbol]":if(d)return d.call(n)==d.call(e)}return!1}},function(n,e,t){var a=t(6).Uint8Array;n.exports=a},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n,a){t[++e]=[a,n]})),t}},function(n,e,t){var a=t(187),r=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,o,i,s){var l=1&t,c=a(n),d=c.length;if(d!=a(e).length&&!l)return!1;for(var p=d;p--;){var u=c[p];if(!(l?u in e:r.call(e,u)))return!1}var h=s.get(n),m=s.get(e);if(h&&m)return h==e&&m==n;var f=!0;s.set(n,e),s.set(e,n);for(var g=l;++p<d;){var v=n[u=c[p]],b=e[u];if(o)var y=l?o(b,v,u,e,n,s):o(v,b,u,n,e,s);if(!(void 0===y?v===b||i(v,b,t,o,s):y)){f=!1;break}g||(g="constructor"==u)}if(f&&!g){var k=n.constructor,x=e.constructor;k==x||!("constructor"in n)||!("constructor"in e)||"function"==typeof k&&k instanceof k&&"function"==typeof x&&x instanceof x||(f=!1)}return s.delete(n),s.delete(e),f}},function(n,e,t){var a=t(188),r=t(189),o=t(78);n.exports=function(n){return a(n,o,r)}},function(n,e,t){var a=t(68),r=t(5);n.exports=function(n,e,t){var o=e(n);return r(n)?o:a(o,t(n))}},function(n,e,t){var a=t(190),r=t(191),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(n){return null==n?[]:(n=Object(n),a(i(n),(function(e){return o.call(n,e)})))}:r;n.exports=s},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length,r=0,o=[];++t<a;){var i=n[t];e(i,t,n)&&(o[r++]=i)}return o}},function(n,e){n.exports=function(){return[]}},function(n,e,t){var a=t(193),r=t(38),o=t(5),i=t(79),s=t(80),l=t(81),c=Object.prototype.hasOwnProperty;n.exports=function(n,e){var t=o(n),d=!t&&r(n),p=!t&&!d&&i(n),u=!t&&!d&&!p&&l(n),h=t||d||p||u,m=h?a(n.length,String):[],f=m.length;for(var g in n)!e&&!c.call(n,g)||h&&("length"==g||p&&("offset"==g||"parent"==g)||u&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,f))||m.push(g);return m}},function(n,e){n.exports=function(n,e){for(var t=-1,a=Array(n);++t<n;)a[t]=e(t);return a}},function(n,e){n.exports=function(){return!1}},function(n,e,t){var a=t(13),r=t(43),o=t(12),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,n.exports=function(n){return o(n)&&r(n.length)&&!!i[a(n)]}},function(n,e){n.exports=function(n){return function(e){return n(e)}}},function(n,e,t){(function(n){var a=t(69),r=e&&!e.nodeType&&e,o=r&&"object"==typeof n&&n&&!n.nodeType&&n,i=o&&o.exports===r&&a.process,s=function(){try{var n=o&&o.require&&o.require("util").types;return n||i&&i.binding&&i.binding("util")}catch(n){}}();n.exports=s}).call(this,t(49)(n))},function(n,e,t){var a=t(199),r=t(200),o=Object.prototype.hasOwnProperty;n.exports=function(n){if(!a(n))return r(n);var e=[];for(var t in Object(n))o.call(n,t)&&"constructor"!=t&&e.push(t);return e}},function(n,e){var t=Object.prototype;n.exports=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}},function(n,e,t){var a=t(201)(Object.keys,Object);n.exports=a},function(n,e){n.exports=function(n,e){return function(t){return n(e(t))}}},function(n,e,t){var a=t(203),r=t(39),o=t(204),i=t(83),s=t(205),l=t(13),c=t(73),d=c(a),p=c(r),u=c(o),h=c(i),m=c(s),f=l;(a&&"[object DataView]"!=f(new a(new ArrayBuffer(1)))||r&&"[object Map]"!=f(new r)||o&&"[object Promise]"!=f(o.resolve())||i&&"[object Set]"!=f(new i)||s&&"[object WeakMap]"!=f(new s))&&(f=function(n){var e=l(n),t="[object Object]"==e?n.constructor:void 0,a=t?c(t):"";if(a)switch(a){case d:return"[object DataView]";case p:return"[object Map]";case u:return"[object Promise]";case h:return"[object Set]";case m:return"[object WeakMap]"}return e}),n.exports=f},function(n,e,t){var a=t(10)(t(6),"DataView");n.exports=a},function(n,e,t){var a=t(10)(t(6),"Promise");n.exports=a},function(n,e,t){var a=t(10)(t(6),"WeakMap");n.exports=a},function(n,e,t){var a=t(84),r=t(78);n.exports=function(n){for(var e=r(n),t=e.length;t--;){var o=e[t],i=n[o];e[t]=[o,i,a(i)]}return e}},function(n,e,t){var a=t(74),r=t(208),o=t(215),i=t(44),s=t(84),l=t(85),c=t(23);n.exports=function(n,e){return i(n)&&s(e)?l(c(n),e):function(t){var i=r(t,n);return void 0===i&&i===e?o(t,n):a(e,i,3)}}},function(n,e,t){var a=t(86);n.exports=function(n,e,t){var r=null==n?void 0:a(n,e);return void 0===r?t:r}},function(n,e,t){var a=t(210),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,i=a((function(n){var e=[];return 46===n.charCodeAt(0)&&e.push(""),n.replace(r,(function(n,t,a,r){e.push(a?r.replace(o,"$1"):t||n)})),e}));n.exports=i},function(n,e,t){var a=t(211);n.exports=function(n){var e=a(n,(function(n){return 500===t.size&&t.clear(),n})),t=e.cache;return e}},function(n,e,t){var a=t(41);function r(n,e){if("function"!=typeof n||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var t=function(){var a=arguments,r=e?e.apply(this,a):a[0],o=t.cache;if(o.has(r))return o.get(r);var i=n.apply(this,a);return t.cache=o.set(r,i)||o,i};return t.cache=new(r.Cache||a),t}r.Cache=a,n.exports=r},function(n,e,t){var a=t(213);n.exports=function(n){return null==n?"":a(n)}},function(n,e,t){var a=t(15),r=t(214),o=t(5),i=t(45),s=a?a.prototype:void 0,l=s?s.toString:void 0;n.exports=function n(e){if("string"==typeof e)return e;if(o(e))return r(e,n)+"";if(i(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(n,e){n.exports=function(n,e){for(var t=-1,a=null==n?0:n.length,r=Array(a);++t<a;)r[t]=e(n[t],t,n);return r}},function(n,e,t){var a=t(216),r=t(217);n.exports=function(n,e){return null!=n&&r(n,e,a)}},function(n,e){n.exports=function(n,e){return null!=n&&e in Object(n)}},function(n,e,t){var a=t(87),r=t(38),o=t(5),i=t(80),s=t(43),l=t(23);n.exports=function(n,e,t){for(var c=-1,d=(e=a(e,n)).length,p=!1;++c<d;){var u=l(e[c]);if(!(p=null!=n&&t(n,u)))break;n=n[u]}return p||++c!=d?p:!!(d=null==n?0:n.length)&&s(d)&&i(u,d)&&(o(n)||r(n))}},function(n,e,t){var a=t(219),r=t(220),o=t(44),i=t(23);n.exports=function(n){return o(n)?a(i(n)):r(n)}},function(n,e){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},function(n,e,t){var a=t(86);n.exports=function(n){return function(e){return a(e,n)}}},function(n,e,t){var a=t(46),r=t(222),o=t(224);n.exports=function(n,e){return o(r(n,e,a),n+"")}},function(n,e,t){var a=t(223),r=Math.max;n.exports=function(n,e,t){return e=r(void 0===e?n.length-1:e,0),function(){for(var o=arguments,i=-1,s=r(o.length-e,0),l=Array(s);++i<s;)l[i]=o[e+i];i=-1;for(var c=Array(e+1);++i<e;)c[i]=o[i];return c[e]=t(l),a(n,this,c)}}},function(n,e){n.exports=function(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}},function(n,e,t){var a=t(225),r=t(228)(a);n.exports=r},function(n,e,t){var a=t(226),r=t(227),o=t(46),i=r?function(n,e){return r(n,"toString",{configurable:!0,enumerable:!1,value:a(e),writable:!0})}:o;n.exports=i},function(n,e){n.exports=function(n){return function(){return n}}},function(n,e,t){var a=t(10),r=function(){try{var n=a(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=r},function(n,e){var t=Date.now;n.exports=function(n){var e=0,a=0;return function(){var r=t(),o=16-(r-a);if(a=r,o>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}},function(n,e,t){var a=t(76),r=t(230),o=t(235),i=t(77),s=t(236),l=t(42);n.exports=function(n,e,t){var c=-1,d=r,p=n.length,u=!0,h=[],m=h;if(t)u=!1,d=o;else if(p>=200){var f=e?null:s(n);if(f)return l(f);u=!1,d=i,m=new a}else m=e?[]:h;n:for(;++c<p;){var g=n[c],v=e?e(g):g;if(g=t||0!==g?g:0,u&&v==v){for(var b=m.length;b--;)if(m[b]===v)continue n;e&&m.push(v),h.push(g)}else d(m,v,t)||(m!==h&&m.push(v),h.push(g))}return h}},function(n,e,t){var a=t(231);n.exports=function(n,e){return!!(null==n?0:n.length)&&a(n,e,0)>-1}},function(n,e,t){var a=t(232),r=t(233),o=t(234);n.exports=function(n,e,t){return e==e?o(n,e,t):a(n,r,t)}},function(n,e){n.exports=function(n,e,t,a){for(var r=n.length,o=t+(a?1:-1);a?o--:++o<r;)if(e(n[o],o,n))return o;return-1}},function(n,e){n.exports=function(n){return n!=n}},function(n,e){n.exports=function(n,e,t){for(var a=t-1,r=n.length;++a<r;)if(n[a]===e)return a;return-1}},function(n,e){n.exports=function(n,e,t){for(var a=-1,r=null==n?0:n.length;++a<r;)if(t(e,n[a]))return!0;return!1}},function(n,e,t){var a=t(83),r=t(237),o=t(42),i=a&&1/o(new a([,-0]))[1]==1/0?function(n){return new a(n)}:r;n.exports=i},function(n,e){n.exports=function(){}},function(n,e,t){var a=t(82),r=t(12);n.exports=function(n){return r(n)&&a(n)}},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";t(88)},function(n,e,t){"use strict";t(89)},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";t(90)},function(n,e,t){"use strict";t(91)},function(n,e,t){"use strict";t.r(e);
/*!
 * Vue.js v2.7.14
 * (c) 2014-2022 Evan You
 * Released under the MIT License.
 */
var a=Object.freeze({}),r=Array.isArray;function o(n){return null==n}function i(n){return null!=n}function s(n){return!0===n}function l(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function c(n){return"function"==typeof n}function d(n){return null!==n&&"object"==typeof n}var p=Object.prototype.toString;function u(n){return"[object Object]"===p.call(n)}function h(n){return"[object RegExp]"===p.call(n)}function m(n){var e=parseFloat(String(n));return e>=0&&Math.floor(e)===e&&isFinite(n)}function f(n){return i(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function g(n){return null==n?"":Array.isArray(n)||u(n)&&n.toString===p?JSON.stringify(n,null,2):String(n)}function v(n){var e=parseFloat(n);return isNaN(e)?n:e}function b(n,e){for(var t=Object.create(null),a=n.split(","),r=0;r<a.length;r++)t[a[r]]=!0;return e?function(n){return t[n.toLowerCase()]}:function(n){return t[n]}}b("slot,component",!0);var y=b("key,ref,slot,slot-scope,is");function k(n,e){var t=n.length;if(t){if(e===n[t-1])return void(n.length=t-1);var a=n.indexOf(e);if(a>-1)return n.splice(a,1)}}var x=Object.prototype.hasOwnProperty;function w(n,e){return x.call(n,e)}function S(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var T=/-(\w)/g,C=S((function(n){return n.replace(T,(function(n,e){return e?e.toUpperCase():""}))})),j=S((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),E=/\B([A-Z])/g,A=S((function(n){return n.replace(E,"-$1").toLowerCase()}));var I=Function.prototype.bind?function(n,e){return n.bind(e)}:function(n,e){function t(t){var a=arguments.length;return a?a>1?n.apply(e,arguments):n.call(e,t):n.call(e)}return t._length=n.length,t};function _(n,e){e=e||0;for(var t=n.length-e,a=new Array(t);t--;)a[t]=n[t+e];return a}function L(n,e){for(var t in e)n[t]=e[t];return n}function z(n){for(var e={},t=0;t<n.length;t++)n[t]&&L(e,n[t]);return e}function P(n,e,t){}var B=function(n,e,t){return!1},M=function(n){return n};function O(n,e){if(n===e)return!0;var t=d(n),a=d(e);if(!t||!a)return!t&&!a&&String(n)===String(e);try{var r=Array.isArray(n),o=Array.isArray(e);if(r&&o)return n.length===e.length&&n.every((function(n,t){return O(n,e[t])}));if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(r||o)return!1;var i=Object.keys(n),s=Object.keys(e);return i.length===s.length&&i.every((function(t){return O(n[t],e[t])}))}catch(n){return!1}}function R(n,e){for(var t=0;t<n.length;t++)if(O(n[t],e))return t;return-1}function D(n){var e=!1;return function(){e||(e=!0,n.apply(this,arguments))}}function J(n,e){return n===e?0===n&&1/n!=1/e:n==n||e==e}var q=["component","directive","filter"],F=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],N={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:B,isReservedAttr:B,isUnknownElement:B,getTagNamespace:P,parsePlatformTagName:M,mustUseProp:B,async:!0,_lifecycleHooks:F},Q=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function U(n){var e=(n+"").charCodeAt(0);return 36===e||95===e}function H(n,e,t,a){Object.defineProperty(n,e,{value:t,enumerable:!!a,writable:!0,configurable:!0})}var $=new RegExp("[^".concat(Q.source,".$_\\d]"));var G="__proto__"in{},V="undefined"!=typeof window,X=V&&window.navigator.userAgent.toLowerCase(),K=X&&/msie|trident/.test(X),W=X&&X.indexOf("msie 9.0")>0,Z=X&&X.indexOf("edge/")>0;X&&X.indexOf("android");var Y=X&&/iphone|ipad|ipod|ios/.test(X);X&&/chrome\/\d+/.test(X),X&&/phantomjs/.test(X);var nn,en=X&&X.match(/firefox\/(\d+)/),tn={}.watch,an=!1;if(V)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){an=!0}}),window.addEventListener("test-passive",null,rn)}catch(n){}var on=function(){return void 0===nn&&(nn=!V&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),nn},sn=V&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ln(n){return"function"==typeof n&&/native code/.test(n.toString())}var cn,dn="undefined"!=typeof Symbol&&ln(Symbol)&&"undefined"!=typeof Reflect&&ln(Reflect.ownKeys);cn="undefined"!=typeof Set&&ln(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var pn=null;function un(n){void 0===n&&(n=null),n||pn&&pn._scope.off(),pn=n,n&&n._scope.on()}var hn=function(){function n(n,e,t,a,r,o,i,s){this.tag=n,this.data=e,this.children=t,this.text=a,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=i,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(n.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),n}(),mn=function(n){void 0===n&&(n="");var e=new hn;return e.text=n,e.isComment=!0,e};function fn(n){return new hn(void 0,void 0,void 0,String(n))}function gn(n){var e=new hn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return e.ns=n.ns,e.isStatic=n.isStatic,e.key=n.key,e.isComment=n.isComment,e.fnContext=n.fnContext,e.fnOptions=n.fnOptions,e.fnScopeId=n.fnScopeId,e.asyncMeta=n.asyncMeta,e.isCloned=!0,e}var vn=0,bn=[],yn=function(){function n(){this._pending=!1,this.id=vn++,this.subs=[]}return n.prototype.addSub=function(n){this.subs.push(n)},n.prototype.removeSub=function(n){this.subs[this.subs.indexOf(n)]=null,this._pending||(this._pending=!0,bn.push(this))},n.prototype.depend=function(e){n.target&&n.target.addDep(this)},n.prototype.notify=function(n){var e=this.subs.filter((function(n){return n}));for(var t=0,a=e.length;t<a;t++){0,e[t].update()}},n}();yn.target=null;var kn=[];function xn(n){kn.push(n),yn.target=n}function wn(){kn.pop(),yn.target=kn[kn.length-1]}var Sn=Array.prototype,Tn=Object.create(Sn);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var e=Sn[n];H(Tn,n,(function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var r,o=e.apply(this,t),i=this.__ob__;switch(n){case"push":case"unshift":r=t;break;case"splice":r=t.slice(2)}return r&&i.observeArray(r),i.dep.notify(),o}))}));var Cn=Object.getOwnPropertyNames(Tn),jn={},En=!0;function An(n){En=n}var In={notify:P,depend:P,addSub:P,removeSub:P},_n=function(){function n(n,e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this.value=n,this.shallow=e,this.mock=t,this.dep=t?In:new yn,this.vmCount=0,H(n,"__ob__",this),r(n)){if(!t)if(G)n.__proto__=Tn;else for(var a=0,o=Cn.length;a<o;a++){H(n,s=Cn[a],Tn[s])}e||this.observeArray(n)}else{var i=Object.keys(n);for(a=0;a<i.length;a++){var s;zn(n,s=i[a],jn,void 0,e,t)}}}return n.prototype.observeArray=function(n){for(var e=0,t=n.length;e<t;e++)Ln(n[e],!1,this.mock)},n}();function Ln(n,e,t){return n&&w(n,"__ob__")&&n.__ob__ instanceof _n?n.__ob__:!En||!t&&on()||!r(n)&&!u(n)||!Object.isExtensible(n)||n.__v_skip||Jn(n)||n instanceof hn?void 0:new _n(n,e,t)}function zn(n,e,t,a,o,i){var s=new yn,l=Object.getOwnPropertyDescriptor(n,e);if(!l||!1!==l.configurable){var c=l&&l.get,d=l&&l.set;c&&!d||t!==jn&&2!==arguments.length||(t=n[e]);var p=!o&&Ln(t,!1,i);return Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){var e=c?c.call(n):t;return yn.target&&(s.depend(),p&&(p.dep.depend(),r(e)&&Mn(e))),Jn(e)&&!o?e.value:e},set:function(e){var a=c?c.call(n):t;if(J(a,e)){if(d)d.call(n,e);else{if(c)return;if(!o&&Jn(a)&&!Jn(e))return void(a.value=e);t=e}p=!o&&Ln(e,!1,i),s.notify()}}}),s}}function Pn(n,e,t){if(!Dn(n)){var a=n.__ob__;return r(n)&&m(e)?(n.length=Math.max(n.length,e),n.splice(e,1,t),a&&!a.shallow&&a.mock&&Ln(t,!1,!0),t):e in n&&!(e in Object.prototype)?(n[e]=t,t):n._isVue||a&&a.vmCount?t:a?(zn(a.value,e,t,void 0,a.shallow,a.mock),a.dep.notify(),t):(n[e]=t,t)}}function Bn(n,e){if(r(n)&&m(e))n.splice(e,1);else{var t=n.__ob__;n._isVue||t&&t.vmCount||Dn(n)||w(n,e)&&(delete n[e],t&&t.dep.notify())}}function Mn(n){for(var e=void 0,t=0,a=n.length;t<a;t++)(e=n[t])&&e.__ob__&&e.__ob__.dep.depend(),r(e)&&Mn(e)}function On(n){return Rn(n,!0),H(n,"__v_isShallow",!0),n}function Rn(n,e){if(!Dn(n)){Ln(n,e,on());0}}function Dn(n){return!(!n||!n.__v_isReadonly)}function Jn(n){return!(!n||!0!==n.__v_isRef)}function qn(n,e,t){Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){var n=e[t];if(Jn(n))return n.value;var a=n&&n.__ob__;return a&&a.dep.depend(),n},set:function(n){var a=e[t];Jn(a)&&!Jn(n)?a.value=n:e[t]=n}})}"".concat("watcher"," callback"),"".concat("watcher"," getter"),"".concat("watcher"," cleanup");var Fn;var Nn=function(){function n(n){void 0===n&&(n=!1),this.detached=n,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Fn,!n&&Fn&&(this.index=(Fn.scopes||(Fn.scopes=[])).push(this)-1)}return n.prototype.run=function(n){if(this.active){var e=Fn;try{return Fn=this,n()}finally{Fn=e}}else 0},n.prototype.on=function(){Fn=this},n.prototype.off=function(){Fn=this.parent},n.prototype.stop=function(n){if(this.active){var e=void 0,t=void 0;for(e=0,t=this.effects.length;e<t;e++)this.effects[e].teardown();for(e=0,t=this.cleanups.length;e<t;e++)this.cleanups[e]();if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!n){var a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0,this.active=!1}},n}();function Qn(n){var e=n._provided,t=n.$parent&&n.$parent._provided;return t===e?n._provided=Object.create(t):e}var Un=S((function(n){var e="&"===n.charAt(0),t="~"===(n=e?n.slice(1):n).charAt(0),a="!"===(n=t?n.slice(1):n).charAt(0);return{name:n=a?n.slice(1):n,once:t,capture:a,passive:e}}));function Hn(n,e){function t(){var n=t.fns;if(!r(n))return Ee(n,null,arguments,e,"v-on handler");for(var a=n.slice(),o=0;o<a.length;o++)Ee(a[o],null,arguments,e,"v-on handler")}return t.fns=n,t}function $n(n,e,t,a,r,i){var l,c,d,p;for(l in n)c=n[l],d=e[l],p=Un(l),o(c)||(o(d)?(o(c.fns)&&(c=n[l]=Hn(c,i)),s(p.once)&&(c=n[l]=r(p.name,c,p.capture)),t(p.name,c,p.capture,p.passive,p.params)):c!==d&&(d.fns=c,n[l]=d));for(l in e)o(n[l])&&a((p=Un(l)).name,e[l],p.capture)}function Gn(n,e,t){var a;n instanceof hn&&(n=n.data.hook||(n.data.hook={}));var r=n[e];function l(){t.apply(this,arguments),k(a.fns,l)}o(r)?a=Hn([l]):i(r.fns)&&s(r.merged)?(a=r).fns.push(l):a=Hn([r,l]),a.merged=!0,n[e]=a}function Vn(n,e,t,a,r){if(i(e)){if(w(e,t))return n[t]=e[t],r||delete e[t],!0;if(w(e,a))return n[t]=e[a],r||delete e[a],!0}return!1}function Xn(n){return l(n)?[fn(n)]:r(n)?function n(e,t){var a,c,d,p,u=[];for(a=0;a<e.length;a++)o(c=e[a])||"boolean"==typeof c||(d=u.length-1,p=u[d],r(c)?c.length>0&&(Kn((c=n(c,"".concat(t||"","_").concat(a)))[0])&&Kn(p)&&(u[d]=fn(p.text+c[0].text),c.shift()),u.push.apply(u,c)):l(c)?Kn(p)?u[d]=fn(p.text+c):""!==c&&u.push(fn(c)):Kn(c)&&Kn(p)?u[d]=fn(p.text+c.text):(s(e._isVList)&&i(c.tag)&&o(c.key)&&i(t)&&(c.key="__vlist".concat(t,"_").concat(a,"__")),u.push(c)));return u}(n):void 0}function Kn(n){return i(n)&&i(n.text)&&!1===n.isComment}function Wn(n,e){var t,a,o,s,l=null;if(r(n)||"string"==typeof n)for(l=new Array(n.length),t=0,a=n.length;t<a;t++)l[t]=e(n[t],t);else if("number"==typeof n)for(l=new Array(n),t=0;t<n;t++)l[t]=e(t+1,t);else if(d(n))if(dn&&n[Symbol.iterator]){l=[];for(var c=n[Symbol.iterator](),p=c.next();!p.done;)l.push(e(p.value,l.length)),p=c.next()}else for(o=Object.keys(n),l=new Array(o.length),t=0,a=o.length;t<a;t++)s=o[t],l[t]=e(n[s],s,t);return i(l)||(l=[]),l._isVList=!0,l}function Zn(n,e,t,a){var r,o=this.$scopedSlots[n];o?(t=t||{},a&&(t=L(L({},a),t)),r=o(t)||(c(e)?e():e)):r=this.$slots[n]||(c(e)?e():e);var i=t&&t.slot;return i?this.$createElement("template",{slot:i},r):r}function Yn(n){return _t(this.$options,"filters",n,!0)||M}function ne(n,e){return r(n)?-1===n.indexOf(e):n!==e}function ee(n,e,t,a,r){var o=N.keyCodes[e]||t;return r&&a&&!N.keyCodes[e]?ne(r,a):o?ne(o,n):a?A(a)!==e:void 0===n}function te(n,e,t,a,o){if(t)if(d(t)){r(t)&&(t=z(t));var i=void 0,s=function(r){if("class"===r||"style"===r||y(r))i=n;else{var s=n.attrs&&n.attrs.type;i=a||N.mustUseProp(e,s,r)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var l=C(r),c=A(r);l in i||c in i||(i[r]=t[r],o&&((n.on||(n.on={}))["update:".concat(r)]=function(n){t[r]=n}))};for(var l in t)s(l)}else;return n}function ae(n,e){var t=this._staticTrees||(this._staticTrees=[]),a=t[n];return a&&!e||oe(a=t[n]=this.$options.staticRenderFns[n].call(this._renderProxy,this._c,this),"__static__".concat(n),!1),a}function re(n,e,t){return oe(n,"__once__".concat(e).concat(t?"_".concat(t):""),!0),n}function oe(n,e,t){if(r(n))for(var a=0;a<n.length;a++)n[a]&&"string"!=typeof n[a]&&ie(n[a],"".concat(e,"_").concat(a),t);else ie(n,e,t)}function ie(n,e,t){n.isStatic=!0,n.key=e,n.isOnce=t}function se(n,e){if(e)if(u(e)){var t=n.on=n.on?L({},n.on):{};for(var a in e){var r=t[a],o=e[a];t[a]=r?[].concat(r,o):o}}else;return n}function le(n,e,t,a){e=e||{$stable:!t};for(var o=0;o<n.length;o++){var i=n[o];r(i)?le(i,e,t):i&&(i.proxy&&(i.fn.proxy=!0),e[i.key]=i.fn)}return a&&(e.$key=a),e}function ce(n,e){for(var t=0;t<e.length;t+=2){var a=e[t];"string"==typeof a&&a&&(n[e[t]]=e[t+1])}return n}function de(n,e){return"string"==typeof n?e+n:n}function pe(n){n._o=re,n._n=v,n._s=g,n._l=Wn,n._t=Zn,n._q=O,n._i=R,n._m=ae,n._f=Yn,n._k=ee,n._b=te,n._v=fn,n._e=mn,n._u=le,n._g=se,n._d=ce,n._p=de}function ue(n,e){if(!n||!n.length)return{};for(var t={},a=0,r=n.length;a<r;a++){var o=n[a],i=o.data;if(i&&i.attrs&&i.attrs.slot&&delete i.attrs.slot,o.context!==e&&o.fnContext!==e||!i||null==i.slot)(t.default||(t.default=[])).push(o);else{var s=i.slot,l=t[s]||(t[s]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var c in t)t[c].every(he)&&delete t[c];return t}function he(n){return n.isComment&&!n.asyncFactory||" "===n.text}function me(n){return n.isComment&&n.asyncFactory}function fe(n,e,t,r){var o,i=Object.keys(t).length>0,s=e?!!e.$stable:!i,l=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&r&&r!==a&&l===r.$key&&!i&&!r.$hasNormal)return r;for(var c in o={},e)e[c]&&"$"!==c[0]&&(o[c]=ge(n,t,c,e[c]))}else o={};for(var d in t)d in o||(o[d]=ve(t,d));return e&&Object.isExtensible(e)&&(e._normalized=o),H(o,"$stable",s),H(o,"$key",l),H(o,"$hasNormal",i),o}function ge(n,e,t,a){var o=function(){var e=pn;un(n);var t=arguments.length?a.apply(null,arguments):a({}),o=(t=t&&"object"==typeof t&&!r(t)?[t]:Xn(t))&&t[0];return un(e),t&&(!o||1===t.length&&o.isComment&&!me(o))?void 0:t};return a.proxy&&Object.defineProperty(e,t,{get:o,enumerable:!0,configurable:!0}),o}function ve(n,e){return function(){return n[e]}}function be(n){return{get attrs(){if(!n._attrsProxy){var e=n._attrsProxy={};H(e,"_v_attr_proxy",!0),ye(e,n.$attrs,a,n,"$attrs")}return n._attrsProxy},get listeners(){n._listenersProxy||ye(n._listenersProxy={},n.$listeners,a,n,"$listeners");return n._listenersProxy},get slots(){return function(n){n._slotsProxy||xe(n._slotsProxy={},n.$scopedSlots);return n._slotsProxy}(n)},emit:I(n.$emit,n),expose:function(e){e&&Object.keys(e).forEach((function(t){return qn(n,e,t)}))}}}function ye(n,e,t,a,r){var o=!1;for(var i in e)i in n?e[i]!==t[i]&&(o=!0):(o=!0,ke(n,i,a,r));for(var i in n)i in e||(o=!0,delete n[i]);return o}function ke(n,e,t,a){Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return t[a][e]}})}function xe(n,e){for(var t in e)n[t]=e[t];for(var t in n)t in e||delete n[t]}var we=null;function Se(n,e){return(n.__esModule||dn&&"Module"===n[Symbol.toStringTag])&&(n=n.default),d(n)?e.extend(n):n}function Te(n){if(r(n))for(var e=0;e<n.length;e++){var t=n[e];if(i(t)&&(i(t.componentOptions)||me(t)))return t}}function Ce(n,e,t,a,p,u){return(r(t)||l(t))&&(p=a,a=t,t=void 0),s(u)&&(p=2),function(n,e,t,a,l){if(i(t)&&i(t.__ob__))return mn();i(t)&&i(t.is)&&(e=t.is);if(!e)return mn();0;r(a)&&c(a[0])&&((t=t||{}).scopedSlots={default:a[0]},a.length=0);2===l?a=Xn(a):1===l&&(a=function(n){for(var e=0;e<n.length;e++)if(r(n[e]))return Array.prototype.concat.apply([],n);return n}(a));var p,u;if("string"==typeof e){var h=void 0;u=n.$vnode&&n.$vnode.ns||N.getTagNamespace(e),p=N.isReservedTag(e)?new hn(N.parsePlatformTagName(e),t,a,void 0,void 0,n):t&&t.pre||!i(h=_t(n.$options,"components",e))?new hn(e,t,a,void 0,void 0,n):kt(h,t,n,a,e)}else p=kt(e,t,n,a);return r(p)?p:i(p)?(i(u)&&function n(e,t,a){e.ns=t,"foreignObject"===e.tag&&(t=void 0,a=!0);if(i(e.children))for(var r=0,l=e.children.length;r<l;r++){var c=e.children[r];i(c.tag)&&(o(c.ns)||s(a)&&"svg"!==c.tag)&&n(c,t,a)}}(p,u),i(t)&&function(n){d(n.style)&&Ne(n.style);d(n.class)&&Ne(n.class)}(t),p):mn()}(n,e,t,a,p)}function je(n,e,t){xn();try{if(e)for(var a=e;a=a.$parent;){var r=a.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{if(!1===r[o].call(a,n,e,t))return}catch(n){Ae(n,a,"errorCaptured hook")}}Ae(n,e,t)}finally{wn()}}function Ee(n,e,t,a,r){var o;try{(o=t?n.apply(e,t):n.call(e))&&!o._isVue&&f(o)&&!o._handled&&(o.catch((function(n){return je(n,a,r+" (Promise/async)")})),o._handled=!0)}catch(n){je(n,a,r)}return o}function Ae(n,e,t){if(N.errorHandler)try{return N.errorHandler.call(null,n,e,t)}catch(e){e!==n&&Ie(e,null,"config.errorHandler")}Ie(n,e,t)}function Ie(n,e,t){if(!V||"undefined"==typeof console)throw n;console.error(n)}var _e,Le=!1,ze=[],Pe=!1;function Be(){Pe=!1;var n=ze.slice(0);ze.length=0;for(var e=0;e<n.length;e++)n[e]()}if("undefined"!=typeof Promise&&ln(Promise)){var Me=Promise.resolve();_e=function(){Me.then(Be),Y&&setTimeout(P)},Le=!0}else if(K||"undefined"==typeof MutationObserver||!ln(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())_e="undefined"!=typeof setImmediate&&ln(setImmediate)?function(){setImmediate(Be)}:function(){setTimeout(Be,0)};else{var Oe=1,Re=new MutationObserver(Be),De=document.createTextNode(String(Oe));Re.observe(De,{characterData:!0}),_e=function(){Oe=(Oe+1)%2,De.data=String(Oe)},Le=!0}function Je(n,e){var t;if(ze.push((function(){if(n)try{n.call(e)}catch(n){je(n,e,"nextTick")}else t&&t(e)})),Pe||(Pe=!0,_e()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){t=n}))}function qe(n){return function(e,t){if(void 0===t&&(t=pn),t)return function(n,e,t){var a=n.$options;a[e]=jt(a[e],t)}(t,n,e)}}qe("beforeMount"),qe("mounted"),qe("beforeUpdate"),qe("updated"),qe("beforeDestroy"),qe("destroyed"),qe("activated"),qe("deactivated"),qe("serverPrefetch"),qe("renderTracked"),qe("renderTriggered"),qe("errorCaptured");var Fe=new cn;function Ne(n){return function n(e,t){var a,o,i=r(e);if(!i&&!d(e)||e.__v_skip||Object.isFrozen(e)||e instanceof hn)return;if(e.__ob__){var s=e.__ob__.dep.id;if(t.has(s))return;t.add(s)}if(i)for(a=e.length;a--;)n(e[a],t);else if(Jn(e))n(e.value,t);else for(o=Object.keys(e),a=o.length;a--;)n(e[o[a]],t)}(n,Fe),Fe.clear(),n}var Qe,Ue=0,He=function(){function n(n,e,t,a,r){var o,i;o=this,void 0===(i=Fn&&!Fn._vm?Fn:n?n._scope:void 0)&&(i=Fn),i&&i.active&&i.effects.push(o),(this.vm=n)&&r&&(n._watcher=this),a?(this.deep=!!a.deep,this.user=!!a.user,this.lazy=!!a.lazy,this.sync=!!a.sync,this.before=a.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=t,this.id=++Ue,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new cn,this.newDepIds=new cn,this.expression="",c(e)?this.getter=e:(this.getter=function(n){if(!$.test(n)){var e=n.split(".");return function(n){for(var t=0;t<e.length;t++){if(!n)return;n=n[e[t]]}return n}}}(e),this.getter||(this.getter=P)),this.value=this.lazy?void 0:this.get()}return n.prototype.get=function(){var n;xn(this);var e=this.vm;try{n=this.getter.call(e,e)}catch(n){if(!this.user)throw n;je(n,e,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&Ne(n),wn(),this.cleanupDeps()}return n},n.prototype.addDep=function(n){var e=n.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(n),this.depIds.has(e)||n.addSub(this))},n.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var e=this.deps[n];this.newDepIds.has(e.id)||e.removeSub(this)}var t=this.depIds;this.depIds=this.newDepIds,this.newDepIds=t,this.newDepIds.clear(),t=this.deps,this.deps=this.newDeps,this.newDeps=t,this.newDeps.length=0},n.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():ut(this)},n.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||d(n)||this.deep){var e=this.value;if(this.value=n,this.user){var t='callback for watcher "'.concat(this.expression,'"');Ee(this.cb,this.vm,[n,e],this.vm,t)}else this.cb.call(this.vm,n,e)}}},n.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},n.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},n.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&k(this.vm._scope.effects,this),this.active){for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},n}();function $e(n,e){Qe.$on(n,e)}function Ge(n,e){Qe.$off(n,e)}function Ve(n,e){var t=Qe;return function a(){var r=e.apply(null,arguments);null!==r&&t.$off(n,a)}}function Xe(n,e,t){Qe=n,$n(e,t||{},$e,Ge,Ve,n),Qe=void 0}var Ke=null;function We(n){var e=Ke;return Ke=n,function(){Ke=e}}function Ze(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function Ye(n,e){if(e){if(n._directInactive=!1,Ze(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var t=0;t<n.$children.length;t++)Ye(n.$children[t]);nt(n,"activated")}}function nt(n,e,t,a){void 0===a&&(a=!0),xn();var r=pn;a&&un(n);var o=n.$options[e],i="".concat(e," hook");if(o)for(var s=0,l=o.length;s<l;s++)Ee(o[s],n,t||null,n,i);n._hasHookEvent&&n.$emit("hook:"+e),a&&un(r),wn()}var et=[],tt=[],at={},rt=!1,ot=!1,it=0;var st=0,lt=Date.now;if(V&&!K){var ct=window.performance;ct&&"function"==typeof ct.now&&lt()>document.createEvent("Event").timeStamp&&(lt=function(){return ct.now()})}var dt=function(n,e){if(n.post){if(!e.post)return 1}else if(e.post)return-1;return n.id-e.id};function pt(){var n,e;for(st=lt(),ot=!0,et.sort(dt),it=0;it<et.length;it++)(n=et[it]).before&&n.before(),e=n.id,at[e]=null,n.run();var t=tt.slice(),a=et.slice();it=et.length=tt.length=0,at={},rt=ot=!1,function(n){for(var e=0;e<n.length;e++)n[e]._inactive=!0,Ye(n[e],!0)}(t),function(n){var e=n.length;for(;e--;){var t=n[e],a=t.vm;a&&a._watcher===t&&a._isMounted&&!a._isDestroyed&&nt(a,"updated")}}(a),function(){for(var n=0;n<bn.length;n++){var e=bn[n];e.subs=e.subs.filter((function(n){return n})),e._pending=!1}bn.length=0}(),sn&&N.devtools&&sn.emit("flush")}function ut(n){var e=n.id;if(null==at[e]&&(n!==yn.target||!n.noRecurse)){if(at[e]=!0,ot){for(var t=et.length-1;t>it&&et[t].id>n.id;)t--;et.splice(t+1,0,n)}else et.push(n);rt||(rt=!0,Je(pt))}}function ht(n,e){if(n){for(var t=Object.create(null),a=dn?Reflect.ownKeys(n):Object.keys(n),r=0;r<a.length;r++){var o=a[r];if("__ob__"!==o){var i=n[o].from;if(i in e._provided)t[o]=e._provided[i];else if("default"in n[o]){var s=n[o].default;t[o]=c(s)?s.call(e):s}else 0}}return t}}function mt(n,e,t,o,i){var l,c=this,d=i.options;w(o,"_uid")?(l=Object.create(o))._original=o:(l=o,o=o._original);var p=s(d._compiled),u=!p;this.data=n,this.props=e,this.children=t,this.parent=o,this.listeners=n.on||a,this.injections=ht(d.inject,o),this.slots=function(){return c.$slots||fe(o,n.scopedSlots,c.$slots=ue(t,o)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return fe(o,n.scopedSlots,this.slots())}}),p&&(this.$options=d,this.$slots=this.slots(),this.$scopedSlots=fe(o,n.scopedSlots,this.$slots)),d._scopeId?this._c=function(n,e,t,a){var i=Ce(l,n,e,t,a,u);return i&&!r(i)&&(i.fnScopeId=d._scopeId,i.fnContext=o),i}:this._c=function(n,e,t,a){return Ce(l,n,e,t,a,u)}}function ft(n,e,t,a,r){var o=gn(n);return o.fnContext=t,o.fnOptions=a,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function gt(n,e){for(var t in e)n[C(t)]=e[t]}function vt(n){return n.name||n.__name||n._componentTag}pe(mt.prototype);var bt={init:function(n,e){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var t=n;bt.prepatch(t,t)}else{(n.componentInstance=function(n,e){var t={_isComponent:!0,_parentVnode:n,parent:e},a=n.data.inlineTemplate;i(a)&&(t.render=a.render,t.staticRenderFns=a.staticRenderFns);return new n.componentOptions.Ctor(t)}(n,Ke)).$mount(e?n.elm:void 0,e)}},prepatch:function(n,e){var t=e.componentOptions;!function(n,e,t,r,o){var i=r.data.scopedSlots,s=n.$scopedSlots,l=!!(i&&!i.$stable||s!==a&&!s.$stable||i&&n.$scopedSlots.$key!==i.$key||!i&&n.$scopedSlots.$key),c=!!(o||n.$options._renderChildren||l),d=n.$vnode;n.$options._parentVnode=r,n.$vnode=r,n._vnode&&(n._vnode.parent=r),n.$options._renderChildren=o;var p=r.data.attrs||a;n._attrsProxy&&ye(n._attrsProxy,p,d.data&&d.data.attrs||a,n,"$attrs")&&(c=!0),n.$attrs=p,t=t||a;var u=n.$options._parentListeners;if(n._listenersProxy&&ye(n._listenersProxy,t,u||a,n,"$listeners"),n.$listeners=n.$options._parentListeners=t,Xe(n,t,u),e&&n.$options.props){An(!1);for(var h=n._props,m=n.$options._propKeys||[],f=0;f<m.length;f++){var g=m[f],v=n.$options.props;h[g]=Lt(g,v,e,n)}An(!0),n.$options.propsData=e}c&&(n.$slots=ue(o,r.context),n.$forceUpdate())}(e.componentInstance=n.componentInstance,t.propsData,t.listeners,e,t.children)},insert:function(n){var e,t=n.context,a=n.componentInstance;a._isMounted||(a._isMounted=!0,nt(a,"mounted")),n.data.keepAlive&&(t._isMounted?((e=a)._inactive=!1,tt.push(e)):Ye(a,!0))},destroy:function(n){var e=n.componentInstance;e._isDestroyed||(n.data.keepAlive?function n(e,t){if(!(t&&(e._directInactive=!0,Ze(e))||e._inactive)){e._inactive=!0;for(var a=0;a<e.$children.length;a++)n(e.$children[a]);nt(e,"deactivated")}}(e,!0):e.$destroy())}},yt=Object.keys(bt);function kt(n,e,t,l,c){if(!o(n)){var p=t.$options._base;if(d(n)&&(n=p.extend(n)),"function"==typeof n){var u;if(o(n.cid)&&void 0===(n=function(n,e){if(s(n.error)&&i(n.errorComp))return n.errorComp;if(i(n.resolved))return n.resolved;var t=we;if(t&&i(n.owners)&&-1===n.owners.indexOf(t)&&n.owners.push(t),s(n.loading)&&i(n.loadingComp))return n.loadingComp;if(t&&!i(n.owners)){var a=n.owners=[t],r=!0,l=null,c=null;t.$on("hook:destroyed",(function(){return k(a,t)}));var p=function(n){for(var e=0,t=a.length;e<t;e++)a[e].$forceUpdate();n&&(a.length=0,null!==l&&(clearTimeout(l),l=null),null!==c&&(clearTimeout(c),c=null))},u=D((function(t){n.resolved=Se(t,e),r?a.length=0:p(!0)})),h=D((function(e){i(n.errorComp)&&(n.error=!0,p(!0))})),m=n(u,h);return d(m)&&(f(m)?o(n.resolved)&&m.then(u,h):f(m.component)&&(m.component.then(u,h),i(m.error)&&(n.errorComp=Se(m.error,e)),i(m.loading)&&(n.loadingComp=Se(m.loading,e),0===m.delay?n.loading=!0:l=setTimeout((function(){l=null,o(n.resolved)&&o(n.error)&&(n.loading=!0,p(!1))}),m.delay||200)),i(m.timeout)&&(c=setTimeout((function(){c=null,o(n.resolved)&&h(null)}),m.timeout)))),r=!1,n.loading?n.loadingComp:n.resolved}}(u=n,p)))return function(n,e,t,a,r){var o=mn();return o.asyncFactory=n,o.asyncMeta={data:e,context:t,children:a,tag:r},o}(u,e,t,l,c);e=e||{},Ht(n),i(e.model)&&function(n,e){var t=n.model&&n.model.prop||"value",a=n.model&&n.model.event||"input";(e.attrs||(e.attrs={}))[t]=e.model.value;var o=e.on||(e.on={}),s=o[a],l=e.model.callback;i(s)?(r(s)?-1===s.indexOf(l):s!==l)&&(o[a]=[l].concat(s)):o[a]=l}(n.options,e);var h=function(n,e,t){var a=e.options.props;if(!o(a)){var r={},s=n.attrs,l=n.props;if(i(s)||i(l))for(var c in a){var d=A(c);Vn(r,l,c,d,!0)||Vn(r,s,c,d,!1)}return r}}(e,n);if(s(n.options.functional))return function(n,e,t,o,s){var l=n.options,c={},d=l.props;if(i(d))for(var p in d)c[p]=Lt(p,d,e||a);else i(t.attrs)&&gt(c,t.attrs),i(t.props)&&gt(c,t.props);var u=new mt(t,c,s,o,n),h=l.render.call(null,u._c,u);if(h instanceof hn)return ft(h,t,u.parent,l,u);if(r(h)){for(var m=Xn(h)||[],f=new Array(m.length),g=0;g<m.length;g++)f[g]=ft(m[g],t,u.parent,l,u);return f}}(n,h,e,t,l);var m=e.on;if(e.on=e.nativeOn,s(n.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(n){for(var e=n.hook||(n.hook={}),t=0;t<yt.length;t++){var a=yt[t],r=e[a],o=bt[a];r===o||r&&r._merged||(e[a]=r?xt(o,r):o)}}(e);var v=vt(n.options)||c;return new hn("vue-component-".concat(n.cid).concat(v?"-".concat(v):""),e,void 0,void 0,void 0,t,{Ctor:n,propsData:h,listeners:m,tag:c,children:l},u)}}}function xt(n,e){var t=function(t,a){n(t,a),e(t,a)};return t._merged=!0,t}var wt=P,St=N.optionMergeStrategies;function Tt(n,e,t){if(void 0===t&&(t=!0),!e)return n;for(var a,r,o,i=dn?Reflect.ownKeys(e):Object.keys(e),s=0;s<i.length;s++)"__ob__"!==(a=i[s])&&(r=n[a],o=e[a],t&&w(n,a)?r!==o&&u(r)&&u(o)&&Tt(r,o):Pn(n,a,o));return n}function Ct(n,e,t){return t?function(){var a=c(e)?e.call(t,t):e,r=c(n)?n.call(t,t):n;return a?Tt(a,r):r}:e?n?function(){return Tt(c(e)?e.call(this,this):e,c(n)?n.call(this,this):n)}:e:n}function jt(n,e){var t=e?n?n.concat(e):r(e)?e:[e]:n;return t?function(n){for(var e=[],t=0;t<n.length;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}(t):t}function Et(n,e,t,a){var r=Object.create(n||null);return e?L(r,e):r}St.data=function(n,e,t){return t?Ct(n,e,t):e&&"function"!=typeof e?n:Ct(n,e)},F.forEach((function(n){St[n]=jt})),q.forEach((function(n){St[n+"s"]=Et})),St.watch=function(n,e,t,a){if(n===tn&&(n=void 0),e===tn&&(e=void 0),!e)return Object.create(n||null);if(!n)return e;var o={};for(var i in L(o,n),e){var s=o[i],l=e[i];s&&!r(s)&&(s=[s]),o[i]=s?s.concat(l):r(l)?l:[l]}return o},St.props=St.methods=St.inject=St.computed=function(n,e,t,a){if(!n)return e;var r=Object.create(null);return L(r,n),e&&L(r,e),r},St.provide=function(n,e){return n?function(){var t=Object.create(null);return Tt(t,c(n)?n.call(this):n),e&&Tt(t,c(e)?e.call(this):e,!1),t}:e};var At=function(n,e){return void 0===e?n:e};function It(n,e,t){if(c(e)&&(e=e.options),function(n,e){var t=n.props;if(t){var a,o,i={};if(r(t))for(a=t.length;a--;)"string"==typeof(o=t[a])&&(i[C(o)]={type:null});else if(u(t))for(var s in t)o=t[s],i[C(s)]=u(o)?o:{type:o};else 0;n.props=i}}(e),function(n,e){var t=n.inject;if(t){var a=n.inject={};if(r(t))for(var o=0;o<t.length;o++)a[t[o]]={from:t[o]};else if(u(t))for(var i in t){var s=t[i];a[i]=u(s)?L({from:i},s):{from:s}}else 0}}(e),function(n){var e=n.directives;if(e)for(var t in e){var a=e[t];c(a)&&(e[t]={bind:a,update:a})}}(e),!e._base&&(e.extends&&(n=It(n,e.extends,t)),e.mixins))for(var a=0,o=e.mixins.length;a<o;a++)n=It(n,e.mixins[a],t);var i,s={};for(i in n)l(i);for(i in e)w(n,i)||l(i);function l(a){var r=St[a]||At;s[a]=r(n[a],e[a],t,a)}return s}function _t(n,e,t,a){if("string"==typeof t){var r=n[e];if(w(r,t))return r[t];var o=C(t);if(w(r,o))return r[o];var i=j(o);return w(r,i)?r[i]:r[t]||r[o]||r[i]}}function Lt(n,e,t,a){var r=e[n],o=!w(t,n),i=t[n],s=Mt(Boolean,r.type);if(s>-1)if(o&&!w(r,"default"))i=!1;else if(""===i||i===A(n)){var l=Mt(String,r.type);(l<0||s<l)&&(i=!0)}if(void 0===i){i=function(n,e,t){if(!w(e,"default"))return;var a=e.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[t]&&void 0!==n._props[t])return n._props[t];return c(a)&&"Function"!==Pt(e.type)?a.call(n):a}(a,r,n);var d=En;An(!0),Ln(i),An(d)}return i}var zt=/^\s*function (\w+)/;function Pt(n){var e=n&&n.toString().match(zt);return e?e[1]:""}function Bt(n,e){return Pt(n)===Pt(e)}function Mt(n,e){if(!r(e))return Bt(e,n)?0:-1;for(var t=0,a=e.length;t<a;t++)if(Bt(e[t],n))return t;return-1}var Ot={enumerable:!0,configurable:!0,get:P,set:P};function Rt(n,e,t){Ot.get=function(){return this[e][t]},Ot.set=function(n){this[e][t]=n},Object.defineProperty(n,t,Ot)}function Dt(n){var e=n.$options;if(e.props&&function(n,e){var t=n.$options.propsData||{},a=n._props=On({}),r=n.$options._propKeys=[];n.$parent&&An(!1);var o=function(o){r.push(o);var i=Lt(o,e,t,n);zn(a,o,i),o in n||Rt(n,"_props",o)};for(var i in e)o(i);An(!0)}(n,e.props),function(n){var e=n.$options,t=e.setup;if(t){var a=n._setupContext=be(n);un(n),xn();var r=Ee(t,null,[n._props||On({}),a],n,"setup");if(wn(),un(),c(r))e.render=r;else if(d(r))if(n._setupState=r,r.__sfc){var o=n._setupProxy={};for(var i in r)"__sfc"!==i&&qn(o,r,i)}else for(var i in r)U(i)||qn(n,r,i);else 0}}(n),e.methods&&function(n,e){n.$options.props;for(var t in e)n[t]="function"!=typeof e[t]?P:I(e[t],n)}(n,e.methods),e.data)!function(n){var e=n.$options.data;u(e=n._data=c(e)?function(n,e){xn();try{return n.call(e,e)}catch(n){return je(n,e,"data()"),{}}finally{wn()}}(e,n):e||{})||(e={});var t=Object.keys(e),a=n.$options.props,r=(n.$options.methods,t.length);for(;r--;){var o=t[r];0,a&&w(a,o)||U(o)||Rt(n,"_data",o)}var i=Ln(e);i&&i.vmCount++}(n);else{var t=Ln(n._data={});t&&t.vmCount++}e.computed&&function(n,e){var t=n._computedWatchers=Object.create(null),a=on();for(var r in e){var o=e[r],i=c(o)?o:o.get;0,a||(t[r]=new He(n,i||P,P,Jt)),r in n||qt(n,r,o)}}(n,e.computed),e.watch&&e.watch!==tn&&function(n,e){for(var t in e){var a=e[t];if(r(a))for(var o=0;o<a.length;o++)Qt(n,t,a[o]);else Qt(n,t,a)}}(n,e.watch)}var Jt={lazy:!0};function qt(n,e,t){var a=!on();c(t)?(Ot.get=a?Ft(e):Nt(t),Ot.set=P):(Ot.get=t.get?a&&!1!==t.cache?Ft(e):Nt(t.get):P,Ot.set=t.set||P),Object.defineProperty(n,e,Ot)}function Ft(n){return function(){var e=this._computedWatchers&&this._computedWatchers[n];if(e)return e.dirty&&e.evaluate(),yn.target&&e.depend(),e.value}}function Nt(n){return function(){return n.call(this,this)}}function Qt(n,e,t,a){return u(t)&&(a=t,t=t.handler),"string"==typeof t&&(t=n[t]),n.$watch(e,t,a)}var Ut=0;function Ht(n){var e=n.options;if(n.super){var t=Ht(n.super);if(t!==n.superOptions){n.superOptions=t;var a=function(n){var e,t=n.options,a=n.sealedOptions;for(var r in t)t[r]!==a[r]&&(e||(e={}),e[r]=t[r]);return e}(n);a&&L(n.extendOptions,a),(e=n.options=It(t,n.extendOptions)).name&&(e.components[e.name]=n)}}return e}function $t(n){this._init(n)}function Gt(n){n.cid=0;var e=1;n.extend=function(n){n=n||{};var t=this,a=t.cid,r=n._Ctor||(n._Ctor={});if(r[a])return r[a];var o=vt(n)||vt(t.options);var i=function(n){this._init(n)};return(i.prototype=Object.create(t.prototype)).constructor=i,i.cid=e++,i.options=It(t.options,n),i.super=t,i.options.props&&function(n){var e=n.options.props;for(var t in e)Rt(n.prototype,"_props",t)}(i),i.options.computed&&function(n){var e=n.options.computed;for(var t in e)qt(n.prototype,t,e[t])}(i),i.extend=t.extend,i.mixin=t.mixin,i.use=t.use,q.forEach((function(n){i[n]=t[n]})),o&&(i.options.components[o]=i),i.superOptions=t.options,i.extendOptions=n,i.sealedOptions=L({},i.options),r[a]=i,i}}function Vt(n){return n&&(vt(n.Ctor.options)||n.tag)}function Xt(n,e){return r(n)?n.indexOf(e)>-1:"string"==typeof n?n.split(",").indexOf(e)>-1:!!h(n)&&n.test(e)}function Kt(n,e){var t=n.cache,a=n.keys,r=n._vnode;for(var o in t){var i=t[o];if(i){var s=i.name;s&&!e(s)&&Wt(t,o,a,r)}}}function Wt(n,e,t,a){var r=n[e];!r||a&&r.tag===a.tag||r.componentInstance.$destroy(),n[e]=null,k(t,e)}!function(n){n.prototype._init=function(n){var e=this;e._uid=Ut++,e._isVue=!0,e.__v_skip=!0,e._scope=new Nn(!0),e._scope._vm=!0,n&&n._isComponent?function(n,e){var t=n.$options=Object.create(n.constructor.options),a=e._parentVnode;t.parent=e.parent,t._parentVnode=a;var r=a.componentOptions;t.propsData=r.propsData,t._parentListeners=r.listeners,t._renderChildren=r.children,t._componentTag=r.tag,e.render&&(t.render=e.render,t.staticRenderFns=e.staticRenderFns)}(e,n):e.$options=It(Ht(e.constructor),n||{},e),e._renderProxy=e,e._self=e,function(n){var e=n.$options,t=e.parent;if(t&&!e.abstract){for(;t.$options.abstract&&t.$parent;)t=t.$parent;t.$children.push(n)}n.$parent=t,n.$root=t?t.$root:n,n.$children=[],n.$refs={},n._provided=t?t._provided:Object.create(null),n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(e),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var e=n.$options._parentListeners;e&&Xe(n,e)}(e),function(n){n._vnode=null,n._staticTrees=null;var e=n.$options,t=n.$vnode=e._parentVnode,r=t&&t.context;n.$slots=ue(e._renderChildren,r),n.$scopedSlots=t?fe(n.$parent,t.data.scopedSlots,n.$slots):a,n._c=function(e,t,a,r){return Ce(n,e,t,a,r,!1)},n.$createElement=function(e,t,a,r){return Ce(n,e,t,a,r,!0)};var o=t&&t.data;zn(n,"$attrs",o&&o.attrs||a,null,!0),zn(n,"$listeners",e._parentListeners||a,null,!0)}(e),nt(e,"beforeCreate",void 0,!1),function(n){var e=ht(n.$options.inject,n);e&&(An(!1),Object.keys(e).forEach((function(t){zn(n,t,e[t])})),An(!0))}(e),Dt(e),function(n){var e=n.$options.provide;if(e){var t=c(e)?e.call(n):e;if(!d(t))return;for(var a=Qn(n),r=dn?Reflect.ownKeys(t):Object.keys(t),o=0;o<r.length;o++){var i=r[o];Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(t,i))}}}(e),nt(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}($t),function(n){var e={get:function(){return this._data}},t={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",e),Object.defineProperty(n.prototype,"$props",t),n.prototype.$set=Pn,n.prototype.$delete=Bn,n.prototype.$watch=function(n,e,t){if(u(e))return Qt(this,n,e,t);(t=t||{}).user=!0;var a=new He(this,n,e,t);if(t.immediate){var r='callback for immediate watcher "'.concat(a.expression,'"');xn(),Ee(e,this,[a.value],this,r),wn()}return function(){a.teardown()}}}($t),function(n){var e=/^hook:/;n.prototype.$on=function(n,t){var a=this;if(r(n))for(var o=0,i=n.length;o<i;o++)a.$on(n[o],t);else(a._events[n]||(a._events[n]=[])).push(t),e.test(n)&&(a._hasHookEvent=!0);return a},n.prototype.$once=function(n,e){var t=this;function a(){t.$off(n,a),e.apply(t,arguments)}return a.fn=e,t.$on(n,a),t},n.prototype.$off=function(n,e){var t=this;if(!arguments.length)return t._events=Object.create(null),t;if(r(n)){for(var a=0,o=n.length;a<o;a++)t.$off(n[a],e);return t}var i,s=t._events[n];if(!s)return t;if(!e)return t._events[n]=null,t;for(var l=s.length;l--;)if((i=s[l])===e||i.fn===e){s.splice(l,1);break}return t},n.prototype.$emit=function(n){var e=this,t=e._events[n];if(t){t=t.length>1?_(t):t;for(var a=_(arguments,1),r='event handler for "'.concat(n,'"'),o=0,i=t.length;o<i;o++)Ee(t[o],e,a,e,r)}return e}}($t),function(n){n.prototype._update=function(n,e){var t=this,a=t.$el,r=t._vnode,o=We(t);t._vnode=n,t.$el=r?t.__patch__(r,n):t.__patch__(t.$el,n,e,!1),o(),a&&(a.__vue__=null),t.$el&&(t.$el.__vue__=t);for(var i=t;i&&i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode;)i.$parent.$el=i.$el,i=i.$parent},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){nt(n,"beforeDestroy"),n._isBeingDestroyed=!0;var e=n.$parent;!e||e._isBeingDestroyed||n.$options.abstract||k(e.$children,n),n._scope.stop(),n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),nt(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}($t),function(n){pe(n.prototype),n.prototype.$nextTick=function(n){return Je(n,this)},n.prototype._render=function(){var n,e=this,t=e.$options,a=t.render,o=t._parentVnode;o&&e._isMounted&&(e.$scopedSlots=fe(e.$parent,o.data.scopedSlots,e.$slots,e.$scopedSlots),e._slotsProxy&&xe(e._slotsProxy,e.$scopedSlots)),e.$vnode=o;try{un(e),we=e,n=a.call(e._renderProxy,e.$createElement)}catch(t){je(t,e,"render"),n=e._vnode}finally{we=null,un()}return r(n)&&1===n.length&&(n=n[0]),n instanceof hn||(n=mn()),n.parent=o,n}}($t);var Zt=[String,RegExp,Array],Yt={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Zt,exclude:Zt,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,e=this.keys,t=this.vnodeToCache,a=this.keyToCache;if(t){var r=t.tag,o=t.componentInstance,i=t.componentOptions;n[a]={name:Vt(i),tag:r,componentInstance:o},e.push(a),this.max&&e.length>parseInt(this.max)&&Wt(n,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)Wt(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(e){Kt(n,(function(n){return Xt(e,n)}))})),this.$watch("exclude",(function(e){Kt(n,(function(n){return!Xt(e,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,e=Te(n),t=e&&e.componentOptions;if(t){var a=Vt(t),r=this.include,o=this.exclude;if(r&&(!a||!Xt(r,a))||o&&a&&Xt(o,a))return e;var i=this.cache,s=this.keys,l=null==e.key?t.Ctor.cid+(t.tag?"::".concat(t.tag):""):e.key;i[l]?(e.componentInstance=i[l].componentInstance,k(s,l),s.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||n&&n[0]}}};!function(n){var e={get:function(){return N}};Object.defineProperty(n,"config",e),n.util={warn:wt,extend:L,mergeOptions:It,defineReactive:zn},n.set=Pn,n.delete=Bn,n.nextTick=Je,n.observable=function(n){return Ln(n),n},n.options=Object.create(null),q.forEach((function(e){n.options[e+"s"]=Object.create(null)})),n.options._base=n,L(n.options.components,Yt),function(n){n.use=function(n){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(n)>-1)return this;var t=_(arguments,1);return t.unshift(this),c(n.install)?n.install.apply(n,t):c(n)&&n.apply(null,t),e.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=It(this.options,n),this}}(n),Gt(n),function(n){q.forEach((function(e){n[e]=function(n,t){return t?("component"===e&&u(t)&&(t.name=t.name||n,t=this.options._base.extend(t)),"directive"===e&&c(t)&&(t={bind:t,update:t}),this.options[e+"s"][n]=t,t):this.options[e+"s"][n]}}))}(n)}($t),Object.defineProperty($t.prototype,"$isServer",{get:on}),Object.defineProperty($t.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty($t,"FunctionalRenderContext",{value:mt}),$t.version="2.7.14";var na=b("style,class"),ea=b("input,textarea,option,select,progress"),ta=b("contenteditable,draggable,spellcheck"),aa=b("events,caret,typing,plaintext-only"),ra=b("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),oa="http://www.w3.org/1999/xlink",ia=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},sa=function(n){return ia(n)?n.slice(6,n.length):""},la=function(n){return null==n||!1===n};function ca(n){for(var e=n.data,t=n,a=n;i(a.componentInstance);)(a=a.componentInstance._vnode)&&a.data&&(e=da(a.data,e));for(;i(t=t.parent);)t&&t.data&&(e=da(e,t.data));return function(n,e){if(i(n)||i(e))return pa(n,ua(e));return""}(e.staticClass,e.class)}function da(n,e){return{staticClass:pa(n.staticClass,e.staticClass),class:i(n.class)?[n.class,e.class]:e.class}}function pa(n,e){return n?e?n+" "+e:n:e||""}function ua(n){return Array.isArray(n)?function(n){for(var e,t="",a=0,r=n.length;a<r;a++)i(e=ua(n[a]))&&""!==e&&(t&&(t+=" "),t+=e);return t}(n):d(n)?function(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}(n):"string"==typeof n?n:""}var ha={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ma=b("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),fa=b("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ga=function(n){return ma(n)||fa(n)};var va=Object.create(null);var ba=b("text,number,password,search,email,tel,url");var ya=Object.freeze({__proto__:null,createElement:function(n,e){var t=document.createElement(n);return"select"!==n||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&t.setAttribute("multiple","multiple"),t},createElementNS:function(n,e){return document.createElementNS(ha[n],e)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,e,t){n.insertBefore(e,t)},removeChild:function(n,e){n.removeChild(e)},appendChild:function(n,e){n.appendChild(e)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,e){n.textContent=e},setStyleScope:function(n,e){n.setAttribute(e,"")}}),ka={create:function(n,e){xa(e)},update:function(n,e){n.data.ref!==e.data.ref&&(xa(n,!0),xa(e))},destroy:function(n){xa(n,!0)}};function xa(n,e){var t=n.data.ref;if(i(t)){var a=n.context,o=n.componentInstance||n.elm,s=e?null:o,l=e?void 0:o;if(c(t))Ee(t,a,[s],a,"template ref function");else{var d=n.data.refInFor,p="string"==typeof t||"number"==typeof t,u=Jn(t),h=a.$refs;if(p||u)if(d){var m=p?h[t]:t.value;e?r(m)&&k(m,o):r(m)?m.includes(o)||m.push(o):p?(h[t]=[o],wa(a,t,h[t])):t.value=[o]}else if(p){if(e&&h[t]!==o)return;h[t]=l,wa(a,t,s)}else if(u){if(e&&t.value!==o)return;t.value=s}else 0}}}function wa(n,e,t){var a=n._setupState;a&&w(a,e)&&(Jn(a[e])?a[e].value=t:a[e]=t)}var Sa=new hn("",{},[]),Ta=["create","activate","update","remove","destroy"];function Ca(n,e){return n.key===e.key&&n.asyncFactory===e.asyncFactory&&(n.tag===e.tag&&n.isComment===e.isComment&&i(n.data)===i(e.data)&&function(n,e){if("input"!==n.tag)return!0;var t,a=i(t=n.data)&&i(t=t.attrs)&&t.type,r=i(t=e.data)&&i(t=t.attrs)&&t.type;return a===r||ba(a)&&ba(r)}(n,e)||s(n.isAsyncPlaceholder)&&o(e.asyncFactory.error))}function ja(n,e,t){var a,r,o={};for(a=e;a<=t;++a)i(r=n[a].key)&&(o[r]=a);return o}var Ea={create:Aa,update:Aa,destroy:function(n){Aa(n,Sa)}};function Aa(n,e){(n.data.directives||e.data.directives)&&function(n,e){var t,a,r,o=n===Sa,i=e===Sa,s=_a(n.data.directives,n.context),l=_a(e.data.directives,e.context),c=[],d=[];for(t in l)a=s[t],r=l[t],a?(r.oldValue=a.value,r.oldArg=a.arg,za(r,"update",e,n),r.def&&r.def.componentUpdated&&d.push(r)):(za(r,"bind",e,n),r.def&&r.def.inserted&&c.push(r));if(c.length){var p=function(){for(var t=0;t<c.length;t++)za(c[t],"inserted",e,n)};o?Gn(e,"insert",p):p()}d.length&&Gn(e,"postpatch",(function(){for(var t=0;t<d.length;t++)za(d[t],"componentUpdated",e,n)}));if(!o)for(t in s)l[t]||za(s[t],"unbind",n,n,i)}(n,e)}var Ia=Object.create(null);function _a(n,e){var t,a,r=Object.create(null);if(!n)return r;for(t=0;t<n.length;t++){if((a=n[t]).modifiers||(a.modifiers=Ia),r[La(a)]=a,e._setupState&&e._setupState.__sfc){var o=a.def||_t(e,"_setupState","v-"+a.name);a.def="function"==typeof o?{bind:o,update:o}:o}a.def=a.def||_t(e.$options,"directives",a.name)}return r}function La(n){return n.rawName||"".concat(n.name,".").concat(Object.keys(n.modifiers||{}).join("."))}function za(n,e,t,a,r){var o=n.def&&n.def[e];if(o)try{o(t.elm,n,t,a,r)}catch(a){je(a,t.context,"directive ".concat(n.name," ").concat(e," hook"))}}var Pa=[ka,Ea];function Ba(n,e){var t=e.componentOptions;if(!(i(t)&&!1===t.Ctor.options.inheritAttrs||o(n.data.attrs)&&o(e.data.attrs))){var a,r,l=e.elm,c=n.data.attrs||{},d=e.data.attrs||{};for(a in(i(d.__ob__)||s(d._v_attr_proxy))&&(d=e.data.attrs=L({},d)),d)r=d[a],c[a]!==r&&Ma(l,a,r,e.data.pre);for(a in(K||Z)&&d.value!==c.value&&Ma(l,"value",d.value),c)o(d[a])&&(ia(a)?l.removeAttributeNS(oa,sa(a)):ta(a)||l.removeAttribute(a))}}function Ma(n,e,t,a){a||n.tagName.indexOf("-")>-1?Oa(n,e,t):ra(e)?la(t)?n.removeAttribute(e):(t="allowfullscreen"===e&&"EMBED"===n.tagName?"true":e,n.setAttribute(e,t)):ta(e)?n.setAttribute(e,function(n,e){return la(e)||"false"===e?"false":"contenteditable"===n&&aa(e)?e:"true"}(e,t)):ia(e)?la(t)?n.removeAttributeNS(oa,sa(e)):n.setAttributeNS(oa,e,t):Oa(n,e,t)}function Oa(n,e,t){if(la(t))n.removeAttribute(e);else{if(K&&!W&&"TEXTAREA"===n.tagName&&"placeholder"===e&&""!==t&&!n.__ieph){var a=function(e){e.stopImmediatePropagation(),n.removeEventListener("input",a)};n.addEventListener("input",a),n.__ieph=!0}n.setAttribute(e,t)}}var Ra={create:Ba,update:Ba};function Da(n,e){var t=e.elm,a=e.data,r=n.data;if(!(o(a.staticClass)&&o(a.class)&&(o(r)||o(r.staticClass)&&o(r.class)))){var s=ca(e),l=t._transitionClasses;i(l)&&(s=pa(s,ua(l))),s!==t._prevClass&&(t.setAttribute("class",s),t._prevClass=s)}}var Ja,qa={create:Da,update:Da};function Fa(n,e,t){var a=Ja;return function r(){var o=e.apply(null,arguments);null!==o&&Ua(n,r,t,a)}}var Na=Le&&!(en&&Number(en[1])<=53);function Qa(n,e,t,a){if(Na){var r=st,o=e;e=o._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=r||n.timeStamp<=0||n.target.ownerDocument!==document)return o.apply(this,arguments)}}Ja.addEventListener(n,e,an?{capture:t,passive:a}:t)}function Ua(n,e,t,a){(a||Ja).removeEventListener(n,e._wrapper||e,t)}function Ha(n,e){if(!o(n.data.on)||!o(e.data.on)){var t=e.data.on||{},a=n.data.on||{};Ja=e.elm||n.elm,function(n){if(i(n.__r)){var e=K?"change":"input";n[e]=[].concat(n.__r,n[e]||[]),delete n.__r}i(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(t),$n(t,a,Qa,Ua,Fa,e.context),Ja=void 0}}var $a,Ga={create:Ha,update:Ha,destroy:function(n){return Ha(n,Sa)}};function Va(n,e){if(!o(n.data.domProps)||!o(e.data.domProps)){var t,a,r=e.elm,l=n.data.domProps||{},c=e.data.domProps||{};for(t in(i(c.__ob__)||s(c._v_attr_proxy))&&(c=e.data.domProps=L({},c)),l)t in c||(r[t]="");for(t in c){if(a=c[t],"textContent"===t||"innerHTML"===t){if(e.children&&(e.children.length=0),a===l[t])continue;1===r.childNodes.length&&r.removeChild(r.childNodes[0])}if("value"===t&&"PROGRESS"!==r.tagName){r._value=a;var d=o(a)?"":String(a);Xa(r,d)&&(r.value=d)}else if("innerHTML"===t&&fa(r.tagName)&&o(r.innerHTML)){($a=$a||document.createElement("div")).innerHTML="<svg>".concat(a,"</svg>");for(var p=$a.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;p.firstChild;)r.appendChild(p.firstChild)}else if(a!==l[t])try{r[t]=a}catch(n){}}}}function Xa(n,e){return!n.composing&&("OPTION"===n.tagName||function(n,e){var t=!0;try{t=document.activeElement!==n}catch(n){}return t&&n.value!==e}(n,e)||function(n,e){var t=n.value,a=n._vModifiers;if(i(a)){if(a.number)return v(t)!==v(e);if(a.trim)return t.trim()!==e.trim()}return t!==e}(n,e))}var Ka={create:Va,update:Va},Wa=S((function(n){var e={},t=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var a=n.split(t);a.length>1&&(e[a[0].trim()]=a[1].trim())}})),e}));function Za(n){var e=Ya(n.style);return n.staticStyle?L(n.staticStyle,e):e}function Ya(n){return Array.isArray(n)?z(n):"string"==typeof n?Wa(n):n}var nr,er=/^--/,tr=/\s*!important$/,ar=function(n,e,t){if(er.test(e))n.style.setProperty(e,t);else if(tr.test(t))n.style.setProperty(A(e),t.replace(tr,""),"important");else{var a=or(e);if(Array.isArray(t))for(var r=0,o=t.length;r<o;r++)n.style[a]=t[r];else n.style[a]=t}},rr=["Webkit","Moz","ms"],or=S((function(n){if(nr=nr||document.createElement("div").style,"filter"!==(n=C(n))&&n in nr)return n;for(var e=n.charAt(0).toUpperCase()+n.slice(1),t=0;t<rr.length;t++){var a=rr[t]+e;if(a in nr)return a}}));function ir(n,e){var t=e.data,a=n.data;if(!(o(t.staticStyle)&&o(t.style)&&o(a.staticStyle)&&o(a.style))){var r,s,l=e.elm,c=a.staticStyle,d=a.normalizedStyle||a.style||{},p=c||d,u=Ya(e.data.style)||{};e.data.normalizedStyle=i(u.__ob__)?L({},u):u;var h=function(n,e){var t,a={};if(e)for(var r=n;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(t=Za(r.data))&&L(a,t);(t=Za(n.data))&&L(a,t);for(var o=n;o=o.parent;)o.data&&(t=Za(o.data))&&L(a,t);return a}(e,!0);for(s in p)o(h[s])&&ar(l,s,"");for(s in h)(r=h[s])!==p[s]&&ar(l,s,null==r?"":r)}}var sr={create:ir,update:ir},lr=/\s+/;function cr(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(lr).forEach((function(e){return n.classList.add(e)})):n.classList.add(e);else{var t=" ".concat(n.getAttribute("class")||""," ");t.indexOf(" "+e+" ")<0&&n.setAttribute("class",(t+e).trim())}}function dr(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(lr).forEach((function(e){return n.classList.remove(e)})):n.classList.remove(e),n.classList.length||n.removeAttribute("class");else{for(var t=" ".concat(n.getAttribute("class")||""," "),a=" "+e+" ";t.indexOf(a)>=0;)t=t.replace(a," ");(t=t.trim())?n.setAttribute("class",t):n.removeAttribute("class")}}function pr(n){if(n){if("object"==typeof n){var e={};return!1!==n.css&&L(e,ur(n.name||"v")),L(e,n),e}return"string"==typeof n?ur(n):void 0}}var ur=S((function(n){return{enterClass:"".concat(n,"-enter"),enterToClass:"".concat(n,"-enter-to"),enterActiveClass:"".concat(n,"-enter-active"),leaveClass:"".concat(n,"-leave"),leaveToClass:"".concat(n,"-leave-to"),leaveActiveClass:"".concat(n,"-leave-active")}})),hr=V&&!W,mr="transition",fr="transitionend",gr="animation",vr="animationend";hr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(mr="WebkitTransition",fr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(gr="WebkitAnimation",vr="webkitAnimationEnd"));var br=V?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function yr(n){br((function(){br(n)}))}function kr(n,e){var t=n._transitionClasses||(n._transitionClasses=[]);t.indexOf(e)<0&&(t.push(e),cr(n,e))}function xr(n,e){n._transitionClasses&&k(n._transitionClasses,e),dr(n,e)}function wr(n,e,t){var a=Tr(n,e),r=a.type,o=a.timeout,i=a.propCount;if(!r)return t();var s="transition"===r?fr:vr,l=0,c=function(){n.removeEventListener(s,d),t()},d=function(e){e.target===n&&++l>=i&&c()};setTimeout((function(){l<i&&c()}),o+1),n.addEventListener(s,d)}var Sr=/\b(transform|all)(,|$)/;function Tr(n,e){var t,a=window.getComputedStyle(n),r=(a[mr+"Delay"]||"").split(", "),o=(a[mr+"Duration"]||"").split(", "),i=Cr(r,o),s=(a[gr+"Delay"]||"").split(", "),l=(a[gr+"Duration"]||"").split(", "),c=Cr(s,l),d=0,p=0;return"transition"===e?i>0&&(t="transition",d=i,p=o.length):"animation"===e?c>0&&(t="animation",d=c,p=l.length):p=(t=(d=Math.max(i,c))>0?i>c?"transition":"animation":null)?"transition"===t?o.length:l.length:0,{type:t,timeout:d,propCount:p,hasTransform:"transition"===t&&Sr.test(a[mr+"Property"])}}function Cr(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max.apply(null,e.map((function(e,t){return jr(e)+jr(n[t])})))}function jr(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function Er(n,e){var t=n.elm;i(t._leaveCb)&&(t._leaveCb.cancelled=!0,t._leaveCb());var a=pr(n.data.transition);if(!o(a)&&!i(t._enterCb)&&1===t.nodeType){for(var r=a.css,s=a.type,l=a.enterClass,p=a.enterToClass,u=a.enterActiveClass,h=a.appearClass,m=a.appearToClass,f=a.appearActiveClass,g=a.beforeEnter,b=a.enter,y=a.afterEnter,k=a.enterCancelled,x=a.beforeAppear,w=a.appear,S=a.afterAppear,T=a.appearCancelled,C=a.duration,j=Ke,E=Ke.$vnode;E&&E.parent;)j=E.context,E=E.parent;var A=!j._isMounted||!n.isRootInsert;if(!A||w||""===w){var I=A&&h?h:l,_=A&&f?f:u,L=A&&m?m:p,z=A&&x||g,P=A&&c(w)?w:b,B=A&&S||y,M=A&&T||k,O=v(d(C)?C.enter:C);0;var R=!1!==r&&!W,J=_r(P),q=t._enterCb=D((function(){R&&(xr(t,L),xr(t,_)),q.cancelled?(R&&xr(t,I),M&&M(t)):B&&B(t),t._enterCb=null}));n.data.show||Gn(n,"insert",(function(){var e=t.parentNode,a=e&&e._pending&&e._pending[n.key];a&&a.tag===n.tag&&a.elm._leaveCb&&a.elm._leaveCb(),P&&P(t,q)})),z&&z(t),R&&(kr(t,I),kr(t,_),yr((function(){xr(t,I),q.cancelled||(kr(t,L),J||(Ir(O)?setTimeout(q,O):wr(t,s,q)))}))),n.data.show&&(e&&e(),P&&P(t,q)),R||J||q()}}}function Ar(n,e){var t=n.elm;i(t._enterCb)&&(t._enterCb.cancelled=!0,t._enterCb());var a=pr(n.data.transition);if(o(a)||1!==t.nodeType)return e();if(!i(t._leaveCb)){var r=a.css,s=a.type,l=a.leaveClass,c=a.leaveToClass,p=a.leaveActiveClass,u=a.beforeLeave,h=a.leave,m=a.afterLeave,f=a.leaveCancelled,g=a.delayLeave,b=a.duration,y=!1!==r&&!W,k=_r(h),x=v(d(b)?b.leave:b);0;var w=t._leaveCb=D((function(){t.parentNode&&t.parentNode._pending&&(t.parentNode._pending[n.key]=null),y&&(xr(t,c),xr(t,p)),w.cancelled?(y&&xr(t,l),f&&f(t)):(e(),m&&m(t)),t._leaveCb=null}));g?g(S):S()}function S(){w.cancelled||(!n.data.show&&t.parentNode&&((t.parentNode._pending||(t.parentNode._pending={}))[n.key]=n),u&&u(t),y&&(kr(t,l),kr(t,p),yr((function(){xr(t,l),w.cancelled||(kr(t,c),k||(Ir(x)?setTimeout(w,x):wr(t,s,w)))}))),h&&h(t,w),y||k||w())}}function Ir(n){return"number"==typeof n&&!isNaN(n)}function _r(n){if(o(n))return!1;var e=n.fns;return i(e)?_r(Array.isArray(e)?e[0]:e):(n._length||n.length)>1}function Lr(n,e){!0!==e.data.show&&Er(e)}var zr=function(n){var e,t,a={},c=n.modules,d=n.nodeOps;for(e=0;e<Ta.length;++e)for(a[Ta[e]]=[],t=0;t<c.length;++t)i(c[t][Ta[e]])&&a[Ta[e]].push(c[t][Ta[e]]);function p(n){var e=d.parentNode(n);i(e)&&d.removeChild(e,n)}function u(n,e,t,r,o,l,c){if(i(n.elm)&&i(l)&&(n=l[c]=gn(n)),n.isRootInsert=!o,!function(n,e,t,r){var o=n.data;if(i(o)){var l=i(n.componentInstance)&&o.keepAlive;if(i(o=o.hook)&&i(o=o.init)&&o(n,!1),i(n.componentInstance))return h(n,e),m(t,n.elm,r),s(l)&&function(n,e,t,r){var o,s=n;for(;s.componentInstance;)if(s=s.componentInstance._vnode,i(o=s.data)&&i(o=o.transition)){for(o=0;o<a.activate.length;++o)a.activate[o](Sa,s);e.push(s);break}m(t,n.elm,r)}(n,e,t,r),!0}}(n,e,t,r)){var p=n.data,u=n.children,g=n.tag;i(g)?(n.elm=n.ns?d.createElementNS(n.ns,g):d.createElement(g,n),y(n),f(n,u,e),i(p)&&v(n,e),m(t,n.elm,r)):s(n.isComment)?(n.elm=d.createComment(n.text),m(t,n.elm,r)):(n.elm=d.createTextNode(n.text),m(t,n.elm,r))}}function h(n,e){i(n.data.pendingInsert)&&(e.push.apply(e,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,g(n)?(v(n,e),y(n)):(xa(n),e.push(n))}function m(n,e,t){i(n)&&(i(t)?d.parentNode(t)===n&&d.insertBefore(n,e,t):d.appendChild(n,e))}function f(n,e,t){if(r(e)){0;for(var a=0;a<e.length;++a)u(e[a],t,n.elm,null,!0,e,a)}else l(n.text)&&d.appendChild(n.elm,d.createTextNode(String(n.text)))}function g(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return i(n.tag)}function v(n,t){for(var r=0;r<a.create.length;++r)a.create[r](Sa,n);i(e=n.data.hook)&&(i(e.create)&&e.create(Sa,n),i(e.insert)&&t.push(n))}function y(n){var e;if(i(e=n.fnScopeId))d.setStyleScope(n.elm,e);else for(var t=n;t;)i(e=t.context)&&i(e=e.$options._scopeId)&&d.setStyleScope(n.elm,e),t=t.parent;i(e=Ke)&&e!==n.context&&e!==n.fnContext&&i(e=e.$options._scopeId)&&d.setStyleScope(n.elm,e)}function k(n,e,t,a,r,o){for(;a<=r;++a)u(t[a],o,n,e,!1,t,a)}function x(n){var e,t,r=n.data;if(i(r))for(i(e=r.hook)&&i(e=e.destroy)&&e(n),e=0;e<a.destroy.length;++e)a.destroy[e](n);if(i(e=n.children))for(t=0;t<n.children.length;++t)x(n.children[t])}function w(n,e,t){for(;e<=t;++e){var a=n[e];i(a)&&(i(a.tag)?(S(a),x(a)):p(a.elm))}}function S(n,e){if(i(e)||i(n.data)){var t,r=a.remove.length+1;for(i(e)?e.listeners+=r:e=function(n,e){function t(){0==--t.listeners&&p(n)}return t.listeners=e,t}(n.elm,r),i(t=n.componentInstance)&&i(t=t._vnode)&&i(t.data)&&S(t,e),t=0;t<a.remove.length;++t)a.remove[t](n,e);i(t=n.data.hook)&&i(t=t.remove)?t(n,e):e()}else p(n.elm)}function T(n,e,t,a){for(var r=t;r<a;r++){var o=e[r];if(i(o)&&Ca(n,o))return r}}function C(n,e,t,r,l,c){if(n!==e){i(e.elm)&&i(r)&&(e=r[l]=gn(e));var p=e.elm=n.elm;if(s(n.isAsyncPlaceholder))i(e.asyncFactory.resolved)?A(n.elm,e,t):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(n.isStatic)&&e.key===n.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=n.componentInstance;else{var h,m=e.data;i(m)&&i(h=m.hook)&&i(h=h.prepatch)&&h(n,e);var f=n.children,v=e.children;if(i(m)&&g(e)){for(h=0;h<a.update.length;++h)a.update[h](n,e);i(h=m.hook)&&i(h=h.update)&&h(n,e)}o(e.text)?i(f)&&i(v)?f!==v&&function(n,e,t,a,r){var s,l,c,p=0,h=0,m=e.length-1,f=e[0],g=e[m],v=t.length-1,b=t[0],y=t[v],x=!r;for(0;p<=m&&h<=v;)o(f)?f=e[++p]:o(g)?g=e[--m]:Ca(f,b)?(C(f,b,a,t,h),f=e[++p],b=t[++h]):Ca(g,y)?(C(g,y,a,t,v),g=e[--m],y=t[--v]):Ca(f,y)?(C(f,y,a,t,v),x&&d.insertBefore(n,f.elm,d.nextSibling(g.elm)),f=e[++p],y=t[--v]):Ca(g,b)?(C(g,b,a,t,h),x&&d.insertBefore(n,g.elm,f.elm),g=e[--m],b=t[++h]):(o(s)&&(s=ja(e,p,m)),o(l=i(b.key)?s[b.key]:T(b,e,p,m))?u(b,a,n,f.elm,!1,t,h):Ca(c=e[l],b)?(C(c,b,a,t,h),e[l]=void 0,x&&d.insertBefore(n,c.elm,f.elm)):u(b,a,n,f.elm,!1,t,h),b=t[++h]);p>m?k(n,o(t[v+1])?null:t[v+1].elm,t,h,v,a):h>v&&w(e,p,m)}(p,f,v,t,c):i(v)?(i(n.text)&&d.setTextContent(p,""),k(p,null,v,0,v.length-1,t)):i(f)?w(f,0,f.length-1):i(n.text)&&d.setTextContent(p,""):n.text!==e.text&&d.setTextContent(p,e.text),i(m)&&i(h=m.hook)&&i(h=h.postpatch)&&h(n,e)}}}function j(n,e,t){if(s(t)&&i(n.parent))n.parent.data.pendingInsert=e;else for(var a=0;a<e.length;++a)e[a].data.hook.insert(e[a])}var E=b("attrs,class,staticClass,staticStyle,key");function A(n,e,t,a){var r,o=e.tag,l=e.data,c=e.children;if(a=a||l&&l.pre,e.elm=n,s(e.isComment)&&i(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(i(l)&&(i(r=l.hook)&&i(r=r.init)&&r(e,!0),i(r=e.componentInstance)))return h(e,t),!0;if(i(o)){if(i(c))if(n.hasChildNodes())if(i(r=l)&&i(r=r.domProps)&&i(r=r.innerHTML)){if(r!==n.innerHTML)return!1}else{for(var d=!0,p=n.firstChild,u=0;u<c.length;u++){if(!p||!A(p,c[u],t,a)){d=!1;break}p=p.nextSibling}if(!d||p)return!1}else f(e,c,t);if(i(l)){var m=!1;for(var g in l)if(!E(g)){m=!0,v(e,t);break}!m&&l.class&&Ne(l.class)}}else n.data!==e.text&&(n.data=e.text);return!0}return function(n,e,t,r){if(!o(e)){var l,c=!1,p=[];if(o(n))c=!0,u(e,p);else{var h=i(n.nodeType);if(!h&&Ca(n,e))C(n,e,p,null,null,r);else{if(h){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),t=!0),s(t)&&A(n,e,p))return j(e,p,!0),n;l=n,n=new hn(d.tagName(l).toLowerCase(),{},[],void 0,l)}var m=n.elm,f=d.parentNode(m);if(u(e,p,m._leaveCb?null:f,d.nextSibling(m)),i(e.parent))for(var v=e.parent,b=g(e);v;){for(var y=0;y<a.destroy.length;++y)a.destroy[y](v);if(v.elm=e.elm,b){for(var k=0;k<a.create.length;++k)a.create[k](Sa,v);var S=v.data.hook.insert;if(S.merged)for(var T=1;T<S.fns.length;T++)S.fns[T]()}else xa(v);v=v.parent}i(f)?w([n],0,0):i(n.tag)&&x(n)}}return j(e,p,c),e.elm}i(n)&&x(n)}}({nodeOps:ya,modules:[Ra,qa,Ga,Ka,sr,V?{create:Lr,activate:Lr,remove:function(n,e){!0!==n.data.show?Ar(n,e):e()}}:{}].concat(Pa)});W&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&qr(n,"input")}));var Pr={inserted:function(n,e,t,a){"select"===t.tag?(a.elm&&!a.elm._vOptions?Gn(t,"postpatch",(function(){Pr.componentUpdated(n,e,t)})):Br(n,e,t.context),n._vOptions=[].map.call(n.options,Rr)):("textarea"===t.tag||ba(n.type))&&(n._vModifiers=e.modifiers,e.modifiers.lazy||(n.addEventListener("compositionstart",Dr),n.addEventListener("compositionend",Jr),n.addEventListener("change",Jr),W&&(n.vmodel=!0)))},componentUpdated:function(n,e,t){if("select"===t.tag){Br(n,e,t.context);var a=n._vOptions,r=n._vOptions=[].map.call(n.options,Rr);if(r.some((function(n,e){return!O(n,a[e])})))(n.multiple?e.value.some((function(n){return Or(n,r)})):e.value!==e.oldValue&&Or(e.value,r))&&qr(n,"change")}}};function Br(n,e,t){Mr(n,e,t),(K||Z)&&setTimeout((function(){Mr(n,e,t)}),0)}function Mr(n,e,t){var a=e.value,r=n.multiple;if(!r||Array.isArray(a)){for(var o,i,s=0,l=n.options.length;s<l;s++)if(i=n.options[s],r)o=R(a,Rr(i))>-1,i.selected!==o&&(i.selected=o);else if(O(Rr(i),a))return void(n.selectedIndex!==s&&(n.selectedIndex=s));r||(n.selectedIndex=-1)}}function Or(n,e){return e.every((function(e){return!O(e,n)}))}function Rr(n){return"_value"in n?n._value:n.value}function Dr(n){n.target.composing=!0}function Jr(n){n.target.composing&&(n.target.composing=!1,qr(n.target,"input"))}function qr(n,e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}function Fr(n){return!n.componentInstance||n.data&&n.data.transition?n:Fr(n.componentInstance._vnode)}var Nr={model:Pr,show:{bind:function(n,e,t){var a=e.value,r=(t=Fr(t)).data&&t.data.transition,o=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;a&&r?(t.data.show=!0,Er(t,(function(){n.style.display=o}))):n.style.display=a?o:"none"},update:function(n,e,t){var a=e.value;!a!=!e.oldValue&&((t=Fr(t)).data&&t.data.transition?(t.data.show=!0,a?Er(t,(function(){n.style.display=n.__vOriginalDisplay})):Ar(t,(function(){n.style.display="none"}))):n.style.display=a?n.__vOriginalDisplay:"none")},unbind:function(n,e,t,a,r){r||(n.style.display=n.__vOriginalDisplay)}}},Qr={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Ur(n){var e=n&&n.componentOptions;return e&&e.Ctor.options.abstract?Ur(Te(e.children)):n}function Hr(n){var e={},t=n.$options;for(var a in t.propsData)e[a]=n[a];var r=t._parentListeners;for(var a in r)e[C(a)]=r[a];return e}function $r(n,e){if(/\d-keep-alive$/.test(e.tag))return n("keep-alive",{props:e.componentOptions.propsData})}var Gr=function(n){return n.tag||me(n)},Vr=function(n){return"show"===n.name},Xr={name:"transition",props:Qr,abstract:!0,render:function(n){var e=this,t=this.$slots.default;if(t&&(t=t.filter(Gr)).length){0;var a=this.mode;0;var r=t[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return r;var o=Ur(r);if(!o)return r;if(this._leaving)return $r(n,r);var i="__transition-".concat(this._uid,"-");o.key=null==o.key?o.isComment?i+"comment":i+o.tag:l(o.key)?0===String(o.key).indexOf(i)?o.key:i+o.key:o.key;var s=(o.data||(o.data={})).transition=Hr(this),c=this._vnode,d=Ur(c);if(o.data.directives&&o.data.directives.some(Vr)&&(o.data.show=!0),d&&d.data&&!function(n,e){return e.key===n.key&&e.tag===n.tag}(o,d)&&!me(d)&&(!d.componentInstance||!d.componentInstance._vnode.isComment)){var p=d.data.transition=L({},s);if("out-in"===a)return this._leaving=!0,Gn(p,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),$r(n,r);if("in-out"===a){if(me(o))return c;var u,h=function(){u()};Gn(s,"afterEnter",h),Gn(s,"enterCancelled",h),Gn(p,"delayLeave",(function(n){u=n}))}}return r}}},Kr=L({tag:String,moveClass:String},Qr);function Wr(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function Zr(n){n.data.newPos=n.elm.getBoundingClientRect()}function Yr(n){var e=n.data.pos,t=n.data.newPos,a=e.left-t.left,r=e.top-t.top;if(a||r){n.data.moved=!0;var o=n.elm.style;o.transform=o.WebkitTransform="translate(".concat(a,"px,").concat(r,"px)"),o.transitionDuration="0s"}}delete Kr.mode;var no={Transition:Xr,TransitionGroup:{props:Kr,beforeMount:function(){var n=this,e=this._update;this._update=function(t,a){var r=We(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,r(),e.call(n,t,a)}},render:function(n){for(var e=this.tag||this.$vnode.data.tag||"span",t=Object.create(null),a=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],i=Hr(this),s=0;s<r.length;s++){if((d=r[s]).tag)if(null!=d.key&&0!==String(d.key).indexOf("__vlist"))o.push(d),t[d.key]=d,(d.data||(d.data={})).transition=i;else;}if(a){var l=[],c=[];for(s=0;s<a.length;s++){var d;(d=a[s]).data.transition=i,d.data.pos=d.elm.getBoundingClientRect(),t[d.key]?l.push(d):c.push(d)}this.kept=n(e,null,l),this.removed=c}return n(e,null,o)},updated:function(){var n=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,e)&&(n.forEach(Wr),n.forEach(Zr),n.forEach(Yr),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var t=n.elm,a=t.style;kr(t,e),a.transform=a.WebkitTransform=a.transitionDuration="",t.addEventListener(fr,t._moveCb=function n(a){a&&a.target!==t||a&&!/transform$/.test(a.propertyName)||(t.removeEventListener(fr,n),t._moveCb=null,xr(t,e))})}})))},methods:{hasMove:function(n,e){if(!hr)return!1;if(this._hasMove)return this._hasMove;var t=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){dr(t,n)})),cr(t,e),t.style.display="none",this.$el.appendChild(t);var a=Tr(t);return this.$el.removeChild(t),this._hasMove=a.hasTransform}}}};function eo(n,e){for(var t in e)n[t]=e[t];return n}$t.config.mustUseProp=function(n,e,t){return"value"===t&&ea(n)&&"button"!==e||"selected"===t&&"option"===n||"checked"===t&&"input"===n||"muted"===t&&"video"===n},$t.config.isReservedTag=ga,$t.config.isReservedAttr=na,$t.config.getTagNamespace=function(n){return fa(n)?"svg":"math"===n?"math":void 0},$t.config.isUnknownElement=function(n){if(!V)return!0;if(ga(n))return!1;if(n=n.toLowerCase(),null!=va[n])return va[n];var e=document.createElement(n);return n.indexOf("-")>-1?va[n]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:va[n]=/HTMLUnknownElement/.test(e.toString())},L($t.options.directives,Nr),L($t.options.components,no),$t.prototype.__patch__=V?zr:P,$t.prototype.$mount=function(n,e){return function(n,e,t){var a;n.$el=e,n.$options.render||(n.$options.render=mn),nt(n,"beforeMount"),a=function(){n._update(n._render(),t)},new He(n,a,P,{before:function(){n._isMounted&&!n._isDestroyed&&nt(n,"beforeUpdate")}},!0),t=!1;var r=n._preWatchers;if(r)for(var o=0;o<r.length;o++)r[o].run();return null==n.$vnode&&(n._isMounted=!0,nt(n,"mounted")),n}(this,n=n&&V?function(n){if("string"==typeof n){var e=document.querySelector(n);return e||document.createElement("div")}return n}(n):void 0,e)},V&&setTimeout((function(){N.devtools&&sn&&sn.emit("init",$t)}),0);var to=/[!'()*]/g,ao=function(n){return"%"+n.charCodeAt(0).toString(16)},ro=/%2C/g,oo=function(n){return encodeURIComponent(n).replace(to,ao).replace(ro,",")};function io(n){try{return decodeURIComponent(n)}catch(n){0}return n}var so=function(n){return null==n||"object"==typeof n?n:String(n)};function lo(n){var e={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var t=n.replace(/\+/g," ").split("="),a=io(t.shift()),r=t.length>0?io(t.join("=")):null;void 0===e[a]?e[a]=r:Array.isArray(e[a])?e[a].push(r):e[a]=[e[a],r]})),e):e}function co(n){var e=n?Object.keys(n).map((function(e){var t=n[e];if(void 0===t)return"";if(null===t)return oo(e);if(Array.isArray(t)){var a=[];return t.forEach((function(n){void 0!==n&&(null===n?a.push(oo(e)):a.push(oo(e)+"="+oo(n)))})),a.join("&")}return oo(e)+"="+oo(t)})).filter((function(n){return n.length>0})).join("&"):null;return e?"?"+e:""}var po=/\/?$/;function uo(n,e,t,a){var r=a&&a.options.stringifyQuery,o=e.query||{};try{o=ho(o)}catch(n){}var i={name:e.name||n&&n.name,meta:n&&n.meta||{},path:e.path||"/",hash:e.hash||"",query:o,params:e.params||{},fullPath:go(e,r),matched:n?fo(n):[]};return t&&(i.redirectedFrom=go(t,r)),Object.freeze(i)}function ho(n){if(Array.isArray(n))return n.map(ho);if(n&&"object"==typeof n){var e={};for(var t in n)e[t]=ho(n[t]);return e}return n}var mo=uo(null,{path:"/"});function fo(n){for(var e=[];n;)e.unshift(n),n=n.parent;return e}function go(n,e){var t=n.path,a=n.query;void 0===a&&(a={});var r=n.hash;return void 0===r&&(r=""),(t||"/")+(e||co)(a)+r}function vo(n,e,t){return e===mo?n===e:!!e&&(n.path&&e.path?n.path.replace(po,"")===e.path.replace(po,"")&&(t||n.hash===e.hash&&bo(n.query,e.query)):!(!n.name||!e.name)&&(n.name===e.name&&(t||n.hash===e.hash&&bo(n.query,e.query)&&bo(n.params,e.params))))}function bo(n,e){if(void 0===n&&(n={}),void 0===e&&(e={}),!n||!e)return n===e;var t=Object.keys(n).sort(),a=Object.keys(e).sort();return t.length===a.length&&t.every((function(t,r){var o=n[t];if(a[r]!==t)return!1;var i=e[t];return null==o||null==i?o===i:"object"==typeof o&&"object"==typeof i?bo(o,i):String(o)===String(i)}))}function yo(n){for(var e=0;e<n.matched.length;e++){var t=n.matched[e];for(var a in t.instances){var r=t.instances[a],o=t.enteredCbs[a];if(r&&o){delete t.enteredCbs[a];for(var i=0;i<o.length;i++)r._isBeingDestroyed||o[i](r)}}}}var ko={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,e){var t=e.props,a=e.children,r=e.parent,o=e.data;o.routerView=!0;for(var i=r.$createElement,s=t.name,l=r.$route,c=r._routerViewCache||(r._routerViewCache={}),d=0,p=!1;r&&r._routerRoot!==r;){var u=r.$vnode?r.$vnode.data:{};u.routerView&&d++,u.keepAlive&&r._directInactive&&r._inactive&&(p=!0),r=r.$parent}if(o.routerViewDepth=d,p){var h=c[s],m=h&&h.component;return m?(h.configProps&&xo(m,o,h.route,h.configProps),i(m,o,a)):i()}var f=l.matched[d],g=f&&f.components[s];if(!f||!g)return c[s]=null,i();c[s]={component:g},o.registerRouteInstance=function(n,e){var t=f.instances[s];(e&&t!==n||!e&&t===n)&&(f.instances[s]=e)},(o.hook||(o.hook={})).prepatch=function(n,e){f.instances[s]=e.componentInstance},o.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==f.instances[s]&&(f.instances[s]=n.componentInstance),yo(l)};var v=f.props&&f.props[s];return v&&(eo(c[s],{route:l,configProps:v}),xo(g,o,l,v)),i(g,o,a)}};function xo(n,e,t,a){var r=e.props=function(n,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(n);case"boolean":return e?n.params:void 0;default:0}}(t,a);if(r){r=e.props=eo({},r);var o=e.attrs=e.attrs||{};for(var i in r)n.props&&i in n.props||(o[i]=r[i],delete r[i])}}function wo(n,e,t){var a=n.charAt(0);if("/"===a)return n;if("?"===a||"#"===a)return e+n;var r=e.split("/");t&&r[r.length-1]||r.pop();for(var o=n.replace(/^\//,"").split("/"),i=0;i<o.length;i++){var s=o[i];".."===s?r.pop():"."!==s&&r.push(s)}return""!==r[0]&&r.unshift(""),r.join("/")}function So(n){return n.replace(/\/(?:\s*\/)+/g,"/")}var To=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},Co=Jo,jo=Lo,Eo=function(n,e){return Po(Lo(n,e),e)},Ao=Po,Io=Do,_o=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Lo(n,e){for(var t,a=[],r=0,o=0,i="",s=e&&e.delimiter||"/";null!=(t=_o.exec(n));){var l=t[0],c=t[1],d=t.index;if(i+=n.slice(o,d),o=d+l.length,c)i+=c[1];else{var p=n[o],u=t[2],h=t[3],m=t[4],f=t[5],g=t[6],v=t[7];i&&(a.push(i),i="");var b=null!=u&&null!=p&&p!==u,y="+"===g||"*"===g,k="?"===g||"*"===g,x=t[2]||s,w=m||f;a.push({name:h||r++,prefix:u||"",delimiter:x,optional:k,repeat:y,partial:b,asterisk:!!v,pattern:w?Mo(w):v?".*":"[^"+Bo(x)+"]+?"})}}return o<n.length&&(i+=n.substr(o)),i&&a.push(i),a}function zo(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function Po(n,e){for(var t=new Array(n.length),a=0;a<n.length;a++)"object"==typeof n[a]&&(t[a]=new RegExp("^(?:"+n[a].pattern+")$",Ro(e)));return function(e,a){for(var r="",o=e||{},i=(a||{}).pretty?zo:encodeURIComponent,s=0;s<n.length;s++){var l=n[s];if("string"!=typeof l){var c,d=o[l.name];if(null==d){if(l.optional){l.partial&&(r+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(To(d)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var p=0;p<d.length;p++){if(c=i(d[p]),!t[s].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(c)+"`");r+=(0===p?l.prefix:l.delimiter)+c}}else{if(c=l.asterisk?encodeURI(d).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):i(d),!t[s].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');r+=l.prefix+c}}else r+=l}return r}}function Bo(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function Mo(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function Oo(n,e){return n.keys=e,n}function Ro(n){return n&&n.sensitive?"":"i"}function Do(n,e,t){To(e)||(t=e||t,e=[]);for(var a=(t=t||{}).strict,r=!1!==t.end,o="",i=0;i<n.length;i++){var s=n[i];if("string"==typeof s)o+=Bo(s);else{var l=Bo(s.prefix),c="(?:"+s.pattern+")";e.push(s),s.repeat&&(c+="(?:"+l+c+")*"),o+=c=s.optional?s.partial?l+"("+c+")?":"(?:"+l+"("+c+"))?":l+"("+c+")"}}var d=Bo(t.delimiter||"/"),p=o.slice(-d.length)===d;return a||(o=(p?o.slice(0,-d.length):o)+"(?:"+d+"(?=$))?"),o+=r?"$":a&&p?"":"(?="+d+"|$)",Oo(new RegExp("^"+o,Ro(t)),e)}function Jo(n,e,t){return To(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?function(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var a=0;a<t.length;a++)e.push({name:a,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Oo(n,e)}(n,e):To(n)?function(n,e,t){for(var a=[],r=0;r<n.length;r++)a.push(Jo(n[r],e,t).source);return Oo(new RegExp("(?:"+a.join("|")+")",Ro(t)),e)}(n,e,t):function(n,e,t){return Do(Lo(n,t),e,t)}(n,e,t)}Co.parse=jo,Co.compile=Eo,Co.tokensToFunction=Ao,Co.tokensToRegExp=Io;var qo=Object.create(null);function Fo(n,e,t){e=e||{};try{var a=qo[n]||(qo[n]=Co.compile(n));return"string"==typeof e.pathMatch&&(e[0]=e.pathMatch),a(e,{pretty:!0})}catch(n){return""}finally{delete e[0]}}function No(n,e,t,a){var r="string"==typeof n?{path:n}:n;if(r._normalized)return r;if(r.name){var o=(r=eo({},n)).params;return o&&"object"==typeof o&&(r.params=eo({},o)),r}if(!r.path&&r.params&&e){(r=eo({},r))._normalized=!0;var i=eo(eo({},e.params),r.params);if(e.name)r.name=e.name,r.params=i;else if(e.matched.length){var s=e.matched[e.matched.length-1].path;r.path=Fo(s,i,e.path)}else 0;return r}var l=function(n){var e="",t="",a=n.indexOf("#");a>=0&&(e=n.slice(a),n=n.slice(0,a));var r=n.indexOf("?");return r>=0&&(t=n.slice(r+1),n=n.slice(0,r)),{path:n,query:t,hash:e}}(r.path||""),c=e&&e.path||"/",d=l.path?wo(l.path,c,t||r.append):c,p=function(n,e,t){void 0===e&&(e={});var a,r=t||lo;try{a=r(n||"")}catch(n){a={}}for(var o in e){var i=e[o];a[o]=Array.isArray(i)?i.map(so):so(i)}return a}(l.query,r.query,a&&a.options.parseQuery),u=r.hash||l.hash;return u&&"#"!==u.charAt(0)&&(u="#"+u),{_normalized:!0,path:d,query:p,hash:u}}var Qo,Uo=function(){},Ho={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var e=this,t=this.$router,a=this.$route,r=t.resolve(this.to,a,this.append),o=r.location,i=r.route,s=r.href,l={},c=t.options.linkActiveClass,d=t.options.linkExactActiveClass,p=null==c?"router-link-active":c,u=null==d?"router-link-exact-active":d,h=null==this.activeClass?p:this.activeClass,m=null==this.exactActiveClass?u:this.exactActiveClass,f=i.redirectedFrom?uo(null,No(i.redirectedFrom),null,t):i;l[m]=vo(a,f,this.exactPath),l[h]=this.exact||this.exactPath?l[m]:function(n,e){return 0===n.path.replace(po,"/").indexOf(e.path.replace(po,"/"))&&(!e.hash||n.hash===e.hash)&&function(n,e){for(var t in e)if(!(t in n))return!1;return!0}(n.query,e.query)}(a,f);var g=l[m]?this.ariaCurrentValue:null,v=function(n){$o(n)&&(e.replace?t.replace(o,Uo):t.push(o,Uo))},b={click:$o};Array.isArray(this.event)?this.event.forEach((function(n){b[n]=v})):b[this.event]=v;var y={class:l},k=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:s,route:i,navigate:v,isActive:l[h],isExactActive:l[m]});if(k){if(1===k.length)return k[0];if(k.length>1||!k.length)return 0===k.length?n():n("span",{},k)}if("a"===this.tag)y.on=b,y.attrs={href:s,"aria-current":g};else{var x=function n(e){var t;if(e)for(var a=0;a<e.length;a++){if("a"===(t=e[a]).tag)return t;if(t.children&&(t=n(t.children)))return t}}(this.$slots.default);if(x){x.isStatic=!1;var w=x.data=eo({},x.data);for(var S in w.on=w.on||{},w.on){var T=w.on[S];S in b&&(w.on[S]=Array.isArray(T)?T:[T])}for(var C in b)C in w.on?w.on[C].push(b[C]):w.on[C]=v;var j=x.data.attrs=eo({},x.data.attrs);j.href=s,j["aria-current"]=g}else y.on=b}return n(this.tag,y,this.$slots.default)}};function $o(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}var Go="undefined"!=typeof window;function Vo(n,e,t,a,r){var o=e||[],i=t||Object.create(null),s=a||Object.create(null);n.forEach((function(n){!function n(e,t,a,r,o,i){var s=r.path,l=r.name;0;var c=r.pathToRegexpOptions||{},d=function(n,e,t){t||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==e)return n;return So(e.path+"/"+n)}(s,o,c.strict);"boolean"==typeof r.caseSensitive&&(c.sensitive=r.caseSensitive);var p={path:d,regex:Xo(d,c),components:r.components||{default:r.component},alias:r.alias?"string"==typeof r.alias?[r.alias]:r.alias:[],instances:{},enteredCbs:{},name:l,parent:o,matchAs:i,redirect:r.redirect,beforeEnter:r.beforeEnter,meta:r.meta||{},props:null==r.props?{}:r.components?r.props:{default:r.props}};r.children&&r.children.forEach((function(r){var o=i?So(i+"/"+r.path):void 0;n(e,t,a,r,p,o)}));t[p.path]||(e.push(p.path),t[p.path]=p);if(void 0!==r.alias)for(var u=Array.isArray(r.alias)?r.alias:[r.alias],h=0;h<u.length;++h){0;var m={path:u[h],children:r.children};n(e,t,a,m,o,p.path||"/")}l&&(a[l]||(a[l]=p))}(o,i,s,n,r)}));for(var l=0,c=o.length;l<c;l++)"*"===o[l]&&(o.push(o.splice(l,1)[0]),c--,l--);return{pathList:o,pathMap:i,nameMap:s}}function Xo(n,e){return Co(n,[],e)}function Ko(n,e){var t=Vo(n),a=t.pathList,r=t.pathMap,o=t.nameMap;function i(n,t,i){var s=No(n,t,!1,e),c=s.name;if(c){var d=o[c];if(!d)return l(null,s);var p=d.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof s.params&&(s.params={}),t&&"object"==typeof t.params)for(var u in t.params)!(u in s.params)&&p.indexOf(u)>-1&&(s.params[u]=t.params[u]);return s.path=Fo(d.path,s.params),l(d,s,i)}if(s.path){s.params={};for(var h=0;h<a.length;h++){var m=a[h],f=r[m];if(Wo(f.regex,s.path,s.params))return l(f,s,i)}}return l(null,s)}function s(n,t){var a=n.redirect,r="function"==typeof a?a(uo(n,t,null,e)):a;if("string"==typeof r&&(r={path:r}),!r||"object"!=typeof r)return l(null,t);var s=r,c=s.name,d=s.path,p=t.query,u=t.hash,h=t.params;if(p=s.hasOwnProperty("query")?s.query:p,u=s.hasOwnProperty("hash")?s.hash:u,h=s.hasOwnProperty("params")?s.params:h,c){o[c];return i({_normalized:!0,name:c,query:p,hash:u,params:h},void 0,t)}if(d){var m=function(n,e){return wo(n,e.parent?e.parent.path:"/",!0)}(d,n);return i({_normalized:!0,path:Fo(m,h),query:p,hash:u},void 0,t)}return l(null,t)}function l(n,t,a){return n&&n.redirect?s(n,a||t):n&&n.matchAs?function(n,e,t){var a=i({_normalized:!0,path:Fo(t,e.params)});if(a){var r=a.matched,o=r[r.length-1];return e.params=a.params,l(o,e)}return l(null,e)}(0,t,n.matchAs):uo(n,t,a,e)}return{match:i,addRoute:function(n,e){var t="object"!=typeof n?o[n]:void 0;Vo([e||n],a,r,o,t),t&&t.alias.length&&Vo(t.alias.map((function(n){return{path:n,children:[e]}})),a,r,o,t)},getRoutes:function(){return a.map((function(n){return r[n]}))},addRoutes:function(n){Vo(n,a,r,o)}}}function Wo(n,e,t){var a=e.match(n);if(!a)return!1;if(!t)return!0;for(var r=1,o=a.length;r<o;++r){var i=n.keys[r-1];i&&(t[i.name||"pathMatch"]="string"==typeof a[r]?io(a[r]):a[r])}return!0}var Zo=Go&&window.performance&&window.performance.now?window.performance:Date;function Yo(){return Zo.now().toFixed(3)}var ni=Yo();function ei(){return ni}function ti(n){return ni=n}var ai=Object.create(null);function ri(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(n,""),t=eo({},window.history.state);return t.key=ei(),window.history.replaceState(t,"",e),window.addEventListener("popstate",si),function(){window.removeEventListener("popstate",si)}}function oi(n,e,t,a){if(n.app){var r=n.options.scrollBehavior;r&&n.app.$nextTick((function(){var o=function(){var n=ei();if(n)return ai[n]}(),i=r.call(n,e,t,a?o:null);i&&("function"==typeof i.then?i.then((function(n){ui(n,o)})).catch((function(n){0})):ui(i,o))}))}}function ii(){var n=ei();n&&(ai[n]={x:window.pageXOffset,y:window.pageYOffset})}function si(n){ii(),n.state&&n.state.key&&ti(n.state.key)}function li(n){return di(n.x)||di(n.y)}function ci(n){return{x:di(n.x)?n.x:window.pageXOffset,y:di(n.y)?n.y:window.pageYOffset}}function di(n){return"number"==typeof n}var pi=/^#\d/;function ui(n,e){var t,a="object"==typeof n;if(a&&"string"==typeof n.selector){var r=pi.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(r){var o=n.offset&&"object"==typeof n.offset?n.offset:{};e=function(n,e){var t=document.documentElement.getBoundingClientRect(),a=n.getBoundingClientRect();return{x:a.left-t.left-e.x,y:a.top-t.top-e.y}}(r,o={x:di((t=o).x)?t.x:0,y:di(t.y)?t.y:0})}else li(n)&&(e=ci(n))}else a&&li(n)&&(e=ci(n));e&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:e.x,top:e.y,behavior:n.behavior}):window.scrollTo(e.x,e.y))}var hi,mi=Go&&((-1===(hi=window.navigator.userAgent).indexOf("Android 2.")&&-1===hi.indexOf("Android 4.0")||-1===hi.indexOf("Mobile Safari")||-1!==hi.indexOf("Chrome")||-1!==hi.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function fi(n,e){ii();var t=window.history;try{if(e){var a=eo({},t.state);a.key=ei(),t.replaceState(a,"",n)}else t.pushState({key:ti(Yo())},"",n)}catch(t){window.location[e?"replace":"assign"](n)}}function gi(n){fi(n,!0)}var vi={redirected:2,aborted:4,cancelled:8,duplicated:16};function bi(n,e){return ki(n,e,vi.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var e={};return xi.forEach((function(t){t in n&&(e[t]=n[t])})),JSON.stringify(e,null,2)}(e)+'" via a navigation guard.')}function yi(n,e){return ki(n,e,vi.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+e.fullPath+'" with a new navigation.')}function ki(n,e,t,a){var r=new Error(a);return r._isRouter=!0,r.from=n,r.to=e,r.type=t,r}var xi=["params","query","hash"];function wi(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function Si(n,e){return wi(n)&&n._isRouter&&(null==e||n.type===e)}function Ti(n,e,t){var a=function(r){r>=n.length?t():n[r]?e(n[r],(function(){a(r+1)})):a(r+1)};a(0)}function Ci(n){return function(e,t,a){var r=!1,o=0,i=null;ji(n,(function(n,e,t,s){if("function"==typeof n&&void 0===n.cid){r=!0,o++;var l,c=Ii((function(e){var r;((r=e).__esModule||Ai&&"Module"===r[Symbol.toStringTag])&&(e=e.default),n.resolved="function"==typeof e?e:Qo.extend(e),t.components[s]=e,--o<=0&&a()})),d=Ii((function(n){var e="Failed to resolve async component "+s+": "+n;i||(i=wi(n)?n:new Error(e),a(i))}));try{l=n(c,d)}catch(n){d(n)}if(l)if("function"==typeof l.then)l.then(c,d);else{var p=l.component;p&&"function"==typeof p.then&&p.then(c,d)}}})),r||a()}}function ji(n,e){return Ei(n.map((function(n){return Object.keys(n.components).map((function(t){return e(n.components[t],n.instances[t],n,t)}))})))}function Ei(n){return Array.prototype.concat.apply([],n)}var Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function Ii(n){var e=!1;return function(){for(var t=[],a=arguments.length;a--;)t[a]=arguments[a];if(!e)return e=!0,n.apply(this,t)}}var _i=function(n,e){this.router=n,this.base=function(n){if(!n)if(Go){var e=document.querySelector("base");n=(n=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(e),this.current=mo,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function Li(n,e,t,a){var r=ji(n,(function(n,a,r,o){var i=function(n,e){"function"!=typeof n&&(n=Qo.extend(n));return n.options[e]}(n,e);if(i)return Array.isArray(i)?i.map((function(n){return t(n,a,r,o)})):t(i,a,r,o)}));return Ei(a?r.reverse():r)}function zi(n,e){if(e)return function(){return n.apply(e,arguments)}}_i.prototype.listen=function(n){this.cb=n},_i.prototype.onReady=function(n,e){this.ready?n():(this.readyCbs.push(n),e&&this.readyErrorCbs.push(e))},_i.prototype.onError=function(n){this.errorCbs.push(n)},_i.prototype.transitionTo=function(n,e,t){var a,r=this;try{a=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(e){e(n)})),n}var o=this.current;this.confirmTransition(a,(function(){r.updateRoute(a),e&&e(a),r.ensureURL(),r.router.afterHooks.forEach((function(n){n&&n(a,o)})),r.ready||(r.ready=!0,r.readyCbs.forEach((function(n){n(a)})))}),(function(n){t&&t(n),n&&!r.ready&&(Si(n,vi.redirected)&&o===mo||(r.ready=!0,r.readyErrorCbs.forEach((function(e){e(n)}))))}))},_i.prototype.confirmTransition=function(n,e,t){var a=this,r=this.current;this.pending=n;var o,i,s=function(n){!Si(n)&&wi(n)&&(a.errorCbs.length?a.errorCbs.forEach((function(e){e(n)})):console.error(n)),t&&t(n)},l=n.matched.length-1,c=r.matched.length-1;if(vo(n,r)&&l===c&&n.matched[l]===r.matched[c])return this.ensureURL(),n.hash&&oi(this.router,r,n,!1),s(((i=ki(o=r,n,vi.duplicated,'Avoided redundant navigation to current location: "'+o.fullPath+'".')).name="NavigationDuplicated",i));var d=function(n,e){var t,a=Math.max(n.length,e.length);for(t=0;t<a&&n[t]===e[t];t++);return{updated:e.slice(0,t),activated:e.slice(t),deactivated:n.slice(t)}}(this.current.matched,n.matched),p=d.updated,u=d.deactivated,h=d.activated,m=[].concat(function(n){return Li(n,"beforeRouteLeave",zi,!0)}(u),this.router.beforeHooks,function(n){return Li(n,"beforeRouteUpdate",zi)}(p),h.map((function(n){return n.beforeEnter})),Ci(h)),f=function(e,t){if(a.pending!==n)return s(yi(r,n));try{e(n,r,(function(e){!1===e?(a.ensureURL(!0),s(function(n,e){return ki(n,e,vi.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+e.fullPath+'" via a navigation guard.')}(r,n))):wi(e)?(a.ensureURL(!0),s(e)):"string"==typeof e||"object"==typeof e&&("string"==typeof e.path||"string"==typeof e.name)?(s(bi(r,n)),"object"==typeof e&&e.replace?a.replace(e):a.push(e)):t(e)}))}catch(n){s(n)}};Ti(m,f,(function(){Ti(function(n){return Li(n,"beforeRouteEnter",(function(n,e,t,a){return function(n,e,t){return function(a,r,o){return n(a,r,(function(n){"function"==typeof n&&(e.enteredCbs[t]||(e.enteredCbs[t]=[]),e.enteredCbs[t].push(n)),o(n)}))}}(n,t,a)}))}(h).concat(a.router.resolveHooks),f,(function(){if(a.pending!==n)return s(yi(r,n));a.pending=null,e(n),a.router.app&&a.router.app.$nextTick((function(){yo(n)}))}))}))},_i.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},_i.prototype.setupListeners=function(){},_i.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=mo,this.pending=null};var Pi=function(n){function e(e,t){n.call(this,e,t),this._startLocation=Bi(this.base)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router,t=e.options.scrollBehavior,a=mi&&t;a&&this.listeners.push(ri());var r=function(){var t=n.current,r=Bi(n.base);n.current===mo&&r===n._startLocation||n.transitionTo(r,(function(n){a&&oi(e,n,t,!0)}))};window.addEventListener("popstate",r),this.listeners.push((function(){window.removeEventListener("popstate",r)}))}},e.prototype.go=function(n){window.history.go(n)},e.prototype.push=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){fi(So(a.base+n.fullPath)),oi(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){gi(So(a.base+n.fullPath)),oi(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.ensureURL=function(n){if(Bi(this.base)!==this.current.fullPath){var e=So(this.base+this.current.fullPath);n?fi(e):gi(e)}},e.prototype.getCurrentLocation=function(){return Bi(this.base)},e}(_i);function Bi(n){var e=window.location.pathname,t=e.toLowerCase(),a=n.toLowerCase();return!n||t!==a&&0!==t.indexOf(So(a+"/"))||(e=e.slice(n.length)),(e||"/")+window.location.search+window.location.hash}var Mi=function(n){function e(e,t,a){n.call(this,e,t),a&&function(n){var e=Bi(n);if(!/^\/#/.test(e))return window.location.replace(So(n+"/#"+e)),!0}(this.base)||Oi()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router.options.scrollBehavior,t=mi&&e;t&&this.listeners.push(ri());var a=function(){var e=n.current;Oi()&&n.transitionTo(Ri(),(function(a){t&&oi(n.router,a,e,!0),mi||qi(a.fullPath)}))},r=mi?"popstate":"hashchange";window.addEventListener(r,a),this.listeners.push((function(){window.removeEventListener(r,a)}))}},e.prototype.push=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){Ji(n.fullPath),oi(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this,r=this.current;this.transitionTo(n,(function(n){qi(n.fullPath),oi(a.router,n,r,!1),e&&e(n)}),t)},e.prototype.go=function(n){window.history.go(n)},e.prototype.ensureURL=function(n){var e=this.current.fullPath;Ri()!==e&&(n?Ji(e):qi(e))},e.prototype.getCurrentLocation=function(){return Ri()},e}(_i);function Oi(){var n=Ri();return"/"===n.charAt(0)||(qi("/"+n),!1)}function Ri(){var n=window.location.href,e=n.indexOf("#");return e<0?"":n=n.slice(e+1)}function Di(n){var e=window.location.href,t=e.indexOf("#");return(t>=0?e.slice(0,t):e)+"#"+n}function Ji(n){mi?fi(Di(n)):window.location.hash=n}function qi(n){mi?gi(Di(n)):window.location.replace(Di(n))}var Fi=function(n){function e(e,t){n.call(this,e,t),this.stack=[],this.index=-1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.push=function(n,e,t){var a=this;this.transitionTo(n,(function(n){a.stack=a.stack.slice(0,a.index+1).concat(n),a.index++,e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var a=this;this.transitionTo(n,(function(n){a.stack=a.stack.slice(0,a.index).concat(n),e&&e(n)}),t)},e.prototype.go=function(n){var e=this,t=this.index+n;if(!(t<0||t>=this.stack.length)){var a=this.stack[t];this.confirmTransition(a,(function(){var n=e.current;e.index=t,e.updateRoute(a),e.router.afterHooks.forEach((function(e){e&&e(a,n)}))}),(function(n){Si(n,vi.duplicated)&&(e.index=t)}))}},e.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},e.prototype.ensureURL=function(){},e}(_i),Ni=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=Ko(n.routes||[],this);var e=n.mode||"hash";switch(this.fallback="history"===e&&!mi&&!1!==n.fallback,this.fallback&&(e="hash"),Go||(e="abstract"),this.mode=e,e){case"history":this.history=new Pi(this,n.base);break;case"hash":this.history=new Mi(this,n.base,this.fallback);break;case"abstract":this.history=new Fi(this,n.base);break;default:0}},Qi={currentRoute:{configurable:!0}};Ni.prototype.match=function(n,e,t){return this.matcher.match(n,e,t)},Qi.currentRoute.get=function(){return this.history&&this.history.current},Ni.prototype.init=function(n){var e=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var t=e.apps.indexOf(n);t>-1&&e.apps.splice(t,1),e.app===n&&(e.app=e.apps[0]||null),e.app||e.history.teardown()})),!this.app){this.app=n;var t=this.history;if(t instanceof Pi||t instanceof Mi){var a=function(n){t.setupListeners(),function(n){var a=t.current,r=e.options.scrollBehavior;mi&&r&&"fullPath"in n&&oi(e,n,a,!1)}(n)};t.transitionTo(t.getCurrentLocation(),a,a)}t.listen((function(n){e.apps.forEach((function(e){e._route=n}))}))}},Ni.prototype.beforeEach=function(n){return Hi(this.beforeHooks,n)},Ni.prototype.beforeResolve=function(n){return Hi(this.resolveHooks,n)},Ni.prototype.afterEach=function(n){return Hi(this.afterHooks,n)},Ni.prototype.onReady=function(n,e){this.history.onReady(n,e)},Ni.prototype.onError=function(n){this.history.onError(n)},Ni.prototype.push=function(n,e,t){var a=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){a.history.push(n,e,t)}));this.history.push(n,e,t)},Ni.prototype.replace=function(n,e,t){var a=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){a.history.replace(n,e,t)}));this.history.replace(n,e,t)},Ni.prototype.go=function(n){this.history.go(n)},Ni.prototype.back=function(){this.go(-1)},Ni.prototype.forward=function(){this.go(1)},Ni.prototype.getMatchedComponents=function(n){var e=n?n.matched?n:this.resolve(n).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(n){return Object.keys(n.components).map((function(e){return n.components[e]}))}))):[]},Ni.prototype.resolve=function(n,e,t){var a=No(n,e=e||this.history.current,t,this),r=this.match(a,e),o=r.redirectedFrom||r.fullPath;return{location:a,route:r,href:function(n,e,t){var a="hash"===t?"#"+e:e;return n?So(n+"/"+a):a}(this.history.base,o,this.mode),normalizedTo:a,resolved:r}},Ni.prototype.getRoutes=function(){return this.matcher.getRoutes()},Ni.prototype.addRoute=function(n,e){this.matcher.addRoute(n,e),this.history.current!==mo&&this.history.transitionTo(this.history.getCurrentLocation())},Ni.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==mo&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(Ni.prototype,Qi);var Ui=Ni;function Hi(n,e){return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}Ni.install=function n(e){if(!n.installed||Qo!==e){n.installed=!0,Qo=e;var t=function(n){return void 0!==n},a=function(n,e){var a=n.$options._parentVnode;t(a)&&t(a=a.data)&&t(a=a.registerRouteInstance)&&a(n,e)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,a(this,this)},destroyed:function(){a(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",ko),e.component("RouterLink",Ho);var r=e.config.optionMergeStrategies;r.beforeRouteEnter=r.beforeRouteLeave=r.beforeRouteUpdate=r.created}},Ni.version="3.6.5",Ni.isNavigationFailure=Si,Ni.NavigationFailureType=vi,Ni.START_LOCATION=mo,Go&&window.Vue&&window.Vue.use(Ni);t(103);t(16),t(130);var $i={NotFound:()=>Promise.all([t.e(0),t.e(4)]).then(t.bind(null,328)),Layout:()=>Promise.all([t.e(0),t.e(2)]).then(t.bind(null,327))},Gi={"v-e78034fa":()=>t.e(5).then(t.bind(null,329)),"v-3e714d2a":()=>t.e(6).then(t.bind(null,330)),"v-407e7564":()=>t.e(7).then(t.bind(null,331)),"v-6a669cc4":()=>t.e(8).then(t.bind(null,332)),"v-3897df61":()=>t.e(9).then(t.bind(null,333)),"v-5ddc5e71":()=>t.e(10).then(t.bind(null,334)),"v-6f5fe4a4":()=>t.e(11).then(t.bind(null,335)),"v-5ec93f7b":()=>t.e(13).then(t.bind(null,336)),"v-77eb69ec":()=>t.e(14).then(t.bind(null,337)),"v-410ac754":()=>t.e(12).then(t.bind(null,338)),"v-d45608ea":()=>t.e(15).then(t.bind(null,339)),"v-4a3cf55d":()=>t.e(16).then(t.bind(null,340)),"v-0a837972":()=>t.e(17).then(t.bind(null,341)),"v-89486e7a":()=>t.e(18).then(t.bind(null,342)),"v-38ab7e32":()=>t.e(19).then(t.bind(null,343)),"v-5367a4af":()=>t.e(20).then(t.bind(null,344)),"v-63e48439":()=>t.e(21).then(t.bind(null,345)),"v-9f8ccf5e":()=>t.e(22).then(t.bind(null,346)),"v-99d6e044":()=>t.e(23).then(t.bind(null,347)),"v-43826e72":()=>t.e(24).then(t.bind(null,348)),"v-c20babe6":()=>t.e(25).then(t.bind(null,349)),"v-08c71366":()=>t.e(26).then(t.bind(null,350)),"v-8ae87632":()=>t.e(27).then(t.bind(null,351)),"v-567fbe26":()=>t.e(28).then(t.bind(null,352)),"v-0ba27c18":()=>t.e(29).then(t.bind(null,353)),"v-3f862f67":()=>t.e(30).then(t.bind(null,354)),"v-e30b8032":()=>t.e(31).then(t.bind(null,355)),"v-03e85d0e":()=>t.e(32).then(t.bind(null,356)),"v-6b463bfb":()=>t.e(34).then(t.bind(null,357)),"v-74777bb3":()=>t.e(35).then(t.bind(null,358)),"v-6a709319":()=>t.e(36).then(t.bind(null,359)),"v-135d0248":()=>t.e(37).then(t.bind(null,360)),"v-c3e7532c":()=>t.e(33).then(t.bind(null,361)),"v-571aeb12":()=>t.e(38).then(t.bind(null,362)),"v-d0afba64":()=>t.e(39).then(t.bind(null,363)),"v-5ddc1b80":()=>t.e(40).then(t.bind(null,364)),"v-47a18848":()=>t.e(41).then(t.bind(null,365)),"v-e231d910":()=>t.e(42).then(t.bind(null,366)),"v-5d98fa16":()=>t.e(43).then(t.bind(null,367)),"v-2552a92f":()=>t.e(44).then(t.bind(null,368)),"v-273d7455":()=>t.e(45).then(t.bind(null,369)),"v-d5dc6db4":()=>t.e(46).then(t.bind(null,370)),"v-4a6be083":()=>t.e(47).then(t.bind(null,371)),"v-783fbd46":()=>t.e(48).then(t.bind(null,372)),"v-1c9fd64e":()=>t.e(49).then(t.bind(null,373)),"v-5f0f30c6":()=>t.e(50).then(t.bind(null,374)),"v-51da0e54":()=>t.e(51).then(t.bind(null,375)),"v-78eeb3d8":()=>t.e(52).then(t.bind(null,376)),"v-26fa598d":()=>t.e(53).then(t.bind(null,377)),"v-f5ed38f8":()=>t.e(54).then(t.bind(null,378)),"v-120df2fa":()=>t.e(55).then(t.bind(null,379)),"v-0082735a":()=>t.e(56).then(t.bind(null,380)),"v-669c40a0":()=>t.e(57).then(t.bind(null,381)),"v-09ae1176":()=>t.e(58).then(t.bind(null,382)),"v-4050afac":()=>t.e(59).then(t.bind(null,383)),"v-7dfe13a8":()=>t.e(60).then(t.bind(null,384)),"v-3489417a":()=>t.e(61).then(t.bind(null,385)),"v-f8c2901e":()=>t.e(62).then(t.bind(null,386)),"v-053a73e8":()=>t.e(63).then(t.bind(null,387)),"v-6379fc2e":()=>t.e(64).then(t.bind(null,388)),"v-5140306c":()=>t.e(65).then(t.bind(null,389)),"v-0b9e1aec":()=>t.e(66).then(t.bind(null,390)),"v-0bf64c24":()=>t.e(67).then(t.bind(null,391)),"v-2767b19c":()=>t.e(68).then(t.bind(null,392)),"v-1d611f27":()=>t.e(69).then(t.bind(null,393)),"v-8153bf3c":()=>t.e(71).then(t.bind(null,394)),"v-8f229662":()=>t.e(73).then(t.bind(null,395)),"v-8bbcfd3a":()=>t.e(74).then(t.bind(null,396)),"v-45ced8ca":()=>t.e(70).then(t.bind(null,397)),"v-50a497ba":()=>t.e(72).then(t.bind(null,398)),"v-d0cbc152":()=>t.e(75).then(t.bind(null,399)),"v-d35585c0":()=>t.e(76).then(t.bind(null,400)),"v-957f7b90":()=>t.e(77).then(t.bind(null,401)),"v-224a9095":()=>t.e(78).then(t.bind(null,402)),"v-70032af0":()=>t.e(79).then(t.bind(null,403)),"v-10ca5dc4":()=>t.e(80).then(t.bind(null,404)),"v-c92a649c":()=>t.e(81).then(t.bind(null,405)),"v-76c98d70":()=>t.e(82).then(t.bind(null,406)),"v-ab00c88e":()=>t.e(83).then(t.bind(null,407)),"v-6158f5dc":()=>t.e(84).then(t.bind(null,408)),"v-68d67e22":()=>t.e(85).then(t.bind(null,409)),"v-097ed174":()=>t.e(86).then(t.bind(null,410)),"v-629046d2":()=>t.e(87).then(t.bind(null,411)),"v-80c46bea":()=>t.e(88).then(t.bind(null,412)),"v-1f84369c":()=>t.e(89).then(t.bind(null,413)),"v-e7bc6886":()=>t.e(90).then(t.bind(null,414)),"v-603745ce":()=>t.e(91).then(t.bind(null,415)),"v-4ae61c39":()=>t.e(92).then(t.bind(null,416)),"v-01e74dde":()=>t.e(93).then(t.bind(null,417)),"v-c9002668":()=>t.e(94).then(t.bind(null,418)),"v-129110e4":()=>t.e(96).then(t.bind(null,419)),"v-34c41a32":()=>t.e(97).then(t.bind(null,420)),"v-79517efc":()=>t.e(95).then(t.bind(null,421)),"v-6bc0f08b":()=>t.e(98).then(t.bind(null,422)),"v-c1084aa0":()=>t.e(99).then(t.bind(null,423)),"v-4c9cf11f":()=>t.e(100).then(t.bind(null,424)),"v-7181834a":()=>t.e(101).then(t.bind(null,425)),"v-ea66ad78":()=>t.e(105).then(t.bind(null,426)),"v-2ede7bc6":()=>t.e(104).then(t.bind(null,427)),"v-165dc3de":()=>t.e(103).then(t.bind(null,428)),"v-5798a127":()=>t.e(106).then(t.bind(null,429)),"v-94d81df6":()=>t.e(107).then(t.bind(null,430)),"v-49c893e5":()=>t.e(102).then(t.bind(null,431)),"v-b28245d2":()=>t.e(108).then(t.bind(null,432)),"v-153f7b50":()=>t.e(109).then(t.bind(null,433)),"v-be922ec8":()=>t.e(110).then(t.bind(null,434)),"v-af878584":()=>t.e(111).then(t.bind(null,435)),"v-2ffbbf7d":()=>t.e(114).then(t.bind(null,436)),"v-6d33b879":()=>t.e(115).then(t.bind(null,437)),"v-365b0049":()=>t.e(116).then(t.bind(null,438)),"v-7ba276fa":()=>t.e(117).then(t.bind(null,439)),"v-b0095412":()=>t.e(118).then(t.bind(null,440)),"v-1689eec4":()=>t.e(119).then(t.bind(null,441)),"v-5aaf6e59":()=>t.e(120).then(t.bind(null,442)),"v-42d727d9":()=>t.e(121).then(t.bind(null,443)),"v-91d0c51a":()=>t.e(122).then(t.bind(null,444)),"v-5bbea173":()=>t.e(123).then(t.bind(null,445)),"v-372121bc":()=>t.e(124).then(t.bind(null,446)),"v-4452d00c":()=>t.e(125).then(t.bind(null,447)),"v-5c5b6663":()=>t.e(126).then(t.bind(null,448)),"v-c4807e92":()=>t.e(127).then(t.bind(null,449)),"v-3fb4f800":()=>t.e(128).then(t.bind(null,450)),"v-dbde7360":()=>t.e(129).then(t.bind(null,451)),"v-61301819":()=>t.e(112).then(t.bind(null,452)),"v-262c459c":()=>t.e(113).then(t.bind(null,453)),"v-36ff78c4":()=>t.e(130).then(t.bind(null,454))};function Vi(n){const e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}const Xi=/-(\w)/g,Ki=Vi(n=>n.replace(Xi,(n,e)=>e?e.toUpperCase():"")),Wi=/\B([A-Z])/g,Zi=Vi(n=>n.replace(Wi,"-$1").toLowerCase()),Yi=Vi(n=>n.charAt(0).toUpperCase()+n.slice(1));function ns(n,e){if(!e)return;if(n(e))return n(e);return e.includes("-")?n(Yi(Ki(e))):n(Yi(e))||n(Zi(e))}const es=Object.assign({},$i,Gi),ts=n=>es[n],as=n=>Gi[n],rs=n=>$i[n],os=n=>$t.component(n);function is(n){return ns(as,n)}function ss(n){return ns(rs,n)}function ls(n){return ns(ts,n)}function cs(n){return ns(os,n)}function ds(...n){return Promise.all(n.filter(n=>n).map(async n=>{if(!cs(n)&&ls(n)){const e=await ls(n)();$t.component(n,e.default)}}))}function ps(n,e){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=e)}var us=t(92),hs=t.n(us),ms=t(93),fs=t.n(ms),gs={created(){if(this.siteMeta=this.$site.headTags.filter(([n])=>"meta"===n).map(([n,e])=>e),this.$ssrContext){const e=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(n=e)?n.map(n=>{let e="<meta";return Object.keys(n).forEach(t=>{e+=` ${t}="${fs()(n[t])}"`}),e+">"}).join("\n    "):"",this.$ssrContext.canonicalLink=bs(this.$canonicalUrl)}var n},mounted(){this.currentMetaTags=[...document.querySelectorAll("meta")],this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta(){document.title=this.$title,document.documentElement.lang=this.$lang;const n=this.getMergedMetaTags();this.currentMetaTags=ys(n,this.currentMetaTags)},getMergedMetaTags(){const n=this.$page.frontmatter.meta||[];return hs()([{name:"description",content:this.$description}],n,this.siteMeta,ks)},updateCanonicalLink(){vs(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",bs(this.$canonicalUrl))}},watch:{$page(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy(){ys(null,this.currentMetaTags),vs()}};function vs(){const n=document.querySelector("link[rel='canonical']");n&&n.remove()}function bs(n=""){return n?`<link href="${n}" rel="canonical" />`:""}function ys(n,e){if(e&&[...e].filter(n=>n.parentNode===document.head).forEach(n=>document.head.removeChild(n)),n)return n.map(n=>{const e=document.createElement("meta");return Object.keys(n).forEach(t=>{e.setAttribute(t,n[t])}),document.head.appendChild(e),e})}function ks(n){for(const e of["name","property","itemprop"])if(n.hasOwnProperty(e))return n[e]+e;return JSON.stringify(n)}var xs=t(50),ws={mounted(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:t.n(xs)()((function(){this.setActiveHash()}),300),setActiveHash(){const n=[].slice.call(document.querySelectorAll(".sidebar-link")),e=[].slice.call(document.querySelectorAll(".header-anchor")).filter(e=>n.some(n=>n.hash===e.hash)),t=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),r=window.innerHeight+t;for(let n=0;n<e.length;n++){const o=e[n],i=e[n+1],s=0===n&&0===t||t>=o.parentElement.offsetTop+10&&(!i||t<i.parentElement.offsetTop-10),l=decodeURIComponent(this.$route.hash);if(s&&l!==decodeURIComponent(o.hash)){const t=o;if(r===a)for(let t=n+1;t<e.length;t++)if(l===decodeURIComponent(e[t].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(t.hash),()=>{this.$nextTick(()=>{this.$vuepress.$set("disableScrollBehavior",!1)})})}}}},beforeDestroy(){window.removeEventListener("scroll",this.onScroll)}},Ss=t(24),Ts=t.n(Ss),Cs={mounted(){Ts.a.configure({showSpinner:!1}),this.$router.beforeEach((n,e,t)=>{n.path===e.path||$t.component(n.name)||Ts.a.start(),t()}),this.$router.afterEach(()=>{Ts.a.done(),this.isSidebarOpen=!1})}};t(239),t(240);class js{constructor(){this.containerEl=document.getElementById("message-container"),this.containerEl||(this.containerEl=document.createElement("div"),this.containerEl.id="message-container",document.body.appendChild(this.containerEl))}show({text:n="",duration:e=3e3}){let t=document.createElement("div");t.className="message move-in",t.innerHTML=`\n      <i style="fill: #06a35a;font-size: 14px;display:inline-flex;align-items: center;">\n        <svg style="fill: #06a35a;font-size: 14px;" t="1572421810237" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2323" width="16" height="16"><path d="M822.811993 824.617989c-83.075838 81.99224-188.546032 124.613757-316.049383 127.86455-122.085362-3.250794-223.943563-45.87231-305.935802-127.86455s-124.613757-184.21164-127.86455-305.935802c3.250794-127.503351 45.87231-232.973545 127.86455-316.049383 81.99224-83.075838 184.21164-126.058554 305.935802-129.309347 127.503351 3.250794 232.973545 46.23351 316.049383 129.309347 83.075838 83.075838 126.058554 188.546032 129.309347 316.049383C949.231746 640.406349 905.887831 742.62575 822.811993 824.617989zM432.716755 684.111464c3.973192 3.973192 8.307584 5.779189 13.364374 6.140388 5.05679 0.361199 9.752381-1.444797 13.364374-5.417989l292.571429-287.514638c3.973192-3.973192 5.779189-8.307584 5.779189-13.364374 0-5.05679-1.805996-9.752381-5.779189-13.364374l1.805996 1.805996c-3.973192-3.973192-8.668783-5.779189-14.086772-6.140388-5.417989-0.361199-10.47478 1.444797-14.809171 5.417989l-264.397884 220.33157c-3.973192 3.250794-8.668783 4.695591-14.447972 4.695591-5.779189 0-10.835979-1.444797-15.53157-3.973192l-94.273016-72.962257c-4.334392-3.250794-9.391182-4.334392-14.447972-3.973192s-9.391182 3.250794-12.641975 7.585185l-2.889594 3.973192c-3.250794 4.334392-4.334392 9.391182-3.973192 14.809171 0.722399 5.417989 2.528395 10.11358 5.779189 14.086772L432.716755 684.111464z" p-id="2324"></path></svg>\n      </i>\n      <div class="text">${n}</div>\n    `,this.containerEl.appendChild(t),e>0&&setTimeout(()=>{this.close(t)},e)}close(n){n.className=n.className.replace("move-in",""),n.className+="move-out",n.addEventListener("animationend",()=>{n.remove()})}}var Es={mounted(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},updated(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},methods:{updateCopy(){setTimeout(()=>{(['div[class*="language-"] pre','div[class*="aside-code"] aside']instanceof Array||Array.isArray(['div[class*="language-"] pre','div[class*="aside-code"] aside']))&&['div[class*="language-"] pre','div[class*="aside-code"] aside'].forEach(n=>{document.querySelectorAll(n).forEach(this.generateCopyButton)})},1e3)},generateCopyButton(n){if(n.classList.contains("codecopy-enabled"))return;const e=document.createElement("i");e.className="code-copy",e.innerHTML='<svg  style="color:#aaa;font-size:14px" t="1572422231464" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3201" width="14" height="14"><path d="M866.461538 39.384615H354.461538c-43.323077 0-78.769231 35.446154-78.76923 78.769231v39.384616h472.615384c43.323077 0 78.769231 35.446154 78.769231 78.76923v551.384616h39.384615c43.323077 0 78.769231-35.446154 78.769231-78.769231V118.153846c0-43.323077-35.446154-78.769231-78.769231-78.769231z m-118.153846 275.692308c0-43.323077-35.446154-78.769231-78.76923-78.769231H157.538462c-43.323077 0-78.769231 35.446154-78.769231 78.769231v590.769231c0 43.323077 35.446154 78.769231 78.769231 78.769231h512c43.323077 0 78.769231-35.446154 78.76923-78.769231V315.076923z m-354.461538 137.846154c0 11.815385-7.876923 19.692308-19.692308 19.692308h-157.538461c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h157.538461c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z m157.538461 315.076923c0 11.815385-7.876923 19.692308-19.692307 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h315.076923c11.815385 0 19.692308 7.876923 19.692307 19.692308v39.384615z m78.769231-157.538462c0 11.815385-7.876923 19.692308-19.692308 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h393.846153c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z" p-id="3202"></path></svg>',e.title="Copy to clipboard",e.addEventListener("click",()=>{this.copyToClipboard(n.innerText)}),n.appendChild(e),n.classList.add("codecopy-enabled")},copyToClipboard(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);const t=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy");(new js).show({text:"å¤å¶æå",duration:1e3}),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}}};!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&a.firstChild?a.insertBefore(r,a.firstChild):a.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}("@media (max-width: 1000px) {\n  .vuepress-plugin-demo-block__h_code {\n    display: none;\n  }\n  .vuepress-plugin-demo-block__app {\n    margin-left: auto !important;\n    margin-right: auto !important;\n  }\n}\n.vuepress-plugin-demo-block__wrapper {\n  margin-top: 10px;\n  border: 1px solid #ebebeb;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display {\n  height: 400px;\n  display: flex;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__app {\n  width: 300px;\n  border: 1px solid #ebebeb;\n  box-shadow: 1px 1px 3px #ebebeb;\n  margin-right: 5px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code {\n  flex: 1;\n  overflow: auto;\n  height: 100%;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code > pre {\n  overflow: visible;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  max-height: 400px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper div {\n  box-sizing: border-box;\n}\n.vuepress-plugin-demo-block__wrapper:hover {\n  box-shadow: 0 0 11px rgba(33, 33, 33, 0.2);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code {\n  overflow: hidden;\n  height: 0;\n  padding: 0 !important;\n  background-color: #282c34;\n  border-radius: 0 !important;\n  transition: height 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code pre {\n  margin: 0 !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  padding: 20px;\n  border-bottom: 1px solid #ebebeb;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer {\n  position: relative;\n  text-align: center;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__codepen {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__expand::before {\n  border-top: none;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #ccc;\n  border-left: 6px solid transparent;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__codepen,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand span,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand::before {\n  border-top-color: #3eaf7c !important;\n  border-bottom-color: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover svg {\n  fill: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand-text {\n  transition: all 0.5s;\n  opacity: 0;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:nth-last-child(2) {\n  right: 50px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:last-child {\n  right: 10px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button {\n  border-color: transparent;\n  background-color: transparent;\n  font-size: 14px;\n  color: #3eaf7c;\n  cursor: pointer;\n  outline: none;\n  margin: 0;\n  width: 46px;\n  position: relative;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::before {\n  content: attr(data-tip);\n  white-space: nowrap;\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  color: #eee;\n  line-height: 1;\n  z-index: 1000;\n  border-radius: 4px;\n  padding: 6px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::after {\n  content: '' !important;\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: -5px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  border: 5px solid transparent;\n  border-top-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button svg {\n  width: 34px;\n  height: 20px;\n  fill: #ccc;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__codepen {\n  position: absolute;\n  top: 10px;\n  transition: all 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand {\n  position: relative;\n  width: 100px;\n  height: 40px;\n  margin: 0;\n  color: #3eaf7c;\n  font-size: 14px;\n  background-color: transparent;\n  border-color: transparent;\n  outline: none;\n  transition: all 0.5s;\n  cursor: pointer;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-top: 6px solid #ccc;\n  border-right: 6px solid transparent;\n  border-left: 6px solid transparent;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n");var As={jsLib:[],cssLib:[],jsfiddle:!0,codepen:!0,codepenLayout:"left",codepenJsProcessor:"babel",codepenEditors:"101",horizontal:!1,vue:"https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js",react:"https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js",reactDOM:"https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"},Is={},_s=function(n){return'<div id="app">\n'.concat(n,"\n</div>")},Ls=function(n){return window.$VUEPRESS_DEMO_BLOCK&&void 0!==window.$VUEPRESS_DEMO_BLOCK[n]?window.$VUEPRESS_DEMO_BLOCK[n]:As[n]},zs=function n(e,t,a){var r=document.createElement(e);return t&&Object.keys(t).forEach((function(n){if(n.indexOf("data"))r[n]=t[n];else{var e=n.replace("data","");r.dataset[e]=t[n]}})),a&&a.forEach((function(e){var t=e.tag,a=e.attrs,o=e.children;r.appendChild(n(t,a,o))})),r},Ps=function(n,e,t){var a,r=(a=n.querySelectorAll(".".concat(e)),Array.prototype.slice.call(a));return 1!==r.length||t?r:r[0]},Bs=function(n,e){var t,a,r=n.match(/<style>([\s\S]+)<\/style>/),o=n.match(/<template>([\s\S]+)<\/template>/),i=n.match(/<script>([\s\S]+)<\/script>/),s={css:r&&r[1].replace(/^\n|\n$/g,""),html:o&&o[1].replace(/^\n|\n$/g,""),js:i&&i[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};s.htmlTpl=_s(s.html),s.jsTpl=(t=s.js,a=t.replace(/export\s+default\s*?\{\n*/,"").replace(/\n*\}\s*$/,"").trim(),"new Vue({\n  el: '#app',\n  ".concat(a,"\n})")),s.script=function(n,e){var t=n.split(/export\s+default/),a="(function() {".concat(t[0]," ; return ").concat(t[1],"})()"),r=window.Babel?window.Babel.transform(a,{presets:["es2015"]}).code:a,o=[eval][0](r);return o.template=e,o}(s.js,s.html);var l=Ls("vue");return s.jsLib.unshift(l),s},Ms=function(n,e){var t,a=n.match(/<style>([\s\S]+)<\/style>/),r=n.match(/<html>([\s\S]+)<\/html>/),o=n.match(/<script>([\s\S]+)<\/script>/),i={css:a&&a[1].replace(/^\n|\n$/g,""),html:r&&r[1].replace(/^\n|\n$/g,""),js:o&&o[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};return i.htmlTpl=i.html,i.jsTpl=i.js,i.script=(t=i.js,window.Babel?window.Babel.transform(t,{presets:["es2015"]}).code:t),i},Os=function(n){return n=n.replace("export default ","").replace(/App\.__style__(\s*)=(\s*)`([\s\S]*)?`/,""),n+='ReactDOM.render(React.createElement(App), document.getElementById("app"))'};function Rs(){var n=Ps(document,"vuepress-plugin-demo-block__wrapper",!0);n.length?n.forEach((function(n){if("true"!==n.dataset.created){n.style.display="block";var e=Ps(n,"vuepress-plugin-demo-block__code"),t=Ps(n,"vuepress-plugin-demo-block__display"),a=Ps(n,"vuepress-plugin-demo-block__footer"),r=Ps(t,"vuepress-plugin-demo-block__app"),o=decodeURIComponent(n.dataset.code),i=decodeURIComponent(n.dataset.config),s=decodeURIComponent(n.dataset.type);i=i?JSON.parse(i):{};var l=e.querySelector("div").clientHeight,c="react"===s?function(n,e){var t=(0,window.Babel.transform)(n,{presets:["es2015","react"]}).code,a="(function(exports){var module={};module.exports=exports;".concat(t,";return module.exports.__esModule?module.exports.default:module.exports;})({})"),r=new Function("return ".concat(a))(),o={js:r,css:r.__style__||"",jsLib:e.jsLib||[],cssLib:e.cssLib||[],jsTpl:Os(n),htmlTpl:_s("")},i=Ls("react"),s=Ls("reactDOM");return o.jsLib.unshift(i,s),o}(o,i):"vanilla"===s?Ms(o,i):Bs(o,i),d=zs("button",{className:"".concat("vuepress-plugin-demo-block__expand")});if(a.appendChild(d),d.addEventListener("click",Ds.bind(null,d,l,e,a)),Ls("jsfiddle")&&a.appendChild(function(n){var e=n.css,t=n.htmlTpl,a=n.jsTpl,r=n.jsLib,o=n.cssLib,i=r.concat(o).concat(Ls("cssLib")).concat(Ls("jsLib")).join(",");return zs("form",{className:"vuepress-plugin-demo-block__jsfiddle",target:"_blank",action:"https://jsfiddle.net/api/post/library/pure/",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"css",value:e}},{tag:"input",attrs:{type:"hidden",name:"html",value:t}},{tag:"input",attrs:{type:"hidden",name:"js",value:a}},{tag:"input",attrs:{type:"hidden",name:"panel_js",value:3}},{tag:"input",attrs:{type:"hidden",name:"wrap",value:1}},{tag:"input",attrs:{type:"hidden",name:"resources",value:i}},{tag:"button",attrs:{type:"submit",className:"vuepress-plugin-demo-block__button",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088289967" class="icon" style="" viewBox="0 0 1170 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1952" xmlns:xlink="http://www.w3.org/1999/xlink" width="228.515625" height="200"><defs><style type="text/css"></style></defs><path d="M1028.571429 441.142857q63.428571 26.285714 102.571428 83.142857T1170.285714 650.857143q0 93.714286-67.428571 160.285714T940 877.714286q-2.285714 0-6.571429-0.285715t-6-0.285714H232q-97.142857-5.714286-164.571429-71.714286T0 645.142857q0-62.857143 31.428571-116t84-84q-6.857143-22.285714-6.857142-46.857143 0-65.714286 46.857142-112t113.714286-46.285714q54.285714 0 98.285714 33.142857 42.857143-88 127.142858-141.714286t186.571428-53.714285q94.857143 0 174.857143 46T982.571429 248.571429t46.571428 172q0 3.428571-0.285714 10.285714t-0.285714 10.285714zM267.428571 593.142857q0 69.714286 48 110.285714t118.857143 40.571429q78.285714 0 137.142857-56.571429-9.142857-11.428571-27.142857-32.285714T519.428571 626.285714q-38.285714 37.142857-82.285714 37.142857-31.428571 0-53.428571-19.142857T361.714286 594.285714q0-30.285714 22-49.714285t52.285714-19.428572q25.142857 0 48.285714 12t41.714286 31.428572 37.142857 42.857142 39.428572 46.857143 44 42.857143 55.428571 31.428572 69.428571 12q69.142857 0 116.857143-40.857143T936 594.857143q0-69.142857-48-109.714286t-118.285714-40.571428q-81.714286 0-137.714286 55.428571l53.142857 61.714286q37.714286-36.571429 81.142857-36.571429 29.714286 0 52.571429 18.857143t22.857143 48q0 32.571429-21.142857 52.285714t-53.714286 19.714286q-24.571429 0-47.142857-12t-41.142857-31.428571-37.428572-42.857143-39.714286-46.857143-44.285714-42.857143-55.142857-31.428571T434.285714 444.571429q-69.714286 0-118.285714 40.285714T267.428571 593.142857z" p-id="1953"></path></svg>',datatip:"JSFiddle"}}])}(c)),Ls("codepen")&&a.appendChild(function(n){var e=n.css,t=n.htmlTpl,a=n.jsTpl,r=n.jsLib,o=n.cssLib,i=JSON.stringify({css:e,html:t,js:a,js_external:r.concat(Ls("jsLib")).join(";"),css_external:o.concat(Ls("cssLib")).join(";"),layout:Ls("codepenLayout"),js_pre_processor:Ls("codepenJsProcessor"),editors:Ls("codepenEditors")});return zs("form",{className:"vuepress-plugin-demo-block__codepen",target:"_blank",action:"https://codepen.io/pen/define",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"data",value:i}},{tag:"button",attrs:{type:"submit",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088271207" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1737" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z" p-id="1738"></path></svg>',className:"vuepress-plugin-demo-block__button",datatip:"Codepen"}}])}(c)),void 0!==i.horizontal?i.horizontal:Ls("horizontal")){n.classList.add("vuepress-plugin-demo-block__horizontal");var p=e.firstChild.cloneNode(!0);p.classList.add("vuepress-plugin-demo-block__h_code"),t.appendChild(p)}if(c.css&&function(n){if(!Is[n]){var e=zs("style",{innerHTML:n});document.body.appendChild(e),Is[n]=!0}}(c.css),"react"===s)ReactDOM.render(React.createElement(c.js),r);else if("vue"===s){var u=(new(Vue.extend(c.script))).$mount();r.appendChild(u.$el)}else"vanilla"===s&&(r.innerHTML=c.html,new Function("return (function(){".concat(c.script,"})()"))());n.dataset.created="true"}})):setTimeout((function(n){Rs()}),300)}function Ds(n,e,t,a){var r="1"!==n.dataset.isExpand;t.style.height=r?"".concat(e,"px"):0,r?a.classList.add("vuepress-plugin-demo-block__show-link"):a.classList.remove("vuepress-plugin-demo-block__show-link"),n.dataset.isExpand=r?"1":"0"}var Js={mounted:function(){window.$VUEPRESS_DEMO_BLOCK={jsfiddle:!1,codepen:!0,horizontal:!1},Rs()},updated:function(){Rs()}},qs="auto",Fs="zoom-in",Ns="zoom-out",Qs="grab",Us="move";function Hs(n,e,t){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r={passive:!1};a?n.addEventListener(e,t,r):n.removeEventListener(e,t,r)}function $s(n,e){if(n){var t=new Image;t.onload=function(){e&&e(t)},t.src=n}}function Gs(n){return n.dataset.original?n.dataset.original:"A"===n.parentNode.tagName?n.parentNode.getAttribute("href"):null}function Vs(n,e,t){!function(n){var e=Xs,t=Ks;if(n.transition){var a=n.transition;delete n.transition,n[e]=a}if(n.transform){var r=n.transform;delete n.transform,n[t]=r}}(e);var a=n.style,r={};for(var o in e)t&&(r[o]=a[o]||""),a[o]=e[o];return r}var Xs="transition",Ks="transform",Ws="transform",Zs="transitionend";var Ys=function(){},nl={enableGrab:!0,preloadImage:!1,closeOnWindowResize:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,zIndex:998,customSize:null,onOpen:Ys,onClose:Ys,onGrab:Ys,onMove:Ys,onRelease:Ys,onBeforeOpen:Ys,onBeforeClose:Ys,onBeforeGrab:Ys,onBeforeRelease:Ys,onImageLoading:Ys,onImageLoaded:Ys},el={init:function(n){var e,t;e=this,t=n,Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(n){e[n]=e[n].bind(t)}))},click:function(n){if(n.preventDefault(),al(n))return window.open(this.target.srcOriginal||n.currentTarget.src,"_blank");this.shown?this.released?this.close():this.release():this.open(n.currentTarget)},scroll:function(){var n=document.documentElement||document.body.parentNode||document.body,e=window.pageXOffset||n.scrollLeft,t=window.pageYOffset||n.scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition={x:e,y:t});var a=this.lastScrollPosition.x-e,r=this.lastScrollPosition.y-t,o=this.options.scrollThreshold;(Math.abs(r)>=o||Math.abs(a)>=o)&&(this.lastScrollPosition=null,this.close())},keydown:function(n){(function(n){return"Escape"===(n.key||n.code)||27===n.keyCode})(n)&&(this.released?this.close():this.release(this.close))},mousedown:function(n){if(tl(n)&&!al(n)){n.preventDefault();var e=n.clientX,t=n.clientY;this.pressTimer=setTimeout(function(){this.grab(e,t)}.bind(this),200)}},mousemove:function(n){this.released||this.move(n.clientX,n.clientY)},mouseup:function(n){tl(n)&&!al(n)&&(clearTimeout(this.pressTimer),this.released?this.close():this.release())},touchstart:function(n){n.preventDefault();var e=n.touches[0],t=e.clientX,a=e.clientY;this.pressTimer=setTimeout(function(){this.grab(t,a)}.bind(this),200)},touchmove:function(n){if(!this.released){var e=n.touches[0],t=e.clientX,a=e.clientY;this.move(t,a)}},touchend:function(n){(function(n){n.targetTouches.length})(n)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())},clickOverlay:function(){this.close()},resizeWindow:function(){this.close()}};function tl(n){return 0===n.button}function al(n){return n.metaKey||n.ctrlKey}var rl={init:function(n){this.el=document.createElement("div"),this.instance=n,this.parent=document.body,Vs(this.el,{position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0}),this.updateStyle(n.options),Hs(this.el,"click",n.handler.clickOverlay.bind(n))},updateStyle:function(n){Vs(this.el,{zIndex:n.zIndex,backgroundColor:n.bgColor,transition:"opacity\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction})},insert:function(){this.parent.appendChild(this.el)},remove:function(){this.parent.removeChild(this.el)},fadeIn:function(){this.el.offsetWidth,this.el.style.opacity=this.instance.options.bgOpacity},fadeOut:function(){this.el.style.opacity=0}},ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},il=function(){function n(n,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),sl=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},ll={init:function(n,e){this.el=n,this.instance=e,this.srcThumbnail=this.el.getAttribute("src"),this.srcset=this.el.getAttribute("srcset"),this.srcOriginal=Gs(this.el),this.rect=this.el.getBoundingClientRect(),this.translate=null,this.scale=null,this.styleOpen=null,this.styleClose=null},zoomIn:function(){var n=this.instance.options,e=n.zIndex,t=n.enableGrab,a=n.transitionDuration,r=n.transitionTimingFunction;this.translate=this.calculateTranslate(),this.scale=this.calculateScale(),this.styleOpen={position:"relative",zIndex:e+1,cursor:t?Qs:Ns,transition:Ws+"\n        "+a+"s\n        "+r,transform:"translate3d("+this.translate.x+"px, "+this.translate.y+"px, 0px)\n        scale("+this.scale.x+","+this.scale.y+")",height:this.rect.height+"px",width:this.rect.width+"px"},this.el.offsetWidth,this.styleClose=Vs(this.el,this.styleOpen,!0)},zoomOut:function(){this.el.offsetWidth,Vs(this.el,{transform:"none"})},grab:function(n,e,t){var a=cl(),r=a.x-n,o=a.y-e;Vs(this.el,{cursor:Us,transform:"translate3d(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+o)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},move:function(n,e,t){var a=cl(),r=a.x-n,o=a.y-e;Vs(this.el,{transition:Ws,transform:"translate3d(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+o)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},restoreCloseStyle:function(){Vs(this.el,this.styleClose)},restoreOpenStyle:function(){Vs(this.el,this.styleOpen)},upgradeSource:function(){if(this.srcOriginal){var n=this.el.parentNode;this.srcset&&this.el.removeAttribute("srcset");var e=this.el.cloneNode(!1);e.setAttribute("src",this.srcOriginal),e.style.position="fixed",e.style.visibility="hidden",n.appendChild(e),setTimeout(function(){this.el.setAttribute("src",this.srcOriginal),n.removeChild(e)}.bind(this),50)}},downgradeSource:function(){this.srcOriginal&&(this.srcset&&this.el.setAttribute("srcset",this.srcset),this.el.setAttribute("src",this.srcThumbnail))},calculateTranslate:function(){var n=cl(),e=this.rect.left+this.rect.width/2,t=this.rect.top+this.rect.height/2;return{x:n.x-e,y:n.y-t}},calculateScale:function(){var n=this.el.dataset,e=n.zoomingHeight,t=n.zoomingWidth,a=this.instance.options,r=a.customSize,o=a.scaleBase;if(!r&&e&&t)return{x:t/this.rect.width,y:e/this.rect.height};if(r&&"object"===(void 0===r?"undefined":ol(r)))return{x:r.width/this.rect.width,y:r.height/this.rect.height};var i=this.rect.width/2,s=this.rect.height/2,l=cl(),c={x:l.x-i,y:l.y-s},d=c.x/i,p=c.y/s,u=o+Math.min(d,p);if(r&&"string"==typeof r){var h=t||this.el.naturalWidth,m=e||this.el.naturalHeight,f=parseFloat(r)*h/(100*this.rect.width),g=parseFloat(r)*m/(100*this.rect.height);if(u>f||u>g)return{x:f,y:g}}return{x:u,y:u}}};function cl(){var n=document.documentElement;return{x:Math.min(n.clientWidth,window.innerWidth)/2,y:Math.min(n.clientHeight,window.innerHeight)/2}}function dl(n,e,t){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach((function(a){Hs(n,a,e[a],t)}))}var pl=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.target=Object.create(ll),this.overlay=Object.create(rl),this.handler=Object.create(el),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=sl({},nl,e),this.overlay.init(this),this.handler.init(this)}return il(n,[{key:"listen",value:function(n){if("string"==typeof n)for(var e=document.querySelectorAll(n),t=e.length;t--;)this.listen(e[t]);else"IMG"===n.tagName&&(n.style.cursor=Fs,Hs(n,"click",this.handler.click),this.options.preloadImage&&$s(Gs(n)));return this}},{key:"config",value:function(n){return n?(sl(this.options,n),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var a="string"==typeof n?document.querySelector(n):n;if("IMG"===a.tagName){if(this.options.onBeforeOpen(a),this.target.init(a,this),!this.options.preloadImage){var r=this.target.srcOriginal;null!=r&&(this.options.onImageLoading(a),$s(r,this.options.onImageLoaded))}this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.fadeIn(),Hs(document,"scroll",this.handler.scroll),Hs(document,"keydown",this.handler.keydown),this.options.closeOnWindowResize&&Hs(window,"resize",this.handler.resizeWindow);var o=function n(){Hs(a,Zs,n,!1),e.lock=!1,e.target.upgradeSource(),e.options.enableGrab&&dl(document,e.handler,!0),t(a)};return Hs(a,Zs,o),this}}}},{key:"close",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeClose(t),this.lock=!0,this.body.style.cursor=qs,this.overlay.fadeOut(),this.target.zoomOut(),Hs(document,"scroll",this.handler.scroll,!1),Hs(document,"keydown",this.handler.keydown,!1),this.options.closeOnWindowResize&&Hs(window,"resize",this.handler.resizeWindow,!1);var a=function a(){Hs(t,Zs,a,!1),n.shown=!1,n.lock=!1,n.target.downgradeSource(),n.options.enableGrab&&dl(document,n.handler,!1),n.target.restoreCloseStyle(),n.overlay.remove(),e(t)};return Hs(t,Zs,a),this}}},{key:"grab",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onGrab;if(this.shown&&!this.lock){var r=this.target.el;this.options.onBeforeGrab(r),this.released=!1,this.target.grab(n,e,t);var o=function n(){Hs(r,Zs,n,!1),a(r)};return Hs(r,Zs,o),this}}},{key:"move",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onMove;if(this.shown&&!this.lock){this.released=!1,this.body.style.cursor=Us,this.target.move(n,e,t);var r=this.target.el,o=function n(){Hs(r,Zs,n,!1),a(r)};return Hs(r,Zs,o),this}}},{key:"release",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeRelease(t),this.lock=!0,this.body.style.cursor=qs,this.target.restoreOpenStyle();var a=function a(){Hs(t,Zs,a,!1),n.lock=!1,n.released=!0,e(t)};return Hs(t,Zs,a),this}}}]),n}();const ul=JSON.parse('{"bgColor":"rgba(0,0,0,0.6)"}'),hl=Number("500");class ml{constructor(){this.instance=new pl(ul)}update(n=".theme-vdoing-content img:not(.no-zoom)"){"undefined"!=typeof window&&this.instance.listen(n)}updateDelay(n=".theme-vdoing-content img:not(.no-zoom)",e=hl){setTimeout(()=>this.update(n),e)}}var fl=[gs,ws,Cs,Es,Js,{watch:{"$page.path"(){void 0!==this.$vuepress.zooming&&this.$vuepress.zooming.updateDelay()}},mounted(){this.$vuepress.zooming=new ml,this.$vuepress.zooming.updateDelay()}}],gl={name:"GlobalLayout",computed:{layout(){const n=this.getLayout();return ps("layout",n),$t.component(n)}},methods:{getLayout(){if(this.$page.path){const n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},vl=t(7),bl=Object(vl.a)(gl,(function(){return(0,this._self._c)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,e,t){switch(e){case"components":n[e]||(n[e]={}),Object.assign(n[e],t);break;case"mixins":n[e]||(n[e]=[]),n[e].push(...t);break;default:throw new Error("Unknown option name.")}}(bl,"mixins",fl);const yl=[{name:"v-e78034fa",path:"/pages/java/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-e78034fa").then(t)}},{path:"/pages/java/index.html",redirect:"/pages/java/"},{path:"/01.Java/01.Javaåºç¡/01.Javaæ±æ».html",redirect:"/pages/java/"},{name:"v-3e714d2a",path:"/pages/2ed256/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-3e714d2a").then(t)}},{path:"/pages/2ed256/index.html",redirect:"/pages/2ed256/"},{path:"/01.Java/01.Javaåºç¡/02.æ¥å£åæ½è±¡ç±»çåºå«.html",redirect:"/pages/2ed256/"},{name:"v-407e7564",path:"/pages/66f85c/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-407e7564").then(t)}},{path:"/pages/66f85c/index.html",redirect:"/pages/66f85c/"},{path:"/01.Java/01.Javaåºç¡/03.åå°ç¸å³.html",redirect:"/pages/66f85c/"},{name:"v-6a669cc4",path:"/pages/d95f75/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6a669cc4").then(t)}},{path:"/pages/d95f75/index.html",redirect:"/pages/d95f75/"},{path:"/01.Java/01.Javaåºç¡/100.è¯­æ³è®°å½.html",redirect:"/pages/d95f75/"},{name:"v-3897df61",path:"/pages/collection/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-3897df61").then(t)}},{path:"/pages/collection/index.html",redirect:"/pages/collection/"},{path:"/01.Java/02.Javaéå/01.ArrayList.html",redirect:"/pages/collection/"},{name:"v-5ddc5e71",path:"/pages/d249ac/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5ddc5e71").then(t)}},{path:"/pages/d249ac/index.html",redirect:"/pages/d249ac/"},{path:"/01.Java/02.Javaéå/02.HashMap.html",redirect:"/pages/d249ac/"},{name:"v-6f5fe4a4",path:"/pages/86b6a3/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6f5fe4a4").then(t)}},{path:"/pages/86b6a3/index.html",redirect:"/pages/86b6a3/"},{path:"/01.Java/02.Javaéå/03. BlockingQueue.html",redirect:"/pages/86b6a3/"},{name:"v-5ec93f7b",path:"/pages/jvm/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5ec93f7b").then(t)}},{path:"/pages/jvm/index.html",redirect:"/pages/jvm/"},{path:"/01.Java/03.JVM/01.Javaåå­æ¨¡å.html",redirect:"/pages/jvm/"},{name:"v-77eb69ec",path:"/pages/7d816e/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-77eb69ec").then(t)}},{path:"/pages/7d816e/index.html",redirect:"/pages/7d816e/"},{path:"/01.Java/03.JVM/02.ç±»å è½½æºå¶.html",redirect:"/pages/7d816e/"},{name:"v-410ac754",path:"/pages/cbcb60/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-410ac754").then(t)}},{path:"/pages/cbcb60/index.html",redirect:"/pages/cbcb60/"},{path:"/01.Java/02.Javaéå/04.LinkedListåArrayDeque.html",redirect:"/pages/cbcb60/"},{name:"v-d45608ea",path:"/pages/a934e8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-d45608ea").then(t)}},{path:"/pages/a934e8/index.html",redirect:"/pages/a934e8/"},{path:"/01.Java/03.JVM/03.JVMåå¾åæ¶.html",redirect:"/pages/a934e8/"},{name:"v-4a3cf55d",path:"/pages/8ffeca/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4a3cf55d").then(t)}},{path:"/pages/8ffeca/index.html",redirect:"/pages/8ffeca/"},{path:"/01.Java/03.JVM/04.Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼.html",redirect:"/pages/8ffeca/"},{name:"v-0a837972",path:"/pages/376408/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-0a837972").then(t)}},{path:"/pages/376408/index.html",redirect:"/pages/376408/"},{path:"/01.Java/03.JVM/05.èææºå¯¹è±¡.html",redirect:"/pages/376408/"},{name:"v-89486e7a",path:"/pages/9a5ae7/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-89486e7a").then(t)}},{path:"/pages/9a5ae7/index.html",redirect:"/pages/9a5ae7/"},{path:"/01.Java/03.JVM/06.OutOfMemoryError.html",redirect:"/pages/9a5ae7/"},{name:"v-38ab7e32",path:"/pages/1a4e69/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-38ab7e32").then(t)}},{path:"/pages/1a4e69/index.html",redirect:"/pages/1a4e69/"},{path:"/01.Java/03.JVM/07.å¦ä½å¿«éææ¥é®é¢.html",redirect:"/pages/1a4e69/"},{name:"v-5367a4af",path:"/pages/1ee611/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5367a4af").then(t)}},{path:"/pages/1ee611/index.html",redirect:"/pages/1ee611/"},{path:"/01.Java/03.JVM/08.JITéé¸åæ.html",redirect:"/pages/1ee611/"},{name:"v-63e48439",path:"/pages/9a3179/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-63e48439").then(t)}},{path:"/pages/9a3179/index.html",redirect:"/pages/9a3179/"},{path:"/01.Java/03.JVM/100.å­èç å¢å¼ºææ¯.html",redirect:"/pages/9a3179/"},{name:"v-9f8ccf5e",path:"/pages/9cc971/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-9f8ccf5e").then(t)}},{path:"/pages/9cc971/index.html",redirect:"/pages/9cc971/"},{path:"/01.Java/03.JVM/101.ãæ·±å¥çè§£Javaèææºã.html",redirect:"/pages/9cc971/"},{name:"v-99d6e044",path:"/pages/concurrent/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-99d6e044").then(t)}},{path:"/pages/concurrent/index.html",redirect:"/pages/concurrent/"},{path:"/01.Java/04.Javaå¹¶å/01.synchronizedåvolatile.html",redirect:"/pages/concurrent/"},{name:"v-43826e72",path:"/pages/41602c/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-43826e72").then(t)}},{path:"/pages/41602c/index.html",redirect:"/pages/41602c/"},{path:"/01.Java/04.Javaå¹¶å/02.TreadLocal.html",redirect:"/pages/41602c/"},{name:"v-c20babe6",path:"/pages/d1bd01/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c20babe6").then(t)}},{path:"/pages/d1bd01/index.html",redirect:"/pages/d1bd01/"},{path:"/01.Java/04.Javaå¹¶å/03.ReentrantLock.html",redirect:"/pages/d1bd01/"},{name:"v-08c71366",path:"/pages/019d22/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-08c71366").then(t)}},{path:"/pages/019d22/index.html",redirect:"/pages/019d22/"},{path:"/01.Java/04.Javaå¹¶å/04.ConcurrentHashMap.html",redirect:"/pages/019d22/"},{name:"v-8ae87632",path:"/pages/854033/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-8ae87632").then(t)}},{path:"/pages/854033/index.html",redirect:"/pages/854033/"},{path:"/01.Java/04.Javaå¹¶å/05.ThreadPoolExecutor.html",redirect:"/pages/854033/"},{name:"v-567fbe26",path:"/pages/9862ed/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-567fbe26").then(t)}},{path:"/pages/9862ed/index.html",redirect:"/pages/9862ed/"},{path:"/01.Java/04.Javaå¹¶å/06.Future & CompletableFuture.html",redirect:"/pages/9862ed/"},{name:"v-0ba27c18",path:"/pages/646254/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-0ba27c18").then(t)}},{path:"/pages/646254/index.html",redirect:"/pages/646254/"},{path:"/01.Java/04.Javaå¹¶å/07.ä»çº¿ç¨å°Javaçéæºå¶.html",redirect:"/pages/646254/"},{name:"v-3f862f67",path:"/pages/9c98d8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-3f862f67").then(t)}},{path:"/pages/9c98d8/index.html",redirect:"/pages/9c98d8/"},{path:"/01.Java/04.Javaå¹¶å/08.CopyOnWriteArrayList.html",redirect:"/pages/9c98d8/"},{name:"v-e30b8032",path:"/pages/7c31b2/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-e30b8032").then(t)}},{path:"/pages/7c31b2/index.html",redirect:"/pages/7c31b2/"},{path:"/01.Java/04.Javaå¹¶å/10.CountDownLatch.html",redirect:"/pages/7c31b2/"},{name:"v-03e85d0e",path:"/pages/d5fcba/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-03e85d0e").then(t)}},{path:"/pages/d5fcba/index.html",redirect:"/pages/d5fcba/"},{path:"/01.Java/04.Javaå¹¶å/100.å¹¶åç¼ç¨.html",redirect:"/pages/d5fcba/"},{name:"v-6b463bfb",path:"/pages/109178/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6b463bfb").then(t)}},{path:"/pages/109178/index.html",redirect:"/pages/109178/"},{path:"/01.Java/04.Javaå¹¶å/12.AQS.html",redirect:"/pages/109178/"},{name:"v-74777bb3",path:"/pages/3c96b3/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-74777bb3").then(t)}},{path:"/pages/3c96b3/index.html",redirect:"/pages/3c96b3/"},{path:"/01.Java/04.Javaå¹¶å/99.å¦ä½å®ç° ReentrantLockï¼.html",redirect:"/pages/3c96b3/"},{name:"v-6a709319",path:"/pages/mysql/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6a709319").then(t)}},{path:"/pages/mysql/index.html",redirect:"/pages/mysql/"},{path:"/02.MySQL/00.MySQL.html",redirect:"/pages/mysql/"},{name:"v-135d0248",path:"/pages/26cff4/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-135d0248").then(t)}},{path:"/pages/26cff4/index.html",redirect:"/pages/26cff4/"},{path:"/02.MySQL/01.MySQLå­å¨å¼æ.html",redirect:"/pages/26cff4/"},{name:"v-c3e7532c",path:"/pages/fa1dea/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c3e7532c").then(t)}},{path:"/pages/fa1dea/index.html",redirect:"/pages/fa1dea/"},{path:"/01.Java/04.Javaå¹¶å/11. CyclicBarrier.html",redirect:"/pages/fa1dea/"},{name:"v-571aeb12",path:"/pages/7ece7e/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-571aeb12").then(t)}},{path:"/pages/7ece7e/index.html",redirect:"/pages/7ece7e/"},{path:"/02.MySQL/02.ç´¢å¼.html",redirect:"/pages/7ece7e/"},{name:"v-d0afba64",path:"/pages/e88566/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-d0afba64").then(t)}},{path:"/pages/e88566/index.html",redirect:"/pages/e88566/"},{path:"/02.MySQL/03.äºå¡.html",redirect:"/pages/e88566/"},{name:"v-5ddc1b80",path:"/pages/1d1ed2/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5ddc1b80").then(t)}},{path:"/pages/1d1ed2/index.html",redirect:"/pages/1d1ed2/"},{path:"/02.MySQL/04.MySQLä¸­çlog.html",redirect:"/pages/1d1ed2/"},{name:"v-47a18848",path:"/pages/43cd7b/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-47a18848").then(t)}},{path:"/pages/43cd7b/index.html",redirect:"/pages/43cd7b/"},{path:"/02.MySQL/05.MVCCè§£å³å¹»è¯»é®é¢.html",redirect:"/pages/43cd7b/"},{name:"v-e231d910",path:"/pages/9ed061/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-e231d910").then(t)}},{path:"/pages/9ed061/index.html",redirect:"/pages/9ed061/"},{path:"/02.MySQL/06.æ°æ®åºä¸èå¼.html",redirect:"/pages/9ed061/"},{name:"v-5d98fa16",path:"/pages/a4281a/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5d98fa16").then(t)}},{path:"/pages/a4281a/index.html",redirect:"/pages/a4281a/"},{path:"/02.MySQL/07.MySQLæ°æ®ç±»å.html",redirect:"/pages/a4281a/"},{name:"v-2552a92f",path:"/pages/c10308/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-2552a92f").then(t)}},{path:"/pages/c10308/index.html",redirect:"/pages/c10308/"},{path:"/02.MySQL/08.èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢.html",redirect:"/pages/c10308/"},{name:"v-273d7455",path:"/pages/b85e9d/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-273d7455").then(t)}},{path:"/pages/b85e9d/index.html",redirect:"/pages/b85e9d/"},{path:"/02.MySQL/09.Explainåæ.html",redirect:"/pages/b85e9d/"},{name:"v-d5dc6db4",path:"/pages/92d4ca/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-d5dc6db4").then(t)}},{path:"/pages/92d4ca/index.html",redirect:"/pages/92d4ca/"},{path:"/02.MySQL/10.MySQLä¸­çé.html",redirect:"/pages/92d4ca/"},{name:"v-4a6be083",path:"/pages/1b8a9e/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4a6be083").then(t)}},{path:"/pages/1b8a9e/index.html",redirect:"/pages/1b8a9e/"},{path:"/02.MySQL/100.SQLè®°å½.html",redirect:"/pages/1b8a9e/"},{name:"v-783fbd46",path:"/pages/4f8fa0/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-783fbd46").then(t)}},{path:"/pages/4f8fa0/index.html",redirect:"/pages/4f8fa0/"},{path:"/02.MySQL/99.MySQLå®æ45è®².html",redirect:"/pages/4f8fa0/"},{name:"v-1c9fd64e",path:"/pages/b55c23/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-1c9fd64e").then(t)}},{path:"/pages/b55c23/index.html",redirect:"/pages/b55c23/"},{path:"/02.MySQL/test.html",redirect:"/pages/b55c23/"},{name:"v-5f0f30c6",path:"/pages/redis/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5f0f30c6").then(t)}},{path:"/pages/redis/index.html",redirect:"/pages/redis/"},{path:"/03.Redis/01.redisæ».html",redirect:"/pages/redis/"},{name:"v-51da0e54",path:"/pages/99d0e1/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-51da0e54").then(t)}},{path:"/pages/99d0e1/index.html",redirect:"/pages/99d0e1/"},{path:"/03.Redis/02.redisæ°æ®ç±»å.html",redirect:"/pages/99d0e1/"},{name:"v-78eeb3d8",path:"/pages/f706e8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-78eeb3d8").then(t)}},{path:"/pages/f706e8/index.html",redirect:"/pages/f706e8/"},{path:"/03.Redis/03.rediså½ä»¤.html",redirect:"/pages/f706e8/"},{name:"v-26fa598d",path:"/pages/d7a25d/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-26fa598d").then(t)}},{path:"/pages/d7a25d/index.html",redirect:"/pages/d7a25d/"},{path:"/03.Redis/04.redisæ°æ®ç»æ.html",redirect:"/pages/d7a25d/"},{name:"v-f5ed38f8",path:"/pages/bc6be1/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-f5ed38f8").then(t)}},{path:"/pages/bc6be1/index.html",redirect:"/pages/bc6be1/"},{path:"/03.Redis/05.redisæä¹å.html",redirect:"/pages/bc6be1/"},{name:"v-120df2fa",path:"/pages/effbd9/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-120df2fa").then(t)}},{path:"/pages/effbd9/index.html",redirect:"/pages/effbd9/"},{path:"/03.Redis/06.redisé«å¯ç¨.html",redirect:"/pages/effbd9/"},{name:"v-0082735a",path:"/pages/428106/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-0082735a").then(t)}},{path:"/pages/428106/index.html",redirect:"/pages/428106/"},{path:"/03.Redis/07.rediså é¤ç­ç¥ååå­æ·æ±°æºå¶.html",redirect:"/pages/428106/"},{name:"v-669c40a0",path:"/pages/87b330/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-669c40a0").then(t)}},{path:"/pages/87b330/index.html",redirect:"/pages/87b330/"},{path:"/03.Redis/08.ç¼å­å¸¸è§é®é¢.html",redirect:"/pages/87b330/"},{name:"v-09ae1176",path:"/pages/c8420f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-09ae1176").then(t)}},{path:"/pages/c8420f/index.html",redirect:"/pages/c8420f/"},{path:"/03.Redis/09.redisåºæ¯é¢.html",redirect:"/pages/c8420f/"},{name:"v-4050afac",path:"/pages/5f810a/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4050afac").then(t)}},{path:"/pages/5f810a/index.html",redirect:"/pages/5f810a/"},{path:"/03.Redis/10.redisåå¸å¼é.html",redirect:"/pages/5f810a/"},{name:"v-7dfe13a8",path:"/pages/fafd87/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-7dfe13a8").then(t)}},{path:"/pages/fafd87/index.html",redirect:"/pages/fafd87/"},{path:"/03.Redis/11.redisçrehash.html",redirect:"/pages/fafd87/"},{name:"v-3489417a",path:"/pages/network/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-3489417a").then(t)}},{path:"/pages/network/index.html",redirect:"/pages/network/"},{path:"/04.è®¡ç®æºç½ç»/01.åºç¡/01.ç½ç»åè®®åå±.html",redirect:"/pages/network/"},{name:"v-f8c2901e",path:"/pages/f1d55e/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-f8c2901e").then(t)}},{path:"/pages/f1d55e/index.html",redirect:"/pages/f1d55e/"},{path:"/04.è®¡ç®æºç½ç»/01.åºç¡/02.æµè§å¨å­å¨.html",redirect:"/pages/f1d55e/"},{name:"v-053a73e8",path:"/pages/9ce3d9/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-053a73e8").then(t)}},{path:"/pages/9ce3d9/index.html",redirect:"/pages/9ce3d9/"},{path:"/04.è®¡ç®æºç½ç»/01.åºç¡/03.ç½ç»æ»å».html",redirect:"/pages/9ce3d9/"},{name:"v-6379fc2e",path:"/pages/e1cd04/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6379fc2e").then(t)}},{path:"/pages/e1cd04/index.html",redirect:"/pages/e1cd04/"},{path:"/04.è®¡ç®æºç½ç»/02.åºç¨å±/01.httpçæ¬å¯¹æ¯.html",redirect:"/pages/e1cd04/"},{name:"v-5140306c",path:"/pages/f502d9/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5140306c").then(t)}},{path:"/pages/f502d9/index.html",redirect:"/pages/f502d9/"},{path:"/04.è®¡ç®æºç½ç»/02.åºç¨å±/02.http.html",redirect:"/pages/f502d9/"},{name:"v-0b9e1aec",path:"/pages/43e2c1/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-0b9e1aec").then(t)}},{path:"/pages/43e2c1/index.html",redirect:"/pages/43e2c1/"},{path:"/04.è®¡ç®æºç½ç»/02.åºç¨å±/03.https.html",redirect:"/pages/43e2c1/"},{name:"v-0bf64c24",path:"/pages/524e17/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-0bf64c24").then(t)}},{path:"/pages/524e17/index.html",redirect:"/pages/524e17/"},{path:"/04.è®¡ç®æºç½ç»/02.åºç¨å±/04.dns.html",redirect:"/pages/524e17/"},{name:"v-2767b19c",path:"/pages/5e312c/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-2767b19c").then(t)}},{path:"/pages/5e312c/index.html",redirect:"/pages/5e312c/"},{path:"/04.è®¡ç®æºç½ç»/03.ä¼ è¾å±/01.tcp.html",redirect:"/pages/5e312c/"},{name:"v-1d611f27",path:"/pages/42791d/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-1d611f27").then(t)}},{path:"/pages/42791d/index.html",redirect:"/pages/42791d/"},{path:"/04.è®¡ç®æºç½ç»/04.ç½ç»å±/01.IP.html",redirect:"/pages/42791d/"},{name:"v-8153bf3c",path:"/pages/0b3887/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-8153bf3c").then(t)}},{path:"/pages/0b3887/index.html",redirect:"/pages/0b3887/"},{path:"/05.æä½ç³»ç»/02.Ctrl+Cåçäºä»ä¹.html",redirect:"/pages/0b3887/"},{name:"v-8f229662",path:"/pages/f45a99/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-8f229662").then(t)}},{path:"/pages/f45a99/index.html",redirect:"/pages/f45a99/"},{path:"/06.æ°æ®ç»æåç®æ³/01.æç´¢æçä¸ºlogçæ .html",redirect:"/pages/f45a99/"},{name:"v-8bbcfd3a",path:"/pages/37ba80/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-8bbcfd3a").then(t)}},{path:"/pages/37ba80/index.html",redirect:"/pages/37ba80/"},{path:"/06.æ°æ®ç»æåç®æ³/02.äºåæ¥æ¾.html",redirect:"/pages/37ba80/"},{name:"v-45ced8ca",path:"/pages/os/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-45ced8ca").then(t)}},{path:"/pages/os/index.html",redirect:"/pages/os/"},{path:"/05.æä½ç³»ç»/01.æä½ç³»ç».html",redirect:"/pages/os/"},{name:"v-50a497ba",path:"/pages/ceeb3f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-50a497ba").then(t)}},{path:"/pages/ceeb3f/index.html",redirect:"/pages/ceeb3f/"},{path:"/05.æä½ç³»ç»/03.åå­ç®¡ç.html",redirect:"/pages/ceeb3f/"},{name:"v-d0cbc152",path:"/pages/d2945b/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-d0cbc152").then(t)}},{path:"/pages/d2945b/index.html",redirect:"/pages/d2945b/"},{path:"/06.æ°æ®ç»æåç®æ³/03.äºåæ .html",redirect:"/pages/d2945b/"},{name:"v-d35585c0",path:"/pages/redux/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-d35585c0").then(t)}},{path:"/pages/redux/index.html",redirect:"/pages/redux/"},{path:"/07.åç«¯/01.React/01.redux.html",redirect:"/pages/redux/"},{name:"v-957f7b90",path:"/pages/2d7856/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-957f7b90").then(t)}},{path:"/pages/2d7856/index.html",redirect:"/pages/2d7856/"},{path:"/07.åç«¯/01.React/02.æ¦å¿µ.html",redirect:"/pages/2d7856/"},{name:"v-224a9095",path:"/pages/960017/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-224a9095").then(t)}},{path:"/pages/960017/index.html",redirect:"/pages/960017/"},{path:"/07.åç«¯/01.React/å¿«æ·é®.html",redirect:"/pages/960017/"},{name:"v-70032af0",path:"/pages/9ba4c3/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-70032af0").then(t)}},{path:"/pages/9ba4c3/index.html",redirect:"/pages/9ba4c3/"},{path:"/07.åç«¯/01.jså¼æ­¥ç¼ç¨.html",redirect:"/pages/9ba4c3/"},{name:"v-10ca5dc4",path:"/pages/jwt/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-10ca5dc4").then(t)}},{path:"/pages/jwt/index.html",redirect:"/pages/jwt/"},{path:"/08.æ¹æ¡/01.JWT.html",redirect:"/pages/jwt/"},{name:"v-c92a649c",path:"/pages/8cac0f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c92a649c").then(t)}},{path:"/pages/8cac0f/index.html",redirect:"/pages/8cac0f/"},{path:"/08.æ¹æ¡/02.OAuth2.html",redirect:"/pages/8cac0f/"},{name:"v-76c98d70",path:"/pages/fcd0f1/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-76c98d70").then(t)}},{path:"/pages/fcd0f1/index.html",redirect:"/pages/fcd0f1/"},{path:"/08.æ¹æ¡/03.CORSçè§£å³æ¹æ¡.html",redirect:"/pages/fcd0f1/"},{name:"v-ab00c88e",path:"/pages/95c00f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-ab00c88e").then(t)}},{path:"/pages/95c00f/index.html",redirect:"/pages/95c00f/"},{path:"/08.æ¹æ¡/04.çæ§ç³»ç»éåè°ç .html",redirect:"/pages/95c00f/"},{name:"v-6158f5dc",path:"/pages/165ba8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6158f5dc").then(t)}},{path:"/pages/165ba8/index.html",redirect:"/pages/165ba8/"},{path:"/08.æ¹æ¡/05.redisåå¸å¼éå®ç°.html",redirect:"/pages/165ba8/"},{name:"v-68d67e22",path:"/pages/spring/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-68d67e22").then(t)}},{path:"/pages/spring/index.html",redirect:"/pages/spring/"},{path:"/09.Javaæ¡æ¶/01.Spring/01.Spring.html",redirect:"/pages/spring/"},{name:"v-097ed174",path:"/pages/581456/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-097ed174").then(t)}},{path:"/pages/581456/index.html",redirect:"/pages/581456/"},{path:"/09.Javaæ¡æ¶/01.Spring/02.Spring boot èªå¨è£é.html",redirect:"/pages/581456/"},{name:"v-629046d2",path:"/pages/0bf668/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-629046d2").then(t)}},{path:"/pages/0bf668/index.html",redirect:"/pages/0bf668/"},{path:"/09.Javaæ¡æ¶/01.Spring/03.Spring IOC.html",redirect:"/pages/0bf668/"},{name:"v-80c46bea",path:"/pages/8c1a59/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-80c46bea").then(t)}},{path:"/pages/8c1a59/index.html",redirect:"/pages/8c1a59/"},{path:"/09.Javaæ¡æ¶/01.Spring/04. Spring AOP.html",redirect:"/pages/8c1a59/"},{name:"v-1f84369c",path:"/pages/c3ac4e/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-1f84369c").then(t)}},{path:"/pages/c3ac4e/index.html",redirect:"/pages/c3ac4e/"},{path:"/09.Javaæ¡æ¶/01.Spring/05.Spring MVC.html",redirect:"/pages/c3ac4e/"},{name:"v-e7bc6886",path:"/pages/e00296/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-e7bc6886").then(t)}},{path:"/pages/e00296/index.html",redirect:"/pages/e00296/"},{path:"/09.Javaæ¡æ¶/01.Spring/06.Spring boot starter.html",redirect:"/pages/e00296/"},{name:"v-603745ce",path:"/pages/643d4f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-603745ce").then(t)}},{path:"/pages/643d4f/index.html",redirect:"/pages/643d4f/"},{path:"/09.Javaæ¡æ¶/01.Spring/07.BeanFactoryåFactoryBean.html",redirect:"/pages/643d4f/"},{name:"v-4ae61c39",path:"/pages/329b73/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4ae61c39").then(t)}},{path:"/pages/329b73/index.html",redirect:"/pages/329b73/"},{path:"/09.Javaæ¡æ¶/01.Spring/08.Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ.html",redirect:"/pages/329b73/"},{name:"v-01e74dde",path:"/pages/40cb9b/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-01e74dde").then(t)}},{path:"/pages/40cb9b/index.html",redirect:"/pages/40cb9b/"},{path:"/10.ä¸­é´ä»¶/01.Kafka/02.kafkaé¶æ·è´ææ¯.html",redirect:"/pages/40cb9b/"},{name:"v-c9002668",path:"/pages/5e6384/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c9002668").then(t)}},{path:"/pages/5e6384/index.html",redirect:"/pages/5e6384/"},{path:"/10.ä¸­é´ä»¶/01.Kafka/Kafkaå¤çº¿ç¨æ¶è´¹.html",redirect:"/pages/5e6384/"},{name:"v-129110e4",path:"/pages/279572/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-129110e4").then(t)}},{path:"/pages/279572/index.html",redirect:"/pages/279572/"},{path:"/10.ä¸­é´ä»¶/02.RocketMQ.html",redirect:"/pages/279572/"},{name:"v-34c41a32",path:"/pages/0cf9ab/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-34c41a32").then(t)}},{path:"/pages/0cf9ab/index.html",redirect:"/pages/0cf9ab/"},{path:"/10.ä¸­é´ä»¶/03.Flumeå¿«éä¸æ.html",redirect:"/pages/0cf9ab/"},{name:"v-79517efc",path:"/pages/mq/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-79517efc").then(t)}},{path:"/pages/mq/index.html",redirect:"/pages/mq/"},{path:"/10.ä¸­é´ä»¶/01.æ¶æ¯éåæ¦è¿°.html",redirect:"/pages/mq/"},{name:"v-6bc0f08b",path:"/pages/7c8ab7/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6bc0f08b").then(t)}},{path:"/pages/7c8ab7/index.html",redirect:"/pages/7c8ab7/"},{path:"/10.ä¸­é´ä»¶/04. RocketMQ å Kafka å¯¹æ¯.html",redirect:"/pages/7c8ab7/"},{name:"v-c1084aa0",path:"/pages/git/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c1084aa0").then(t)}},{path:"/pages/git/index.html",redirect:"/pages/git/"},{path:"/100.å·¥å·/01.Git/01.Git commit message è§è.html",redirect:"/pages/git/"},{name:"v-4c9cf11f",path:"/pages/6f9bb5/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4c9cf11f").then(t)}},{path:"/pages/6f9bb5/index.html",redirect:"/pages/6f9bb5/"},{path:"/100.å·¥å·/01.Git/02.åå¹¶æäº¤-rebase.html",redirect:"/pages/6f9bb5/"},{name:"v-7181834a",path:"/pages/0974e8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-7181834a").then(t)}},{path:"/pages/0974e8/index.html",redirect:"/pages/0974e8/"},{path:"/100.å·¥å·/01.Git/03.git pullågit fetch.html",redirect:"/pages/0974e8/"},{name:"v-ea66ad78",path:"/pages/c02964/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-ea66ad78").then(t)}},{path:"/pages/c02964/index.html",redirect:"/pages/c02964/"},{path:"/11. è®¾è®¡æ¨¡å¼/01.åä¾æ¨¡å¼.html",redirect:"/pages/c02964/"},{name:"v-2ede7bc6",path:"/pages/aa154b/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-2ede7bc6").then(t)}},{path:"/pages/aa154b/index.html",redirect:"/pages/aa154b/"},{path:"/100.å·¥å·/03.Docker/01.Dockerå½ä»¤.html",redirect:"/pages/aa154b/"},{name:"v-165dc3de",path:"/pages/d3d9ca/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-165dc3de").then(t)}},{path:"/pages/d3d9ca/index.html",redirect:"/pages/d3d9ca/"},{path:"/100.å·¥å·/02.Linux/02.Linuxå½ä»¤.html",redirect:"/pages/d3d9ca/"},{name:"v-5798a127",path:"/pages/da6600/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5798a127").then(t)}},{path:"/pages/da6600/index.html",redirect:"/pages/da6600/"},{path:"/11. è®¾è®¡æ¨¡å¼/02.å·¥åæ¨¡å¼.html",redirect:"/pages/da6600/"},{name:"v-94d81df6",path:"/pages/aitools/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-94d81df6").then(t)}},{path:"/pages/aitools/index.html",redirect:"/pages/aitools/"},{path:"/12.AI/01.AI  tools.html",redirect:"/pages/aitools/"},{name:"v-49c893e5",path:"/pages/linux/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-49c893e5").then(t)}},{path:"/pages/linux/index.html",redirect:"/pages/linux/"},{path:"/100.å·¥å·/02.Linux/01.Linuxå¸¸ç¨å½ä»¤.html",redirect:"/pages/linux/"},{name:"v-b28245d2",path:"/pages/e945bb/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-b28245d2").then(t)}},{path:"/pages/e945bb/index.html",redirect:"/pages/e945bb/"},{path:"/13.ç³»ç»è®¾è®¡/01.éç¾¤æ­å»ºæ»æè·¯.html",redirect:"/pages/e945bb/"},{name:"v-153f7b50",path:"/pages/27d05d/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-153f7b50").then(t)}},{path:"/pages/27d05d/index.html",redirect:"/pages/27d05d/"},{path:"/99.Code Snippet/01.QuickSort.html",redirect:"/pages/27d05d/"},{name:"v-be922ec8",path:"/pages/dfcd0a/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-be922ec8").then(t)}},{path:"/pages/dfcd0a/index.html",redirect:"/pages/dfcd0a/"},{path:"/99.Code Snippet/02.HeapSort.html",redirect:"/pages/dfcd0a/"},{name:"v-af878584",path:"/pages/c708a0/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-af878584").then(t)}},{path:"/pages/c708a0/index.html",redirect:"/pages/c708a0/"},{path:"/99.Code Snippet/03.Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼.html",redirect:"/pages/c708a0/"},{name:"v-2ffbbf7d",path:"/pages/3c8ef8/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-2ffbbf7d").then(t)}},{path:"/pages/3c8ef8/index.html",redirect:"/pages/3c8ef8/"},{path:"/temp/chatgpt promt engineering for develpers.html",redirect:"/pages/3c8ef8/"},{name:"v-6d33b879",path:"/pages/a3d6e4/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-6d33b879").then(t)}},{path:"/pages/a3d6e4/index.html",redirect:"/pages/a3d6e4/"},{path:"/temp/gradleåmavenå¯¹ç§.html",redirect:"/pages/a3d6e4/"},{name:"v-365b0049",path:"/pages/08f55c/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-365b0049").then(t)}},{path:"/pages/08f55c/index.html",redirect:"/pages/08f55c/"},{path:"/temp/jdkæ°ç¹æ§.html",redirect:"/pages/08f55c/"},{name:"v-7ba276fa",path:"/pages/7a6f3c/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-7ba276fa").then(t)}},{path:"/pages/7a6f3c/index.html",redirect:"/pages/7a6f3c/"},{path:"/temp/juc-all.html",redirect:"/pages/7a6f3c/"},{name:"v-b0095412",path:"/pages/cf4cda/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-b0095412").then(t)}},{path:"/pages/cf4cda/index.html",redirect:"/pages/cf4cda/"},{path:"/temp/lombokçå®ç°åç.html",redirect:"/pages/cf4cda/"},{name:"v-1689eec4",path:"/pages/252ef5/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-1689eec4").then(t)}},{path:"/pages/252ef5/index.html",redirect:"/pages/252ef5/"},{path:"/temp/prompt record.html",redirect:"/pages/252ef5/"},{name:"v-5aaf6e59",path:"/pages/144ecf/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5aaf6e59").then(t)}},{path:"/pages/144ecf/index.html",redirect:"/pages/144ecf/"},{path:"/temp/sentinel.html",redirect:"/pages/144ecf/"},{name:"v-42d727d9",path:"/pages/d16eb4/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-42d727d9").then(t)}},{path:"/pages/d16eb4/index.html",redirect:"/pages/d16eb4/"},{path:"/temp/spring data rest.html",redirect:"/pages/d16eb4/"},{name:"v-91d0c51a",path:"/pages/cfda81/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-91d0c51a").then(t)}},{path:"/pages/cfda81/index.html",redirect:"/pages/cfda81/"},{path:"/temp/spring-temp.html",redirect:"/pages/cfda81/"},{name:"v-5bbea173",path:"/pages/9a2825/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5bbea173").then(t)}},{path:"/pages/9a2825/index.html",redirect:"/pages/9a2825/"},{path:"/temp/springboot3.html",redirect:"/pages/9a2825/"},{name:"v-372121bc",path:"/pages/22b30f/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-372121bc").then(t)}},{path:"/pages/22b30f/index.html",redirect:"/pages/22b30f/"},{path:"/temp/tip: project oriented learning.html",redirect:"/pages/22b30f/"},{name:"v-4452d00c",path:"/pages/6796b2/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-4452d00c").then(t)}},{path:"/pages/6796b2/index.html",redirect:"/pages/6796b2/"},{path:"/temp/å«è¡-mysql.html",redirect:"/pages/6796b2/"},{name:"v-5c5b6663",path:"/pages/7c006d/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-5c5b6663").then(t)}},{path:"/pages/7c006d/index.html",redirect:"/pages/7c006d/"},{path:"/temp/å°ç¥è¯.html",redirect:"/pages/7c006d/"},{name:"v-c4807e92",path:"/pages/fba198/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-c4807e92").then(t)}},{path:"/pages/fba198/index.html",redirect:"/pages/fba198/"},{path:"/temp/æ¥è¯­-promt.html",redirect:"/pages/fba198/"},{name:"v-3fb4f800",path:"/pages/5da819/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-3fb4f800").then(t)}},{path:"/pages/5da819/index.html",redirect:"/pages/5da819/"},{path:"/temp/æ¥è¯­å¨è¯.html",redirect:"/pages/5da819/"},{name:"v-dbde7360",path:"/pages/263c98/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-dbde7360").then(t)}},{path:"/pages/263c98/index.html",redirect:"/pages/263c98/"},{path:"/temp/éç¾¤ååå¸å¼.html",redirect:"/pages/263c98/"},{name:"v-61301819",path:"/archives/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-61301819").then(t)}},{path:"/archives/index.html",redirect:"/archives/"},{path:"/@pages/archivesPage.html",redirect:"/archives/"},{name:"v-262c459c",path:"/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-262c459c").then(t)}},{path:"/index.html",redirect:"/"},{name:"v-36ff78c4",path:"/pages/home/",component:bl,beforeEnter:(n,e,t)=>{ds("Layout","v-36ff78c4").then(t)}},{path:"/pages/home/index.html",redirect:"/pages/home/"},{path:"/ç¥è¯ä½ç³»æ»è§.html",redirect:"/pages/home/"},{path:"*",component:bl}],kl={title:"Boundless wiki",description:"ä¸ä¸ªåºäºVuePressç ç¥è¯ç®¡ç&åå®¢ ä¸»é¢",base:"/",headTags:[["link",{rel:"icon",href:"/img/favicon.ico"}],["meta",{name:"keywords",content:"vuepress,theme,blog,vdoing"}],["meta",{name:"theme-color",content:"#11a8cd"}],["meta",{name:"wwads-cn-verify",content:"6c4b761a28b734fe93831e3fb400ce87"}],["script",{src:"https://cdn.wwads.cn/js/makemoney.js",type:"text/javascript"}]],pages:[{title:"Java æ±æ»",frontmatter:{title:"Java æ±æ»",date:"2023-03-16T23:35:49.000Z",permalink:"/pages/java/"},regularPath:"/01.Java/01.Java%E5%9F%BA%E7%A1%80/01.Java%E6%B1%87%E6%80%BB.html",relativePath:"01.Java/01.Javaåºç¡/01.Javaæ±æ».md",key:"v-e78034fa",path:"/pages/java/",headers:[{level:2,title:"overrideåoverload",slug:"overrideåoverload",normalizedTitle:"overrideåoverload",charIndex:2}],headersStr:"overrideåoverload",content:"# overrideåoverload\n\n * éè½½ (Overload) è¡¨ç¤ºåä¸ä¸ªç±»ä¸­å¯ä»¥æå¤ä¸ªåç§°ç¸åçæ¹æ³ï¼ä½è¿äºæ¹æ³çåæ°åè¡¨åä¸ç¸åï¼å³åæ°ä¸ªæ°ãç±»åæé¡ºåºä¸åï¼ã\n * éå (Override) è¡¨ç¤ºå­ç±»ä¸­çæ¹æ³å¯ä»¥ä¸ç¶ç±»ä¸­çæä¸ªæ¹æ³çåç§° ååæ°å®å¨ç¸åï¼éè¿å­ç±»åå»ºçå®ä¾å¯¹è±¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å°è°ç¨å­ç±»ä¸­çå®ä¹æ¹æ³ï¼è¿ç¸å½äºæç¶ç±»ä¸­å®ä¹çé£ ä¸ªå®å¨ç¸åçæ¹æ³ç»è¦çäºï¼è¿ä¹æ¯é¢åå¯¹è±¡ç¼ç¨çå¤ææ§çä¸ç§è¡¨ç°ãï¼å¤æ³¨ï¼å­ç±»è¦çç¶ç±»çæ¹æ³æ¶ï¼åªè½æ¯ç¶ç±»æåºæ´å°çå¼å¸¸ï¼æèæ¯æåºç¶ç±»æåºçå¼å¸¸ çå­å¼å¸¸ï¼å ä¸ºå­ç±»å¯ä»¥è§£å³ç¶ç±»çä¸äºé®é¢ï¼ä¸è½æ¯ç¶ç±»ææ´å¤çé®é¢ãå­ç±»æ¹æ³çè®¿é®æéåªè½æ¯ç¶ç±»çæ´å¤§ï¼ä¸è½æ´å°ãå¦æç¶ç±»çæ¹æ³ æ¯ private ç±»åï¼é£ä¹ï¼å­ç±»åä¸å­å¨è¦ççéå¶ï¼ç¸å½äºå­ç±»ä¸­å¢å äºä¸ä¸ªå¨æ°çæ¹æ³ãï¼\n\næ»ä¹ï¼éå Overriding æ¯ç¶ç±»ä¸å­ç±»ä¹é´å¤ææ§çä¸ç§è¡¨ç°ï¼éè½½ Overloading æ¯ä¸ä¸ªç±»ä¸­å¤ææ§çä¸ç§è¡¨ç°ãå¾éè¦çä¸ç¹å°±æ¯ï¼Overloaded çæ¹æ³æ¯å¯ä»¥æ¹åè¿åå¼çç±»åã",normalizedContent:"# overrideåoverload\n\n * éè½½ (overload) è¡¨ç¤ºåä¸ä¸ªç±»ä¸­å¯ä»¥æå¤ä¸ªåç§°ç¸åçæ¹æ³ï¼ä½è¿äºæ¹æ³çåæ°åè¡¨åä¸ç¸åï¼å³åæ°ä¸ªæ°ãç±»åæé¡ºåºä¸åï¼ã\n * éå (override) è¡¨ç¤ºå­ç±»ä¸­çæ¹æ³å¯ä»¥ä¸ç¶ç±»ä¸­çæä¸ªæ¹æ³çåç§° ååæ°å®å¨ç¸åï¼éè¿å­ç±»åå»ºçå®ä¾å¯¹è±¡è°ç¨è¿ä¸ªæ¹æ³æ¶ï¼å°è°ç¨å­ç±»ä¸­çå®ä¹æ¹æ³ï¼è¿ç¸å½äºæç¶ç±»ä¸­å®ä¹çé£ ä¸ªå®å¨ç¸åçæ¹æ³ç»è¦çäºï¼è¿ä¹æ¯é¢åå¯¹è±¡ç¼ç¨çå¤ææ§çä¸ç§è¡¨ç°ãï¼å¤æ³¨ï¼å­ç±»è¦çç¶ç±»çæ¹æ³æ¶ï¼åªè½æ¯ç¶ç±»æåºæ´å°çå¼å¸¸ï¼æèæ¯æåºç¶ç±»æåºçå¼å¸¸ çå­å¼å¸¸ï¼å ä¸ºå­ç±»å¯ä»¥è§£å³ç¶ç±»çä¸äºé®é¢ï¼ä¸è½æ¯ç¶ç±»ææ´å¤çé®é¢ãå­ç±»æ¹æ³çè®¿é®æéåªè½æ¯ç¶ç±»çæ´å¤§ï¼ä¸è½æ´å°ãå¦æç¶ç±»çæ¹æ³ æ¯ private ç±»åï¼é£ä¹ï¼å­ç±»åä¸å­å¨è¦ççéå¶ï¼ç¸å½äºå­ç±»ä¸­å¢å äºä¸ä¸ªå¨æ°çæ¹æ³ãï¼\n\næ»ä¹ï¼éå overriding æ¯ç¶ç±»ä¸å­ç±»ä¹é´å¤ææ§çä¸ç§è¡¨ç°ï¼éè½½ overloading æ¯ä¸ä¸ªç±»ä¸­å¤ææ§çä¸ç§è¡¨ç°ãå¾éè¦çä¸ç¹å°±æ¯ï¼overloaded çæ¹æ³æ¯å¯ä»¥æ¹åè¿åå¼çç±»åã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"æ¥å£åæ½è±¡ç±»çåºå«",frontmatter:{title:"æ¥å£åæ½è±¡ç±»çåºå«",date:"2023-03-18T09:27:04.000Z",permalink:"/pages/2ed256/"},regularPath:"/01.Java/01.Java%E5%9F%BA%E7%A1%80/02.%E6%8E%A5%E5%8F%A3%E5%92%8C%E6%8A%BD%E8%B1%A1%E7%B1%BB%E7%9A%84%E5%8C%BA%E5%88%AB.html",relativePath:"01.Java/01.Javaåºç¡/02.æ¥å£åæ½è±¡ç±»çåºå«.md",key:"v-3e714d2a",path:"/pages/2ed256/",headers:[{level:2,title:"ç¸åç¹ï¼",slug:"ç¸åç¹",normalizedTitle:"ç¸åç¹ï¼",charIndex:2},{level:2,title:"ä¸åç¹ï¼",slug:"ä¸åç¹",normalizedTitle:"ä¸åç¹ï¼",charIndex:64},{level:2,title:"æ¥å£",slug:"æ¥å£",normalizedTitle:"æ¥å£",charIndex:23},{level:2,title:"æ½è±¡ç±»",slug:"æ½è±¡ç±»",normalizedTitle:"æ½è±¡ç±»",charIndex:30}],headersStr:"ç¸åç¹ï¼ ä¸åç¹ï¼ æ¥å£ æ½è±¡ç±»",content:"# ç¸åç¹ï¼\n\n * é½ä¸è½è¢«å®ä¾åã\n * æ¥å£çå®ç°ç±»ææ½è±¡ç±»çå­ç±»é½åªæå®ç°äºæ¥å£ææ½è±¡ç±»ä¸­çæ¹æ³åæè½å®ä¾åã\n\n\n# ä¸åç¹ï¼\n\n * æ¥å£å¼ºè°ç¹å®åè½çå®ç°ï¼æ½è±¡ç±»å¼ºè°æå±å³ç³»ã\n * æ¥å£çè®¾è®¡ç®çæ¯å¯¹ç±»çè¡ä¸ºè¿è¡çº¦æï¼ä¸ç§âæâççº¦æï¼ãæ½è±¡ç±»çè®¾è®¡ç®çæ¯ä»£ç å¤ç¨ã\n * æ¥å£åªè½æå®ä¹ï¼ä¸è½ææ¹æ³çå®ç°ï¼Java1.8å¼å§å¯ä»¥å®ä¹defaultæ¹æ³ãæ½è±¡ç±»å¯ä»¥æå®ä¹åå®ç°ã\n * æ¥å£æååéé»è®¤ä¸ºpublic static finalï¼å¿é¡»èµåå¼ï¼ä¸è½è¢«ä¿®æ¹ï¼æåæ¹æ³é½æ¯publicãabstractçãæ½è±¡ç±»ä¸­çæååéé»è®¤defaultï¼å¯å¨å­ç±»ä¸­è¢«éæ°å®ä¹ï¼éæ°èµå¼ï¼æ½è±¡æ¹æ³è¢«abstractä¿®é¥°ï¼ä¹å¯ä»¥ææ®éæ¹æ³ã\n * ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼ä½åªè½ç»§æ¿ä¸ä¸ªæ½è±¡ç±»ã\n\nä¸äºçè§£ï¼\n\næ½è±¡ç±»å°±æ¯æ¥å£åæ®éç±»ä¹é´çè¿æ¸¡ï¼æ½è±¡ç±»åè¡·æ¯ä»£ç å¤ç¨ï¼æ¯å ä¸ºä»å°±æ¯ä¸ªç±»ï¼ä½æ¯ç¨æ½è±¡æ¹æ³è¿ä¸ªä¸è¥¿ä¹å¯ä»¥å¯¹å­ç±»è¿è¡ä¸å®ç¨åº¦ä¸ççº¦æï¼æä»¥æ½è±¡ç±»æ¯è¾éåæ¢æçº¦æï¼åéè¦ä»£ç å¤ç¨çåºæ¯ã\n\nç±»éè¿ç»§æ¿å®ç°æ½è±¡å±æ¬¡åå·ä½å®ç°çå¤ç¨ï¼ä½è¿æ ·å±æ¬¡æ··ä¹±ï¼äºæ¯è¿æ¸¡å°äºæ½è±¡ç±»ï¼åæ¼åä¸ºæ¥å£ç±»+ç»åã\n\næ¥å£ä¸»è¦æ¯ç¨æ¥æ½è±¡æ¹æ³åè½ãå½ä½ å³æ³¨äºç©çæ¬è´¨çæ¶åï¼è¯·ç¨æ½è±¡ç±»ï¼å½ä½ å³æ³¨ä¸ç§æä½çæ¶åï¼ç¨æ¥å£ã\n\næ¥å£éé¢çæ¹æ³åªè½å£°æï¼ä¸è½æå·ä½çå®ç°ãè¿è¯´ææ¥å£æ¯è®¾è®¡çç»æï¼æ½è±¡ç±»æ¯éæçç»æã\n\n\n# æ¥å£\n\n * Javaä¸­æ¥å£ä½¿ç¨interfaceå³é®å­ä¿®é¥°\n * æ¥å£å¯ä»¥åå«åéãæ¹æ³ï¼åéè¢«éå¼æå®ä¸ºpublic static finalï¼æ¹æ³è¢«éå¼æå®ä¸ºpublic abstractï¼JDK1.8ä¹åï¼ï¼ï¼å¯ä»¥å°æ¥å£æ¹æ³æ è®°ä¸º publicï¼å°åéæ è®°ä¸º public static finalãä½ Java è¯­è¨è§èå»ºè®®ä¸è¦ä¹¦åè¿äºå¤ä½çå³é®å­ãï¼\n * æ¥å£æ¯æå¤ç»§æ¿ï¼å³ä¸ä¸ªæ¥å£å¯ä»¥extendså¤ä¸ªæ¥å£ï¼é´æ¥çè§£å³äºJavaä¸­ç±»çåç»§æ¿é®é¢ï¼\n * ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼\n * JDK1.8ä¸­å¯¹æ¥å£å¢å äºæ°çç¹æ§ï¼\n   * é»è®¤æ¹æ³ï¼default methodï¼ï¼JDK 1.8åè®¸ç»æ¥å£æ·»å éæ½è±¡çæ¹æ³å®ç°ï¼ä½å¿é¡»ä½¿ç¨defaultå³é®å­ä¿®é¥°ï¼å®ä¹äºdefaultçæ¹æ³å¯ä»¥ä¸è¢«å®ç°å­ç±»æå®ç°ï¼ä½åªè½è¢«å®ç°å­ç±»çå¯¹è±¡è°ç¨ï¼å¦æå­ç±»å®ç°äºå¤ä¸ªæ¥å£ï¼å¹¶ä¸è¿äºæ¥å£åå«ä¸æ ·çé»è®¤æ¹æ³ï¼åå­ç±»å¿é¡»éåé»è®¤æ¹æ³ï¼\n   * éææ¹æ³ï¼static methodï¼ï¼JDK 1.8ä¸­åè®¸ä½¿ç¨staticå³é®å­ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å¹¶æä¾å®ç°ï¼ç§°ä¸ºæ¥å£éææ¹æ³ãæ¥å£éææ¹æ³åªè½éè¿æ¥å£è°ç¨ï¼æ¥å£å.éææ¹æ³åï¼ã\n * æ¥å£æ¯æ½è±¡ç±»è¿æ½è±¡ãå°è£äºæ¥å£çå®ç°ãå¯ä»¥éä½ä»£ç çè¦ååº¦ï¼æé«ä»£ç çå¯ç»´æ¤æ§åå¯æ©å±æ§ã\n\n\n# æ½è±¡ç±»\n\n * Javaä¸­è¢«abstractå³é®å­ä¿®é¥°çç±»ç§°ä¸ºæ½è±¡ç±»ï¼è¢«abstractå³é®å­ä¿®é¥°çæ¹æ³ç§°ä¸ºæ½è±¡æ¹æ³ï¼æ½è±¡æ¹æ³åªææ¹æ³çå£°æï¼æ²¡ææ¹æ³ä½ã\n * æ½è±¡ç±»ä¸è½è¢«å®ä¾ååªè½è¢«ç»§æ¿ï¼\n * åå«æ½è±¡æ¹æ³çä¸å®æ¯æ½è±¡ç±»ï¼ä½æ¯æ½è±¡ç±»ä¸ä¸å®å«ææ½è±¡æ¹æ³ï¼\n * æ½è±¡ç±»ä¸­çæ½è±¡æ¹æ³çä¿®é¥°ç¬¦åªè½ä¸ºpublicæèprotectedï¼é»è®¤ä¸ºpublicï¼\n * ä¸ä¸ªå­ç±»ç»§æ¿ä¸ä¸ªæ½è±¡ç±»ï¼åå­ç±»å¿é¡»å®ç°ç¶ç±»æ½è±¡æ¹æ³ï¼å¦åå­ç±»ä¹å¿é¡»å®ä¹ä¸ºæ½è±¡ç±»ï¼\n * æ½è±¡ç±»å¯ä»¥åå«å±æ§ãæ¹æ³ãæé æ¹æ³ï¼ä½æ¯æé æ¹æ³ä¸è½ç¨äºå®ä¾åï¼ä¸»è¦ç¨éæ¯è¢«å­ç±»è°ç¨ã",normalizedContent:"# ç¸åç¹ï¼\n\n * é½ä¸è½è¢«å®ä¾åã\n * æ¥å£çå®ç°ç±»ææ½è±¡ç±»çå­ç±»é½åªæå®ç°äºæ¥å£ææ½è±¡ç±»ä¸­çæ¹æ³åæè½å®ä¾åã\n\n\n# ä¸åç¹ï¼\n\n * æ¥å£å¼ºè°ç¹å®åè½çå®ç°ï¼æ½è±¡ç±»å¼ºè°æå±å³ç³»ã\n * æ¥å£çè®¾è®¡ç®çæ¯å¯¹ç±»çè¡ä¸ºè¿è¡çº¦æï¼ä¸ç§âæâççº¦æï¼ãæ½è±¡ç±»çè®¾è®¡ç®çæ¯ä»£ç å¤ç¨ã\n * æ¥å£åªè½æå®ä¹ï¼ä¸è½ææ¹æ³çå®ç°ï¼java1.8å¼å§å¯ä»¥å®ä¹defaultæ¹æ³ãæ½è±¡ç±»å¯ä»¥æå®ä¹åå®ç°ã\n * æ¥å£æååéé»è®¤ä¸ºpublic static finalï¼å¿é¡»èµåå¼ï¼ä¸è½è¢«ä¿®æ¹ï¼æåæ¹æ³é½æ¯publicãabstractçãæ½è±¡ç±»ä¸­çæååéé»è®¤defaultï¼å¯å¨å­ç±»ä¸­è¢«éæ°å®ä¹ï¼éæ°èµå¼ï¼æ½è±¡æ¹æ³è¢«abstractä¿®é¥°ï¼ä¹å¯ä»¥ææ®éæ¹æ³ã\n * ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼ä½åªè½ç»§æ¿ä¸ä¸ªæ½è±¡ç±»ã\n\nä¸äºçè§£ï¼\n\næ½è±¡ç±»å°±æ¯æ¥å£åæ®éç±»ä¹é´çè¿æ¸¡ï¼æ½è±¡ç±»åè¡·æ¯ä»£ç å¤ç¨ï¼æ¯å ä¸ºä»å°±æ¯ä¸ªç±»ï¼ä½æ¯ç¨æ½è±¡æ¹æ³è¿ä¸ªä¸è¥¿ä¹å¯ä»¥å¯¹å­ç±»è¿è¡ä¸å®ç¨åº¦ä¸ççº¦æï¼æä»¥æ½è±¡ç±»æ¯è¾éåæ¢æçº¦æï¼åéè¦ä»£ç å¤ç¨çåºæ¯ã\n\nç±»éè¿ç»§æ¿å®ç°æ½è±¡å±æ¬¡åå·ä½å®ç°çå¤ç¨ï¼ä½è¿æ ·å±æ¬¡æ··ä¹±ï¼äºæ¯è¿æ¸¡å°äºæ½è±¡ç±»ï¼åæ¼åä¸ºæ¥å£ç±»+ç»åã\n\næ¥å£ä¸»è¦æ¯ç¨æ¥æ½è±¡æ¹æ³åè½ãå½ä½ å³æ³¨äºç©çæ¬è´¨çæ¶åï¼è¯·ç¨æ½è±¡ç±»ï¼å½ä½ å³æ³¨ä¸ç§æä½çæ¶åï¼ç¨æ¥å£ã\n\næ¥å£éé¢çæ¹æ³åªè½å£°æï¼ä¸è½æå·ä½çå®ç°ãè¿è¯´ææ¥å£æ¯è®¾è®¡çç»æï¼æ½è±¡ç±»æ¯éæçç»æã\n\n\n# æ¥å£\n\n * javaä¸­æ¥å£ä½¿ç¨interfaceå³é®å­ä¿®é¥°\n * æ¥å£å¯ä»¥åå«åéãæ¹æ³ï¼åéè¢«éå¼æå®ä¸ºpublic static finalï¼æ¹æ³è¢«éå¼æå®ä¸ºpublic abstractï¼jdk1.8ä¹åï¼ï¼ï¼å¯ä»¥å°æ¥å£æ¹æ³æ è®°ä¸º publicï¼å°åéæ è®°ä¸º public static finalãä½ java è¯­è¨è§èå»ºè®®ä¸è¦ä¹¦åè¿äºå¤ä½çå³é®å­ãï¼\n * æ¥å£æ¯æå¤ç»§æ¿ï¼å³ä¸ä¸ªæ¥å£å¯ä»¥extendså¤ä¸ªæ¥å£ï¼é´æ¥çè§£å³äºjavaä¸­ç±»çåç»§æ¿é®é¢ï¼\n * ä¸ä¸ªç±»å¯ä»¥å®ç°å¤ä¸ªæ¥å£ï¼\n * jdk1.8ä¸­å¯¹æ¥å£å¢å äºæ°çç¹æ§ï¼\n   * é»è®¤æ¹æ³ï¼default methodï¼ï¼jdk 1.8åè®¸ç»æ¥å£æ·»å éæ½è±¡çæ¹æ³å®ç°ï¼ä½å¿é¡»ä½¿ç¨defaultå³é®å­ä¿®é¥°ï¼å®ä¹äºdefaultçæ¹æ³å¯ä»¥ä¸è¢«å®ç°å­ç±»æå®ç°ï¼ä½åªè½è¢«å®ç°å­ç±»çå¯¹è±¡è°ç¨ï¼å¦æå­ç±»å®ç°äºå¤ä¸ªæ¥å£ï¼å¹¶ä¸è¿äºæ¥å£åå«ä¸æ ·çé»è®¤æ¹æ³ï¼åå­ç±»å¿é¡»éåé»è®¤æ¹æ³ï¼\n   * éææ¹æ³ï¼static methodï¼ï¼jdk 1.8ä¸­åè®¸ä½¿ç¨staticå³é®å­ä¿®é¥°ä¸ä¸ªæ¹æ³ï¼å¹¶æä¾å®ç°ï¼ç§°ä¸ºæ¥å£éææ¹æ³ãæ¥å£éææ¹æ³åªè½éè¿æ¥å£è°ç¨ï¼æ¥å£å.éææ¹æ³åï¼ã\n * æ¥å£æ¯æ½è±¡ç±»è¿æ½è±¡ãå°è£äºæ¥å£çå®ç°ãå¯ä»¥éä½ä»£ç çè¦ååº¦ï¼æé«ä»£ç çå¯ç»´æ¤æ§åå¯æ©å±æ§ã\n\n\n# æ½è±¡ç±»\n\n * javaä¸­è¢«abstractå³é®å­ä¿®é¥°çç±»ç§°ä¸ºæ½è±¡ç±»ï¼è¢«abstractå³é®å­ä¿®é¥°çæ¹æ³ç§°ä¸ºæ½è±¡æ¹æ³ï¼æ½è±¡æ¹æ³åªææ¹æ³çå£°æï¼æ²¡ææ¹æ³ä½ã\n * æ½è±¡ç±»ä¸è½è¢«å®ä¾ååªè½è¢«ç»§æ¿ï¼\n * åå«æ½è±¡æ¹æ³çä¸å®æ¯æ½è±¡ç±»ï¼ä½æ¯æ½è±¡ç±»ä¸ä¸å®å«ææ½è±¡æ¹æ³ï¼\n * æ½è±¡ç±»ä¸­çæ½è±¡æ¹æ³çä¿®é¥°ç¬¦åªè½ä¸ºpublicæèprotectedï¼é»è®¤ä¸ºpublicï¼\n * ä¸ä¸ªå­ç±»ç»§æ¿ä¸ä¸ªæ½è±¡ç±»ï¼åå­ç±»å¿é¡»å®ç°ç¶ç±»æ½è±¡æ¹æ³ï¼å¦åå­ç±»ä¹å¿é¡»å®ä¹ä¸ºæ½è±¡ç±»ï¼\n * æ½è±¡ç±»å¯ä»¥åå«å±æ§ãæ¹æ³ãæé æ¹æ³ï¼ä½æ¯æé æ¹æ³ä¸è½ç¨äºå®ä¾åï¼ä¸»è¦ç¨éæ¯è¢«å­ç±»è°ç¨ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"åå°ç¸å³",frontmatter:{title:"åå°ç¸å³",date:"2023-09-05T23:47:07.000Z",permalink:"/pages/66f85c/"},regularPath:"/01.Java/01.Java%E5%9F%BA%E7%A1%80/03.%E5%8F%8D%E5%B0%84%E7%9B%B8%E5%85%B3.html",relativePath:"01.Java/01.Javaåºç¡/03.åå°ç¸å³.md",key:"v-407e7564",path:"/pages/66f85c/",headers:[{level:2,title:"Class.getFieldågetDeclaredFieldçåºå«",slug:"class-getfieldågetdeclaredfieldçåºå«",normalizedTitle:"class.getfieldågetdeclaredfieldçåºå«",charIndex:2}],headersStr:"Class.getFieldågetDeclaredFieldçåºå«",content:'# Class.getFieldågetDeclaredFieldçåºå«\n\ngetFieldågetDeclaredFieldé½æ¯Classç±»çæ¹æ³ï¼åå°æååéæ¶ä½¿ç¨ã(getMethodågetDeclaredMethodç±»ä¼¼)\n\ngetFieldï¼è·åä¸ä¸ªç±»ç ==publicæååéï¼åæ¬åºç±»== ã\n\ngetDeclaredFieldï¼è·åä¸ä¸ªç±»ç ==æææååéï¼ä¸åæ¬åºç±»== ã\n\nField.setAccessibleï¼æååéä¸ºprivateæ¶ï¼å¿é¡»è¿è¡æ­¤æä½ã\n\npublic class MyUtil {    \n    \n    public static void main(String[] args) {    \n       testFields();    \n    }    \n        \n    public static void testFields() {    \n        try {    \n            System.out.println("Declared fields: ");    \n            Field[] fields = Dog.class.getDeclaredFields();    \n            for(int i = 0; i < fields.length; i++) {    \n                System.out.println(fields[i].getName()); // æ­¤å¤ç»ææ¯color, name, type, fur    \n            }    \n                \n            System.out.println("Public fields: ");    \n            fields = Dog.class.getFields();    \n            for(int i = 0; i < fields.length; i++) {    \n                System.out.println(fields[i].getName()); // æ­¤å¤ç»ææ¯color, location    \n            }    \n        } catch (Exception e) {    \n            e.printStackTrace();    \n        }    \n    }    \n    \n}    \n    \nclass Dog extends Animal {    \n    public int color;    \n    protected int name;    \n    private int type;    \n    int fur;    \n}    \n    \nclass Animal {    \n    public int location;    \n    protected int age;    \n    private int height;    \n    int length;        \n}\n',normalizedContent:'# class.getfieldågetdeclaredfieldçåºå«\n\ngetfieldågetdeclaredfieldé½æ¯classç±»çæ¹æ³ï¼åå°æååéæ¶ä½¿ç¨ã(getmethodågetdeclaredmethodç±»ä¼¼)\n\ngetfieldï¼è·åä¸ä¸ªç±»ç ==publicæååéï¼åæ¬åºç±»== ã\n\ngetdeclaredfieldï¼è·åä¸ä¸ªç±»ç ==æææååéï¼ä¸åæ¬åºç±»== ã\n\nfield.setaccessibleï¼æååéä¸ºprivateæ¶ï¼å¿é¡»è¿è¡æ­¤æä½ã\n\npublic class myutil {    \n    \n    public static void main(string[] args) {    \n       testfields();    \n    }    \n        \n    public static void testfields() {    \n        try {    \n            system.out.println("declared fields: ");    \n            field[] fields = dog.class.getdeclaredfields();    \n            for(int i = 0; i < fields.length; i++) {    \n                system.out.println(fields[i].getname()); // æ­¤å¤ç»ææ¯color, name, type, fur    \n            }    \n                \n            system.out.println("public fields: ");    \n            fields = dog.class.getfields();    \n            for(int i = 0; i < fields.length; i++) {    \n                system.out.println(fields[i].getname()); // æ­¤å¤ç»ææ¯color, location    \n            }    \n        } catch (exception e) {    \n            e.printstacktrace();    \n        }    \n    }    \n    \n}    \n    \nclass dog extends animal {    \n    public int color;    \n    protected int name;    \n    private int type;    \n    int fur;    \n}    \n    \nclass animal {    \n    public int location;    \n    protected int age;    \n    private int height;    \n    int length;        \n}\n',charsets:{cjk:!0}},{title:"è¯­æ³è®°å½",frontmatter:{title:"è¯­æ³è®°å½",date:"2023-03-26T11:18:05.000Z",permalink:"/pages/d95f75/"},regularPath:"/01.Java/01.Java%E5%9F%BA%E7%A1%80/100.%E8%AF%AD%E6%B3%95%E8%AE%B0%E5%BD%95.html",relativePath:"01.Java/01.Javaåºç¡/100.è¯­æ³è®°å½.md",key:"v-6a669cc4",path:"/pages/d95f75/",headers:[{level:2,title:"æ°ç»æªåæ¹æ³",slug:"æ°ç»æªåæ¹æ³",normalizedTitle:"æ°ç»æªåæ¹æ³",charIndex:2},{level:2,title:"lambda: set to array",slug:"lambda-set-to-array",normalizedTitle:"lambda: set to array",charIndex:250},{level:2,title:"ç­éåºææå¹´é¾å¤§äº18å²çäººï¼å¹¶æç§å§åè¿è¡æåº",slug:"ç­éåºææå¹´é¾å¤§äº18å²çäºº-å¹¶æç§å§åè¿è¡æåº",normalizedTitle:"ç­éåºææå¹´é¾å¤§äº18å²çäººï¼å¹¶æç§å§åè¿è¡æåº",charIndex:367},{level:2,title:"Comparable.compareTo()åComparator.compare()",slug:"comparable-compareto-åcomparator-compare",normalizedTitle:"comparable.compareto()åcomparator.compare()",charIndex:858},{level:2,title:"lambda mapToObj",slug:"lambda-maptoobj",normalizedTitle:"lambda maptoobj",charIndex:1147},{level:2,title:"lambda map",slug:"lambda-map",normalizedTitle:"lambda map",charIndex:1147},{level:2,title:"StringBuilderéç¨ æ¸ç©ºæ°æ®æ¹æ³",slug:"stringbuilderéç¨-æ¸ç©ºæ°æ®æ¹æ³",normalizedTitle:"stringbuilderéç¨ æ¸ç©ºæ°æ®æ¹æ³",charIndex:1595},{level:2,title:"List è½¬ int[]",slug:"list-è½¬-int",normalizedTitle:"list è½¬ int[]",charIndex:1746}],headersStr:"æ°ç»æªåæ¹æ³ lambda: set to array ç­éåºææå¹´é¾å¤§äº18å²çäººï¼å¹¶æç§å§åè¿è¡æåº Comparable.compareTo()åComparator.compare() lambda mapToObj lambda map StringBuilderéç¨ æ¸ç©ºæ°æ®æ¹æ³ List è½¬ int[]",content:'# æ°ç»æªåæ¹æ³\n\n * System.arraycopy(source, sourceStartIndex, target, targetStartIndex, len);\n * int[] target = Arrays.copyOf(source, newLen);\n\nå¦æéè¦å°ä¸ä¸ªæ°ç»çä¸é¨åå¤å¶å°å¦ä¸ä¸ªæ°ç»ä¸­ï¼å¹¶ä¸å·²ç»æäºç®æ æ°ç»ï¼é£ä¹ä½¿ç¨ System.arraycopy() å¯è½æ´å é«æãå¦æéè¦å¤å¶æ´ä¸ªæ°ç»å¹¶è¿åä¸ä¸ªæ°çæ°ç»ï¼åå¯ä»¥ä½¿ç¨ Arrays.copyOf()ã\n\n\n# lambda: set to array\n\nSet<Integer> set = new HashSet<>();\nint[] ints = set.stream().mapToInt(x -> x).toArray();\n\n\n\n# ç­éåºææå¹´é¾å¤§äº18å²çäººï¼å¹¶æç§å§åè¿è¡æåº\n\nList<Person> people = Arrays.asList(new Person("John", 20), new Person("Mary", 25), new Person("Bob", 15));\n\nList<String> names = people.stream()\n                           .filter(person -> person.getAge() > 18)\n                           .sorted((p1, p2) -> p1.getName().compareTo(p2.getName()))\n                           .map(Person::getName)\n                           .collect(Collectors.toList());\n\n\n * compareTo\n\n * map\n\n * collect(Collectors.toList())\n\n\n# Comparable.compareTo()åComparator.compare()\n\nComparableæ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹ä¸ä¸ªç±»çèªç¶æåºé¡ºåºï¼è¯¥æ¥å£ä¸­åªæä¸ä¸ªæ¹æ³compareTo()ã\n\nComparatoræ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹ä¸ä¸ªæ¯è¾å¨ï¼è¯¥æ¥å£ä¸­åªæä¸ä¸ªæ¹æ³compare()ã\n\nä¸¤ä¸ªæ¹æ³çè¿åå¼é½æ¯ä¸ä¸ªæ´æ°ï¼è¡¨ç¤ºæ¯è¾ç»æï¼å¦æè¿åè´æ°è¡¨ç¤ºæ¯è¾èå°äºè¢«æ¯è¾èï¼è¿å0è¡¨ç¤ºç¸ç­ï¼è¿åæ­£æ°è¡¨ç¤ºæ¯è¾èå¤§äºè¢«æ¯è¾èã\n\nå®ä»¬çåºå«å¨äºï¼Comparable.compareTo()æ¹æ³ç¨äºèªç¶æåºï¼èComparator.compare()æ¹æ³ç¨äºèªå®ä¹æåºã\n\n\n# lambda mapToObj\n\nhttps://geek-docs.com/java/java-intstream/g_intstream-maptoobj-java.html\n\nString[] ss = Arrays.stream(nums).mapToObj(Integer::toString)\n        .sorted((s1, s2) -> (s1 + s2).compareTo(s2 + s1)).toArray(String[]::new);\n\n\n\n# lambda map\n\næ´å½¢æ°ç»å¨åå¾å¤æä½ä¹åè¦åboxedæèmapToObj\n\næ´å½¢æ°ç»è½¬åä¸ºåè¡¨ï¼éè¦ååè£boxed\n\n Arrays.stream(nums).boxed().collect(Collectors.toList())\n Arrays.stream(buff).mapToObj(String::valueOf).collect(Collectors.joining(" "))\n\n\n\n# StringBuilderéç¨ æ¸ç©ºæ°æ®æ¹æ³\n\nStringBuilder æ²¡ææä¾clearæemptyæ¹æ³ã æ¸ç©ºæ3ç§æ¹æ³ï¼\n\n 1. æ°çæä¸ä¸ªï¼æ§çç±ç³»ç»èªå¨åæ¶ ;\n 2. ä½¿ç¨ sb.delete(0, sb.length());\n 3. ä½¿ç¨ sb.setLength(0);\n\n\n# List è½¬ int[]\n\nint[] arr = list.toArray(new int[0]);',normalizedContent:'# æ°ç»æªåæ¹æ³\n\n * system.arraycopy(source, sourcestartindex, target, targetstartindex, len);\n * int[] target = arrays.copyof(source, newlen);\n\nå¦æéè¦å°ä¸ä¸ªæ°ç»çä¸é¨åå¤å¶å°å¦ä¸ä¸ªæ°ç»ä¸­ï¼å¹¶ä¸å·²ç»æäºç®æ æ°ç»ï¼é£ä¹ä½¿ç¨ system.arraycopy() å¯è½æ´å é«æãå¦æéè¦å¤å¶æ´ä¸ªæ°ç»å¹¶è¿åä¸ä¸ªæ°çæ°ç»ï¼åå¯ä»¥ä½¿ç¨ arrays.copyof()ã\n\n\n# lambda: set to array\n\nset<integer> set = new hashset<>();\nint[] ints = set.stream().maptoint(x -> x).toarray();\n\n\n\n# ç­éåºææå¹´é¾å¤§äº18å²çäººï¼å¹¶æç§å§åè¿è¡æåº\n\nlist<person> people = arrays.aslist(new person("john", 20), new person("mary", 25), new person("bob", 15));\n\nlist<string> names = people.stream()\n                           .filter(person -> person.getage() > 18)\n                           .sorted((p1, p2) -> p1.getname().compareto(p2.getname()))\n                           .map(person::getname)\n                           .collect(collectors.tolist());\n\n\n * compareto\n\n * map\n\n * collect(collectors.tolist())\n\n\n# comparable.compareto()åcomparator.compare()\n\ncomparableæ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹ä¸ä¸ªç±»çèªç¶æåºé¡ºåºï¼è¯¥æ¥å£ä¸­åªæä¸ä¸ªæ¹æ³compareto()ã\n\ncomparatoræ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹ä¸ä¸ªæ¯è¾å¨ï¼è¯¥æ¥å£ä¸­åªæä¸ä¸ªæ¹æ³compare()ã\n\nä¸¤ä¸ªæ¹æ³çè¿åå¼é½æ¯ä¸ä¸ªæ´æ°ï¼è¡¨ç¤ºæ¯è¾ç»æï¼å¦æè¿åè´æ°è¡¨ç¤ºæ¯è¾èå°äºè¢«æ¯è¾èï¼è¿å0è¡¨ç¤ºç¸ç­ï¼è¿åæ­£æ°è¡¨ç¤ºæ¯è¾èå¤§äºè¢«æ¯è¾èã\n\nå®ä»¬çåºå«å¨äºï¼comparable.compareto()æ¹æ³ç¨äºèªç¶æåºï¼ècomparator.compare()æ¹æ³ç¨äºèªå®ä¹æåºã\n\n\n# lambda maptoobj\n\nhttps://geek-docs.com/java/java-intstream/g_intstream-maptoobj-java.html\n\nstring[] ss = arrays.stream(nums).maptoobj(integer::tostring)\n        .sorted((s1, s2) -> (s1 + s2).compareto(s2 + s1)).toarray(string[]::new);\n\n\n\n# lambda map\n\næ´å½¢æ°ç»å¨åå¾å¤æä½ä¹åè¦åboxedæèmaptoobj\n\næ´å½¢æ°ç»è½¬åä¸ºåè¡¨ï¼éè¦ååè£boxed\n\n arrays.stream(nums).boxed().collect(collectors.tolist())\n arrays.stream(buff).maptoobj(string::valueof).collect(collectors.joining(" "))\n\n\n\n# stringbuilderéç¨ æ¸ç©ºæ°æ®æ¹æ³\n\nstringbuilder æ²¡ææä¾clearæemptyæ¹æ³ã æ¸ç©ºæ3ç§æ¹æ³ï¼\n\n 1. æ°çæä¸ä¸ªï¼æ§çç±ç³»ç»èªå¨åæ¶ ;\n 2. ä½¿ç¨ sb.delete(0, sb.length());\n 3. ä½¿ç¨ sb.setlength(0);\n\n\n# list è½¬ int[]\n\nint[] arr = list.toarray(new int[0]);',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ArrayList",frontmatter:{title:"ArrayList",date:"2023-03-28T14:21:33.000Z",permalink:"/pages/collection/"},regularPath:"/01.Java/02.Java%E9%9B%86%E5%90%88/01.ArrayList.html",relativePath:"01.Java/02.Javaéå/01.ArrayList.md",key:"v-3897df61",path:"/pages/collection/",headers:[{level:2,title:"ArrayList å LinkedListçåºå«",slug:"arraylist-å-linkedlistçåºå«",normalizedTitle:"arraylist å linkedlistçåºå«",charIndex:2},{level:2,title:"ArrayListçæ©å®¹æºå¶",slug:"arraylistçæ©å®¹æºå¶",normalizedTitle:"arraylistçæ©å®¹æºå¶",charIndex:455},{level:2,title:"ArrayListçæé æ¹æ³",slug:"arraylistçæé æ¹æ³",normalizedTitle:"arraylistçæé æ¹æ³",charIndex:832}],headersStr:"ArrayList å LinkedListçåºå« ArrayListçæ©å®¹æºå¶ ArrayListçæé æ¹æ³",content:"# ArrayList å LinkedListçåºå«\n\nArrayListï¼åºå±æ¯åºäºæ°ç»å®ç°çï¼æ¥æ¾å¿«ï¼å¢å è¾æ¢ï¼\n\nLinkedListï¼åºå±æ¯åºäºé¾è¡¨å®ç°çãç¡®åçè¯´æ¯å¾ªç¯ååé¾è¡¨ï¼JDK1.6 ä¹åæ¯ååå¾ªç¯é¾è¡¨ãJDK1.7 ä¹ååæ¶äºå¾ªç¯ï¼ï¼æ¥æ¾æ¢ãå¢å å¿«ã\n\nArrayList çå¢å æªå¿å°±æ¯æ¯ LinkedList è¦æ¢ï¼\n\n 1. å¦æå¢å é½æ¯å¨æ«å°¾æ¥æä½ãæ¯æ¬¡è°ç¨çé½æ¯ remove() å add()ãï¼æ­¤æ¶ ArrayList å°±ä¸éè¦ç§»å¨åå¤å¶æ°ç»æ¥è¿è¡æä½äºãå¦ææ°æ®éæç¾ä¸çº§çæ¶ï¼éåº¦æ¯ä¼æ¯ LinkedList è¦å¿«çã\n 2. å¦æå é¤æä½çä½ç½®æ¯å¨ä¸­é´ãç±äº LinkedList çæ¶èä¸»è¦æ¯å¨éåä¸ï¼ArrayList çæ¶èä¸»è¦æ¯å¨ç§»å¨åå¤å¶ä¸ï¼åºå±è°ç¨çæ¯ arraycopy() æ¹æ³ï¼æ¯ native æ¹æ³ï¼ãLinkedList çéåéåº¦æ¯è¦æ¢äº ArrayList çå¤å¶ç§»å¨éåº¦çå¦ææ°æ®éæç¾ä¸çº§çæ¶ï¼è¿æ¯ ArrayList è¦å¿«ã\n\n\n# ArrayListçæ©å®¹æºå¶\n\n 1. å½ä½¿ç¨ add æ¹æ³çæ¶åé¦åè°ç¨ ensureCapacityInternal æ¹æ³ï¼ä¼ å¥ size+1 è¿å»ï¼æ£æ¥æ¯å¦éè¦æ©å elementData æ°ç»çå¤§å°ï¼\n 2. newCapacity = æ©åæ°ç»ä¸ºåæ¥ç 1.5 å(ä¸è½èªå®ä¹)ï¼å¦æè¿ä¸å¤ï¼å°±ä½¿ç¨å®æå®è¦æ©åçå¤§å° minCapacity ï¼ç¶åå¤æ­ minCapacity æ¯å¦å¤§äº MAX_ARRAY_SIZE(Integer.MAX_VALUE â 8) ï¼å¦æå¤§äºï¼å°±å Integer.MAX_VALUEï¼\n 3. æ©å®¹çä¸»è¦æ¹æ³ï¼growï¼\n 4. ArrayList ä¸­ copy æ°ç»çæ ¸å¿å°±æ¯ System.arraycopy æ¹æ³ï¼å° original æ°ç»çæææ°æ®å¤å¶å° copy æ°ç»ä¸­ï¼è¿æ¯ä¸ä¸ªæ¬å°æ¹æ³ã\n\n\n# ArrayListçæé æ¹æ³\n\n * æ åæé ï¼å»¶è¿åå§åï¼\n   * æé æ¹æ³ä¸­å°elementDataåå§åä¸ºç©ºæ°ç»DEFAULTCAPACITY_EMPTY_ELEMENTDATA\n   * å½è°ç¨addæ¹æ³æ·»å ç¬¬ä¸ä¸ªåç´ çæ¶åï¼ä¼è¿è¡æ©å®¹\n   * æ©å®¹è³å¤§å°ä¸ºDEFAULT_CAPACITY=10\n * æåæé  public ArrayList(int initialCapacity)\n   * åæ°å¤§äº0ï¼elementDataåå§åä¸ºinitialCapacityå¤§å°çæ°ç»\n   * åæ°ç­äº0ï¼elementDataåå§åä¸ºç©ºæ°ç»\n   * åæ°å°äº0ï¼æåºå¼å¸¸",normalizedContent:"# arraylist å linkedlistçåºå«\n\narraylistï¼åºå±æ¯åºäºæ°ç»å®ç°çï¼æ¥æ¾å¿«ï¼å¢å è¾æ¢ï¼\n\nlinkedlistï¼åºå±æ¯åºäºé¾è¡¨å®ç°çãç¡®åçè¯´æ¯å¾ªç¯ååé¾è¡¨ï¼jdk1.6 ä¹åæ¯ååå¾ªç¯é¾è¡¨ãjdk1.7 ä¹ååæ¶äºå¾ªç¯ï¼ï¼æ¥æ¾æ¢ãå¢å å¿«ã\n\narraylist çå¢å æªå¿å°±æ¯æ¯ linkedlist è¦æ¢ï¼\n\n 1. å¦æå¢å é½æ¯å¨æ«å°¾æ¥æä½ãæ¯æ¬¡è°ç¨çé½æ¯ remove() å add()ãï¼æ­¤æ¶ arraylist å°±ä¸éè¦ç§»å¨åå¤å¶æ°ç»æ¥è¿è¡æä½äºãå¦ææ°æ®éæç¾ä¸çº§çæ¶ï¼éåº¦æ¯ä¼æ¯ linkedlist è¦å¿«çã\n 2. å¦æå é¤æä½çä½ç½®æ¯å¨ä¸­é´ãç±äº linkedlist çæ¶èä¸»è¦æ¯å¨éåä¸ï¼arraylist çæ¶èä¸»è¦æ¯å¨ç§»å¨åå¤å¶ä¸ï¼åºå±è°ç¨çæ¯ arraycopy() æ¹æ³ï¼æ¯ native æ¹æ³ï¼ãlinkedlist çéåéåº¦æ¯è¦æ¢äº arraylist çå¤å¶ç§»å¨éåº¦çå¦ææ°æ®éæç¾ä¸çº§çæ¶ï¼è¿æ¯ arraylist è¦å¿«ã\n\n\n# arraylistçæ©å®¹æºå¶\n\n 1. å½ä½¿ç¨ add æ¹æ³çæ¶åé¦åè°ç¨ ensurecapacityinternal æ¹æ³ï¼ä¼ å¥ size+1 è¿å»ï¼æ£æ¥æ¯å¦éè¦æ©å elementdata æ°ç»çå¤§å°ï¼\n 2. newcapacity = æ©åæ°ç»ä¸ºåæ¥ç 1.5 å(ä¸è½èªå®ä¹)ï¼å¦æè¿ä¸å¤ï¼å°±ä½¿ç¨å®æå®è¦æ©åçå¤§å° mincapacity ï¼ç¶åå¤æ­ mincapacity æ¯å¦å¤§äº max_array_size(integer.max_value â 8) ï¼å¦æå¤§äºï¼å°±å integer.max_valueï¼\n 3. æ©å®¹çä¸»è¦æ¹æ³ï¼growï¼\n 4. arraylist ä¸­ copy æ°ç»çæ ¸å¿å°±æ¯ system.arraycopy æ¹æ³ï¼å° original æ°ç»çæææ°æ®å¤å¶å° copy æ°ç»ä¸­ï¼è¿æ¯ä¸ä¸ªæ¬å°æ¹æ³ã\n\n\n# arraylistçæé æ¹æ³\n\n * æ åæé ï¼å»¶è¿åå§åï¼\n   * æé æ¹æ³ä¸­å°elementdataåå§åä¸ºç©ºæ°ç»defaultcapacity_empty_elementdata\n   * å½è°ç¨addæ¹æ³æ·»å ç¬¬ä¸ä¸ªåç´ çæ¶åï¼ä¼è¿è¡æ©å®¹\n   * æ©å®¹è³å¤§å°ä¸ºdefault_capacity=10\n * æåæé  public arraylist(int initialcapacity)\n   * åæ°å¤§äº0ï¼elementdataåå§åä¸ºinitialcapacityå¤§å°çæ°ç»\n   * åæ°ç­äº0ï¼elementdataåå§åä¸ºç©ºæ°ç»\n   * åæ°å°äº0ï¼æåºå¼å¸¸",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"HashMap",frontmatter:{title:"HashMap",date:"2023-03-28T14:22:29.000Z",permalink:"/pages/d249ac/"},regularPath:"/01.Java/02.Java%E9%9B%86%E5%90%88/02.HashMap.html",relativePath:"01.Java/02.Javaéå/02.HashMap.md",key:"v-5ddc5e71",path:"/pages/d249ac/",headers:[{level:2,title:"HashMapçåºå±æ°æ®ç»æ",slug:"hashmapçåºå±æ°æ®ç»æ",normalizedTitle:"hashmapçåºå±æ°æ®ç»æ",charIndex:2},{level:2,title:"HashMapçputæ¹æ³æ§è¡è¿ç¨",slug:"hashmapçputæ¹æ³æ§è¡è¿ç¨",normalizedTitle:"hashmapçputæ¹æ³æ§è¡è¿ç¨",charIndex:21},{level:2,title:"HashMapçgetæ¹æ³æ§è¡è¿ç¨",slug:"hashmapçgetæ¹æ³æ§è¡è¿ç¨",normalizedTitle:"hashmapçgetæ¹æ³æ§è¡è¿ç¨",charIndex:43},{level:2,title:"HashMapçresizeæ¹æ³æ§è¡è¿ç¨",slug:"hashmapçresizeæ¹æ³æ§è¡è¿ç¨",normalizedTitle:"hashmapçresizeæ¹æ³æ§è¡è¿ç¨",charIndex:65},{level:2,title:"HashMapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹",slug:"hashmapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹",normalizedTitle:"hashmapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹",charIndex:3276},{level:2,title:"HashMapå¤çº¿ç¨æ­»å¾ªç¯é®é¢",slug:"hashmapå¤çº¿ç¨æ­»å¾ªç¯é®é¢",normalizedTitle:"hashmapå¤çº¿ç¨æ­»å¾ªç¯é®é¢",charIndex:3606},{level:2,title:"HashMap ç get æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨ map ä¸­",slug:"hashmap-ç-get-æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨-map-ä¸­",normalizedTitle:"hashmap ç get æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨ map ä¸­",charIndex:4406}],headersStr:"HashMapçåºå±æ°æ®ç»æ HashMapçputæ¹æ³æ§è¡è¿ç¨ HashMapçgetæ¹æ³æ§è¡è¿ç¨ HashMapçresizeæ¹æ³æ§è¡è¿ç¨ HashMapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹ HashMapå¤çº¿ç¨æ­»å¾ªç¯é®é¢ HashMap ç get æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨ map ä¸­",content:'# HashMapçåºå±æ°æ®ç»æ\n\n\n# HashMapçputæ¹æ³æ§è¡è¿ç¨\n\n\n# HashMapçgetæ¹æ³æ§è¡è¿ç¨\n\n\n# HashMapçresizeæ¹æ³æ§è¡è¿ç¨\n\n 1. åå»ºä¸ä¸ªä¸¤åçæ°æ°ç» newCap = oldCap << 1\n 2. å¾ªç¯æ§æ°ç»ï¼å¾ªç¯é¾è¡¨ï¼å¯¹æ¯ä¸ªåç´  rehashã\n    1. æ°ä½ç½®ä¼æ¯æ§ä½ç½®ï¼æèæ¯æ§ä½ç½®+åæ°ç»é¿åº¦ãæä»¥å°±åäºä¸¤ä¸ª node é¾è¡¨å»å­ãå³ååè¡¨ä¼åæ£æ2ä¸ªã\n\nfinal Node<K,V>[] resize() {\n        Node<K,V>[] oldTab = table;\n        int oldCap = (oldTab == null) ? 0 : oldTab.length;\n        int oldThr = threshold;\n        int newCap, newThr = 0;\n        if (oldCap > 0) {\n            if (oldCap >= MAXIMUM_CAPACITY) {\n                threshold = Integer.MAX_VALUE;\n                return oldTab;\n            }\n            else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                     oldCap >= DEFAULT_INITIAL_CAPACITY)\n                newThr = oldThr << 1; // double threshold\n        }\n        else if (oldThr > 0) // initial capacity was placed in threshold\n            newCap = oldThr;\n        else {               // zero initial threshold signifies using defaults\n            newCap = DEFAULT_INITIAL_CAPACITY;\n            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n        }\n        if (newThr == 0) {\n            float ft = (float)newCap * loadFactor;\n            newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                      (int)ft : Integer.MAX_VALUE);\n        }\n        threshold = newThr;\n        @SuppressWarnings({"rawtypes","unchecked"})\n        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n        table = newTab;\n        if (oldTab != null) {\n            for (int j = 0; j < oldCap; ++j) {\n                Node<K,V> e;\n                if ((e = oldTab[j]) != null) {\n                    oldTab[j] = null;\n                    if (e.next == null)\n                        newTab[e.hash & (newCap - 1)] = e;\n                    else if (e instanceof TreeNode)\n                        ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                    else { // preserve order\n                        Node<K,V> loHead = null, loTail = null;\n                        Node<K,V> hiHead = null, hiTail = null;\n                        Node<K,V> next;\n                        do {\n                            next = e.next;\n                            if ((e.hash & oldCap) == 0) {\n                                if (loTail == null)\n                                    loHead = e;\n                                else\n                                    loTail.next = e;\n                                loTail = e;\n                            }\n                            else {\n                                if (hiTail == null)\n                                    hiHead = e;\n                                else\n                                    hiTail.next = e;\n                                hiTail = e;\n                            }\n                        } while ((e = next) != null);\n                        if (loTail != null) {\n                            loTail.next = null;\n                            newTab[j] = loHead;\n                        }\n                        if (hiTail != null) {\n                            hiTail.next = null;\n                            newTab[j + oldCap] = hiHead;\n                        }\n                    }\n                }\n            }\n        }\n        return newTab;\n    }\n\n\n\n# HashMapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹\n\nå ä¸ºåç´ å¨æ°ç»ä¸­çä½ç½®æ¯æ ¹æ® hash & (size - 1)è·åçï¼è¿ä¸ªæä½åªæå½sizeä¸º2çnæ¬¡å¹æ¶ï¼æç­ä»·äºåä½æä½ã\n\néåº¦æ¯ç´æ¥åä½å¿«å¾å¤ï¼å¹¶ä¸æ²¡æç©ºé´æµªè´¹ã\n\nå¦æ length ä¸æ¯ 2 çæ¬¡å¹ï¼æ¯å¦ï¼length ä¸º 15ï¼å length â 1 ä¸º 14ï¼å¯¹åºçäºè¿å¶ä¸º 1110ï¼å¨äº h ä¸æä½ï¼æåä¸ä½é½ä¸º 0 ï¼è 0001ï¼0011ï¼0101ï¼1001ï¼1011ï¼0111ï¼1101 è¿å ä¸ªä½ç½®æ°¸è¿é½ä¸è½å­æ¾åç´ äºï¼ç©ºé´æµªè´¹ç¸å½å¤§ï¼æ´ç³çæ¯è¿ç§æåµä¸­ï¼æ°ç»å¯ä»¥ä½¿ç¨çä½ç½®æ¯æ°ç»é¿åº¦å°äºå¾å¤ï¼è¿æå³çè¿ä¸æ­¥å¢å äºç¢°æçå çï¼åæ¢äºæ¥è¯¢çæçï¼è¿æ ·å°±ä¼é æç©ºé´çæµªè´¹ã\n\n\n# HashMapå¤çº¿ç¨æ­»å¾ªç¯é®é¢\n\nJava 1.8åï¼\n\nå¨å¤çº¿ç¨ç¯å¢ä¸ï¼ä½¿ç¨HashMapå¯è½ä¼åºç°æ­»å¾ªç¯é®é¢ï¼å·ä½åå æ¯ç±äºHashMapå¨è¿è¡æ©å®¹ï¼resizeï¼æä½æ¶ï¼å¦æå¤ä¸ªçº¿ç¨åæ¶æ§è¡resizeæä½ï¼å¯è½ä¼å¯¼è´å¶ä¸­ä¸ä¸ªçº¿ç¨æ©å®¹æ¶å¯¹é¾è¡¨è¿è¡æåæ¶ï¼å¦ä¸ä¸ªçº¿ç¨å¹¶ä¸ç¥éå·²ç»è¢«æåï¼ä»ç¶å¨åæ¥çé¾è¡¨ä¸éåï¼ä»èé ææ­»å¾ªç¯ãæ©å®¹è¿ç¨ä¸­ä½¿ç¨å¤´ææ³å°oldTableä¸­çåé¾è¡¨ä¸­çèç¹æå¥å°newTableçåé¾è¡¨ä¸­ï¼æä»¥newTableä¸­çåé¾è¡¨ä¼åç½®oldTableä¸­çåé¾è¡¨ãé£ä¹å¨å¤ä¸ªçº¿ç¨åæ¶æ©å®¹çæåµä¸å°±å¯è½å¯¼è´æ©å®¹åçHashMapä¸­å­å¨ä¸ä¸ªæç¯çåé¾è¡¨ï¼ä»èå¯¼è´åç»­æ§è¡getæä½çæ¶åï¼ä¼è§¦åæ­»å¾ªç¯ï¼å¼èµ·CPUç100%é®é¢ã\n\nè§£å³è¯¥é®é¢çæ¹æ³ä¸è¬æä»¥ä¸å ç§ï¼\n\n 1. ä½¿ç¨çº¿ç¨å®å¨çMapå®ç°ï¼å¦ConcurrentHashMapç­ã\n 2. å¨å¤çº¿ç¨ç¯å¢ä¸ï¼å°½éé¿åå¯¹åä¸ä¸ªHashMapè¿è¡å¹¶åä¿®æ¹æä½ï¼å¯ä»¥ä½¿ç¨åæ®µéç­æ¹æ³è¿è¡åæ­¥æ§å¶ã\n 3. å¨HashMapä¸­ï¼å°å®¹ééå¼è®¾å¾è¶³å¤å¤§ï¼ä»¥åå°resizeæä½çé¢çï¼ä»èéä½åºç°æ­»å¾ªç¯çæ¦çã\n 4. ä½¿ç¨å¶ä»çæ°æ®ç»æï¼å¦TreeMapãLinkedHashMapç­ï¼è¿äºæ°æ®ç»æå¨ä¸å®ç¨åº¦ä¸é¿åäºåå¸å²çªçé®é¢ã\n\nè½ç¶Java1.8éç¨å°¾ææ³è§£å³äºå¤çº¿ç¨ä¸å¯è½åºç°çæ­»å¾ªç¯é®é¢ï¼ä½å¦æå¨å¤çº¿ç¨ç¯å¢ä¸å¯¹åä¸ä¸ªHashMapè¿è¡å¹¶åä¿®æ¹æä½ï¼ä»ç¶å¯è½ä¼åçä¸äºå¶ä»ççº¿ç¨å®å¨é®é¢ï¼å¦å¹¶åæå¥ï¼æ°æ®è¦çé®é¢ï¼ãå é¤ãéåç­æä½å¯è½ä¼å¯¼è´æ°æ®ä¸ä¸è´æèConcurrentModificationExceptionå¼å¸¸ç­é®é¢ï¼å æ­¤å¨ä½¿ç¨HashMapæ¶ä»ç¶éè¦æ³¨æçº¿ç¨å®å¨é®é¢ãä¸ºäºé¿åè¿äºé®é¢ï¼å¯ä»¥éæ©ä½¿ç¨çº¿ç¨å®å¨çMapå®ç°ï¼å¦ConcurrentHashMapï¼æèéè¿åéçåæ­¥æ§å¶æ¹å¼æ¥ä¿è¯çº¿ç¨å®å¨ã\n\n\n# HashMap ç get æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨ map ä¸­\n\nä¸è½ãå ä¸º get è¿å null æå¯è½æ¯ä¸åå«è¯¥ keyï¼ä¹æå¯è½è¯¥ key å¯¹åºç value ä¸º nullãå ä¸º HashMap ä¸­åè®¸ key ä¸º nullï¼ä¹åè®¸ value ä¸º nullã',normalizedContent:'# hashmapçåºå±æ°æ®ç»æ\n\n\n# hashmapçputæ¹æ³æ§è¡è¿ç¨\n\n\n# hashmapçgetæ¹æ³æ§è¡è¿ç¨\n\n\n# hashmapçresizeæ¹æ³æ§è¡è¿ç¨\n\n 1. åå»ºä¸ä¸ªä¸¤åçæ°æ°ç» newcap = oldcap << 1\n 2. å¾ªç¯æ§æ°ç»ï¼å¾ªç¯é¾è¡¨ï¼å¯¹æ¯ä¸ªåç´  rehashã\n    1. æ°ä½ç½®ä¼æ¯æ§ä½ç½®ï¼æèæ¯æ§ä½ç½®+åæ°ç»é¿åº¦ãæä»¥å°±åäºä¸¤ä¸ª node é¾è¡¨å»å­ãå³ååè¡¨ä¼åæ£æ2ä¸ªã\n\nfinal node<k,v>[] resize() {\n        node<k,v>[] oldtab = table;\n        int oldcap = (oldtab == null) ? 0 : oldtab.length;\n        int oldthr = threshold;\n        int newcap, newthr = 0;\n        if (oldcap > 0) {\n            if (oldcap >= maximum_capacity) {\n                threshold = integer.max_value;\n                return oldtab;\n            }\n            else if ((newcap = oldcap << 1) < maximum_capacity &&\n                     oldcap >= default_initial_capacity)\n                newthr = oldthr << 1; // double threshold\n        }\n        else if (oldthr > 0) // initial capacity was placed in threshold\n            newcap = oldthr;\n        else {               // zero initial threshold signifies using defaults\n            newcap = default_initial_capacity;\n            newthr = (int)(default_load_factor * default_initial_capacity);\n        }\n        if (newthr == 0) {\n            float ft = (float)newcap * loadfactor;\n            newthr = (newcap < maximum_capacity && ft < (float)maximum_capacity ?\n                      (int)ft : integer.max_value);\n        }\n        threshold = newthr;\n        @suppresswarnings({"rawtypes","unchecked"})\n        node<k,v>[] newtab = (node<k,v>[])new node[newcap];\n        table = newtab;\n        if (oldtab != null) {\n            for (int j = 0; j < oldcap; ++j) {\n                node<k,v> e;\n                if ((e = oldtab[j]) != null) {\n                    oldtab[j] = null;\n                    if (e.next == null)\n                        newtab[e.hash & (newcap - 1)] = e;\n                    else if (e instanceof treenode)\n                        ((treenode<k,v>)e).split(this, newtab, j, oldcap);\n                    else { // preserve order\n                        node<k,v> lohead = null, lotail = null;\n                        node<k,v> hihead = null, hitail = null;\n                        node<k,v> next;\n                        do {\n                            next = e.next;\n                            if ((e.hash & oldcap) == 0) {\n                                if (lotail == null)\n                                    lohead = e;\n                                else\n                                    lotail.next = e;\n                                lotail = e;\n                            }\n                            else {\n                                if (hitail == null)\n                                    hihead = e;\n                                else\n                                    hitail.next = e;\n                                hitail = e;\n                            }\n                        } while ((e = next) != null);\n                        if (lotail != null) {\n                            lotail.next = null;\n                            newtab[j] = lohead;\n                        }\n                        if (hitail != null) {\n                            hitail.next = null;\n                            newtab[j + oldcap] = hihead;\n                        }\n                    }\n                }\n            }\n        }\n        return newtab;\n    }\n\n\n\n# hashmapçsizeä¸ºä»ä¹å¿é¡»æ¯2çæ´æ°æ¬¡æ¹\n\nå ä¸ºåç´ å¨æ°ç»ä¸­çä½ç½®æ¯æ ¹æ® hash & (size - 1)è·åçï¼è¿ä¸ªæä½åªæå½sizeä¸º2çnæ¬¡å¹æ¶ï¼æç­ä»·äºåä½æä½ã\n\néåº¦æ¯ç´æ¥åä½å¿«å¾å¤ï¼å¹¶ä¸æ²¡æç©ºé´æµªè´¹ã\n\nå¦æ length ä¸æ¯ 2 çæ¬¡å¹ï¼æ¯å¦ï¼length ä¸º 15ï¼å length â 1 ä¸º 14ï¼å¯¹åºçäºè¿å¶ä¸º 1110ï¼å¨äº h ä¸æä½ï¼æåä¸ä½é½ä¸º 0 ï¼è 0001ï¼0011ï¼0101ï¼1001ï¼1011ï¼0111ï¼1101 è¿å ä¸ªä½ç½®æ°¸è¿é½ä¸è½å­æ¾åç´ äºï¼ç©ºé´æµªè´¹ç¸å½å¤§ï¼æ´ç³çæ¯è¿ç§æåµä¸­ï¼æ°ç»å¯ä»¥ä½¿ç¨çä½ç½®æ¯æ°ç»é¿åº¦å°äºå¾å¤ï¼è¿æå³çè¿ä¸æ­¥å¢å äºç¢°æçå çï¼åæ¢äºæ¥è¯¢çæçï¼è¿æ ·å°±ä¼é æç©ºé´çæµªè´¹ã\n\n\n# hashmapå¤çº¿ç¨æ­»å¾ªç¯é®é¢\n\njava 1.8åï¼\n\nå¨å¤çº¿ç¨ç¯å¢ä¸ï¼ä½¿ç¨hashmapå¯è½ä¼åºç°æ­»å¾ªç¯é®é¢ï¼å·ä½åå æ¯ç±äºhashmapå¨è¿è¡æ©å®¹ï¼resizeï¼æä½æ¶ï¼å¦æå¤ä¸ªçº¿ç¨åæ¶æ§è¡resizeæä½ï¼å¯è½ä¼å¯¼è´å¶ä¸­ä¸ä¸ªçº¿ç¨æ©å®¹æ¶å¯¹é¾è¡¨è¿è¡æåæ¶ï¼å¦ä¸ä¸ªçº¿ç¨å¹¶ä¸ç¥éå·²ç»è¢«æåï¼ä»ç¶å¨åæ¥çé¾è¡¨ä¸éåï¼ä»èé ææ­»å¾ªç¯ãæ©å®¹è¿ç¨ä¸­ä½¿ç¨å¤´ææ³å°oldtableä¸­çåé¾è¡¨ä¸­çèç¹æå¥å°newtableçåé¾è¡¨ä¸­ï¼æä»¥newtableä¸­çåé¾è¡¨ä¼åç½®oldtableä¸­çåé¾è¡¨ãé£ä¹å¨å¤ä¸ªçº¿ç¨åæ¶æ©å®¹çæåµä¸å°±å¯è½å¯¼è´æ©å®¹åçhashmapä¸­å­å¨ä¸ä¸ªæç¯çåé¾è¡¨ï¼ä»èå¯¼è´åç»­æ§è¡getæä½çæ¶åï¼ä¼è§¦åæ­»å¾ªç¯ï¼å¼èµ·cpuç100%é®é¢ã\n\nè§£å³è¯¥é®é¢çæ¹æ³ä¸è¬æä»¥ä¸å ç§ï¼\n\n 1. ä½¿ç¨çº¿ç¨å®å¨çmapå®ç°ï¼å¦concurrenthashmapç­ã\n 2. å¨å¤çº¿ç¨ç¯å¢ä¸ï¼å°½éé¿åå¯¹åä¸ä¸ªhashmapè¿è¡å¹¶åä¿®æ¹æä½ï¼å¯ä»¥ä½¿ç¨åæ®µéç­æ¹æ³è¿è¡åæ­¥æ§å¶ã\n 3. å¨hashmapä¸­ï¼å°å®¹ééå¼è®¾å¾è¶³å¤å¤§ï¼ä»¥åå°resizeæä½çé¢çï¼ä»èéä½åºç°æ­»å¾ªç¯çæ¦çã\n 4. ä½¿ç¨å¶ä»çæ°æ®ç»æï¼å¦treemapãlinkedhashmapç­ï¼è¿äºæ°æ®ç»æå¨ä¸å®ç¨åº¦ä¸é¿åäºåå¸å²çªçé®é¢ã\n\nè½ç¶java1.8éç¨å°¾ææ³è§£å³äºå¤çº¿ç¨ä¸å¯è½åºç°çæ­»å¾ªç¯é®é¢ï¼ä½å¦æå¨å¤çº¿ç¨ç¯å¢ä¸å¯¹åä¸ä¸ªhashmapè¿è¡å¹¶åä¿®æ¹æä½ï¼ä»ç¶å¯è½ä¼åçä¸äºå¶ä»ççº¿ç¨å®å¨é®é¢ï¼å¦å¹¶åæå¥ï¼æ°æ®è¦çé®é¢ï¼ãå é¤ãéåç­æä½å¯è½ä¼å¯¼è´æ°æ®ä¸ä¸è´æèconcurrentmodificationexceptionå¼å¸¸ç­é®é¢ï¼å æ­¤å¨ä½¿ç¨hashmapæ¶ä»ç¶éè¦æ³¨æçº¿ç¨å®å¨é®é¢ãä¸ºäºé¿åè¿äºé®é¢ï¼å¯ä»¥éæ©ä½¿ç¨çº¿ç¨å®å¨çmapå®ç°ï¼å¦concurrenthashmapï¼æèéè¿åéçåæ­¥æ§å¶æ¹å¼æ¥ä¿è¯çº¿ç¨å®å¨ã\n\n\n# hashmap ç get æ¹æ³çè¿åå¼è½å¦å¤æ­æä¸ªåç´ æ¯å¦å¨ map ä¸­\n\nä¸è½ãå ä¸º get è¿å null æå¯è½æ¯ä¸åå«è¯¥ keyï¼ä¹æå¯è½è¯¥ key å¯¹åºç value ä¸º nullãå ä¸º hashmap ä¸­åè®¸ key ä¸º nullï¼ä¹åè®¸ value ä¸º nullã',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"BlockingQueue",frontmatter:{title:"BlockingQueue",date:"2023-04-02T19:22:58.000Z",permalink:"/pages/86b6a3/"},regularPath:"/01.Java/02.Java%E9%9B%86%E5%90%88/03.%20BlockingQueue.html",relativePath:"01.Java/02.Javaéå/03. BlockingQueue.md",key:"v-6f5fe4a4",path:"/pages/86b6a3/",headers:[{level:2,title:"put",slug:"put",normalizedTitle:"put",charIndex:75},{level:2,title:"take",slug:"take",normalizedTitle:"take",charIndex:79}],headersStr:"put take",content:"ä¸ç»åè½ç±»ä¼¼çæ¹æ³ï¼\n\n * æåºå¼å¸¸ï¼addãremoveãelement\n * è¿åç»æä½ä¸æåºå¼å¸¸ï¼offerãpollãpeek\n * é»å¡ï¼putãtake\n\naddãofferé½æ¯è¿å booleanã\n\nremoveãelementãpollãpeeké½æ¯è¿åelementï¼pollãpeekæ²¡ææ¶è¿ånullã\n\nåºå«ä»å¨äºï¼å½éåæ»¡æ¶æ æ³æ·»å åç´ ï¼æéåç©ºäºæ æ³ç§»é¤åç´ æ¶çä¸åå¤çæ¹å¼ã\n\nç¬¬ä¸ç»çç¹ç¹æ¯å¨æ æ³æ­£å¸¸æ§è¡çæåµä¸æåºå¼å¸¸ï¼\n\nç¬¬äºç»çç¹ç¹æ¯å¨æ æ³æ­£å¸¸æ§è¡çæåµä¸ä¸æåºå¼å¸¸ï¼ä½ä¼ç¨è¿åå¼æç¤ºè¿è¡å¤±è´¥ï¼\n\nç¬¬ä¸ç»çç¹ç¹æ¯å¨éå°ç¹æ®æåµæ¶è®©çº¿ç¨é·å¥é»å¡ç¶æï¼ç­å°å¯ä»¥è¿è¡åç»§ç»­æ§è¡ã\n\n\n# put\n\nput æ¹æ³çä½ç¨æ¯æå¥åç´ ãéå¸¸å¨éåæ²¡æ»¡çæ¶åæ¯æ­£å¸¸çæå¥ï¼ä½æ¯å¦æéåå·²æ»¡å°±æ æ³ç»§ç»­æå¥ï¼è¿æ¶å®æ¢ä¸ä¼ç«å»è¿å false ä¹ä¸ä¼æåºå¼å¸¸ï¼èæ¯è®©æå¥ççº¿ç¨é·å¥é»å¡ç¶æï¼ç´å°éåéæäºç©ºé²ç©ºé´ï¼æ­¤æ¶éåå°±ä¼è®©ä¹åççº¿ç¨è§£é¤é»å¡ç¶æï¼å¹¶æåæé£ä¸ªåç´ æ·»å è¿å»ã\n\n\n# take\n\ntake æ¹æ³çä½ç¨æ¯è·åå¹¶ç§»é¤éåçå¤´ç»ç¹ãéå¸¸å¨éåéææ°æ®çæ¶åä¼æ­£å¸¸ååºæ°æ®å¹¶å é¤ï¼ä½æ¯å¦ææ§è¡ take çæ¶åéåéæ æ°æ®ï¼åé»å¡ï¼ç´å°éåéææ°æ®ï¼ä¸æ¦éåéææ°æ®äºï¼å°±ä¼ç«å»è§£é¤é»å¡ç¶æï¼å¹¶ä¸åå°æ°æ®ã",normalizedContent:"ä¸ç»åè½ç±»ä¼¼çæ¹æ³ï¼\n\n * æåºå¼å¸¸ï¼addãremoveãelement\n * è¿åç»æä½ä¸æåºå¼å¸¸ï¼offerãpollãpeek\n * é»å¡ï¼putãtake\n\naddãofferé½æ¯è¿å booleanã\n\nremoveãelementãpollãpeeké½æ¯è¿åelementï¼pollãpeekæ²¡ææ¶è¿ånullã\n\nåºå«ä»å¨äºï¼å½éåæ»¡æ¶æ æ³æ·»å åç´ ï¼æéåç©ºäºæ æ³ç§»é¤åç´ æ¶çä¸åå¤çæ¹å¼ã\n\nç¬¬ä¸ç»çç¹ç¹æ¯å¨æ æ³æ­£å¸¸æ§è¡çæåµä¸æåºå¼å¸¸ï¼\n\nç¬¬äºç»çç¹ç¹æ¯å¨æ æ³æ­£å¸¸æ§è¡çæåµä¸ä¸æåºå¼å¸¸ï¼ä½ä¼ç¨è¿åå¼æç¤ºè¿è¡å¤±è´¥ï¼\n\nç¬¬ä¸ç»çç¹ç¹æ¯å¨éå°ç¹æ®æåµæ¶è®©çº¿ç¨é·å¥é»å¡ç¶æï¼ç­å°å¯ä»¥è¿è¡åç»§ç»­æ§è¡ã\n\n\n# put\n\nput æ¹æ³çä½ç¨æ¯æå¥åç´ ãéå¸¸å¨éåæ²¡æ»¡çæ¶åæ¯æ­£å¸¸çæå¥ï¼ä½æ¯å¦æéåå·²æ»¡å°±æ æ³ç»§ç»­æå¥ï¼è¿æ¶å®æ¢ä¸ä¼ç«å»è¿å false ä¹ä¸ä¼æåºå¼å¸¸ï¼èæ¯è®©æå¥ççº¿ç¨é·å¥é»å¡ç¶æï¼ç´å°éåéæäºç©ºé²ç©ºé´ï¼æ­¤æ¶éåå°±ä¼è®©ä¹åççº¿ç¨è§£é¤é»å¡ç¶æï¼å¹¶æåæé£ä¸ªåç´ æ·»å è¿å»ã\n\n\n# take\n\ntake æ¹æ³çä½ç¨æ¯è·åå¹¶ç§»é¤éåçå¤´ç»ç¹ãéå¸¸å¨éåéææ°æ®çæ¶åä¼æ­£å¸¸ååºæ°æ®å¹¶å é¤ï¼ä½æ¯å¦ææ§è¡ take çæ¶åéåéæ æ°æ®ï¼åé»å¡ï¼ç´å°éåéææ°æ®ï¼ä¸æ¦éåéææ°æ®äºï¼å°±ä¼ç«å»è§£é¤é»å¡ç¶æï¼å¹¶ä¸åå°æ°æ®ã",charsets:{cjk:!0}},{title:"Javaåå­æ¨¡å",frontmatter:{title:"Javaåå­æ¨¡å",date:"2023-03-19T15:23:08.000Z",permalink:"/pages/jvm/"},regularPath:"/01.Java/03.JVM/01.Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.html",relativePath:"01.Java/03.JVM/01.Javaåå­æ¨¡å.md",key:"v-5ec93f7b",path:"/pages/jvm/",headers:[{level:2,title:"volatile å synchronized",slug:"volatile-å-synchronized",normalizedTitle:"volatile å synchronized",charIndex:359}],headersStr:"volatile å synchronized",content:"Java Memory Modelï¼JMM\n\nç¼å­ä¼å¸¦æ¥ç¼å­ä¸è´æ§çé®é¢ãéå¸¸éè¿åç§åè®®è§£å³ã\n\nè¿éçä¸»åå­ãå·¥ä½åå­ä¸Javaåå­åºåä¸­çJavaå ãæ ãæ¹æ³åºç­ä¸æ¯ä¸ä¸ªæ¦å¿µï¼æ²¡æå³ç³»ã\n\n * Javaåå­æ¨¡åè§å®äºææçåéé½å­å¨å¨ä¸»åå­ä¸­ã\n * æ¯æ¡çº¿ç¨è¿æèªå·±çå·¥ä½åå­ï¼çº¿ç¨ä¸­çå·¥ä½åå­ä¸­ä¿å­äºè¢«è¯¥çº¿ç¨ä½¿ç¨çåéçä¸»åå­å¯æ¬ï¼çº¿ç¨å¯¹åéçæææä½ï¼è¯»åãèµå¼ç­ï¼é½å¿é¡»å¨å·¥ä½åå­ä¸­è¿è¡ï¼èä¸è½ç´æ¥è¯»åä¸»åå­ä¸­çæ°æ®ã\n * ä¸åççº¿ç¨ä¹é´ä¹æ æ³ç´æ¥è®¿é®å¯¹æ¹å·¥ä½åå­ä¸­çåéï¼çº¿ç¨é´åéå¼çä¼ éåéè¦éè¿ä¸»åå­æ¥å®æã\n\nè¿éè¯´çåéä¸javaç¼ç¨ä¸­çåéææåºå«ï¼å®åæ¬äºå®ä¾å­æ®µãéæå­æ®µåæææ°ç»å¯¹è±¡çåç´ ï¼ä½æ¯ä¸åæ¬å±é¨åéä¸æ¹æ³åæ°ï¼å ä¸ºæ¯çº¿ç¨ç§æçï¼ä¸ä¼è¢«å±äº«ï¼ä¸ä¼å­å¨ç«äºé®é¢ã\n\n\n# volatile å synchronized",normalizedContent:"java memory modelï¼jmm\n\nç¼å­ä¼å¸¦æ¥ç¼å­ä¸è´æ§çé®é¢ãéå¸¸éè¿åç§åè®®è§£å³ã\n\nè¿éçä¸»åå­ãå·¥ä½åå­ä¸javaåå­åºåä¸­çjavaå ãæ ãæ¹æ³åºç­ä¸æ¯ä¸ä¸ªæ¦å¿µï¼æ²¡æå³ç³»ã\n\n * javaåå­æ¨¡åè§å®äºææçåéé½å­å¨å¨ä¸»åå­ä¸­ã\n * æ¯æ¡çº¿ç¨è¿æèªå·±çå·¥ä½åå­ï¼çº¿ç¨ä¸­çå·¥ä½åå­ä¸­ä¿å­äºè¢«è¯¥çº¿ç¨ä½¿ç¨çåéçä¸»åå­å¯æ¬ï¼çº¿ç¨å¯¹åéçæææä½ï¼è¯»åãèµå¼ç­ï¼é½å¿é¡»å¨å·¥ä½åå­ä¸­è¿è¡ï¼èä¸è½ç´æ¥è¯»åä¸»åå­ä¸­çæ°æ®ã\n * ä¸åççº¿ç¨ä¹é´ä¹æ æ³ç´æ¥è®¿é®å¯¹æ¹å·¥ä½åå­ä¸­çåéï¼çº¿ç¨é´åéå¼çä¼ éåéè¦éè¿ä¸»åå­æ¥å®æã\n\nè¿éè¯´çåéä¸javaç¼ç¨ä¸­çåéææåºå«ï¼å®åæ¬äºå®ä¾å­æ®µãéæå­æ®µåæææ°ç»å¯¹è±¡çåç´ ï¼ä½æ¯ä¸åæ¬å±é¨åéä¸æ¹æ³åæ°ï¼å ä¸ºæ¯çº¿ç¨ç§æçï¼ä¸ä¼è¢«å±äº«ï¼ä¸ä¼å­å¨ç«äºé®é¢ã\n\n\n# volatile å synchronized",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ç±»å è½½æºå¶",frontmatter:{title:"ç±»å è½½æºå¶",date:"2023-03-19T15:24:12.000Z",permalink:"/pages/7d816e/"},regularPath:"/01.Java/03.JVM/02.%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6.html",relativePath:"01.Java/03.JVM/02.ç±»å è½½æºå¶.md",key:"v-77eb69ec",path:"/pages/7d816e/",headers:[{level:2,title:"ç±»ççå½å¨æ",slug:"ç±»ççå½å¨æ",normalizedTitle:"ç±»ççå½å¨æ",charIndex:2},{level:2,title:"ç±»å è½½",slug:"ç±»å è½½",normalizedTitle:"ç±»å è½½",charIndex:87},{level:2,title:"ç±»å è½½å¨",slug:"ç±»å è½½å¨",normalizedTitle:"ç±»å è½½å¨",charIndex:726},{level:2,title:"åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼",slug:"åäº²å§æ´¾æ¨¡å-parents-delegation-model",normalizedTitle:"åäº²å§æ´¾æ¨¡åï¼parents delegation modelï¼",charIndex:1323},{level:2,title:"Javaæ¨¡ååç³»ç»ï¼JDK 9ï¼",slug:"javaæ¨¡ååç³»ç»-jdk-9",normalizedTitle:"javaæ¨¡ååç³»ç»ï¼jdk 9ï¼",charIndex:1761}],headersStr:"ç±»ççå½å¨æ ç±»å è½½ ç±»å è½½å¨ åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼ Javaæ¨¡ååç³»ç»ï¼JDK 9ï¼",content:"# ç±»ççå½å¨æ\n\nJavaèææºææè¿°ç±»çæ°æ®ä»classæä»¶å è½½å°åå­ï¼å¹¶å¯¹æ°æ®è¿è¡éªè¯ãè§£æååå§åï¼æç»å½¢æå¯ä»¥è¢«èææºç´æ¥ä½¿ç¨çJavaç±»åï¼è¿ä¸ªè¿ç¨è¢«ç§°ä½èææºçç±»å è½½æºå¶ã\n\nä¸é£äºå¨ç¼è¯å¨éè¦è¿è¡è¿æ¥çè¯­è¨ä¸åï¼å¨Javaè¯­è¨éï¼ç±»åçå è½½ãè¿æ¥ååå§åé½æ¯å¨ç¨åºè¿è¡æé´å®æçã\n\nä¸ä¸ªç±»ä»è¢«å è½½å°èææºåå­ä¸­å¼å§ï¼å°å¸è½½åºåå­ä¸ºæ­¢ï¼å®çæ´ä¸ªçå½å¨æå°ä¼ç»å7ä¸ªé¶æ®µã\n\n\n\n\n# ç±»å è½½\n\nç±»å è½½å¨è¿ç¨ï¼å è½½ãéªè¯ãåå¤ãè§£æãåå§åã\n\n * å è½½ï¼ä¸»è¦æ¯å¨åå­ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç Class å¯¹è±¡ï¼ä½ä¸ºæ¹æ³åºè¿ä¸ªç±»çè®¿é®å¥å£\n\n * è¿æ¥\n   \n   * éªè¯ï¼ç¡®ä¿ Class æä»¶çå­èæµæ»¡è¶³âJavaèææºè§èâ\n   * åå¤ï¼ç»ç±»ä¸­å®ä¹çåéï¼static ä¿®é¥°çéæåéï¼åéåå­å¹¶è®¾ç½®åå§å¼ã\n   * è§£æï¼å°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨æ¿æ¢ä¸ºç´æ¥å¼ç¨çè¿ç¨ã\n     * ç¬¦å·å¼ç¨æ¯âJavaèææºè§èâæå®ä¹ç Class æä»¶æ ¼å¼ãæ¯å¦CONSTAN_class_info è¿äºåé\n     * ç´æ¥å¼ç¨æ¯å¯ä»¥ç´æ¥æåç®æ çæéãç¸å¯¹åç§»éæè½é´æ¥å®ä½å°ç®æ çå¥æãæäºç´æ¥å¼ç¨ï¼å¼ç¨çå¯¹è±¡å¿å®å¨èææºçåå­ä¸­å­å¨ã\n\n * åå§åï¼æ§è¡ç±»æé å¨æ¹æ³\n\nç¬¬ä¸é¶æ®µï¼å è½½é¶æ®µï¼Loadingï¼ï¼èæå®æä¸ä»¶äº\n\n * éè¿ç±»çå¨éå®åè·åå¶å®ä¹çäºè¿å¶å­èæµï¼.classï¼ããclass loaderã\n * å°è¿ä¸ªå­èæµæä»£è¡¨çéæå­å¨ç»æè½¬åä¸ºæ¹æ³åºçè¿è¡æ¶æ°æ®ç»æã\n * å¨ Java å ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç java.lang.Class å¯¹è±¡ï¼ä½ä¸ºå¯¹æ¹æ³åºä¸­è¿äºæ°æ®çè®¿é®å¥å£ã\n\n\n\n\n# ç±»å è½½å¨\n\nJavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­çâéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°Javaèææºå¤é¨å»å®ç°ï¼ ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ã å®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨âï¼Class Loaderï¼ ã\n\nJDK 9 ä¹åï¼\n\nç»å¤§å¤æ°Javaç¨åºé½ä¼ä½¿ç¨å°ä»¥ä¸3ä¸ªç³»ç»æä¾çç±»å è½½å¨æ¥è¿è¡å è½½ã\n\n 1. å¯å¨ç±»å è½½å¨ Bootstrap Class Loaderï¼è´è´£å è½½å­æ¾å¨ <JAVA_HOME>\\libç®å½ï¼æè¢« -Xbootclasspathåæ°ææå®çè·¯å¾ä¸­å­æ¾çï¼å¹¶ä¸æ¯Javaèææºè½è¯å«çç±»åºå è½½å°èææºçåå­ä¸­ãï¼egï¼rt.jarãtools.jarï¼\n 2. æ©å±ç±»å è½½å¨ Extension Class Loaderï¼è´è´£å è½½ <JAVA_HOME>\\lib\\extç®å½ï¼æè¢« java.ext.dirsç³»ç»åéææå®çè·¯å¾ä¸­ææçç±»åºã\n 3. åºç¨ç¨åºç±»å è½½å¨/ç³»ç»ç±»å è½½å¨ Application Class Loaderï¼è´è´£å è½½ç¨æ·ç±»è·¯å¾ï¼ClassPathï¼ä¸ææçç±»åºãå¦æåºç¨ç¨åºä¸­æ²¡æèªå®ä¹è¿èªå·±çç±»å è½½å¨ï¼ä¸è¬æåµä¸è¿ä¸ªå°±æ¯ç¨åºä¸­é»è®¤çç±»å è½½å¨ã\n\nå¦ææéè¦ï¼è¿å¯ä»¥èªå®ä¹ç±»å è½½å¨ãegï¼å¢å é¤äºç£çä½ç½®ä¹å¤çClassæä»¶æ¥æºï¼ æèéè¿ç±»å è½½å¨å®ç°ç±»çéç¦»ã éè½½ç­åè½ã\n\n\n# åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼\n\nåäº²å§æ´¾æ¨¡åçå·¥ä½è¿ç¨æ¯ï¼ å¦æä¸ä¸ªç±»å è½½å¨æ¶å°äºç±»å è½½çè¯·æ±ï¼å®é¦åä¸ä¼èªå·±å»å°è¯å è½½è¿ä¸ªç±»ï¼èæ¯æè¿ä¸ªè¯·æ±å§æ´¾ç»ç¶ç±»å è½½å¨å»å®æï¼æ¯ä¸ä¸ªå±æ¬¡çç±»å è½½å¨é½æ¯å¦æ­¤ï¼å æ­¤ææçå è½½è¯·æ±æç»é½åºè¯¥ä¼ éå°æé¡¶å±çå¯å¨ç±»å è½½å¨ä¸­ï¼åªæå½ç¶ç±»å è½½å¨åé¦èªå·±æ æ³å®æè¿ä¸ªå è½½è¯·æ±ï¼å®çæç´¢èå´ä¸­æ²¡ææ¾å°æéçç±»ï¼æ¶ï¼å­å è½½å¨æä¼å°è¯èªå·±å»å®æå è½½ã\n\nä½¿ç¨åäº²å§æ´¾æ¨¡åæ¥ç»ç»ç±»å è½½å¨ä¹é´çå³ç³»ï¼ ä¸ä¸ªæ¾èæè§çå¥½å¤å°±æ¯Javaä¸­çç±»éçå®çç±»å è½½å¨ä¸èµ·å·å¤äºä¸ç§å¸¦æä¼åçº§çå±æ¬¡å³ç³»ã ä¾å¦ç±»java.lang.Objectï¼ å®å­æ¾å¨rt.jarä¹ä¸­ï¼ æ è®ºåªä¸ä¸ªç±»å è½½å¨è¦å è½½è¿ä¸ªç±»ï¼ æç»é½æ¯å§æ´¾ç»å¤äºæ¨¡åæé¡¶ç«¯çå¯å¨ç±»å è½½å¨è¿è¡å è½½ï¼ å æ­¤Objectç±»å¨ç¨åºçåç§ç±»å è½½å¨ç¯å¢ä¸­é½è½å¤ä¿è¯æ¯åä¸ä¸ªç±»ã\n\nä¼ç¹ï¼\n\n * é²æ­¢åå­ä¸­åºç°å¤ä»½åæ ·å­èç çç³»ç»ç±»ã\n * ä¿è¯ Java ç¨åºå®å¨ç¨³å®è¿è¡ã\n\n\n# Javaæ¨¡ååç³»ç»ï¼JDK 9ï¼",normalizedContent:"# ç±»ççå½å¨æ\n\njavaèææºææè¿°ç±»çæ°æ®ä»classæä»¶å è½½å°åå­ï¼å¹¶å¯¹æ°æ®è¿è¡éªè¯ãè§£æååå§åï¼æç»å½¢æå¯ä»¥è¢«èææºç´æ¥ä½¿ç¨çjavaç±»åï¼è¿ä¸ªè¿ç¨è¢«ç§°ä½èææºçç±»å è½½æºå¶ã\n\nä¸é£äºå¨ç¼è¯å¨éè¦è¿è¡è¿æ¥çè¯­è¨ä¸åï¼å¨javaè¯­è¨éï¼ç±»åçå è½½ãè¿æ¥ååå§åé½æ¯å¨ç¨åºè¿è¡æé´å®æçã\n\nä¸ä¸ªç±»ä»è¢«å è½½å°èææºåå­ä¸­å¼å§ï¼å°å¸è½½åºåå­ä¸ºæ­¢ï¼å®çæ´ä¸ªçå½å¨æå°ä¼ç»å7ä¸ªé¶æ®µã\n\n\n\n\n# ç±»å è½½\n\nç±»å è½½å¨è¿ç¨ï¼å è½½ãéªè¯ãåå¤ãè§£æãåå§åã\n\n * å è½½ï¼ä¸»è¦æ¯å¨åå­ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç class å¯¹è±¡ï¼ä½ä¸ºæ¹æ³åºè¿ä¸ªç±»çè®¿é®å¥å£\n\n * è¿æ¥\n   \n   * éªè¯ï¼ç¡®ä¿ class æä»¶çå­èæµæ»¡è¶³âjavaèææºè§èâ\n   * åå¤ï¼ç»ç±»ä¸­å®ä¹çåéï¼static ä¿®é¥°çéæåéï¼åéåå­å¹¶è®¾ç½®åå§å¼ã\n   * è§£æï¼å°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨æ¿æ¢ä¸ºç´æ¥å¼ç¨çè¿ç¨ã\n     * ç¬¦å·å¼ç¨æ¯âjavaèææºè§èâæå®ä¹ç class æä»¶æ ¼å¼ãæ¯å¦constan_class_info è¿äºåé\n     * ç´æ¥å¼ç¨æ¯å¯ä»¥ç´æ¥æåç®æ çæéãç¸å¯¹åç§»éæè½é´æ¥å®ä½å°ç®æ çå¥æãæäºç´æ¥å¼ç¨ï¼å¼ç¨çå¯¹è±¡å¿å®å¨èææºçåå­ä¸­å­å¨ã\n\n * åå§åï¼æ§è¡ç±»æé å¨æ¹æ³\n\nç¬¬ä¸é¶æ®µï¼å è½½é¶æ®µï¼loadingï¼ï¼èæå®æä¸ä»¶äº\n\n * éè¿ç±»çå¨éå®åè·åå¶å®ä¹çäºè¿å¶å­èæµï¼.classï¼ããclass loaderã\n * å°è¿ä¸ªå­èæµæä»£è¡¨çéæå­å¨ç»æè½¬åä¸ºæ¹æ³åºçè¿è¡æ¶æ°æ®ç»æã\n * å¨ java å ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç java.lang.class å¯¹è±¡ï¼ä½ä¸ºå¯¹æ¹æ³åºä¸­è¿äºæ°æ®çè®¿é®å¥å£ã\n\n\n\n\n# ç±»å è½½å¨\n\njavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­çâéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°javaèææºå¤é¨å»å®ç°ï¼ ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ã å®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨âï¼class loaderï¼ ã\n\njdk 9 ä¹åï¼\n\nç»å¤§å¤æ°javaç¨åºé½ä¼ä½¿ç¨å°ä»¥ä¸3ä¸ªç³»ç»æä¾çç±»å è½½å¨æ¥è¿è¡å è½½ã\n\n 1. å¯å¨ç±»å è½½å¨ bootstrap class loaderï¼è´è´£å è½½å­æ¾å¨ <java_home>\\libç®å½ï¼æè¢« -xbootclasspathåæ°ææå®çè·¯å¾ä¸­å­æ¾çï¼å¹¶ä¸æ¯javaèææºè½è¯å«çç±»åºå è½½å°èææºçåå­ä¸­ãï¼egï¼rt.jarãtools.jarï¼\n 2. æ©å±ç±»å è½½å¨ extension class loaderï¼è´è´£å è½½ <java_home>\\lib\\extç®å½ï¼æè¢« java.ext.dirsç³»ç»åéææå®çè·¯å¾ä¸­ææçç±»åºã\n 3. åºç¨ç¨åºç±»å è½½å¨/ç³»ç»ç±»å è½½å¨ application class loaderï¼è´è´£å è½½ç¨æ·ç±»è·¯å¾ï¼classpathï¼ä¸ææçç±»åºãå¦æåºç¨ç¨åºä¸­æ²¡æèªå®ä¹è¿èªå·±çç±»å è½½å¨ï¼ä¸è¬æåµä¸è¿ä¸ªå°±æ¯ç¨åºä¸­é»è®¤çç±»å è½½å¨ã\n\nå¦ææéè¦ï¼è¿å¯ä»¥èªå®ä¹ç±»å è½½å¨ãegï¼å¢å é¤äºç£çä½ç½®ä¹å¤çclassæä»¶æ¥æºï¼ æèéè¿ç±»å è½½å¨å®ç°ç±»çéç¦»ã éè½½ç­åè½ã\n\n\n# åäº²å§æ´¾æ¨¡åï¼parents delegation modelï¼\n\nåäº²å§æ´¾æ¨¡åçå·¥ä½è¿ç¨æ¯ï¼ å¦æä¸ä¸ªç±»å è½½å¨æ¶å°äºç±»å è½½çè¯·æ±ï¼å®é¦åä¸ä¼èªå·±å»å°è¯å è½½è¿ä¸ªç±»ï¼èæ¯æè¿ä¸ªè¯·æ±å§æ´¾ç»ç¶ç±»å è½½å¨å»å®æï¼æ¯ä¸ä¸ªå±æ¬¡çç±»å è½½å¨é½æ¯å¦æ­¤ï¼å æ­¤ææçå è½½è¯·æ±æç»é½åºè¯¥ä¼ éå°æé¡¶å±çå¯å¨ç±»å è½½å¨ä¸­ï¼åªæå½ç¶ç±»å è½½å¨åé¦èªå·±æ æ³å®æè¿ä¸ªå è½½è¯·æ±ï¼å®çæç´¢èå´ä¸­æ²¡ææ¾å°æéçç±»ï¼æ¶ï¼å­å è½½å¨æä¼å°è¯èªå·±å»å®æå è½½ã\n\nä½¿ç¨åäº²å§æ´¾æ¨¡åæ¥ç»ç»ç±»å è½½å¨ä¹é´çå³ç³»ï¼ ä¸ä¸ªæ¾èæè§çå¥½å¤å°±æ¯javaä¸­çç±»éçå®çç±»å è½½å¨ä¸èµ·å·å¤äºä¸ç§å¸¦æä¼åçº§çå±æ¬¡å³ç³»ã ä¾å¦ç±»java.lang.objectï¼ å®å­æ¾å¨rt.jarä¹ä¸­ï¼ æ è®ºåªä¸ä¸ªç±»å è½½å¨è¦å è½½è¿ä¸ªç±»ï¼ æç»é½æ¯å§æ´¾ç»å¤äºæ¨¡åæé¡¶ç«¯çå¯å¨ç±»å è½½å¨è¿è¡å è½½ï¼ å æ­¤objectç±»å¨ç¨åºçåç§ç±»å è½½å¨ç¯å¢ä¸­é½è½å¤ä¿è¯æ¯åä¸ä¸ªç±»ã\n\nä¼ç¹ï¼\n\n * é²æ­¢åå­ä¸­åºç°å¤ä»½åæ ·å­èç çç³»ç»ç±»ã\n * ä¿è¯ java ç¨åºå®å¨ç¨³å®è¿è¡ã\n\n\n# javaæ¨¡ååç³»ç»ï¼jdk 9ï¼",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"LinkedListåArrayDeque",frontmatter:{title:"LinkedListåArrayDeque",date:"2023-04-21T22:12:37.000Z",permalink:"/pages/cbcb60/"},regularPath:"/01.Java/02.Java%E9%9B%86%E5%90%88/04.LinkedList%E5%92%8CArrayDeque.html",relativePath:"01.Java/02.Javaéå/04.LinkedListåArrayDeque.md",key:"v-410ac754",path:"/pages/cbcb60/",headers:[{level:2,title:"LinkedList",slug:"linkedlist",normalizedTitle:"linkedlist",charIndex:2},{level:3,title:"LinkedList å¦ä½å®ç°çº¿ç¨å®å¨ï¼",slug:"linkedlist-å¦ä½å®ç°çº¿ç¨å®å¨",normalizedTitle:"linkedlist å¦ä½å®ç°çº¿ç¨å®å¨ï¼",charIndex:1035},{level:2,title:"ArrayDeque",slug:"arraydeque",normalizedTitle:"arraydeque",charIndex:1360},{level:3,title:"Queue æ¥å£",slug:"queue-æ¥å£",normalizedTitle:"queue æ¥å£",charIndex:2405},{level:3,title:"Deque æ¥å£ï¼ç»§æ¿äº Queue æ¥å£ï¼",slug:"deque-æ¥å£-ç»§æ¿äº-queue-æ¥å£",normalizedTitle:"deque æ¥å£ï¼ç»§æ¿äº queue æ¥å£ï¼",charIndex:2727}],headersStr:"LinkedList LinkedList å¦ä½å®ç°çº¿ç¨å®å¨ï¼ ArrayDeque Queue æ¥å£ Deque æ¥å£ï¼ç»§æ¿äº Queue æ¥å£ï¼",content:"# LinkedList\n\npublic class LinkedList<E>\n    extends AbstractSequentialList<E>\n    implements List<E>, Deque<E>, Cloneable, java.io.Serializable {\n\n    // ä¸ºä»ä¹å­æ®µé½å£°æ transient å³é®å­ï¼\n    // åç´ ä¸ªæ°\n    transient int size = 0;\n\n    // å¤´æé\n    transient Node<E> first;\n\n    // å°¾æé\n    transient Node<E> last;\n\n    // é¾è¡¨èç¹\n    private static class Node<E> {\n        // èç¹æ°æ®\n        // ï¼ç±»åæ¦é¤åï¼Object item;ï¼\n        E item;\n        // åé©±æé\n        Node<E> next;\n        // åç»§æé\n        Node<E> prev;\n\n        Node(Node<E> prev, E element, Node<E> next) {\n            this.item = element;\n            this.next = next;\n            this.prev = prev;\n        }\n    }\n}\n\n\nLinkedList æ¯åºäºé¾è¡¨ççº¿æ§è¡¨ï¼åæ¶å·å¤ ListãQueue å Stack çè¡ä¸ºï¼\n\nå¨é¾è¡¨ä¸­é´æ·»å èç¹æ¶ï¼ä¼ç¨å° node(index) æ¹æ³æ¥è¯¢æå®ä½ç½®çèç¹ãå¯ä»¥çå°ç»´æ first å last å¤´å°¾èç¹çä½ç¨ååæ¥åºæ¥äºï¼\n\n * å¦æç´¢å¼ä½ç½®å°äº size/2ï¼åä»å¤´èç¹å¼å§æ¾ï¼\n * å¦æç´¢å¼ä½ç½®å¤§äº size/2ï¼åä»å°¾èç¹å¼å§æ¾ã\n\nè½ç¶ï¼ä»å¤æåº¦åæçè§åº¦çï¼ä»åªä¸ªæ¹åæ¥è¯¢æ¯æ²¡æåºå«çï¼æ¶é´å¤æåº¦é½æ¯ O(n)ãä½ä»å·¥ç¨åæçè§åº¦çè¿æ¯æåºå«çï¼ä»æ´é è¿ç®æ èç¹çä½ç½®å¼å§æ¥è¯¢ï¼å®éæ§è¡çæ¶é´ä¼æ´ç­ã\n\nä¸ºä»ä¹å­æ®µé½å£°æ transient å³é®å­ï¼LinkedList éåäºåºååè¿ç¨ï¼ä¸åºååé¾è¡¨èç¹ï¼åªå¤çé¾è¡¨èç¹ä¸­ææçåç´ ï¼å¨ååºåæ¶ï¼åªéè¦æç§å¯¹è±¡é¡ºåºä¾æ¬¡æ·»å å°é¾è¡¨çæ«å°¾ï¼å°±è½æ¢å¤é¾è¡¨çé¡ºåºã\n\n\n# LinkedList å¦ä½å®ç°çº¿ç¨å®å¨ï¼\n\n * ä½¿ç¨ Collections.synchronizedList åè£ç±»ï¼ åçä¹æ¯å¨æææ¹æ³ä¸å¢å  synchronized å³é®å­ï¼\n * ä½¿ç¨ ConcurrentLinkedQueue å®¹å¨ç±»ï¼ åºäº CAS æ éå®ç°ççº¿ç¨å®å¨éåï¼\n * ä½¿ç¨ ConcurrentLinkedDeque å®¹å¨ç±»ï¼ åºäº CAS æ éå®ç°ççº¿ç¨å®å¨åç«¯éåã\n * ä½¿ç¨ LinkedBlockingQueue å®¹å¨ï¼ åºäºå éçé»å¡éåï¼éåäºå¸¦é»å¡æä½ççäº§èæ¶è´¹èæ¨¡åï¼\n * ä½¿ç¨ LinkedBlockingDeque å®¹å¨ï¼ åºäºå éçé»å¡åç«¯éåï¼éåäºå¸¦é»å¡æä½ççäº§èæ¶è´¹èæ¨¡åï¼\n\n\n# ArrayDeque\n\nDeque æ¥å£è¡¨ç¤ºä¸ä¸ªåç«¯éåï¼Double Ended Queueï¼ï¼åè®¸å¨éåçé¦å°¾ä¸¤ç«¯æä½ï¼æä»¥æ¢è½å®ç°éåè¡ä¸ºï¼ä¹è½å®ç°æ è¡ä¸ºã\n\n * ArrayDeque æ¯åºäºå¨ææ°ç»ççº¿æ§è¡¨ï¼å·å¤ Queue å Stack çè¡ä¸ºï¼ä½ä¸å·å¤ List çè¡ä¸ºï¼\n * ArrayDeque çæ°ç»å®¹éæ¯ 2 çæ´æ°å¹ï¼å¨æ©å®¹æ¶å®¹éä¼ç¿»åï¼ä¸ä¸æ¯æ null åç´ ï¼ï¼å¶å®å¨ Deque æ¥å£ä¸å¹¶ä¸ä¸¥æ ¼ç¦æ­¢å­å¨ null åç´ ï¼ä½æ¯ä¼å¼ºçå»ºè®® Deque çå®ç°ä¸æä¾å­å¨ null å¼çè½åãå ä¸º null éå¸¸ä¼ä½ä¸ºä¸ä¸ªç¹æ®å¼æ¥å¤æ­éåæ¯å¦ä¸ºç©ºãï¼\n * ArrayDeque å LinkedList çæ åéåè¡ä¸ºé½æ¯ O(1) æ¶é´å¤æåº¦ï¼ArrayDeque çå¥æ åå¥éæå¯è½ä¼è§¦åæ©å®¹ï¼ä½ä»åæåæä¸çä¾ç¶æ¯ O(1) æ¶é´å¤æåº¦ï¼\n * ArrayDeque æ¯ä¸åè¿ç»­åå­ç©ºé´ï¼åºäºå±é¨æ§åçè½å¤æ´å¥½å°å½ä¸­ CPU ç¼å­è¡ï¼è LinkedList æ¯ç¦»æ£çåå­ç©ºé´å¯¹ç¼å­è¡ä¸åå¥½ï¼\n * ArrayDeque å LinkedList é½ä¸èèçº¿ç¨åæ­¥ï¼ä¸ä¿è¯çº¿ç¨å®å¨ã\n\npublic class ArrayDeque<E> extends AbstractCollection<E>\n\t\timplements Deque<E>, Cloneable, Serializable\n{\n    // åºå±æ°ç»\n    transient Object[] elements; // non-private to simplify nested class access\n\n    // éå¤´æé\n    transient int head;\n\n    // éå°¾æé\n    transient int tail;\n\n    // new ArrayDeque(0) æå°åå§å®¹é\n    private static final int MIN_INITIAL_CAPACITY = 8;\n\n    // å°¾æé - å¤´æé\n    public int size() {\n        return (tail - head) & (elements.length - 1);\n    }\n}\n\n\nä¸ºä»ä¹ elements å­æ®µä¸å£°æä¸ºæ³åç±»å Eï¼ å ä¸ºæ³åæ¦é¤åç­äº Object[] elementDataï¼æ²¡æåºå«ã\n\n\n# Queue æ¥å£\n\nQueue ç API å¯ä»¥åä¸º 2 ç±»ï¼åºå«å¨äºæ¹æ³çæç»ç­ç¥ä¸ï¼\n\n * æå¼å¸¸ï¼\n   * åç©ºéååæ°æ®ï¼ä¼æåº NoSuchElementException å¼å¸¸ï¼\n   * åå®¹éæ»¡çéåå æ°æ®ï¼ä¼æåº IllegalStateException å¼å¸¸ã\n * è¿åç¹æ®å¼ï¼\n   * åç©ºéååæ°æ®ï¼ä¼è¿å nullï¼\n   * åå®¹éæ»¡çéåå æ°æ®ï¼ä¼è¿å falseã\n\næç»ç­ç¥     æå¼å¸¸         è¿åç¹æ®å¼\nå¥éï¼éå°¾ï¼   add(e)      offer(e)\nåºéï¼éå¤´ï¼   remove()    poll()\nè§å¯ï¼éå¤´ï¼   element()   peek()\n\n\n# Deque æ¥å£ï¼ç»§æ¿äº Queue æ¥å£ï¼\n\nJava æ²¡ææä¾æ åçæ æ¥å£ï¼èæ¯æ¾å¨ Deque æ¥å£ä¸­ï¼\n\næç»ç­ç¥     æå¼å¸¸       ç­ä»·äº\nå¥æ        push(e)   addFirst(e)\nåºæ        pop()     removeFirst()\nè§å¯ï¼æ é¡¶ï¼   peek()    peekFirst()\n\né¤äºæ åçéååæ è¡ä¸ºï¼Deque æ¥å£è¿æä¾äº 12 ä¸ªå¨ä¸¤ç«¯æä½çæ¹æ³ï¼\n\næç»ç­ç¥   æå¼å¸¸                           è¿åå¼\nå¢å      addFirst(e)/ addLast(e)       offerFirst(e)/ offerLast(e)\nå é¤     removeFirst()/ removeLast()   pollFirst()/ pollLast()\nè§å¯     getFirst()/ getLast()         peekFirst()/ peekLast()",normalizedContent:"# linkedlist\n\npublic class linkedlist<e>\n    extends abstractsequentiallist<e>\n    implements list<e>, deque<e>, cloneable, java.io.serializable {\n\n    // ä¸ºä»ä¹å­æ®µé½å£°æ transient å³é®å­ï¼\n    // åç´ ä¸ªæ°\n    transient int size = 0;\n\n    // å¤´æé\n    transient node<e> first;\n\n    // å°¾æé\n    transient node<e> last;\n\n    // é¾è¡¨èç¹\n    private static class node<e> {\n        // èç¹æ°æ®\n        // ï¼ç±»åæ¦é¤åï¼object item;ï¼\n        e item;\n        // åé©±æé\n        node<e> next;\n        // åç»§æé\n        node<e> prev;\n\n        node(node<e> prev, e element, node<e> next) {\n            this.item = element;\n            this.next = next;\n            this.prev = prev;\n        }\n    }\n}\n\n\nlinkedlist æ¯åºäºé¾è¡¨ççº¿æ§è¡¨ï¼åæ¶å·å¤ listãqueue å stack çè¡ä¸ºï¼\n\nå¨é¾è¡¨ä¸­é´æ·»å èç¹æ¶ï¼ä¼ç¨å° node(index) æ¹æ³æ¥è¯¢æå®ä½ç½®çèç¹ãå¯ä»¥çå°ç»´æ first å last å¤´å°¾èç¹çä½ç¨ååæ¥åºæ¥äºï¼\n\n * å¦æç´¢å¼ä½ç½®å°äº size/2ï¼åä»å¤´èç¹å¼å§æ¾ï¼\n * å¦æç´¢å¼ä½ç½®å¤§äº size/2ï¼åä»å°¾èç¹å¼å§æ¾ã\n\nè½ç¶ï¼ä»å¤æåº¦åæçè§åº¦çï¼ä»åªä¸ªæ¹åæ¥è¯¢æ¯æ²¡æåºå«çï¼æ¶é´å¤æåº¦é½æ¯ o(n)ãä½ä»å·¥ç¨åæçè§åº¦çè¿æ¯æåºå«çï¼ä»æ´é è¿ç®æ èç¹çä½ç½®å¼å§æ¥è¯¢ï¼å®éæ§è¡çæ¶é´ä¼æ´ç­ã\n\nä¸ºä»ä¹å­æ®µé½å£°æ transient å³é®å­ï¼linkedlist éåäºåºååè¿ç¨ï¼ä¸åºååé¾è¡¨èç¹ï¼åªå¤çé¾è¡¨èç¹ä¸­ææçåç´ ï¼å¨ååºåæ¶ï¼åªéè¦æç§å¯¹è±¡é¡ºåºä¾æ¬¡æ·»å å°é¾è¡¨çæ«å°¾ï¼å°±è½æ¢å¤é¾è¡¨çé¡ºåºã\n\n\n# linkedlist å¦ä½å®ç°çº¿ç¨å®å¨ï¼\n\n * ä½¿ç¨ collections.synchronizedlist åè£ç±»ï¼ åçä¹æ¯å¨æææ¹æ³ä¸å¢å  synchronized å³é®å­ï¼\n * ä½¿ç¨ concurrentlinkedqueue å®¹å¨ç±»ï¼ åºäº cas æ éå®ç°ççº¿ç¨å®å¨éåï¼\n * ä½¿ç¨ concurrentlinkeddeque å®¹å¨ç±»ï¼ åºäº cas æ éå®ç°ççº¿ç¨å®å¨åç«¯éåã\n * ä½¿ç¨ linkedblockingqueue å®¹å¨ï¼ åºäºå éçé»å¡éåï¼éåäºå¸¦é»å¡æä½ççäº§èæ¶è´¹èæ¨¡åï¼\n * ä½¿ç¨ linkedblockingdeque å®¹å¨ï¼ åºäºå éçé»å¡åç«¯éåï¼éåäºå¸¦é»å¡æä½ççäº§èæ¶è´¹èæ¨¡åï¼\n\n\n# arraydeque\n\ndeque æ¥å£è¡¨ç¤ºä¸ä¸ªåç«¯éåï¼double ended queueï¼ï¼åè®¸å¨éåçé¦å°¾ä¸¤ç«¯æä½ï¼æä»¥æ¢è½å®ç°éåè¡ä¸ºï¼ä¹è½å®ç°æ è¡ä¸ºã\n\n * arraydeque æ¯åºäºå¨ææ°ç»ççº¿æ§è¡¨ï¼å·å¤ queue å stack çè¡ä¸ºï¼ä½ä¸å·å¤ list çè¡ä¸ºï¼\n * arraydeque çæ°ç»å®¹éæ¯ 2 çæ´æ°å¹ï¼å¨æ©å®¹æ¶å®¹éä¼ç¿»åï¼ä¸ä¸æ¯æ null åç´ ï¼ï¼å¶å®å¨ deque æ¥å£ä¸å¹¶ä¸ä¸¥æ ¼ç¦æ­¢å­å¨ null åç´ ï¼ä½æ¯ä¼å¼ºçå»ºè®® deque çå®ç°ä¸æä¾å­å¨ null å¼çè½åãå ä¸º null éå¸¸ä¼ä½ä¸ºä¸ä¸ªç¹æ®å¼æ¥å¤æ­éåæ¯å¦ä¸ºç©ºãï¼\n * arraydeque å linkedlist çæ åéåè¡ä¸ºé½æ¯ o(1) æ¶é´å¤æåº¦ï¼arraydeque çå¥æ åå¥éæå¯è½ä¼è§¦åæ©å®¹ï¼ä½ä»åæåæä¸çä¾ç¶æ¯ o(1) æ¶é´å¤æåº¦ï¼\n * arraydeque æ¯ä¸åè¿ç»­åå­ç©ºé´ï¼åºäºå±é¨æ§åçè½å¤æ´å¥½å°å½ä¸­ cpu ç¼å­è¡ï¼è linkedlist æ¯ç¦»æ£çåå­ç©ºé´å¯¹ç¼å­è¡ä¸åå¥½ï¼\n * arraydeque å linkedlist é½ä¸èèçº¿ç¨åæ­¥ï¼ä¸ä¿è¯çº¿ç¨å®å¨ã\n\npublic class arraydeque<e> extends abstractcollection<e>\n\t\timplements deque<e>, cloneable, serializable\n{\n    // åºå±æ°ç»\n    transient object[] elements; // non-private to simplify nested class access\n\n    // éå¤´æé\n    transient int head;\n\n    // éå°¾æé\n    transient int tail;\n\n    // new arraydeque(0) æå°åå§å®¹é\n    private static final int min_initial_capacity = 8;\n\n    // å°¾æé - å¤´æé\n    public int size() {\n        return (tail - head) & (elements.length - 1);\n    }\n}\n\n\nä¸ºä»ä¹ elements å­æ®µä¸å£°æä¸ºæ³åç±»å eï¼ å ä¸ºæ³åæ¦é¤åç­äº object[] elementdataï¼æ²¡æåºå«ã\n\n\n# queue æ¥å£\n\nqueue ç api å¯ä»¥åä¸º 2 ç±»ï¼åºå«å¨äºæ¹æ³çæç»ç­ç¥ä¸ï¼\n\n * æå¼å¸¸ï¼\n   * åç©ºéååæ°æ®ï¼ä¼æåº nosuchelementexception å¼å¸¸ï¼\n   * åå®¹éæ»¡çéåå æ°æ®ï¼ä¼æåº illegalstateexception å¼å¸¸ã\n * è¿åç¹æ®å¼ï¼\n   * åç©ºéååæ°æ®ï¼ä¼è¿å nullï¼\n   * åå®¹éæ»¡çéåå æ°æ®ï¼ä¼è¿å falseã\n\næç»ç­ç¥     æå¼å¸¸         è¿åç¹æ®å¼\nå¥éï¼éå°¾ï¼   add(e)      offer(e)\nåºéï¼éå¤´ï¼   remove()    poll()\nè§å¯ï¼éå¤´ï¼   element()   peek()\n\n\n# deque æ¥å£ï¼ç»§æ¿äº queue æ¥å£ï¼\n\njava æ²¡ææä¾æ åçæ æ¥å£ï¼èæ¯æ¾å¨ deque æ¥å£ä¸­ï¼\n\næç»ç­ç¥     æå¼å¸¸       ç­ä»·äº\nå¥æ        push(e)   addfirst(e)\nåºæ        pop()     removefirst()\nè§å¯ï¼æ é¡¶ï¼   peek()    peekfirst()\n\né¤äºæ åçéååæ è¡ä¸ºï¼deque æ¥å£è¿æä¾äº 12 ä¸ªå¨ä¸¤ç«¯æä½çæ¹æ³ï¼\n\næç»ç­ç¥   æå¼å¸¸                           è¿åå¼\nå¢å      addfirst(e)/ addlast(e)       offerfirst(e)/ offerlast(e)\nå é¤     removefirst()/ removelast()   pollfirst()/ polllast()\nè§å¯     getfirst()/ getlast()         peekfirst()/ peeklast()",charsets:{cjk:!0}},{title:"JVMåå¾åæ¶",frontmatter:{title:"JVMåå¾åæ¶",date:"2023-03-19T15:24:52.000Z",permalink:"/pages/a934e8/"},regularPath:"/01.Java/03.JVM/03.JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.html",relativePath:"01.Java/03.JVM/03.JVMåå¾åæ¶.md",key:"v-d45608ea",path:"/pages/a934e8/",headers:[{level:2,title:"åå¾åæ¶ç®æ³",slug:"åå¾åæ¶ç®æ³",normalizedTitle:"åå¾åæ¶ç®æ³",charIndex:2},{level:2,title:"åå¾åæ¶å¨",slug:"åå¾åæ¶å¨",normalizedTitle:"åå¾åæ¶å¨",charIndex:72},{level:2,title:"å¯¹æ¯",slug:"å¯¹æ¯",normalizedTitle:"å¯¹æ¯",charIndex:489},{level:2,title:"CMSï¼Concurrent Mark Sweepï¼",slug:"cms-concurrent-mark-sweep",normalizedTitle:"cmsï¼concurrent mark sweepï¼",charIndex:833},{level:2,title:"G1",slug:"g1",normalizedTitle:"g1",charIndex:230},{level:2,title:"ZGC",slug:"zgc",normalizedTitle:"zgc",charIndex:247},{level:3,title:"çè²æé",slug:"çè²æé",normalizedTitle:"çè²æé",charIndex:3525},{level:3,title:"è¯»å±é",slug:"è¯»å±é",normalizedTitle:"è¯»å±é",charIndex:784},{level:2,title:"ç©ºé´åéæä¿",slug:"ç©ºé´åéæä¿",normalizedTitle:"ç©ºé´åéæä¿",charIndex:4079},{level:2,title:"GC çè§¦åæ¡ä»¶",slug:"gc-çè§¦åæ¡ä»¶",normalizedTitle:"gc çè§¦åæ¡ä»¶",charIndex:4345},{level:2,title:"é»è®¤çåå¾åæ¶å¨",slug:"é»è®¤çåå¾åæ¶å¨",normalizedTitle:"é»è®¤çåå¾åæ¶å¨",charIndex:4659},{level:2,title:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ",slug:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ",normalizedTitle:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ",charIndex:4769},{level:2,title:"å¯ä»¥ä½ä¸ºGC Rootsçå¯¹è±¡",slug:"å¯ä»¥ä½ä¸ºgc-rootsçå¯¹è±¡",normalizedTitle:"å¯ä»¥ä½ä¸ºgc rootsçå¯¹è±¡",charIndex:4985},{level:2,title:"å¼ç¨",slug:"å¼ç¨",normalizedTitle:"å¼ç¨",charIndex:1652},{level:2,title:"å¸¸éæ± çä½ç½®",slug:"å¸¸éæ± çä½ç½®",normalizedTitle:"å¸¸éæ± çä½ç½®",charIndex:5503},{level:2,title:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",slug:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",normalizedTitle:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",charIndex:5881}],headersStr:"åå¾åæ¶ç®æ³ åå¾åæ¶å¨ å¯¹æ¯ CMSï¼Concurrent Mark Sweepï¼ G1 ZGC çè²æé è¯»å±é ç©ºé´åéæä¿ GC çè§¦åæ¡ä»¶ é»è®¤çåå¾åæ¶å¨ å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ å¯ä»¥ä½ä¸ºGC Rootsçå¯¹è±¡ å¼ç¨ å¸¸éæ± çä½ç½® å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",content:'# åå¾åæ¶ç®æ³\n\n * æ è®°-æ¸ç Mark-Sweep\n * æ è®°-å¤å¶ï¼å¸¸ç¨äºæ°çä»£\n * æ è®°-æ´ç Mark-Compact\n\n\n# åå¾åæ¶å¨\n\nåå¾åæ¶å¨åç±»ï¼\n\n * æ°çä»£\n\n * * Serialï¼åçº¿ç¨\n   * ParNew ï¼åªè½è·CMSæ­éï¼ï¼å¤çº¿ç¨å¹¶è¡\n   * Parallel Scavenge\n\n * èå¹´ä»£\n\n * * Serial Old\n   * Parallel Old\n   * CMS\n\n * éç¨\n\n * * G1\n\n * ä½å»¶è¿\n\n * * ZGC\n   * Shenandoah\n\næ­éï¼\n\n * Serial + Serial Old\n * Parallel Scavenge + Parallel Old\n * Parallel Scavenge + Serial Old\n * ParNew + CMS ï¼ParNewåCMSå¯ä¸ä½¿ç¨æåµï¼\n * G1\n * ZGC\n * Shenandoah\n * Serial+ CMS ï¼JDK 9ç§»é¤ï¼\n * ParNew + Serial Oldï¼JDK 9ç§»é¤ï¼\n\n\n# å¯¹æ¯\n\n * Serial æ¯åçº¿ç¨çæ¬ï¼ParNewæ¯Serialçå¤çº¿ç¨çæ¬ã\n * Parallel Scavenge å³æ³¨çæ¯ååéï¼CPUç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸æ»æ¶é´çæ¯å¼ï¼ï¼CMSå³æ³¨çæ¯çº¿ç¨çåé¡¿æ¶é´ï¼æé«ç¨æ·ä½éªï¼ã\n * G1å³æ³¨ä½åé¡¿+é«ååãG1 ä»æ´ä½æ¥çæ¯åºäºâæ è®°-æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨ä¸æ¥çæ¯åºäºâæ è®°-å¤å¶âç®æ³å®ç°çã\n * G1 æ¶éå¨å¨åå°ç»´æ¤äºä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼åéæ©åæ¶ä»·å¼æå¤§ç Region(è¿ä¹å°±æ¯å®çåå­ Garbage-First çç±æ¥) ã\n * ZGCï¼åºäºRegion åå­å¸å±ï¼ä¸è®¾åä»£ï¼ä½¿ç¨äºè¯»å±éãæè²æéååå­å¤éæ å°ç­ææ¯å®ç°å¯å¹¶åçæ è®°-æ´çç®æ³ï¼ä»¥ä½å»¶è¿ä¸ºé¦è¦ç®æ ã\n\n\n\n\n# CMSï¼Concurrent Mark Sweepï¼\n\næ§è¡æ­¥éª¤ï¼\n\n 1. åå§æ è®°ï¼ä»ä»åªæ¯æ è®°ä¸ä¸ GC Roots è½ç´æ¥å³èå°çå¯¹è±¡ï¼éåº¦å¾å¿«ï¼éè¦åé¡¿ãä¼å¯¼è´swtã\n 2. å¹¶åæ è®°ï¼ä¸ç¨æ·çº¿ç¨åæ¶è¿è¡ï¼è¿è¡ GC Roots Tracing çè¿ç¨ï¼å®å¨æ´ä¸ªåæ¶è¿ç¨ä¸­èæ¶æé¿ï¼ä¸éè¦åé¡¿ã\n 3. éæ°æ è®°ï¼ä¼å¯¼è´swtãä¸ºäºä¿®æ­£å¹¶åæ è®°æé´å ç¨æ·ç¨åºç»§ç»­è¿ä½èå¯¼è´æ è®°åå¨çé£ä¸é¨åå¯¹è±¡çæ è®°è®°å½ï¼éè¦åé¡¿ã\n 4. å¹¶åæ¸çï¼ä¸éè¦åé¡¿ã\n 5. å¹¶åéç½®çº¿ç¨ï¼ç­å¾ä¸æ¬¡CMSçè§¦å\n\nç¼ºç¹ï¼\n\n * ååéä½: ä½åé¡¿æ¶é´æ¯ä»¥çºç²ååéä¸ºä»£ä»·çï¼å¯¼è´ CPU å©ç¨çä¸å¤é«ã\n\n * å¯¹ CPU èµæºææï¼\n\n * æ æ³å¤çæµ®å¨åå¾ãæµ®å¨åå¾æ¯æå¹¶åæ¸é¤é¶æ®µç±äºç¨æ·çº¿ç¨ç»§ç»­è¿è¡èäº§ççåå¾ï¼è¿é¨ååå¾åªè½å°ä¸ä¸æ¬¡ GC æ¶æè½è¿è¡åæ¶ãç±äºæµ®å¨åå¾çå­å¨ï¼å æ­¤éè¦é¢çåºä¸é¨ååå­ï¼æå³ç CMS æ¶éä¸è½åå¶å®æ¶éå¨é£æ ·ç­å¾èå¹´ä»£å¿«æ»¡çæ¶åååæ¶ãå¦æé¢ççåå­ä¸å¤å­æ¾æµ®å¨åå¾ï¼å°±ä¼åºç° Concurrent Mode Failureï¼è¿æ¶èææºå°ä¸´æ¶å¯ç¨ Serial Old æ¥æ¿ä»£ CMSã\n\n * å®ä½¿ç¨çåæ¶ç®æ³-âæ è®°-æ¸é¤âç®æ³ä¼å¯¼è´æ¶éç»ææ¶ä¼æå¤§éç©ºé´ç¢çäº§çã\n\n\n# G1\n\nå¼å¥Regionååºçæ¦å¿µï¼å¼±ååä»£çæ¦å¿µã\n\nG1 æå ååæå¤ä¸ªå¤§å°ç¸ç­çç¬ç«åºå(Region)ï¼æ°çä»£åèå¹´ä»£ä¸åç©çéç¦»ã\n\nä½¿å¾æ¯ä¸ªå°ç©ºé´å¯ä»¥åç¬è¿è¡åå¾åæ¶ãè¿ç§ååæ¹æ³å¸¦æ¥äºå¾å¤§ççµæ´»æ§ï¼ä½¿å¾å¯é¢æµçåé¡¿æ¶é´æ¨¡åæä¸ºå¯è½ãéè¿è®°å½æ¯ä¸ª Region åå¾åæ¶æ¶é´ä»¥ååæ¶æè·å¾çç©ºé´(è¿ä¸¤ä¸ªå¼æ¯éè¿è¿å»åæ¶çç»éªè·å¾)ï¼å¹¶ç»´æ¤ä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼ååæ¶ä»·å¼æå¤§ç Regionã\n\næ¯ä¸ª Region é½æä¸ä¸ª Remembered Setï¼ç¨æ¥è®°å½è¯¥ Region å¯¹è±¡çå¼ç¨å¯¹è±¡æå¨ç Regionãéè¿ä½¿ç¨ Remembered Setï¼å¨åå¯è¾¾æ§åæçæ¶åå°±å¯ä»¥é¿åå¨å æ«æã\n\n\n\næ§è¡æ­¥éª¤ï¼\n\n 1. åå§æ è®°\n 2. å¹¶åæ è®°\n 3. æç»æ è®°ï¼æ è®°é£äºå¨å¹¶åæ è®°é¶æ®µåçååçå¯¹è±¡ï¼å°è¢«åæ¶ï¼\n 4. ç­éåæ¶ï¼é¦åå¯¹åä¸ªReginçåæ¶ä»·å¼åææ¬è¿è¡æåºï¼æ ¹æ®ç¨æ·ææå¾çGCåé¡¿æ¶é´æå®åæ¶è®¡åï¼åæ¶ä¸é¨åRegionï¼\n\n\nç¹ç¹ï¼\n\n * ç©ºé´æ´å: æ´ä½æ¥çæ¯åºäºâæ è®° - æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨(ä¸¤ä¸ª Region ä¹é´)ä¸æ¥çæ¯åºäºâå¤å¶âç®æ³å®ç°çï¼è¿æå³çè¿è¡æé´ä¸ä¼äº§çåå­ç©ºé´ç¢çã\n\n * å¯é¢æµçåé¡¿: è½è®©ä½¿ç¨èæç¡®æå®å¨ä¸ä¸ªé¿åº¦ä¸º M æ¯«ç§çæ¶é´çæ®µåï¼æ¶èå¨ GC ä¸çæ¶é´ä¸å¾è¶è¿ N æ¯«ç§ã\n\n\nG1çä¸äºæ»ç»ï¼\n\n * G1æ¯ä¸æ¬¾éå¸¸ä¼ç§çåå¾æ¶éå¨ï¼ä¸ä»éåå åå­å¤§çåºç¨ï¼åæ¶ä¹ç®åäºè°ä¼çå·¥ä½ãéè¿ä¸»è¦çåæ°åå§åæå¤§å ç©ºé´ãä»¥åæå¤§å®¹å¿çGCæåç®æ ï¼å°±è½å¾å°ä¸éçæ§è½ã\n\n * è½ç¶G1ä¹æç±»ä¼¼CMSçæ¶éå¨ä½ï¼åå§æ è®°ãå¹¶åæ è®°ãéæ°æ è®°ãæ¸é¤ãè½¬ç§»åæ¶ï¼å¹¶ä¸ä¹ä»¥ä¸ä¸ªä¸²è¡æ¶éå¨åæä¿æºå¶ã\n\n * G1çè®¾è®¡ååæ¯"é¦åæ¶éå°½å¯è½å¤çåå¾(Garbage First)"ãå æ­¤ï¼G1å¹¶ä¸ä¼ç­åå­èå°½(ä¸²è¡ãå¹¶è¡)æèå¿«èå°½(CMS)çæ¶åå¼å§åå¾æ¶éï¼èæ¯å¨åé¨éç¨äºå¯åå¼ç®æ³ï¼å¨èå¹´ä»£æ¾åºå·æé«æ¶éæ¶ççååºè¿è¡æ¶éãåæ¶G1å¯ä»¥æ ¹æ®ç¨æ·è®¾ç½®çæåæ¶é´ç®æ èªå¨è°æ´å¹´è½»ä»£åæ»å å¤§å°ï¼æåç®æ è¶ç­å¹´è½»ä»£ç©ºé´è¶å°ãæ»ç©ºé´å°±è¶å¤§ï¼\n\n * G1éç¨åå­ååº(Region)çæè·¯ï¼å°åå­ååä¸ºä¸ä¸ªä¸ªç¸ç­å¤§å°çåå­ååºï¼åæ¶æ¶åä»¥ååºä¸ºåä½è¿è¡åæ¶ï¼å­æ´»çå¯¹è±¡å¤å¶å°å¦ä¸ä¸ªç©ºé²ååºä¸­ãç±äºé½æ¯ä»¥ç¸ç­å¤§å°çååºä¸ºåä½è¿è¡æä½ï¼å æ­¤G1å¤©ç¶å°±æ¯ä¸ç§åç¼©æ¹æ¡(å±é¨åç¼©)ï¼\n\n * G1è½ç¶ä¹æ¯åä»£æ¶éå¨ï¼ä½æ´ä¸ªåå­ååºä¸å­å¨ç©çä¸çå¹´è½»ä»£ä¸èå¹´ä»£çåºå«ï¼ä¹ä¸éè¦å®å¨ç¬ç«çsurvivor(to space)å åå¤å¶åå¤ãG1åªæé»è¾ä¸çåä»£æ¦å¿µï¼æèè¯´æ¯ä¸ªååºé½å¯è½éG1çè¿è¡å¨ä¸åä»£ä¹é´åååæ¢ï¼\n\n * G1çæ¶éé½æ¯STWçï¼ä½å¹´è½»ä»£åèå¹´ä»£çæ¶éçéæ¯è¾æ¨¡ç³ï¼éç¨äºæ··å(mixed)æ¶éçæ¹å¼ãå³æ¯æ¬¡æ¶éæ¢å¯è½åªæ¶éå¹´è½»ä»£ååº(å¹´è½»ä»£æ¶é)ï¼ä¹å¯è½å¨æ¶éå¹´è½»ä»£çåæ¶ï¼åå«é¨åèå¹´ä»£ååº(æ··åæ¶é)ï¼è¿æ ·å³ä½¿å åå­å¾å¤§æ¶ï¼ä¹å¯ä»¥éå¶æ¶éèå´ï¼ä»èéä½åé¡¿ã\n\n\nShenandoahä¸G1ç3ä¸ªææ¾ä¸åï¼\n\n * æ¯æå¹¶åçæ´çç®æ³ï¼æéè¦ï¼ãG1çåæ¶é¶æ®µæ¯å¯ä»¥å¤çº¿ç¨å¹¶è¡çï¼ä½ä¸è½ä¸ç¨æ·çº¿ç¨å¹¶åã\n * ç®åé»è®¤ä¸ä½¿ç¨åä»£åæ¶\n * æå¼G1ä¸­èè´¹å¤§éåå­åè®¡ç®èµæºå»ç»´æ¤çè®°å¿éï¼ä½¿ç¨âè¿æ¥ç©éµâçå¨å±æ°æ®ç»ææ¥è®°å½è·¨Regionçå¼ç¨å³ç³»ã\n\n\n# ZGC\n\nZGCï¼The Z Garbage Collectorï¼æ¯JDK 11ä¸­æ¨åºçä¸æ¬¾ä½å»¶è¿åå¾åæ¶å¨ï¼å®çè®¾è®¡ç®æ åæ¬ï¼\n\n * åé¡¿æ¶é´ä¸è¶è¿10msï¼\n * åé¡¿æ¶é´ä¸ä¼éçå çå¤§å°ï¼æèæ´»è·å¯¹è±¡çå¤§å°èå¢å ï¼å¯¹ç¨åºååéå½±åå°äº15%ï¼ï¼\n * æ¯æ8MB~4TBçº§å«çå ï¼æªæ¥æ¯æ16TBï¼ã\n\næ è®°å¤å¶ç®æ³çä¸ä¸ªé¶æ®µï¼\n\næ è®°é¶æ®µï¼å³ä»GC Rootséåå¼å§ï¼æ è®°æ´»è·å¯¹è±¡ï¼\n\nè½¬ç§»é¶æ®µï¼å³ææ´»è·å¯¹è±¡å¤å¶å°æ°çåå­å°åä¸ï¼\n\néå®ä½é¶æ®µï¼å ä¸ºè½¬ç§»å¯¼è´å¯¹è±¡çå°ååçäºååï¼å¨éå®ä½é¶æ®µï¼æææåå¯¹è±¡æ§å°åçæéé½è¦è°æ´å°å¯¹è±¡æ°çå°åä¸ã\n\né®é¢åæï¼åé¡¿æ¶é´çä¸»è¦ç¶é¢æ¯æ¯æ è®°-å¤å¶ä¸­è½¬ç§»é¶æ®µçSTWãæ è®°-å¤å¶ç®æ³åºç¨å¨CMSæ°çä»£ï¼ParNewæ¯CMSé»è®¤çæ°çä»£åå¾åæ¶å¨ï¼åG1åå¾åæ¶å¨ä¸­ã\n\nä¸CMSä¸­çParNewåG1ç±»ä¼¼ï¼ZGCä¹éç¨æ è®°-å¤å¶ç®æ³ï¼ä¸è¿ZGCå¯¹è¯¥ç®æ³åäºéå¤§æ¹è¿ï¼ZGCå¨æ è®°ãè½¬ç§»åéå®ä½é¶æ®µå ä¹é½æ¯å¹¶åçï¼è¿æ¯ZGCå®ç°åé¡¿æ¶é´å°äº10msç®æ çæå³é®åå ã\n\nZGCåªæä¸ä¸ªSTWé¶æ®µï¼åå§æ è®°ï¼åæ è®°ï¼åå§è½¬ç§»ãå¶ä¸­ï¼åå§æ è®°ååå§è½¬ç§»åå«é½åªéè¦æ«æææGC Rootsï¼å¶å¤çæ¶é´åGC Rootsçæ°éææ­£æ¯ï¼ä¸è¬æåµèæ¶éå¸¸ç­ï¼åæ è®°é¶æ®µSTWæ¶é´å¾ç­ï¼æå¤1msï¼è¶è¿1msååæ¬¡è¿å¥å¹¶åæ è®°é¶æ®µãå³ï¼ZGCå ä¹æææåé½åªä¾èµäºGC Rootséåå¤§å°ï¼åé¡¿æ¶é´ä¸ä¼éçå çå¤§å°æèæ´»è·å¯¹è±¡çå¤§å°èå¢å ãä¸ZGCå¯¹æ¯ï¼G1çè½¬ç§»é¶æ®µå®å¨STWçï¼ä¸åé¡¿æ¶é´éå­æ´»å¯¹è±¡çå¤§å°å¢å èå¢å ã\n\n\n\nZGCéè¿çè²æéåè¯»å±éææ¯ï¼è§£å³äºè½¬ç§»è¿ç¨ä¸­åç¡®è®¿é®å¯¹è±¡çé®é¢ï¼å®ç°äºå¹¶åè½¬ç§»ãå¤§è´åçæè¿°å¦ä¸ï¼å¹¶åè½¬ç§»ä¸­âå¹¶åâæå³çGCçº¿ç¨å¨è½¬ç§»å¯¹è±¡çè¿ç¨ä¸­ï¼åºç¨çº¿ç¨ä¹å¨ä¸åå°è®¿é®å¯¹è±¡ãåè®¾å¯¹è±¡åçè½¬ç§»ï¼ä½å¯¹è±¡å°åæªåæ¶æ´æ°ï¼é£ä¹åºç¨çº¿ç¨å¯è½è®¿é®å°æ§å°åï¼ä»èé æéè¯¯ãèå¨ZGCä¸­ï¼åºç¨çº¿ç¨è®¿é®å¯¹è±¡å°è§¦åâè¯»å±éâï¼å¦æåç°å¯¹è±¡è¢«ç§»å¨äºï¼é£ä¹âè¯»å±éâä¼æè¯»åºæ¥çæéæ´æ°å°å¯¹è±¡çæ°å°åä¸ï¼è¿æ ·åºç¨çº¿ç¨å§ç»è®¿é®çé½æ¯å¯¹è±¡çæ°å°åãé£ä¹ï¼JVMæ¯å¦ä½å¤æ­å¯¹è±¡è¢«ç§»å¨è¿å¢ï¼å°±æ¯å©ç¨å¯¹è±¡å¼ç¨çå°åï¼å³çè²æéãä¸é¢ä»ç»çè²æéåè¯»å±éææ¯ç»èã\n\n\n# çè²æé\n\nçè²æéæ¯ä¸ç§å°ä¿¡æ¯å­å¨å¨æéä¸­çææ¯ã\n\nZGCå°å¯¹è±¡å­æ´»ä¿¡æ¯å­å¨å¨42~45ä½ä¸­ï¼è¿ä¸ä¼ ç»çåå¾åæ¶å¹¶å°å¯¹è±¡å­æ´»ä¿¡æ¯æ¾å¨å¯¹è±¡å¤´ä¸­å®å¨ä¸åã\n\n\n# è¯»å±é\n\nè¯»å±éæ¯JVMååºç¨ä»£ç æå¥ä¸å°æ®µä»£ç çææ¯ãå½åºç¨çº¿ç¨ä»å ä¸­è¯»åå¯¹è±¡å¼ç¨æ¶ï¼å°±ä¼æ§è¡è¿æ®µä»£ç ãéè¦æ³¨æçæ¯ï¼ä»âä»å ä¸­è¯»åå¯¹è±¡å¼ç¨âæä¼è§¦åè¿æ®µä»£ç ã\n\nZGCä¸­è¯»å±éçä»£ç ä½ç¨ï¼å¨å¯¹è±¡æ è®°åè½¬ç§»è¿ç¨ä¸­ï¼ç¨äºç¡®å®å¯¹è±¡çå¼ç¨å°åæ¯å¦æ»¡è¶³æ¡ä»¶ï¼å¹¶ä½åºç¸åºå¨ä½ã\n\n\nåèï¼\n\n * https://www.pdai.tech/md/java/jvm/java-jvm-gc-zgc.html\n\n\n# ç©ºé´åéæä¿\n\nå¨åç Minor GC ä¹åï¼èææºåæ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºæ°çä»£ææå¯¹è±¡æ»ç©ºé´ï¼å¦ææ¡ä»¶æç«çè¯ï¼é£ä¹ Minor GC å¯ä»¥ç¡®è®¤æ¯å®å¨çã\n\nå¦æä¸æç«çè¯èææºä¼æ¥ç HandlePromotionFailure è®¾ç½®å¼æ¯å¦åè®¸æä¿å¤±è´¥ï¼å¦æåè®¸é£ä¹å°±ä¼ç»§ç»­æ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºåæ¬¡æåå°èå¹´ä»£å¯¹è±¡çå¹³åå¤§å°ï¼å¦æå¤§äºï¼å°å°è¯çè¿è¡ä¸æ¬¡ Minor GCï¼å¦æå°äºï¼æè HandlePromotionFailure è®¾ç½®ä¸åè®¸åé©ï¼é£ä¹å°±è¦è¿è¡ä¸æ¬¡ Full GCã\n\n\n# GC çè§¦åæ¡ä»¶\n\nMinor GCï¼å½ eden æ»¡æ¶ï¼è§¦åä¸æ¬¡ minor GCã\n\nFull GCï¼\n\n * è°ç¨ System.gc(); åªæ¯å»ºè®®èææºæ§è¡ Full GCï¼ä½æ¯èææºä¸ä¸å®çæ­£å»æ§è¡ãä¸å»ºè®®ä½¿ç¨è¿ç§æ¹å¼ï¼èæ¯è®©èææºç®¡çåå­ã\n * èå¹´ä»£ç©ºé´ä¸è¶³\n * ç©ºé´åéæä¿å¤±è´¥\n * JDK1.7 åä¹åï¼æ°¸ä¹ä»£ç©ºé´ä¸è¶³ã\n * Concurrent Mode Failureï¼æ§è¡ CMS GC çè¿ç¨ä¸­åæ¶æå¯¹è±¡è¦æ¾å¥èå¹´ä»£ï¼èæ­¤æ¶èå¹´ä»£ç©ºé´ä¸è¶³(å¯è½æ¯ GC è¿ç¨ä¸­æµ®å¨åå¾è¿å¤å¯¼è´ææ¶æ§çç©ºé´ä¸è¶³)ï¼ä¾¿ä¼æ¥ Concurrent Mode Failure éè¯¯ï¼å¹¶è§¦å Full GCã\n\n\n# é»è®¤çåå¾åæ¶å¨\n\n * JDK8 é»è®¤ä½¿ç¨çæ¯ Parallel Scavenge + Parallel Oldãä½ä¸è¬ä¸ç¨è¿ä¸ªãå¸¸ç¨ParNew+CMSå§ï¼å ä¸ºæ¯å¯ä¸æ­éåï¼\n * JDK9~16 é»è®¤G1\n\n\n# å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ\n\n * å¼ç¨è®¡æ°æ³\n\n * * å®ç°ç®åï¼æçé«ï¼ä½æ¯ç®åä¸»æµçèææºä¸­å¹¶æ²¡æéæ©è¿ä¸ªç®æ³æ¥ç®¡çåå­ï¼å¶æä¸»è¦çåå æ¯å®å¾é¾è§£å³å¯¹è±¡ä¹é´ç¸äºå¾ªç¯å¼ç¨çé®é¢ã\n\n * å¯è¾¾æ§åææ³ï¼JVMä½¿ç¨çï¼\n\n * * éè¿ä¸ç³»åçç§°ä¸º âGC Rootsâ çå¯¹è±¡ä½ä¸ºèµ·ç¹ï¼ä»è¿äºèç¹å¼å§åä¸æç´¢ï¼èç¹æèµ°è¿çè·¯å¾ç§°ä¸ºå¼ç¨é¾ï¼å½ä¸ä¸ªå¯¹è±¡å° GC Roots æ²¡æä»»ä½å¼ç¨é¾ç¸è¿çè¯ï¼åè¯ææ­¤å¯¹è±¡æ¯ä¸å¯ç¨çã\n\n\n# å¯ä»¥ä½ä¸ºGC Rootsçå¯¹è±¡\n\n * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¬å°æ¹æ³æ ï¼Nativeæ¹æ³ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n * ææè¢«åæ­¥éææçå¯¹è±¡\n\n\n# å¼ç¨\n\nJDK1.2 ä¹åï¼Java ä¸­å¼ç¨çå®ä¹å¾ä¼ ç»ï¼å¦æ reference ç±»åçæ°æ®å­å¨çæ°å¼ä»£è¡¨çæ¯å¦ä¸ååå­çèµ·å§å°åï¼å°±ç§°è¿ååå­ä»£è¡¨ä¸ä¸ªå¼ç¨ã\n\nJDK1.2 ä»¥åï¼Java å¯¹å¼ç¨çæ¦å¿µè¿è¡äºæ©åï¼å°å¼ç¨åä¸ºå¼ºå¼ç¨ãè½¯å¼ç¨ãå¼±å¼ç¨ãèå¼ç¨åç§ï¼å¼ç¨å¼ºåº¦éæ¸åå¼±ï¼\n\n * å¼ºå¼ç¨ï¼StrongReferenceï¼ï¼åå¾åæ¶å¨ç»ä¸ä¼åæ¶å®\n * è½¯å¼ç¨ï¼SoftReferenceï¼ï¼å¦æåå­ç©ºé´è¶³å¤ï¼åå¾åæ¶å¨å°±ä¸ä¼åæ¶å®ï¼å¦æåå­ç©ºé´ä¸è¶³äºï¼å°±ä¼åæ¶è¿äºå¯¹è±¡çåå­ã\n * å¼±å¼ç¨ï¼WeakReferenceï¼ï¼ä¸ç®¡å½ååå­ç©ºé´è¶³å¤ä¸å¦ï¼é½ä¼åæ¶å®çåå­ã\n * èå¼ç¨ï¼PhantomReferenceï¼ï¼å¦æä¸ä¸ªå¯¹è±¡ä»ææèå¼ç¨ï¼é£ä¹å®å°±åæ²¡æä»»ä½å¼ç¨ä¸æ ·ï¼å¨ä»»ä½æ¶åé½å¯è½è¢«åå¾åæ¶ãä¸ºä¸ä¸ªå¯¹è±¡è®¾ç½®èå¼ç¨å³èçå¯ä¸ç®çå°±æ¯è½å¨è¿ä¸ªå¯¹è±¡è¢«åæ¶æ¶æ¶å°ä¸ä¸ªç³»ç»éç¥ã\n\n\n# å¸¸éæ± çä½ç½®\n\nJDK1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\nJDK1.7 å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ ã\n\nJDK1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(Metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(Metaspace)\n\nåå¦å¨å­ç¬¦ä¸²å¸¸éæ± ä¸­å­å¨å­ç¬¦ä¸² "abc"ï¼å¦æå½åæ²¡æä»»ä½ String å¯¹è±¡å¼ç¨è¯¥å­ç¬¦ä¸²å¸¸éçè¯ï¼å°±è¯´æå¸¸é "abc" å°±æ¯åºå¼å¸¸éï¼å¦æè¿æ¶åçåå­åæ¶çè¯èä¸æå¿è¦çè¯ï¼"abc" å°±ä¼è¢«ç³»ç»æ¸çåºå¸¸éæ± äºã\n\n\n# å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»\n\næ¹æ³åºä¸»è¦åæ¶çæ¯æ ç¨çç±»ï¼é£ä¹å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»çå¢ï¼\n\nå¤å®ä¸ä¸ªå¸¸éæ¯å¦æ¯âåºå¼å¸¸éâæ¯è¾ç®åï¼èè¦å¤å®ä¸ä¸ªç±»æ¯å¦æ¯âæ ç¨çç±»âçæ¡ä»¶åç¸å¯¹èå»è®¸å¤ãç±»éè¦åæ¶æ»¡è¶³ä¸é¢ 3 ä¸ªæ¡ä»¶æè½ç®æ¯ âæ ç¨çç±»â ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ Java å ä¸­ä¸å­å¨è¯¥ç±»çä»»ä½å®ä¾ã\n * å è½½è¯¥ç±»ç ClassLoader å·²ç»è¢«åæ¶ã\n * è¯¥ç±»å¯¹åºç java.lang.Class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³ã\n\nèææºå¯ä»¥å¯¹æ»¡è¶³ä¸è¿° 3 ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âå¯ä»¥âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ä¸ä½¿ç¨äºå°±ä¼å¿ç¶è¢«åæ¶ã',normalizedContent:'# åå¾åæ¶ç®æ³\n\n * æ è®°-æ¸ç mark-sweep\n * æ è®°-å¤å¶ï¼å¸¸ç¨äºæ°çä»£\n * æ è®°-æ´ç mark-compact\n\n\n# åå¾åæ¶å¨\n\nåå¾åæ¶å¨åç±»ï¼\n\n * æ°çä»£\n\n * * serialï¼åçº¿ç¨\n   * parnew ï¼åªè½è·cmsæ­éï¼ï¼å¤çº¿ç¨å¹¶è¡\n   * parallel scavenge\n\n * èå¹´ä»£\n\n * * serial old\n   * parallel old\n   * cms\n\n * éç¨\n\n * * g1\n\n * ä½å»¶è¿\n\n * * zgc\n   * shenandoah\n\næ­éï¼\n\n * serial + serial old\n * parallel scavenge + parallel old\n * parallel scavenge + serial old\n * parnew + cms ï¼parnewåcmså¯ä¸ä½¿ç¨æåµï¼\n * g1\n * zgc\n * shenandoah\n * serial+ cms ï¼jdk 9ç§»é¤ï¼\n * parnew + serial oldï¼jdk 9ç§»é¤ï¼\n\n\n# å¯¹æ¯\n\n * serial æ¯åçº¿ç¨çæ¬ï¼parnewæ¯serialçå¤çº¿ç¨çæ¬ã\n * parallel scavenge å³æ³¨çæ¯ååéï¼cpuç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸æ»æ¶é´çæ¯å¼ï¼ï¼cmså³æ³¨çæ¯çº¿ç¨çåé¡¿æ¶é´ï¼æé«ç¨æ·ä½éªï¼ã\n * g1å³æ³¨ä½åé¡¿+é«ååãg1 ä»æ´ä½æ¥çæ¯åºäºâæ è®°-æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨ä¸æ¥çæ¯åºäºâæ è®°-å¤å¶âç®æ³å®ç°çã\n * g1 æ¶éå¨å¨åå°ç»´æ¤äºä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼åéæ©åæ¶ä»·å¼æå¤§ç region(è¿ä¹å°±æ¯å®çåå­ garbage-first çç±æ¥) ã\n * zgcï¼åºäºregion åå­å¸å±ï¼ä¸è®¾åä»£ï¼ä½¿ç¨äºè¯»å±éãæè²æéååå­å¤éæ å°ç­ææ¯å®ç°å¯å¹¶åçæ è®°-æ´çç®æ³ï¼ä»¥ä½å»¶è¿ä¸ºé¦è¦ç®æ ã\n\n\n\n\n# cmsï¼concurrent mark sweepï¼\n\næ§è¡æ­¥éª¤ï¼\n\n 1. åå§æ è®°ï¼ä»ä»åªæ¯æ è®°ä¸ä¸ gc roots è½ç´æ¥å³èå°çå¯¹è±¡ï¼éåº¦å¾å¿«ï¼éè¦åé¡¿ãä¼å¯¼è´swtã\n 2. å¹¶åæ è®°ï¼ä¸ç¨æ·çº¿ç¨åæ¶è¿è¡ï¼è¿è¡ gc roots tracing çè¿ç¨ï¼å®å¨æ´ä¸ªåæ¶è¿ç¨ä¸­èæ¶æé¿ï¼ä¸éè¦åé¡¿ã\n 3. éæ°æ è®°ï¼ä¼å¯¼è´swtãä¸ºäºä¿®æ­£å¹¶åæ è®°æé´å ç¨æ·ç¨åºç»§ç»­è¿ä½èå¯¼è´æ è®°åå¨çé£ä¸é¨åå¯¹è±¡çæ è®°è®°å½ï¼éè¦åé¡¿ã\n 4. å¹¶åæ¸çï¼ä¸éè¦åé¡¿ã\n 5. å¹¶åéç½®çº¿ç¨ï¼ç­å¾ä¸æ¬¡cmsçè§¦å\n\nç¼ºç¹ï¼\n\n * ååéä½: ä½åé¡¿æ¶é´æ¯ä»¥çºç²ååéä¸ºä»£ä»·çï¼å¯¼è´ cpu å©ç¨çä¸å¤é«ã\n\n * å¯¹ cpu èµæºææï¼\n\n * æ æ³å¤çæµ®å¨åå¾ãæµ®å¨åå¾æ¯æå¹¶åæ¸é¤é¶æ®µç±äºç¨æ·çº¿ç¨ç»§ç»­è¿è¡èäº§ççåå¾ï¼è¿é¨ååå¾åªè½å°ä¸ä¸æ¬¡ gc æ¶æè½è¿è¡åæ¶ãç±äºæµ®å¨åå¾çå­å¨ï¼å æ­¤éè¦é¢çåºä¸é¨ååå­ï¼æå³ç cms æ¶éä¸è½åå¶å®æ¶éå¨é£æ ·ç­å¾èå¹´ä»£å¿«æ»¡çæ¶åååæ¶ãå¦æé¢ççåå­ä¸å¤å­æ¾æµ®å¨åå¾ï¼å°±ä¼åºç° concurrent mode failureï¼è¿æ¶èææºå°ä¸´æ¶å¯ç¨ serial old æ¥æ¿ä»£ cmsã\n\n * å®ä½¿ç¨çåæ¶ç®æ³-âæ è®°-æ¸é¤âç®æ³ä¼å¯¼è´æ¶éç»ææ¶ä¼æå¤§éç©ºé´ç¢çäº§çã\n\n\n# g1\n\nå¼å¥regionååºçæ¦å¿µï¼å¼±ååä»£çæ¦å¿µã\n\ng1 æå ååæå¤ä¸ªå¤§å°ç¸ç­çç¬ç«åºå(region)ï¼æ°çä»£åèå¹´ä»£ä¸åç©çéç¦»ã\n\nä½¿å¾æ¯ä¸ªå°ç©ºé´å¯ä»¥åç¬è¿è¡åå¾åæ¶ãè¿ç§ååæ¹æ³å¸¦æ¥äºå¾å¤§ççµæ´»æ§ï¼ä½¿å¾å¯é¢æµçåé¡¿æ¶é´æ¨¡åæä¸ºå¯è½ãéè¿è®°å½æ¯ä¸ª region åå¾åæ¶æ¶é´ä»¥ååæ¶æè·å¾çç©ºé´(è¿ä¸¤ä¸ªå¼æ¯éè¿è¿å»åæ¶çç»éªè·å¾)ï¼å¹¶ç»´æ¤ä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼ååæ¶ä»·å¼æå¤§ç regionã\n\næ¯ä¸ª region é½æä¸ä¸ª remembered setï¼ç¨æ¥è®°å½è¯¥ region å¯¹è±¡çå¼ç¨å¯¹è±¡æå¨ç regionãéè¿ä½¿ç¨ remembered setï¼å¨åå¯è¾¾æ§åæçæ¶åå°±å¯ä»¥é¿åå¨å æ«æã\n\n\n\næ§è¡æ­¥éª¤ï¼\n\n 1. åå§æ è®°\n 2. å¹¶åæ è®°\n 3. æç»æ è®°ï¼æ è®°é£äºå¨å¹¶åæ è®°é¶æ®µåçååçå¯¹è±¡ï¼å°è¢«åæ¶ï¼\n 4. ç­éåæ¶ï¼é¦åå¯¹åä¸ªreginçåæ¶ä»·å¼åææ¬è¿è¡æåºï¼æ ¹æ®ç¨æ·ææå¾çgcåé¡¿æ¶é´æå®åæ¶è®¡åï¼åæ¶ä¸é¨åregionï¼\n\n\nç¹ç¹ï¼\n\n * ç©ºé´æ´å: æ´ä½æ¥çæ¯åºäºâæ è®° - æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨(ä¸¤ä¸ª region ä¹é´)ä¸æ¥çæ¯åºäºâå¤å¶âç®æ³å®ç°çï¼è¿æå³çè¿è¡æé´ä¸ä¼äº§çåå­ç©ºé´ç¢çã\n\n * å¯é¢æµçåé¡¿: è½è®©ä½¿ç¨èæç¡®æå®å¨ä¸ä¸ªé¿åº¦ä¸º m æ¯«ç§çæ¶é´çæ®µåï¼æ¶èå¨ gc ä¸çæ¶é´ä¸å¾è¶è¿ n æ¯«ç§ã\n\n\ng1çä¸äºæ»ç»ï¼\n\n * g1æ¯ä¸æ¬¾éå¸¸ä¼ç§çåå¾æ¶éå¨ï¼ä¸ä»éåå åå­å¤§çåºç¨ï¼åæ¶ä¹ç®åäºè°ä¼çå·¥ä½ãéè¿ä¸»è¦çåæ°åå§åæå¤§å ç©ºé´ãä»¥åæå¤§å®¹å¿çgcæåç®æ ï¼å°±è½å¾å°ä¸éçæ§è½ã\n\n * è½ç¶g1ä¹æç±»ä¼¼cmsçæ¶éå¨ä½ï¼åå§æ è®°ãå¹¶åæ è®°ãéæ°æ è®°ãæ¸é¤ãè½¬ç§»åæ¶ï¼å¹¶ä¸ä¹ä»¥ä¸ä¸ªä¸²è¡æ¶éå¨åæä¿æºå¶ã\n\n * g1çè®¾è®¡ååæ¯"é¦åæ¶éå°½å¯è½å¤çåå¾(garbage first)"ãå æ­¤ï¼g1å¹¶ä¸ä¼ç­åå­èå°½(ä¸²è¡ãå¹¶è¡)æèå¿«èå°½(cms)çæ¶åå¼å§åå¾æ¶éï¼èæ¯å¨åé¨éç¨äºå¯åå¼ç®æ³ï¼å¨èå¹´ä»£æ¾åºå·æé«æ¶éæ¶ççååºè¿è¡æ¶éãåæ¶g1å¯ä»¥æ ¹æ®ç¨æ·è®¾ç½®çæåæ¶é´ç®æ èªå¨è°æ´å¹´è½»ä»£åæ»å å¤§å°ï¼æåç®æ è¶ç­å¹´è½»ä»£ç©ºé´è¶å°ãæ»ç©ºé´å°±è¶å¤§ï¼\n\n * g1éç¨åå­ååº(region)çæè·¯ï¼å°åå­ååä¸ºä¸ä¸ªä¸ªç¸ç­å¤§å°çåå­ååºï¼åæ¶æ¶åä»¥ååºä¸ºåä½è¿è¡åæ¶ï¼å­æ´»çå¯¹è±¡å¤å¶å°å¦ä¸ä¸ªç©ºé²ååºä¸­ãç±äºé½æ¯ä»¥ç¸ç­å¤§å°çååºä¸ºåä½è¿è¡æä½ï¼å æ­¤g1å¤©ç¶å°±æ¯ä¸ç§åç¼©æ¹æ¡(å±é¨åç¼©)ï¼\n\n * g1è½ç¶ä¹æ¯åä»£æ¶éå¨ï¼ä½æ´ä¸ªåå­ååºä¸å­å¨ç©çä¸çå¹´è½»ä»£ä¸èå¹´ä»£çåºå«ï¼ä¹ä¸éè¦å®å¨ç¬ç«çsurvivor(to space)å åå¤å¶åå¤ãg1åªæé»è¾ä¸çåä»£æ¦å¿µï¼æèè¯´æ¯ä¸ªååºé½å¯è½ég1çè¿è¡å¨ä¸åä»£ä¹é´åååæ¢ï¼\n\n * g1çæ¶éé½æ¯stwçï¼ä½å¹´è½»ä»£åèå¹´ä»£çæ¶éçéæ¯è¾æ¨¡ç³ï¼éç¨äºæ··å(mixed)æ¶éçæ¹å¼ãå³æ¯æ¬¡æ¶éæ¢å¯è½åªæ¶éå¹´è½»ä»£ååº(å¹´è½»ä»£æ¶é)ï¼ä¹å¯è½å¨æ¶éå¹´è½»ä»£çåæ¶ï¼åå«é¨åèå¹´ä»£ååº(æ··åæ¶é)ï¼è¿æ ·å³ä½¿å åå­å¾å¤§æ¶ï¼ä¹å¯ä»¥éå¶æ¶éèå´ï¼ä»èéä½åé¡¿ã\n\n\nshenandoahä¸g1ç3ä¸ªææ¾ä¸åï¼\n\n * æ¯æå¹¶åçæ´çç®æ³ï¼æéè¦ï¼ãg1çåæ¶é¶æ®µæ¯å¯ä»¥å¤çº¿ç¨å¹¶è¡çï¼ä½ä¸è½ä¸ç¨æ·çº¿ç¨å¹¶åã\n * ç®åé»è®¤ä¸ä½¿ç¨åä»£åæ¶\n * æå¼g1ä¸­èè´¹å¤§éåå­åè®¡ç®èµæºå»ç»´æ¤çè®°å¿éï¼ä½¿ç¨âè¿æ¥ç©éµâçå¨å±æ°æ®ç»ææ¥è®°å½è·¨regionçå¼ç¨å³ç³»ã\n\n\n# zgc\n\nzgcï¼the z garbage collectorï¼æ¯jdk 11ä¸­æ¨åºçä¸æ¬¾ä½å»¶è¿åå¾åæ¶å¨ï¼å®çè®¾è®¡ç®æ åæ¬ï¼\n\n * åé¡¿æ¶é´ä¸è¶è¿10msï¼\n * åé¡¿æ¶é´ä¸ä¼éçå çå¤§å°ï¼æèæ´»è·å¯¹è±¡çå¤§å°èå¢å ï¼å¯¹ç¨åºååéå½±åå°äº15%ï¼ï¼\n * æ¯æ8mb~4tbçº§å«çå ï¼æªæ¥æ¯æ16tbï¼ã\n\næ è®°å¤å¶ç®æ³çä¸ä¸ªé¶æ®µï¼\n\næ è®°é¶æ®µï¼å³ä»gc rootséåå¼å§ï¼æ è®°æ´»è·å¯¹è±¡ï¼\n\nè½¬ç§»é¶æ®µï¼å³ææ´»è·å¯¹è±¡å¤å¶å°æ°çåå­å°åä¸ï¼\n\néå®ä½é¶æ®µï¼å ä¸ºè½¬ç§»å¯¼è´å¯¹è±¡çå°ååçäºååï¼å¨éå®ä½é¶æ®µï¼æææåå¯¹è±¡æ§å°åçæéé½è¦è°æ´å°å¯¹è±¡æ°çå°åä¸ã\n\né®é¢åæï¼åé¡¿æ¶é´çä¸»è¦ç¶é¢æ¯æ¯æ è®°-å¤å¶ä¸­è½¬ç§»é¶æ®µçstwãæ è®°-å¤å¶ç®æ³åºç¨å¨cmsæ°çä»£ï¼parnewæ¯cmsé»è®¤çæ°çä»£åå¾åæ¶å¨ï¼åg1åå¾åæ¶å¨ä¸­ã\n\nä¸cmsä¸­çparnewåg1ç±»ä¼¼ï¼zgcä¹éç¨æ è®°-å¤å¶ç®æ³ï¼ä¸è¿zgcå¯¹è¯¥ç®æ³åäºéå¤§æ¹è¿ï¼zgcå¨æ è®°ãè½¬ç§»åéå®ä½é¶æ®µå ä¹é½æ¯å¹¶åçï¼è¿æ¯zgcå®ç°åé¡¿æ¶é´å°äº10msç®æ çæå³é®åå ã\n\nzgcåªæä¸ä¸ªstwé¶æ®µï¼åå§æ è®°ï¼åæ è®°ï¼åå§è½¬ç§»ãå¶ä¸­ï¼åå§æ è®°ååå§è½¬ç§»åå«é½åªéè¦æ«ææægc rootsï¼å¶å¤çæ¶é´ågc rootsçæ°éææ­£æ¯ï¼ä¸è¬æåµèæ¶éå¸¸ç­ï¼åæ è®°é¶æ®µstwæ¶é´å¾ç­ï¼æå¤1msï¼è¶è¿1msååæ¬¡è¿å¥å¹¶åæ è®°é¶æ®µãå³ï¼zgcå ä¹æææåé½åªä¾èµäºgc rootséåå¤§å°ï¼åé¡¿æ¶é´ä¸ä¼éçå çå¤§å°æèæ´»è·å¯¹è±¡çå¤§å°èå¢å ãä¸zgcå¯¹æ¯ï¼g1çè½¬ç§»é¶æ®µå®å¨stwçï¼ä¸åé¡¿æ¶é´éå­æ´»å¯¹è±¡çå¤§å°å¢å èå¢å ã\n\n\n\nzgcéè¿çè²æéåè¯»å±éææ¯ï¼è§£å³äºè½¬ç§»è¿ç¨ä¸­åç¡®è®¿é®å¯¹è±¡çé®é¢ï¼å®ç°äºå¹¶åè½¬ç§»ãå¤§è´åçæè¿°å¦ä¸ï¼å¹¶åè½¬ç§»ä¸­âå¹¶åâæå³çgcçº¿ç¨å¨è½¬ç§»å¯¹è±¡çè¿ç¨ä¸­ï¼åºç¨çº¿ç¨ä¹å¨ä¸åå°è®¿é®å¯¹è±¡ãåè®¾å¯¹è±¡åçè½¬ç§»ï¼ä½å¯¹è±¡å°åæªåæ¶æ´æ°ï¼é£ä¹åºç¨çº¿ç¨å¯è½è®¿é®å°æ§å°åï¼ä»èé æéè¯¯ãèå¨zgcä¸­ï¼åºç¨çº¿ç¨è®¿é®å¯¹è±¡å°è§¦åâè¯»å±éâï¼å¦æåç°å¯¹è±¡è¢«ç§»å¨äºï¼é£ä¹âè¯»å±éâä¼æè¯»åºæ¥çæéæ´æ°å°å¯¹è±¡çæ°å°åä¸ï¼è¿æ ·åºç¨çº¿ç¨å§ç»è®¿é®çé½æ¯å¯¹è±¡çæ°å°åãé£ä¹ï¼jvmæ¯å¦ä½å¤æ­å¯¹è±¡è¢«ç§»å¨è¿å¢ï¼å°±æ¯å©ç¨å¯¹è±¡å¼ç¨çå°åï¼å³çè²æéãä¸é¢ä»ç»çè²æéåè¯»å±éææ¯ç»èã\n\n\n# çè²æé\n\nçè²æéæ¯ä¸ç§å°ä¿¡æ¯å­å¨å¨æéä¸­çææ¯ã\n\nzgcå°å¯¹è±¡å­æ´»ä¿¡æ¯å­å¨å¨42~45ä½ä¸­ï¼è¿ä¸ä¼ ç»çåå¾åæ¶å¹¶å°å¯¹è±¡å­æ´»ä¿¡æ¯æ¾å¨å¯¹è±¡å¤´ä¸­å®å¨ä¸åã\n\n\n# è¯»å±é\n\nè¯»å±éæ¯jvmååºç¨ä»£ç æå¥ä¸å°æ®µä»£ç çææ¯ãå½åºç¨çº¿ç¨ä»å ä¸­è¯»åå¯¹è±¡å¼ç¨æ¶ï¼å°±ä¼æ§è¡è¿æ®µä»£ç ãéè¦æ³¨æçæ¯ï¼ä»âä»å ä¸­è¯»åå¯¹è±¡å¼ç¨âæä¼è§¦åè¿æ®µä»£ç ã\n\nzgcä¸­è¯»å±éçä»£ç ä½ç¨ï¼å¨å¯¹è±¡æ è®°åè½¬ç§»è¿ç¨ä¸­ï¼ç¨äºç¡®å®å¯¹è±¡çå¼ç¨å°åæ¯å¦æ»¡è¶³æ¡ä»¶ï¼å¹¶ä½åºç¸åºå¨ä½ã\n\n\nåèï¼\n\n * https://www.pdai.tech/md/java/jvm/java-jvm-gc-zgc.html\n\n\n# ç©ºé´åéæä¿\n\nå¨åç minor gc ä¹åï¼èææºåæ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºæ°çä»£ææå¯¹è±¡æ»ç©ºé´ï¼å¦ææ¡ä»¶æç«çè¯ï¼é£ä¹ minor gc å¯ä»¥ç¡®è®¤æ¯å®å¨çã\n\nå¦æä¸æç«çè¯èææºä¼æ¥ç handlepromotionfailure è®¾ç½®å¼æ¯å¦åè®¸æä¿å¤±è´¥ï¼å¦æåè®¸é£ä¹å°±ä¼ç»§ç»­æ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºåæ¬¡æåå°èå¹´ä»£å¯¹è±¡çå¹³åå¤§å°ï¼å¦æå¤§äºï¼å°å°è¯çè¿è¡ä¸æ¬¡ minor gcï¼å¦æå°äºï¼æè handlepromotionfailure è®¾ç½®ä¸åè®¸åé©ï¼é£ä¹å°±è¦è¿è¡ä¸æ¬¡ full gcã\n\n\n# gc çè§¦åæ¡ä»¶\n\nminor gcï¼å½ eden æ»¡æ¶ï¼è§¦åä¸æ¬¡ minor gcã\n\nfull gcï¼\n\n * è°ç¨ system.gc(); åªæ¯å»ºè®®èææºæ§è¡ full gcï¼ä½æ¯èææºä¸ä¸å®çæ­£å»æ§è¡ãä¸å»ºè®®ä½¿ç¨è¿ç§æ¹å¼ï¼èæ¯è®©èææºç®¡çåå­ã\n * èå¹´ä»£ç©ºé´ä¸è¶³\n * ç©ºé´åéæä¿å¤±è´¥\n * jdk1.7 åä¹åï¼æ°¸ä¹ä»£ç©ºé´ä¸è¶³ã\n * concurrent mode failureï¼æ§è¡ cms gc çè¿ç¨ä¸­åæ¶æå¯¹è±¡è¦æ¾å¥èå¹´ä»£ï¼èæ­¤æ¶èå¹´ä»£ç©ºé´ä¸è¶³(å¯è½æ¯ gc è¿ç¨ä¸­æµ®å¨åå¾è¿å¤å¯¼è´ææ¶æ§çç©ºé´ä¸è¶³)ï¼ä¾¿ä¼æ¥ concurrent mode failure éè¯¯ï¼å¹¶è§¦å full gcã\n\n\n# é»è®¤çåå¾åæ¶å¨\n\n * jdk8 é»è®¤ä½¿ç¨çæ¯ parallel scavenge + parallel oldãä½ä¸è¬ä¸ç¨è¿ä¸ªãå¸¸ç¨parnew+cmså§ï¼å ä¸ºæ¯å¯ä¸æ­éåï¼\n * jdk9~16 é»è®¤g1\n\n\n# å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ\n\n * å¼ç¨è®¡æ°æ³\n\n * * å®ç°ç®åï¼æçé«ï¼ä½æ¯ç®åä¸»æµçèææºä¸­å¹¶æ²¡æéæ©è¿ä¸ªç®æ³æ¥ç®¡çåå­ï¼å¶æä¸»è¦çåå æ¯å®å¾é¾è§£å³å¯¹è±¡ä¹é´ç¸äºå¾ªç¯å¼ç¨çé®é¢ã\n\n * å¯è¾¾æ§åææ³ï¼jvmä½¿ç¨çï¼\n\n * * éè¿ä¸ç³»åçç§°ä¸º âgc rootsâ çå¯¹è±¡ä½ä¸ºèµ·ç¹ï¼ä»è¿äºèç¹å¼å§åä¸æç´¢ï¼èç¹æèµ°è¿çè·¯å¾ç§°ä¸ºå¼ç¨é¾ï¼å½ä¸ä¸ªå¯¹è±¡å° gc roots æ²¡æä»»ä½å¼ç¨é¾ç¸è¿çè¯ï¼åè¯ææ­¤å¯¹è±¡æ¯ä¸å¯ç¨çã\n\n\n# å¯ä»¥ä½ä¸ºgc rootsçå¯¹è±¡\n\n * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¬å°æ¹æ³æ ï¼nativeæ¹æ³ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n * ææè¢«åæ­¥éææçå¯¹è±¡\n\n\n# å¼ç¨\n\njdk1.2 ä¹åï¼java ä¸­å¼ç¨çå®ä¹å¾ä¼ ç»ï¼å¦æ reference ç±»åçæ°æ®å­å¨çæ°å¼ä»£è¡¨çæ¯å¦ä¸ååå­çèµ·å§å°åï¼å°±ç§°è¿ååå­ä»£è¡¨ä¸ä¸ªå¼ç¨ã\n\njdk1.2 ä»¥åï¼java å¯¹å¼ç¨çæ¦å¿µè¿è¡äºæ©åï¼å°å¼ç¨åä¸ºå¼ºå¼ç¨ãè½¯å¼ç¨ãå¼±å¼ç¨ãèå¼ç¨åç§ï¼å¼ç¨å¼ºåº¦éæ¸åå¼±ï¼\n\n * å¼ºå¼ç¨ï¼strongreferenceï¼ï¼åå¾åæ¶å¨ç»ä¸ä¼åæ¶å®\n * è½¯å¼ç¨ï¼softreferenceï¼ï¼å¦æåå­ç©ºé´è¶³å¤ï¼åå¾åæ¶å¨å°±ä¸ä¼åæ¶å®ï¼å¦æåå­ç©ºé´ä¸è¶³äºï¼å°±ä¼åæ¶è¿äºå¯¹è±¡çåå­ã\n * å¼±å¼ç¨ï¼weakreferenceï¼ï¼ä¸ç®¡å½ååå­ç©ºé´è¶³å¤ä¸å¦ï¼é½ä¼åæ¶å®çåå­ã\n * èå¼ç¨ï¼phantomreferenceï¼ï¼å¦æä¸ä¸ªå¯¹è±¡ä»ææèå¼ç¨ï¼é£ä¹å®å°±åæ²¡æä»»ä½å¼ç¨ä¸æ ·ï¼å¨ä»»ä½æ¶åé½å¯è½è¢«åå¾åæ¶ãä¸ºä¸ä¸ªå¯¹è±¡è®¾ç½®èå¼ç¨å³èçå¯ä¸ç®çå°±æ¯è½å¨è¿ä¸ªå¯¹è±¡è¢«åæ¶æ¶æ¶å°ä¸ä¸ªç³»ç»éç¥ã\n\n\n# å¸¸éæ± çä½ç½®\n\njdk1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\njdk1.7 å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ ã\n\njdk1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(metaspace)\n\nåå¦å¨å­ç¬¦ä¸²å¸¸éæ± ä¸­å­å¨å­ç¬¦ä¸² "abc"ï¼å¦æå½åæ²¡æä»»ä½ string å¯¹è±¡å¼ç¨è¯¥å­ç¬¦ä¸²å¸¸éçè¯ï¼å°±è¯´æå¸¸é "abc" å°±æ¯åºå¼å¸¸éï¼å¦æè¿æ¶åçåå­åæ¶çè¯èä¸æå¿è¦çè¯ï¼"abc" å°±ä¼è¢«ç³»ç»æ¸çåºå¸¸éæ± äºã\n\n\n# å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»\n\næ¹æ³åºä¸»è¦åæ¶çæ¯æ ç¨çç±»ï¼é£ä¹å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»çå¢ï¼\n\nå¤å®ä¸ä¸ªå¸¸éæ¯å¦æ¯âåºå¼å¸¸éâæ¯è¾ç®åï¼èè¦å¤å®ä¸ä¸ªç±»æ¯å¦æ¯âæ ç¨çç±»âçæ¡ä»¶åç¸å¯¹èå»è®¸å¤ãç±»éè¦åæ¶æ»¡è¶³ä¸é¢ 3 ä¸ªæ¡ä»¶æè½ç®æ¯ âæ ç¨çç±»â ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ java å ä¸­ä¸å­å¨è¯¥ç±»çä»»ä½å®ä¾ã\n * å è½½è¯¥ç±»ç classloader å·²ç»è¢«åæ¶ã\n * è¯¥ç±»å¯¹åºç java.lang.class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³ã\n\nèææºå¯ä»¥å¯¹æ»¡è¶³ä¸è¿° 3 ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âå¯ä»¥âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ä¸ä½¿ç¨äºå°±ä¼å¿ç¶è¢«åæ¶ã',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼",frontmatter:{title:"Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼",date:"2023-03-19T16:13:20.000Z",permalink:"/pages/8ffeca/"},regularPath:"/01.Java/03.JVM/04.Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%EF%BC%88%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%EF%BC%89.html",relativePath:"01.Java/03.JVM/04.Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼.md",key:"v-4a3cf55d",path:"/pages/8ffeca/",headers:[{level:2,title:"å ",slug:"å ",normalizedTitle:"å ",charIndex:28},{level:3,title:"å° -Xmx å -Xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼",slug:"å°-xmx-å-xms-ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼",normalizedTitle:"å° -xmx å -xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼",charIndex:1174},{level:3,title:"Minor GCãMajor GCãFull GC",slug:"minor-gcãmajor-gcãfull-gc",normalizedTitle:"minor gcãmajor gcãfull gc",charIndex:1429},{level:2,title:"æ¹æ³åº",slug:"æ¹æ³åº",normalizedTitle:"æ¹æ³åº",charIndex:30},{level:3,title:"ç±»åä¿¡æ¯",slug:"ç±»åä¿¡æ¯",normalizedTitle:"ç±»åä¿¡æ¯",charIndex:1905},{level:3,title:"å¯¹äºæ¹æ³åºï¼Java8 ä¹åçååï¼",slug:"å¯¹äºæ¹æ³åº-java8-ä¹åçåå",normalizedTitle:"å¯¹äºæ¹æ³åºï¼java8 ä¹åçååï¼",charIndex:2571},{level:3,title:"æ¹æ³åºçåå¾åæ¶",slug:"æ¹æ³åºçåå¾åæ¶",normalizedTitle:"æ¹æ³åºçåå¾åæ¶",charIndex:2844},{level:2,title:"èææºæ ",slug:"èææºæ ",normalizedTitle:"èææºæ ",charIndex:11},{level:2,title:"æ¬å°æ¹æ³æ ",slug:"æ¬å°æ¹æ³æ ",normalizedTitle:"æ¬å°æ¹æ³æ ",charIndex:16},{level:2,title:"ç¨åºè®¡æ°å¨",slug:"ç¨åºè®¡æ°å¨",normalizedTitle:"ç¨åºè®¡æ°å¨",charIndex:5},{level:2,title:"æ¬å°åå­ï¼åç©ºé´ãç´æ¥åå­ï¼",slug:"æ¬å°åå­-åç©ºé´ãç´æ¥åå­",normalizedTitle:"æ¬å°åå­ï¼åç©ºé´ãç´æ¥åå­ï¼",charIndex:4626},{level:2,title:"è¿è¡æ¶å¸¸éæ± ï¼Runtime Constant Poolï¼",slug:"è¿è¡æ¶å¸¸éæ± -runtime-constant-pool",normalizedTitle:"è¿è¡æ¶å¸¸éæ± ï¼runtime constant poolï¼",charIndex:2009}],headersStr:"å  å° -Xmx å -Xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼ Minor GCãMajor GCãFull GC æ¹æ³åº ç±»åä¿¡æ¯ å¯¹äºæ¹æ³åºï¼Java8 ä¹åçååï¼ æ¹æ³åºçåå¾åæ¶ èææºæ  æ¬å°æ¹æ³æ  ç¨åºè®¡æ°å¨ æ¬å°åå­ï¼åç©ºé´ãç´æ¥åå­ï¼ è¿è¡æ¶å¸¸éæ± ï¼Runtime Constant Poolï¼",content:"çº¿ç¨ç§æï¼ç¨åºè®¡æ°å¨ãèææºæ ãæ¬å°æ¹æ³æ \n\nçº¿ç¨å±äº«ï¼å ãæ¹æ³åºãå å¤åå­ï¼JDK8çåç©ºé´ãä»£ç ç¼å­ï¼\n\næ æ¯è¿è¡æ¶çåä½ï¼èå æ¯å­å¨çåä½ã\n\næ è§£å³ç¨åºçè¿è¡é®é¢ï¼å³ç¨åºå¦ä½æ§è¡ï¼æèè¯´å¦ä½å¤çæ°æ®ãå è§£å³çæ¯æ°æ®å­å¨çé®é¢ï¼å³æ°æ®æä¹æ¾ãæ¾å¨åªã\n\n\n# å \n\n * å¯¹è±¡å®ä¾ä»¥åæ°ç»é½å¨è¿éåéåå­\n\n * æ°çä»£ï¼edenãfrom survivorãto survior 8:1:1\n   \n   * å½ Eden ç©ºé´è¢«å¯¹è±¡å¡«åæ¶ï¼æ§è¡Minor GCï¼å¹¶å°ææå¹¸å­èå¯¹è±¡ç§»å¨å°ä¸ä¸ªå¹¸å­èç©ºé´ä¸­\n\n * èå¹´ä»£ï¼èå¹´ä»£åå¾æ¶éç§°ä¸º Major GCï¼éå¸¸éè¦æ´é¿çæ¶é´ã\n\n * æ°¸ä¹ä»£ï¼JDK 8ç¨åç©ºé´åä»£ï¼ãæ°¸ä¹ä»£ç©çæ¯å çä¸é¨åï¼åæ°çä»£ï¼èå¹´ä»£å°åæ¯è¿ç»­çï¼ååå¾åæ¶å¨ç®¡çï¼ï¼èåç©ºé´å­å¨äºæ¬å°åå­ï¼æä»¬å¸¸è¯´çå å¤åå­ï¼ä¸ååå¾åæ¶å¨ç®¡çï¼ï¼è¿æ ·å°±ä¸å JVM éå¶äºï¼ä¹æ¯è¾é¾åçOOMï¼é½ä¼ææº¢åºå¼å¸¸ï¼ã\n\n * åç©ºé´å­å¨ç±»çåä¿¡æ¯ï¼éæåéåå­ç¬¦ä¸²å¸¸éæ± ç­å¹¶å¥å ä¸­ãç¸å½äºæ°¸ä¹ä»£çæ°æ®è¢«åå°äºå ååç©ºé´ä¸­ã\n\n * åä»£çç®çæ¯ä¼å GC æ§è½ã\n\nå éç½®ï¼\n\n * -Xms: éç½®å çèµ·å§åå­ï¼æå°åå­ï¼ãç­ä»·äº -XX:InitialHeapSizeãé»è®¤æ¯ç©çåå­1/64ã\n * -Xmx: éç½®å çæå¤§åå­ãç­ä»·äº -XX:MaxHeapSizeã\n * é»è®¤æåµä¸æ°çä»£åèå¹´ä»£çæ¯ä¾æ¯ 1:2ï¼å¯ä»¥éè¿ âXX:NewRatio æ¥éç½®\n * æ°çä»£ä¸­ç Eden:From Survivor:To Survivor çæ¯ä¾æ¯ 8:1:1ï¼å¯ä»¥éè¿ -XX:SurvivorRatio æ¥éç½®\n * è¥å¨ JDK 7 ä¸­å¼å¯äº -XX:+UseAdaptiveSizePolicyï¼JVM ä¼å¨æè°æ´ JVM å ä¸­åä¸ªåºåçå¤§å°ä»¥åè¿å¥èå¹´ä»£çå¹´é¾ï¼æ­¤æ¶ âXX:NewRatio å -XX:SurvivorRatio å°ä¼å¤±æï¼è JDK 8 æ¯é»è®¤å¼å¯-XX:+UseAdaptiveSizePolicyï¼å¨ JDK 8ä¸­ï¼ä¸è¦éæå³é­-XX:+UseAdaptiveSizePolicyï¼é¤éå¯¹å åå­çååææç¡®çè§åã\n * å¯¹è±¡å¹´è½»è®¡æ°å¨ï¼-XX:MaxTenuringThresholdï¼\n * å¦æåéçå¯¹è±¡è¶è¿äº-XX:PetenureSizeThresholdï¼å¯¹è±¡ä¼ç´æ¥è¢«åéå°èå¹´ä»£\n * Java7 ä¸­æä»¬éè¿-XX:PermSize å -xx:MaxPermSize æ¥è®¾ç½®æ°¸ä¹ä»£åæ°ï¼Java8 ä¹åï¼éçæ°¸ä¹ä»£çåæ¶ï¼è¿äºåæ°ä¹å°±éä¹å¤±æäºï¼æ¹ä¸ºéè¿-XX:MetaspaceSize å -XX:MaxMetaspaceSize ç¨æ¥è®¾ç½®åç©ºé´åæ°\n\n\n# å° -Xmx å -Xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼\n\nå¦ï¼å¸¸è§çJVMåæ°ä½¿ç¨\n\njava -Xms512m -Xmx1g\n\n\nå¨è¿ç§éç½®ä¸ï¼JVMå¯å¨æ¶ä¼åé512Mçå åå­ç©ºé´ï¼éçç¨åºçæ§è¡ï¼æéçå ç©ºé´è¶æ¥è¶å¤§ï¼åä¼éæ¸å¢å¤§å åå­ç©ºé´ï¼ç´å°Xmxåæ°æå®çå æå¤§ç©ºé´1Gãå½å åå­ä½¿ç¨çéä½ï¼åä¼éæ¸åå°è¯¥åå­åºåçå¤§å°ã\n\næä»¬éå¸¸ä¼å° -Xmx å -Xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼ï¼ä¸ºäºé¿åç±äºheapåå­æ©å¤§æç¼©å°å¯¼è´åºç¨åé¡¿ï¼éä½å»¶è¿ï¼åæ¶é¿åæ¯æ¬¡åå¾åæ¶å®æåJVMéæ°åéåå­ã\n\n\n# Minor GCãMajor GCãFull GC\n\néå¯¹ HotSpot VM çå®ç°ï¼å®éé¢ç GC æç§åæ¶åºåååä¸ºä¸¤å¤§ç±»ï¼é¨åæ¶éï¼Partial GCï¼ï¼æ´å æ¶éï¼Full GCï¼\n\n * é¨åæ¶éï¼ä¸æ¯å®æ´æ¶éæ´ä¸ª Java å çåå¾æ¶éãå¶ä¸­ååä¸ºï¼\n   * æ°çä»£æ¶éï¼Minor GC/Young GCï¼ï¼åªæ¯æ°çä»£çåå¾æ¶é\n   * èå¹´ä»£æ¶éï¼Major GC/Old GCï¼ï¼åªæ¯èå¹´ä»£çåå¾æ¶é\n     * ç®åï¼åªæ CMS GC ä¼æåç¬æ¶éèå¹´ä»£çè¡ä¸º\n     * å¾å¤æ¶å Major GC ä¼å Full GC æ··åä½¿ç¨ï¼éè¦å·ä½åè¾¨æ¯èå¹´ä»£åæ¶è¿æ¯æ´å åæ¶\n   * æ··åæ¶éï¼Mixed GCï¼ï¼æ¶éæ´ä¸ªæ°çä»£ä»¥åé¨åèå¹´ä»£çåå¾æ¶é\n     * ç®ååªæ G1 GC ä¼æè¿ç§è¡ä¸º\n * æ´å æ¶éï¼Full GCï¼ï¼æ¶éæ´ä¸ª Java å åæ¹æ³åºçåå¾\n\n\n# æ¹æ³åº\n\nä¹ç§°ä¸ºéå  non-heap\n\næ¹æ³åºçå®ç°JDK7ç¨æ°¸ä¹ä»£ï¼JDK8æ¹ç¨æ¬å°åå­çåç©ºé´ã\n\næ¹æ³åºç¨äºå­å¨å·²è¢«èææºå è½½çç±»åä¿¡æ¯ãå¸¸éãéæåéãå³æ¶ç¼è¯å¨ç¼è¯åçä»£ç ç¼å­ç­æ°æ®ã\n\nè½ç¶ Java èææºè§èææ¹æ³åºæè¿°ä¸ºå çä¸ä¸ªé»è¾é¨åï¼ä½æ¯å®å´æä¸ä¸ªå«åå« Non-Heapï¼éå ï¼ï¼ç®çåºè¯¥æ¯ä¸ Java å åºåå¼ã\n\nè¿è¡æ¶å¸¸éæ± ï¼Runtime Constant Poolï¼æ¯æ¹æ³åºçä¸é¨åãClass æä»¶ä¸­é¤äºæç±»ççæ¬/å­æ®µ/æ¹æ³/æ¥å£ç­æè¿°ä¿¡æ¯å¤ï¼è¿æä¸é¡¹ä¿¡æ¯æ¯å¸¸éæ± ï¼Constant Pool Tableï¼ï¼ç¨äºå­æ¾ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼è¿é¨ååå®¹å°ç±»å¨å è½½åè¿å¥æ¹æ³åºçè¿è¡æ¶å¸¸éæ± ä¸­å­æ¾ãè¿è¡æé´ä¹å¯è½å°æ°çå¸¸éæ¾å¥æ± ä¸­ï¼è¿ç§ç¹æ§è¢«å¼åäººåå©ç¨å¾æ¯è¾å¤çæ¯ String.intern()æ¹æ³ãåæ¹æ³åºåå­çéå¶ï¼å½å¸¸éæ± æ æ³åç³è¯·å°åå­æ¶ä¼æåº OutOfMemoryError å¼å¸¸ã\n\næ¹æ³åºçå¤§å°åå ç©ºé´ä¸æ ·ï¼å¯ä»¥éæ©åºå®å¤§å°ä¹å¯éæ©å¯æ©å±ï¼æ¹æ³åºçå¤§å°å³å®äºç³»ç»å¯ä»¥æ¾å¤å°ä¸ªç±»ï¼å¦æç³»ç»ç±»å¤ªå¤ï¼å¯¼è´æ¹æ³åºæº¢åºï¼èææºåæ ·ä¼æåºåå­æº¢åºéè¯¯ã\n\n\n# ç±»åä¿¡æ¯\n\nå¯¹æ¯ä¸ªå è½½çç±»åï¼ç±» classãæ¥å£ interfaceãæä¸¾ enumãæ³¨è§£ annotationï¼ï¼JVM å¿é¡»å¨æ¹æ³åºä¸­å­å¨ä»¥ä¸ç±»åä¿¡æ¯\n\n * è¿ä¸ªç±»åçå®æ´ææåç§°ï¼å¨å=åå.ç±»åï¼\n * è¿ä¸ªç±»åç´æ¥ç¶ç±»çå®æ´ææåï¼å¯¹äº interfaceææ¯ java.lang.Objectï¼é½æ²¡æç¶ç±»ï¼\n * è¿ä¸ªç±»åçä¿®é¥°ç¬¦ï¼publicï¼abstractï¼final çæä¸ªå­éï¼\n * è¿ä¸ªç±»åç´æ¥æ¥å£çä¸ä¸ªæåºåè¡¨\n\n\n# å¯¹äºæ¹æ³åºï¼Java8 ä¹åçååï¼\n\n * ç§»é¤äºæ°¸ä¹ä»£ï¼PermGenï¼ï¼æ¿æ¢ä¸ºåç©ºé´ï¼Metaspaceï¼ï¼\n * æ°¸ä¹ä»£ä¸­ç class metadata è½¬ç§»å°äº native memoryï¼æ¬å°åå­ï¼èä¸æ¯èææºï¼ï¼\n * æ°¸ä¹ä»£ä¸­ç interned Strings ï¼å­ç¬¦ä¸²å¸¸éæ± ï¼å class static variables ï¼éæåéï¼è½¬ç§»å°äº Java heapï¼\n * æ°¸ä¹ä»£åæ° ï¼PermSize MaxPermSizeï¼ -> åç©ºé´åæ°ï¼MetaspaceSize MaxMetaspaceSizeï¼\n\n\n# æ¹æ³åºçåå¾åæ¶\n\næ¹æ³åºçåå¾æ¶éä¸»è¦åæ¶ä¸¤é¨ååå®¹ï¼å¸¸éæ± ä¸­åºå¼çå¸¸éåä¸åä½¿ç¨çç±»åã\n\nåæ¥è¯´è¯´æ¹æ³åºåå¸¸éæ± ä¹ä¸­ä¸»è¦å­æ¾çä¸¤å¤§ç±»å¸¸éï¼å­é¢éåç¬¦å·å¼ç¨ãå­é¢éæ¯è¾æ¥è¿ Java è¯­è¨å±æ¬¡çå¸¸éæ¦å¿µï¼å¦ææ¬å­ç¬¦ä¸²ãè¢«å£°æä¸º final çå¸¸éå¼ç­ãèç¬¦å·å¼ç¨åå±äºç¼è¯åçæ¹é¢çæ¦å¿µï¼åæ¬ä¸é¢ä¸ç±»å¸¸éï¼\n\n * ç±»åæ¥å£çå¨éå®å\n * å­æ®µçåç§°åæè¿°ç¬¦\n * æ¹æ³çåç§°åæè¿°ç¬¦\n\nHotSpot èææºå¯¹å¸¸éæ± çåæ¶ç­ç¥æ¯å¾æç¡®çï¼åªè¦å¸¸éæ± ä¸­çå¸¸éæ²¡æè¢«ä»»ä½å°æ¹å¼ç¨ï¼å°±å¯ä»¥è¢«åæ¶\n\nå¤å®ä¸ä¸ªç±»åæ¯å¦å±äºâä¸åè¢«ä½¿ç¨çç±»âï¼éè¦åæ¶æ»¡è¶³ä¸ä¸ªæ¡ä»¶ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ Java å ä¸­ä¸å­å¨è¯¥ç±»åå¶ä»»ä½æ´¾çå­ç±»çå®ä¾\n * å è½½è¯¥ç±»çç±»å è½½å¨å·²ç»è¢«åæ¶ï¼è¿ä¸ªæ¡ä»¶é¤éæ¯ç»è¿ç²¾å¿è®¾è®¡çå¯æ¿æ¢ç±»å è½½å¨çåºæ¯ï¼å¦ OSGiãJSP çéå è½½ç­ï¼å¦åéå¸¸å¾é¾è¾¾æ\n * è¯¥ç±»å¯¹åºç java.lang.Class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³\n\nJava èææºè¢«åè®¸å æ»¡è¶³ä¸è¿°ä¸ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âè¢«åè®¸âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ï¼ä¸ä½¿ç¨äºå°±å¿ç¶ä¼åæ¶ãæ¯å¦å¯¹ç±»è¿è¡åæ¶ï¼HotSpot èææºæä¾äº -Xnoclassgc åæ°è¿è¡æ§å¶ï¼è¿å¯ä»¥ä½¿ç¨ -verbose:class ä»¥å -XX:+TraceClassLoading ã-XX:+TraceClassUnLoading æ¥çç±»å è½½åå¸è½½ä¿¡æ¯ã\n\nå¨å¤§éä½¿ç¨åå°ãå¨æä»£çãCGLib ç­ ByteCode æ¡æ¶ãå¨æçæ JSP ä»¥å OSGi è¿ç±»é¢ç¹èªå®ä¹ ClassLoader çåºæ¯é½éè¦èææºå·å¤ç±»å¸è½½çåè½ï¼ä»¥ä¿è¯æ°¸ä¹ä»£ä¸ä¼æº¢åºã\n\n\n# èææºæ \n\n * æ¯ä¸ªæ¹æ³è¢«æ§è¡æ¶ï¼é½ä¼åå»ºä¸ä¸ªæ å¸§ï¼Stack Frameï¼ç¨äºå­å¨å±é¨åéè¡¨ãæä½æ°æ ãå¨æè¿æ¥ãæ¹æ³åºå£ç­ä¿¡æ¯ã\n * å¨ä¸æ¡æ´»å¨çº¿ç¨ä¸­ï¼ä¸ä¸ªæ¶é´ç¹ä¸ï¼åªä¼æä¸ä¸ªæ´»å¨çæ å¸§ãå³åªæå½åæ­£å¨æ§è¡çæ¹æ³çæ å¸§ï¼æ é¡¶æ å¸§ï¼æ¯ææçï¼è¿ä¸ªæ å¸§è¢«ç§°ä¸ºå½åæ å¸§ï¼Current Frameï¼ï¼ä¸å½åæ å¸§å¯¹åºçæ¹æ³å°±æ¯å½åæ¹æ³ï¼Current Methodï¼ï¼å®ä¹è¿ä¸ªæ¹æ³çç±»å°±æ¯å½åç±»ï¼Current Classï¼ã\n * æ§è¡å¼æè¿è¡çææå­èç æä»¤åªéå¯¹å½åæ å¸§è¿è¡æä½ã\n * ä¸åçº¿ç¨ä¸­æåå«çæ å¸§æ¯ä¸åè®¸å­å¨ç¸äºå¼ç¨çï¼å³ä¸å¯è½å¨ä¸ä¸ªæ å¸§ä¸­å¼ç¨å¦å¤ä¸ä¸ªçº¿ç¨çæ å¸§ã\n * Java æ¹æ³æä¸¤ç§è¿åå½æ°çæ¹å¼ï¼ä¸ç§æ¯æ­£å¸¸çå½æ°è¿åï¼ä½¿ç¨ return æä»¤ï¼å¦ä¸ç§æ¯æåºå¼å¸¸ï¼ä¸ç®¡ç¨åªç§æ¹å¼ï¼é½ä¼å¯¼è´æ å¸§è¢«å¼¹åºã\n * æ ä¸å­å¨åå¾åæ¶é®é¢\n\n\n\næ ä¸­å¯è½åºç°çå¼å¸¸ï¼\n\nJava èææºè§èåè®¸ Javaèææºæ çå¤§å°æ¯å¨æçæèæ¯åºå®ä¸åç\n\n * å¦æéç¨åºå®å¤§å°ç Java èææºæ ï¼é£æ¯ä¸ªçº¿ç¨ç Java èææºæ å®¹éå¯ä»¥å¨çº¿ç¨åå»ºçæ¶åç¬ç«éå®ãå¦æçº¿ç¨è¯·æ±åéçæ å®¹éè¶è¿ Java èææºæ åè®¸çæå¤§å®¹éï¼Java èææºå°ä¼æåºä¸ä¸ª StackOverflowError å¼å¸¸\n * å¦æ Java èææºæ å¯ä»¥å¨ææ©å±ï¼å¹¶ä¸å¨å°è¯æ©å±çæ¶åæ æ³ç³è¯·å°è¶³å¤çåå­ï¼æèå¨åå»ºæ°ççº¿ç¨æ¶æ²¡æè¶³å¤çåå­å»åå»ºå¯¹åºçèææºæ ï¼é£ Java èææºå°ä¼æåºä¸ä¸ªOutOfMemoryErrorå¼å¸¸\n\nå¯ä»¥éè¿åæ°-Xssæ¥è®¾ç½®çº¿ç¨çæå¤§æ ç©ºé´ï¼æ çå¤§å°ç´æ¥å³å®äºå½æ°è°ç¨çæå¤§å¯è¾¾æ·±åº¦ã\n\n\n# æ¬å°æ¹æ³æ \n\n * ä¸èææºæ ç¸ä¼¼ï¼åªæ¯æå¡çæ¯native æ¹æ³ã\n * Unsafe ç±»å°±æå¾å¤æ¬å°æ¹æ³ã\n\n\n# ç¨åºè®¡æ°å¨\n\n * è®°å½å½åçº¿ç¨ææ§è¡çå­èç çè¡å·ãJVM ä¸­ç PC å¯å­å¨æ¯å¯¹ç©ç PC å¯å­å¨çä¸ç§æ½è±¡æ¨¡æã\n\n * å ä¸ºCPUéè¦ä¸åçåæ¢åä¸ªçº¿ç¨ï¼è¿æ¶ååæ¢åæ¥ä»¥åï¼å°±å¾ç¥éæ¥çä»åªå¼å§ç»§ç»­æ§è¡ãJVMçå­èç è§£éå¨å°±éè¦éè¿æ¹åPCå¯å­å¨çå¼æ¥æç¡®ä¸ä¸æ¡åºè¯¥æ§è¡ä»ä¹æ ·çå­èç æä»¤ã\n\n * å®æ¯ç¨åºæ§å¶æµçæç¤ºå¨ï¼åæ¯ãå¾ªç¯ãè·³è½¬ãå¼å¸¸å¤çãçº¿ç¨æ¢å¤ç­åºç¡åè½é½éè¦ä¾èµè¿ä¸ªè®¡æ°å¨æ¥å®æã\n\n * å®æ¯å¯ä¸ä¸ä¸ªå¨ JVM è§èä¸­æ²¡æè§å®ä»»ä½ OutOfMemoryError æåµçåºå\n\n\n# æ¬å°åå­ï¼åç©ºé´ãç´æ¥åå­ï¼\n\n * å¦NIOï¼åéå å¤åå­ï¼é¿åäºå¨ Java å å Native å ä¹é´æ¥åå¤å¶æ°æ®ï¼å¯æé«æ§è½ã\n\n\n# è¿è¡æ¶å¸¸éæ± ï¼Runtime Constant Poolï¼\n\nè¿è¡æ¶å¸¸éæ± ï¼Runtime Constant Poolï¼æ¯æ¹æ³åºçä¸é¨åã\n\nçè§£è¿è¡æ¶å¸¸éæ± ï¼\n\nå­èç æä»¶ï¼Class æä»¶ï¼ä¸­çåå«ä¸é¡¹ä¿¡æ¯å¸¸éæ±  Constant Poolï¼å®å¯ä»¥çä½æ¯ä¸å¼ è¡¨ï¼èææºæä»¤æ ¹æ®è¿å¼ å¸¸éè¡¨æ¾å°è¦æ§è¡çç±»åãæ¹æ³åãåæ°ç±»åãå­é¢éç­ç±»åã\n\nå¸¸éæ± è¡¨ï¼Constant Pool Tableï¼æ¯ Class æä»¶çä¸é¨åï¼ç¨äºå­å¨ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼è¿é¨ååå®¹å°å¨ç±»å è½½åå­æ¾å°æ¹æ³åºçè¿è¡æ¶å¸¸éæ± ä¸­ã\n\nJDK1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\nJDK1.7å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ã\n\nJDK1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(Metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(Metaspace)ã\n\nå¼ç³çé®é¢ï¼\n\nä¸ºä»ä¹è¦æ¹æ°¸ä¹ä»£ä¸ºåç©ºé´å»å®ç°æ¹æ³åºï¼\n\nå ä¸ºç¨æ°¸ä¹ä»£å®ç°å¯¼è´Javaåºç¨æ´å®¹æäº§çåå­æº¢åºé®é¢ãèæ¹ç¨æ¬å°åå­å®ç°çåç©ºé´åæ¯è¾å¥½ã",normalizedContent:"çº¿ç¨ç§æï¼ç¨åºè®¡æ°å¨ãèææºæ ãæ¬å°æ¹æ³æ \n\nçº¿ç¨å±äº«ï¼å ãæ¹æ³åºãå å¤åå­ï¼jdk8çåç©ºé´ãä»£ç ç¼å­ï¼\n\næ æ¯è¿è¡æ¶çåä½ï¼èå æ¯å­å¨çåä½ã\n\næ è§£å³ç¨åºçè¿è¡é®é¢ï¼å³ç¨åºå¦ä½æ§è¡ï¼æèè¯´å¦ä½å¤çæ°æ®ãå è§£å³çæ¯æ°æ®å­å¨çé®é¢ï¼å³æ°æ®æä¹æ¾ãæ¾å¨åªã\n\n\n# å \n\n * å¯¹è±¡å®ä¾ä»¥åæ°ç»é½å¨è¿éåéåå­\n\n * æ°çä»£ï¼edenãfrom survivorãto survior 8:1:1\n   \n   * å½ eden ç©ºé´è¢«å¯¹è±¡å¡«åæ¶ï¼æ§è¡minor gcï¼å¹¶å°ææå¹¸å­èå¯¹è±¡ç§»å¨å°ä¸ä¸ªå¹¸å­èç©ºé´ä¸­\n\n * èå¹´ä»£ï¼èå¹´ä»£åå¾æ¶éç§°ä¸º major gcï¼éå¸¸éè¦æ´é¿çæ¶é´ã\n\n * æ°¸ä¹ä»£ï¼jdk 8ç¨åç©ºé´åä»£ï¼ãæ°¸ä¹ä»£ç©çæ¯å çä¸é¨åï¼åæ°çä»£ï¼èå¹´ä»£å°åæ¯è¿ç»­çï¼ååå¾åæ¶å¨ç®¡çï¼ï¼èåç©ºé´å­å¨äºæ¬å°åå­ï¼æä»¬å¸¸è¯´çå å¤åå­ï¼ä¸ååå¾åæ¶å¨ç®¡çï¼ï¼è¿æ ·å°±ä¸å jvm éå¶äºï¼ä¹æ¯è¾é¾åçoomï¼é½ä¼ææº¢åºå¼å¸¸ï¼ã\n\n * åç©ºé´å­å¨ç±»çåä¿¡æ¯ï¼éæåéåå­ç¬¦ä¸²å¸¸éæ± ç­å¹¶å¥å ä¸­ãç¸å½äºæ°¸ä¹ä»£çæ°æ®è¢«åå°äºå ååç©ºé´ä¸­ã\n\n * åä»£çç®çæ¯ä¼å gc æ§è½ã\n\nå éç½®ï¼\n\n * -xms: éç½®å çèµ·å§åå­ï¼æå°åå­ï¼ãç­ä»·äº -xx:initialheapsizeãé»è®¤æ¯ç©çåå­1/64ã\n * -xmx: éç½®å çæå¤§åå­ãç­ä»·äº -xx:maxheapsizeã\n * é»è®¤æåµä¸æ°çä»£åèå¹´ä»£çæ¯ä¾æ¯ 1:2ï¼å¯ä»¥éè¿ âxx:newratio æ¥éç½®\n * æ°çä»£ä¸­ç eden:from survivor:to survivor çæ¯ä¾æ¯ 8:1:1ï¼å¯ä»¥éè¿ -xx:survivorratio æ¥éç½®\n * è¥å¨ jdk 7 ä¸­å¼å¯äº -xx:+useadaptivesizepolicyï¼jvm ä¼å¨æè°æ´ jvm å ä¸­åä¸ªåºåçå¤§å°ä»¥åè¿å¥èå¹´ä»£çå¹´é¾ï¼æ­¤æ¶ âxx:newratio å -xx:survivorratio å°ä¼å¤±æï¼è jdk 8 æ¯é»è®¤å¼å¯-xx:+useadaptivesizepolicyï¼å¨ jdk 8ä¸­ï¼ä¸è¦éæå³é­-xx:+useadaptivesizepolicyï¼é¤éå¯¹å åå­çååææç¡®çè§åã\n * å¯¹è±¡å¹´è½»è®¡æ°å¨ï¼-xx:maxtenuringthresholdï¼\n * å¦æåéçå¯¹è±¡è¶è¿äº-xx:petenuresizethresholdï¼å¯¹è±¡ä¼ç´æ¥è¢«åéå°èå¹´ä»£\n * java7 ä¸­æä»¬éè¿-xx:permsize å -xx:maxpermsize æ¥è®¾ç½®æ°¸ä¹ä»£åæ°ï¼java8 ä¹åï¼éçæ°¸ä¹ä»£çåæ¶ï¼è¿äºåæ°ä¹å°±éä¹å¤±æäºï¼æ¹ä¸ºéè¿-xx:metaspacesize å -xx:maxmetaspacesize ç¨æ¥è®¾ç½®åç©ºé´åæ°\n\n\n# å° -xmx å -xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼\n\nå¦ï¼å¸¸è§çjvmåæ°ä½¿ç¨\n\njava -xms512m -xmx1g\n\n\nå¨è¿ç§éç½®ä¸ï¼jvmå¯å¨æ¶ä¼åé512mçå åå­ç©ºé´ï¼éçç¨åºçæ§è¡ï¼æéçå ç©ºé´è¶æ¥è¶å¤§ï¼åä¼éæ¸å¢å¤§å åå­ç©ºé´ï¼ç´å°xmxåæ°æå®çå æå¤§ç©ºé´1gãå½å åå­ä½¿ç¨çéä½ï¼åä¼éæ¸åå°è¯¥åå­åºåçå¤§å°ã\n\næä»¬éå¸¸ä¼å° -xmx å -xms ä¸¤ä¸ªåæ°éç½®ä¸ºç¸åçå¼ï¼ä¸ºäºé¿åç±äºheapåå­æ©å¤§æç¼©å°å¯¼è´åºç¨åé¡¿ï¼éä½å»¶è¿ï¼åæ¶é¿åæ¯æ¬¡åå¾åæ¶å®æåjvméæ°åéåå­ã\n\n\n# minor gcãmajor gcãfull gc\n\néå¯¹ hotspot vm çå®ç°ï¼å®éé¢ç gc æç§åæ¶åºåååä¸ºä¸¤å¤§ç±»ï¼é¨åæ¶éï¼partial gcï¼ï¼æ´å æ¶éï¼full gcï¼\n\n * é¨åæ¶éï¼ä¸æ¯å®æ´æ¶éæ´ä¸ª java å çåå¾æ¶éãå¶ä¸­ååä¸ºï¼\n   * æ°çä»£æ¶éï¼minor gc/young gcï¼ï¼åªæ¯æ°çä»£çåå¾æ¶é\n   * èå¹´ä»£æ¶éï¼major gc/old gcï¼ï¼åªæ¯èå¹´ä»£çåå¾æ¶é\n     * ç®åï¼åªæ cms gc ä¼æåç¬æ¶éèå¹´ä»£çè¡ä¸º\n     * å¾å¤æ¶å major gc ä¼å full gc æ··åä½¿ç¨ï¼éè¦å·ä½åè¾¨æ¯èå¹´ä»£åæ¶è¿æ¯æ´å åæ¶\n   * æ··åæ¶éï¼mixed gcï¼ï¼æ¶éæ´ä¸ªæ°çä»£ä»¥åé¨åèå¹´ä»£çåå¾æ¶é\n     * ç®ååªæ g1 gc ä¼æè¿ç§è¡ä¸º\n * æ´å æ¶éï¼full gcï¼ï¼æ¶éæ´ä¸ª java å åæ¹æ³åºçåå¾\n\n\n# æ¹æ³åº\n\nä¹ç§°ä¸ºéå  non-heap\n\næ¹æ³åºçå®ç°jdk7ç¨æ°¸ä¹ä»£ï¼jdk8æ¹ç¨æ¬å°åå­çåç©ºé´ã\n\næ¹æ³åºç¨äºå­å¨å·²è¢«èææºå è½½çç±»åä¿¡æ¯ãå¸¸éãéæåéãå³æ¶ç¼è¯å¨ç¼è¯åçä»£ç ç¼å­ç­æ°æ®ã\n\nè½ç¶ java èææºè§èææ¹æ³åºæè¿°ä¸ºå çä¸ä¸ªé»è¾é¨åï¼ä½æ¯å®å´æä¸ä¸ªå«åå« non-heapï¼éå ï¼ï¼ç®çåºè¯¥æ¯ä¸ java å åºåå¼ã\n\nè¿è¡æ¶å¸¸éæ± ï¼runtime constant poolï¼æ¯æ¹æ³åºçä¸é¨åãclass æä»¶ä¸­é¤äºæç±»ççæ¬/å­æ®µ/æ¹æ³/æ¥å£ç­æè¿°ä¿¡æ¯å¤ï¼è¿æä¸é¡¹ä¿¡æ¯æ¯å¸¸éæ± ï¼constant pool tableï¼ï¼ç¨äºå­æ¾ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼è¿é¨ååå®¹å°ç±»å¨å è½½åè¿å¥æ¹æ³åºçè¿è¡æ¶å¸¸éæ± ä¸­å­æ¾ãè¿è¡æé´ä¹å¯è½å°æ°çå¸¸éæ¾å¥æ± ä¸­ï¼è¿ç§ç¹æ§è¢«å¼åäººåå©ç¨å¾æ¯è¾å¤çæ¯ string.intern()æ¹æ³ãåæ¹æ³åºåå­çéå¶ï¼å½å¸¸éæ± æ æ³åç³è¯·å°åå­æ¶ä¼æåº outofmemoryerror å¼å¸¸ã\n\næ¹æ³åºçå¤§å°åå ç©ºé´ä¸æ ·ï¼å¯ä»¥éæ©åºå®å¤§å°ä¹å¯éæ©å¯æ©å±ï¼æ¹æ³åºçå¤§å°å³å®äºç³»ç»å¯ä»¥æ¾å¤å°ä¸ªç±»ï¼å¦æç³»ç»ç±»å¤ªå¤ï¼å¯¼è´æ¹æ³åºæº¢åºï¼èææºåæ ·ä¼æåºåå­æº¢åºéè¯¯ã\n\n\n# ç±»åä¿¡æ¯\n\nå¯¹æ¯ä¸ªå è½½çç±»åï¼ç±» classãæ¥å£ interfaceãæä¸¾ enumãæ³¨è§£ annotationï¼ï¼jvm å¿é¡»å¨æ¹æ³åºä¸­å­å¨ä»¥ä¸ç±»åä¿¡æ¯\n\n * è¿ä¸ªç±»åçå®æ´ææåç§°ï¼å¨å=åå.ç±»åï¼\n * è¿ä¸ªç±»åç´æ¥ç¶ç±»çå®æ´ææåï¼å¯¹äº interfaceææ¯ java.lang.objectï¼é½æ²¡æç¶ç±»ï¼\n * è¿ä¸ªç±»åçä¿®é¥°ç¬¦ï¼publicï¼abstractï¼final çæä¸ªå­éï¼\n * è¿ä¸ªç±»åç´æ¥æ¥å£çä¸ä¸ªæåºåè¡¨\n\n\n# å¯¹äºæ¹æ³åºï¼java8 ä¹åçååï¼\n\n * ç§»é¤äºæ°¸ä¹ä»£ï¼permgenï¼ï¼æ¿æ¢ä¸ºåç©ºé´ï¼metaspaceï¼ï¼\n * æ°¸ä¹ä»£ä¸­ç class metadata è½¬ç§»å°äº native memoryï¼æ¬å°åå­ï¼èä¸æ¯èææºï¼ï¼\n * æ°¸ä¹ä»£ä¸­ç interned strings ï¼å­ç¬¦ä¸²å¸¸éæ± ï¼å class static variables ï¼éæåéï¼è½¬ç§»å°äº java heapï¼\n * æ°¸ä¹ä»£åæ° ï¼permsize maxpermsizeï¼ -> åç©ºé´åæ°ï¼metaspacesize maxmetaspacesizeï¼\n\n\n# æ¹æ³åºçåå¾åæ¶\n\næ¹æ³åºçåå¾æ¶éä¸»è¦åæ¶ä¸¤é¨ååå®¹ï¼å¸¸éæ± ä¸­åºå¼çå¸¸éåä¸åä½¿ç¨çç±»åã\n\nåæ¥è¯´è¯´æ¹æ³åºåå¸¸éæ± ä¹ä¸­ä¸»è¦å­æ¾çä¸¤å¤§ç±»å¸¸éï¼å­é¢éåç¬¦å·å¼ç¨ãå­é¢éæ¯è¾æ¥è¿ java è¯­è¨å±æ¬¡çå¸¸éæ¦å¿µï¼å¦ææ¬å­ç¬¦ä¸²ãè¢«å£°æä¸º final çå¸¸éå¼ç­ãèç¬¦å·å¼ç¨åå±äºç¼è¯åçæ¹é¢çæ¦å¿µï¼åæ¬ä¸é¢ä¸ç±»å¸¸éï¼\n\n * ç±»åæ¥å£çå¨éå®å\n * å­æ®µçåç§°åæè¿°ç¬¦\n * æ¹æ³çåç§°åæè¿°ç¬¦\n\nhotspot èææºå¯¹å¸¸éæ± çåæ¶ç­ç¥æ¯å¾æç¡®çï¼åªè¦å¸¸éæ± ä¸­çå¸¸éæ²¡æè¢«ä»»ä½å°æ¹å¼ç¨ï¼å°±å¯ä»¥è¢«åæ¶\n\nå¤å®ä¸ä¸ªç±»åæ¯å¦å±äºâä¸åè¢«ä½¿ç¨çç±»âï¼éè¦åæ¶æ»¡è¶³ä¸ä¸ªæ¡ä»¶ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ java å ä¸­ä¸å­å¨è¯¥ç±»åå¶ä»»ä½æ´¾çå­ç±»çå®ä¾\n * å è½½è¯¥ç±»çç±»å è½½å¨å·²ç»è¢«åæ¶ï¼è¿ä¸ªæ¡ä»¶é¤éæ¯ç»è¿ç²¾å¿è®¾è®¡çå¯æ¿æ¢ç±»å è½½å¨çåºæ¯ï¼å¦ osgiãjsp çéå è½½ç­ï¼å¦åéå¸¸å¾é¾è¾¾æ\n * è¯¥ç±»å¯¹åºç java.lang.class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³\n\njava èææºè¢«åè®¸å æ»¡è¶³ä¸è¿°ä¸ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âè¢«åè®¸âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ï¼ä¸ä½¿ç¨äºå°±å¿ç¶ä¼åæ¶ãæ¯å¦å¯¹ç±»è¿è¡åæ¶ï¼hotspot èææºæä¾äº -xnoclassgc åæ°è¿è¡æ§å¶ï¼è¿å¯ä»¥ä½¿ç¨ -verbose:class ä»¥å -xx:+traceclassloading ã-xx:+traceclassunloading æ¥çç±»å è½½åå¸è½½ä¿¡æ¯ã\n\nå¨å¤§éä½¿ç¨åå°ãå¨æä»£çãcglib ç­ bytecode æ¡æ¶ãå¨æçæ jsp ä»¥å osgi è¿ç±»é¢ç¹èªå®ä¹ classloader çåºæ¯é½éè¦èææºå·å¤ç±»å¸è½½çåè½ï¼ä»¥ä¿è¯æ°¸ä¹ä»£ä¸ä¼æº¢åºã\n\n\n# èææºæ \n\n * æ¯ä¸ªæ¹æ³è¢«æ§è¡æ¶ï¼é½ä¼åå»ºä¸ä¸ªæ å¸§ï¼stack frameï¼ç¨äºå­å¨å±é¨åéè¡¨ãæä½æ°æ ãå¨æè¿æ¥ãæ¹æ³åºå£ç­ä¿¡æ¯ã\n * å¨ä¸æ¡æ´»å¨çº¿ç¨ä¸­ï¼ä¸ä¸ªæ¶é´ç¹ä¸ï¼åªä¼æä¸ä¸ªæ´»å¨çæ å¸§ãå³åªæå½åæ­£å¨æ§è¡çæ¹æ³çæ å¸§ï¼æ é¡¶æ å¸§ï¼æ¯ææçï¼è¿ä¸ªæ å¸§è¢«ç§°ä¸ºå½åæ å¸§ï¼current frameï¼ï¼ä¸å½åæ å¸§å¯¹åºçæ¹æ³å°±æ¯å½åæ¹æ³ï¼current methodï¼ï¼å®ä¹è¿ä¸ªæ¹æ³çç±»å°±æ¯å½åç±»ï¼current classï¼ã\n * æ§è¡å¼æè¿è¡çææå­èç æä»¤åªéå¯¹å½åæ å¸§è¿è¡æä½ã\n * ä¸åçº¿ç¨ä¸­æåå«çæ å¸§æ¯ä¸åè®¸å­å¨ç¸äºå¼ç¨çï¼å³ä¸å¯è½å¨ä¸ä¸ªæ å¸§ä¸­å¼ç¨å¦å¤ä¸ä¸ªçº¿ç¨çæ å¸§ã\n * java æ¹æ³æä¸¤ç§è¿åå½æ°çæ¹å¼ï¼ä¸ç§æ¯æ­£å¸¸çå½æ°è¿åï¼ä½¿ç¨ return æä»¤ï¼å¦ä¸ç§æ¯æåºå¼å¸¸ï¼ä¸ç®¡ç¨åªç§æ¹å¼ï¼é½ä¼å¯¼è´æ å¸§è¢«å¼¹åºã\n * æ ä¸å­å¨åå¾åæ¶é®é¢\n\n\n\næ ä¸­å¯è½åºç°çå¼å¸¸ï¼\n\njava èææºè§èåè®¸ javaèææºæ çå¤§å°æ¯å¨æçæèæ¯åºå®ä¸åç\n\n * å¦æéç¨åºå®å¤§å°ç java èææºæ ï¼é£æ¯ä¸ªçº¿ç¨ç java èææºæ å®¹éå¯ä»¥å¨çº¿ç¨åå»ºçæ¶åç¬ç«éå®ãå¦æçº¿ç¨è¯·æ±åéçæ å®¹éè¶è¿ java èææºæ åè®¸çæå¤§å®¹éï¼java èææºå°ä¼æåºä¸ä¸ª stackoverflowerror å¼å¸¸\n * å¦æ java èææºæ å¯ä»¥å¨ææ©å±ï¼å¹¶ä¸å¨å°è¯æ©å±çæ¶åæ æ³ç³è¯·å°è¶³å¤çåå­ï¼æèå¨åå»ºæ°ççº¿ç¨æ¶æ²¡æè¶³å¤çåå­å»åå»ºå¯¹åºçèææºæ ï¼é£ java èææºå°ä¼æåºä¸ä¸ªoutofmemoryerrorå¼å¸¸\n\nå¯ä»¥éè¿åæ°-xssæ¥è®¾ç½®çº¿ç¨çæå¤§æ ç©ºé´ï¼æ çå¤§å°ç´æ¥å³å®äºå½æ°è°ç¨çæå¤§å¯è¾¾æ·±åº¦ã\n\n\n# æ¬å°æ¹æ³æ \n\n * ä¸èææºæ ç¸ä¼¼ï¼åªæ¯æå¡çæ¯native æ¹æ³ã\n * unsafe ç±»å°±æå¾å¤æ¬å°æ¹æ³ã\n\n\n# ç¨åºè®¡æ°å¨\n\n * è®°å½å½åçº¿ç¨ææ§è¡çå­èç çè¡å·ãjvm ä¸­ç pc å¯å­å¨æ¯å¯¹ç©ç pc å¯å­å¨çä¸ç§æ½è±¡æ¨¡æã\n\n * å ä¸ºcpuéè¦ä¸åçåæ¢åä¸ªçº¿ç¨ï¼è¿æ¶ååæ¢åæ¥ä»¥åï¼å°±å¾ç¥éæ¥çä»åªå¼å§ç»§ç»­æ§è¡ãjvmçå­èç è§£éå¨å°±éè¦éè¿æ¹åpcå¯å­å¨çå¼æ¥æç¡®ä¸ä¸æ¡åºè¯¥æ§è¡ä»ä¹æ ·çå­èç æä»¤ã\n\n * å®æ¯ç¨åºæ§å¶æµçæç¤ºå¨ï¼åæ¯ãå¾ªç¯ãè·³è½¬ãå¼å¸¸å¤çãçº¿ç¨æ¢å¤ç­åºç¡åè½é½éè¦ä¾èµè¿ä¸ªè®¡æ°å¨æ¥å®æã\n\n * å®æ¯å¯ä¸ä¸ä¸ªå¨ jvm è§èä¸­æ²¡æè§å®ä»»ä½ outofmemoryerror æåµçåºå\n\n\n# æ¬å°åå­ï¼åç©ºé´ãç´æ¥åå­ï¼\n\n * å¦nioï¼åéå å¤åå­ï¼é¿åäºå¨ java å å native å ä¹é´æ¥åå¤å¶æ°æ®ï¼å¯æé«æ§è½ã\n\n\n# è¿è¡æ¶å¸¸éæ± ï¼runtime constant poolï¼\n\nè¿è¡æ¶å¸¸éæ± ï¼runtime constant poolï¼æ¯æ¹æ³åºçä¸é¨åã\n\nçè§£è¿è¡æ¶å¸¸éæ± ï¼\n\nå­èç æä»¶ï¼class æä»¶ï¼ä¸­çåå«ä¸é¡¹ä¿¡æ¯å¸¸éæ±  constant poolï¼å®å¯ä»¥çä½æ¯ä¸å¼ è¡¨ï¼èææºæä»¤æ ¹æ®è¿å¼ å¸¸éè¡¨æ¾å°è¦æ§è¡çç±»åãæ¹æ³åãåæ°ç±»åãå­é¢éç­ç±»åã\n\nå¸¸éæ± è¡¨ï¼constant pool tableï¼æ¯ class æä»¶çä¸é¨åï¼ç¨äºå­å¨ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼è¿é¨ååå®¹å°å¨ç±»å è½½åå­æ¾å°æ¹æ³åºçè¿è¡æ¶å¸¸éæ± ä¸­ã\n\njdk1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\njdk1.7å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ã\n\njdk1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(metaspace)ã\n\nå¼ç³çé®é¢ï¼\n\nä¸ºä»ä¹è¦æ¹æ°¸ä¹ä»£ä¸ºåç©ºé´å»å®ç°æ¹æ³åºï¼\n\nå ä¸ºç¨æ°¸ä¹ä»£å®ç°å¯¼è´javaåºç¨æ´å®¹æäº§çåå­æº¢åºé®é¢ãèæ¹ç¨æ¬å°åå­å®ç°çåç©ºé´åæ¯è¾å¥½ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"èææºå¯¹è±¡",frontmatter:{title:"èææºå¯¹è±¡",date:"2023-03-19T19:37:22.000Z",permalink:"/pages/376408/"},regularPath:"/01.Java/03.JVM/05.%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1.html",relativePath:"01.Java/03.JVM/05.èææºå¯¹è±¡.md",key:"v-0a837972",path:"/pages/376408/",headersStr:null,content:'# Javaå¯¹è±¡çåå»º\n\n 1. ç±»å è½½æ£æ¥\n 2. åéåå­\n 3. åå§åé¶å¼ï¼ä¸ºå¯¹è±¡å­æ®µè®¾ç½®é¶å¼ï¼\n 4. è®¾ç½®å¯¹è±¡å¤´\n 5. æ§è¡æé æ¹æ³\n\n\n# Javaå¯¹è±¡çåå­å¸å±\n\nå¯¹è±¡å¨å ä¸­å¸å±å¯ä»¥åä¸ºä¸ä¸ªé¨åï¼\n\n * å¯¹è±¡å¤´\n\n * * å­å¨å¯¹è±¡èªèº«çè¿è¡æ¶æ°æ®ï¼Mark Wordï¼ï¼åå¸ç ãGCåä»£å¹´é¾ãéç¶ææ å¿ãçº¿ç¨ææçéãååéIDç­\n   * ç±»åæéï¼å¯¹è±¡æåå®çç±»åæ°æ®çæéï¼è¡¨ç¤ºæ¯åªä¸ªç±»çå®ä¾ã\n\n * å®ä¾æ°æ®\n\n * å¡«åå¯¹é½\n\n\n# Javaå¯¹è±¡çè®¿é®å®ä½\n\néè¿èææºæ ä¸çreferenceæ°æ®æ¥æä½å ä¸çå·ä½å¯¹è±¡ã\n\nå¯¹è±¡çè®¿é®æ¹å¼ç±èææºçå®ç°å³å®ï¼ä¸»æµçè®¿é®æ¹å¼ä¸»è¦æä½¿ç¨å¥æåç´æ¥æéä¸¤ç§ã\n\nå¥æï¼ å¦æä½¿ç¨å¥æçè¯ï¼é£ä¹Javaå ä¸­å°ä¼åååºä¸ååå­æ¥ä½ä¸ºå¥ææ± ï¼reference ä¸­å­å¨çå°±æ¯å¯¹è±¡çå¥æå°åï¼èå¥æä¸­åå«äºå¯¹è±¡å®ä¾æ°æ®ä¸ç±»åæ°æ®åèªçå·ä½å°åä¿¡æ¯ï¼\n\nç´æ¥æéï¼ å¦æä½¿ç¨ç´æ¥æéè®¿é®ï¼é£ä¹ Java å å¯¹è±¡çå¸å±ä¸­å°±å¿é¡»èèå¦ä½æ¾ç½®è®¿é®ç±»åæ°æ®çç¸å³ä¿¡æ¯ï¼èreference ä¸­å­å¨çç´æ¥å°±æ¯å¯¹è±¡çå°åãhotspotçä½¿ç¨æ¹å¼\n\nè¿ä¸¤ç§å¯¹è±¡è®¿é®æ¹å¼åæä¼å¿ãä½¿ç¨å¥ææ¥è®¿é®çæå¤§å¥½å¤æ¯ reference ä¸­å­å¨çæ¯ç¨³å®çå¥æå°åï¼å¨å¯¹è±¡è¢«ç§»å¨æ¶åªä¼æ¹åå¥æä¸­çå®ä¾æ°æ®æéï¼è reference æ¬èº«ä¸éè¦ä¿®æ¹ãä½¿ç¨ç´æ¥æéè®¿é®æ¹å¼æå¤§çå¥½å¤å°±æ¯éåº¦å¿«ï¼åå°äºä¸æ¬¡é´æ¥å¯»åã\n\n\n\n\n\n\n# å¸¸éæ± é®é¢\n\nç´æ¥ä½¿ç¨åå¼å·å£°æåºæ¥çStringå¯¹è±¡ä¼ç´æ¥å­å¨å¨å¸¸éæ± ä¸­ã\n\nå¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¼ãå¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\nJava åºæ¬ç±»åçåè£ç±»çå¤§é¨åé½å®ç°äºå¸¸éæ± ææ¯ã\n\nByte,Short,Integer,Long è¿ 4 ç§åè£ç±»é»è®¤åå»ºäºæ°å¼ [-128ï¼127] çç¸åºç±»åçç¼å­æ°æ®ï¼Character åå»ºäºæ°å¼å¨ [0,127] èå´çç¼å­æ°æ®ï¼Boolean ç´æ¥è¿å True Or Falseã\n\nä¸¤ç§æµ®ç¹æ°ç±»åçåè£ç±» Float,Double å¹¶æ²¡æå®ç°å¸¸éæ± ææ¯ã\n\nè®°ä½ï¼æææ´ååè£ç±»å¯¹è±¡ä¹é´å¼çæ¯è¾ï¼å¨é¨ä½¿ç¨ equals æ¹æ³æ¯è¾ã\n\nå¨ç¼è¯è¿ç¨ä¸­ï¼Javac ç¼è¯å¨ä¼è¿è¡ä¸ä¸ªå«åå¸¸éæå (Constant Folding)çä»£ç ä¼åãå¸¸éæå ä¼æå¸¸éè¡¨è¾¾å¼çå¼æ±åºæ¥ä½ä¸ºå¸¸éåµå¨æç»çæçä»£ç ä¸­ï¼è¿æ¯ Javac ç¼è¯å¨ä¼å¯¹æºä»£ç åçæå°éä¼åæªæ½ä¹ä¸(ä»£ç ä¼åå ä¹é½å¨å³æ¶ç¼è¯å¨ä¸­è¿è¡)ã\n\nä¸è¬æ¥è¯´ï¼æä»¬è¦å°½éé¿åéè¿ new çæ¹å¼åå»ºå­ç¬¦ä¸²ãä½¿ç¨åå¼å·å£°æç String å¯¹è±¡ï¼ String s1 = "java" ï¼æ´å©äºè®©ç¼è¯å¨ææºä¼ä¼åæä»¬çä»£ç ï¼åæ¶ä¹æ´æäºéè¯»ã\n\nè¢« Final å³é®å­ä¿®æ¹ä¹åç String ä¼è¢«ç¼è¯å¨å½åå¸¸éæ¥å¤çï¼ç¼è¯å¨ç¨åºç¼è¯æå°±å¯ä»¥ç¡®å®å®çå¼ï¼å¶ææå°±æ³å°äºè®¿é®å¸¸éã',normalizedContent:'# javaå¯¹è±¡çåå»º\n\n 1. ç±»å è½½æ£æ¥\n 2. åéåå­\n 3. åå§åé¶å¼ï¼ä¸ºå¯¹è±¡å­æ®µè®¾ç½®é¶å¼ï¼\n 4. è®¾ç½®å¯¹è±¡å¤´\n 5. æ§è¡æé æ¹æ³\n\n\n# javaå¯¹è±¡çåå­å¸å±\n\nå¯¹è±¡å¨å ä¸­å¸å±å¯ä»¥åä¸ºä¸ä¸ªé¨åï¼\n\n * å¯¹è±¡å¤´\n\n * * å­å¨å¯¹è±¡èªèº«çè¿è¡æ¶æ°æ®ï¼mark wordï¼ï¼åå¸ç ãgcåä»£å¹´é¾ãéç¶ææ å¿ãçº¿ç¨ææçéãååéidç­\n   * ç±»åæéï¼å¯¹è±¡æåå®çç±»åæ°æ®çæéï¼è¡¨ç¤ºæ¯åªä¸ªç±»çå®ä¾ã\n\n * å®ä¾æ°æ®\n\n * å¡«åå¯¹é½\n\n\n# javaå¯¹è±¡çè®¿é®å®ä½\n\néè¿èææºæ ä¸çreferenceæ°æ®æ¥æä½å ä¸çå·ä½å¯¹è±¡ã\n\nå¯¹è±¡çè®¿é®æ¹å¼ç±èææºçå®ç°å³å®ï¼ä¸»æµçè®¿é®æ¹å¼ä¸»è¦æä½¿ç¨å¥æåç´æ¥æéä¸¤ç§ã\n\nå¥æï¼ å¦æä½¿ç¨å¥æçè¯ï¼é£ä¹javaå ä¸­å°ä¼åååºä¸ååå­æ¥ä½ä¸ºå¥ææ± ï¼reference ä¸­å­å¨çå°±æ¯å¯¹è±¡çå¥æå°åï¼èå¥æä¸­åå«äºå¯¹è±¡å®ä¾æ°æ®ä¸ç±»åæ°æ®åèªçå·ä½å°åä¿¡æ¯ï¼\n\nç´æ¥æéï¼ å¦æä½¿ç¨ç´æ¥æéè®¿é®ï¼é£ä¹ java å å¯¹è±¡çå¸å±ä¸­å°±å¿é¡»èèå¦ä½æ¾ç½®è®¿é®ç±»åæ°æ®çç¸å³ä¿¡æ¯ï¼èreference ä¸­å­å¨çç´æ¥å°±æ¯å¯¹è±¡çå°åãhotspotçä½¿ç¨æ¹å¼\n\nè¿ä¸¤ç§å¯¹è±¡è®¿é®æ¹å¼åæä¼å¿ãä½¿ç¨å¥ææ¥è®¿é®çæå¤§å¥½å¤æ¯ reference ä¸­å­å¨çæ¯ç¨³å®çå¥æå°åï¼å¨å¯¹è±¡è¢«ç§»å¨æ¶åªä¼æ¹åå¥æä¸­çå®ä¾æ°æ®æéï¼è reference æ¬èº«ä¸éè¦ä¿®æ¹ãä½¿ç¨ç´æ¥æéè®¿é®æ¹å¼æå¤§çå¥½å¤å°±æ¯éåº¦å¿«ï¼åå°äºä¸æ¬¡é´æ¥å¯»åã\n\n\n\n\n\n\n# å¸¸éæ± é®é¢\n\nç´æ¥ä½¿ç¨åå¼å·å£°æåºæ¥çstringå¯¹è±¡ä¼ç´æ¥å­å¨å¨å¸¸éæ± ä¸­ã\n\nå¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¼ãå¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\njava åºæ¬ç±»åçåè£ç±»çå¤§é¨åé½å®ç°äºå¸¸éæ± ææ¯ã\n\nbyte,short,integer,long è¿ 4 ç§åè£ç±»é»è®¤åå»ºäºæ°å¼ [-128ï¼127] çç¸åºç±»åçç¼å­æ°æ®ï¼character åå»ºäºæ°å¼å¨ [0,127] èå´çç¼å­æ°æ®ï¼boolean ç´æ¥è¿å true or falseã\n\nä¸¤ç§æµ®ç¹æ°ç±»åçåè£ç±» float,double å¹¶æ²¡æå®ç°å¸¸éæ± ææ¯ã\n\nè®°ä½ï¼æææ´ååè£ç±»å¯¹è±¡ä¹é´å¼çæ¯è¾ï¼å¨é¨ä½¿ç¨ equals æ¹æ³æ¯è¾ã\n\nå¨ç¼è¯è¿ç¨ä¸­ï¼javac ç¼è¯å¨ä¼è¿è¡ä¸ä¸ªå«åå¸¸éæå (constant folding)çä»£ç ä¼åãå¸¸éæå ä¼æå¸¸éè¡¨è¾¾å¼çå¼æ±åºæ¥ä½ä¸ºå¸¸éåµå¨æç»çæçä»£ç ä¸­ï¼è¿æ¯ javac ç¼è¯å¨ä¼å¯¹æºä»£ç åçæå°éä¼åæªæ½ä¹ä¸(ä»£ç ä¼åå ä¹é½å¨å³æ¶ç¼è¯å¨ä¸­è¿è¡)ã\n\nä¸è¬æ¥è¯´ï¼æä»¬è¦å°½éé¿åéè¿ new çæ¹å¼åå»ºå­ç¬¦ä¸²ãä½¿ç¨åå¼å·å£°æç string å¯¹è±¡ï¼ string s1 = "java" ï¼æ´å©äºè®©ç¼è¯å¨ææºä¼ä¼åæä»¬çä»£ç ï¼åæ¶ä¹æ´æäºéè¯»ã\n\nè¢« final å³é®å­ä¿®æ¹ä¹åç string ä¼è¢«ç¼è¯å¨å½åå¸¸éæ¥å¤çï¼ç¼è¯å¨ç¨åºç¼è¯æå°±å¯ä»¥ç¡®å®å®çå¼ï¼å¶ææå°±æ³å°äºè®¿é®å¸¸éã',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"OutOfMemoryError",frontmatter:{title:"OutOfMemoryError",date:"2023-03-20T19:19:34.000Z",permalink:"/pages/9a5ae7/"},regularPath:"/01.Java/03.JVM/06.OutOfMemoryError.html",relativePath:"01.Java/03.JVM/06.OutOfMemoryError.md",key:"v-89486e7a",path:"/pages/9a5ae7/",headers:[{level:2,title:"å æº¢åº",slug:"å æº¢åº",normalizedTitle:"å æº¢åº",charIndex:2},{level:2,title:"æ æº¢åº",slug:"æ æº¢åº",normalizedTitle:"æ æº¢åº",charIndex:775},{level:2,title:"æ¬æºç´æ¥åå­æº¢åº",slug:"æ¬æºç´æ¥åå­æº¢åº",normalizedTitle:"æ¬æºç´æ¥åå­æº¢åº",charIndex:947}],headersStr:"å æº¢åº æ æº¢åº æ¬æºç´æ¥åå­æº¢åº",content:"# å æº¢åº\n\nå°å çæå°å¼-Xmsåæ°ä¸æå¤§å¼-Xmxåæ°è®¾ç½®ä¸ºä¸æ ·çè¯å¯é¿åå èªå¨æ©å±ï¼å³è®¾ç½®ä¸ºä¸å¯æ©å±ã\n\nè¦è§£å³è¿ä¸ªåå­åºåçå¼å¸¸ï¼ å¸¸è§çå¤çæ¹æ³æ¯é¦åéè¿åå­æ ååæå·¥å·ï¼å¦MATï¼å¯¹Dumpåºæ¥çå è½¬å¨å¿«ç§è¿è¡åæã ç¬¬ä¸æ­¥é¦ååºç¡®è®¤åå­ä¸­å¯¼è´OOMçå¯¹è±¡æ¯å¦æ¯å¿è¦çï¼ ä¹å°±æ¯è¦ååæ¸æ¥å°åºæ¯åºç°äºåå­æ³æ¼ï¼Memory Leakï¼ è¿æ¯åå­æº¢åºï¼Memory Overflowï¼ ã\n\nå¦ææ¯åå­æ³æ¼ï¼ å¯è¿ä¸æ­¥éè¿å·¥å·æ¥çæ³æ¼å¯¹è±¡å°GC Rootsçå¼ç¨é¾ï¼ æ¾å°æ³æ¼å¯¹è±¡æ¯éè¿ææ ·çå¼ç¨è·¯å¾ã ä¸åªäºGC Rootsç¸å³èï¼ æå¯¼è´åå¾æ¶éå¨æ æ³åæ¶å®ä»¬ï¼ æ ¹æ®æ³æ¼å¯¹è±¡çç±»åä¿¡æ¯ä»¥åå®å°GC Rootså¼ç¨é¾çä¿¡æ¯ï¼ ä¸è¬å¯ä»¥æ¯è¾åç¡®å°å®ä½å°è¿äºå¯¹è±¡åå»ºçä½ç½®ï¼ è¿èæ¾åºäº§çåå­æ³æ¼çä»£ç çå·ä½ä½ç½®ã\n\nå¦æä¸æ¯åå­æ³æ¼ï¼ æ¢å¥è¯è¯´å°±æ¯åå­ä¸­çå¯¹è±¡ç¡®å®é½æ¯å¿é¡»å­æ´»çï¼ é£å°±åºå½æ£æ¥Javaèææºçå åæ°ï¼-Xmxä¸-Xmsï¼ è®¾ç½®ï¼ ä¸æºå¨çåå­å¯¹æ¯ï¼ ççæ¯å¦è¿æåä¸è°æ´çç©ºé´ã åä»ä»£ç ä¸æ£æ¥æ¯å¦å­å¨æäºå¯¹è±¡çå½å¨æè¿é¿ã ææç¶ææ¶é´è¿é¿ã å­å¨ç»æè®¾è®¡ä¸åçç­æåµï¼ å°½éåå°ç¨åºè¿è¡æçåå­æ¶èã\n\næ­¥éª¤ï¼\n\n 1. ä½¿ç¨ jpsæè ps -ef | grep XXXX æ¥çè¿è¡çJavaé¡¹ç®ä¿¡æ¯\n 2. ç±ä½¿ç¨ jmap dumpåå­å¿«ç§æ¶ï¼å¦æå½åç¨æ·ä¸å¯å¨è¿ç¨çç¨æ·ä¸ä¸è´æ¶ï¼ä¸åè®¸è¿è¡å¿«ç§çå¤ä»½ãæ¥è¯¢è¿ç¨å¯å¨æå±ï¼top -pid PIDï¼å¶ä¸­ COMMAND ä¿¡æ¯å°±æ¯å¯å¨è¿ç¨çæå±ï¼sudo å°è¿ä¸ªæå±ç¨æ·å³å¯ã\n 3. dump ä¿å­åå­å¿«ç§ä¿¡æ¯ï¼jmap -dump:live, format=b, file=dump.hprof 2629\n 4. ä½¿ç¨ MAT å è½½dumpæä»¶ã\n\n\n# æ æº¢åº\n\nç±äºHotSpotèææºå¹¶ä¸åºåèææºæ åæ¬å°æ¹æ³æ ï¼æä»¥æ å®¹éåªç± -Xssåæ°å³å®ã\n\n 1. å¦æçº¿ç¨è¯·æ±çæ æ·±åº¦å¤§äºèææºæåè®¸çæå¤§æ·±åº¦ï¼ å°æåºStackOverflowErrorå¼å¸¸ã\n 2. å¦æèææºçæ åå­åè®¸å¨ææ©å±ï¼ å½æ©å±æ å®¹éæ æ³ç³è¯·å°è¶³å¤çåå­æ¶ï¼ å°æåºOutOfMemoryErrorå¼å¸¸ã\n\n\n# æ¬æºç´æ¥åå­æº¢åº\n\nç´æ¥åå­ï¼Direct Memoryï¼ çå®¹éå¤§å°å¯éè¿-XXï¼ MaxDirectMemorySizeåæ°æ¥æå®ï¼ å¦æä¸å»æå®ï¼ åé»è®¤ä¸Javaå æå¤§å¼ï¼ç±-Xmxæå®ï¼ ä¸è´ã\n\nç±ç´æ¥åå­å¯¼è´çåå­æº¢åºï¼ ä¸ä¸ªææ¾çç¹å¾æ¯å¨Heap Dumpæä»¶ä¸­ä¸ä¼çè§æä»ä¹ææ¾çå¼å¸¸æåµï¼ å¦æè¯»èåç°åå­æº¢åºä¹åäº§ççDumpæä»¶å¾å°ï¼ èç¨åºä¸­åç´æ¥æé´æ¥ä½¿ç¨äºDirectMemoryï¼å¸åçé´æ¥ä½¿ç¨å°±æ¯NIOï¼ ï¼ é£å°±å¯ä»¥èèéç¹æ£æ¥ä¸ä¸ç´æ¥åå­æ¹é¢çåå äºã",normalizedContent:"# å æº¢åº\n\nå°å çæå°å¼-xmsåæ°ä¸æå¤§å¼-xmxåæ°è®¾ç½®ä¸ºä¸æ ·çè¯å¯é¿åå èªå¨æ©å±ï¼å³è®¾ç½®ä¸ºä¸å¯æ©å±ã\n\nè¦è§£å³è¿ä¸ªåå­åºåçå¼å¸¸ï¼ å¸¸è§çå¤çæ¹æ³æ¯é¦åéè¿åå­æ ååæå·¥å·ï¼å¦matï¼å¯¹dumpåºæ¥çå è½¬å¨å¿«ç§è¿è¡åæã ç¬¬ä¸æ­¥é¦ååºç¡®è®¤åå­ä¸­å¯¼è´oomçå¯¹è±¡æ¯å¦æ¯å¿è¦çï¼ ä¹å°±æ¯è¦ååæ¸æ¥å°åºæ¯åºç°äºåå­æ³æ¼ï¼memory leakï¼ è¿æ¯åå­æº¢åºï¼memory overflowï¼ ã\n\nå¦ææ¯åå­æ³æ¼ï¼ å¯è¿ä¸æ­¥éè¿å·¥å·æ¥çæ³æ¼å¯¹è±¡å°gc rootsçå¼ç¨é¾ï¼ æ¾å°æ³æ¼å¯¹è±¡æ¯éè¿ææ ·çå¼ç¨è·¯å¾ã ä¸åªäºgc rootsç¸å³èï¼ æå¯¼è´åå¾æ¶éå¨æ æ³åæ¶å®ä»¬ï¼ æ ¹æ®æ³æ¼å¯¹è±¡çç±»åä¿¡æ¯ä»¥åå®å°gc rootså¼ç¨é¾çä¿¡æ¯ï¼ ä¸è¬å¯ä»¥æ¯è¾åç¡®å°å®ä½å°è¿äºå¯¹è±¡åå»ºçä½ç½®ï¼ è¿èæ¾åºäº§çåå­æ³æ¼çä»£ç çå·ä½ä½ç½®ã\n\nå¦æä¸æ¯åå­æ³æ¼ï¼ æ¢å¥è¯è¯´å°±æ¯åå­ä¸­çå¯¹è±¡ç¡®å®é½æ¯å¿é¡»å­æ´»çï¼ é£å°±åºå½æ£æ¥javaèææºçå åæ°ï¼-xmxä¸-xmsï¼ è®¾ç½®ï¼ ä¸æºå¨çåå­å¯¹æ¯ï¼ ççæ¯å¦è¿æåä¸è°æ´çç©ºé´ã åä»ä»£ç ä¸æ£æ¥æ¯å¦å­å¨æäºå¯¹è±¡çå½å¨æè¿é¿ã ææç¶ææ¶é´è¿é¿ã å­å¨ç»æè®¾è®¡ä¸åçç­æåµï¼ å°½éåå°ç¨åºè¿è¡æçåå­æ¶èã\n\næ­¥éª¤ï¼\n\n 1. ä½¿ç¨ jpsæè ps -ef | grep xxxx æ¥çè¿è¡çjavaé¡¹ç®ä¿¡æ¯\n 2. ç±ä½¿ç¨ jmap dumpåå­å¿«ç§æ¶ï¼å¦æå½åç¨æ·ä¸å¯å¨è¿ç¨çç¨æ·ä¸ä¸è´æ¶ï¼ä¸åè®¸è¿è¡å¿«ç§çå¤ä»½ãæ¥è¯¢è¿ç¨å¯å¨æå±ï¼top -pid pidï¼å¶ä¸­ command ä¿¡æ¯å°±æ¯å¯å¨è¿ç¨çæå±ï¼sudo å°è¿ä¸ªæå±ç¨æ·å³å¯ã\n 3. dump ä¿å­åå­å¿«ç§ä¿¡æ¯ï¼jmap -dump:live, format=b, file=dump.hprof 2629\n 4. ä½¿ç¨ mat å è½½dumpæä»¶ã\n\n\n# æ æº¢åº\n\nç±äºhotspotèææºå¹¶ä¸åºåèææºæ åæ¬å°æ¹æ³æ ï¼æä»¥æ å®¹éåªç± -xssåæ°å³å®ã\n\n 1. å¦æçº¿ç¨è¯·æ±çæ æ·±åº¦å¤§äºèææºæåè®¸çæå¤§æ·±åº¦ï¼ å°æåºstackoverflowerrorå¼å¸¸ã\n 2. å¦æèææºçæ åå­åè®¸å¨ææ©å±ï¼ å½æ©å±æ å®¹éæ æ³ç³è¯·å°è¶³å¤çåå­æ¶ï¼ å°æåºoutofmemoryerrorå¼å¸¸ã\n\n\n# æ¬æºç´æ¥åå­æº¢åº\n\nç´æ¥åå­ï¼direct memoryï¼ çå®¹éå¤§å°å¯éè¿-xxï¼ maxdirectmemorysizeåæ°æ¥æå®ï¼ å¦æä¸å»æå®ï¼ åé»è®¤ä¸javaå æå¤§å¼ï¼ç±-xmxæå®ï¼ ä¸è´ã\n\nç±ç´æ¥åå­å¯¼è´çåå­æº¢åºï¼ ä¸ä¸ªææ¾çç¹å¾æ¯å¨heap dumpæä»¶ä¸­ä¸ä¼çè§æä»ä¹ææ¾çå¼å¸¸æåµï¼ å¦æè¯»èåç°åå­æº¢åºä¹åäº§ççdumpæä»¶å¾å°ï¼ èç¨åºä¸­åç´æ¥æé´æ¥ä½¿ç¨äºdirectmemoryï¼å¸åçé´æ¥ä½¿ç¨å°±æ¯nioï¼ ï¼ é£å°±å¯ä»¥èèéç¹æ£æ¥ä¸ä¸ç´æ¥åå­æ¹é¢çåå äºã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"å¦ä½å¿«éææ¥é®é¢",frontmatter:{title:"å¦ä½å¿«éææ¥é®é¢",date:"2023-04-02T15:58:02.000Z",permalink:"/pages/1a4e69/"},regularPath:"/01.Java/03.JVM/07.%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%8E%92%E6%9F%A5%E9%97%AE%E9%A2%98.html",relativePath:"01.Java/03.JVM/07.å¦ä½å¿«éææ¥é®é¢.md",key:"v-38ab7e32",path:"/pages/1a4e69/",headers:[{level:2,title:"åºæ¯",slug:"åºæ¯",normalizedTitle:"åºæ¯",charIndex:2},{level:2,title:"å¯è½åå ",slug:"å¯è½åå ",normalizedTitle:"å¯è½åå ",charIndex:43},{level:2,title:"linuxåmacosä¸­topå½ä»¤çåºå«",slug:"linuxåmacosä¸­topå½ä»¤çåºå«",normalizedTitle:"linuxåmacosä¸­topå½ä»¤çåºå«",charIndex:899},{level:2,title:"jstack",slug:"jstack",normalizedTitle:"jstack",charIndex:339},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1800}],headersStr:"åºæ¯ å¯è½åå  linuxåmacosä¸­topå½ä»¤çåºå« jstack åè",content:'# åºæ¯\n\nç³»ç»ç¹å«å¡é¡¿ï¼å¾å¤é¡µé¢é½æä¸å¼äºï¼ä½ä¸ºåç«¯å¼åå¦ä½å¿«éå®ä½é®é¢ï¼\n\n\n# å¯è½åå \n\nå¯¹äºé æè¿ç§é®é¢çå¯è½åå ï¼è¿éçå¨å¤´èä¸­éªè¿åç§æåµï¼\n\n1ãæä¸ªæ¥å£ååºæ¶é´è¶é¿ï¼å¹¶ä¸å¯è½è¢«é¢ç¹è°ç¨\n\n2ãäº§çäºè¿å¤§çå¯¹è±¡ï¼é æé¢ç¹FGC\n\n3ãä»£ç åºç°æ­»å¾ªç¯\n\n4ãçº¿ç¨åºç°æ­»é\n\nç»å½å°å¯¹åºçæå¡å¨ä¸æ§è¡äºtopå½ä»¤ï¼åç°cpué£åå°100%ï¼è¿ç§é®é¢éè¦åºè¯¥å¿«éçå®ä½å°é®é¢ï¼å¦åä¼å½±åçº¿ä¸ç³»ç»çæ­£å¸¸ä½ä¸ã\n\nå®ä½é®é¢æ­¥éª¤ï¼\n\n 1. top æ¥çå°åªä¸ªè¿ç¨\n 2. top -Hp pid æ¥çæä¸ªè¿ç¨ä¸ççº¿ç¨æåµ\n 3. printf "%x" threadid å°çº¿ç¨idè½¬æ¢ä¸º16è¿å¶ï¼åè®¾è¿éå¾å°äº3c41ãå ä¸ºå æ éï¼çº¿ç¨idæ¯ç¨16è¿å¶è¡¨ç¤ºçã\n 4. jstack pid | grep 0x3c41 -C50 --color æå°ç»å®Javaè¿ç¨çJavaå æ ä¿¡æ¯ï¼å¹¶éè¿ç®¡éç¬¦å°å¶è¾åºå° grep å½ä»¤ä¸­ï¼å¨ grep å½ä»¤ä¸­æ¥æ¾åå«å­ç¬¦ä¸² "0x3c41" çè¡ï¼å¹¶æ¾ç¤ºå¶ååå 50 è¡ï¼æ»è®¡ 101 è¡ï¼çåå®¹ï¼åæ¶å°å¹éå°çå­ç¬¦ä¸²é«äº®æ¾ç¤ºã\n 5. ä¹å¯ä»¥æ§è¡å½ä»¤ jstack -l 23002 >/data1/23002.statck å°å¯¹åºçè¿ç¨å·çæ ä¿¡æ¯è¾å¥å°æå®ç®å½\n\nå¦ææå¤§å¯¹è±¡äº§çï¼åºè¯¥ä¼æå¤ä¸ªè¿ç¨CPUå ç¨é½ä¼è¶è¿80%ï¼å¶ä¸­æå¤ä¸ªè¿ç¨å¨å¨è¿è¡GCï¼ä»èé æCPUé£åãå¦æåªæä¸ä¸ªçº¿ç¨CPUèµæºé£åï¼å¯ä»¥æé¤äº§çå¤§å¯¹è±¡é®é¢ã\n\næ§è¡jstackçæ¶åï¼æ§è¡ç¨æ·éè¦åè¿ç¨å¯å¨ç¨æ·ä¸ç´ï¼å¦åä¼æç¤ºä¸é¢éè¯¯ï¼Unable to open socket file: target process not responding or HotSpot VM not loaded The -F option can be used when the target process is not responding\n\njstat -gcutil 23002 2000 5 è¾åºè¯¥è¿ç¨å¨jvmä¸­çå ç¨æåµ æ¯2000æ¯«ç§æ§è¡ä¸æ¬¡ ä¸å±æ§è¡5æ¬¡\n\n\n# linuxåmacosä¸­topå½ä»¤çåºå«\n\nLinux å macOS ä¸­ç top å½ä»¤è½ç¶å¨åè½ä¸ç±»ä¼¼ï¼ä½æ¯å¨å®ç°ä¸æäºè®¸å·®å¼ã Linux å macOS ä¸­ç top å½ä»¤æ¯æçåæ°ç¥æä¸åãä¾å¦ï¼Linux ä¸­ç top å½ä»¤å¯ä»¥ä½¿ç¨ -H åæ°æ¥æ¾ç¤ºè¿ç¨ççº¿ç¨ä¿¡æ¯ï¼ä¹å¯ä»¥å¨äº¤äºçé¢ä½¿ç¨Håæ¢ï¼è macOS ä¸­åä¸æ¯æã\n\nè½ç¶ä¸¤ä¸ªç³»ç»ç top å½ä»¤é½è½å¤æ¾ç¤ºè¿ç¨ç CPU å ç¨çãåå­ä½¿ç¨æåµç­ä¿¡æ¯ï¼ä½å¨æ¾ç¤ºæ¹å¼ä¸ææä¸åãä¾å¦ï¼Linux ä¸­ç top å½ä»¤é»è®¤æåµä¸å¯ä»¥æ¾ç¤ºè¿ç¨ç VIRTï¼èæåå­ï¼å RESï¼å®éä½¿ç¨åå­ï¼ä¿¡æ¯ï¼è macOS ä¸­ç top å½ä»¤åé»è®¤ä¸æ¾ç¤ºè¿äºä¿¡æ¯ã\n\n\n# jstack\n\njstack æ¯ä¸ä¸ª Java èææºæä¾çå½ä»¤è¡å·¥å·ï¼ç¨äºçæå½å Java åºç¨ç¨åºççº¿ç¨è½¬å¨ä¿¡æ¯ï¼å¯ä»¥å¸®å©å¼åäººååè¿ç»´äººåè¯æ­ Java åºç¨ç¨åºçæ§è½é®é¢åæ­»éé®é¢ã\n\njstack å½ä»¤å¯ä»¥éè¿å½ä»¤è¡æèå¾å½¢çé¢å·¥å·æ¥è¿è¡ï¼çæççº¿ç¨è½¬å¨ä¿¡æ¯åå«äºå½åææçº¿ç¨çè°ç¨æ ä¿¡æ¯ï¼ä»¥åæ¯ä¸ªçº¿ç¨æææçéåç­å¾çéçä¿¡æ¯ç­ãè¿äºä¿¡æ¯å¯ä»¥å¸®å©å¼åäººåæèè¿ç»´äººåå¿«éå®ä½åºåºç¨ç¨åºä¸­çæ§è½é®é¢ãæ­»éé®é¢ç­ã\n\nä¸é¢æ¯ jstack å½ä»¤çä¸äºå¸¸ç¨ç¨æ³ï¼jstack [options] <pid> å¶ä¸­ï¼options æ¯ä¸äºå¯éçå½ä»¤åæ°ï¼pid è¡¨ç¤º Java åºç¨ç¨åºçè¿ç¨ IDã\n\nå¸¸ç¨åæ°ï¼ -Fï¼å½ jstack å½ä»¤æ æ³æ­£å¸¸è¾åºçº¿ç¨è½¬å¨ä¿¡æ¯æ¶ï¼å¯ä»¥ä½¿ç¨è¯¥åæ°è¿è¡å¼ºå¶è¾åºãè¯¥åæ°å¯è½ä¼å½±åç³»ç»çæ§è½ã -lï¼è¾åºçº¿ç¨çéä¿¡æ¯ã -mï¼è¾åºææçº¿ç¨ç Native å æ ä¿¡æ¯ã -hï¼æ¾ç¤ºå¸®å©ä¿¡æ¯ã\n\nè¾åºä¿¡æ¯ï¼jstack å½ä»¤è¾åºççº¿ç¨è½¬å¨ä¿¡æ¯åæ¬ä»¥ä¸åå®¹ï¼\n\n * çº¿ç¨ IDï¼æ¯ä¸ªçº¿ç¨çå¯ä¸æ è¯ç¬¦ã\n * çº¿ç¨ç¶æï¼æ¯ä¸ªçº¿ç¨çç¶æï¼å¦ WAITINGãBLOCKEDãTIMED_WAITING ç­ã\n * çº¿ç¨è°ç¨æ ï¼æ¯ä¸ªçº¿ç¨çè°ç¨æ ä¿¡æ¯ï¼åæ¬æ¹æ³åãæ¹æ³ç­¾åãä»£ç è¡æ°ç­ã\n * éä¿¡æ¯ï¼æ¯ä¸ªçº¿ç¨æææçéåç­å¾çéçä¿¡æ¯ã\n\n\n# åè\n\nhttps://developer.aliyun.com/article/1093780',normalizedContent:'# åºæ¯\n\nç³»ç»ç¹å«å¡é¡¿ï¼å¾å¤é¡µé¢é½æä¸å¼äºï¼ä½ä¸ºåç«¯å¼åå¦ä½å¿«éå®ä½é®é¢ï¼\n\n\n# å¯è½åå \n\nå¯¹äºé æè¿ç§é®é¢çå¯è½åå ï¼è¿éçå¨å¤´èä¸­éªè¿åç§æåµï¼\n\n1ãæä¸ªæ¥å£ååºæ¶é´è¶é¿ï¼å¹¶ä¸å¯è½è¢«é¢ç¹è°ç¨\n\n2ãäº§çäºè¿å¤§çå¯¹è±¡ï¼é æé¢ç¹fgc\n\n3ãä»£ç åºç°æ­»å¾ªç¯\n\n4ãçº¿ç¨åºç°æ­»é\n\nç»å½å°å¯¹åºçæå¡å¨ä¸æ§è¡äºtopå½ä»¤ï¼åç°cpué£åå°100%ï¼è¿ç§é®é¢éè¦åºè¯¥å¿«éçå®ä½å°é®é¢ï¼å¦åä¼å½±åçº¿ä¸ç³»ç»çæ­£å¸¸ä½ä¸ã\n\nå®ä½é®é¢æ­¥éª¤ï¼\n\n 1. top æ¥çå°åªä¸ªè¿ç¨\n 2. top -hp pid æ¥çæä¸ªè¿ç¨ä¸ççº¿ç¨æåµ\n 3. printf "%x" threadid å°çº¿ç¨idè½¬æ¢ä¸º16è¿å¶ï¼åè®¾è¿éå¾å°äº3c41ãå ä¸ºå æ éï¼çº¿ç¨idæ¯ç¨16è¿å¶è¡¨ç¤ºçã\n 4. jstack pid | grep 0x3c41 -c50 --color æå°ç»å®javaè¿ç¨çjavaå æ ä¿¡æ¯ï¼å¹¶éè¿ç®¡éç¬¦å°å¶è¾åºå° grep å½ä»¤ä¸­ï¼å¨ grep å½ä»¤ä¸­æ¥æ¾åå«å­ç¬¦ä¸² "0x3c41" çè¡ï¼å¹¶æ¾ç¤ºå¶ååå 50 è¡ï¼æ»è®¡ 101 è¡ï¼çåå®¹ï¼åæ¶å°å¹éå°çå­ç¬¦ä¸²é«äº®æ¾ç¤ºã\n 5. ä¹å¯ä»¥æ§è¡å½ä»¤ jstack -l 23002 >/data1/23002.statck å°å¯¹åºçè¿ç¨å·çæ ä¿¡æ¯è¾å¥å°æå®ç®å½\n\nå¦ææå¤§å¯¹è±¡äº§çï¼åºè¯¥ä¼æå¤ä¸ªè¿ç¨cpuå ç¨é½ä¼è¶è¿80%ï¼å¶ä¸­æå¤ä¸ªè¿ç¨å¨å¨è¿è¡gcï¼ä»èé æcpué£åãå¦æåªæä¸ä¸ªçº¿ç¨cpuèµæºé£åï¼å¯ä»¥æé¤äº§çå¤§å¯¹è±¡é®é¢ã\n\næ§è¡jstackçæ¶åï¼æ§è¡ç¨æ·éè¦åè¿ç¨å¯å¨ç¨æ·ä¸ç´ï¼å¦åä¼æç¤ºä¸é¢éè¯¯ï¼unable to open socket file: target process not responding or hotspot vm not loaded the -f option can be used when the target process is not responding\n\njstat -gcutil 23002 2000 5 è¾åºè¯¥è¿ç¨å¨jvmä¸­çå ç¨æåµ æ¯2000æ¯«ç§æ§è¡ä¸æ¬¡ ä¸å±æ§è¡5æ¬¡\n\n\n# linuxåmacosä¸­topå½ä»¤çåºå«\n\nlinux å macos ä¸­ç top å½ä»¤è½ç¶å¨åè½ä¸ç±»ä¼¼ï¼ä½æ¯å¨å®ç°ä¸æäºè®¸å·®å¼ã linux å macos ä¸­ç top å½ä»¤æ¯æçåæ°ç¥æä¸åãä¾å¦ï¼linux ä¸­ç top å½ä»¤å¯ä»¥ä½¿ç¨ -h åæ°æ¥æ¾ç¤ºè¿ç¨ççº¿ç¨ä¿¡æ¯ï¼ä¹å¯ä»¥å¨äº¤äºçé¢ä½¿ç¨håæ¢ï¼è macos ä¸­åä¸æ¯æã\n\nè½ç¶ä¸¤ä¸ªç³»ç»ç top å½ä»¤é½è½å¤æ¾ç¤ºè¿ç¨ç cpu å ç¨çãåå­ä½¿ç¨æåµç­ä¿¡æ¯ï¼ä½å¨æ¾ç¤ºæ¹å¼ä¸ææä¸åãä¾å¦ï¼linux ä¸­ç top å½ä»¤é»è®¤æåµä¸å¯ä»¥æ¾ç¤ºè¿ç¨ç virtï¼èæåå­ï¼å resï¼å®éä½¿ç¨åå­ï¼ä¿¡æ¯ï¼è macos ä¸­ç top å½ä»¤åé»è®¤ä¸æ¾ç¤ºè¿äºä¿¡æ¯ã\n\n\n# jstack\n\njstack æ¯ä¸ä¸ª java èææºæä¾çå½ä»¤è¡å·¥å·ï¼ç¨äºçæå½å java åºç¨ç¨åºççº¿ç¨è½¬å¨ä¿¡æ¯ï¼å¯ä»¥å¸®å©å¼åäººååè¿ç»´äººåè¯æ­ java åºç¨ç¨åºçæ§è½é®é¢åæ­»éé®é¢ã\n\njstack å½ä»¤å¯ä»¥éè¿å½ä»¤è¡æèå¾å½¢çé¢å·¥å·æ¥è¿è¡ï¼çæççº¿ç¨è½¬å¨ä¿¡æ¯åå«äºå½åææçº¿ç¨çè°ç¨æ ä¿¡æ¯ï¼ä»¥åæ¯ä¸ªçº¿ç¨æææçéåç­å¾çéçä¿¡æ¯ç­ãè¿äºä¿¡æ¯å¯ä»¥å¸®å©å¼åäººåæèè¿ç»´äººåå¿«éå®ä½åºåºç¨ç¨åºä¸­çæ§è½é®é¢ãæ­»éé®é¢ç­ã\n\nä¸é¢æ¯ jstack å½ä»¤çä¸äºå¸¸ç¨ç¨æ³ï¼jstack [options] <pid> å¶ä¸­ï¼options æ¯ä¸äºå¯éçå½ä»¤åæ°ï¼pid è¡¨ç¤º java åºç¨ç¨åºçè¿ç¨ idã\n\nå¸¸ç¨åæ°ï¼ -fï¼å½ jstack å½ä»¤æ æ³æ­£å¸¸è¾åºçº¿ç¨è½¬å¨ä¿¡æ¯æ¶ï¼å¯ä»¥ä½¿ç¨è¯¥åæ°è¿è¡å¼ºå¶è¾åºãè¯¥åæ°å¯è½ä¼å½±åç³»ç»çæ§è½ã -lï¼è¾åºçº¿ç¨çéä¿¡æ¯ã -mï¼è¾åºææçº¿ç¨ç native å æ ä¿¡æ¯ã -hï¼æ¾ç¤ºå¸®å©ä¿¡æ¯ã\n\nè¾åºä¿¡æ¯ï¼jstack å½ä»¤è¾åºççº¿ç¨è½¬å¨ä¿¡æ¯åæ¬ä»¥ä¸åå®¹ï¼\n\n * çº¿ç¨ idï¼æ¯ä¸ªçº¿ç¨çå¯ä¸æ è¯ç¬¦ã\n * çº¿ç¨ç¶æï¼æ¯ä¸ªçº¿ç¨çç¶æï¼å¦ waitingãblockedãtimed_waiting ç­ã\n * çº¿ç¨è°ç¨æ ï¼æ¯ä¸ªçº¿ç¨çè°ç¨æ ä¿¡æ¯ï¼åæ¬æ¹æ³åãæ¹æ³ç­¾åãä»£ç è¡æ°ç­ã\n * éä¿¡æ¯ï¼æ¯ä¸ªçº¿ç¨æææçéåç­å¾çéçä¿¡æ¯ã\n\n\n# åè\n\nhttps://developer.aliyun.com/article/1093780',charsets:{cjk:!0}},{title:"JITéé¸åæ",frontmatter:{title:"JITéé¸åæ",date:"2023-08-30T23:52:48.000Z",permalink:"/pages/1ee611/"},regularPath:"/01.Java/03.JVM/08.JIT%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90.html",relativePath:"01.Java/03.JVM/08.JITéé¸åæ.md",key:"v-5367a4af",path:"/pages/1ee611/",headers:[{level:2,title:"JIT",slug:"jit",normalizedTitle:"jit",charIndex:2},{level:2,title:"JIT ä¼åä¹éé¸åæ",slug:"jit-ä¼åä¹éé¸åæ",normalizedTitle:"jit ä¼åä¹éé¸åæ",charIndex:412},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1264}],headersStr:"JIT JIT ä¼åä¹éé¸åæ åè",content:"# JIT\n\nå¨Javaçç¼è¯ä½ç³»ä¸­ï¼ä¸ä¸ªJavaçæºä»£ç æä»¶åæè®¡ç®æºå¯æ§è¡çæºå¨æä»¤çè¿ç¨ä¸­ï¼éè¦ç»è¿ä¸¤æ®µç¼è¯ï¼ç¬¬ä¸æ®µæ¯æ.javaæä»¶è½¬æ¢æ.classæä»¶ãç¬¬äºæ®µç¼è¯æ¯æ.classè½¬æ¢ææºå¨æä»¤çè¿ç¨ã\n\nç¬¬ä¸æ®µç¼è¯å°±æ¯javacå½ä»¤ã\n\nå¨ç¬¬äºç¼è¯é¶æ®µï¼JVM éè¿è§£éå­èç å°å¶ç¿»è¯æå¯¹åºçæºå¨æä»¤ï¼éæ¡è¯»å¥ï¼éæ¡è§£éç¿»è¯ãå¾æ¾ç¶ï¼ç»è¿è§£éæ§è¡ï¼å¶æ§è¡éåº¦å¿ç¶ä¼æ¯å¯æ§è¡çäºè¿å¶å­èç ç¨åºæ¢å¾å¤ãè¿å°±æ¯ä¼ ç»çJVMçè§£éå¨ï¼Interpreterï¼çåè½ãä¸ºäºè§£å³è¿ç§æçé®é¢ï¼å¼å¥äº JITï¼å³æ¶ç¼è¯ï¼ ææ¯ã\n\nå¼å¥äº JIT ææ¯åï¼Javaç¨åºè¿æ¯éè¿è§£éå¨è¿è¡è§£éæ§è¡ï¼å½JVMåç°æä¸ªæ¹æ³æä»£ç åè¿è¡ç¹å«é¢ç¹çæ¶åï¼å°±ä¼è®¤ä¸ºè¿æ¯âç­ç¹ä»£ç âï¼Hot Spot Code)ãç¶åJITä¼æé¨åâç­ç¹ä»£ç âç¿»è¯ææ¬å°æºå¨ç¸å³çæºå¨ç ï¼å¹¶è¿è¡ä¼åï¼ç¶ååæç¿»è¯åçæºå¨ç ç¼å­èµ·æ¥ï¼ä»¥å¤ä¸æ¬¡ä½¿ç¨ã\n\n\n# JIT ä¼åä¹éé¸åæ\n\nJITä¼åä¸­æéè¦çä¸ä¸ªå°±æ¯éé¸åæã\n\néé¸åæçåºæ¬è¡ä¸ºå°±æ¯åæå¯¹è±¡å¨æä½ç¨åï¼å½ä¸ä¸ªå¯¹è±¡å¨æ¹æ³ä¸­è¢«å®ä¹åï¼å®å¯è½è¢«å¤é¨æ¹æ³æå¼ç¨ï¼ä¾å¦ä½ä¸ºè°ç¨åæ°ä¼ éå°å¶ä»å°æ¹ä¸­ï¼ç§°ä¸ºæ¹æ³éé¸ã\n\npublic static StringBuffer craeteStringBuffer(String s1, String s2) {\n    StringBuffer sb = new StringBuffer();\n    sb.append(s1);\n    sb.append(s2);\n    return sb;\n}\n\npublic static String createStringBuffer(String s1, String s2) {\n    StringBuffer sb = new StringBuffer();\n    sb.append(s1);\n    sb.append(s2);\n    return sb.toString();\n}\n\n\nç¬¬ä¸æ®µä»£ç ä¸­çsbå°±éé¸äºï¼èç¬¬äºæ®µä»£ç ä¸­çsbå°±æ²¡æéé¸ã\n\nä½¿ç¨éé¸åæï¼ç¼è¯å¨å¯ä»¥å¯¹ä»£ç åå¦ä¸ä¼åï¼\n\nä¸ãåæ­¥çç¥ãå¦æä¸ä¸ªå¯¹è±¡è¢«åç°åªè½ä»ä¸ä¸ªçº¿ç¨è¢«è®¿é®å°ï¼é£ä¹å¯¹äºè¿ä¸ªå¯¹è±¡çæä½å¯ä»¥ä¸èèåæ­¥ã\n\näºãå°å åéè½¬åä¸ºæ åéãå¦æä¸ä¸ªå¯¹è±¡å¨å­ç¨åºä¸­è¢«åéï¼è¦ä½¿æåè¯¥å¯¹è±¡çæéæ°¸è¿ä¸ä¼éé¸ï¼å¯¹è±¡å¯è½æ¯æ åéçåéï¼èä¸æ¯å åéã\n\nä¸ãåç¦»å¯¹è±¡ææ éæ¿æ¢ãæçå¯¹è±¡å¯è½ä¸éè¦ä½ä¸ºä¸ä¸ªè¿ç»­çåå­ç»æå­å¨ä¹å¯ä»¥è¢«è®¿é®å°ï¼é£ä¹å¯¹è±¡çé¨åï¼æå¨é¨ï¼å¯ä»¥ä¸å­å¨å¨åå­ï¼èæ¯å­å¨å¨CPUå¯å­å¨ä¸­ã\n\nå¨Javaä»£ç è¿è¡æ¶ï¼éè¿JVMåæ°å¯æå®æ¯å¦å¼å¯éé¸åæï¼\n\n-XX:+DoEscapeAnalysis ï¼ è¡¨ç¤ºå¼å¯éé¸åæ\n\n-XX:-DoEscapeAnalysis ï¼ è¡¨ç¤ºå³é­éé¸åæ ä»jdk 1.7å¼å§å·²ç»é»è®¤å¼å§éé¸åæï¼å¦éå³é­ï¼éè¦æå®-XX:-DoEscapeAnalysis\n\n\n# åè\n\nhttps://juejin.cn/post/6844903639308304397",normalizedContent:"# jit\n\nå¨javaçç¼è¯ä½ç³»ä¸­ï¼ä¸ä¸ªjavaçæºä»£ç æä»¶åæè®¡ç®æºå¯æ§è¡çæºå¨æä»¤çè¿ç¨ä¸­ï¼éè¦ç»è¿ä¸¤æ®µç¼è¯ï¼ç¬¬ä¸æ®µæ¯æ.javaæä»¶è½¬æ¢æ.classæä»¶ãç¬¬äºæ®µç¼è¯æ¯æ.classè½¬æ¢ææºå¨æä»¤çè¿ç¨ã\n\nç¬¬ä¸æ®µç¼è¯å°±æ¯javacå½ä»¤ã\n\nå¨ç¬¬äºç¼è¯é¶æ®µï¼jvm éè¿è§£éå­èç å°å¶ç¿»è¯æå¯¹åºçæºå¨æä»¤ï¼éæ¡è¯»å¥ï¼éæ¡è§£éç¿»è¯ãå¾æ¾ç¶ï¼ç»è¿è§£éæ§è¡ï¼å¶æ§è¡éåº¦å¿ç¶ä¼æ¯å¯æ§è¡çäºè¿å¶å­èç ç¨åºæ¢å¾å¤ãè¿å°±æ¯ä¼ ç»çjvmçè§£éå¨ï¼interpreterï¼çåè½ãä¸ºäºè§£å³è¿ç§æçé®é¢ï¼å¼å¥äº jitï¼å³æ¶ç¼è¯ï¼ ææ¯ã\n\nå¼å¥äº jit ææ¯åï¼javaç¨åºè¿æ¯éè¿è§£éå¨è¿è¡è§£éæ§è¡ï¼å½jvmåç°æä¸ªæ¹æ³æä»£ç åè¿è¡ç¹å«é¢ç¹çæ¶åï¼å°±ä¼è®¤ä¸ºè¿æ¯âç­ç¹ä»£ç âï¼hot spot code)ãç¶åjitä¼æé¨åâç­ç¹ä»£ç âç¿»è¯ææ¬å°æºå¨ç¸å³çæºå¨ç ï¼å¹¶è¿è¡ä¼åï¼ç¶ååæç¿»è¯åçæºå¨ç ç¼å­èµ·æ¥ï¼ä»¥å¤ä¸æ¬¡ä½¿ç¨ã\n\n\n# jit ä¼åä¹éé¸åæ\n\njitä¼åä¸­æéè¦çä¸ä¸ªå°±æ¯éé¸åæã\n\néé¸åæçåºæ¬è¡ä¸ºå°±æ¯åæå¯¹è±¡å¨æä½ç¨åï¼å½ä¸ä¸ªå¯¹è±¡å¨æ¹æ³ä¸­è¢«å®ä¹åï¼å®å¯è½è¢«å¤é¨æ¹æ³æå¼ç¨ï¼ä¾å¦ä½ä¸ºè°ç¨åæ°ä¼ éå°å¶ä»å°æ¹ä¸­ï¼ç§°ä¸ºæ¹æ³éé¸ã\n\npublic static stringbuffer craetestringbuffer(string s1, string s2) {\n    stringbuffer sb = new stringbuffer();\n    sb.append(s1);\n    sb.append(s2);\n    return sb;\n}\n\npublic static string createstringbuffer(string s1, string s2) {\n    stringbuffer sb = new stringbuffer();\n    sb.append(s1);\n    sb.append(s2);\n    return sb.tostring();\n}\n\n\nç¬¬ä¸æ®µä»£ç ä¸­çsbå°±éé¸äºï¼èç¬¬äºæ®µä»£ç ä¸­çsbå°±æ²¡æéé¸ã\n\nä½¿ç¨éé¸åæï¼ç¼è¯å¨å¯ä»¥å¯¹ä»£ç åå¦ä¸ä¼åï¼\n\nä¸ãåæ­¥çç¥ãå¦æä¸ä¸ªå¯¹è±¡è¢«åç°åªè½ä»ä¸ä¸ªçº¿ç¨è¢«è®¿é®å°ï¼é£ä¹å¯¹äºè¿ä¸ªå¯¹è±¡çæä½å¯ä»¥ä¸èèåæ­¥ã\n\näºãå°å åéè½¬åä¸ºæ åéãå¦æä¸ä¸ªå¯¹è±¡å¨å­ç¨åºä¸­è¢«åéï¼è¦ä½¿æåè¯¥å¯¹è±¡çæéæ°¸è¿ä¸ä¼éé¸ï¼å¯¹è±¡å¯è½æ¯æ åéçåéï¼èä¸æ¯å åéã\n\nä¸ãåç¦»å¯¹è±¡ææ éæ¿æ¢ãæçå¯¹è±¡å¯è½ä¸éè¦ä½ä¸ºä¸ä¸ªè¿ç»­çåå­ç»æå­å¨ä¹å¯ä»¥è¢«è®¿é®å°ï¼é£ä¹å¯¹è±¡çé¨åï¼æå¨é¨ï¼å¯ä»¥ä¸å­å¨å¨åå­ï¼èæ¯å­å¨å¨cpuå¯å­å¨ä¸­ã\n\nå¨javaä»£ç è¿è¡æ¶ï¼éè¿jvmåæ°å¯æå®æ¯å¦å¼å¯éé¸åæï¼\n\n-xx:+doescapeanalysis ï¼ è¡¨ç¤ºå¼å¯éé¸åæ\n\n-xx:-doescapeanalysis ï¼ è¡¨ç¤ºå³é­éé¸åæ ä»jdk 1.7å¼å§å·²ç»é»è®¤å¼å§éé¸åæï¼å¦éå³é­ï¼éè¦æå®-xx:-doescapeanalysis\n\n\n# åè\n\nhttps://juejin.cn/post/6844903639308304397",charsets:{cjk:!0}},{title:"å­èç å¢å¼ºææ¯",frontmatter:{title:"å­èç å¢å¼ºææ¯",date:"2023-03-19T16:27:47.000Z",permalink:"/pages/9a3179/"},regularPath:"/01.Java/03.JVM/100.%E5%AD%97%E8%8A%82%E7%A0%81%E5%A2%9E%E5%BC%BA%E6%8A%80%E6%9C%AF.html",relativePath:"01.Java/03.JVM/100.å­èç å¢å¼ºææ¯.md",key:"v-63e48439",path:"/pages/9a3179/",headersStr:null,content:"ä¸è¬çå­èç å¢å¼ºææ¯ï¼å¦ASMï¼Javassist åªè½å¨ç±»å è½½åå¯¹ç±»è¿è¡å¼ºåãèéåJVMæä¾ç Instrument ç±»ï¼å¯ä»¥å®ç°å¯¹è¿è¡æ¶çç±»è¿è¡ä¿®æ¹åéè½½ã\n\nåºç¨åºæ¯ï¼\n\n * ç­é¨ç½²ï¼ä¸é¨ç½²æå¡èå¯¹çº¿ä¸æå¡åä¿®æ¹ï¼å¯ä»¥åæç¹ãå¢å æ¥å¿ç­æä½ã\n * Mockï¼æµè¯æ¶åå¯¹æäºæå¡åMockã\n * æ§è½è¯æ­å·¥å·ï¼æ¯å¦bTraceå°±æ¯å©ç¨Instrumentï¼å®ç°æ ä¾µå¥å°è·è¸ªä¸ä¸ªæ­£å¨è¿è¡çJVMï¼çæ§å°ç±»åæ¹æ³çº§å«çç¶æä¿¡æ¯ã\n\nå­èç å¢å¼ºææ¯ç¸å½äºæ¯ä¸ææå¼è¿è¡æ¶JVMçé¥åï¼å©ç¨å®å¯ä»¥å¨æå°å¯¹è¿è¡ä¸­çç¨åºåä¿®æ¹ï¼ä¹å¯ä»¥è·è¸ªJVMè¿è¡ä¸­ç¨åºçç¶æãæ­¤å¤ï¼æä»¬å¹³æ¶ä½¿ç¨çå¨æä»£çãAOPä¹ä¸å­èç å¢å¼ºå¯åç¸å³ï¼å®ä»¬å®è´¨ä¸è¿æ¯å©ç¨åç§ææ®µçæç¬¦åè§èçå­èç æä»¶ãææ¡å­èç å¢å¼ºåå¯ä»¥é«æå°å®ä½å¹¶å¿«éä¿®å¤ä¸äºæ£æçé®é¢ï¼å¦çº¿ä¸æ§è½é®é¢ãæ¹æ³åºç°ä¸å¯æ§çåºå¥åéè¦ç´§æ¥å æ¥å¿ç­é®é¢ï¼ï¼ä¹å¯ä»¥å¨å¼åä¸­åå°åä½ä»£ç ï¼å¤§å¤§æé«å¼åæçã\n\nåèï¼\n\n * https://www.pdai.tech/md/java/jvm/java-jvm-class-enhancer.html#%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E7%9A%84%E9%87%8D%E8%BD%BD",normalizedContent:"ä¸è¬çå­èç å¢å¼ºææ¯ï¼å¦asmï¼javassist åªè½å¨ç±»å è½½åå¯¹ç±»è¿è¡å¼ºåãèéåjvmæä¾ç instrument ç±»ï¼å¯ä»¥å®ç°å¯¹è¿è¡æ¶çç±»è¿è¡ä¿®æ¹åéè½½ã\n\nåºç¨åºæ¯ï¼\n\n * ç­é¨ç½²ï¼ä¸é¨ç½²æå¡èå¯¹çº¿ä¸æå¡åä¿®æ¹ï¼å¯ä»¥åæç¹ãå¢å æ¥å¿ç­æä½ã\n * mockï¼æµè¯æ¶åå¯¹æäºæå¡åmockã\n * æ§è½è¯æ­å·¥å·ï¼æ¯å¦btraceå°±æ¯å©ç¨instrumentï¼å®ç°æ ä¾µå¥å°è·è¸ªä¸ä¸ªæ­£å¨è¿è¡çjvmï¼çæ§å°ç±»åæ¹æ³çº§å«çç¶æä¿¡æ¯ã\n\nå­èç å¢å¼ºææ¯ç¸å½äºæ¯ä¸ææå¼è¿è¡æ¶jvmçé¥åï¼å©ç¨å®å¯ä»¥å¨æå°å¯¹è¿è¡ä¸­çç¨åºåä¿®æ¹ï¼ä¹å¯ä»¥è·è¸ªjvmè¿è¡ä¸­ç¨åºçç¶æãæ­¤å¤ï¼æä»¬å¹³æ¶ä½¿ç¨çå¨æä»£çãaopä¹ä¸å­èç å¢å¼ºå¯åç¸å³ï¼å®ä»¬å®è´¨ä¸è¿æ¯å©ç¨åç§ææ®µçæç¬¦åè§èçå­èç æä»¶ãææ¡å­èç å¢å¼ºåå¯ä»¥é«æå°å®ä½å¹¶å¿«éä¿®å¤ä¸äºæ£æçé®é¢ï¼å¦çº¿ä¸æ§è½é®é¢ãæ¹æ³åºç°ä¸å¯æ§çåºå¥åéè¦ç´§æ¥å æ¥å¿ç­é®é¢ï¼ï¼ä¹å¯ä»¥å¨å¼åä¸­åå°åä½ä»£ç ï¼å¤§å¤§æé«å¼åæçã\n\nåèï¼\n\n * https://www.pdai.tech/md/java/jvm/java-jvm-class-enhancer.html#%e8%bf%90%e8%a1%8c%e6%97%b6%e7%b1%bb%e7%9a%84%e9%87%8d%e8%bd%bd",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ãæ·±å¥çè§£Javaèææº-ç¬¬ä¸çã",frontmatter:{title:"ãæ·±å¥çè§£Javaèææº-ç¬¬ä¸çã",date:"2023-03-31T16:58:30.000Z",permalink:"/pages/9cc971/"},regularPath:"/01.Java/03.JVM/101.%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B.html",relativePath:"01.Java/03.JVM/101.ãæ·±å¥çè§£Javaèææºã.md",key:"v-9f8ccf5e",path:"/pages/9cc971/",headers:[{level:2,title:"ç¼è¯å¨åè§£éå¨",slug:"ç¼è¯å¨åè§£éå¨",normalizedTitle:"ç¼è¯å¨åè§£éå¨",charIndex:2},{level:2,title:"è¿è¡æ¶æ°æ®åº",slug:"è¿è¡æ¶æ°æ®åº",normalizedTitle:"è¿è¡æ¶æ°æ®åº",charIndex:1106},{level:3,title:"ç¨åºè®¡æ°å¨",slug:"ç¨åºè®¡æ°å¨",normalizedTitle:"ç¨åºè®¡æ°å¨",charIndex:1223},{level:3,title:"Javaèææºæ ",slug:"javaèææºæ ",normalizedTitle:"javaèææºæ ",charIndex:1493},{level:3,title:"æ¬å°æ¹æ³æ ",slug:"æ¬å°æ¹æ³æ ",normalizedTitle:"æ¬å°æ¹æ³æ ",charIndex:2180},{level:3,title:"å ",slug:"å ",normalizedTitle:"å ",charIndex:2336},{level:3,title:"æ¹æ³åº",slug:"æ¹æ³åº",normalizedTitle:"æ¹æ³åº",charIndex:3315},{level:3,title:"ç´æ¥åå­",slug:"ç´æ¥åå­",normalizedTitle:"ç´æ¥åå­",charIndex:3370},{level:2,title:"Hotspotèææºå¯¹è±¡æ¢ç§",slug:"hotspotèææºå¯¹è±¡æ¢ç§",normalizedTitle:"hotspotèææºå¯¹è±¡æ¢ç§",charIndex:6368},{level:3,title:"å¯¹è±¡çåå»º",slug:"å¯¹è±¡çåå»º",normalizedTitle:"å¯¹è±¡çåå»º",charIndex:6474},{level:3,title:"å¯¹è±¡çåå­å¸å±",slug:"å¯¹è±¡çåå­å¸å±",normalizedTitle:"å¯¹è±¡çåå­å¸å±",charIndex:7075},{level:3,title:"å¯¹è±¡çè®¿é®å®ä½",slug:"å¯¹è±¡çè®¿é®å®ä½",normalizedTitle:"å¯¹è±¡çè®¿é®å®ä½",charIndex:7491},{level:3,title:"å­ç¬¦ä¸²é®é¢",slug:"å­ç¬¦ä¸²é®é¢",normalizedTitle:"å­ç¬¦ä¸²é®é¢",charIndex:7711},{level:2,title:"OutOfMemoryErrorå¼å¸¸",slug:"outofmemoryerrorå¼å¸¸",normalizedTitle:"outofmemoryerrorå¼å¸¸",charIndex:2014},{level:3,title:"Javaå æº¢åº",slug:"javaå æº¢åº",normalizedTitle:"javaå æº¢åº",charIndex:8869},{level:3,title:"èææºæ ææ¬å°æ¹æ³æ æº¢åº",slug:"èææºæ ææ¬å°æ¹æ³æ æº¢åº",normalizedTitle:"èææºæ ææ¬å°æ¹æ³æ æº¢åº",charIndex:9414},{level:3,title:"æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº",slug:"æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº",normalizedTitle:"æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº",charIndex:10279},{level:3,title:"æ¬æºç´æ¥åå­æº¢åº",slug:"æ¬æºç´æ¥åå­æº¢åº",normalizedTitle:"æ¬æºç´æ¥åå­æº¢åº",charIndex:11129},{level:2,title:"åå¾åæ¶ç®æ³",slug:"åå¾åæ¶ç®æ³",normalizedTitle:"åå¾åæ¶ç®æ³",charIndex:11481},{level:2,title:"å¹¶è¡åå¹¶å",slug:"å¹¶è¡åå¹¶å",normalizedTitle:"å¹¶è¡åå¹¶å",charIndex:11627},{level:2,title:"åå¾åæ¶å¨å¾è§£",slug:"åå¾åæ¶å¨å¾è§£",normalizedTitle:"åå¾åæ¶å¨å¾è§£",charIndex:11768},{level:2,title:"åå¾åæ¶å¨åç±»",slug:"åå¾åæ¶å¨åç±»",normalizedTitle:"åå¾åæ¶å¨åç±»",charIndex:12100},{level:2,title:"é»è®¤åå¾åæ¶å¨ï¼",slug:"é»è®¤åå¾åæ¶å¨",normalizedTitle:"é»è®¤åå¾åæ¶å¨ï¼",charIndex:13171},{level:2,title:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æï¼",slug:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æ",normalizedTitle:"å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æï¼",charIndex:14520},{level:2,title:"å¯ä½ä¸ºGC Rootsçå¯¹è±¡",slug:"å¯ä½ä¸ºgc-rootsçå¯¹è±¡",normalizedTitle:"å¯ä½ä¸ºgc rootsçå¯¹è±¡",charIndex:14735},{level:2,title:"å¼ç¨",slug:"å¼ç¨",normalizedTitle:"å¼ç¨",charIndex:1703},{level:2,title:"å¸¸éæ± çä½ç½®",slug:"å¸¸éæ± çä½ç½®",normalizedTitle:"å¸¸éæ± çä½ç½®",charIndex:16197},{level:2,title:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",slug:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",normalizedTitle:"å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»",charIndex:16575},{level:2,title:"6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·ï¼",slug:"_6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·",normalizedTitle:"6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·ï¼",charIndex:16908},{level:2,title:"4ä¸ªå¸¸ç¨çå¯è§åå·¥å·ï¼",slug:"_4ä¸ªå¸¸ç¨çå¯è§åå·¥å·",normalizedTitle:"4ä¸ªå¸¸ç¨çå¯è§åå·¥å·ï¼",charIndex:17414},{level:2,title:"JMX",slug:"jmx",normalizedTitle:"jmx",charIndex:17596},{level:2,title:"ç±»æä»¶ç»æ",slug:"ç±»æä»¶ç»æ",normalizedTitle:"ç±»æä»¶ç»æ",charIndex:18004},{level:2,title:"èææºç±»å è½½æºå¶",slug:"èææºç±»å è½½æºå¶",normalizedTitle:"èææºç±»å è½½æºå¶",charIndex:18037},{level:2,title:"ç±»å è½½çè¿ç¨",slug:"ç±»å è½½çè¿ç¨",normalizedTitle:"ç±»å è½½çè¿ç¨",charIndex:19005},{level:3,title:"å è½½",slug:"å è½½",normalizedTitle:"å è½½",charIndex:4181},{level:3,title:"éªè¯",slug:"éªè¯",normalizedTitle:"éªè¯",charIndex:18240},{level:3,title:"åå¤",slug:"åå¤",normalizedTitle:"åå¤",charIndex:4878},{level:3,title:"è§£æ",slug:"è§£æ",normalizedTitle:"è§£æ",charIndex:6564},{level:3,title:"åå§å",slug:"åå§å",normalizedTitle:"åå§å",charIndex:6567},{level:2,title:"ç±»å è½½å¨",slug:"ç±»å è½½å¨",normalizedTitle:"ç±»å è½½å¨",charIndex:20518},{level:3,title:"ä¸å±ç±»å è½½å¨",slug:"ä¸å±ç±»å è½½å¨",normalizedTitle:"ä¸å±ç±»å è½½å¨",charIndex:21386},{level:3,title:"åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼",slug:"åäº²å§æ´¾æ¨¡å-parents-delegation-model",normalizedTitle:"åäº²å§æ´¾æ¨¡åï¼parents delegation modelï¼",charIndex:21908},{level:3,title:"Javaæ¨¡ååç³»ç»",slug:"javaæ¨¡ååç³»ç»",normalizedTitle:"javaæ¨¡ååç³»ç»",charIndex:23149},{level:2,title:"ç¡¬ä»¶çæçä¸ä¸è´æ§",slug:"ç¡¬ä»¶çæçä¸ä¸è´æ§",normalizedTitle:"ç¡¬ä»¶çæçä¸ä¸è´æ§",charIndex:23616},{level:2,title:"Javaåå­æ¨¡å",slug:"javaåå­æ¨¡å-2",normalizedTitle:"javaåå­æ¨¡å",charIndex:23603},{level:2,title:"åè¡åçï¼Happens-Beforeï¼åå",slug:"åè¡åç-happens-before-åå",normalizedTitle:"åè¡åçï¼happens-beforeï¼åå",charIndex:24975},{level:2,title:"Java ä¸çº¿ç¨",slug:"java-ä¸çº¿ç¨",normalizedTitle:"java ä¸çº¿ç¨",charIndex:25874},{level:2,title:"Java ä¸åç¨ãä¸æ¯å¾çè§£ã",slug:"java-ä¸åç¨ãä¸æ¯å¾çè§£ã",normalizedTitle:"java ä¸åç¨ãä¸æ¯å¾çè§£ã",charIndex:26121},{level:2,title:"çº¿ç¨å®å¨",slug:"çº¿ç¨å®å¨",normalizedTitle:"çº¿ç¨å®å¨",charIndex:6679},{level:3,title:"äºæ¥åæ­¥ï¼é»å¡åæ­¥ï¼",slug:"äºæ¥åæ­¥-é»å¡åæ­¥",normalizedTitle:"äºæ¥åæ­¥ï¼é»å¡åæ­¥ï¼",charIndex:26810},{level:3,title:"éé»å¡åæ­¥",slug:"éé»å¡åæ­¥",normalizedTitle:"éé»å¡åæ­¥",charIndex:28108},{level:3,title:"æ åæ­¥æ¹æ¡",slug:"æ åæ­¥æ¹æ¡",normalizedTitle:"æ åæ­¥æ¹æ¡",charIndex:29283},{level:2,title:"éä¼å",slug:"éä¼å",normalizedTitle:"éä¼å",charIndex:27756},{level:3,title:"èªæéä¸èªéåºèªæ",slug:"èªæéä¸èªéåºèªæ",normalizedTitle:"èªæéä¸èªéåºèªæ",charIndex:30071},{level:3,title:"éæ¶é¤",slug:"éæ¶é¤",normalizedTitle:"éæ¶é¤",charIndex:29973},{level:3,title:"éç²å",slug:"éç²å",normalizedTitle:"éç²å",charIndex:30763},{level:3,title:"è½»éçº§é",slug:"è½»éçº§é",normalizedTitle:"è½»éçº§é",charIndex:30020},{level:3,title:"ååé",slug:"ååé",normalizedTitle:"ååé",charIndex:7039}],headersStr:"ç¼è¯å¨åè§£éå¨ è¿è¡æ¶æ°æ®åº ç¨åºè®¡æ°å¨ Javaèææºæ  æ¬å°æ¹æ³æ  å  æ¹æ³åº ç´æ¥åå­ Hotspotèææºå¯¹è±¡æ¢ç§ å¯¹è±¡çåå»º å¯¹è±¡çåå­å¸å± å¯¹è±¡çè®¿é®å®ä½ å­ç¬¦ä¸²é®é¢ OutOfMemoryErrorå¼å¸¸ Javaå æº¢åº èææºæ ææ¬å°æ¹æ³æ æº¢åº æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº æ¬æºç´æ¥åå­æº¢åº åå¾åæ¶ç®æ³ å¹¶è¡åå¹¶å åå¾åæ¶å¨å¾è§£ åå¾åæ¶å¨åç±» é»è®¤åå¾åæ¶å¨ï¼ å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æï¼ å¯ä½ä¸ºGC Rootsçå¯¹è±¡ å¼ç¨ å¸¸éæ± çä½ç½® å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±» 6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·ï¼ 4ä¸ªå¸¸ç¨çå¯è§åå·¥å·ï¼ JMX ç±»æä»¶ç»æ èææºç±»å è½½æºå¶ ç±»å è½½çè¿ç¨ å è½½ éªè¯ åå¤ è§£æ åå§å ç±»å è½½å¨ ä¸å±ç±»å è½½å¨ åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼ Javaæ¨¡ååç³»ç» ç¡¬ä»¶çæçä¸ä¸è´æ§ Javaåå­æ¨¡å åè¡åçï¼Happens-Beforeï¼åå Java ä¸çº¿ç¨ Java ä¸åç¨ãä¸æ¯å¾çè§£ã çº¿ç¨å®å¨ äºæ¥åæ­¥ï¼é»å¡åæ­¥ï¼ éé»å¡åæ­¥ æ åæ­¥æ¹æ¡ éä¼å èªæéä¸èªéåºèªæ éæ¶é¤ éç²å è½»éçº§é ååé",content:'# ç¼è¯å¨åè§£éå¨\n\n * ç±»å1ï¼CãC++\n * ç±»å2ï¼JavaScriptãPythonãPHP\n * ç±»å3ï¼Java\n\nå¯¹äºç±»å1ï¼æä»¬ä¸è¬ç§°ä¸ºç¼è¯åè¯­è¨ï¼ä¹å°±æ¯éè¦ç¨å°ç¼è¯å¨è¿è¡ç¼è¯ã\n\nå¯¹äºç±»å2ï¼æä»¬ä¸è¬ç§°ä¸ºè§£éåè¯­è¨ï¼ææ¯èæ¬è¯­è¨ï¼ä¹å°±æ¯è¦ç¨è§£éå¨è¿è¡è§£éã\n\nç¼è¯å¨ä¸è§£éå¨å°±ç±»ä¼¼äºç¬è¯å·¥ä½èä¸å£è¯å·¥ä½èçåºå«ï¼ç¼è¯å¨å°±æ¯ç¬è¯å·¥ä½èï¼èè§£éå¨å°±æ¯å£è¯å·¥ä½èã\n\n * ç¼è¯å¨å¨ç¼è¯çè¿ç¨ä¸­ï¼è¯»å¥æºç¨åºæä»¶ï¼è¾åºä¸ä»½ç­ä»·çäºè¿å¶å¯æ§è¡æä»¶ï¼å°±åç¬è¯å·¥ä½èä¸æ ·ï¼ä»ä»¬é½ä¼è¾åºä¸ä»½ç¿»è¯åçæä»¶ã\n * è§£éå¨å¨è§£éçè¿ç¨ä¸­ï¼è¯»å¥æºç¨åºæä»¶ï¼è¾åºçæ¯æ§è¡çç»æï¼å°±åå£è¯å·¥ä½èä¸æ ·ï¼ä»ä»¬è¾åºçæ¯å·²ç»å®æç¿»è¯çç»æã\n\nè§£éå¨ï¼\n\n * ä¼ç¹ï¼è·¨å¹³å°ãå¯å¨éåº¦å¿«ãå¼åæçé«\n\n * ç¼ºç¹ï¼æ§è¡éåº¦æ¢ï¼æ§è¡æçä½\n\nç¼è¯å¨ï¼\n\n * ä¼ç¹ï¼æ§è¡éåº¦å¿«ãæ§è¡æçé«\n * ç¼ºç¹ï¼å¹³å°ç¸å³æ§é«ï¼ç¼è¯éåº¦ï¼å¯å¨éåº¦ï¼æ¢ï¼å¼åæçä½\n\nJavaæ¢æç¼è¯å¨ï¼ä¸æ­¢ä¸ä¸ªï¼åæè§£éå¨ã\n\nJavaä¸­ç¼è¯å¨æ¯è¾å¤ï¼å®åå«ä¸ä¸ªåç«¯ç¼è¯å¨ï¼ä¸ä¸ªåç«¯ç¼è¯å¨ï¼JITï¼ä»¥åä¸ä¸ªéæé¢ç¼è¯å¨ï¼AOTï¼ã\n\n * åç«¯ç¼è¯å¨çåè½æ¯ä»æºä»£ç çæJavaå­èç ï¼ä¹å°±æ¯ä¸­é´ä»£ç ï¼\n * åç«¯ç¼è¯å¨ï¼ä¹å«ä½å³æ¶ç¼è¯å¨ï¼JITï¼å®æ¯åå«å¨äºJVMä¸­ï¼ç¨äºå¨æ§è¡çè¿ç¨ä¸­ï¼å°ç­ç¹ä»£ç ï¼ä¹å°±æ¯æ§è¡æ¬¡æ°æ¯è¾å¤çä»£ç ï¼è½¬åä¸ºæ¬å°æºå¨ç ï¼å¹¶åä¸äºä¼åï¼ä»¥å éæ§è¡æçã\n * éæé¢ç¼è¯å¨ï¼AOTï¼å®æ¯ç´æ¥å°javaæºä»£ç ç¼è¯ææ¬å°æºå¨ç ï¼ä¹å°±æ¯ä¼ ç»æä¹ä¸çç¼è¯å¨ï¼ä½ç¨çä¸å¤ï¼å ä¸ºè¿æ ·ä¼ä½¿javaçä¸äºç¹æ§ä¸¢å¤±ã\n\nJavaä¸­çè§£éå¨ä¸JITä¸èµ·æåï¼ä½ä¸ºJVMä¸­çæ§è¡å¼æï¼è§£éå¨ä¸»è¦å°å­èç è¿è¡è§£éæ§è¡ï¼åæ¶éåJITè¿è¡ä»£ç çä¼åæä½ã\n\njavaè§£éå¨å°±æ¯æå¨javaèææºä¸è¿è¡çç®æ ä»£ç ï¼å­èç ï¼è§£éæä¸ºå·ä½å¹³å°çæºå¨ç çç¨åºãå³jdkæjreç®å½ä¸binç®å½ä¸­çjava.exeæä»¶ï¼èjavac.exeæ¯ç¼è¯å¨ã\n\nè¿è¡javaç¨åºçè¿ç¨æ¯åç¨javacç¼è¯ï¼ç¶åç¨javaè§£éãèä¸ç»ç¼è¯æååï¼å°±å¯ä»¥ç´æ¥ç¨java.exeéå¤è§£éè¿è¡äºã\n\nJVMè´è´£è¿è¡å­èç ï¼JVMææ¯ä¸æ¡è¦æ§è¡çå­èç äº¤ç»è§£éå¨ï¼ç¿»è¯æå¯¹åºçæºå¨ç ï¼ç¶åç±è§£éå¨æ§è¡ãJVMè§£éæ§è¡å­èç æä»¶å°±æ¯JVMæä½Javaè§£éå¨è¿è¡è§£éæ§è¡å­èç æä»¶çè¿ç¨ã\n\n\n# Javaåå­åºå\n\nJavaææ§å¶åå­çæå©äº¤ç»äºJava èææºï¼ä¸æ¦åºç°åå­æ³æ¼åæº¢åºæ¹é¢çé®é¢ï¼å¦æä¸äºè§£èææºæ¯ææ ·ä½¿ç¨åå­çï¼é£ææ¥éè¯¯ãä¿®æ­£é®é¢å°æä¸ºä¸é¡¹è°é¾çå·¥ä½ã\n\n\n# è¿è¡æ¶æ°æ®åº\n\nãJavaèææºè§èã ï¼âæ¦å¿µæ¨¡åâè¿ä¸ªè¯ä¼ç»å¸¸è¢«æåï¼ å®ä»£è¡¨äºææèææºçç»ä¸å¤è§ï¼ ä½åæ¬¾å·ä½çJavaèææºå¹¶ä¸ ä¸å®è¦å®å¨ç§çæ¦å¿µæ¨¡åçå®ä¹æ¥è¿è¡è®¾è®¡ï¼ å¯è½ä¼éè¿ä¸äºæ´é«æççç­ä»·æ¹å¼å»å®ç°å®ã\n\n\n# ç¨åºè®¡æ°å¨\n\nå½åçº¿ç¨ææ§è¡çå­èç çè¡å·ãå­èç è§£éå¨å°±æ¯éè¿æ¹åè¿ä¸ªè®¡æ°å¨çå¼æ¥éåä¸ä¸æ¡éè¦æ§è¡çå­èç æä»¤ã\n\nç¨åºè®¡æ°å¨ä¸»è¦æä¸¤ä¸ªä½ç¨ï¼\n\n 1. å­èç è§£éå¨éè¿æ¹åç¨åºè®¡æ°å¨æ¥ä¾æ¬¡è¯»åæä»¤ï¼ä»èå®ç°ä»£ç çæµç¨æ§å¶ï¼å¦ï¼é¡ºåºæ§è¡ãéæ©ãå¾ªç¯ãå¼å¸¸å¤çã\n 2. å¨å¤çº¿ç¨çæåµä¸ï¼ç¨åºè®¡æ°å¨ç¨äºè®°å½å½åçº¿ç¨æ§è¡çä½ç½®ï¼ä»èå½çº¿ç¨è¢«åæ¢åæ¥çæ¶åè½å¤ç¥éè¯¥çº¿ç¨ä¸æ¬¡è¿è¡å°åªå¿äºã\n\næ³¨æï¼ç¨åºè®¡æ°å¨æ¯å¯ä¸ä¸ä¸ªä¸ä¼åºç° OutOfMemoryError çåå­åºåï¼å®ççå½å¨æéççº¿ç¨çåå»ºèåå»ºï¼éççº¿ç¨çç»æèæ­»äº¡ã\n\n\n# Javaèææºæ \n\næè¿°çæ¯Javaæ¹æ³æ§è¡ççº¿ç¨åå­æ¨¡åï¼æ¯ä¸ªæ¹æ³è¢«æ§è¡æ¶ï¼Javaèææºé½ä¼åæ­¥åå»ºä¸ä¸ªæ å¸§ï¼Stack Frameï¼ç¨äºå­å¨å±é¨åéè¡¨ãæä½æ°æ ãå¨æè¿æ¥ãæ¹æ³åºå£ç­ä¿¡æ¯ãæ¯ä¸ªæ¹æ³ä»è¢«è°ç¨å°æ§è¡å®æ¯çè¿ç¨ï¼å°±å¯¹åºè¿ä¸ä¸ªæ å¸§å¨èææºæ çå¥æ ååºæ è¿ç¨ã\n\nå±é¨åéè¡¨ä¸»è¦å­æ¾äºç¼è¯æå¯ç¥çåç§æ°æ®ç±»åï¼booleanãbyteãcharãshortãintãfloatãlongãdoubleï¼ãå¯¹è±¡å¼ç¨ï¼reference ç±»åï¼å®ä¸åäºå¯¹è±¡æ¬èº«ï¼å¯è½æ¯ä¸ä¸ªæåå¯¹è±¡èµ·å§å°åçå¼ç¨æéï¼ä¹å¯è½æ¯æåä¸ä¸ªä»£è¡¨å¯¹è±¡çå¥ææå¶ä»ä¸æ­¤å¯¹è±¡ç¸å³çä½ç½®ï¼ã\n\nJava èææºæ ä¼åºç°ä¸¤ç§éè¯¯ï¼StackOverFlowError å OutOfMemoryErrorã\n\n * StackOverFlowErrorï¼ è¥ Java èææºæ çåå­å¤§å°ä¸åè®¸å¨ææ©å±ï¼é£ä¹å½çº¿ç¨è¯·æ±æ çæ·±åº¦è¶è¿å½å Java èææºæ çæå¤§æ·±åº¦çæ¶åï¼å°±æåº StackOverFlowError éè¯¯ã\n * OutOfMemoryErrorï¼ Java èææºæ çåå­å¤§å°å¯ä»¥å¨ææ©å±ï¼ å¦æèææºå¨å¨ææ©å±æ æ¶æ æ³ç³è¯·å°è¶³å¤çåå­ç©ºé´ï¼åæåºOutOfMemoryErrorå¼å¸¸ã\n\nHotSpotèææºçæ å®¹éæ¯ä¸å¯ä»¥å¨ææ©å±çï¼ ä»¥åçClassicèææºåæ¯å¯ä»¥ã æä»¥å¨HotSpotèææºä¸æ¯ä¸ä¼ç±äºèææºæ æ æ³æ©å±èå¯¼è´OutOfMemoryErrorå¼å¸¸ââåªè¦çº¿ç¨ç³è¯·æ ç©ºé´æåäºå°±ä¸ä¼æOOMï¼ ä½æ¯å¦æç³è¯·æ¶å°±å¤±è´¥ï¼ ä»ç¶æ¯ä¼åºç°OOMå¼å¸¸çã\n\n\n# æ¬å°æ¹æ³æ \n\næ¬å°æ¹æ³æ ï¼Native Method Stacksï¼ ä¸èææºæ æåæ¥çä½ç¨æ¯éå¸¸ç¸ä¼¼çï¼ å¶åºå«åªæ¯èææºæ ä¸ºèææºæ§è¡Javaæ¹æ³ï¼ä¹å°±æ¯å­èç ï¼ æå¡ï¼ èæ¬å°æ¹æ³æ åæ¯ä¸ºèææºä½¿ç¨å°çæ¬å°ï¼Nativeï¼æ¹æ³æå¡ã\n\nå¨ HotSpot èææºä¸­å Java èææºæ åäºä¸ºä¸ã\n\n\n# å \n\nJava èææºæç®¡ççåå­ä¸­æå¤§çä¸åï¼Java å æ¯ææçº¿ç¨å±äº«çä¸ååå­åºåï¼å¨èææºå¯å¨æ¶åå»ºãæ­¤åå­åºåçå¯ä¸ç®çå°±æ¯å­æ¾å¯¹è±¡å®ä¾ï¼å ä¹ææçå¯¹è±¡å®ä¾ä»¥åæ°ç»é½å¨è¿éåéåå­ã\n\nJava ä¸çä¸­âå ä¹âææçå¯¹è±¡é½å¨å ä¸­åéï¼ä½æ¯ï¼éç JIT ç¼è¯å¨çåå±ä¸éé¸åæææ¯éæ¸æçï¼æ ä¸åéãæ éæ¿æ¢ä¼åææ¯å°ä¼å¯¼è´ä¸äºå¾®å¦çååï¼ææçå¯¹è±¡é½åéå°å ä¸ä¹æ¸æ¸åå¾ä¸é£ä¹âç»å¯¹âäºãä» JDK 1.7 å¼å§å·²ç»é»è®¤å¼å¯éé¸åæï¼å¦ææäºæ¹æ³ä¸­çå¯¹è±¡å¼ç¨æ²¡æè¢«è¿åæèæªè¢«å¤é¢ä½¿ç¨ï¼ä¹å°±æ¯æªéé¸åºå»ï¼ï¼é£ä¹å¯¹è±¡å¯ä»¥ç´æ¥å¨æ ä¸åéåå­ã\n\nJava å æ¯åå¾æ¶éå¨ç®¡ççä¸»è¦åºåï¼å æ­¤ä¹è¢«ç§°ä½GC å ï¼Garbage Collected Heapï¼ãä»åå¾åæ¶çè§åº¦ï¼ç±äºç°å¨æ¶éå¨åºæ¬é½éç¨åä»£åå¾æ¶éç®æ³ï¼æä»¥ Java å è¿å¯ä»¥ç»åä¸ºï¼æ°çä»£åèå¹´ä»£ï¼åç»è´ä¸ç¹æï¼Eden ç©ºé´ãFrom SurvivorãTo Survivor ç©ºé´ç­ãè¿ä¸æ­¥ååçç®çæ¯æ´å¥½å°åæ¶åå­ï¼æèæ´å¿«å°åéåå­ã\n\nä»åæ¶åå­çè§åº¦çï¼ ç±äºç°ä»£åå¾æ¶éå¨å¤§é¨åé½æ¯åºäºåä»£æ¶éçè®ºè®¾è®¡çï¼ æä»¥Javaå ä¸­ç»å¸¸ä¼åºç°âæ°çä»£ââèå¹´ä»£ââæ°¸ä¹ä»£ââEdenç©ºé´ââFrom Survivorç©ºé´ââTo Survivorç©ºé´âç­åè¯ï¼ è¿äºåºåååä»ä»æ¯ä¸é¨ååå¾æ¶éå¨çå±åç¹æ§æèè¯´è®¾è®¡é£æ ¼èå·²ï¼ èéæä¸ªJavaèææºå·ä½å®ç°çåºæåå­å¸å±ï¼ æ´ä¸æ¯ãJavaèææºè§èã éå¯¹Javaå çè¿ä¸æ­¥ç»è´ååã ä¸å°èµæä¸ç»å¸¸åçç±»ä¼¼äºâJavaèææºçå åå­åä¸ºæ°çä»£ã èå¹´ä»£ã æ°¸ä¹ä»£ã Edenã Survivorâ¦â¦âè¿æ ·çåå®¹ã å¨åå¹´ä¹åï¼ä»¥G1æ¶éå¨çåºç°ä¸ºåçï¼ ï¼ ä½ä¸ºä¸çç»å¯¹ä¸»æµçHotSpotèææºï¼ å®åé¨çåå¾æ¶éå¨å¨é¨é½åºäºâç»å¸åä»£â[3]æ¥è®¾è®¡ï¼ éè¦æ°çä»£ã èå¹´ä»£æ¶éå¨æ­éæè½å·¥ä½ï¼ ä½ç°å¨ä¸å¯åæ¥èè¯­ï¼ä¹åºç°äºä¸éç¨åä»£è®¾è®¡çåå¾åæ¶å¨ã\n\nå¨ JDK 7 çæ¬å JDK 7 çæ¬ä¹åï¼å åå­è¢«éå¸¸åä¸ºä¸é¢ä¸é¨åï¼\n\n 1. æ°çä»£åå­(Young Generation)\n 2. èçä»£(Old Generation)\n 3. æ°¸çä»£(Permanent Generation)\n\nJDK 8 çæ¬ä¹åæ¹æ³åºï¼HotSpot çæ°¸ä¹ä»£ï¼è¢«å½»åºç§»é¤äºï¼JDK1.7 å°±å·²ç»å¼å§äºï¼ï¼åèä»£ä¹æ¯åç©ºé´ï¼åç©ºé´ä½¿ç¨çæ¯ç´æ¥åå­ã\n\nä¸å¾æç¤ºç Eden åºãä¸¤ä¸ª Survivor åºé½å±äºæ°çä»£ï¼ä¸ºäºåºåï¼è¿ä¸¤ä¸ª Survivor åºåæç§é¡ºåºè¢«å½åä¸º from å toï¼ï¼ä¸­é´ä¸å±å±äºèå¹´ä»£ã\n\nå¤§é¨åæåµï¼å¯¹è±¡é½ä¼é¦åå¨ Eden åºååéï¼å¨ä¸æ¬¡æ°çä»£åå¾åæ¶åï¼å¦æå¯¹è±¡è¿å­æ´»ï¼åä¼è¿å¥ s0 æè s1ï¼å¹¶ä¸å¯¹è±¡çå¹´é¾è¿ä¼å  1(Eden åº->Survivor åºåå¯¹è±¡çåå§å¹´é¾åä¸º 1)ï¼å½å®çå¹´é¾å¢å å°ä¸å®ç¨åº¦ï¼é»è®¤ä¸º 15 å²ï¼ï¼å°±ä¼è¢«æåå°èå¹´ä»£ä¸­ãå¯¹è±¡æåå°èå¹´ä»£çå¹´é¾éå¼ï¼å¯ä»¥éè¿åæ° -XX:MaxTenuringThreshold æ¥è®¾ç½®ã\n\nHotspot éåææå¯¹è±¡æ¶ï¼æç§å¹´é¾ä»å°å°å¤§å¯¹å¶æå ç¨çå¤§å°è¿è¡ç´¯ç§¯ï¼å½ç´¯ç§¯çæä¸ªå¹´é¾å¤§å°è¶è¿äº survivor åºçä¸åæ¶ï¼åè¿ä¸ªå¹´é¾å MaxTenuringThreshold ä¸­æ´å°çä¸ä¸ªå¼ï¼ä½ä¸ºæ°çæåå¹´é¾éå¼ã\n\nå è¿éæå®¹æåºç°çå°±æ¯ OutOfMemoryError éè¯¯ï¼å¹¶ä¸åºç°è¿ç§éè¯¯ä¹åçè¡¨ç°å½¢å¼è¿ä¼æå ç§ï¼æ¯å¦ï¼\n\n 1. java.lang.OutOfMemoryError: GC Overhead Limit Exceeded ï¼ å½ JVM è±å¤ªå¤æ¶é´æ§è¡åå¾åæ¶å¹¶ä¸åªè½åæ¶å¾å°çå ç©ºé´æ¶ï¼å°±ä¼åçæ­¤éè¯¯ã\n 2. java.lang.OutOfMemoryError: Java heap space :åå¦å¨åå»ºæ°çå¯¹è±¡æ¶, å åå­ä¸­çç©ºé´ä¸è¶³ä»¥å­æ¾æ°åå»ºçå¯¹è±¡, å°±ä¼å¼åæ­¤éè¯¯ã(åéç½®çæå¤§å åå­æå³ï¼ä¸åå¶äºç©çåå­å¤§å°ãæå¤§å åå­å¯éè¿-Xmxåæ°éç½®ï¼-Xmsè®¾ç½®åå§å åå­ï¼è¥æ²¡æç¹å«éç½®ï¼å°ä¼ä½¿ç¨é»è®¤å¼ï¼è¯¦è§ï¼Default Java 8 max heap size (opens new window))\n\n\n# æ¹æ³åº\n\næ¹æ³åºä¸ Java å ä¸æ ·ï¼æ¯åä¸ªçº¿ç¨å±äº«çåå­åºåï¼å®ç¨äºå­å¨å·²è¢«èææºå è½½çç±»ä¿¡æ¯ãå¸¸éãéæåéãå³æ¶ç¼è¯å¨ç¼è¯åçä»£ç ç­æ°æ®ãè½ç¶ Java èææºè§èææ¹æ³åºæè¿°ä¸ºå çä¸ä¸ªé»è¾é¨åï¼ä½æ¯å®å´æä¸ä¸ªå«åå«å Non-Heapï¼éå ï¼ï¼ç®çåºè¯¥æ¯ä¸ Java å åºåå¼æ¥ã\n\nè¯´å°æ¹æ³åºï¼ ä¸å¾ä¸æä¸ä¸âæ°¸ä¹ä»£âè¿ä¸ªæ¦å¿µï¼ å°¤å¶æ¯å¨JDK 8ä»¥åï¼ è®¸å¤Javaç¨åºåé½ä¹ æ¯å¨HotSpotèææºä¸å¼åã é¨ç½²ç¨åºï¼ å¾å¤äººé½æ´æ¿æææ¹æ³åºç§°å¼ä¸ºâæ°¸ä¹ä»£âï¼Permanent Generationï¼ ï¼ æå°ä¸¤èæ··ä¸ºä¸è°ã æ¬è´¨ä¸è¿ä¸¤èå¹¶ä¸æ¯ç­ä»·çï¼ å ä¸ºä»ä»æ¯å½æ¶çHotSpotèææºè®¾è®¡å¢ééæ©ææ¶éå¨çåä»£è®¾è®¡æ©å±è³æ¹æ³åºï¼ æèè¯´ä½¿ç¨æ°¸ä¹ä»£æ¥å®ç°æ¹æ³åºèå·²ï¼ è¿æ ·ä½¿å¾HotSpotçåå¾æ¶éå¨è½å¤åç®¡çJavaå ä¸æ ·ç®¡çè¿é¨ååå­ï¼ çå»ä¸é¨ä¸ºæ¹æ³åºç¼ååå­ç®¡çä»£ç çå·¥ä½ã ä½æ¯å¯¹äºå¶ä»èææºå®ç°ï¼ è­¬å¦BEA JRockitã IBM J9ç­æ¥è¯´ï¼ æ¯ä¸å­å¨æ°¸ä¹ä»£çæ¦å¿µçã ååä¸å¦ä½å®ç°æ¹æ³åºå±äºèææºå®ç°ç»èï¼ ä¸åãJavaèææºè§èã ç®¡æï¼ å¹¶ä¸è¦æ±ç»ä¸ã ä½ç°å¨åå¤´æ¥çï¼ å½å¹´ä½¿ç¨æ°¸ä¹ä»£æ¥å®ç°æ¹æ³åºçå³å®å¹¶ä¸æ¯ä¸ä¸ªå¥½ä¸»æï¼ è¿ç§è®¾è®¡å¯¼è´äºJavaåºç¨æ´å®¹æéå°åå­æº¢åºçé®é¢ï¼æ°¸ä¹ä»£æ-XXï¼ MaxPermSizeçä¸éï¼ å³ä½¿ä¸è®¾ç½®ä¹æé»è®¤å¤§å°ï¼ èJ9åJRockitåªè¦æ²¡æè§¦ç¢°å°è¿ç¨å¯ç¨åå­çä¸éï¼ ä¾å¦32ä½ç³»ç»ä¸­ç4GBéå¶ï¼ å°±ä¸ä¼åºé®é¢ï¼ ï¼ èä¸ææå°æ°æ¹æ³ï¼ä¾å¦String::intern()ï¼ ä¼å æ°¸ä¹ä»£çåå èå¯¼è´ä¸åèææºä¸æä¸åçè¡¨ç°ã å½Oracleæ¶è´­BEAè·å¾äºJRockitçæææåï¼ åå¤æJRockitä¸­çä¼ç§åè½ï¼ è­¬å¦Java Mission Controlç®¡çå·¥å·ï¼ ç§»æ¤å°HotSpotèææºæ¶ï¼ ä½å ä¸ºä¸¤èå¯¹æ¹æ³åºå®ç°çå·®å¼èé¢ä¸´è¯¸å¤å°é¾ã\n\nèèå°HotSpotæªæ¥çåå±ï¼ å¨JDK 6çæ¶åHotSpotå¼åå¢éå°±ææ¾å¼æ°¸ä¹ä»£ï¼ éæ­¥æ¹ä¸ºéç¨æ¬å°åå­ï¼Native Memoryï¼ æ¥å®ç°æ¹æ³åºçè®¡åäº[1]ï¼ å°äºJDK 7çHotSpotï¼ å·²ç»æåæ¬æ¾å¨æ°¸ä¹ä»£çå­ç¬¦ä¸²å¸¸éæ± ã éæåéç­ç§»åºï¼ èå°äºJDK 8ï¼ ç»äºå®å¨åºå¼äºæ°¸ä¹ä»£çæ¦å¿µï¼ æ¹ç¨ä¸JRockitã J9ä¸æ ·å¨æ¬å°åå­ä¸­å®ç°çåç©ºé´ï¼Metaspaceï¼ æ¥ä»£æ¿ï¼ æJDK 7ä¸­æ°¸ä¹ä»£è¿å©ä½çåå®¹ï¼ä¸»è¦æ¯ç±»åä¿¡æ¯ï¼ å¨é¨ç§»å°åç©ºé´ä¸­ã\n\n//JDK 1.8 ä¹åæ°¸ä¹ä»£è¿æ²¡è¢«å½»åºç§»é¤çæ¶åéå¸¸éè¿ä¸é¢è¿äºåæ°æ¥è°èæ¹æ³åºå¤§å°\n-XX:PermSize=N //æ¹æ³åº (æ°¸ä¹ä»£) åå§å¤§å°\n-XX:MaxPermSize=N //æ¹æ³åº (æ°¸ä¹ä»£) æå¤§å¤§å°,è¶è¿è¿ä¸ªå¼å°ä¼æåº OutOfMemoryError å¼å¸¸:java.lang.OutOfMemoryError: PermGen\n\n\nJDK 1.8 çæ¶åï¼æ¹æ³åºï¼HotSpot çæ°¸ä¹ä»£ï¼è¢«å½»åºç§»é¤äºï¼JDK1.7 å°±å·²ç»å¼å§äºï¼ï¼åèä»£ä¹æ¯åç©ºé´ï¼åç©ºé´ä½¿ç¨çæ¯ç´æ¥åå­ã\n\n//ä¸äºå¸¸ç¨åæ°ï¼\n-XX:MetaspaceSize=N //è®¾ç½® Metaspace çåå§ï¼åæå°å¤§å°ï¼\n-XX:MaxMetaspaceSize=N //è®¾ç½® Metaspace çæå¤§å¤§å°\n\n\nä¸æ°¸ä¹ä»£å¾å¤§çä¸åå°±æ¯ï¼å¦æä¸æå®å¤§å°çè¯ï¼éçæ´å¤ç±»çåå»ºï¼èææºä¼èå°½ææå¯ç¨çç³»ç»åå­ã\n\nè¿è¡æ¶å¸¸éæ± æ¯æ¹æ³åºçä¸é¨åãClass æä»¶ä¸­é¤äºæç±»ççæ¬ãå­æ®µãæ¹æ³ãæ¥å£ç­æè¿°ä¿¡æ¯å¤ï¼è¿æå¸¸éæ± è¡¨ï¼ç¨äºå­æ¾ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼ãæ¢ç¶è¿è¡æ¶å¸¸éæ± æ¯æ¹æ³åºçä¸é¨åï¼èªç¶åå°æ¹æ³åºåå­çéå¶ï¼å½å¸¸éæ± æ æ³åç³è¯·å°åå­æ¶ä¼æåº OutOfMemoryError éè¯¯ã\n\nJDK1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\nJDK1.7å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ã\n\nJDK1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(Metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(Metaspace)ã\n\n\n# ç´æ¥åå­\n\nç´æ¥åå­å¹¶ä¸æ¯èææºè¿è¡æ¶æ°æ®åºçä¸é¨åï¼ä¹ä¸æ¯èææºè§èä¸­å®ä¹çåå­åºåï¼ä½æ¯è¿é¨ååå­ä¹è¢«é¢ç¹å°ä½¿ç¨ãèä¸ä¹å¯è½å¯¼è´ OutOfMemoryError éè¯¯åºç°ã\n\nJDK1.4 ä¸­æ°å å¥ç NIO(New Input/Output) ç±»ï¼å¼å¥äºä¸ç§åºäºééï¼Channelï¼ä¸ç¼å­åºï¼Bufferï¼ç I/O æ¹å¼ï¼å®å¯ä»¥ç´æ¥ä½¿ç¨ Native å½æ°åºç´æ¥åéå å¤åå­ï¼ç¶åéè¿ä¸ä¸ªå­å¨å¨ Java å ä¸­ç DirectByteBuffer å¯¹è±¡ä½ä¸ºè¿ååå­çå¼ç¨è¿è¡æä½ãè¿æ ·å°±è½å¨ä¸äºåºæ¯ä¸­æ¾èæé«æ§è½ï¼å ä¸ºé¿åäºå¨ Java å å Native å ä¹é´æ¥åå¤å¶æ°æ®ã\n\næ¬æºç´æ¥åå­çåéä¸ä¼åå° Java å çéå¶ï¼ä½æ¯ï¼æ¢ç¶æ¯åå­å°±ä¼åå°æ¬æºæ»åå­å¤§å°ä»¥åå¤çå¨å¯»åç©ºé´çéå¶ã\n\n\n# Hotspotèææºå¯¹è±¡æ¢ç§\n\n> åºäºå®ç¨ä¼åçååï¼ ä»¥æå¸¸ç¨çèææºHotSpotåæå¸¸ç¨çåå­åºåJavaå ä¸ºä¾ï¼ æ·±å¥æ¢è®¨ä¸ä¸HotSpotèææºå¨Javaå ä¸­å¯¹è±¡åéã å¸å±åè®¿é®çå¨è¿ç¨ã\n\n\n# å¯¹è±¡çåå»º\n\n\n\n 1. ç±»å è½½æ£æ¥ï¼èææºéå°ä¸æ¡ new æä»¤æ¶ï¼é¦åå°å»æ£æ¥è¿ä¸ªæä»¤çåæ°æ¯å¦è½å¨å¸¸éæ± ä¸­å®ä½å°è¿ä¸ªç±»çç¬¦å·å¼ç¨ï¼å¹¶ä¸æ£æ¥è¿ä¸ªç¬¦å·å¼ç¨ä»£è¡¨çç±»æ¯å¦å·²è¢«å è½½è¿ãè§£æååå§åè¿ãå¦ææ²¡æï¼é£å¿é¡»åæ§è¡ç¸åºçç±»å è½½è¿ç¨ã\n 2. åéåå­ï¼\n    1. åéæ¹å¼ï¼æâæéç¢°æâåâç©ºé²åè¡¨âä¸¤ç§ï¼åå³äºJavaå æ¯å¦è§æ´ï¼è¿åç±åå¾åæ¶å¨æ¯å¦å¸¦æåç¼©æ´çåè½å³å®ã\n    2. èææºä¿è¯çº¿ç¨å®å¨ï¼\n       1. CAS+å¤±è´¥éè¯ï¼ CAS æ¯ä¹è§éçä¸ç§å®ç°æ¹å¼ãæè°ä¹è§éå°±æ¯ï¼æ¯æ¬¡ä¸å éèæ¯åè®¾æ²¡æå²çªèå»å®ææé¡¹æä½ï¼å¦æå ä¸ºå²çªå¤±è´¥å°±éè¯ï¼ç´å°æåä¸ºæ­¢ãèææºéç¨ CAS éä¸å¤±è´¥éè¯çæ¹å¼ä¿è¯æ´æ°æä½çåå­æ§ã\n       2. TLABï¼æ¬å°çº¿ç¨åéç¼å­ï¼ï¼ ä¸ºæ¯ä¸ä¸ªçº¿ç¨é¢åå¨ Eden åºåéä¸åå¿åå­ï¼JVM å¨ç»çº¿ç¨ä¸­çå¯¹è±¡åéåå­æ¶ï¼é¦åå¨ TLAB åéï¼å½å¯¹è±¡å¤§äº TLAB ä¸­çå©ä½åå­æ TLAB çåå­å·²ç¨å°½æ¶ï¼åéç¨ä¸è¿°ç CAS è¿è¡åå­åéã\n 3. åå§åé¶å¼\n 4. è®¾ç½®å¯¹è±¡å¤´ï¼ä¾å¦è¿ä¸ªå¯¹è±¡æ¯åªä¸ªç±»çå®ä¾ãå¦ä½æè½æ¾å°ç±»çåæ°æ®ä¿¡æ¯ãå¯¹è±¡çåå¸ç ãå¯¹è±¡ç GC åä»£å¹´é¾ç­ä¿¡æ¯ã è¿äºä¿¡æ¯å­æ¾å¨å¯¹è±¡å¤´ä¸­ã å¦å¤ï¼æ ¹æ®èææºå½åè¿è¡ç¶æçä¸åï¼å¦æ¯å¦å¯ç¨ååéç­ï¼å¯¹è±¡å¤´ä¼æä¸åçè®¾ç½®æ¹å¼ã\n 5. æ§è¡initæ¹æ³\n\n\n# å¯¹è±¡çåå­å¸å±\n\nå¨HotSpotèææºä¸­ï¼å¯¹è±¡å¨å åå­ä¸­çå­å¨å¸å±å¯ä»¥åä¸ºä¸ä¸ªé¨åï¼å¯¹è±¡å¤´ãå®ä¾æ°æ®åå¯¹é½å¡«åã\n\nHotspot èææºçå¯¹è±¡å¤´åæ¬ä¸¤é¨åä¿¡æ¯ï¼ç¬¬ä¸é¨åç¨äºå­å¨å¯¹è±¡èªèº«çè¿è¡æ¶æ°æ®ï¼åå¸ç ãGC åä»£å¹´é¾ãéç¶ææ å¿ãçº¿ç¨ææçéãååçº¿ç¨IDãååæ¶é´æ³ç­ç­ï¼ï¼å®æ¹ç§°ä¸ºâMark Wordâãå¦ä¸é¨åæ¯ç±»åæéï¼å³å¯¹è±¡æåå®çç±»åæ°æ®çæéï¼èææºéè¿è¿ä¸ªæéæ¥ç¡®å®è¿ä¸ªå¯¹è±¡æ¯é£ä¸ªç±»çå®ä¾ã\n\nå®ä¾æ°æ®é¨åæ¯å¯¹è±¡çæ­£å­å¨çææä¿¡æ¯ï¼ä¹æ¯å¨ç¨åºä¸­æå®ä¹çåç§ç±»åçå­æ®µåå®¹ã\n\nå¯¹é½å¡«åé¨åä¸æ¯å¿ç¶å­å¨çï¼ä¹æ²¡æä»ä¹ç¹å«çå«ä¹ï¼ä»ä»èµ·å ä½ä½ç¨ã å ä¸º Hotspot èææºçèªå¨åå­ç®¡çç³»ç»è¦æ±å¯¹è±¡èµ·å§å°åå¿é¡»æ¯ 8 å­èçæ´æ°åï¼æ¢å¥è¯è¯´å°±æ¯å¯¹è±¡çå¤§å°å¿é¡»æ¯ 8 å­èçæ´æ°åãèå¯¹è±¡å¤´é¨åæ­£å¥½æ¯ 8 å­èçåæ°ï¼1 åæ 2 åï¼ï¼å æ­¤ï¼å½å¯¹è±¡å®ä¾æ°æ®é¨åæ²¡æå¯¹é½æ¶ï¼å°±éè¦éè¿å¯¹é½å¡«åæ¥è¡¥å¨ã\n\n\n# å¯¹è±¡çè®¿é®å®ä½\n\nJavaç¨åºä¼éè¿æ ä¸referenceæ°æ®æ¥æä½å ä¸çå·ä½å¯¹è±¡ã\n\nå¯¹è±¡çè®¿é®æ¹å¼ç±èææºçå®ç°å³å®ï¼ä¸»æµçè®¿é®æ¹å¼ä¸»è¦æä½¿ç¨å¥æåç´æ¥æéä¸¤ç§ã\n\nè¿ä¸¤ç§å¯¹è±¡è®¿é®æ¹å¼åæä¼å¿ãä½¿ç¨å¥ææ¥è®¿é®çæå¤§å¥½å¤æ¯ reference ä¸­å­å¨çæ¯ç¨³å®çå¥æå°åï¼å¨å¯¹è±¡è¢«ç§»å¨æ¶åªä¼æ¹åå¥æä¸­çå®ä¾æ°æ®æéï¼è reference æ¬èº«ä¸éè¦ä¿®æ¹ãä½¿ç¨ç´æ¥æéè®¿é®æ¹å¼æå¤§çå¥½å¤å°±æ¯éåº¦å¿«ï¼å®èçäºä¸æ¬¡æéå®ä½çæ¶é´å¼éã\n\n\n# å­ç¬¦ä¸²é®é¢\n\n * ç´æ¥ä½¿ç¨åå¼å·å£°æåºæ¥çStringå¯¹è±¡ä¼ç´æ¥å­å¨å¨å¸¸éæ± ä¸­ã\n * å¦æä¸æ¯ç¨åå¼å·å£°æçStringå¯¹è±¡ï¼å¯ä»¥ä½¿ç¨Stringæä¾çinternæ¹æ³ãintern æ¹æ³ä¼ä»å­ç¬¦ä¸²å¸¸éæ± ä¸­æ¥è¯¢å½åå­ç¬¦ä¸²æ¯å¦å­å¨ï¼è¥ä¸å­å¨å°±ä¼å°å½åå­ç¬¦ä¸²æ¾å¥å¸¸éæ± ä¸­ã\n * ï¼String.intern() æ¯ä¸ä¸ª Native æ¹æ³ï¼å®çä½ç¨æ¯ï¼å¦æè¿è¡æ¶å¸¸éæ± ä¸­å·²ç»åå«ä¸ä¸ªç­äºæ­¤ String å¯¹è±¡åå®¹çå­ç¬¦ä¸²ï¼åè¿åå¸¸éæ± ä¸­è¯¥å­ç¬¦ä¸²çå¼ç¨ï¼å¦ææ²¡æï¼JDK1.7 ä¹åï¼ä¸åå« 1.7ï¼çå¤çæ¹å¼æ¯å¨å¸¸éæ± ä¸­åå»ºä¸æ­¤ String åå®¹ç¸åçå­ç¬¦ä¸²ï¼å¹¶è¿åå¸¸éæ± ä¸­åå»ºçå­ç¬¦ä¸²çå¼ç¨ï¼JDK1.7 ä»¥åä¹åï¼å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­ï¼jvm ä¸ä¼å¨å¸¸éæ± ä¸­åå»ºè¯¥å¯¹è±¡ï¼èæ¯å°å ä¸­è¿ä¸ªå¯¹è±¡çå¼ç¨ç´æ¥æ¾å°å¸¸éæ± ä¸­ï¼åå°ä¸å¿è¦çåå­å¼éãï¼\n\nå¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¼ãå¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\nå¨ç¼è¯è¿ç¨ä¸­ï¼Javac ç¼è¯å¨ä¼è¿è¡ä¸ä¸ªå«å å¸¸éæå (Constant Folding) çä»£ç ä¼åãå¸¸éæå ä¼æå¸¸éè¡¨è¾¾å¼çå¼æ±åºæ¥ä½ä¸ºå¸¸éåµå¨æç»çæçä»£ç ä¸­ï¼è¿æ¯ Javac ç¼è¯å¨ä¼å¯¹æºä»£ç åçæå°éä¼åæªæ½ä¹ä¸(ä»£ç ä¼åå ä¹é½å¨å³æ¶ç¼è¯å¨ä¸­è¿è¡)ã\n\nä¸è¬æ¥è¯´ï¼æä»¬è¦å°½éé¿åéè¿ new çæ¹å¼åå»ºå­ç¬¦ä¸²ãä½¿ç¨åå¼å·å£°æç String å¯¹è±¡ï¼ String s1 = "java" ï¼æ´å©äºè®©ç¼è¯å¨ææºä¼ä¼åæä»¬çä»£ç ï¼åæ¶ä¹æ´æäºéè¯»ã\n\nè¢« final å³é®å­ä¿®æ¹ä¹åç String ä¼è¢«ç¼è¯å¨å½åå¸¸éæ¥å¤çï¼ç¼è¯å¨ç¨åºç¼è¯æå°±å¯ä»¥ç¡®å®å®çå¼ï¼å¶ææå°±æ³å°äºè®¿é®å¸¸éã\n\nString s1 = new String("abc");è¿å¥è¯åå»ºäºå ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼\n\nä¼åå»º 1 æ 2 ä¸ªå­ç¬¦ä¸²ï¼\n\n * å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­å·²å­å¨å­ç¬¦ä¸²å¸¸éâabcâï¼ååªä¼å¨å ç©ºé´åå»ºä¸ä¸ªå­ç¬¦ä¸²å¸¸éâabcâã\n * å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­æ²¡æå­ç¬¦ä¸²å¸¸éâabcâï¼é£ä¹å®å°é¦åå¨å­ç¬¦ä¸²å¸¸éæ± ä¸­åå»ºï¼ç¶åå¨å ç©ºé´ä¸­åå»ºï¼å æ­¤å°åå»ºæ»å± 2 ä¸ªå­ç¬¦ä¸²å¯¹è±¡ã\n\nJava åºæ¬ç±»åçåè£ç±»çå¤§é¨åé½å®ç°äºå¸¸éæ± ææ¯ã\n\nByte,Short,Integer,Long è¿ 4 ç§åè£ç±»é»è®¤åå»ºäºæ°å¼ [-128ï¼127] çç¸åºç±»åçç¼å­æ°æ®ï¼Character åå»ºäºæ°å¼å¨ [0,127] èå´çç¼å­æ°æ®ï¼Boolean ç´æ¥è¿å True Or Falseã\n\nä¸¤ç§æµ®ç¹æ°ç±»åçåè£ç±» Float,Double å¹¶æ²¡æå®ç°å¸¸éæ± ææ¯ã\n\nè®°ä½ï¼æææ´ååè£ç±»å¯¹è±¡ä¹é´å¼çæ¯è¾ï¼å¨é¨ä½¿ç¨ equals æ¹æ³æ¯è¾ã\n\n\n# OutOfMemoryErrorå¼å¸¸\n\n\n# Javaå æº¢åº\n\nå°å çæå°å¼-Xmsåæ°ä¸æå¤§å¼-Xmxåæ°è®¾ç½®ä¸ºä¸æ ·çè¯å¯é¿åå èªå¨æ©å±ï¼å³è®¾ç½®ä¸ºä¸å¯æ©å±ã\n\nè¦è§£å³è¿ä¸ªåå­åºåçå¼å¸¸ï¼ å¸¸è§çå¤çæ¹æ³æ¯é¦åéè¿åå­æ ååæå·¥å·ï¼å¦Eclipse Memory Analyzerï¼ å¯¹Dumpåºæ¥çå è½¬å¨å¿«ç§è¿è¡åæã ç¬¬ä¸æ­¥é¦ååºç¡®è®¤åå­ä¸­å¯¼è´OOMçå¯¹è±¡æ¯å¦æ¯å¿è¦çï¼ ä¹å°±æ¯è¦ååæ¸æ¥å°åºæ¯åºç°äºåå­æ³æ¼ï¼Memory Leakï¼ è¿æ¯åå­æº¢åºï¼Memory Overflowï¼ ã\n\nå¦ææ¯åå­æ³æ¼ï¼ å¯è¿ä¸æ­¥éè¿å·¥å·æ¥çæ³æ¼å¯¹è±¡å°GC Rootsçå¼ç¨é¾ï¼ æ¾å°æ³æ¼å¯¹è±¡æ¯éè¿ææ ·çå¼ç¨è·¯å¾ã ä¸åªäºGC Rootsç¸å³èï¼ æå¯¼è´åå¾æ¶éå¨æ æ³åæ¶å®ä»¬ï¼ æ ¹æ®æ³æ¼å¯¹è±¡çç±»åä¿¡æ¯ä»¥åå®å°GC Rootså¼ç¨é¾çä¿¡æ¯ï¼ ä¸è¬å¯ä»¥æ¯è¾åç¡®å°å®ä½å°è¿äºå¯¹è±¡åå»ºçä½ç½®ï¼ è¿èæ¾åºäº§çåå­æ³æ¼çä»£ç çå·ä½ä½ç½®ã\n\nå¦æä¸æ¯åå­æ³æ¼ï¼ æ¢å¥è¯è¯´å°±æ¯åå­ä¸­çå¯¹è±¡ç¡®å®é½æ¯å¿é¡»å­æ´»çï¼ é£å°±åºå½æ£æ¥Javaèææºçå åæ°ï¼-Xmxä¸-Xmsï¼ è®¾ç½®ï¼ ä¸æºå¨çåå­å¯¹æ¯ï¼ ççæ¯å¦è¿æåä¸è°æ´çç©ºé´ã åä»ä»£ç ä¸æ£æ¥æ¯å¦å­å¨æäºå¯¹è±¡çå½å¨æè¿é¿ã ææç¶ææ¶é´è¿é¿ã å­å¨ç»æè®¾è®¡ä¸åçç­æåµï¼ å°½éåå°ç¨åºè¿è¡æçåå­æ¶èã\n\n\n# èææºæ ææ¬å°æ¹æ³æ æº¢åº\n\nç±äºHotSpotèææºå¹¶ä¸åºåèææºæ åæ¬å°æ¹æ³æ ï¼æä»¥æ å®¹éåªç± -Xssåæ°å³å®ã\n\nå³äºèææºæ åæ¬å°æ¹æ³æ ï¼ å¨ãJavaèææºè§èã ä¸­æè¿°äºä¸¤ç§å¼å¸¸ï¼\n\n 1. å¦æçº¿ç¨è¯·æ±çæ æ·±åº¦å¤§äºèææºæåè®¸çæå¤§æ·±åº¦ï¼ å°æåºStackOverflowErrorå¼å¸¸ã\n 2. å¦æèææºçæ åå­åè®¸å¨ææ©å±ï¼ å½æ©å±æ å®¹éæ æ³ç³è¯·å°è¶³å¤çåå­æ¶ï¼ å°æåºOutOfMemoryErrorå¼å¸¸ã\n\nãJavaèææºè§èã æç¡®åè®¸Javaèææºå®ç°èªè¡éæ©æ¯å¦æ¯ææ çå¨ææ©å±ï¼ èHotSpotèææºçéæ©æ¯ä¸æ¯ææ©å±ï¼ æä»¥é¤éå¨åå»ºçº¿ç¨ç³è¯·åå­æ¶å°±å æ æ³è·å¾è¶³å¤åå­èåºç°OutOfMemoryErrorå¼å¸¸ï¼ å¦åå¨çº¿ç¨è¿è¡æ¶æ¯ä¸ä¼å ä¸ºæ©å±èå¯¼è´åå­æº¢åºçï¼ åªä¼å ä¸ºæ å®¹éæ æ³å®¹çº³æ°çæ å¸§èå¯¼è´StackOverflowErrorå¼å¸¸ã\n\nåºç°StackOverflowErrorå¼å¸¸æ¶ï¼ ä¼ææç¡®éè¯¯å æ å¯ä¾åæï¼ ç¸å¯¹èè¨æ¯è¾å®¹æå®ä½å°é®é¢æå¨ã å¦æä½¿ç¨HotSpotèææºé»è®¤åæ°ï¼ æ æ·±åº¦å¨å¤§å¤æ°æåµä¸ï¼å ä¸ºæ¯ä¸ªæ¹æ³åå¥æ çå¸§å¤§å°å¹¶ä¸æ¯ä¸æ ·çï¼ æä»¥åªè½è¯´å¤§å¤æ°æåµä¸ï¼ å°è¾¾1000~2000æ¯å®å¨æ²¡æé®é¢ï¼ å¯¹äºæ­£å¸¸çæ¹æ³è°ç¨ï¼åæ¬ä¸è½åå°¾éå½ä¼åçéå½è°ç¨ï¼ ï¼è¿ä¸ªæ·±åº¦åºè¯¥å®å¨å¤ç¨äºã\n\nä½æ¯ï¼ å¦ææ¯å»ºç«è¿å¤çº¿ç¨å¯¼è´çåå­æº¢åºï¼ å¨ä¸è½åå°çº¿ç¨æ°éæèæ´æ¢64ä½èææºçæåµä¸ï¼ å°±åªè½éè¿åå°æå¤§å ååå°æ å®¹éæ¥æ¢åæ´å¤ççº¿ç¨ã è¿ç§éè¿âåå°åå­âçææ®µæ¥è§£å³åå­æº¢åºçæ¹å¼ï¼ å¦ææ²¡æè¿æ¹é¢å¤çç»éªï¼ ä¸è¬æ¯è¾é¾ä»¥æ³å°ï¼ è¿ä¸ç¹è¯»èéè¦å¨å¼å32ä½ç³»ç»çå¤çº¿ç¨åºç¨æ¶æ³¨æã ä¹æ¯ç±äºè¿ç§é®é¢è¾ä¸ºéè½ï¼ ä»JDK 7èµ·ï¼ ä»¥ä¸æç¤ºä¿¡æ¯ä¸­âunable to create native threadâåé¢ï¼ èææºä¼ç¹å«æ³¨æåå å¯è½æ¯âpossiblyout of memory or process/resource limits reachedâã\n\n\n# æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº\n\nä»¥ä¸é¢çä¾å­ä¸ºä¾ï¼\n\nString::intern()æ¯ä¸ä¸ªæ¬å°æ¹æ³ï¼ å®çä½ç¨æ¯å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­å·²ç»åå«ä¸ä¸ªç­äºæ­¤Stringå¯¹è±¡çå­ç¬¦ä¸²ï¼ åè¿åä»£è¡¨æ± ä¸­è¿ä¸ªå­ç¬¦ä¸²çStringå¯¹è±¡çå¼ç¨ï¼ å¦åï¼ ä¼å°æ­¤Stringå¯¹è±¡åå«çå­ç¬¦ä¸²æ·»å å°å¸¸éæ± ä¸­ï¼ å¹¶ä¸è¿åæ­¤Stringå¯¹è±¡çå¼ç¨ã\n\nèªJDK 7èµ·ï¼ åæ¬å­æ¾å¨æ°¸ä¹ä»£çå­ç¬¦ä¸²å¸¸éæ± è¢«ç§»è³Javaå ä¹ä¸­ã\n\nå½åçå¾å¤ä¸»æµæ¡æ¶ï¼ å¦Springã Hibernateå¯¹ç±»è¿è¡å¢å¼ºæ¶ï¼ é½ä¼ä½¿ç¨å°CGLibè¿ç±»å­èç ææ¯ï¼ å½å¢å¼ºçç±»è¶å¤ï¼ å°±éè¦è¶å¤§çæ¹æ³åºä»¥ä¿è¯å¨æçæçæ°ç±»åå¯ä»¥è½½å¥åå­ã\n\næ¹æ³åºæº¢åºä¹æ¯ä¸ç§å¸¸è§çåå­æº¢åºå¼å¸¸ï¼ ä¸ä¸ªç±»å¦æè¦è¢«åå¾æ¶éå¨åæ¶ï¼ è¦è¾¾æçæ¡ä»¶æ¯æ¯è¾èå»çã\n\nå¨JDK 8ä»¥åï¼ æ°¸ä¹ä»£ä¾¿å®å¨éåºäºåå²èå°ï¼ åç©ºé´ä½ä¸ºå¶æ¿ä»£èç»åºã å¨é»è®¤è®¾ç½®ä¸ï¼ æ­£å¸¸çå¨æåå»ºæ°ç±»åå·²ç»å¾é¾åè¿«ä½¿èææºäº§çæ¹æ³åºçæº¢åºå¼å¸¸äºã ä¸è¿ä¸ºäºè®©ä½¿ç¨èæé¢é²å®éåºç¨éåºç°çç ´åæ§çæä½ï¼ HotSpotè¿æ¯æä¾äºä¸äºåæ°ä½ä¸ºåç©ºé´çé²å¾¡æªæ½ï¼ ä¸»è¦åæ¬ï¼\n\n * -XXï¼MaxMetaspaceSizeï¼ è®¾ç½®åç©ºé´æå¤§å¼ï¼ é»è®¤æ¯-1ï¼ å³ä¸éå¶ï¼ æèè¯´åªåéäºæ¬å°åå­å¤§å°ã\n * -XXï¼MetaspaceSizeï¼ æå®åç©ºé´çåå§ç©ºé´å¤§å°ï¼ ä»¥å­èä¸ºåä½ï¼ è¾¾å°è¯¥å¼å°±ä¼è§¦ååå¾æ¶éè¿è¡ç±»åå¸è½½ï¼ åæ¶æ¶éå¨ä¼å¯¹è¯¥å¼è¿è¡è°æ´ï¼ å¦æéæ¾äºå¤§éçç©ºé´ï¼ å°±éå½éä½è¯¥å¼ï¼ å¦æéæ¾äºå¾å°çç©ºé´ï¼ é£ä¹å¨ä¸è¶è¿-XXï¼ MaxMetaspaceSizeï¼å¦æè®¾ç½®äºçè¯ï¼ çæåµä¸ï¼ éå½æé«è¯¥å¼ã\n * -XXï¼MinMetaspaceFreeRatioï¼ ä½ç¨æ¯å¨åå¾æ¶éä¹åæ§å¶æå°çåç©ºé´å©ä½å®¹éçç¾åæ¯ï¼ å¯åå°å ä¸ºåç©ºé´ä¸è¶³å¯¼è´çåå¾æ¶éçé¢çã ç±»ä¼¼çè¿æ-XXï¼ Max-MetaspaceFreeRatioï¼ ç¨äºæ§å¶æå¤§çåç©ºé´å©ä½å®¹éçç¾åæ¯ã\n\n\n# æ¬æºç´æ¥åå­æº¢åº\n\nç´æ¥åå­ï¼Direct Memoryï¼ çå®¹éå¤§å°å¯éè¿-XXï¼ MaxDirectMemorySizeåæ°æ¥æå®ï¼ å¦æä¸å»æå®ï¼ åé»è®¤ä¸Javaå æå¤§å¼ï¼ç±-Xmxæå®ï¼ ä¸è´ã\n\nç±ç´æ¥åå­å¯¼è´çåå­æº¢åºï¼ ä¸ä¸ªææ¾çç¹å¾æ¯å¨Heap Dumpæä»¶ä¸­ä¸ä¼çè§æä»ä¹ææ¾çå¼å¸¸æåµï¼ å¦æè¯»èåç°åå­æº¢åºä¹åäº§ççDumpæä»¶å¾å°ï¼ èç¨åºä¸­åç´æ¥æé´æ¥ä½¿ç¨äºDirectMemoryï¼å¸åçé´æ¥ä½¿ç¨å°±æ¯NIOï¼ ï¼ é£å°±å¯ä»¥èèéç¹æ£æ¥ä¸ä¸ç´æ¥åå­æ¹é¢çåå äºã\n\n\n# JVMåå¾åæ¶\n\né®é¢ï¼\n\n * åå­æ¯å¦ä½åéååæ¶çï¼\n * åªäºåå­éè¦åæ¶ï¼\n * ä»ä¹æ¶ååæ¶ï¼\n * å¦ä½åæ¶ï¼\n * parNew åparallel scavenge çåºå«æ¯ï¼\n\n\n# åå¾åæ¶ç®æ³\n\n * æ è®°-æ¸é¤ Mark-Sweep\n * æ è®°-å¤å¶ï¼å¸¸ç¨äºæ°çä»£\n * æ è®°-æ´ç Mark-Compact\n\nåä»£åæ¶ï¼åªæ¯æ ¹æ®å¯¹è±¡å­æ´»å¨æçä¸åå°åå­åä¸ºå åãä¸è¬å° java å åä¸ºæ°çä»£åèå¹´ä»£ï¼è¿æ ·æä»¬å°±å¯ä»¥æ ¹æ®åä¸ªå¹´ä»£çç¹ç¹éæ©åéçåå¾æ¶éç®æ³ã\n\n\n# å¹¶è¡åå¹¶å\n\n * å¹¶è¡ï¼Parallelï¼ ï¼æå¤æ¡åå¾æ¶éçº¿ç¨å¹¶è¡å·¥ä½ï¼ä½æ­¤æ¶ç¨æ·çº¿ç¨ä»ç¶å¤äºç­å¾ç¶æã\n * å¹¶åï¼Concurrentï¼ï¼æç¨æ·çº¿ç¨ä¸åå¾æ¶éçº¿ç¨åæ¶æ§è¡ï¼ä½ä¸ä¸å®æ¯å¹¶è¡ï¼å¯è½ä¼äº¤æ¿æ§è¡ï¼ï¼ç¨æ·ç¨åºå¨ç»§ç»­è¿è¡ï¼èåå¾æ¶éå¨è¿è¡å¨å¦ä¸ä¸ª CPU ä¸ã\n\n\n# åå¾åæ¶å¨å¾è§£\n\n\n\nSerial æ¯åçº¿ç¨çæ¶éå¨\n\nParNew æ¶éå¨å®è´¨ä¸æ¯Serialæ¶éå¨çå¤çº¿ç¨å¹¶è¡çæ¬ãé¤äºåæ¶ä½¿ç¨å¤æ¡çº¿ç¨è¿è¡åå¾æ¶éä¹å¤ï¼ å¶ä½çè¡ä¸ºåæ¬Serialæ¶éå¨å¯ç¨çæææ§å¶åæ°ï¼ä¾å¦ï¼ -XXï¼ SurvivorRatioã -XXï¼PretenureSizeThresholdã -XXï¼ HandlePromotionFailureç­ï¼ ã æ¶éç®æ³ã Stop The Worldã å¯¹è±¡åéè§åã åæ¶ç­ç¥ç­é½ä¸Serialæ¶éå¨å®å¨ä¸è´ï¼ å¨å®ç°ä¸è¿ä¸¤ç§æ¶éå¨ä¹å±ç¨äºç¸å½å¤çä»£ç ã\n\nParNewæ¶éå¨é¤äºæ¯æå¤çº¿ç¨å¹¶è¡æ¶éä¹å¤ï¼ å¶ä»ä¸Serialæ¶éå¨ç¸æ¯å¹¶æ²¡æå¤ªå¤åæ°ä¹å¤ã\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# åå¾åæ¶å¨åç±»\n\n * ç»å¸åå¾åæ¶å¨\n   * æ°çä»£\n     * Serialï¼æ°çä»£éç¨æ è®°-å¤å¶ç®æ³ï¼èå¹´ä»£éç¨æ è®°-æ´çç®æ³ã\n     * ParNewï¼serialçå¤çº¿ç¨ç\n     * Parallel Scavengeï¼æ°çä»£éç¨æ è®°-å¤å¶ç®æ³ï¼èå¹´ä»£éç¨æ è®°-æ´çç®æ³ã\n       * Parallel Scavenge æ¶éå¨å³æ³¨ç¹æ¯ååéï¼é«æççå©ç¨ CPUï¼ãCMS ç­åå¾æ¶éå¨çå³æ³¨ç¹æ´å¤çæ¯ç¨æ·çº¿ç¨çåé¡¿æ¶é´ï¼æé«ç¨æ·ä½éªï¼ãæè°ååéå°±æ¯ CPU ä¸­ç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸ CPU æ»æ¶èæ¶é´çæ¯å¼ã Parallel Scavenge æ¶éå¨æä¾äºå¾å¤åæ°ä¾ç¨æ·æ¾å°æåéçåé¡¿æ¶é´ææå¤§ååéï¼å¦æå¯¹äºæ¶éå¨è¿ä½ä¸å¤ªäºè§£ï¼æå·¥ä¼åå­å¨å°é¾çæ¶åï¼ä½¿ç¨ Parallel Scavenge æ¶éå¨éåèªéåºè°èç­ç¥ï¼æåå­ç®¡çä¼åäº¤ç»èææºå»å®æä¹æ¯ä¸ä¸ªä¸éçéæ©ã\n   * èå¹´ä»£ï¼\n     * Serial Old\n     * Parallel Oldï¼å¤çº¿ç¨+æ è®°æ´ç\n     * CMSï¼Concurrent Mark Sweepï¼éç¨æ è®°-æ¸é¤ç®æ³ãç®æ æç­åæ¶åé¡¿æ¶é´ã\n   * G1ï¼é¢åæå¡å¨çåå¾æ¶éå¨,ä¸»è¦éå¯¹éå¤å¤é¢å¤çå¨åå¤§å®¹éåå­çæºå¨. ä»¥æé«æ¦çæ»¡è¶³ GC åé¡¿æ¶é´è¦æ±çåæ¶,è¿å·å¤é«ååéæ§è½ç¹å¾.ï¼ä½åé¡¿+é«ååï¼ãG1 ä»æ´ä½æ¥çæ¯åºäºâæ è®°-æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨ä¸æ¥çæ¯åºäºâæ è®°-å¤å¶âç®æ³å®ç°çã\n     * G1 æ¶éå¨å¨åå°ç»´æ¤äºä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼åéæ©åæ¶ä»·å¼æå¤§ç Region(è¿ä¹å°±æ¯å®çåå­ Garbage-First çç±æ¥) ã\n * ä½å»¶è¿åå¾åæ¶å¨\n   * ZGCï¼åºäºRegion åå­å¸å±ï¼ä¸è®¾åä»£ï¼ä½¿ç¨äºè¯»å±éãæè²æéååå­å¤éæ å°ç­ææ¯å®ç°å¯å¹¶åçæ è®°-æ´çç®æ³ï¼ä»¥ä½å»¶è¿ä¸ºé¦è¦ç®æ ã\n   * Shenandoah\n\nCMSç¼ºç¹ï¼\n\n * å¯¹ CPU èµæºææï¼\n * æ æ³å¤çæµ®å¨åå¾ï¼\n * å®ä½¿ç¨çåæ¶ç®æ³-âæ è®°-æ¸é¤âç®æ³ä¼å¯¼è´æ¶éç»ææ¶ä¼æå¤§éç©ºé´ç¢çäº§çã\n\nShenandoahä¸G1ç3ä¸ªææ¾ä¸åï¼\n\n * æ¯æå¹¶åçæ´çç®æ³ï¼æéè¦ï¼ãG1çåæ¶é¶æ®µæ¯å¯ä»¥å¤çº¿ç¨å¹¶è¡çï¼ä½ä¸è½ä¸ç¨æ·çº¿ç¨å¹¶åã\n * ç®åé»è®¤ä¸ä½¿ç¨åä»£åæ¶\n * æå¼G1ä¸­èè´¹å¤§éåå­åè®¡ç®èµæºå»ç»´æ¤çè®°å¿éï¼ä½¿ç¨âè¿æ¥ç©éµâçå¨å±æ°æ®ç»ææ¥è®°å½è·¨Regionçå¼ç¨å³ç³»ã\n\n\n# é»è®¤åå¾åæ¶å¨ï¼\n\n * JDK8 é»è®¤ä½¿ç¨çæ¯ Parallel Scavenge + Parallel Oldãä½ä¸è¬ä¸ç¨è¿ä¸ªãå¸¸ç¨ParNew+CMSå§ï¼å ä¸ºæ¯å¯ä¸æ­éåï¼\n * JDK9~16 é»è®¤G1\n\nå¨JVMä¸­æ¯+XXéç½®å®ç°çæ­éç»åï¼\n\n * -XX:+UseSerialGCï¼èææºè¿è¡å¨Clientæ¨¡å¼ä¸çé»è®¤å¼ï¼Serial+Serial Oldã\n * -XX:+UseParNewGCï¼ParNew+Serial Oldï¼å¨JDK1.8è¢«åºå¼ï¼å¨JDK1.7è¿å¯ä»¥ä½¿ç¨ã\n * -XX:+UseConcMarkSweepGCï¼ParNew+CMS+Serial Oldã\n * -XX:+UseParallelGCï¼èææºè¿è¡å¨Serveræ¨¡å¼ä¸çé»è®¤å¼ï¼Parallel Scavenge+Serial Old(PS Mark Sweep)ã\n * -XX:+UseParallelOldGCï¼Parallel Scavenge+Parallel Oldã\n * -XX:+UseG1GCï¼G1+G1ã\n\n\n\n\n\nå åå­å¸¸è§åéç­ç¥ï¼\n\n * å¯¹è±¡ä¼ååéå¨edenåº\n * å¤§å¯¹è±¡ç´æ¥åéå°èå¹´ä»£ãå¤§å¯¹è±¡å°±æ¯éè¦å¤§éè¿ç»­åå­ç©ºé´çå¯¹è±¡ï¼æ¯å¦ï¼å­ç¬¦ä¸²ãæ°ç»ï¼ã\n * é¿æå­æ´»çå¯¹è±¡è¿å¥èå¹´ä»£\n\nç©ºé´åéæä¿ï¼ç®çæ¯ç¡®ä¿Minor GCä¹åèå¹´ä»£æè¶³å¤ç©ºé´å®¹çº³æ°çä»£ææå¯¹è±¡\n\nJDK 6 Update 24 ä¹åï¼å¨åç Minor GC ä¹åï¼èææºå¿é¡»åæ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºæ°çä»£ææå¯¹è±¡æ»ç©ºé´ï¼å¦æè¿ä¸ªæ¡ä»¶æç«ï¼é£è¿ä¸æ¬¡ Minor GC å¯ä»¥ç¡®ä¿æ¯å®å¨çãå¦æä¸æç«ï¼åèææºä¼åæ¥ç -XX:HandlePromotionFailure åæ°çè®¾ç½®å¼æ¯å¦åè®¸æä¿å¤±è´¥(Handle Promotion Failure);å¦æåè®¸ï¼é£ä¼ç»§ç»­æ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºåæ¬¡æåå°èå¹´ä»£å¯¹è±¡çå¹³åå¤§å°ï¼å¦æå¤§äºï¼å°å°è¯è¿è¡ä¸æ¬¡ Minor GCï¼å°½ç®¡è¿æ¬¡ Minor GC æ¯æé£é©ç;å¦æå°äºï¼æè -XX: HandlePromotionFailure è®¾ç½®ä¸åè®¸åé©ï¼é£è¿æ¶å°±è¦æ¹ä¸ºè¿è¡ä¸æ¬¡ Full GCã\n\nJDK 6 Update 24ä¹åçè§ååä¸ºåªè¦èå¹´ä»£çè¿ç»­ç©ºé´å¤§äºæ°çä»£å¯¹è±¡æ»å¤§å°æèåæ¬¡æåçå¹³åå¤§å°ï¼å°±ä¼è¿è¡ Minor GCï¼å¦åå°è¿è¡ Full GCã\n\nå¨æå¯¹è±¡å¹´é¾å¤å®ï¼Hotspot éåææå¯¹è±¡æ¶ï¼æç§å¹´é¾ä»å°å°å¤§å¯¹å¶æå ç¨çå¤§å°è¿è¡ç´¯ç§¯ï¼å½ç´¯ç§¯çæä¸ªå¹´é¾å¤§å°è¶è¿äº survivor åºç 50% æ¶ï¼é»è®¤å¼æ¯ 50%ï¼å¯ä»¥éè¿ -XX:TargetSurvivorRatio=percent æ¥è®¾ç½® ï¼ï¼åè¿ä¸ªå¹´é¾å MaxTenuringThresholdï¼é»è®¤15å²ï¼ ä¸­æ´å°çä¸ä¸ªå¼ï¼ä½ä¸ºæ°çæåå¹´é¾éå¼âã\n\nGCåç±»\n\n * Partial GC:\n   \n   * Minor GC/Young GC\n   \n   * Major GC/Old GC\n   \n   * Mixed GCï¼å¯¹æ´ä¸ªæ°çä»£åèå¹´ä»£è¿è¡åå¾åæ¶\n\n * Full GCï¼æ¶éæ´ä¸ªJavaå åæ¹æ³åº\n\n\n# å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æï¼\n\n * å¼ç¨è®¡æ°æ³\n   \n   * å®ç°ç®åï¼æçé«ï¼ä½æ¯ç®åä¸»æµçèææºä¸­å¹¶æ²¡æéæ©è¿ä¸ªç®æ³æ¥ç®¡çåå­ï¼å¶æä¸»è¦çåå æ¯å®å¾é¾è§£å³å¯¹è±¡ä¹é´ç¸äºå¾ªç¯å¼ç¨çé®é¢ã\n\n * å¯è¾¾æ§åææ³\n   \n   * éè¿ä¸ç³»åçç§°ä¸º âGC Rootsâ çå¯¹è±¡ä½ä¸ºèµ·ç¹ï¼ä»è¿äºèç¹å¼å§åä¸æç´¢ï¼èç¹æèµ°è¿çè·¯å¾ç§°ä¸ºå¼ç¨é¾ï¼å½ä¸ä¸ªå¯¹è±¡å° GC Roots æ²¡æä»»ä½å¼ç¨é¾ç¸è¿çè¯ï¼åè¯ææ­¤å¯¹è±¡æ¯ä¸å¯ç¨çã\n\n\n# å¯ä½ä¸ºGC Rootsçå¯¹è±¡\n\n * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¬å°æ¹æ³æ ï¼Nativeæ¹æ³ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n * ææè¢«åæ­¥éææçå¯¹è±¡\n\n\n# å¼ç¨\n\nJDK1.2 ä¹åï¼Java ä¸­å¼ç¨çå®ä¹å¾ä¼ ç»ï¼å¦æ reference ç±»åçæ°æ®å­å¨çæ°å¼ä»£è¡¨çæ¯å¦ä¸ååå­çèµ·å§å°åï¼å°±ç§°è¿ååå­ä»£è¡¨ä¸ä¸ªå¼ç¨ã\n\nJDK1.2 ä»¥åï¼Java å¯¹å¼ç¨çæ¦å¿µè¿è¡äºæ©åï¼å°å¼ç¨åä¸ºå¼ºå¼ç¨ãè½¯å¼ç¨ãå¼±å¼ç¨ãèå¼ç¨åç§ï¼å¼ç¨å¼ºåº¦éæ¸åå¼±ï¼\n\n * å¼ºå¼ç¨ï¼StrongReferenceï¼\n   \n   ä»¥åæä»¬ä½¿ç¨çå¤§é¨åå¼ç¨å®éä¸é½æ¯å¼ºå¼ç¨ï¼è¿æ¯ä½¿ç¨ææ®éçå¼ç¨ãå¦æä¸ä¸ªå¯¹è±¡å·æå¼ºå¼ç¨ï¼é£å°±ç±»ä¼¼äºå¿ä¸å¯å°ççæ´»ç¨åï¼åå¾åæ¶å¨ç»ä¸ä¼åæ¶å®ãå½åå­ç©ºé´ä¸è¶³ï¼Java èææºå®æ¿æåº OutOfMemoryError éè¯¯ï¼ä½¿ç¨åºå¼å¸¸ç»æ­¢ï¼ä¹ä¸ä¼é éæåæ¶å·æå¼ºå¼ç¨çå¯¹è±¡æ¥è§£å³åå­ä¸è¶³é®é¢ã\n\n * è½¯å¼ç¨ï¼SoftReferenceï¼\n   \n   å¦æä¸ä¸ªå¯¹è±¡åªå·æè½¯å¼ç¨ï¼é£å°±ç±»ä¼¼äºå¯æå¯æ ççæ´»ç¨åã**å¦æåå­ç©ºé´è¶³å¤ï¼åå¾åæ¶å¨å°±ä¸ä¼åæ¶å®ï¼å¦æåå­ç©ºé´ä¸è¶³äºï¼å°±ä¼åæ¶è¿äºå¯¹è±¡çåå­ã**åªè¦åå¾åæ¶å¨æ²¡æåæ¶å®ï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨åºä½¿ç¨ãè½¯å¼ç¨å¯ç¨æ¥å®ç°åå­ææçé«éç¼å­ã\n   \n   è½¯å¼ç¨å¯ä»¥åä¸ä¸ªå¼ç¨éåï¼ReferenceQueueï¼èåä½¿ç¨ï¼å¦æè½¯å¼ç¨æå¼ç¨çå¯¹è±¡è¢«åå¾åæ¶ï¼JAVA èææºå°±ä¼æè¿ä¸ªè½¯å¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ã\n\n * å¼±å¼ç¨ï¼WeakReferenceï¼\n   \n   å¦æä¸ä¸ªå¯¹è±¡åªå·æå¼±å¼ç¨ï¼é£å°±ç±»ä¼¼äºå¯æå¯æ ççæ´»ç¨åãå¼±å¼ç¨ä¸è½¯å¼ç¨çåºå«å¨äºï¼åªå·æå¼±å¼ç¨çå¯¹è±¡æ¥ææ´ç­æççå½å¨æãå¨åå¾åæ¶å¨çº¿ç¨æ«æå®æç®¡è¾çåå­åºåçè¿ç¨ä¸­ï¼ä¸æ¦åç°äºåªå·æå¼±å¼ç¨çå¯¹è±¡ï¼ä¸ç®¡å½ååå­ç©ºé´è¶³å¤ä¸å¦ï¼é½ä¼åæ¶å®çåå­ãä¸è¿ï¼ç±äºåå¾åæ¶å¨æ¯ä¸ä¸ªä¼åçº§å¾ä½ççº¿ç¨ï¼ å æ­¤ä¸ä¸å®ä¼å¾å¿«åç°é£äºåªå·æå¼±å¼ç¨çå¯¹è±¡ã\n   \n   å¼±å¼ç¨å¯ä»¥åä¸ä¸ªå¼ç¨éåï¼ReferenceQueueï¼èåä½¿ç¨ï¼å¦æå¼±å¼ç¨æå¼ç¨çå¯¹è±¡è¢«åå¾åæ¶ï¼Java èææºå°±ä¼æè¿ä¸ªå¼±å¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ã\n\n * èå¼ç¨ï¼PhantomReferenceï¼\n   \n   "èå¼ç¨"é¡¾åæä¹ï¼å°±æ¯å½¢åèè®¾ï¼ä¸å¶ä»å ç§å¼ç¨é½ä¸åï¼èå¼ç¨å¹¶ä¸ä¼å³å®å¯¹è±¡ççå½å¨æãå¦æä¸ä¸ªå¯¹è±¡ä»ææèå¼ç¨ï¼é£ä¹å®å°±åæ²¡æä»»ä½å¼ç¨ä¸æ ·ï¼å¨ä»»ä½æ¶åé½å¯è½è¢«åå¾åæ¶ã\n   \n   èå¼ç¨ä¸»è¦ç¨æ¥è·è¸ªå¯¹è±¡è¢«åå¾åæ¶çæ´»å¨ã\n   \n   èå¼ç¨ä¸è½¯å¼ç¨åå¼±å¼ç¨çä¸ä¸ªåºå«å¨äºï¼ èå¼ç¨å¿é¡»åå¼ç¨éåï¼ReferenceQueueï¼èåä½¿ç¨ãå½åå¾åæ¶å¨åå¤åæ¶ä¸ä¸ªå¯¹è±¡æ¶ï¼å¦æåç°å®è¿æèå¼ç¨ï¼å°±ä¼å¨åæ¶å¯¹è±¡çåå­ä¹åï¼æè¿ä¸ªèå¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ãç¨åºå¯ä»¥éè¿å¤æ­å¼ç¨éåä¸­æ¯å¦å·²ç»å å¥äºèå¼ç¨ï¼æ¥äºè§£è¢«å¼ç¨çå¯¹è±¡æ¯å¦å°è¦è¢«åå¾åæ¶ãç¨åºå¦æåç°æä¸ªèå¼ç¨å·²ç»è¢«å å¥å°å¼ç¨éåï¼é£ä¹å°±å¯ä»¥å¨æå¼ç¨çå¯¹è±¡çåå­è¢«åæ¶ä¹åéåå¿è¦çè¡å¨ã\n   \n   ç¹å«æ³¨æï¼å¨ç¨åºè®¾è®¡ä¸­ä¸è¬å¾å°ä½¿ç¨å¼±å¼ç¨ä¸èå¼ç¨ï¼ä½¿ç¨è½¯å¼ç¨çæåµè¾å¤ï¼è¿æ¯å ä¸ºè½¯å¼ç¨å¯ä»¥å é JVM å¯¹åå¾åå­çåæ¶éåº¦ï¼å¯ä»¥ç»´æ¤ç³»ç»çè¿è¡å®å¨ï¼é²æ­¢åå­æº¢åºï¼OutOfMemoryï¼ç­é®é¢çäº§çã\n\nä½ ä¼ä½¿ç¨è½¯å¼ç¨åå¼±å¼ç¨åï¼è½¯å¼ç¨åå¼±å¼ç¨çä¾å­ä¸éã\n\n\n# å¸¸éæ± çä½ç½®\n\nJDK1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\nJDK1.7 å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ ã\n\nJDK1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(Metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(Metaspace)\n\nåå¦å¨å­ç¬¦ä¸²å¸¸éæ± ä¸­å­å¨å­ç¬¦ä¸² "abc"ï¼å¦æå½åæ²¡æä»»ä½ String å¯¹è±¡å¼ç¨è¯¥å­ç¬¦ä¸²å¸¸éçè¯ï¼å°±è¯´æå¸¸é "abc" å°±æ¯åºå¼å¸¸éï¼å¦æè¿æ¶åçåå­åæ¶çè¯èä¸æå¿è¦çè¯ï¼"abc" å°±ä¼è¢«ç³»ç»æ¸çåºå¸¸éæ± äºã\n\n\n# å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»\n\næ¹æ³åºä¸»è¦åæ¶çæ¯æ ç¨çç±»ï¼é£ä¹å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»çå¢ï¼\n\nå¤å®ä¸ä¸ªå¸¸éæ¯å¦æ¯âåºå¼å¸¸éâæ¯è¾ç®åï¼èè¦å¤å®ä¸ä¸ªç±»æ¯å¦æ¯âæ ç¨çç±»âçæ¡ä»¶åç¸å¯¹èå»è®¸å¤ãç±»éè¦åæ¶æ»¡è¶³ä¸é¢ 3 ä¸ªæ¡ä»¶æè½ç®æ¯ âæ ç¨çç±»â ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ Java å ä¸­ä¸å­å¨è¯¥ç±»çä»»ä½å®ä¾ã\n * å è½½è¯¥ç±»ç ClassLoader å·²ç»è¢«åæ¶ã\n * è¯¥ç±»å¯¹åºç java.lang.Class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³ã\n\nèææºå¯ä»¥å¯¹æ»¡è¶³ä¸è¿° 3 ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âå¯ä»¥âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ä¸ä½¿ç¨äºå°±ä¼å¿ç¶è¢«åæ¶ã\n\n\n# èææºæ§è½çæ§ãæéå¤çå·¥å·\n\n\n# 6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·ï¼\n\nå·¥å·       åè½\njps      èææºè¿ç¨ç¶åµå·¥å·ãå¯ååºæ­£å¨è¿è¡çèææºè¿ç¨ï¼å¹¶ç°å®èææºæ§è¡ä¸»ç±»ã\njstat    èææºç»è®¡ä¿¡æ¯çè§å·¥å·ãèææºä¿¡æ¯ä¸»è¦æ3ç±»ï¼ç±»å è½½ãåå¾æ¶éãè¿è¡æç¼è¯ç¶åµ\njinfo    Javaéç½®ä¿¡æ¯å·¥å·ãå®æ¶æ¥çåè°æ´èææºåé¡¹åæ°ã\njmap     Javaåå­æ åå·¥å·ãç¨äºçæå è½¬å¨å¿«ç§ï¼heap dumpædumpæä»¶ï¼ã\njhat     èææºå è½¬å¨å¿«ç§åæå·¥å·ãæ­éjmapä½¿ç¨ï¼åæjmapçæçå è½¬å¨å¿«ç§ãä¸è¬ä¸ç¨ï¼ç¨VisualVMæå¶ä»ã\njstack   Javaå æ è·è¸ªå·¥å·ãç¨äºçæèææºå½åæ¶å»ççº¿ç¨å¿«ç§ï¼threaddumpæjavacoreæä»¶ï¼ãçº¿ç¨å¿«ç§å°±æ¯å½åèææºåæ¯ä¸æ¡çº¿ç¨æ­£å¨æ§è¡çæ¹æ³çå æ çéåã\n\nå¶ä»å·¥å·ï¼\n\nå·¥å·      åè½\njava    ç¨äºè¿è¡classæä»¶æjaræä»¶\njavac   ç¼è¯å¨ï¼å°.javaæä»¶ç¼è¯æ.class\njavap   ç¨äºåæå­èç ãåç¼è¯å¾å°å­èç æä»¤ãä¹å¯ç¨å¶ä»å·¥å·å°classæä»¶è½¬æ¢æç¹å®å¹³å°ä¸çæ±ç¼ä»£ç ã\n        \n\n\n# 4ä¸ªå¸¸ç¨çå¯è§åå·¥å·ï¼\n\nå¯è§åå·¥å·                  åè½\nJHSDB                  åºäºæå¡æ§ä»£ççè°è¯å·¥å·\nJConsole               Javaçè§ä¸ç®¡çæ§å¶å°\nVisualVM               å¤å-æéå¤çå·¥å·\nJava Mission Control   å¯æç»­å¨çº¿ççæ§å·¥å·\n\n\n# JMX\n\nJMXï¼Java Management Extensionsï¼ï¼ Java ç®¡çæ©å±ï¼ç¨æ¥ç®¡çåçæµ Java ç¨åºãæå¸¸ç¨å°çå°±æ¯å¯¹äº JVM ççæµåç®¡çï¼æ¯å¦ JVM åå­ãCPU ä½¿ç¨çãçº¿ç¨æ°ãåå¾æ¶éæåµç­ç­ãå¦å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿çº§å«çå¨æä¿®æ¹ï¼æ¯å¦ log4j å°±æ¯æ JMX æ¹å¼å¨æä¿®æ¹çº¿ä¸æå¡çæ¥å¿çº§å«ãæä¸»è¦çè¿æ¯è¢«ç¨æ¥ååç§çæ§å·¥å·ï¼æ¯å¦ Spring Boot ActuatorãJConsoleãVisualVM ç­ã\n\nJMX æ¢æ¯ Java ç®¡çç³»ç»çä¸ä¸ªæ åï¼ä¸ä¸ªè§èï¼ä¹æ¯ä¸ä¸ªæ¥å£ï¼ä¸ä¸ªæ¡æ¶ãææ åãæè§èæ¯ä¸ºäºè®©å¼åèå¯ä»¥å®å¶å¼åèªå·±çæ©å±åè½ï¼èä¸ä½ä¸ºä¸ä¸ªæ¡æ¶æ¥è®²ï¼JDK å·²ç»å¸®æä»¬å®ç°äºå¸¸ç¨çåè½ï¼å°¤å¶æ¯å¯¹ JVM ççæ§åç®¡çã\n\nhttps://www.cnblogs.com/fengzheng/p/13431845.html\n\n\n# ç±»å è½½æºå¶\n\n\n# ç±»æä»¶ç»æ\n\n\n\nå¯ç¨ javap åæclassæä»¶ã\n\n\n# èææºç±»å è½½æºå¶\n\nJavaèææºææè¿°ç±»çæ°æ®ä»classæä»¶å è½½å°åå­ï¼å¹¶å¯¹æ°æ®è¿è¡æ ¡éªãè½¬æ¢è§£æååå§åï¼æç»å½¢æå¯ä»¥è¢«èææºç´æ¥ä½¿ç¨çJavaç±»åï¼è¿ä¸ªè¿ç¨è¢«ç§°ä½èææºçç±»å è½½æºå¶ã\n\nä¸é£äºå¨ç¼è¯å¨éè¦è¿è¡è¿æ¥çè¯­è¨ä¸åï¼å¨Javaè¯­è¨éï¼ç±»åçå è½½ãè¿æ¥ååå§åé½æ¯å¨ç¨åºè¿è¡æé´å®æçã\n\nä¸ä¸ªç±»ä»è¢«å è½½å°èææºåå­ä¸­å¼å§ï¼å°å¸è½½åºåå­ä¸ºæ­¢ï¼å®çæ´ä¸ªçå½å¨æå°ä¼ç»å7ä¸ªé¶æ®µã\n\n\n\nå è½½ã éªè¯ã åå¤ã åå§ååå¸è½½è¿äºä¸ªé¶æ®µçé¡ºåºæ¯ç¡®å®çï¼ ç±»åçå è½½è¿ç¨å¿é¡»æç§è¿ç§é¡ºåºæé¨å°±ç­å°å¼å§ï¼ èè§£æé¶æ®µåä¸ä¸å®ï¼ å®å¨æäºæåµä¸å¯ä»¥å¨åå§åé¶æ®µä¹ååå¼å§ï¼è¿æ¯ä¸ºäºæ¯æJavaè¯­è¨çè¿è¡æ¶ç»å®ç¹æ§ï¼ä¹ç§°ä¸ºå¨æç»å®æææç»å®ï¼ ã\n\nå¯¹äºä»ä¹æ¶åå¼å§ç±»å è½½è¿ç¨çç¬¬ä¸ä¸ªé¶æ®µâå è½½âï¼ãJavaèææºè§èãæ²¡æå¼ºå¶çº¦æã\n\nä½å¯¹äºåå§åé¶æ®µï¼åä¸¥æ ¼è§å®äºæä¸åªæä»¥ä¸å­ç§æåµå¿é¡»å¯¹ç±»è¿è¡âåå§åâï¼èå è½½ãéªè¯ãåå¤èªç¶éè¦å¨æ­¤ä¹åå¼å§ï¼ï¼\n\n 1. éå° newãgetstaticãputstaticãinvokestaticè¿åæ¡å­èç æä»¤æ¶ãè½å¤çæè¿åæ¡æä»¤çå¸åJavaä»£ç åºæ¯æï¼\n    * ä½¿ç¨newå³é®å­å®ä¾åå¯¹è±¡æ¶ã\n    * è¯»åæè®¾ç½®ä¸ä¸ªç±»åçéæå­æ®µï¼è¢«finalä¿®é¥°ãå·²å¨ç¼è¯å¨æç»ææ¾å¥å¸¸éæ± çéæå­æ®µé¤å¤ï¼çæ¶åã\n    * è°ç¨ä¸ä¸ªç±»åçéææ¹æ³æ¶ã\n 2. ä½¿ç¨ java.lang.reflectåçæ¹æ³å¯¹ç±»åè¿è¡åå°è°ç¨æ¶ã\n 3. å½åå§åç±»æ¶ï¼å¦æåç°å¶ç¶ç±»è¿æ²¡è¿è¡è¿åå§åï¼åéè¦åè§¦åå¶ç¶ç±»çåå§åã\n 4. å½èææºå¯å¨æ¶ï¼ç¨æ·éè¦æå®ä¸ä¸ªè¦æ§è¡çä¸»ç±»ï¼åå«main()çé£ä¸ªç±»ï¼ï¼èææºä¼ååå§åè¿ä¸ªç±»ã\n 5. å½ä½¿ç¨JDK 7æ°å å¥çå¨æè¯­è¨æ¯ææ¶ï¼ å¦æä¸ä¸ªjava.lang.invoke.MethodHandleå®ä¾æåçè§£æç»æä¸ºREF_getStaticã REF_putStaticã REF_invokeStaticã REF_newInvokeSpecialåç§ç±»åçæ¹æ³å¥æï¼ å¹¶ä¸è¿ä¸ªæ¹æ³å¥æå¯¹åºçç±»æ²¡æè¿è¡è¿åå§åï¼ åéè¦åè§¦åå¶åå§åã\n 6. å½ä¸ä¸ªæ¥å£ä¸­å®ä¹äºJDK 8å å¥çé»è®¤æ¹æ³ï¼è¢«defaultä¿®é¥°çæ¥å£æ¹æ³ï¼ã\n\n\n# ç±»å è½½çè¿ç¨\n\nç±»å è½½çå¨è¿ç¨ï¼å è½½ãéªè¯ãåå¤ãè§£æååå§åäºä¸ªé¶æ®µã\n\n\n# å è½½\n\nè¿éçå è½½ï¼Loadingï¼é¶æ®µæ¯ææ´ä¸ªç±»å è½½ï¼Class Loadingï¼è¿ç¨ä¸­çä¸ä¸ªé¶æ®µã\n\nèææºéè¦å®æä¸ä»¶äºï¼\n\n 1. éè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åå®ä¹æ­¤ç±»çäºè¿å¶å­èæµã\n 2. å°è¿ä¸ªå­èæµæä»£è¡¨çéæå­å¨ç»æè½¬æ¢ä¸ºæ¹æ³åºçè¿è¡æ¶æ°æ®ç»æã\n 3. å¨åå­ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç java.lang.Classå¯¹è±¡ï¼ä½ä¸ºæ¹æ³åºè¿ä¸ªç±»çåç§æ°æ®çè®¿é®å¥å£ã\n\nå è½½é¶æ®µç»æåï¼ Javaèææºå¤é¨çäºè¿å¶å­èæµå°±æç§èææºæè®¾å®çæ ¼å¼å­å¨å¨æ¹æ³åºä¹ä¸­äºï¼ æ¹æ³åºä¸­çæ°æ®å­å¨æ ¼å¼å®å¨ç±èææºå®ç°èªè¡å®ä¹ï¼ ãJavaèææºè§èã æªè§å®æ­¤åºåçå·ä½æ°æ®ç»æã ç±»åæ°æ®å¦¥åå®ç½®å¨æ¹æ³åºä¹åï¼ ä¼å¨Javaå åå­ä¸­å®ä¾åä¸ä¸ªjava.lang.Classç±»çå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡å°ä½ä¸ºç¨åºè®¿é®æ¹æ³åºä¸­çç±»åæ°æ®çå¤é¨æ¥å£ã\n\n\n# éªè¯\n\néªè¯æ¯è¿æ¥é¶æ®µçç¬¬ä¸æ­¥ï¼ è¿ä¸é¶æ®µçç®çæ¯ç¡®ä¿Classæä»¶çå­èæµä¸­åå«çä¿¡æ¯ç¬¦åãJavaèææºè§èã çå¨é¨çº¦æè¦æ±ï¼ ä¿è¯è¿äºä¿¡æ¯è¢«å½ä½ä»£ç è¿è¡åä¸ä¼å±å®³èææºèªèº«çå®å¨ã\n\nä»æ´ä½ä¸çï¼ éªè¯é¶æ®µå¤§è´ä¸ä¼å®æä¸é¢åä¸ªé¶æ®µçæ£éªå¨ä½ï¼ æä»¶æ ¼å¼éªè¯ã åæ°æ®éªè¯ã å­èç éªè¯åç¬¦å·å¼ç¨éªè¯ã\n\n\n# åå¤\n\nåå¤é¶æ®µæ¯æ­£å¼ä¸ºç±»ä¸­å®ä¹çåéï¼å³éæåéï¼ è¢«staticä¿®é¥°çåéï¼ åéåå­å¹¶è®¾ç½®ç±»åéåå§å¼çé¶æ®µã\n\nè¿æ¶åè¿è¡åå­åéçä»åæ¬ç±»åéï¼ èä¸åæ¬å®ä¾åéï¼ å®ä¾åéå°ä¼å¨å¯¹è±¡å®ä¾åæ¶éçå¯¹è±¡ä¸èµ·åéå¨Javaå ä¸­ã\n\n\n# è§£æ\n\nè§£æé¶æ®µæ¯Javaèææºå°å¸¸éæ± åçç¬¦å·å¼ç¨æ¿æ¢ä¸ºç´æ¥å¼ç¨çè¿ç¨ã\n\n * ç¬¦å·å¼ç¨ï¼Symbolic Referencesï¼ ï¼ ç¬¦å·å¼ç¨ä»¥ä¸ç»ç¬¦å·æ¥æè¿°æå¼ç¨çç®æ ï¼ ç¬¦å·å¯ä»¥æ¯ä»»ä½å½¢å¼çå­é¢éï¼ åªè¦ä½¿ç¨æ¶è½æ æ­§ä¹å°å®ä½å°ç®æ å³å¯ã ç¬¦å·å¼ç¨ä¸èææºå®ç°çåå­å¸å±æ å³ï¼ å¼ç¨çç®æ å¹¶ä¸ä¸å®æ¯å·²ç»å è½½å°èææºåå­å½ä¸­çåå®¹ã åç§èææºå®ç°çåå­å¸å±å¯ä»¥åä¸ç¸åï¼ä½æ¯å®ä»¬è½æ¥åçç¬¦å·å¼ç¨å¿é¡»é½æ¯ä¸è´çï¼ å ä¸ºç¬¦å·å¼ç¨çå­é¢éå½¢å¼æç¡®å®ä¹å¨ãJavaèææºè§èã çClassæä»¶æ ¼å¼ä¸­ãegï¼å¨Classæä»¶ä¸­ CONSTANT_Class_infoãCONSTANT_Fieldref_infoã CONSTANT_Methodref_infoç­ç±»åçå¸¸éåºç°ã\n * ç´æ¥å¼ç¨ï¼Direct Referencesï¼ ï¼ ç´æ¥å¼ç¨æ¯å¯ä»¥ç´æ¥æåç®æ çæéã ç¸å¯¹åç§»éæèæ¯ä¸ä¸ªè½é´æ¥å®ä½å°ç®æ çå¥æã ç´æ¥å¼ç¨æ¯åèææºå®ç°çåå­å¸å±ç´æ¥ç¸å³çï¼ åä¸ä¸ªç¬¦å·å¼ç¨å¨ä¸åèææºå®ä¾ä¸ç¿»è¯åºæ¥çç´æ¥å¼ç¨ä¸è¬ä¸ä¼ç¸åã å¦ææäºç´æ¥å¼ç¨ï¼ é£å¼ç¨çç®æ å¿å®å·²ç»å¨èææºçåå­ä¸­å­å¨ã\n\nè§£æå¨ä½ä¸»è¦éå¯¹ç±»ææ¥å£ã å­æ®µã ç±»æ¹æ³ã æ¥å£æ¹æ³ã æ¹æ³ç±»åã æ¹æ³å¥æåè°ç¨ç¹éå®ç¬¦è¿7ç±»ç¬¦å·å¼ç¨è¿è¡ï¼ åå«å¯¹åºäºå¸¸éæ± çCONSTANT_Class_infoã CON-STANT_Fieldref_infoãCONSTANT_Methodref_infoã CONSTANT_InterfaceMethodref_infoãCONSTANT_MethodType_infoã CONSTANT_MethodHandle_infoã CONSTANT_Dyna-mic_infoåCONSTANT_InvokeDynamic_info 8ç§å¸¸éç±»åã\n\n\n# åå§å\n\nå¨ä¹åç±»å è½½å¨ä½ä¸­ï¼é¤äºå¨å è½½é¶æ®µåºç¨ç¨åºå¯ä»¥éè¿èªå®ä¹ç±»å è½½å¨çæ¹å¼å±é¨åä¸å¤ï¼å¶ä½å¨ä½é½å®å¨ç±Javaèææºæ¥ä¸»å¯¼æ§å¶ãç´å°åå§åé¶æ®µï¼Javaèææºæçæ­£å¯æ¯æ§è¡ç±»ä¸­ç¼åçJavaç¨åºä»£ç ï¼å°ä¸»å¯¼æäº¤ç»åºç¨ç¨åºã\n\nè¿è¡åå¤é¶æ®µæ¶ï¼ åéå·²ç»èµè¿ä¸æ¬¡ç³»ç»è¦æ±çåå§é¶å¼ï¼ èå¨åå§åé¶æ®µï¼ åä¼æ ¹æ®ç¨åºåéè¿ç¨åºç¼ç å¶å®çä¸»è§è®¡åå»åå§åç±»åéåå¶ä»èµæºã æä»¬ä¹å¯ä»¥ä»å¦å¤ä¸ç§æ´ç´æ¥çå½¢å¼æ¥è¡¨è¾¾ï¼ åå§åé¶æ®µå°±æ¯æ§è¡ç±»æé å¨<clinit>()æ¹æ³çè¿ç¨ã <clinit>()å¹¶ä¸æ¯ç¨åºåå¨Javaä»£ç ä¸­ç´æ¥ç¼åçæ¹æ³ï¼ å®æ¯Javacç¼è¯å¨çèªå¨çæç©ã\n\n\n# ç±»å è½½å¨\n\nJavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­çâéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°Javaèææºå¤é¨å»å®ç°ï¼ ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ã å®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨âï¼Class Loaderï¼ ã\n\nå¯¹äºä»»æä¸ä¸ªç±»ï¼é½å¿é¡»ç±å è½½å®çç±»å è½½å¨åè¿ä¸ªç±»æ¬èº«ä¸èµ·å±åç¡®ç«å¶å¨Javaèææºä¸­çå¯ä¸æ§ã\n\næ¯ä¸ä¸ªç±»å è½½å¨ï¼é½æ¥æä¸ä¸ªç¬ç«çç±»åè¯ç©ºé´ã\n\næ¯è¾ä¸¤ä¸ªç±»æ¯å¦âç¸ç­âï¼åªæå¨è¿ä¸¤ä¸ªç±»æ¯ç±åä¸ä¸ªç±»å è½½å¨å è½½çåæä¸æææä¹ãå¦åï¼å³ä½¿è¿ä¸¤ä¸ªç±»æ¥æºäºåä¸ä¸ªClassæä»¶ï¼è¢«åä¸ä¸ªJavaèææºå è½½ï¼åªè¦å è½½å®ä»¬çç±»å è½½å¨ä¸åï¼é£è¿ä¸¤ä¸ªç±»å°±å¿å®ä¸ç¸ç­ã\n\nè¿éææçâç¸ç­âï¼ åæ¬ä»£è¡¨ç±»çClasså¯¹è±¡çequals()æ¹æ³ã isAssignableFrom()æ¹æ³ã isInstance()æ¹æ³çè¿åç»æï¼ ä¹åæ¬äºä½¿ç¨instanceofå³é®å­åå¯¹è±¡æå±å³ç³»å¤å®ç­åç§æåµã\n\nä»Javaèææºçè§åº¦æ¥çï¼åªå­å¨ä¸¤ç§ä¸åçç±»å è½½å¨ï¼\n\n 1. å¯å¨ç±»å è½½å¨ï¼Bootstrap ClassLoaderï¼ï¼è¿ä¸ªç±»å è½½å¨æ¯ä½¿ç¨C++å®ç°çï¼æ¯èææºèªèº«çä¸é¨åã\n 2. å¶ä»ææçç±»å è½½å¨ï¼è¿äºç±»å è½½å¨é½ç±Javaå®ç°çï¼ç¬ç«äºèææºå¤é¨ï¼å¹¶ä¸å¨é¨ç»§æ¿èªæ½è±¡ç±» java.lang.ClassLoader\n\nèªJDK 1.2ä»¥æ¥ï¼Javaä¸ç´ä¿æçä¸å±ç±»å è½½å¨ãåäº²å§æ´¾çç±»å è½½æ¶æãï¼å¨Javaæ¨¡åååæä¸äºè°æ´ï¼ä½ä¸»ä½ç»ææ²¡åï¼ã\n\n\n# ä¸å±ç±»å è½½å¨\n\nJDK 9 ä¹åï¼\n\nç»å¤§å¤æ°Javaç¨åºé½ä¼ä½¿ç¨å°ä»¥ä¸3ä¸ªç³»ç»æä¾çç±»å è½½å¨æ¥è¿è¡å è½½ã\n\n 1. å¯å¨ç±»å è½½å¨ Bootstrap Class Loaderï¼è´è´£å è½½å­æ¾å¨ <JAVA_HOME>\\libç®å½ï¼æè¢« -Xbootclasspathåæ°ææå®çè·¯å¾ä¸­å­æ¾çï¼å¹¶ä¸æ¯Javaèææºè½è¯å«çç±»åºå è½½å°èææºçåå­ä¸­ãï¼egï¼rt.jarãtools.jarï¼\n 2. æ©å±ç±»å è½½å¨ Extension Class Loaderï¼è´è´£å è½½ <JAVA_HOME>\\lib\\extç®å½ï¼æè¢« java.ext.dirsç³»ç»åéææå®çè·¯å¾ä¸­ææçç±»åºã\n 3. åºç¨ç¨åºç±»å è½½å¨/ç³»ç»ç±»å è½½å¨ Application Class Loaderï¼è´è´£å è½½ç¨æ·ç±»è·¯å¾ï¼ClassPathï¼ä¸ææçç±»åºãå¦æåºç¨ç¨åºä¸­æ²¡æèªå®ä¹è¿èªå·±çç±»å è½½å¨ï¼ä¸è¬æåµä¸è¿ä¸ªå°±æ¯ç¨åºä¸­é»è®¤çç±»å è½½å¨ã\n\nå¦ææéè¦ï¼è¿å¯ä»¥èªå®ä¹ç±»å è½½å¨ãegï¼å¢å é¤äºç£çä½ç½®ä¹å¤çClassæä»¶æ¥æºï¼ æèéè¿ç±»å è½½å¨å®ç°ç±»çéç¦»ã éè½½ç­åè½ã\n\n\n# åäº²å§æ´¾æ¨¡åï¼Parents Delegation Modelï¼\n\nåç§ç±»å è½½å¨æ¯ç»ä»¶çå±æ¬¡å³ç³»å°±è¢«ç§°ä¸ºç±»å è½½å¨çåäº²å§æ´¾æ¨¡åã\n\nåäº²å§æ´¾æ¨¡åè¦æ±é¤äºé¡¶å±çå¯å¨ç±»å è½½å¨å¤ï¼å¶ä½çç±»å è½½å¨é½åºæèªå·±çç¶ç±»å è½½å¨ãä¸è¿è¿éç±»å è½½å¨ä¹é´çç¶å­å³ç³»ä¸è¬ä¸æ¯ç»§æ¿ï¼inheritanceï¼çå³ç³»æ¥å®ç°çï¼èæ¯ä½¿ç¨ç»åï¼compositionï¼å³ç³»æ¥å¤ç¨ç¶ç±»å è½½å¨çä»£ç ã\n\n**åäº²å§æ´¾æ¨¡åçå·¥ä½è¿ç¨æ¯ï¼**å¦æä¸ä¸ªç±»å è½½å¨æ¶å°äºç±»å è½½çè¯·æ±ï¼å®é¦åä¸ä¼èªå·±å»å°è¯å è½½è¿ä¸ªç±»ï¼èæ¯æè¿ä¸ªè¯·æ±å§æ´¾ç»ç¶ç±»å è½½å¨å»å®æï¼æ¯ä¸ä¸ªå±æ¬¡çç±»å è½½å¨é½æ¯å¦æ­¤ï¼å æ­¤ææçå è½½è¯·æ±æç»é½åºè¯¥ä¼ éå°æé¡¶å±çå¯å¨ç±»å è½½å¨ä¸­ï¼åªæå½ç¶ç±»å è½½å¨åé¦èªå·±æ æ³å®æè¿ä¸ªå è½½è¯·æ±ï¼å®çæç´¢èå´ä¸­æ²¡ææ¾å°æéçç±»ï¼æ¶ï¼å­å è½½å¨æä¼å°è¯èªå·±å»å®æå è½½ã\n\nä½¿ç¨åäº²å§æ´¾æ¨¡åæ¥ç»ç»ç±»å è½½å¨ä¹é´çå³ç³»ï¼ ä¸ä¸ªæ¾èæè§çå¥½å¤å°±æ¯Javaä¸­çç±»éçå®çç±»å è½½å¨ä¸èµ·å·å¤äºä¸ç§å¸¦æä¼åçº§çå±æ¬¡å³ç³»ã ä¾å¦ç±»java.lang.Objectï¼ å®å­æ¾å¨rt.jarä¹ä¸­ï¼ æ è®ºåªä¸ä¸ªç±»å è½½å¨è¦å è½½è¿ä¸ªç±»ï¼ æç»é½æ¯å§æ´¾ç»å¤äºæ¨¡åæé¡¶ç«¯çå¯å¨ç±»å è½½å¨è¿è¡å è½½ï¼ å æ­¤Objectç±»å¨ç¨åºçåç§ç±»å è½½å¨ç¯å¢ä¸­é½è½å¤ä¿è¯æ¯åä¸ä¸ªç±»ã\n\nåäº²å§æ´¾æ¨¡åçå®ç°ï¼\n\n//java.lang.ClassLoaderçloadClass()\nprotected synchronized Class<?> loadClass(String name, boolean resolve) throws ClassNotFoundException\n{\n// é¦åï¼ æ£æ¥è¯·æ±çç±»æ¯å¦å·²ç»è¢«å è½½è¿äº\nClass c = findLoadedClass(name);\nif (c == null) {\ntry {\nif (parent != null) {\nc = parent.loadClass(name, false);\n} else {\nc = findBootstrapClassOrNull(name);\n}}\ncatch (ClassNotFoundException e) {\n// å¦æç¶ç±»å è½½å¨æåºClassNotFoundException\n// è¯´æç¶ç±»å è½½å¨æ æ³å®æå è½½è¯·æ±\n}i\nf (c == null) {\n// å¨ç¶ç±»å è½½å¨æ æ³å è½½æ¶\n// åè°ç¨æ¬èº«çfindClassæ¹æ³æ¥è¿è¡ç±»å è½½\nc = findClass(name);\n}\n}i\nf (resolve) {\nresolveClass(c);\n}return c;\n}\n\n\nåæ£æ¥è¯·æ±å è½½çç±»åæ¯å¦å·²ç»è¢«å è½½è¿ï¼ è¥æ²¡æåè°ç¨ç¶å è½½å¨çloadClass()æ¹æ³ï¼ è¥ç¶å è½½å¨ä¸ºç©ºåé»è®¤ä½¿ç¨å¯å¨ç±»å è½½å¨ä½ä¸ºç¶å è½½å¨ã åå¦ç¶ç±»å è½½å¨å è½½å¤±è´¥ï¼ æåºClassNotFoundExceptionå¼å¸¸çè¯ï¼ æè°ç¨èªå·±çfindClass()æ¹æ³å°è¯è¿è¡å è½½ã\n\n\n# Javaæ¨¡ååç³»ç»\n\nJDK 9 ä¸­å¼å¥äºJavaæ¨¡ååç³»ç»ï¼Java Platform Module System, JPMSï¼ã\n\nï¼æ¨¡ååå°åºæä¹æ ·ï¼æ²¡çæï¼\n\nä¸ºäºä¿è¯å¼å®¹æ§ï¼ JDK 9å¹¶æ²¡æä»æ ¹æ¬ä¸å¨æä»JDK 1.2ä»¥æ¥è¿è¡äºäºåå¹´ä¹ä¹çä¸å±ç±»å è½½å¨æ¶æä»¥ååäº²å§æ´¾æ¨¡åã ä½æ¯ä¸ºäºæ¨¡ååç³»ç»çé¡ºå©æ½è¡ï¼ æ¨¡ååä¸çç±»å è½½å¨ä»ç¶åçäºä¸äºåºè¯¥è¢«æ³¨æå°åå¨ï¼ ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. æ©å±ç±»å è½½å¨ï¼Extension Class Loaderï¼ è¢«å¹³å°ç±»å è½½å¨ï¼Platform Class Loaderï¼ åä»£ã\n 2. JDK 9ä¸­è½ç¶ä»ç¶ç»´æçä¸å±ç±»å è½½å¨ååäº²å§æ´¾çæ¶æï¼ ä½ç±»å è½½çå§æ´¾å³ç³»ä¹åçäºåå¨ã å½å¹³å°ååºç¨ç¨åºç±»å è½½å¨æ¶å°ç±»å è½½è¯·æ±ï¼ å¨å§æ´¾ç»ç¶å è½½å¨å è½½åï¼ è¦åå¤æ­è¯¥ç±»æ¯å¦è½å¤å½å±å°æä¸ä¸ªç³»ç»æ¨¡åä¸­ï¼ å¦æå¯ä»¥æ¾å°è¿æ ·çå½å±å³ç³»ï¼ å°±è¦ä¼åå§æ´¾ç»è´è´£é£ä¸ªæ¨¡åçå è½½å¨å®æå è½½ã\n\nå¨Javaæ¨¡ååç³»ç»æç¡®çè§å®äºä¸ä¸ªç±»å è½½å¨è´è´£åèªå è½½çæ¨¡åã\n\n\n\n\n# Javaåå­æ¨¡å\n\n\n# ç¡¬ä»¶çæçä¸ä¸è´æ§\n\n\n\nåºäºåè¯ç¼å­çå­å¨äº¤äºå¾å¥½çè§£å³äºå¤çå¨ä¸åå­éåº¦ä¹é´ççç¾ï¼ä½å¸¦æ¥äºä¸ä¸ªæ°é®é¢ï¼ç¼å­ä¸è´æ§ï¼Cache Coherenceï¼ãä¸ºäºè§£å³ä¸è´æ§é®é¢ï¼éè¦åä¸ªå¤çå¨è®¿é®ç¼å­æ¶é½éµå¾ªä¸äºåè®®ãè¿ç±»åè®®æï¼MSIãMESIãMOSIããã\n\nJavaèææºä¹æèªå·±çåå­æ¨¡åï¼å¹¶ä¸åè¿éçåå­è®¿é®æä½åç¡¬ä»¶çç¼å­æä½è§æé«åº¦çå¯ç±»æ¯æ§ã\n\n\n# Javaåå­æ¨¡å\n\nJava Memory Modelï¼JMM\n\n\n\nè¿éçä¸»åå­ãå·¥ä½åå­ä¸Javaåå­åºåä¸­çJavaå ãæ ãæ¹æ³åºç­ä¸æ¯ä¸ä¸ªæ¦å¿µï¼æ²¡æå³ç³»ã\n\n * Javaåå­æ¨¡åè§å®äºææçåéé½å­å¨å¨ä¸»åå­ä¸­ã\n\n * æ¯æ¡çº¿ç¨è¿æèªå·±çå·¥ä½åå­ï¼çº¿ç¨ä¸­çå·¥ä½åå­ä¸­ä¿å­äºè¢«è¯¥çº¿ç¨ä½¿ç¨çåéçä¸»åå­å¯æ¬ï¼çº¿ç¨å¯¹åéçæææä½ï¼è¯»åãèµå¼ç­ï¼é½å¿é¡»å¨å·¥ä½åå­ä¸­è¿è¡ï¼èä¸è½ç´æ¥è¯»åä¸»åå­ä¸­çæ°æ®ã\n\n * ä¸åççº¿ç¨ä¹é´ä¹æ æ³ç´æ¥è®¿é®å¯¹æ¹å·¥ä½åå­ä¸­çåéï¼çº¿ç¨é´åéå¼çä¼ éåéè¦éè¿ä¸»åå­æ¥å®æã\n\nè¿éè¯´çåéä¸javaç¼ç¨ä¸­çåéææåºå«ï¼å®åæ¬äºå®ä¾å­æ®µãéæå­æ®µåæææ°ç»å¯¹è±¡çåç´ ï¼ä½æ¯ä¸åæ¬å±é¨åéä¸æ¹æ³åæ°ï¼å ä¸ºæ¯çº¿ç¨ç§æçï¼ä¸ä¼è¢«å±äº«ï¼ä¸ä¼å­å¨ç«äºé®é¢ã\n\nå¯¹äºä¸»åå­åå·¥ä½åå­ä¹é´çäº¤äºåè®®ï¼Javaåå­æ¨¡åä¸­å®ä¹äº8ç§æä½æ¥å®æï¼Javaèææºå®ç°æ¶å¿é¡»ä¿è¯è¿8ç§æä½æ¯ä¸ä¸ªé½æ¯åå­çãåæ¥ï¼ç®åä¸º read, write, lock, unlock åç§ã\n\nvolatile å¯ä»¥è¯´æ¯Javaèææºæä¾çæè½»éçº§çåæ­¥æºå¶ãå½ä¸ä¸ªåéè¢«å®ä¸ºæ volatile ä¹åï¼å®å°å·å¤ä¸¤ä¸ªç¹æ§ï¼\n\n 1. ä¿è¯åéå¯¹ææçº¿ç¨çå¯è§æ§ãï¼å¹¶ä¸ä¿è¯åå­æ§ï¼å³ä½¿ç¼è¯åºæ¥åªæä¸æ¡å­èç æä»¤ï¼ä¹ä¸æå³çè¿æ¡æä»¤å°±æ¯ä¸ä¸ªåå­æä½ï¼\n 2. ç¦æ­¢æä»¤éæåºä¼åã\n\nå¤§å¤æ°æåµä¸ volatile çæ»å¼ä¸æ¯éè¦ä½ï¼å æ­¤æä»¬å¨ volatile ä¸éçéæ©ä¸­ï¼å¯ä¸å¤æ­ä¾æ®ä¾¿æ¯ volatileçè¯­ä¹è½å¦æ»¡è¶³ä½¿ç¨åºæ¯çéæ±ã\n\nå¯¹äº volatile åéçç¹æ®è§åï¼\n\n * å¨å·¥ä½åå­ä¸­ï¼æ¯æ¬¡ä½¿ç¨åé½å¿é¡»åä»ä¸»åå­å·æ°ææ°çå¼ï¼ä¿è¯è½çèµ·å¶ä»çº¿ç¨å¯¹åéæåçä¿®æ¹ã\n * å¨å·¥ä½åå­ä¸­ï¼æ¯æ¬¡ä¿®æ¹åé½å¿é¡»ç«å»åæ­¥åä¸»åå­ä¸­ï¼ä¿è¯å¶ä»çº¿ç¨å¯ä»¥çå°èªå·±å¯¹åéçä¿®æ¹ã\n * ä¿®é¥°çåéä¸ä¼è¢«æä»¤éæåºä¼åï¼ä»èä¿è¯ä»£ç çæ§è¡é¡ºåºä¸ç¨åºçé¡ºåºç¸åã\n\nåå­æ§ï¼\n\nå°½ç®¡èææºæªæ lock å unlock æä½ç´æ¥å¼æ¾ç»ç¨æ·ä½¿ç¨ï¼ä½æ¯å´æä¾äºæ´é«å±æ¬¡çå­èç æä»¤ monitorenter å monitorexit æ¥éå¼çä½¿ç¨è¿ä¸¤ä¸ªæä½ãè¿ä¸¤ä¸ªå­èç æä»¤åæ å°javaä»£ç ä¸­å°±æ¯åæ­¥å¿«synchronizedå³é®å­ã\n\nå¯è§æ§ï¼\n\né¤äº volatile ä¹å¤ï¼Javaè¿æä¸¤ä¸ªå³é®å­å¯ä»¥å®ç°å¯è§æ§ï¼synchronized å finalã\n\nfinal çå¯è§æ§æ¯æï¼è¢«finalä¿®é¥°çå­æ®µå¨æé å¨ä¸­ä¸æ¦è¢«åå§åå®æï¼å¹¶ä¸æé æ²¡ææ this çå¼ç¨ä¼ éåºå»ï¼é£ä¹å¨å¶ä»çº¿ç¨ä¸­å°±è½çè§ final å­æ®µçå¼ã\n\næåºæ§ï¼\n\nå¦æå¨æ¬çº¿ç¨åè§å¯ï¼æææä½é½æ¯æåºçã\n\nå¦æå¨ä¸ä¸ªçº¿ç¨è§å¯å¦ä¸ä¸ªçº¿ç¨ï¼ææçæä½é½æ¯æ åºçã\n\n\n# åè¡åçï¼Happens-Beforeï¼åå\n\nå¦æJava åå­æ¨¡åä¸­ææçæåºæ§é½åªé  volatile å synchronized æ¥å®æï¼é£ä¹å¾å¤æä½å°ä¼åå¾éå¸¸å°å¦ã\n\nèJavaéè¿åè¡åçï¼Happens-Beforeï¼ååï¼å¯¹æ°æ®æ¯å¦å­å¨ç«äºï¼çº¿ç¨æ¯å¦å®å¨è¿è¡äºå¤æ­ã\n\nåè¡åçæ¯æï¼Javaåå­æ¨¡åä¸­å®ä¹çä¸¤é¡¹æä½ä¹é´çååºå³ç³»ï¼å¦ææä½Aåè¡åçä¸æä½Bï¼é£å°±æ¯è¯´å¨åéæä½Bä¹åï¼æä½Aäº§ççå½±åè½è¢«æä½Bè§å¯å°ãå½±ååæ¬ä¿®æ¹äºåå­ä¸­å±äº«åéçå¼ãåéäºæ¶æ¯ãè°ç¨äºæ¹æ³ç­ã\n\nä»¥ä¸æ¯Javaåå­æ¨¡åä¸­çåè¡åçå³ç³»ï¼ï¼å¦æä¸¤ä¸ªæä½ä¹é´çå³ç³»ä¸å¨æ­¤åï¼ æ æ³ä»ä¸åè§åæ¨å¯¼åºæ¥ï¼ åå®ä»¬å°±æ²¡æé¡ºåºæ§ä¿éï¼ èææºå¯ä»¥å¯¹å®ä»¬éæå°è¿è¡éæåºãï¼\n\n * ç¨åºæ¬¡åºè§å Program Order Ruleï¼å¨ä¸ä¸ªçº¿ç¨åï¼æç§æ§å¶æµç¨é¡ºåºï¼ä¹¦åå¨åé¢çæä½åè¡åçä¸ä¹¦åå¨åé¢çæä½\n * ç®¡ç¨éå®è§å Monitor Lock Ruleï¼ä¸ä¸ªunlock æä½åè¡åçä¸åé¢å¯¹åä¸ä¸ªéçlockæä½ã\n * çº¿ç¨å¯å¨è§å Thread Start Ruleï¼Threadå¯¹è±¡çstart()æ¹æ³åè¡åçä¸æ­¤çº¿ç¨çæ¯ä¸ä¸ªå¨ä½ã\n * çº¿ç¨ç»æ­¢è§å Thead Termination Ruleï¼çº¿ç¨ä¸­çæææä½é½åè¡åçäºå¯¹æ­¤çº¿ç¨çç»æ­¢æ£æµï¼å¯ä»¥éè¿ Thread::jion() æ¹æ³æ¯å¦ç»æãThread::isAlive()çè¿åå¼ç­ææ®µæ£æµçº¿ç¨æ¯å¦å·²ç»ç»æ­¢æ§è¡ã\n * çº¿ç¨ä¸­æ­è§å Thread Interruption Ruleï¼å¯¹çº¿ç¨interrput()æ¹æ³çè°ç¨åè¡åçäºè¢«ä¸­æ­çº¿ç¨çä»£ç æ£æµå°ä¼ä¸­æ­äºä»¶çåçï¼å¯ä»¥éè¿ Thread::interrupted()æ¹æ³æ£æµå°æ¯å¦æä¸­æ­åçã\n * å¯¹è±¡ç»ç»è§å Finalize Ruleï¼ä¸ä¸ªå¯¹è±¡çåå§åå®æï¼æé å½æ°æ§è¡ç»æï¼åè¡åçäºå®çfinalize()æ¹æ³çå¼å§ã\n * ä¼ éæ§ Transitivityï¼å¦ææä½Aåè¡åçä¸æä½Bï¼æä½Båè¡åçä¸æä½Cï¼é£ä¹æä½Aåè¡åçäºæä½Cã\n\n\n# Java ä¸çº¿ç¨\n\nçº¿ç¨æ¯æ¯è¿ç¨æ´è½»éçº§çè°åº¦æ§è¡åä½ï¼å¼å¥äºçº¿ç¨ï¼å¯ä»¥æä¸ä¸ªè¿ç¨çèµæºåéåæ§è¡è°åº¦åå¼ï¼åä¸ªçº¿ç¨æ¢å¯ä»¥å±äº«è¿ç¨èµæºï¼åå­å°åãæä»¶I/Oç­ï¼ï¼åå¯ä»¥ç¬ç«è°åº¦ã\n\nç®åçº¿ç¨æ¯Javaè¿è¡å¤çå¨èµæºè°åº¦çæåºæ¬åä½ã\n\nä¸»æµJavaèææºççº¿ç¨æ¨¡åé½æ¯åºäºæä½ç³»ç»åççº¿ç¨æ¨¡åæ¥å®ç°çï¼å³éç¨1ï¼1çº¿ç¨æ¨¡åã\n\né»å¡åç­å¾çåºå«ï¼\n\n * é»å¡ï¼å¨ç­å¾è·åä¸ä¸ªæä»éï¼è¿ä¸ªäºä»¶å°å¨å¦ä¸ä¸ªçº¿ç¨æ¾å¼è¿ä¸ªéçæ¶ååç\n * ç­å¾ï¼åæ¯å¨ç­å¾ä¸æ®µæ¶é´ï¼æèå¤éå¨ä½çåçã\n\n\n\n\n# Java ä¸åç¨ãä¸æ¯å¾çè§£ã\n\n1ï¼ 1çåæ ¸çº¿ç¨æ¨¡åæ¯å¦ä»Javaèææºçº¿ç¨å®ç°çä¸»æµéæ©ï¼ ä½æ¯è¿ç§æ å°å°æä½ç³»ç»ä¸ççº¿ç¨å¤©ç¶çç¼ºé·æ¯åæ¢ã è°åº¦ææ¬é«æï¼ ç³»ç»è½å®¹çº³ççº¿ç¨æ°éä¹å¾æéã\n\nä¼ ç»çJava Webæå¡å¨ççº¿ç¨æ± çå®¹ééå¸¸å¨å åä¸ªå°ä¸¤ç¾ä¹é´ï¼ å½ç¨åºåææ°ä»¥ç¾ä¸è®¡çè¯·æ±å¾çº¿ç¨æ± éé¢çæ¶ï¼ ç³»ç»å³ä½¿è½å¤çå¾è¿æ¥ï¼ ä½å¶ä¸­çåæ¢æèä¹æ¯ç¸å½å¯è§çã\n\nåæ ¸çº¿ç¨çè°åº¦ææ¬ä¸»è¦æ¥èªäºç¨æ·æä¸æ ¸å¿æä¹é´çç¶æè½¬æ¢ï¼ èè¿ä¸¤ç§ç¶æè½¬æ¢çå¼éä¸»è¦æ¥èªäºååºä¸­æ­ã ä¿æ¤åæ¢å¤æ§è¡ç°åºçææ¬ã\n\nåæ¥ï¼ æä½ç³»ç»å¼å§æä¾å¤çº¿ç¨çæ¯æï¼ é åºç¨èªå·±æ¨¡æå¤çº¿ç¨çåæ³èªç¶æ¯åå°äºè®¸å¤ï¼ ä½ä¹å¹¶æ²¡æå®å¨æ¶å¤±ï¼ èæ¯æ¼åä¸ºç¨æ·çº¿ç¨ç»§ç»­å­å¨ã ç±äºæåå¤æ°çç¨æ·çº¿ç¨æ¯è¢«è®¾è®¡æååå¼è°åº¦ï¼Cooperative Schedulingï¼ çï¼ æä»¥å®æäºä¸ä¸ªå«åâââåç¨âï¼Coroutineï¼ ã åç±äºè¿æ¶åçåç¨ä¼å®æ´å°åè°ç¨æ çä¿æ¤ã æ¢å¤å·¥ä½ï¼ æä»¥ä»å¤©ä¹è¢«ç§°ä¸ºâææ åç¨âï¼Stackfull Coroutineï¼ ï¼ èµ·è¿æ ·çåå­æ¯ä¸ºäºä¾¿äºè·åæ¥çâæ æ åç¨âï¼Stackless Coroutineï¼ åºåå¼ã æ æ åç¨ä¸æ¯æ¬èçä¸»è§ï¼ ä¸è¿è¿æ¯å¯ä»¥ç®åæä¸ä¸å®çå¸ååºç¨ï¼ å³åç§è¯­è¨ä¸­çawaitã asyncã yieldè¿ç±»å³é®å­ã æ æ åç¨æ¬è´¨ä¸æ¯ä¸ç§æéç¶ææºï¼ ç¶æä¿å­å¨é­åéï¼ èªç¶æ¯ææ åç¨æ¢å¤è°ç¨æ è¦è½»éå¾å¤ï¼ ä½åè½ä¹ç¸å¯¹æ´æéã\n\nå¯¹äºææ åç¨ï¼ æä¸ç§ç¹ä¾å®ç°åä¸ºçº¤ç¨ï¼Fiberï¼\n\n\n# çº¿ç¨å®å¨\n\nçº¿ç¨å®å¨çå®ç°æ¹æ³ï¼\n\n\n# äºæ¥åæ­¥ï¼é»å¡åæ­¥ï¼\n\näºæ¥æ¯ææ®µï¼åæ­¥æ¯ç®çã\n\nä¸´çåºï¼critical sectionï¼ãäºæ¥éï¼mutexï¼ãä¿¡å·éï¼semaphoreï¼é½æ¯å¸¸è§çäºæ¥å®ç°æ¹æ³ã\n\nå¨Javaä¸­ï¼æåºæ¬çäºæ¥åæ­¥ææ®µå°±æ¯ synchronized ï¼è¿æ¯ä¸ç§åç»æï¼block structuredï¼çåæ­¥è¯­æ³ã\n\nsynchronized ç»è¿javac ç¼è¯åï¼ä¼å¨åæ­¥ååååå«å½¢æ monitorenter åmonitorexitä¸¤ä¸ªå­èç æä»¤ãè¿ä¸¤ä¸ªå­èç æä»¤é½éè¦ä¸ä¸ªreferenceç±»åçåæ°æ¥ææè¦éå®åè§£éçå¯¹è±¡ãå¦æä»£ç ä¸­synchronizedæç¡®ææäºå¯¹è±¡åæ°ï¼é£å°±ä»¥è¿ä¸ªå¯¹è±¡çå¼ç¨ä½ä¸ºreferenceï¼å³è·å¾çæ¯ä½ ä¼ å¥çï¼ä¼ å¥å¯¹è±¡å°±æ¯å¯¹è±¡éãthisä¹æ¯å¯¹è±¡éãï¼ä¼ å¥ç±»å°±æ¯ç±»éï¼ï¼å¦ææ²¡ææç¡®æå®ï¼å°æ ¹æ®synchronizedä¿®é¥°çæ¹æ³ç±»åï¼å®ä¾æ¹æ³è¿æ¯ç±»æ¹æ³ï¼ï¼æ¥å³å®æ¯è·åå¯¹è±¡å®ä¾è¿æ¯ç±»åå¯¹åºçClasså¯¹è±¡æ¥ä½ä¸ºçº¿ç¨è¦ææçéï¼å³ä¿®é¥°å®ä¾æ¹æ³è·åçæ¯å¯¹è±¡éï¼ä¿®é¥°éææ¹æ³è·åçæ¯ç±»éï¼ã\n\nè¢« synchronized ä¿®é¥°çåæ­¥åå¯¹åä¸æ¡çº¿ç¨æ¥è¯´æ¯å¯éå¥çãè¿æå³çåä¸çº¿ç¨åå¤è¿å¥åæ­¥åä¹ä¸ä¼åºç°æèªå·±éæ­»çæåµã\n\nè¢« synchronized ä¿®é¥°çåæ­¥åå¨ææéççº¿ç¨æ§è¡å®æ¯å¹¶éæ¾éä¹åï¼ä¼æ æ¡ä»¶çé»å¡åé¢å¶ä»çº¿ç¨çè¿å¥ã\n\nJDK 5èµ·ï¼Javaæä¾äºjava.util.concurrentåï¼J.U.Tåï¼ï¼å¶ä¸­java.util.concurrent.locks.Lockæ¥å£ä¾¿æäºJavaçå¦ä¸ç§å¨æ°çäºæ¥åæ­¥ææ®µãåºäºLockæ¥å£ï¼ç¨æ·è½å¤ä»¥éåç»æï¼Non-Block Structuredï¼æ¥å®ç°äºæ¥åæ­¥ï¼ä»èæè±è¯­è¨ç¹æ§çæç¼ï¼å¨ç±»åºå±é¢å»å®ç°åæ­¥ã\n\néå¥éï¼ReentrantLockï¼æ¯Lockæ¥å£æå¸¸è§çä¸ç§å®ç°ãå¨åºæ¬ç¨æ³ä¸ï¼ReentrantLock å synchronizedç¸ä¼¼ï¼åªæ¯åæ³ç¨å¾®ä¸åï¼ä¸ ReentrantLock æ¯ synchronized å¤äºä¸äºé«çº§åè½ï¼ä¸»è¦æ3é¡¹ï¼\n\n 1. ç­å¾å¯ä¸­æ­\n 2. å¯å®ç°å¬å¹³é\n 3. å¯ç»å®å¤ä¸ªæ¡ä»¶\n\nJDK 6 å¼å§å¯¹synchronizedè¿è¡äºéä¼åï¼ReentrantLock å synchronized çæ§è½åºæ¬è½æå¹³ï¼å æ­¤æ§è½å·²ä¸åæ¯éæ© ReentrantLock æ synchronized çå¤æ­å ç´ ã\n\næ¨èå¨ synchronized å ReentrantLock é½è½æ»¡è¶³çåºæ¯ä¼åä½¿ç¨ synchronizedï¼åå å¦ä¸ï¼\n\n * synchronized è¶³å¤æ¸æ°ï¼ç®åã\n * Lockè¦ç¡®ä¿å¨finallyä¸­éæ¾éãsynchronizedç±Javaèææºæ¥ä¿è¯ã\n * ä»é¿è¿çï¼Javaèææºæ´å®¹æéå¯¹synchronizedè¿è¡ä¼åãå ä¸ºJavaèææºéè¿å¨çº¿ç¨åå¯¹è±¡çåæ°æ®ä¸­è®°å½synchronizedä¸­éçç¸å³ä¿¡æ¯ï¼ä½¿ç¨Lockçè¯ï¼Javaèææºå¾é¾å¾ç¥å·ä½åªäºéå¯¹è±¡æ¯ç±ç¹å®çº¿ç¨æææçã\n\n\n# éé»å¡åæ­¥\n\näºæ¥åæ­¥é¢ä¸´çä¸»è¦é®é¢æ¯è¿è¡çº¿ç¨é»å¡åå¤ééå¸¦æ¥çæ§è½å¼éï¼å æ­¤è¿ç§åæ­¥ä¹è¢«ç§°ä¸ºé»å¡åæ­¥ï¼Blocking Synchronizationï¼ï¼å±äºæ²è§çå¹¶åç­ç¥ã\n\néé»å¡åæ­¥ï¼Non-Blocking Synchronizationï¼æ¯åºäºå²çªæ£æµçä¹è§å¹¶åç­ç¥ï¼å²çªäºåè¿è¡è¡¥å¿ï¼æå¸¸ç¨çè¡¥å¿æªæ½æ¯ä¸æ­éè¯ï¼ç´å°æ²¡æç«äºçå±äº«æ°æ®ä½ç½®ãä¹ç§°ä¸ºæ éï¼Lock-Freeï¼ç¼ç¨ã\n\nä¹è§å¹¶åç­ç¥éè¦ä¾èµç¡¬ä»¶æä»¤éçåå±ï¼å ä¸ºè¦ä¿è¯æä½åå²çªæ£æµè¿ä¸¤ä¸ªæ­¥éª¤å·å¤åå­æ§ã\n\nè¿ç±»æä»¤éå¸¸ç¨ï¼\n\n * æµè¯å¹¶è®¾ç½®ï¼Test and Setï¼\n * è·åå¹¶å¢å ï¼Fetch and Incrementï¼\n * äº¤æ¢ï¼Swapï¼\n * æ¯è¾å¹¶äº¤æ¢ï¼Compare and Swapï¼CASï¼\n * å è½½é¾æ¥/æ¡ä»¶å­å¨ï¼Load Linked/Store Conditionalï¼LL/SCï¼\n\nJavaéæç»æ´é²åºæ¥çæ¯CASæä½ï¼CASæä»¤éè¦æ3ä¸ªæä½æ°ï¼åå«æ¯åéçåå­å°åVï¼æ§çé¢æå¼Aï¼åå¤è®¾ç½®çæ°å¼BãCASæä»¤æ§è¡æ¶ï¼å½ä¸ä»å½Vç¬¦åAæ¶ï¼å¤çå¨æä¼ç¨Bæ´æ°Vçå¼ï¼å¦åä¸æ§è¡æ´æ°ãä½æ è®ºæ¯å¦æ§è¡æ´æ°ï¼é½ä¼è¿åVçæ§å¼ã\n\nå¨JDK 5ä¹åï¼ Javaç±»åºä¸­æå¼å§ä½¿ç¨CASæä½ï¼ è¯¥æä½ç±sun.misc.Unsafeç±»éé¢çcompareAndSwapInt()åcompareAndSwapLong()ç­å ä¸ªæ¹æ³åè£æä¾ã HotSpotèææºå¨åé¨å¯¹è¿äºæ¹æ³åäºç¹æ®å¤çï¼ å³æ¶ç¼è¯åºæ¥çç»æå°±æ¯ä¸æ¡å¹³å°ç¸å³çå¤çå¨CASæä»¤ï¼ æ²¡ææ¹æ³è°ç¨çè¿ç¨ã ä¸è¿ç±äºUnsafeç±»å¨è®¾è®¡ä¸å°±ä¸æ¯æä¾ç»ç¨æ·ç¨åºè°ç¨çç±»ï¼Unsafe::getUnsafe()çä»£ç ä¸­éå¶äºåªæå¯å¨ç±»å è½½å¨ï¼Bootstrap ClassLoaderï¼ å è½½çClassæè½è®¿é®å®ï¼ ï¼ å æ­¤å¨JDK 9ä¹ååªæJavaç±»åºå¯ä»¥ä½¿ç¨CASï¼ è­¬å¦J.U.Cåéé¢çæ´æ°åå­ç±»ï¼ å¶ä¸­çcompareAndSet()ågetAndIncrement()ç­æ¹æ³é½ä½¿ç¨äºUnsafeç±»çCASæä½æ¥å®ç°ã èå¦æç¨æ·ç¨åºä¹æä½¿ç¨CASæä½çéæ±ï¼ é£è¦ä¹å°±éç¨åå°ææ®µçªç ´Unsafeçè®¿é®éå¶ï¼ è¦ä¹å°±åªè½éè¿Javaç±»åºAPIæ¥é´æ¥ä½¿ç¨å®ã ç´å°JDK 9ä¹åï¼ Javaç±»åºæå¨VarHandleç±»éå¼æ¾äºé¢åç¨æ·ç¨åºä½¿ç¨çCASæä½ã\n\nä¸ºäºè§£å³CASçABAé®é¢ï¼J.U.Cåæä¾äºä¸ä¸ªå¸¦ææ è®°çåå­å¼ç¨ç±»AtomicStampedReferenceï¼å®å¯ä»¥éè¿æ§å¶åéå¼ççæ¬æ¥ä¿è¯CASçæ­£ç¡®æ§ãä¸ç®¡ç®åè¿ä¸ªç±»ç¸å½é¸¡èï¼å¤§é¨åæåµä¸ABAé®é¢ä¸ä¼å½±åç¨åºå¹¶åçæ­£ç¡®æ§ï¼å¦æéè¦è§£å³ABAé®é¢ï¼éç¨ä¼ ç»çäºæ¥åæ­¥å¯è½ä¼æ¯åå­ç±»æ´é«æã\n\n\n# æ åæ­¥æ¹æ¡\n\nçº¿ç¨æ¬å°å­å¨ï¼Thread Local Storageï¼ï¼å¦æä¸æ®µä»£ç ä¸­æéè¦çæ°æ®å¿é¡»ä¸å¶ä»ä»£ç å±äº«ï¼é£å°±ççè¿äºå±äº«æ°æ®çä»£ç è½å¦ä¿è¯åªå¨åä¸ä¸ªçº¿ç¨ä¸­æ§è¡ãå¦æè½ä¿è¯ï¼å°±å¯ä»¥æå±äº«æ°æ®çå¯è§èå´éå¶å¨åä¸ä¸ªçº¿ç¨ä¹åï¼è¿æ ·æ é¡»åæ­¥ä¹è½ä¿è¯çº¿ç¨ä¹é´ä¸åºç°æ°æ®ç«äºçé®é¢ã\n\nç¬¦åè¿ç§ç¹ç¹çåºç¨å¹¶ä¸å°è§ï¼å¤§é¨åä½¿ç¨æ¶è´¹éåçæ¶ææ¨¡å¼ï¼egï¼çäº§è-æ¶è´¹èæ¨¡å¼ï¼é½ä¼å°äº§åçæ¶è´¹è¿ç¨éå¶å¨ä¸ä¸ªçº¿ç¨ä¸­æ¶è´¹å®ï¼å¶ä¸­æéè¦çä¸ç§åºç¨å®ä¾å°±æ¯ç»å¸Webäº¤äºæ¨¡åä¸­çâä¸ä¸ªè¯·æ±å¯¹åºä¸ä¸ªæå¡å¨çº¿ç¨âï¼Thread-pre-Requestï¼çå¤çæ¹å¼ï¼è¿ç§å¤çæ¹å¼çå¹¿æ³åºç¨ä½¿å¾å¾å¤Webæå¡ç«¯åºç¨é½å¯ä»¥ä½¿ç¨çº¿ç¨æ¬å°å­å¨æ¥è§£å³çº¿ç¨å®å¨é®é¢ã\n\nJavaä¸­ï¼å¦æä¸ä¸ªåéè¦è¢«å¤çº¿ç¨è®¿é®ï¼å¯ä»¥ä½¿ç¨ volatileå°å¶å£°æä¸ºâæåçâãå¦æä¸ä¸ªåéåªè¦è¢«æä¸ªçº¿ç¨ç¬äº«ï¼å¯ä»¥éè¿ java.lang.ThreadLocalç±»æ¥å®ç°çº¿ç¨æ¬å°å­å¨çåè½ãæ¯ä¸ä¸ªçº¿ç¨çThreadå¯¹è±¡ä¸­é½æä¸ä¸ªThreadLocalMapå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡å­å¨äºä¸ç»ä»¥ThreadLocal.threadLocalHashCodeä¸ºé®ï¼ä»¥æ¬å°çº¿ç¨åéä¸ºå¼çé®å¼å¯¹ï¼ThreadLocalå¯¹è±¡å°±æ¯å½åçº¿ç¨çThreadLocalMapçè®¿é®å¥å£ï¼æ¯ä¸ä¸ªThreadLocalå¯¹è±¡é½åå«äºä¸ä¸ªç¬ä¸æ äºçthreadLocalHashCodeï¼è¿ä¸ªå¼å°±å¯ä»¥å¨çº¿ç¨é®å¼å¯¹ä¸­æ¾å°å¯¹åºçæ¬å°çº¿ç¨åéã\n\n\n# éä¼å\n\nJDK 6ï¼èææºå¢ééè¿è¡äºå¤ç§ä¼åï¼æï¼\n\n * éåºæ§èªæ Adaptive Spinning\n * éæ¶é¤ Lock Elimination\n * éè¨è Lock Coarsening\n * è½»éçº§é Lightweight Locking\n * ååé Biased Locking\n\n\n# èªæéä¸èªéåºèªæ\n\näºæ¥åæ­¥å¯¹æ§è½æå¤§çå½±åæ¯é»å¡çå®ç°ï¼ æèµ·çº¿ç¨åæ¢å¤çº¿ç¨çæä½é½éè¦è½¬å¥åæ ¸æä¸­å®æï¼ è¿äºæä½ç»Javaèææºçå¹¶åæ§è½å¸¦æ¥äºå¾å¤§çååã åæ¶ï¼ æä»¬æ³¨æå°å¨è®¸å¤åºç¨ä¸ï¼ å±äº«æ°æ®çéå®ç¶æåªä¼æç»­å¾ç­çä¸æ®µæ¶é´ï¼ ä¸ºäºè¿æ®µæ¶é´å»æèµ·åæ¢å¤çº¿ç¨å¹¶ä¸å¼å¾ãå¦æç©çæºå¨æä¸ä¸ªä»¥ä¸çå¤çå¨æèå¤çå¨æ ¸å¿ï¼ è½è®©ä¸¤ä¸ªæä»¥ä¸ççº¿ç¨åæ¶å¹¶è¡æ§è¡ï¼ æä»¬ å°±å¯ä»¥è®©åé¢è¯·æ±éçé£ä¸ªçº¿ç¨âç¨ç­ä¸ä¼âï¼ ä½ä¸æ¾å¼å¤çå¨çæ§è¡æ¶é´ï¼ ççææéççº¿ç¨æ¯å¦å¾å¿«å°±ä¼éæ¾éã ä¸ºäºè®©çº¿ç¨ç­å¾ï¼ æä»¬åªé¡»è®©çº¿ç¨æ§è¡ä¸ä¸ªå¿å¾ªç¯ï¼èªæï¼ ï¼ è¿é¡¹ææ¯å°±æ¯æè°çèªæéã\n\nèªæéå¨1.4.2ä¸­å°±å¼è¿äºï¼ä¸è¿é»è®¤æ¯å³é­çãJDK 6å¼å§æ¹ä¸ºé»è®¤å¼å¯ãé»è®¤èªæ10æ¬¡ã\n\nJDK 6 å¯¹èªæéçä¼åï¼å¼å¥äºèªéåºçèªæãèªéåºèªææå³çèªææ¬¡æ°ä¸åæ¯åºå®çäºï¼ç±åä¸æ¬¡å¨åä¸ä¸ªéä¸çèªææ¶é´ä»¥åéçæ¥æèçç¶æå³å®ãå¦æåä¸ä¸ªéå¯¹è±¡ä¸ï¼èªæç­å¾ååæåè·å¾è¿éï¼å¹¶ä¸ææéççº¿ç¨æ­£å¨è¿è¡ä¸­ï¼é£ä¹èææºå°±ä¼è®¤ä¸ºè¿æ¬¡èªæä¹å¾æå¯è½åæ¬¡æåï¼è¿èåè®¸èªæç­å¾æç»­æ´é¿çæ¶é´ãå¦æéåæä¸ªéï¼èªæå¾å°æåè·å¾è¿éï¼é£ä»¥åè¦è·åè¿ä¸ªéå°å¯è½ç´æ¥çç¥èªæè¿ç¨ã\n\n\n# éæ¶é¤\n\néæ¶é¤æ¯æèææºå³æ¶ç¼è¯å¨å¨è¿è¡æ¶ï¼å¯¹ä¸äºä»£ç è¦æ±åæ­¥ï¼ä½æ¯å¯¹è¢«æ£æµå°ä¸å¯è½å­å¨å±äº«æ°æ®ç«äºçéè¿è¡æ¶é¤ã\n\néæ¶é¤çä¸»è¦å¤æ­ä¾æ®æ¥æºäºéé¸åæçæ°æ®æ¯æã\n\nå¦æå¤æ­å°ä¸æ®µä»£ç ï¼å¨å ä¸çæææ°æ®é½ä¸ä¼éé¸åºå»è¢«å¶ä»çº¿ç¨è®¿é®å°ï¼é£å°±å¯ä»¥æä»ä»¬å½åæ ä¸æ°æ®å¯¹å¾ï¼è®¤ä¸ºä»ä»¬æ¯çº¿ç¨ç§æçï¼åæ­¥å éèªç¶å°±ä¸ç¨åè¿è¡äºã\n\n\n# éç²å\n\nå¦æèææºæ£æµå°æä¸ä¸²é¶ç¢çæä½é½å¯¹åä¸ä¸ªå¯¹è±¡å éï¼å°±ä¼æå éåæ­¥çèå´ç²åå°æ´ä¸ªæä½åºåçå¤é¨ã\n\n\n# è½»éçº§é\n\nè½»éçº§éå¹¶ä¸æ¯æ¥æ¿ä»£ééçº§éçï¼å®çè®¾è®¡åè¡·æ¯å¨æ²¡æå¤çº¿ç¨ç«äºçåæä¸ï¼åå°ä¼ ç»çééçº§éä½¿ç¨æä½ç³»ç»äºæ¥éçæ§è½æ¶èã\n\n\n\nå¨ä»£ç å³å°è¿å¥åæ­¥åæ¶ï¼å¦ææ­¤åæ­¥å¯¹è±¡æ²¡æè¢«éå®ï¼éæ å¿ä½ä¸ºâ01âç¶æï¼ï¼èææºé¦åå°å¨å½åçº¿ç¨çæ å¸§ä¸­ç®åä¸ä¸ªåä¸ºéè®°å½ï¼Lock Recordï¼çç©ºé´ï¼ç¨äºå­å¨éå¯¹è±¡ç®åçMark Wordçæ·è´ã\n\nç¶åèææºå°ä½¿ç¨ CASæä½å°è¯æå¯¹è±¡çMark Wordæ´æ°ä¸ºæåLock Record çæéã\n\nå¦ææ´æ°å¨ä½æåäºï¼ä»£è¡¨è¯¥çº¿ç¨æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼å¹¶ä¸å¯¹è±¡Mark Wordçéæ å¿ä½ï¼Mark Wordçæåä¸¤ä¸ªæ¯ç¹ï¼å°åä¸ºâ00âï¼è¡¨ç¤ºæ­¤å¯¹è±¡æ­£å¤äºè½»éçº§éå®ç¶æã\n\nå¦ææ´æ°æä½å¤±è´¥äºï¼æå³çæçº¿ç¨ä¸å½åçº¿ç¨ç«äºè¯¥å¯¹è±¡çéãèææºé¦åä¼æ£æ¥å¯¹è±¡çMark Wordæ¯å¦æåå½åçº¿ç¨çæ å¸§ï¼å¦ææ¯ï¼è¯´æå½åçº¿ç¨å·²ç»æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼ç´æ¥è¿å¥åæ­¥åãå¦åè¯´æè¿ä¸ªéå¯¹è±¡ç»å¶ä»çº¿ç¨æ¢å äºï¼æ­¤æ¶è½»éçº§éåçº§ä¸ºééçº§éï¼éæ å¿ä½ç¶æåä¸ºâ10âã\n\nè½»éçº§éè½æåç¨åºåæ­¥æ§è½çä¾æ®æ¯âå¯¹äºç»å¤§é¨åçéï¼å¨æ´ä¸ªåæ­¥å¨æåé½æ¯ä¸å­å¨ç«äºçâãå¦ææ²¡æç«äºï¼è½»éçº§éä¾¿éè¿CASæä½æåé¿åäºä½¿ç¨äºæ¥éçå¼éãä½å¦æç¡®å®å­å¨éç«äºï¼é¤äºäºæ¥éæ¬èº«çå¼éå¤ï¼è¿é¢å¤åçäºCASçå¼éãå æ­¤å¨æç«äºçæåµä¸ï¼è½»éçº§éåèä¼æ¯ä¼ ç»çééçº§éæ´æ¢ã\n\n\n# ååé\n\nååéçç®çæ¯æ¶é¤æ°æ®å¨æ ç«äºæåµä¸çåæ­¥åè¯­ãå¦æè¯´è½»éçº§éæ¯å¨æ ç«äºçæåµä¸ä½¿ç¨CASæä½å»æ¶é¤åæ­¥ä½¿ç¨çäºæ¥éï¼é£ååéå°±æ¯å¨æ ç«äºæåµä¸ææ´ä¸ªåæ­¥é½æ¶é¤æï¼è¿CASæä½é½ä¸åã\n\nè¿ä¸ªéä¼ååäºç¬¬ä¸ä¸ªè·å¾å®ççº¿ç¨ï¼å¦æå¨æ¥ä¸æ¥çæ§è¡è¿ç¨ä¸­ï¼è¯¥éä¸ç´æ²¡æè¢«å¶ä»ççº¿ç¨è·åï¼åææååéççº¿ç¨å°æ°¸è¿ä¸éè¦åè¿è¡åæ­¥ã\n\nååéé»è®¤æ¯å¼å¯çãå½éå¯¹è±¡ç¬¬ä¸æ¬¡è¢«çº¿ç¨è·åæ¶ï¼èææºä¼æå¯¹è±¡å¤´ä¸­çæ å¿ä½è®¾ç½®ä¸ºâ01âãæååæ¨¡å¼è®¾ç½®ä¸º1ï¼è¡¨ç¤ºè¿å¥ååæ¨¡å¼ãåæ¶ä½¿ç¨CASæä½æè·åå°è¿ä¸ªéççº¿ç¨IDè®°å½å¨å¯¹è±¡çMark Wordä¸­ãæCASæä½æåï¼ ææååéççº¿ç¨ä»¥åæ¯æ¬¡è¿å¥è¿ä¸ªéç¸å³çåæ­¥åæ¶ï¼ èææºé½å¯ä»¥ä¸åè¿è¡ä»»ä½åæ­¥æä½ï¼ä¾å¦å éã è§£éåå¯¹Mark Wordçæ´æ°æä½ç­ï¼ã\n\nä¸æ¦åºç°å¦å¤ä¸ä¸ªçº¿ç¨å»å°è¯è·åè¿ä¸ªéçæåµï¼ ååæ¨¡å¼å°±é©¬ä¸å®£åç»æã æ ¹æ®éå¯¹è±¡ç®åæ¯å¦å¤äºè¢«éå®çç¶æå³å®æ¯å¦æ¤éååï¼ååæ¨¡å¼è®¾ç½®ä¸ºâ0âï¼ ï¼ æ¤éåæ å¿ä½æ¢å¤å°æªéå®ï¼æ å¿ä½ä¸ºâ01âï¼ æè½»éçº§éå®ï¼æ å¿ä½ä¸ºâ00âï¼ çç¶æï¼ åç»­çåæ­¥æä½å°±æç§ä¸é¢ä»ç»çè½»éçº§éé£æ ·å»æ§è¡ã\n\n\n\nå¦æç¨åºä¸­å¤§å¤æ°çéé½æ»æ¯è¢«å¤ä¸ªä¸åççº¿ç¨è®¿é®ï¼é£ä¹ååæ¨¡å¼å°±æ¯å¤ä½çãææ¶ä½¿ç¨åæ° -XX:-UseBisedLocking=falseæ¥ç¦æ­¢ååéä¼ååèå¯ä»¥æåæ§è½ã\n\nï¼JDK 15 åºå¼ååéï¼',normalizedContent:'# ç¼è¯å¨åè§£éå¨\n\n * ç±»å1ï¼cãc++\n * ç±»å2ï¼javascriptãpythonãphp\n * ç±»å3ï¼java\n\nå¯¹äºç±»å1ï¼æä»¬ä¸è¬ç§°ä¸ºç¼è¯åè¯­è¨ï¼ä¹å°±æ¯éè¦ç¨å°ç¼è¯å¨è¿è¡ç¼è¯ã\n\nå¯¹äºç±»å2ï¼æä»¬ä¸è¬ç§°ä¸ºè§£éåè¯­è¨ï¼ææ¯èæ¬è¯­è¨ï¼ä¹å°±æ¯è¦ç¨è§£éå¨è¿è¡è§£éã\n\nç¼è¯å¨ä¸è§£éå¨å°±ç±»ä¼¼äºç¬è¯å·¥ä½èä¸å£è¯å·¥ä½èçåºå«ï¼ç¼è¯å¨å°±æ¯ç¬è¯å·¥ä½èï¼èè§£éå¨å°±æ¯å£è¯å·¥ä½èã\n\n * ç¼è¯å¨å¨ç¼è¯çè¿ç¨ä¸­ï¼è¯»å¥æºç¨åºæä»¶ï¼è¾åºä¸ä»½ç­ä»·çäºè¿å¶å¯æ§è¡æä»¶ï¼å°±åç¬è¯å·¥ä½èä¸æ ·ï¼ä»ä»¬é½ä¼è¾åºä¸ä»½ç¿»è¯åçæä»¶ã\n * è§£éå¨å¨è§£éçè¿ç¨ä¸­ï¼è¯»å¥æºç¨åºæä»¶ï¼è¾åºçæ¯æ§è¡çç»æï¼å°±åå£è¯å·¥ä½èä¸æ ·ï¼ä»ä»¬è¾åºçæ¯å·²ç»å®æç¿»è¯çç»æã\n\nè§£éå¨ï¼\n\n * ä¼ç¹ï¼è·¨å¹³å°ãå¯å¨éåº¦å¿«ãå¼åæçé«\n\n * ç¼ºç¹ï¼æ§è¡éåº¦æ¢ï¼æ§è¡æçä½\n\nç¼è¯å¨ï¼\n\n * ä¼ç¹ï¼æ§è¡éåº¦å¿«ãæ§è¡æçé«\n * ç¼ºç¹ï¼å¹³å°ç¸å³æ§é«ï¼ç¼è¯éåº¦ï¼å¯å¨éåº¦ï¼æ¢ï¼å¼åæçä½\n\njavaæ¢æç¼è¯å¨ï¼ä¸æ­¢ä¸ä¸ªï¼åæè§£éå¨ã\n\njavaä¸­ç¼è¯å¨æ¯è¾å¤ï¼å®åå«ä¸ä¸ªåç«¯ç¼è¯å¨ï¼ä¸ä¸ªåç«¯ç¼è¯å¨ï¼jitï¼ä»¥åä¸ä¸ªéæé¢ç¼è¯å¨ï¼aotï¼ã\n\n * åç«¯ç¼è¯å¨çåè½æ¯ä»æºä»£ç çæjavaå­èç ï¼ä¹å°±æ¯ä¸­é´ä»£ç ï¼\n * åç«¯ç¼è¯å¨ï¼ä¹å«ä½å³æ¶ç¼è¯å¨ï¼jitï¼å®æ¯åå«å¨äºjvmä¸­ï¼ç¨äºå¨æ§è¡çè¿ç¨ä¸­ï¼å°ç­ç¹ä»£ç ï¼ä¹å°±æ¯æ§è¡æ¬¡æ°æ¯è¾å¤çä»£ç ï¼è½¬åä¸ºæ¬å°æºå¨ç ï¼å¹¶åä¸äºä¼åï¼ä»¥å éæ§è¡æçã\n * éæé¢ç¼è¯å¨ï¼aotï¼å®æ¯ç´æ¥å°javaæºä»£ç ç¼è¯ææ¬å°æºå¨ç ï¼ä¹å°±æ¯ä¼ ç»æä¹ä¸çç¼è¯å¨ï¼ä½ç¨çä¸å¤ï¼å ä¸ºè¿æ ·ä¼ä½¿javaçä¸äºç¹æ§ä¸¢å¤±ã\n\njavaä¸­çè§£éå¨ä¸jitä¸èµ·æåï¼ä½ä¸ºjvmä¸­çæ§è¡å¼æï¼è§£éå¨ä¸»è¦å°å­èç è¿è¡è§£éæ§è¡ï¼åæ¶éåjitè¿è¡ä»£ç çä¼åæä½ã\n\njavaè§£éå¨å°±æ¯æå¨javaèææºä¸è¿è¡çç®æ ä»£ç ï¼å­èç ï¼è§£éæä¸ºå·ä½å¹³å°çæºå¨ç çç¨åºãå³jdkæjreç®å½ä¸binç®å½ä¸­çjava.exeæä»¶ï¼èjavac.exeæ¯ç¼è¯å¨ã\n\nè¿è¡javaç¨åºçè¿ç¨æ¯åç¨javacç¼è¯ï¼ç¶åç¨javaè§£éãèä¸ç»ç¼è¯æååï¼å°±å¯ä»¥ç´æ¥ç¨java.exeéå¤è§£éè¿è¡äºã\n\njvmè´è´£è¿è¡å­èç ï¼jvmææ¯ä¸æ¡è¦æ§è¡çå­èç äº¤ç»è§£éå¨ï¼ç¿»è¯æå¯¹åºçæºå¨ç ï¼ç¶åç±è§£éå¨æ§è¡ãjvmè§£éæ§è¡å­èç æä»¶å°±æ¯jvmæä½javaè§£éå¨è¿è¡è§£éæ§è¡å­èç æä»¶çè¿ç¨ã\n\n\n# javaåå­åºå\n\njavaææ§å¶åå­çæå©äº¤ç»äºjava èææºï¼ä¸æ¦åºç°åå­æ³æ¼åæº¢åºæ¹é¢çé®é¢ï¼å¦æä¸äºè§£èææºæ¯ææ ·ä½¿ç¨åå­çï¼é£ææ¥éè¯¯ãä¿®æ­£é®é¢å°æä¸ºä¸é¡¹è°é¾çå·¥ä½ã\n\n\n# è¿è¡æ¶æ°æ®åº\n\nãjavaèææºè§èã ï¼âæ¦å¿µæ¨¡åâè¿ä¸ªè¯ä¼ç»å¸¸è¢«æåï¼ å®ä»£è¡¨äºææèææºçç»ä¸å¤è§ï¼ ä½åæ¬¾å·ä½çjavaèææºå¹¶ä¸ ä¸å®è¦å®å¨ç§çæ¦å¿µæ¨¡åçå®ä¹æ¥è¿è¡è®¾è®¡ï¼ å¯è½ä¼éè¿ä¸äºæ´é«æççç­ä»·æ¹å¼å»å®ç°å®ã\n\n\n# ç¨åºè®¡æ°å¨\n\nå½åçº¿ç¨ææ§è¡çå­èç çè¡å·ãå­èç è§£éå¨å°±æ¯éè¿æ¹åè¿ä¸ªè®¡æ°å¨çå¼æ¥éåä¸ä¸æ¡éè¦æ§è¡çå­èç æä»¤ã\n\nç¨åºè®¡æ°å¨ä¸»è¦æä¸¤ä¸ªä½ç¨ï¼\n\n 1. å­èç è§£éå¨éè¿æ¹åç¨åºè®¡æ°å¨æ¥ä¾æ¬¡è¯»åæä»¤ï¼ä»èå®ç°ä»£ç çæµç¨æ§å¶ï¼å¦ï¼é¡ºåºæ§è¡ãéæ©ãå¾ªç¯ãå¼å¸¸å¤çã\n 2. å¨å¤çº¿ç¨çæåµä¸ï¼ç¨åºè®¡æ°å¨ç¨äºè®°å½å½åçº¿ç¨æ§è¡çä½ç½®ï¼ä»èå½çº¿ç¨è¢«åæ¢åæ¥çæ¶åè½å¤ç¥éè¯¥çº¿ç¨ä¸æ¬¡è¿è¡å°åªå¿äºã\n\næ³¨æï¼ç¨åºè®¡æ°å¨æ¯å¯ä¸ä¸ä¸ªä¸ä¼åºç° outofmemoryerror çåå­åºåï¼å®ççå½å¨æéççº¿ç¨çåå»ºèåå»ºï¼éççº¿ç¨çç»æèæ­»äº¡ã\n\n\n# javaèææºæ \n\næè¿°çæ¯javaæ¹æ³æ§è¡ççº¿ç¨åå­æ¨¡åï¼æ¯ä¸ªæ¹æ³è¢«æ§è¡æ¶ï¼javaèææºé½ä¼åæ­¥åå»ºä¸ä¸ªæ å¸§ï¼stack frameï¼ç¨äºå­å¨å±é¨åéè¡¨ãæä½æ°æ ãå¨æè¿æ¥ãæ¹æ³åºå£ç­ä¿¡æ¯ãæ¯ä¸ªæ¹æ³ä»è¢«è°ç¨å°æ§è¡å®æ¯çè¿ç¨ï¼å°±å¯¹åºè¿ä¸ä¸ªæ å¸§å¨èææºæ çå¥æ ååºæ è¿ç¨ã\n\nå±é¨åéè¡¨ä¸»è¦å­æ¾äºç¼è¯æå¯ç¥çåç§æ°æ®ç±»åï¼booleanãbyteãcharãshortãintãfloatãlongãdoubleï¼ãå¯¹è±¡å¼ç¨ï¼reference ç±»åï¼å®ä¸åäºå¯¹è±¡æ¬èº«ï¼å¯è½æ¯ä¸ä¸ªæåå¯¹è±¡èµ·å§å°åçå¼ç¨æéï¼ä¹å¯è½æ¯æåä¸ä¸ªä»£è¡¨å¯¹è±¡çå¥ææå¶ä»ä¸æ­¤å¯¹è±¡ç¸å³çä½ç½®ï¼ã\n\njava èææºæ ä¼åºç°ä¸¤ç§éè¯¯ï¼stackoverflowerror å outofmemoryerrorã\n\n * stackoverflowerrorï¼ è¥ java èææºæ çåå­å¤§å°ä¸åè®¸å¨ææ©å±ï¼é£ä¹å½çº¿ç¨è¯·æ±æ çæ·±åº¦è¶è¿å½å java èææºæ çæå¤§æ·±åº¦çæ¶åï¼å°±æåº stackoverflowerror éè¯¯ã\n * outofmemoryerrorï¼ java èææºæ çåå­å¤§å°å¯ä»¥å¨ææ©å±ï¼ å¦æèææºå¨å¨ææ©å±æ æ¶æ æ³ç³è¯·å°è¶³å¤çåå­ç©ºé´ï¼åæåºoutofmemoryerrorå¼å¸¸ã\n\nhotspotèææºçæ å®¹éæ¯ä¸å¯ä»¥å¨ææ©å±çï¼ ä»¥åçclassicèææºåæ¯å¯ä»¥ã æä»¥å¨hotspotèææºä¸æ¯ä¸ä¼ç±äºèææºæ æ æ³æ©å±èå¯¼è´outofmemoryerrorå¼å¸¸ââåªè¦çº¿ç¨ç³è¯·æ ç©ºé´æåäºå°±ä¸ä¼æoomï¼ ä½æ¯å¦æç³è¯·æ¶å°±å¤±è´¥ï¼ ä»ç¶æ¯ä¼åºç°oomå¼å¸¸çã\n\n\n# æ¬å°æ¹æ³æ \n\næ¬å°æ¹æ³æ ï¼native method stacksï¼ ä¸èææºæ æåæ¥çä½ç¨æ¯éå¸¸ç¸ä¼¼çï¼ å¶åºå«åªæ¯èææºæ ä¸ºèææºæ§è¡javaæ¹æ³ï¼ä¹å°±æ¯å­èç ï¼ æå¡ï¼ èæ¬å°æ¹æ³æ åæ¯ä¸ºèææºä½¿ç¨å°çæ¬å°ï¼nativeï¼æ¹æ³æå¡ã\n\nå¨ hotspot èææºä¸­å java èææºæ åäºä¸ºä¸ã\n\n\n# å \n\njava èææºæç®¡ççåå­ä¸­æå¤§çä¸åï¼java å æ¯ææçº¿ç¨å±äº«çä¸ååå­åºåï¼å¨èææºå¯å¨æ¶åå»ºãæ­¤åå­åºåçå¯ä¸ç®çå°±æ¯å­æ¾å¯¹è±¡å®ä¾ï¼å ä¹ææçå¯¹è±¡å®ä¾ä»¥åæ°ç»é½å¨è¿éåéåå­ã\n\njava ä¸çä¸­âå ä¹âææçå¯¹è±¡é½å¨å ä¸­åéï¼ä½æ¯ï¼éç jit ç¼è¯å¨çåå±ä¸éé¸åæææ¯éæ¸æçï¼æ ä¸åéãæ éæ¿æ¢ä¼åææ¯å°ä¼å¯¼è´ä¸äºå¾®å¦çååï¼ææçå¯¹è±¡é½åéå°å ä¸ä¹æ¸æ¸åå¾ä¸é£ä¹âç»å¯¹âäºãä» jdk 1.7 å¼å§å·²ç»é»è®¤å¼å¯éé¸åæï¼å¦ææäºæ¹æ³ä¸­çå¯¹è±¡å¼ç¨æ²¡æè¢«è¿åæèæªè¢«å¤é¢ä½¿ç¨ï¼ä¹å°±æ¯æªéé¸åºå»ï¼ï¼é£ä¹å¯¹è±¡å¯ä»¥ç´æ¥å¨æ ä¸åéåå­ã\n\njava å æ¯åå¾æ¶éå¨ç®¡ççä¸»è¦åºåï¼å æ­¤ä¹è¢«ç§°ä½gc å ï¼garbage collected heapï¼ãä»åå¾åæ¶çè§åº¦ï¼ç±äºç°å¨æ¶éå¨åºæ¬é½éç¨åä»£åå¾æ¶éç®æ³ï¼æä»¥ java å è¿å¯ä»¥ç»åä¸ºï¼æ°çä»£åèå¹´ä»£ï¼åç»è´ä¸ç¹æï¼eden ç©ºé´ãfrom survivorãto survivor ç©ºé´ç­ãè¿ä¸æ­¥ååçç®çæ¯æ´å¥½å°åæ¶åå­ï¼æèæ´å¿«å°åéåå­ã\n\nä»åæ¶åå­çè§åº¦çï¼ ç±äºç°ä»£åå¾æ¶éå¨å¤§é¨åé½æ¯åºäºåä»£æ¶éçè®ºè®¾è®¡çï¼ æä»¥javaå ä¸­ç»å¸¸ä¼åºç°âæ°çä»£ââèå¹´ä»£ââæ°¸ä¹ä»£ââedenç©ºé´ââfrom survivorç©ºé´ââto survivorç©ºé´âç­åè¯ï¼ è¿äºåºåååä»ä»æ¯ä¸é¨ååå¾æ¶éå¨çå±åç¹æ§æèè¯´è®¾è®¡é£æ ¼èå·²ï¼ èéæä¸ªjavaèææºå·ä½å®ç°çåºæåå­å¸å±ï¼ æ´ä¸æ¯ãjavaèææºè§èã éå¯¹javaå çè¿ä¸æ­¥ç»è´ååã ä¸å°èµæä¸ç»å¸¸åçç±»ä¼¼äºâjavaèææºçå åå­åä¸ºæ°çä»£ã èå¹´ä»£ã æ°¸ä¹ä»£ã edenã survivorâ¦â¦âè¿æ ·çåå®¹ã å¨åå¹´ä¹åï¼ä»¥g1æ¶éå¨çåºç°ä¸ºåçï¼ ï¼ ä½ä¸ºä¸çç»å¯¹ä¸»æµçhotspotèææºï¼ å®åé¨çåå¾æ¶éå¨å¨é¨é½åºäºâç»å¸åä»£â[3]æ¥è®¾è®¡ï¼ éè¦æ°çä»£ã èå¹´ä»£æ¶éå¨æ­éæè½å·¥ä½ï¼ ä½ç°å¨ä¸å¯åæ¥èè¯­ï¼ä¹åºç°äºä¸éç¨åä»£è®¾è®¡çåå¾åæ¶å¨ã\n\nå¨ jdk 7 çæ¬å jdk 7 çæ¬ä¹åï¼å åå­è¢«éå¸¸åä¸ºä¸é¢ä¸é¨åï¼\n\n 1. æ°çä»£åå­(young generation)\n 2. èçä»£(old generation)\n 3. æ°¸çä»£(permanent generation)\n\njdk 8 çæ¬ä¹åæ¹æ³åºï¼hotspot çæ°¸ä¹ä»£ï¼è¢«å½»åºç§»é¤äºï¼jdk1.7 å°±å·²ç»å¼å§äºï¼ï¼åèä»£ä¹æ¯åç©ºé´ï¼åç©ºé´ä½¿ç¨çæ¯ç´æ¥åå­ã\n\nä¸å¾æç¤ºç eden åºãä¸¤ä¸ª survivor åºé½å±äºæ°çä»£ï¼ä¸ºäºåºåï¼è¿ä¸¤ä¸ª survivor åºåæç§é¡ºåºè¢«å½åä¸º from å toï¼ï¼ä¸­é´ä¸å±å±äºèå¹´ä»£ã\n\nå¤§é¨åæåµï¼å¯¹è±¡é½ä¼é¦åå¨ eden åºååéï¼å¨ä¸æ¬¡æ°çä»£åå¾åæ¶åï¼å¦æå¯¹è±¡è¿å­æ´»ï¼åä¼è¿å¥ s0 æè s1ï¼å¹¶ä¸å¯¹è±¡çå¹´é¾è¿ä¼å  1(eden åº->survivor åºåå¯¹è±¡çåå§å¹´é¾åä¸º 1)ï¼å½å®çå¹´é¾å¢å å°ä¸å®ç¨åº¦ï¼é»è®¤ä¸º 15 å²ï¼ï¼å°±ä¼è¢«æåå°èå¹´ä»£ä¸­ãå¯¹è±¡æåå°èå¹´ä»£çå¹´é¾éå¼ï¼å¯ä»¥éè¿åæ° -xx:maxtenuringthreshold æ¥è®¾ç½®ã\n\nhotspot éåææå¯¹è±¡æ¶ï¼æç§å¹´é¾ä»å°å°å¤§å¯¹å¶æå ç¨çå¤§å°è¿è¡ç´¯ç§¯ï¼å½ç´¯ç§¯çæä¸ªå¹´é¾å¤§å°è¶è¿äº survivor åºçä¸åæ¶ï¼åè¿ä¸ªå¹´é¾å maxtenuringthreshold ä¸­æ´å°çä¸ä¸ªå¼ï¼ä½ä¸ºæ°çæåå¹´é¾éå¼ã\n\nå è¿éæå®¹æåºç°çå°±æ¯ outofmemoryerror éè¯¯ï¼å¹¶ä¸åºç°è¿ç§éè¯¯ä¹åçè¡¨ç°å½¢å¼è¿ä¼æå ç§ï¼æ¯å¦ï¼\n\n 1. java.lang.outofmemoryerror: gc overhead limit exceeded ï¼ å½ jvm è±å¤ªå¤æ¶é´æ§è¡åå¾åæ¶å¹¶ä¸åªè½åæ¶å¾å°çå ç©ºé´æ¶ï¼å°±ä¼åçæ­¤éè¯¯ã\n 2. java.lang.outofmemoryerror: java heap space :åå¦å¨åå»ºæ°çå¯¹è±¡æ¶, å åå­ä¸­çç©ºé´ä¸è¶³ä»¥å­æ¾æ°åå»ºçå¯¹è±¡, å°±ä¼å¼åæ­¤éè¯¯ã(åéç½®çæå¤§å åå­æå³ï¼ä¸åå¶äºç©çåå­å¤§å°ãæå¤§å åå­å¯éè¿-xmxåæ°éç½®ï¼-xmsè®¾ç½®åå§å åå­ï¼è¥æ²¡æç¹å«éç½®ï¼å°ä¼ä½¿ç¨é»è®¤å¼ï¼è¯¦è§ï¼default java 8 max heap size (opens new window))\n\n\n# æ¹æ³åº\n\næ¹æ³åºä¸ java å ä¸æ ·ï¼æ¯åä¸ªçº¿ç¨å±äº«çåå­åºåï¼å®ç¨äºå­å¨å·²è¢«èææºå è½½çç±»ä¿¡æ¯ãå¸¸éãéæåéãå³æ¶ç¼è¯å¨ç¼è¯åçä»£ç ç­æ°æ®ãè½ç¶ java èææºè§èææ¹æ³åºæè¿°ä¸ºå çä¸ä¸ªé»è¾é¨åï¼ä½æ¯å®å´æä¸ä¸ªå«åå«å non-heapï¼éå ï¼ï¼ç®çåºè¯¥æ¯ä¸ java å åºåå¼æ¥ã\n\nè¯´å°æ¹æ³åºï¼ ä¸å¾ä¸æä¸ä¸âæ°¸ä¹ä»£âè¿ä¸ªæ¦å¿µï¼ å°¤å¶æ¯å¨jdk 8ä»¥åï¼ è®¸å¤javaç¨åºåé½ä¹ æ¯å¨hotspotèææºä¸å¼åã é¨ç½²ç¨åºï¼ å¾å¤äººé½æ´æ¿æææ¹æ³åºç§°å¼ä¸ºâæ°¸ä¹ä»£âï¼permanent generationï¼ ï¼ æå°ä¸¤èæ··ä¸ºä¸è°ã æ¬è´¨ä¸è¿ä¸¤èå¹¶ä¸æ¯ç­ä»·çï¼ å ä¸ºä»ä»æ¯å½æ¶çhotspotèææºè®¾è®¡å¢ééæ©ææ¶éå¨çåä»£è®¾è®¡æ©å±è³æ¹æ³åºï¼ æèè¯´ä½¿ç¨æ°¸ä¹ä»£æ¥å®ç°æ¹æ³åºèå·²ï¼ è¿æ ·ä½¿å¾hotspotçåå¾æ¶éå¨è½å¤åç®¡çjavaå ä¸æ ·ç®¡çè¿é¨ååå­ï¼ çå»ä¸é¨ä¸ºæ¹æ³åºç¼ååå­ç®¡çä»£ç çå·¥ä½ã ä½æ¯å¯¹äºå¶ä»èææºå®ç°ï¼ è­¬å¦bea jrockitã ibm j9ç­æ¥è¯´ï¼ æ¯ä¸å­å¨æ°¸ä¹ä»£çæ¦å¿µçã ååä¸å¦ä½å®ç°æ¹æ³åºå±äºèææºå®ç°ç»èï¼ ä¸åãjavaèææºè§èã ç®¡æï¼ å¹¶ä¸è¦æ±ç»ä¸ã ä½ç°å¨åå¤´æ¥çï¼ å½å¹´ä½¿ç¨æ°¸ä¹ä»£æ¥å®ç°æ¹æ³åºçå³å®å¹¶ä¸æ¯ä¸ä¸ªå¥½ä¸»æï¼ è¿ç§è®¾è®¡å¯¼è´äºjavaåºç¨æ´å®¹æéå°åå­æº¢åºçé®é¢ï¼æ°¸ä¹ä»£æ-xxï¼ maxpermsizeçä¸éï¼ å³ä½¿ä¸è®¾ç½®ä¹æé»è®¤å¤§å°ï¼ èj9åjrockitåªè¦æ²¡æè§¦ç¢°å°è¿ç¨å¯ç¨åå­çä¸éï¼ ä¾å¦32ä½ç³»ç»ä¸­ç4gbéå¶ï¼ å°±ä¸ä¼åºé®é¢ï¼ ï¼ èä¸ææå°æ°æ¹æ³ï¼ä¾å¦string::intern()ï¼ ä¼å æ°¸ä¹ä»£çåå èå¯¼è´ä¸åèææºä¸æä¸åçè¡¨ç°ã å½oracleæ¶è´­beaè·å¾äºjrockitçæææåï¼ åå¤æjrockitä¸­çä¼ç§åè½ï¼ è­¬å¦java mission controlç®¡çå·¥å·ï¼ ç§»æ¤å°hotspotèææºæ¶ï¼ ä½å ä¸ºä¸¤èå¯¹æ¹æ³åºå®ç°çå·®å¼èé¢ä¸´è¯¸å¤å°é¾ã\n\nèèå°hotspotæªæ¥çåå±ï¼ å¨jdk 6çæ¶åhotspotå¼åå¢éå°±ææ¾å¼æ°¸ä¹ä»£ï¼ éæ­¥æ¹ä¸ºéç¨æ¬å°åå­ï¼native memoryï¼ æ¥å®ç°æ¹æ³åºçè®¡åäº[1]ï¼ å°äºjdk 7çhotspotï¼ å·²ç»æåæ¬æ¾å¨æ°¸ä¹ä»£çå­ç¬¦ä¸²å¸¸éæ± ã éæåéç­ç§»åºï¼ èå°äºjdk 8ï¼ ç»äºå®å¨åºå¼äºæ°¸ä¹ä»£çæ¦å¿µï¼ æ¹ç¨ä¸jrockitã j9ä¸æ ·å¨æ¬å°åå­ä¸­å®ç°çåç©ºé´ï¼metaspaceï¼ æ¥ä»£æ¿ï¼ æjdk 7ä¸­æ°¸ä¹ä»£è¿å©ä½çåå®¹ï¼ä¸»è¦æ¯ç±»åä¿¡æ¯ï¼ å¨é¨ç§»å°åç©ºé´ä¸­ã\n\n//jdk 1.8 ä¹åæ°¸ä¹ä»£è¿æ²¡è¢«å½»åºç§»é¤çæ¶åéå¸¸éè¿ä¸é¢è¿äºåæ°æ¥è°èæ¹æ³åºå¤§å°\n-xx:permsize=n //æ¹æ³åº (æ°¸ä¹ä»£) åå§å¤§å°\n-xx:maxpermsize=n //æ¹æ³åº (æ°¸ä¹ä»£) æå¤§å¤§å°,è¶è¿è¿ä¸ªå¼å°ä¼æåº outofmemoryerror å¼å¸¸:java.lang.outofmemoryerror: permgen\n\n\njdk 1.8 çæ¶åï¼æ¹æ³åºï¼hotspot çæ°¸ä¹ä»£ï¼è¢«å½»åºç§»é¤äºï¼jdk1.7 å°±å·²ç»å¼å§äºï¼ï¼åèä»£ä¹æ¯åç©ºé´ï¼åç©ºé´ä½¿ç¨çæ¯ç´æ¥åå­ã\n\n//ä¸äºå¸¸ç¨åæ°ï¼\n-xx:metaspacesize=n //è®¾ç½® metaspace çåå§ï¼åæå°å¤§å°ï¼\n-xx:maxmetaspacesize=n //è®¾ç½® metaspace çæå¤§å¤§å°\n\n\nä¸æ°¸ä¹ä»£å¾å¤§çä¸åå°±æ¯ï¼å¦æä¸æå®å¤§å°çè¯ï¼éçæ´å¤ç±»çåå»ºï¼èææºä¼èå°½ææå¯ç¨çç³»ç»åå­ã\n\nè¿è¡æ¶å¸¸éæ± æ¯æ¹æ³åºçä¸é¨åãclass æä»¶ä¸­é¤äºæç±»ççæ¬ãå­æ®µãæ¹æ³ãæ¥å£ç­æè¿°ä¿¡æ¯å¤ï¼è¿æå¸¸éæ± è¡¨ï¼ç¨äºå­æ¾ç¼è¯æçæçåç§å­é¢éåç¬¦å·å¼ç¨ï¼ãæ¢ç¶è¿è¡æ¶å¸¸éæ± æ¯æ¹æ³åºçä¸é¨åï¼èªç¶åå°æ¹æ³åºåå­çéå¶ï¼å½å¸¸éæ± æ æ³åç³è¯·å°åå­æ¶ä¼æåº outofmemoryerror éè¯¯ã\n\njdk1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\njdk1.7å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ã\n\njdk1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(metaspace)ã\n\n\n# ç´æ¥åå­\n\nç´æ¥åå­å¹¶ä¸æ¯èææºè¿è¡æ¶æ°æ®åºçä¸é¨åï¼ä¹ä¸æ¯èææºè§èä¸­å®ä¹çåå­åºåï¼ä½æ¯è¿é¨ååå­ä¹è¢«é¢ç¹å°ä½¿ç¨ãèä¸ä¹å¯è½å¯¼è´ outofmemoryerror éè¯¯åºç°ã\n\njdk1.4 ä¸­æ°å å¥ç nio(new input/output) ç±»ï¼å¼å¥äºä¸ç§åºäºééï¼channelï¼ä¸ç¼å­åºï¼bufferï¼ç i/o æ¹å¼ï¼å®å¯ä»¥ç´æ¥ä½¿ç¨ native å½æ°åºç´æ¥åéå å¤åå­ï¼ç¶åéè¿ä¸ä¸ªå­å¨å¨ java å ä¸­ç directbytebuffer å¯¹è±¡ä½ä¸ºè¿ååå­çå¼ç¨è¿è¡æä½ãè¿æ ·å°±è½å¨ä¸äºåºæ¯ä¸­æ¾èæé«æ§è½ï¼å ä¸ºé¿åäºå¨ java å å native å ä¹é´æ¥åå¤å¶æ°æ®ã\n\næ¬æºç´æ¥åå­çåéä¸ä¼åå° java å çéå¶ï¼ä½æ¯ï¼æ¢ç¶æ¯åå­å°±ä¼åå°æ¬æºæ»åå­å¤§å°ä»¥åå¤çå¨å¯»åç©ºé´çéå¶ã\n\n\n# hotspotèææºå¯¹è±¡æ¢ç§\n\n> åºäºå®ç¨ä¼åçååï¼ ä»¥æå¸¸ç¨çèææºhotspotåæå¸¸ç¨çåå­åºåjavaå ä¸ºä¾ï¼ æ·±å¥æ¢è®¨ä¸ä¸hotspotèææºå¨javaå ä¸­å¯¹è±¡åéã å¸å±åè®¿é®çå¨è¿ç¨ã\n\n\n# å¯¹è±¡çåå»º\n\n\n\n 1. ç±»å è½½æ£æ¥ï¼èææºéå°ä¸æ¡ new æä»¤æ¶ï¼é¦åå°å»æ£æ¥è¿ä¸ªæä»¤çåæ°æ¯å¦è½å¨å¸¸éæ± ä¸­å®ä½å°è¿ä¸ªç±»çç¬¦å·å¼ç¨ï¼å¹¶ä¸æ£æ¥è¿ä¸ªç¬¦å·å¼ç¨ä»£è¡¨çç±»æ¯å¦å·²è¢«å è½½è¿ãè§£æååå§åè¿ãå¦ææ²¡æï¼é£å¿é¡»åæ§è¡ç¸åºçç±»å è½½è¿ç¨ã\n 2. åéåå­ï¼\n    1. åéæ¹å¼ï¼æâæéç¢°æâåâç©ºé²åè¡¨âä¸¤ç§ï¼åå³äºjavaå æ¯å¦è§æ´ï¼è¿åç±åå¾åæ¶å¨æ¯å¦å¸¦æåç¼©æ´çåè½å³å®ã\n    2. èææºä¿è¯çº¿ç¨å®å¨ï¼\n       1. cas+å¤±è´¥éè¯ï¼ cas æ¯ä¹è§éçä¸ç§å®ç°æ¹å¼ãæè°ä¹è§éå°±æ¯ï¼æ¯æ¬¡ä¸å éèæ¯åè®¾æ²¡æå²çªèå»å®ææé¡¹æä½ï¼å¦æå ä¸ºå²çªå¤±è´¥å°±éè¯ï¼ç´å°æåä¸ºæ­¢ãèææºéç¨ cas éä¸å¤±è´¥éè¯çæ¹å¼ä¿è¯æ´æ°æä½çåå­æ§ã\n       2. tlabï¼æ¬å°çº¿ç¨åéç¼å­ï¼ï¼ ä¸ºæ¯ä¸ä¸ªçº¿ç¨é¢åå¨ eden åºåéä¸åå¿åå­ï¼jvm å¨ç»çº¿ç¨ä¸­çå¯¹è±¡åéåå­æ¶ï¼é¦åå¨ tlab åéï¼å½å¯¹è±¡å¤§äº tlab ä¸­çå©ä½åå­æ tlab çåå­å·²ç¨å°½æ¶ï¼åéç¨ä¸è¿°ç cas è¿è¡åå­åéã\n 3. åå§åé¶å¼\n 4. è®¾ç½®å¯¹è±¡å¤´ï¼ä¾å¦è¿ä¸ªå¯¹è±¡æ¯åªä¸ªç±»çå®ä¾ãå¦ä½æè½æ¾å°ç±»çåæ°æ®ä¿¡æ¯ãå¯¹è±¡çåå¸ç ãå¯¹è±¡ç gc åä»£å¹´é¾ç­ä¿¡æ¯ã è¿äºä¿¡æ¯å­æ¾å¨å¯¹è±¡å¤´ä¸­ã å¦å¤ï¼æ ¹æ®èææºå½åè¿è¡ç¶æçä¸åï¼å¦æ¯å¦å¯ç¨ååéç­ï¼å¯¹è±¡å¤´ä¼æä¸åçè®¾ç½®æ¹å¼ã\n 5. æ§è¡initæ¹æ³\n\n\n# å¯¹è±¡çåå­å¸å±\n\nå¨hotspotèææºä¸­ï¼å¯¹è±¡å¨å åå­ä¸­çå­å¨å¸å±å¯ä»¥åä¸ºä¸ä¸ªé¨åï¼å¯¹è±¡å¤´ãå®ä¾æ°æ®åå¯¹é½å¡«åã\n\nhotspot èææºçå¯¹è±¡å¤´åæ¬ä¸¤é¨åä¿¡æ¯ï¼ç¬¬ä¸é¨åç¨äºå­å¨å¯¹è±¡èªèº«çè¿è¡æ¶æ°æ®ï¼åå¸ç ãgc åä»£å¹´é¾ãéç¶ææ å¿ãçº¿ç¨ææçéãååçº¿ç¨idãååæ¶é´æ³ç­ç­ï¼ï¼å®æ¹ç§°ä¸ºâmark wordâãå¦ä¸é¨åæ¯ç±»åæéï¼å³å¯¹è±¡æåå®çç±»åæ°æ®çæéï¼èææºéè¿è¿ä¸ªæéæ¥ç¡®å®è¿ä¸ªå¯¹è±¡æ¯é£ä¸ªç±»çå®ä¾ã\n\nå®ä¾æ°æ®é¨åæ¯å¯¹è±¡çæ­£å­å¨çææä¿¡æ¯ï¼ä¹æ¯å¨ç¨åºä¸­æå®ä¹çåç§ç±»åçå­æ®µåå®¹ã\n\nå¯¹é½å¡«åé¨åä¸æ¯å¿ç¶å­å¨çï¼ä¹æ²¡æä»ä¹ç¹å«çå«ä¹ï¼ä»ä»èµ·å ä½ä½ç¨ã å ä¸º hotspot èææºçèªå¨åå­ç®¡çç³»ç»è¦æ±å¯¹è±¡èµ·å§å°åå¿é¡»æ¯ 8 å­èçæ´æ°åï¼æ¢å¥è¯è¯´å°±æ¯å¯¹è±¡çå¤§å°å¿é¡»æ¯ 8 å­èçæ´æ°åãèå¯¹è±¡å¤´é¨åæ­£å¥½æ¯ 8 å­èçåæ°ï¼1 åæ 2 åï¼ï¼å æ­¤ï¼å½å¯¹è±¡å®ä¾æ°æ®é¨åæ²¡æå¯¹é½æ¶ï¼å°±éè¦éè¿å¯¹é½å¡«åæ¥è¡¥å¨ã\n\n\n# å¯¹è±¡çè®¿é®å®ä½\n\njavaç¨åºä¼éè¿æ ä¸referenceæ°æ®æ¥æä½å ä¸çå·ä½å¯¹è±¡ã\n\nå¯¹è±¡çè®¿é®æ¹å¼ç±èææºçå®ç°å³å®ï¼ä¸»æµçè®¿é®æ¹å¼ä¸»è¦æä½¿ç¨å¥æåç´æ¥æéä¸¤ç§ã\n\nè¿ä¸¤ç§å¯¹è±¡è®¿é®æ¹å¼åæä¼å¿ãä½¿ç¨å¥ææ¥è®¿é®çæå¤§å¥½å¤æ¯ reference ä¸­å­å¨çæ¯ç¨³å®çå¥æå°åï¼å¨å¯¹è±¡è¢«ç§»å¨æ¶åªä¼æ¹åå¥æä¸­çå®ä¾æ°æ®æéï¼è reference æ¬èº«ä¸éè¦ä¿®æ¹ãä½¿ç¨ç´æ¥æéè®¿é®æ¹å¼æå¤§çå¥½å¤å°±æ¯éåº¦å¿«ï¼å®èçäºä¸æ¬¡æéå®ä½çæ¶é´å¼éã\n\n\n# å­ç¬¦ä¸²é®é¢\n\n * ç´æ¥ä½¿ç¨åå¼å·å£°æåºæ¥çstringå¯¹è±¡ä¼ç´æ¥å­å¨å¨å¸¸éæ± ä¸­ã\n * å¦æä¸æ¯ç¨åå¼å·å£°æçstringå¯¹è±¡ï¼å¯ä»¥ä½¿ç¨stringæä¾çinternæ¹æ³ãintern æ¹æ³ä¼ä»å­ç¬¦ä¸²å¸¸éæ± ä¸­æ¥è¯¢å½åå­ç¬¦ä¸²æ¯å¦å­å¨ï¼è¥ä¸å­å¨å°±ä¼å°å½åå­ç¬¦ä¸²æ¾å¥å¸¸éæ± ä¸­ã\n * ï¼string.intern() æ¯ä¸ä¸ª native æ¹æ³ï¼å®çä½ç¨æ¯ï¼å¦æè¿è¡æ¶å¸¸éæ± ä¸­å·²ç»åå«ä¸ä¸ªç­äºæ­¤ string å¯¹è±¡åå®¹çå­ç¬¦ä¸²ï¼åè¿åå¸¸éæ± ä¸­è¯¥å­ç¬¦ä¸²çå¼ç¨ï¼å¦ææ²¡æï¼jdk1.7 ä¹åï¼ä¸åå« 1.7ï¼çå¤çæ¹å¼æ¯å¨å¸¸éæ± ä¸­åå»ºä¸æ­¤ string åå®¹ç¸åçå­ç¬¦ä¸²ï¼å¹¶è¿åå¸¸éæ± ä¸­åå»ºçå­ç¬¦ä¸²çå¼ç¨ï¼jdk1.7 ä»¥åä¹åï¼å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­ï¼jvm ä¸ä¼å¨å¸¸éæ± ä¸­åå»ºè¯¥å¯¹è±¡ï¼èæ¯å°å ä¸­è¿ä¸ªå¯¹è±¡çå¼ç¨ç´æ¥æ¾å°å¸¸éæ± ä¸­ï¼åå°ä¸å¿è¦çåå­å¼éãï¼\n\nå¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¼ãå¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\nå¨ç¼è¯è¿ç¨ä¸­ï¼javac ç¼è¯å¨ä¼è¿è¡ä¸ä¸ªå«å å¸¸éæå (constant folding) çä»£ç ä¼åãå¸¸éæå ä¼æå¸¸éè¡¨è¾¾å¼çå¼æ±åºæ¥ä½ä¸ºå¸¸éåµå¨æç»çæçä»£ç ä¸­ï¼è¿æ¯ javac ç¼è¯å¨ä¼å¯¹æºä»£ç åçæå°éä¼åæªæ½ä¹ä¸(ä»£ç ä¼åå ä¹é½å¨å³æ¶ç¼è¯å¨ä¸­è¿è¡)ã\n\nä¸è¬æ¥è¯´ï¼æä»¬è¦å°½éé¿åéè¿ new çæ¹å¼åå»ºå­ç¬¦ä¸²ãä½¿ç¨åå¼å·å£°æç string å¯¹è±¡ï¼ string s1 = "java" ï¼æ´å©äºè®©ç¼è¯å¨ææºä¼ä¼åæä»¬çä»£ç ï¼åæ¶ä¹æ´æäºéè¯»ã\n\nè¢« final å³é®å­ä¿®æ¹ä¹åç string ä¼è¢«ç¼è¯å¨å½åå¸¸éæ¥å¤çï¼ç¼è¯å¨ç¨åºç¼è¯æå°±å¯ä»¥ç¡®å®å®çå¼ï¼å¶ææå°±æ³å°äºè®¿é®å¸¸éã\n\nstring s1 = new string("abc");è¿å¥è¯åå»ºäºå ä¸ªå­ç¬¦ä¸²å¯¹è±¡ï¼\n\nä¼åå»º 1 æ 2 ä¸ªå­ç¬¦ä¸²ï¼\n\n * å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­å·²å­å¨å­ç¬¦ä¸²å¸¸éâabcâï¼ååªä¼å¨å ç©ºé´åå»ºä¸ä¸ªå­ç¬¦ä¸²å¸¸éâabcâã\n * å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­æ²¡æå­ç¬¦ä¸²å¸¸éâabcâï¼é£ä¹å®å°é¦åå¨å­ç¬¦ä¸²å¸¸éæ± ä¸­åå»ºï¼ç¶åå¨å ç©ºé´ä¸­åå»ºï¼å æ­¤å°åå»ºæ»å± 2 ä¸ªå­ç¬¦ä¸²å¯¹è±¡ã\n\njava åºæ¬ç±»åçåè£ç±»çå¤§é¨åé½å®ç°äºå¸¸éæ± ææ¯ã\n\nbyte,short,integer,long è¿ 4 ç§åè£ç±»é»è®¤åå»ºäºæ°å¼ [-128ï¼127] çç¸åºç±»åçç¼å­æ°æ®ï¼character åå»ºäºæ°å¼å¨ [0,127] èå´çç¼å­æ°æ®ï¼boolean ç´æ¥è¿å true or falseã\n\nä¸¤ç§æµ®ç¹æ°ç±»åçåè£ç±» float,double å¹¶æ²¡æå®ç°å¸¸éæ± ææ¯ã\n\nè®°ä½ï¼æææ´ååè£ç±»å¯¹è±¡ä¹é´å¼çæ¯è¾ï¼å¨é¨ä½¿ç¨ equals æ¹æ³æ¯è¾ã\n\n\n# outofmemoryerrorå¼å¸¸\n\n\n# javaå æº¢åº\n\nå°å çæå°å¼-xmsåæ°ä¸æå¤§å¼-xmxåæ°è®¾ç½®ä¸ºä¸æ ·çè¯å¯é¿åå èªå¨æ©å±ï¼å³è®¾ç½®ä¸ºä¸å¯æ©å±ã\n\nè¦è§£å³è¿ä¸ªåå­åºåçå¼å¸¸ï¼ å¸¸è§çå¤çæ¹æ³æ¯é¦åéè¿åå­æ ååæå·¥å·ï¼å¦eclipse memory analyzerï¼ å¯¹dumpåºæ¥çå è½¬å¨å¿«ç§è¿è¡åæã ç¬¬ä¸æ­¥é¦ååºç¡®è®¤åå­ä¸­å¯¼è´oomçå¯¹è±¡æ¯å¦æ¯å¿è¦çï¼ ä¹å°±æ¯è¦ååæ¸æ¥å°åºæ¯åºç°äºåå­æ³æ¼ï¼memory leakï¼ è¿æ¯åå­æº¢åºï¼memory overflowï¼ ã\n\nå¦ææ¯åå­æ³æ¼ï¼ å¯è¿ä¸æ­¥éè¿å·¥å·æ¥çæ³æ¼å¯¹è±¡å°gc rootsçå¼ç¨é¾ï¼ æ¾å°æ³æ¼å¯¹è±¡æ¯éè¿ææ ·çå¼ç¨è·¯å¾ã ä¸åªäºgc rootsç¸å³èï¼ æå¯¼è´åå¾æ¶éå¨æ æ³åæ¶å®ä»¬ï¼ æ ¹æ®æ³æ¼å¯¹è±¡çç±»åä¿¡æ¯ä»¥åå®å°gc rootså¼ç¨é¾çä¿¡æ¯ï¼ ä¸è¬å¯ä»¥æ¯è¾åç¡®å°å®ä½å°è¿äºå¯¹è±¡åå»ºçä½ç½®ï¼ è¿èæ¾åºäº§çåå­æ³æ¼çä»£ç çå·ä½ä½ç½®ã\n\nå¦æä¸æ¯åå­æ³æ¼ï¼ æ¢å¥è¯è¯´å°±æ¯åå­ä¸­çå¯¹è±¡ç¡®å®é½æ¯å¿é¡»å­æ´»çï¼ é£å°±åºå½æ£æ¥javaèææºçå åæ°ï¼-xmxä¸-xmsï¼ è®¾ç½®ï¼ ä¸æºå¨çåå­å¯¹æ¯ï¼ ççæ¯å¦è¿æåä¸è°æ´çç©ºé´ã åä»ä»£ç ä¸æ£æ¥æ¯å¦å­å¨æäºå¯¹è±¡çå½å¨æè¿é¿ã ææç¶ææ¶é´è¿é¿ã å­å¨ç»æè®¾è®¡ä¸åçç­æåµï¼ å°½éåå°ç¨åºè¿è¡æçåå­æ¶èã\n\n\n# èææºæ ææ¬å°æ¹æ³æ æº¢åº\n\nç±äºhotspotèææºå¹¶ä¸åºåèææºæ åæ¬å°æ¹æ³æ ï¼æä»¥æ å®¹éåªç± -xssåæ°å³å®ã\n\nå³äºèææºæ åæ¬å°æ¹æ³æ ï¼ å¨ãjavaèææºè§èã ä¸­æè¿°äºä¸¤ç§å¼å¸¸ï¼\n\n 1. å¦æçº¿ç¨è¯·æ±çæ æ·±åº¦å¤§äºèææºæåè®¸çæå¤§æ·±åº¦ï¼ å°æåºstackoverflowerrorå¼å¸¸ã\n 2. å¦æèææºçæ åå­åè®¸å¨ææ©å±ï¼ å½æ©å±æ å®¹éæ æ³ç³è¯·å°è¶³å¤çåå­æ¶ï¼ å°æåºoutofmemoryerrorå¼å¸¸ã\n\nãjavaèææºè§èã æç¡®åè®¸javaèææºå®ç°èªè¡éæ©æ¯å¦æ¯ææ çå¨ææ©å±ï¼ èhotspotèææºçéæ©æ¯ä¸æ¯ææ©å±ï¼ æä»¥é¤éå¨åå»ºçº¿ç¨ç³è¯·åå­æ¶å°±å æ æ³è·å¾è¶³å¤åå­èåºç°outofmemoryerrorå¼å¸¸ï¼ å¦åå¨çº¿ç¨è¿è¡æ¶æ¯ä¸ä¼å ä¸ºæ©å±èå¯¼è´åå­æº¢åºçï¼ åªä¼å ä¸ºæ å®¹éæ æ³å®¹çº³æ°çæ å¸§èå¯¼è´stackoverflowerrorå¼å¸¸ã\n\nåºç°stackoverflowerrorå¼å¸¸æ¶ï¼ ä¼ææç¡®éè¯¯å æ å¯ä¾åæï¼ ç¸å¯¹èè¨æ¯è¾å®¹æå®ä½å°é®é¢æå¨ã å¦æä½¿ç¨hotspotèææºé»è®¤åæ°ï¼ æ æ·±åº¦å¨å¤§å¤æ°æåµä¸ï¼å ä¸ºæ¯ä¸ªæ¹æ³åå¥æ çå¸§å¤§å°å¹¶ä¸æ¯ä¸æ ·çï¼ æä»¥åªè½è¯´å¤§å¤æ°æåµä¸ï¼ å°è¾¾1000~2000æ¯å®å¨æ²¡æé®é¢ï¼ å¯¹äºæ­£å¸¸çæ¹æ³è°ç¨ï¼åæ¬ä¸è½åå°¾éå½ä¼åçéå½è°ç¨ï¼ ï¼è¿ä¸ªæ·±åº¦åºè¯¥å®å¨å¤ç¨äºã\n\nä½æ¯ï¼ å¦ææ¯å»ºç«è¿å¤çº¿ç¨å¯¼è´çåå­æº¢åºï¼ å¨ä¸è½åå°çº¿ç¨æ°éæèæ´æ¢64ä½èææºçæåµä¸ï¼ å°±åªè½éè¿åå°æå¤§å ååå°æ å®¹éæ¥æ¢åæ´å¤ççº¿ç¨ã è¿ç§éè¿âåå°åå­âçææ®µæ¥è§£å³åå­æº¢åºçæ¹å¼ï¼ å¦ææ²¡æè¿æ¹é¢å¤çç»éªï¼ ä¸è¬æ¯è¾é¾ä»¥æ³å°ï¼ è¿ä¸ç¹è¯»èéè¦å¨å¼å32ä½ç³»ç»çå¤çº¿ç¨åºç¨æ¶æ³¨æã ä¹æ¯ç±äºè¿ç§é®é¢è¾ä¸ºéè½ï¼ ä»jdk 7èµ·ï¼ ä»¥ä¸æç¤ºä¿¡æ¯ä¸­âunable to create native threadâåé¢ï¼ èææºä¼ç¹å«æ³¨æåå å¯è½æ¯âpossiblyout of memory or process/resource limits reachedâã\n\n\n# æ¹æ³åºåè¿è¡æ¶å¸¸éæ± æº¢åº\n\nä»¥ä¸é¢çä¾å­ä¸ºä¾ï¼\n\nstring::intern()æ¯ä¸ä¸ªæ¬å°æ¹æ³ï¼ å®çä½ç¨æ¯å¦æå­ç¬¦ä¸²å¸¸éæ± ä¸­å·²ç»åå«ä¸ä¸ªç­äºæ­¤stringå¯¹è±¡çå­ç¬¦ä¸²ï¼ åè¿åä»£è¡¨æ± ä¸­è¿ä¸ªå­ç¬¦ä¸²çstringå¯¹è±¡çå¼ç¨ï¼ å¦åï¼ ä¼å°æ­¤stringå¯¹è±¡åå«çå­ç¬¦ä¸²æ·»å å°å¸¸éæ± ä¸­ï¼ å¹¶ä¸è¿åæ­¤stringå¯¹è±¡çå¼ç¨ã\n\nèªjdk 7èµ·ï¼ åæ¬å­æ¾å¨æ°¸ä¹ä»£çå­ç¬¦ä¸²å¸¸éæ± è¢«ç§»è³javaå ä¹ä¸­ã\n\nå½åçå¾å¤ä¸»æµæ¡æ¶ï¼ å¦springã hibernateå¯¹ç±»è¿è¡å¢å¼ºæ¶ï¼ é½ä¼ä½¿ç¨å°cglibè¿ç±»å­èç ææ¯ï¼ å½å¢å¼ºçç±»è¶å¤ï¼ å°±éè¦è¶å¤§çæ¹æ³åºä»¥ä¿è¯å¨æçæçæ°ç±»åå¯ä»¥è½½å¥åå­ã\n\næ¹æ³åºæº¢åºä¹æ¯ä¸ç§å¸¸è§çåå­æº¢åºå¼å¸¸ï¼ ä¸ä¸ªç±»å¦æè¦è¢«åå¾æ¶éå¨åæ¶ï¼ è¦è¾¾æçæ¡ä»¶æ¯æ¯è¾èå»çã\n\nå¨jdk 8ä»¥åï¼ æ°¸ä¹ä»£ä¾¿å®å¨éåºäºåå²èå°ï¼ åç©ºé´ä½ä¸ºå¶æ¿ä»£èç»åºã å¨é»è®¤è®¾ç½®ä¸ï¼ æ­£å¸¸çå¨æåå»ºæ°ç±»åå·²ç»å¾é¾åè¿«ä½¿èææºäº§çæ¹æ³åºçæº¢åºå¼å¸¸äºã ä¸è¿ä¸ºäºè®©ä½¿ç¨èæé¢é²å®éåºç¨éåºç°çç ´åæ§çæä½ï¼ hotspotè¿æ¯æä¾äºä¸äºåæ°ä½ä¸ºåç©ºé´çé²å¾¡æªæ½ï¼ ä¸»è¦åæ¬ï¼\n\n * -xxï¼maxmetaspacesizeï¼ è®¾ç½®åç©ºé´æå¤§å¼ï¼ é»è®¤æ¯-1ï¼ å³ä¸éå¶ï¼ æèè¯´åªåéäºæ¬å°åå­å¤§å°ã\n * -xxï¼metaspacesizeï¼ æå®åç©ºé´çåå§ç©ºé´å¤§å°ï¼ ä»¥å­èä¸ºåä½ï¼ è¾¾å°è¯¥å¼å°±ä¼è§¦ååå¾æ¶éè¿è¡ç±»åå¸è½½ï¼ åæ¶æ¶éå¨ä¼å¯¹è¯¥å¼è¿è¡è°æ´ï¼ å¦æéæ¾äºå¤§éçç©ºé´ï¼ å°±éå½éä½è¯¥å¼ï¼ å¦æéæ¾äºå¾å°çç©ºé´ï¼ é£ä¹å¨ä¸è¶è¿-xxï¼ maxmetaspacesizeï¼å¦æè®¾ç½®äºçè¯ï¼ çæåµä¸ï¼ éå½æé«è¯¥å¼ã\n * -xxï¼minmetaspacefreeratioï¼ ä½ç¨æ¯å¨åå¾æ¶éä¹åæ§å¶æå°çåç©ºé´å©ä½å®¹éçç¾åæ¯ï¼ å¯åå°å ä¸ºåç©ºé´ä¸è¶³å¯¼è´çåå¾æ¶éçé¢çã ç±»ä¼¼çè¿æ-xxï¼ max-metaspacefreeratioï¼ ç¨äºæ§å¶æå¤§çåç©ºé´å©ä½å®¹éçç¾åæ¯ã\n\n\n# æ¬æºç´æ¥åå­æº¢åº\n\nç´æ¥åå­ï¼direct memoryï¼ çå®¹éå¤§å°å¯éè¿-xxï¼ maxdirectmemorysizeåæ°æ¥æå®ï¼ å¦æä¸å»æå®ï¼ åé»è®¤ä¸javaå æå¤§å¼ï¼ç±-xmxæå®ï¼ ä¸è´ã\n\nç±ç´æ¥åå­å¯¼è´çåå­æº¢åºï¼ ä¸ä¸ªææ¾çç¹å¾æ¯å¨heap dumpæä»¶ä¸­ä¸ä¼çè§æä»ä¹ææ¾çå¼å¸¸æåµï¼ å¦æè¯»èåç°åå­æº¢åºä¹åäº§ççdumpæä»¶å¾å°ï¼ èç¨åºä¸­åç´æ¥æé´æ¥ä½¿ç¨äºdirectmemoryï¼å¸åçé´æ¥ä½¿ç¨å°±æ¯nioï¼ ï¼ é£å°±å¯ä»¥èèéç¹æ£æ¥ä¸ä¸ç´æ¥åå­æ¹é¢çåå äºã\n\n\n# jvmåå¾åæ¶\n\né®é¢ï¼\n\n * åå­æ¯å¦ä½åéååæ¶çï¼\n * åªäºåå­éè¦åæ¶ï¼\n * ä»ä¹æ¶ååæ¶ï¼\n * å¦ä½åæ¶ï¼\n * parnew åparallel scavenge çåºå«æ¯ï¼\n\n\n# åå¾åæ¶ç®æ³\n\n * æ è®°-æ¸é¤ mark-sweep\n * æ è®°-å¤å¶ï¼å¸¸ç¨äºæ°çä»£\n * æ è®°-æ´ç mark-compact\n\nåä»£åæ¶ï¼åªæ¯æ ¹æ®å¯¹è±¡å­æ´»å¨æçä¸åå°åå­åä¸ºå åãä¸è¬å° java å åä¸ºæ°çä»£åèå¹´ä»£ï¼è¿æ ·æä»¬å°±å¯ä»¥æ ¹æ®åä¸ªå¹´ä»£çç¹ç¹éæ©åéçåå¾æ¶éç®æ³ã\n\n\n# å¹¶è¡åå¹¶å\n\n * å¹¶è¡ï¼parallelï¼ ï¼æå¤æ¡åå¾æ¶éçº¿ç¨å¹¶è¡å·¥ä½ï¼ä½æ­¤æ¶ç¨æ·çº¿ç¨ä»ç¶å¤äºç­å¾ç¶æã\n * å¹¶åï¼concurrentï¼ï¼æç¨æ·çº¿ç¨ä¸åå¾æ¶éçº¿ç¨åæ¶æ§è¡ï¼ä½ä¸ä¸å®æ¯å¹¶è¡ï¼å¯è½ä¼äº¤æ¿æ§è¡ï¼ï¼ç¨æ·ç¨åºå¨ç»§ç»­è¿è¡ï¼èåå¾æ¶éå¨è¿è¡å¨å¦ä¸ä¸ª cpu ä¸ã\n\n\n# åå¾åæ¶å¨å¾è§£\n\n\n\nserial æ¯åçº¿ç¨çæ¶éå¨\n\nparnew æ¶éå¨å®è´¨ä¸æ¯serialæ¶éå¨çå¤çº¿ç¨å¹¶è¡çæ¬ãé¤äºåæ¶ä½¿ç¨å¤æ¡çº¿ç¨è¿è¡åå¾æ¶éä¹å¤ï¼ å¶ä½çè¡ä¸ºåæ¬serialæ¶éå¨å¯ç¨çæææ§å¶åæ°ï¼ä¾å¦ï¼ -xxï¼ survivorratioã -xxï¼pretenuresizethresholdã -xxï¼ handlepromotionfailureç­ï¼ ã æ¶éç®æ³ã stop the worldã å¯¹è±¡åéè§åã åæ¶ç­ç¥ç­é½ä¸serialæ¶éå¨å®å¨ä¸è´ï¼ å¨å®ç°ä¸è¿ä¸¤ç§æ¶éå¨ä¹å±ç¨äºç¸å½å¤çä»£ç ã\n\nparnewæ¶éå¨é¤äºæ¯æå¤çº¿ç¨å¹¶è¡æ¶éä¹å¤ï¼ å¶ä»ä¸serialæ¶éå¨ç¸æ¯å¹¶æ²¡æå¤ªå¤åæ°ä¹å¤ã\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# åå¾åæ¶å¨åç±»\n\n * ç»å¸åå¾åæ¶å¨\n   * æ°çä»£\n     * serialï¼æ°çä»£éç¨æ è®°-å¤å¶ç®æ³ï¼èå¹´ä»£éç¨æ è®°-æ´çç®æ³ã\n     * parnewï¼serialçå¤çº¿ç¨ç\n     * parallel scavengeï¼æ°çä»£éç¨æ è®°-å¤å¶ç®æ³ï¼èå¹´ä»£éç¨æ è®°-æ´çç®æ³ã\n       * parallel scavenge æ¶éå¨å³æ³¨ç¹æ¯ååéï¼é«æççå©ç¨ cpuï¼ãcms ç­åå¾æ¶éå¨çå³æ³¨ç¹æ´å¤çæ¯ç¨æ·çº¿ç¨çåé¡¿æ¶é´ï¼æé«ç¨æ·ä½éªï¼ãæè°ååéå°±æ¯ cpu ä¸­ç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸ cpu æ»æ¶èæ¶é´çæ¯å¼ã parallel scavenge æ¶éå¨æä¾äºå¾å¤åæ°ä¾ç¨æ·æ¾å°æåéçåé¡¿æ¶é´ææå¤§ååéï¼å¦æå¯¹äºæ¶éå¨è¿ä½ä¸å¤ªäºè§£ï¼æå·¥ä¼åå­å¨å°é¾çæ¶åï¼ä½¿ç¨ parallel scavenge æ¶éå¨éåèªéåºè°èç­ç¥ï¼æåå­ç®¡çä¼åäº¤ç»èææºå»å®æä¹æ¯ä¸ä¸ªä¸éçéæ©ã\n   * èå¹´ä»£ï¼\n     * serial old\n     * parallel oldï¼å¤çº¿ç¨+æ è®°æ´ç\n     * cmsï¼concurrent mark sweepï¼éç¨æ è®°-æ¸é¤ç®æ³ãç®æ æç­åæ¶åé¡¿æ¶é´ã\n   * g1ï¼é¢åæå¡å¨çåå¾æ¶éå¨,ä¸»è¦éå¯¹éå¤å¤é¢å¤çå¨åå¤§å®¹éåå­çæºå¨. ä»¥æé«æ¦çæ»¡è¶³ gc åé¡¿æ¶é´è¦æ±çåæ¶,è¿å·å¤é«ååéæ§è½ç¹å¾.ï¼ä½åé¡¿+é«ååï¼ãg1 ä»æ´ä½æ¥çæ¯åºäºâæ è®°-æ´çâç®æ³å®ç°çæ¶éå¨ï¼ä»å±é¨ä¸æ¥çæ¯åºäºâæ è®°-å¤å¶âç®æ³å®ç°çã\n     * g1 æ¶éå¨å¨åå°ç»´æ¤äºä¸ä¸ªä¼ååè¡¨ï¼æ¯æ¬¡æ ¹æ®åè®¸çæ¶éæ¶é´ï¼ä¼åéæ©åæ¶ä»·å¼æå¤§ç region(è¿ä¹å°±æ¯å®çåå­ garbage-first çç±æ¥) ã\n * ä½å»¶è¿åå¾åæ¶å¨\n   * zgcï¼åºäºregion åå­å¸å±ï¼ä¸è®¾åä»£ï¼ä½¿ç¨äºè¯»å±éãæè²æéååå­å¤éæ å°ç­ææ¯å®ç°å¯å¹¶åçæ è®°-æ´çç®æ³ï¼ä»¥ä½å»¶è¿ä¸ºé¦è¦ç®æ ã\n   * shenandoah\n\ncmsç¼ºç¹ï¼\n\n * å¯¹ cpu èµæºææï¼\n * æ æ³å¤çæµ®å¨åå¾ï¼\n * å®ä½¿ç¨çåæ¶ç®æ³-âæ è®°-æ¸é¤âç®æ³ä¼å¯¼è´æ¶éç»ææ¶ä¼æå¤§éç©ºé´ç¢çäº§çã\n\nshenandoahä¸g1ç3ä¸ªææ¾ä¸åï¼\n\n * æ¯æå¹¶åçæ´çç®æ³ï¼æéè¦ï¼ãg1çåæ¶é¶æ®µæ¯å¯ä»¥å¤çº¿ç¨å¹¶è¡çï¼ä½ä¸è½ä¸ç¨æ·çº¿ç¨å¹¶åã\n * ç®åé»è®¤ä¸ä½¿ç¨åä»£åæ¶\n * æå¼g1ä¸­èè´¹å¤§éåå­åè®¡ç®èµæºå»ç»´æ¤çè®°å¿éï¼ä½¿ç¨âè¿æ¥ç©éµâçå¨å±æ°æ®ç»ææ¥è®°å½è·¨regionçå¼ç¨å³ç³»ã\n\n\n# é»è®¤åå¾åæ¶å¨ï¼\n\n * jdk8 é»è®¤ä½¿ç¨çæ¯ parallel scavenge + parallel oldãä½ä¸è¬ä¸ç¨è¿ä¸ªãå¸¸ç¨parnew+cmså§ï¼å ä¸ºæ¯å¯ä¸æ­éåï¼\n * jdk9~16 é»è®¤g1\n\nå¨jvmä¸­æ¯+xxéç½®å®ç°çæ­éç»åï¼\n\n * -xx:+useserialgcï¼èææºè¿è¡å¨clientæ¨¡å¼ä¸çé»è®¤å¼ï¼serial+serial oldã\n * -xx:+useparnewgcï¼parnew+serial oldï¼å¨jdk1.8è¢«åºå¼ï¼å¨jdk1.7è¿å¯ä»¥ä½¿ç¨ã\n * -xx:+useconcmarksweepgcï¼parnew+cms+serial oldã\n * -xx:+useparallelgcï¼èææºè¿è¡å¨serveræ¨¡å¼ä¸çé»è®¤å¼ï¼parallel scavenge+serial old(ps mark sweep)ã\n * -xx:+useparalleloldgcï¼parallel scavenge+parallel oldã\n * -xx:+useg1gcï¼g1+g1ã\n\n\n\n\n\nå åå­å¸¸è§åéç­ç¥ï¼\n\n * å¯¹è±¡ä¼ååéå¨edenåº\n * å¤§å¯¹è±¡ç´æ¥åéå°èå¹´ä»£ãå¤§å¯¹è±¡å°±æ¯éè¦å¤§éè¿ç»­åå­ç©ºé´çå¯¹è±¡ï¼æ¯å¦ï¼å­ç¬¦ä¸²ãæ°ç»ï¼ã\n * é¿æå­æ´»çå¯¹è±¡è¿å¥èå¹´ä»£\n\nç©ºé´åéæä¿ï¼ç®çæ¯ç¡®ä¿minor gcä¹åèå¹´ä»£æè¶³å¤ç©ºé´å®¹çº³æ°çä»£ææå¯¹è±¡\n\njdk 6 update 24 ä¹åï¼å¨åç minor gc ä¹åï¼èææºå¿é¡»åæ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºæ°çä»£ææå¯¹è±¡æ»ç©ºé´ï¼å¦æè¿ä¸ªæ¡ä»¶æç«ï¼é£è¿ä¸æ¬¡ minor gc å¯ä»¥ç¡®ä¿æ¯å®å¨çãå¦æä¸æç«ï¼åèææºä¼åæ¥ç -xx:handlepromotionfailure åæ°çè®¾ç½®å¼æ¯å¦åè®¸æä¿å¤±è´¥(handle promotion failure);å¦æåè®¸ï¼é£ä¼ç»§ç»­æ£æ¥èå¹´ä»£æå¤§å¯ç¨çè¿ç»­ç©ºé´æ¯å¦å¤§äºåæ¬¡æåå°èå¹´ä»£å¯¹è±¡çå¹³åå¤§å°ï¼å¦æå¤§äºï¼å°å°è¯è¿è¡ä¸æ¬¡ minor gcï¼å°½ç®¡è¿æ¬¡ minor gc æ¯æé£é©ç;å¦æå°äºï¼æè -xx: handlepromotionfailure è®¾ç½®ä¸åè®¸åé©ï¼é£è¿æ¶å°±è¦æ¹ä¸ºè¿è¡ä¸æ¬¡ full gcã\n\njdk 6 update 24ä¹åçè§ååä¸ºåªè¦èå¹´ä»£çè¿ç»­ç©ºé´å¤§äºæ°çä»£å¯¹è±¡æ»å¤§å°æèåæ¬¡æåçå¹³åå¤§å°ï¼å°±ä¼è¿è¡ minor gcï¼å¦åå°è¿è¡ full gcã\n\nå¨æå¯¹è±¡å¹´é¾å¤å®ï¼hotspot éåææå¯¹è±¡æ¶ï¼æç§å¹´é¾ä»å°å°å¤§å¯¹å¶æå ç¨çå¤§å°è¿è¡ç´¯ç§¯ï¼å½ç´¯ç§¯çæä¸ªå¹´é¾å¤§å°è¶è¿äº survivor åºç 50% æ¶ï¼é»è®¤å¼æ¯ 50%ï¼å¯ä»¥éè¿ -xx:targetsurvivorratio=percent æ¥è®¾ç½® ï¼ï¼åè¿ä¸ªå¹´é¾å maxtenuringthresholdï¼é»è®¤15å²ï¼ ä¸­æ´å°çä¸ä¸ªå¼ï¼ä½ä¸ºæ°çæåå¹´é¾éå¼âã\n\ngcåç±»\n\n * partial gc:\n   \n   * minor gc/young gc\n   \n   * major gc/old gc\n   \n   * mixed gcï¼å¯¹æ´ä¸ªæ°çä»£åèå¹´ä»£è¿è¡åå¾åæ¶\n\n * full gcï¼æ¶éæ´ä¸ªjavaå åæ¹æ³åº\n\n\n# å¦ä½å¤æ­ä¸ä¸ªå¯¹è±¡å·²ç»æ æï¼\n\n * å¼ç¨è®¡æ°æ³\n   \n   * å®ç°ç®åï¼æçé«ï¼ä½æ¯ç®åä¸»æµçèææºä¸­å¹¶æ²¡æéæ©è¿ä¸ªç®æ³æ¥ç®¡çåå­ï¼å¶æä¸»è¦çåå æ¯å®å¾é¾è§£å³å¯¹è±¡ä¹é´ç¸äºå¾ªç¯å¼ç¨çé®é¢ã\n\n * å¯è¾¾æ§åææ³\n   \n   * éè¿ä¸ç³»åçç§°ä¸º âgc rootsâ çå¯¹è±¡ä½ä¸ºèµ·ç¹ï¼ä»è¿äºèç¹å¼å§åä¸æç´¢ï¼èç¹æèµ°è¿çè·¯å¾ç§°ä¸ºå¼ç¨é¾ï¼å½ä¸ä¸ªå¯¹è±¡å° gc roots æ²¡æä»»ä½å¼ç¨é¾ç¸è¿çè¯ï¼åè¯ææ­¤å¯¹è±¡æ¯ä¸å¯ç¨çã\n\n\n# å¯ä½ä¸ºgc rootsçå¯¹è±¡\n\n * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¬å°æ¹æ³æ ï¼nativeæ¹æ³ï¼ä¸­å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n * ææè¢«åæ­¥éææçå¯¹è±¡\n\n\n# å¼ç¨\n\njdk1.2 ä¹åï¼java ä¸­å¼ç¨çå®ä¹å¾ä¼ ç»ï¼å¦æ reference ç±»åçæ°æ®å­å¨çæ°å¼ä»£è¡¨çæ¯å¦ä¸ååå­çèµ·å§å°åï¼å°±ç§°è¿ååå­ä»£è¡¨ä¸ä¸ªå¼ç¨ã\n\njdk1.2 ä»¥åï¼java å¯¹å¼ç¨çæ¦å¿µè¿è¡äºæ©åï¼å°å¼ç¨åä¸ºå¼ºå¼ç¨ãè½¯å¼ç¨ãå¼±å¼ç¨ãèå¼ç¨åç§ï¼å¼ç¨å¼ºåº¦éæ¸åå¼±ï¼\n\n * å¼ºå¼ç¨ï¼strongreferenceï¼\n   \n   ä»¥åæä»¬ä½¿ç¨çå¤§é¨åå¼ç¨å®éä¸é½æ¯å¼ºå¼ç¨ï¼è¿æ¯ä½¿ç¨ææ®éçå¼ç¨ãå¦æä¸ä¸ªå¯¹è±¡å·æå¼ºå¼ç¨ï¼é£å°±ç±»ä¼¼äºå¿ä¸å¯å°ççæ´»ç¨åï¼åå¾åæ¶å¨ç»ä¸ä¼åæ¶å®ãå½åå­ç©ºé´ä¸è¶³ï¼java èææºå®æ¿æåº outofmemoryerror éè¯¯ï¼ä½¿ç¨åºå¼å¸¸ç»æ­¢ï¼ä¹ä¸ä¼é éæåæ¶å·æå¼ºå¼ç¨çå¯¹è±¡æ¥è§£å³åå­ä¸è¶³é®é¢ã\n\n * è½¯å¼ç¨ï¼softreferenceï¼\n   \n   å¦æä¸ä¸ªå¯¹è±¡åªå·æè½¯å¼ç¨ï¼é£å°±ç±»ä¼¼äºå¯æå¯æ ççæ´»ç¨åã**å¦æåå­ç©ºé´è¶³å¤ï¼åå¾åæ¶å¨å°±ä¸ä¼åæ¶å®ï¼å¦æåå­ç©ºé´ä¸è¶³äºï¼å°±ä¼åæ¶è¿äºå¯¹è±¡çåå­ã**åªè¦åå¾åæ¶å¨æ²¡æåæ¶å®ï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨åºä½¿ç¨ãè½¯å¼ç¨å¯ç¨æ¥å®ç°åå­ææçé«éç¼å­ã\n   \n   è½¯å¼ç¨å¯ä»¥åä¸ä¸ªå¼ç¨éåï¼referencequeueï¼èåä½¿ç¨ï¼å¦æè½¯å¼ç¨æå¼ç¨çå¯¹è±¡è¢«åå¾åæ¶ï¼java èææºå°±ä¼æè¿ä¸ªè½¯å¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ã\n\n * å¼±å¼ç¨ï¼weakreferenceï¼\n   \n   å¦æä¸ä¸ªå¯¹è±¡åªå·æå¼±å¼ç¨ï¼é£å°±ç±»ä¼¼äºå¯æå¯æ ççæ´»ç¨åãå¼±å¼ç¨ä¸è½¯å¼ç¨çåºå«å¨äºï¼åªå·æå¼±å¼ç¨çå¯¹è±¡æ¥ææ´ç­æççå½å¨æãå¨åå¾åæ¶å¨çº¿ç¨æ«æå®æç®¡è¾çåå­åºåçè¿ç¨ä¸­ï¼ä¸æ¦åç°äºåªå·æå¼±å¼ç¨çå¯¹è±¡ï¼ä¸ç®¡å½ååå­ç©ºé´è¶³å¤ä¸å¦ï¼é½ä¼åæ¶å®çåå­ãä¸è¿ï¼ç±äºåå¾åæ¶å¨æ¯ä¸ä¸ªä¼åçº§å¾ä½ççº¿ç¨ï¼ å æ­¤ä¸ä¸å®ä¼å¾å¿«åç°é£äºåªå·æå¼±å¼ç¨çå¯¹è±¡ã\n   \n   å¼±å¼ç¨å¯ä»¥åä¸ä¸ªå¼ç¨éåï¼referencequeueï¼èåä½¿ç¨ï¼å¦æå¼±å¼ç¨æå¼ç¨çå¯¹è±¡è¢«åå¾åæ¶ï¼java èææºå°±ä¼æè¿ä¸ªå¼±å¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ã\n\n * èå¼ç¨ï¼phantomreferenceï¼\n   \n   "èå¼ç¨"é¡¾åæä¹ï¼å°±æ¯å½¢åèè®¾ï¼ä¸å¶ä»å ç§å¼ç¨é½ä¸åï¼èå¼ç¨å¹¶ä¸ä¼å³å®å¯¹è±¡ççå½å¨æãå¦æä¸ä¸ªå¯¹è±¡ä»ææèå¼ç¨ï¼é£ä¹å®å°±åæ²¡æä»»ä½å¼ç¨ä¸æ ·ï¼å¨ä»»ä½æ¶åé½å¯è½è¢«åå¾åæ¶ã\n   \n   èå¼ç¨ä¸»è¦ç¨æ¥è·è¸ªå¯¹è±¡è¢«åå¾åæ¶çæ´»å¨ã\n   \n   èå¼ç¨ä¸è½¯å¼ç¨åå¼±å¼ç¨çä¸ä¸ªåºå«å¨äºï¼ èå¼ç¨å¿é¡»åå¼ç¨éåï¼referencequeueï¼èåä½¿ç¨ãå½åå¾åæ¶å¨åå¤åæ¶ä¸ä¸ªå¯¹è±¡æ¶ï¼å¦æåç°å®è¿æèå¼ç¨ï¼å°±ä¼å¨åæ¶å¯¹è±¡çåå­ä¹åï¼æè¿ä¸ªèå¼ç¨å å¥å°ä¸ä¹å³èçå¼ç¨éåä¸­ãç¨åºå¯ä»¥éè¿å¤æ­å¼ç¨éåä¸­æ¯å¦å·²ç»å å¥äºèå¼ç¨ï¼æ¥äºè§£è¢«å¼ç¨çå¯¹è±¡æ¯å¦å°è¦è¢«åå¾åæ¶ãç¨åºå¦æåç°æä¸ªèå¼ç¨å·²ç»è¢«å å¥å°å¼ç¨éåï¼é£ä¹å°±å¯ä»¥å¨æå¼ç¨çå¯¹è±¡çåå­è¢«åæ¶ä¹åéåå¿è¦çè¡å¨ã\n   \n   ç¹å«æ³¨æï¼å¨ç¨åºè®¾è®¡ä¸­ä¸è¬å¾å°ä½¿ç¨å¼±å¼ç¨ä¸èå¼ç¨ï¼ä½¿ç¨è½¯å¼ç¨çæåµè¾å¤ï¼è¿æ¯å ä¸ºè½¯å¼ç¨å¯ä»¥å é jvm å¯¹åå¾åå­çåæ¶éåº¦ï¼å¯ä»¥ç»´æ¤ç³»ç»çè¿è¡å®å¨ï¼é²æ­¢åå­æº¢åºï¼outofmemoryï¼ç­é®é¢çäº§çã\n\nä½ ä¼ä½¿ç¨è½¯å¼ç¨åå¼±å¼ç¨åï¼è½¯å¼ç¨åå¼±å¼ç¨çä¾å­ä¸éã\n\n\n# å¸¸éæ± çä½ç½®\n\njdk1.7 ä¹åè¿è¡æ¶å¸¸éæ± é»è¾åå«å­ç¬¦ä¸²å¸¸éæ± å­æ¾å¨æ¹æ³åº, æ­¤æ¶ hotspot èææºå¯¹æ¹æ³åºçå®ç°ä¸ºæ°¸ä¹ä»£ã\n\njdk1.7 å­ç¬¦ä¸²å¸¸éæ± è¢«ä»æ¹æ³åºæ¿å°äºå ä¸­, è¿éæ²¡ææå°è¿è¡æ¶å¸¸éæ± ,ä¹å°±æ¯è¯´å­ç¬¦ä¸²å¸¸éæ± è¢«åç¬æ¿å°å ,è¿è¡æ¶å¸¸éæ± å©ä¸çä¸è¥¿è¿å¨æ¹æ³åº, ä¹å°±æ¯ hotspot ä¸­çæ°¸ä¹ä»£ ã\n\njdk1.8 hotspot ç§»é¤äºæ°¸ä¹ä»£ç¨åç©ºé´(metaspace)åèä»£ä¹, è¿æ¶åå­ç¬¦ä¸²å¸¸éæ± è¿å¨å , è¿è¡æ¶å¸¸éæ± è¿å¨æ¹æ³åº, åªä¸è¿æ¹æ³åºçå®ç°ä»æ°¸ä¹ä»£åæäºåç©ºé´(metaspace)\n\nåå¦å¨å­ç¬¦ä¸²å¸¸éæ± ä¸­å­å¨å­ç¬¦ä¸² "abc"ï¼å¦æå½åæ²¡æä»»ä½ string å¯¹è±¡å¼ç¨è¯¥å­ç¬¦ä¸²å¸¸éçè¯ï¼å°±è¯´æå¸¸é "abc" å°±æ¯åºå¼å¸¸éï¼å¦æè¿æ¶åçåå­åæ¶çè¯èä¸æå¿è¦çè¯ï¼"abc" å°±ä¼è¢«ç³»ç»æ¸çåºå¸¸éæ± äºã\n\n\n# å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»\n\næ¹æ³åºä¸»è¦åæ¶çæ¯æ ç¨çç±»ï¼é£ä¹å¦ä½å¤æ­ä¸ä¸ªç±»æ¯æ ç¨çç±»çå¢ï¼\n\nå¤å®ä¸ä¸ªå¸¸éæ¯å¦æ¯âåºå¼å¸¸éâæ¯è¾ç®åï¼èè¦å¤å®ä¸ä¸ªç±»æ¯å¦æ¯âæ ç¨çç±»âçæ¡ä»¶åç¸å¯¹èå»è®¸å¤ãç±»éè¦åæ¶æ»¡è¶³ä¸é¢ 3 ä¸ªæ¡ä»¶æè½ç®æ¯ âæ ç¨çç±»â ï¼\n\n * è¯¥ç±»ææçå®ä¾é½å·²ç»è¢«åæ¶ï¼ä¹å°±æ¯ java å ä¸­ä¸å­å¨è¯¥ç±»çä»»ä½å®ä¾ã\n * å è½½è¯¥ç±»ç classloader å·²ç»è¢«åæ¶ã\n * è¯¥ç±»å¯¹åºç java.lang.class å¯¹è±¡æ²¡æå¨ä»»ä½å°æ¹è¢«å¼ç¨ï¼æ æ³å¨ä»»ä½å°æ¹éè¿åå°è®¿é®è¯¥ç±»çæ¹æ³ã\n\nèææºå¯ä»¥å¯¹æ»¡è¶³ä¸è¿° 3 ä¸ªæ¡ä»¶çæ ç¨ç±»è¿è¡åæ¶ï¼è¿éè¯´çä»ä»æ¯âå¯ä»¥âï¼èå¹¶ä¸æ¯åå¯¹è±¡ä¸æ ·ä¸ä½¿ç¨äºå°±ä¼å¿ç¶è¢«åæ¶ã\n\n\n# èææºæ§è½çæ§ãæéå¤çå·¥å·\n\n\n# 6ä¸ªå¸¸ç¨çå½ä»¤è¡å·¥å·ï¼\n\nå·¥å·       åè½\njps      èææºè¿ç¨ç¶åµå·¥å·ãå¯ååºæ­£å¨è¿è¡çèææºè¿ç¨ï¼å¹¶ç°å®èææºæ§è¡ä¸»ç±»ã\njstat    èææºç»è®¡ä¿¡æ¯çè§å·¥å·ãèææºä¿¡æ¯ä¸»è¦æ3ç±»ï¼ç±»å è½½ãåå¾æ¶éãè¿è¡æç¼è¯ç¶åµ\njinfo    javaéç½®ä¿¡æ¯å·¥å·ãå®æ¶æ¥çåè°æ´èææºåé¡¹åæ°ã\njmap     javaåå­æ åå·¥å·ãç¨äºçæå è½¬å¨å¿«ç§ï¼heap dumpædumpæä»¶ï¼ã\njhat     èææºå è½¬å¨å¿«ç§åæå·¥å·ãæ­éjmapä½¿ç¨ï¼åæjmapçæçå è½¬å¨å¿«ç§ãä¸è¬ä¸ç¨ï¼ç¨visualvmæå¶ä»ã\njstack   javaå æ è·è¸ªå·¥å·ãç¨äºçæèææºå½åæ¶å»ççº¿ç¨å¿«ç§ï¼threaddumpæjavacoreæä»¶ï¼ãçº¿ç¨å¿«ç§å°±æ¯å½åèææºåæ¯ä¸æ¡çº¿ç¨æ­£å¨æ§è¡çæ¹æ³çå æ çéåã\n\nå¶ä»å·¥å·ï¼\n\nå·¥å·      åè½\njava    ç¨äºè¿è¡classæä»¶æjaræä»¶\njavac   ç¼è¯å¨ï¼å°.javaæä»¶ç¼è¯æ.class\njavap   ç¨äºåæå­èç ãåç¼è¯å¾å°å­èç æä»¤ãä¹å¯ç¨å¶ä»å·¥å·å°classæä»¶è½¬æ¢æç¹å®å¹³å°ä¸çæ±ç¼ä»£ç ã\n        \n\n\n# 4ä¸ªå¸¸ç¨çå¯è§åå·¥å·ï¼\n\nå¯è§åå·¥å·                  åè½\njhsdb                  åºäºæå¡æ§ä»£ççè°è¯å·¥å·\njconsole               javaçè§ä¸ç®¡çæ§å¶å°\nvisualvm               å¤å-æéå¤çå·¥å·\njava mission control   å¯æç»­å¨çº¿ççæ§å·¥å·\n\n\n# jmx\n\njmxï¼java management extensionsï¼ï¼ java ç®¡çæ©å±ï¼ç¨æ¥ç®¡çåçæµ java ç¨åºãæå¸¸ç¨å°çå°±æ¯å¯¹äº jvm ççæµåç®¡çï¼æ¯å¦ jvm åå­ãcpu ä½¿ç¨çãçº¿ç¨æ°ãåå¾æ¶éæåµç­ç­ãå¦å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿çº§å«çå¨æä¿®æ¹ï¼æ¯å¦ log4j å°±æ¯æ jmx æ¹å¼å¨æä¿®æ¹çº¿ä¸æå¡çæ¥å¿çº§å«ãæä¸»è¦çè¿æ¯è¢«ç¨æ¥ååç§çæ§å·¥å·ï¼æ¯å¦ spring boot actuatorãjconsoleãvisualvm ç­ã\n\njmx æ¢æ¯ java ç®¡çç³»ç»çä¸ä¸ªæ åï¼ä¸ä¸ªè§èï¼ä¹æ¯ä¸ä¸ªæ¥å£ï¼ä¸ä¸ªæ¡æ¶ãææ åãæè§èæ¯ä¸ºäºè®©å¼åèå¯ä»¥å®å¶å¼åèªå·±çæ©å±åè½ï¼èä¸ä½ä¸ºä¸ä¸ªæ¡æ¶æ¥è®²ï¼jdk å·²ç»å¸®æä»¬å®ç°äºå¸¸ç¨çåè½ï¼å°¤å¶æ¯å¯¹ jvm ççæ§åç®¡çã\n\nhttps://www.cnblogs.com/fengzheng/p/13431845.html\n\n\n# ç±»å è½½æºå¶\n\n\n# ç±»æä»¶ç»æ\n\n\n\nå¯ç¨ javap åæclassæä»¶ã\n\n\n# èææºç±»å è½½æºå¶\n\njavaèææºææè¿°ç±»çæ°æ®ä»classæä»¶å è½½å°åå­ï¼å¹¶å¯¹æ°æ®è¿è¡æ ¡éªãè½¬æ¢è§£æååå§åï¼æç»å½¢æå¯ä»¥è¢«èææºç´æ¥ä½¿ç¨çjavaç±»åï¼è¿ä¸ªè¿ç¨è¢«ç§°ä½èææºçç±»å è½½æºå¶ã\n\nä¸é£äºå¨ç¼è¯å¨éè¦è¿è¡è¿æ¥çè¯­è¨ä¸åï¼å¨javaè¯­è¨éï¼ç±»åçå è½½ãè¿æ¥ååå§åé½æ¯å¨ç¨åºè¿è¡æé´å®æçã\n\nä¸ä¸ªç±»ä»è¢«å è½½å°èææºåå­ä¸­å¼å§ï¼å°å¸è½½åºåå­ä¸ºæ­¢ï¼å®çæ´ä¸ªçå½å¨æå°ä¼ç»å7ä¸ªé¶æ®µã\n\n\n\nå è½½ã éªè¯ã åå¤ã åå§ååå¸è½½è¿äºä¸ªé¶æ®µçé¡ºåºæ¯ç¡®å®çï¼ ç±»åçå è½½è¿ç¨å¿é¡»æç§è¿ç§é¡ºåºæé¨å°±ç­å°å¼å§ï¼ èè§£æé¶æ®µåä¸ä¸å®ï¼ å®å¨æäºæåµä¸å¯ä»¥å¨åå§åé¶æ®µä¹ååå¼å§ï¼è¿æ¯ä¸ºäºæ¯æjavaè¯­è¨çè¿è¡æ¶ç»å®ç¹æ§ï¼ä¹ç§°ä¸ºå¨æç»å®æææç»å®ï¼ ã\n\nå¯¹äºä»ä¹æ¶åå¼å§ç±»å è½½è¿ç¨çç¬¬ä¸ä¸ªé¶æ®µâå è½½âï¼ãjavaèææºè§èãæ²¡æå¼ºå¶çº¦æã\n\nä½å¯¹äºåå§åé¶æ®µï¼åä¸¥æ ¼è§å®äºæä¸åªæä»¥ä¸å­ç§æåµå¿é¡»å¯¹ç±»è¿è¡âåå§åâï¼èå è½½ãéªè¯ãåå¤èªç¶éè¦å¨æ­¤ä¹åå¼å§ï¼ï¼\n\n 1. éå° newãgetstaticãputstaticãinvokestaticè¿åæ¡å­èç æä»¤æ¶ãè½å¤çæè¿åæ¡æä»¤çå¸åjavaä»£ç åºæ¯æï¼\n    * ä½¿ç¨newå³é®å­å®ä¾åå¯¹è±¡æ¶ã\n    * è¯»åæè®¾ç½®ä¸ä¸ªç±»åçéæå­æ®µï¼è¢«finalä¿®é¥°ãå·²å¨ç¼è¯å¨æç»ææ¾å¥å¸¸éæ± çéæå­æ®µé¤å¤ï¼çæ¶åã\n    * è°ç¨ä¸ä¸ªç±»åçéææ¹æ³æ¶ã\n 2. ä½¿ç¨ java.lang.reflectåçæ¹æ³å¯¹ç±»åè¿è¡åå°è°ç¨æ¶ã\n 3. å½åå§åç±»æ¶ï¼å¦æåç°å¶ç¶ç±»è¿æ²¡è¿è¡è¿åå§åï¼åéè¦åè§¦åå¶ç¶ç±»çåå§åã\n 4. å½èææºå¯å¨æ¶ï¼ç¨æ·éè¦æå®ä¸ä¸ªè¦æ§è¡çä¸»ç±»ï¼åå«main()çé£ä¸ªç±»ï¼ï¼èææºä¼ååå§åè¿ä¸ªç±»ã\n 5. å½ä½¿ç¨jdk 7æ°å å¥çå¨æè¯­è¨æ¯ææ¶ï¼ å¦æä¸ä¸ªjava.lang.invoke.methodhandleå®ä¾æåçè§£æç»æä¸ºref_getstaticã ref_putstaticã ref_invokestaticã ref_newinvokespecialåç§ç±»åçæ¹æ³å¥æï¼ å¹¶ä¸è¿ä¸ªæ¹æ³å¥æå¯¹åºçç±»æ²¡æè¿è¡è¿åå§åï¼ åéè¦åè§¦åå¶åå§åã\n 6. å½ä¸ä¸ªæ¥å£ä¸­å®ä¹äºjdk 8å å¥çé»è®¤æ¹æ³ï¼è¢«defaultä¿®é¥°çæ¥å£æ¹æ³ï¼ã\n\n\n# ç±»å è½½çè¿ç¨\n\nç±»å è½½çå¨è¿ç¨ï¼å è½½ãéªè¯ãåå¤ãè§£æååå§åäºä¸ªé¶æ®µã\n\n\n# å è½½\n\nè¿éçå è½½ï¼loadingï¼é¶æ®µæ¯ææ´ä¸ªç±»å è½½ï¼class loadingï¼è¿ç¨ä¸­çä¸ä¸ªé¶æ®µã\n\nèææºéè¦å®æä¸ä»¶äºï¼\n\n 1. éè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åå®ä¹æ­¤ç±»çäºè¿å¶å­èæµã\n 2. å°è¿ä¸ªå­èæµæä»£è¡¨çéæå­å¨ç»æè½¬æ¢ä¸ºæ¹æ³åºçè¿è¡æ¶æ°æ®ç»æã\n 3. å¨åå­ä¸­çæä¸ä¸ªä»£è¡¨è¿ä¸ªç±»ç java.lang.classå¯¹è±¡ï¼ä½ä¸ºæ¹æ³åºè¿ä¸ªç±»çåç§æ°æ®çè®¿é®å¥å£ã\n\nå è½½é¶æ®µç»æåï¼ javaèææºå¤é¨çäºè¿å¶å­èæµå°±æç§èææºæè®¾å®çæ ¼å¼å­å¨å¨æ¹æ³åºä¹ä¸­äºï¼ æ¹æ³åºä¸­çæ°æ®å­å¨æ ¼å¼å®å¨ç±èææºå®ç°èªè¡å®ä¹ï¼ ãjavaèææºè§èã æªè§å®æ­¤åºåçå·ä½æ°æ®ç»æã ç±»åæ°æ®å¦¥åå®ç½®å¨æ¹æ³åºä¹åï¼ ä¼å¨javaå åå­ä¸­å®ä¾åä¸ä¸ªjava.lang.classç±»çå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡å°ä½ä¸ºç¨åºè®¿é®æ¹æ³åºä¸­çç±»åæ°æ®çå¤é¨æ¥å£ã\n\n\n# éªè¯\n\néªè¯æ¯è¿æ¥é¶æ®µçç¬¬ä¸æ­¥ï¼ è¿ä¸é¶æ®µçç®çæ¯ç¡®ä¿classæä»¶çå­èæµä¸­åå«çä¿¡æ¯ç¬¦åãjavaèææºè§èã çå¨é¨çº¦æè¦æ±ï¼ ä¿è¯è¿äºä¿¡æ¯è¢«å½ä½ä»£ç è¿è¡åä¸ä¼å±å®³èææºèªèº«çå®å¨ã\n\nä»æ´ä½ä¸çï¼ éªè¯é¶æ®µå¤§è´ä¸ä¼å®æä¸é¢åä¸ªé¶æ®µçæ£éªå¨ä½ï¼ æä»¶æ ¼å¼éªè¯ã åæ°æ®éªè¯ã å­èç éªè¯åç¬¦å·å¼ç¨éªè¯ã\n\n\n# åå¤\n\nåå¤é¶æ®µæ¯æ­£å¼ä¸ºç±»ä¸­å®ä¹çåéï¼å³éæåéï¼ è¢«staticä¿®é¥°çåéï¼ åéåå­å¹¶è®¾ç½®ç±»åéåå§å¼çé¶æ®µã\n\nè¿æ¶åè¿è¡åå­åéçä»åæ¬ç±»åéï¼ èä¸åæ¬å®ä¾åéï¼ å®ä¾åéå°ä¼å¨å¯¹è±¡å®ä¾åæ¶éçå¯¹è±¡ä¸èµ·åéå¨javaå ä¸­ã\n\n\n# è§£æ\n\nè§£æé¶æ®µæ¯javaèææºå°å¸¸éæ± åçç¬¦å·å¼ç¨æ¿æ¢ä¸ºç´æ¥å¼ç¨çè¿ç¨ã\n\n * ç¬¦å·å¼ç¨ï¼symbolic referencesï¼ ï¼ ç¬¦å·å¼ç¨ä»¥ä¸ç»ç¬¦å·æ¥æè¿°æå¼ç¨çç®æ ï¼ ç¬¦å·å¯ä»¥æ¯ä»»ä½å½¢å¼çå­é¢éï¼ åªè¦ä½¿ç¨æ¶è½æ æ­§ä¹å°å®ä½å°ç®æ å³å¯ã ç¬¦å·å¼ç¨ä¸èææºå®ç°çåå­å¸å±æ å³ï¼ å¼ç¨çç®æ å¹¶ä¸ä¸å®æ¯å·²ç»å è½½å°èææºåå­å½ä¸­çåå®¹ã åç§èææºå®ç°çåå­å¸å±å¯ä»¥åä¸ç¸åï¼ä½æ¯å®ä»¬è½æ¥åçç¬¦å·å¼ç¨å¿é¡»é½æ¯ä¸è´çï¼ å ä¸ºç¬¦å·å¼ç¨çå­é¢éå½¢å¼æç¡®å®ä¹å¨ãjavaèææºè§èã çclassæä»¶æ ¼å¼ä¸­ãegï¼å¨classæä»¶ä¸­ constant_class_infoãconstant_fieldref_infoã constant_methodref_infoç­ç±»åçå¸¸éåºç°ã\n * ç´æ¥å¼ç¨ï¼direct referencesï¼ ï¼ ç´æ¥å¼ç¨æ¯å¯ä»¥ç´æ¥æåç®æ çæéã ç¸å¯¹åç§»éæèæ¯ä¸ä¸ªè½é´æ¥å®ä½å°ç®æ çå¥æã ç´æ¥å¼ç¨æ¯åèææºå®ç°çåå­å¸å±ç´æ¥ç¸å³çï¼ åä¸ä¸ªç¬¦å·å¼ç¨å¨ä¸åèææºå®ä¾ä¸ç¿»è¯åºæ¥çç´æ¥å¼ç¨ä¸è¬ä¸ä¼ç¸åã å¦ææäºç´æ¥å¼ç¨ï¼ é£å¼ç¨çç®æ å¿å®å·²ç»å¨èææºçåå­ä¸­å­å¨ã\n\nè§£æå¨ä½ä¸»è¦éå¯¹ç±»ææ¥å£ã å­æ®µã ç±»æ¹æ³ã æ¥å£æ¹æ³ã æ¹æ³ç±»åã æ¹æ³å¥æåè°ç¨ç¹éå®ç¬¦è¿7ç±»ç¬¦å·å¼ç¨è¿è¡ï¼ åå«å¯¹åºäºå¸¸éæ± çconstant_class_infoã con-stant_fieldref_infoãconstant_methodref_infoã constant_interfacemethodref_infoãconstant_methodtype_infoã constant_methodhandle_infoã constant_dyna-mic_infoåconstant_invokedynamic_info 8ç§å¸¸éç±»åã\n\n\n# åå§å\n\nå¨ä¹åç±»å è½½å¨ä½ä¸­ï¼é¤äºå¨å è½½é¶æ®µåºç¨ç¨åºå¯ä»¥éè¿èªå®ä¹ç±»å è½½å¨çæ¹å¼å±é¨åä¸å¤ï¼å¶ä½å¨ä½é½å®å¨ç±javaèææºæ¥ä¸»å¯¼æ§å¶ãç´å°åå§åé¶æ®µï¼javaèææºæçæ­£å¯æ¯æ§è¡ç±»ä¸­ç¼åçjavaç¨åºä»£ç ï¼å°ä¸»å¯¼æäº¤ç»åºç¨ç¨åºã\n\nè¿è¡åå¤é¶æ®µæ¶ï¼ åéå·²ç»èµè¿ä¸æ¬¡ç³»ç»è¦æ±çåå§é¶å¼ï¼ èå¨åå§åé¶æ®µï¼ åä¼æ ¹æ®ç¨åºåéè¿ç¨åºç¼ç å¶å®çä¸»è§è®¡åå»åå§åç±»åéåå¶ä»èµæºã æä»¬ä¹å¯ä»¥ä»å¦å¤ä¸ç§æ´ç´æ¥çå½¢å¼æ¥è¡¨è¾¾ï¼ åå§åé¶æ®µå°±æ¯æ§è¡ç±»æé å¨<clinit>()æ¹æ³çè¿ç¨ã <clinit>()å¹¶ä¸æ¯ç¨åºåå¨javaä»£ç ä¸­ç´æ¥ç¼åçæ¹æ³ï¼ å®æ¯javacç¼è¯å¨çèªå¨çæç©ã\n\n\n# ç±»å è½½å¨\n\njavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­çâéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°javaèææºå¤é¨å»å®ç°ï¼ ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ã å®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨âï¼class loaderï¼ ã\n\nå¯¹äºä»»æä¸ä¸ªç±»ï¼é½å¿é¡»ç±å è½½å®çç±»å è½½å¨åè¿ä¸ªç±»æ¬èº«ä¸èµ·å±åç¡®ç«å¶å¨javaèææºä¸­çå¯ä¸æ§ã\n\næ¯ä¸ä¸ªç±»å è½½å¨ï¼é½æ¥æä¸ä¸ªç¬ç«çç±»åè¯ç©ºé´ã\n\næ¯è¾ä¸¤ä¸ªç±»æ¯å¦âç¸ç­âï¼åªæå¨è¿ä¸¤ä¸ªç±»æ¯ç±åä¸ä¸ªç±»å è½½å¨å è½½çåæä¸æææä¹ãå¦åï¼å³ä½¿è¿ä¸¤ä¸ªç±»æ¥æºäºåä¸ä¸ªclassæä»¶ï¼è¢«åä¸ä¸ªjavaèææºå è½½ï¼åªè¦å è½½å®ä»¬çç±»å è½½å¨ä¸åï¼é£è¿ä¸¤ä¸ªç±»å°±å¿å®ä¸ç¸ç­ã\n\nè¿éææçâç¸ç­âï¼ åæ¬ä»£è¡¨ç±»çclasså¯¹è±¡çequals()æ¹æ³ã isassignablefrom()æ¹æ³ã isinstance()æ¹æ³çè¿åç»æï¼ ä¹åæ¬äºä½¿ç¨instanceofå³é®å­åå¯¹è±¡æå±å³ç³»å¤å®ç­åç§æåµã\n\nä»javaèææºçè§åº¦æ¥çï¼åªå­å¨ä¸¤ç§ä¸åçç±»å è½½å¨ï¼\n\n 1. å¯å¨ç±»å è½½å¨ï¼bootstrap classloaderï¼ï¼è¿ä¸ªç±»å è½½å¨æ¯ä½¿ç¨c++å®ç°çï¼æ¯èææºèªèº«çä¸é¨åã\n 2. å¶ä»ææçç±»å è½½å¨ï¼è¿äºç±»å è½½å¨é½ç±javaå®ç°çï¼ç¬ç«äºèææºå¤é¨ï¼å¹¶ä¸å¨é¨ç»§æ¿èªæ½è±¡ç±» java.lang.classloader\n\nèªjdk 1.2ä»¥æ¥ï¼javaä¸ç´ä¿æçä¸å±ç±»å è½½å¨ãåäº²å§æ´¾çç±»å è½½æ¶æãï¼å¨javaæ¨¡åååæä¸äºè°æ´ï¼ä½ä¸»ä½ç»ææ²¡åï¼ã\n\n\n# ä¸å±ç±»å è½½å¨\n\njdk 9 ä¹åï¼\n\nç»å¤§å¤æ°javaç¨åºé½ä¼ä½¿ç¨å°ä»¥ä¸3ä¸ªç³»ç»æä¾çç±»å è½½å¨æ¥è¿è¡å è½½ã\n\n 1. å¯å¨ç±»å è½½å¨ bootstrap class loaderï¼è´è´£å è½½å­æ¾å¨ <java_home>\\libç®å½ï¼æè¢« -xbootclasspathåæ°ææå®çè·¯å¾ä¸­å­æ¾çï¼å¹¶ä¸æ¯javaèææºè½è¯å«çç±»åºå è½½å°èææºçåå­ä¸­ãï¼egï¼rt.jarãtools.jarï¼\n 2. æ©å±ç±»å è½½å¨ extension class loaderï¼è´è´£å è½½ <java_home>\\lib\\extç®å½ï¼æè¢« java.ext.dirsç³»ç»åéææå®çè·¯å¾ä¸­ææçç±»åºã\n 3. åºç¨ç¨åºç±»å è½½å¨/ç³»ç»ç±»å è½½å¨ application class loaderï¼è´è´£å è½½ç¨æ·ç±»è·¯å¾ï¼classpathï¼ä¸ææçç±»åºãå¦æåºç¨ç¨åºä¸­æ²¡æèªå®ä¹è¿èªå·±çç±»å è½½å¨ï¼ä¸è¬æåµä¸è¿ä¸ªå°±æ¯ç¨åºä¸­é»è®¤çç±»å è½½å¨ã\n\nå¦ææéè¦ï¼è¿å¯ä»¥èªå®ä¹ç±»å è½½å¨ãegï¼å¢å é¤äºç£çä½ç½®ä¹å¤çclassæä»¶æ¥æºï¼ æèéè¿ç±»å è½½å¨å®ç°ç±»çéç¦»ã éè½½ç­åè½ã\n\n\n# åäº²å§æ´¾æ¨¡åï¼parents delegation modelï¼\n\nåç§ç±»å è½½å¨æ¯ç»ä»¶çå±æ¬¡å³ç³»å°±è¢«ç§°ä¸ºç±»å è½½å¨çåäº²å§æ´¾æ¨¡åã\n\nåäº²å§æ´¾æ¨¡åè¦æ±é¤äºé¡¶å±çå¯å¨ç±»å è½½å¨å¤ï¼å¶ä½çç±»å è½½å¨é½åºæèªå·±çç¶ç±»å è½½å¨ãä¸è¿è¿éç±»å è½½å¨ä¹é´çç¶å­å³ç³»ä¸è¬ä¸æ¯ç»§æ¿ï¼inheritanceï¼çå³ç³»æ¥å®ç°çï¼èæ¯ä½¿ç¨ç»åï¼compositionï¼å³ç³»æ¥å¤ç¨ç¶ç±»å è½½å¨çä»£ç ã\n\n**åäº²å§æ´¾æ¨¡åçå·¥ä½è¿ç¨æ¯ï¼**å¦æä¸ä¸ªç±»å è½½å¨æ¶å°äºç±»å è½½çè¯·æ±ï¼å®é¦åä¸ä¼èªå·±å»å°è¯å è½½è¿ä¸ªç±»ï¼èæ¯æè¿ä¸ªè¯·æ±å§æ´¾ç»ç¶ç±»å è½½å¨å»å®æï¼æ¯ä¸ä¸ªå±æ¬¡çç±»å è½½å¨é½æ¯å¦æ­¤ï¼å æ­¤ææçå è½½è¯·æ±æç»é½åºè¯¥ä¼ éå°æé¡¶å±çå¯å¨ç±»å è½½å¨ä¸­ï¼åªæå½ç¶ç±»å è½½å¨åé¦èªå·±æ æ³å®æè¿ä¸ªå è½½è¯·æ±ï¼å®çæç´¢èå´ä¸­æ²¡ææ¾å°æéçç±»ï¼æ¶ï¼å­å è½½å¨æä¼å°è¯èªå·±å»å®æå è½½ã\n\nä½¿ç¨åäº²å§æ´¾æ¨¡åæ¥ç»ç»ç±»å è½½å¨ä¹é´çå³ç³»ï¼ ä¸ä¸ªæ¾èæè§çå¥½å¤å°±æ¯javaä¸­çç±»éçå®çç±»å è½½å¨ä¸èµ·å·å¤äºä¸ç§å¸¦æä¼åçº§çå±æ¬¡å³ç³»ã ä¾å¦ç±»java.lang.objectï¼ å®å­æ¾å¨rt.jarä¹ä¸­ï¼ æ è®ºåªä¸ä¸ªç±»å è½½å¨è¦å è½½è¿ä¸ªç±»ï¼ æç»é½æ¯å§æ´¾ç»å¤äºæ¨¡åæé¡¶ç«¯çå¯å¨ç±»å è½½å¨è¿è¡å è½½ï¼ å æ­¤objectç±»å¨ç¨åºçåç§ç±»å è½½å¨ç¯å¢ä¸­é½è½å¤ä¿è¯æ¯åä¸ä¸ªç±»ã\n\nåäº²å§æ´¾æ¨¡åçå®ç°ï¼\n\n//java.lang.classloaderçloadclass()\nprotected synchronized class<?> loadclass(string name, boolean resolve) throws classnotfoundexception\n{\n// é¦åï¼ æ£æ¥è¯·æ±çç±»æ¯å¦å·²ç»è¢«å è½½è¿äº\nclass c = findloadedclass(name);\nif (c == null) {\ntry {\nif (parent != null) {\nc = parent.loadclass(name, false);\n} else {\nc = findbootstrapclassornull(name);\n}}\ncatch (classnotfoundexception e) {\n// å¦æç¶ç±»å è½½å¨æåºclassnotfoundexception\n// è¯´æç¶ç±»å è½½å¨æ æ³å®æå è½½è¯·æ±\n}i\nf (c == null) {\n// å¨ç¶ç±»å è½½å¨æ æ³å è½½æ¶\n// åè°ç¨æ¬èº«çfindclassæ¹æ³æ¥è¿è¡ç±»å è½½\nc = findclass(name);\n}\n}i\nf (resolve) {\nresolveclass(c);\n}return c;\n}\n\n\nåæ£æ¥è¯·æ±å è½½çç±»åæ¯å¦å·²ç»è¢«å è½½è¿ï¼ è¥æ²¡æåè°ç¨ç¶å è½½å¨çloadclass()æ¹æ³ï¼ è¥ç¶å è½½å¨ä¸ºç©ºåé»è®¤ä½¿ç¨å¯å¨ç±»å è½½å¨ä½ä¸ºç¶å è½½å¨ã åå¦ç¶ç±»å è½½å¨å è½½å¤±è´¥ï¼ æåºclassnotfoundexceptionå¼å¸¸çè¯ï¼ æè°ç¨èªå·±çfindclass()æ¹æ³å°è¯è¿è¡å è½½ã\n\n\n# javaæ¨¡ååç³»ç»\n\njdk 9 ä¸­å¼å¥äºjavaæ¨¡ååç³»ç»ï¼java platform module system, jpmsï¼ã\n\nï¼æ¨¡ååå°åºæä¹æ ·ï¼æ²¡çæï¼\n\nä¸ºäºä¿è¯å¼å®¹æ§ï¼ jdk 9å¹¶æ²¡æä»æ ¹æ¬ä¸å¨æä»jdk 1.2ä»¥æ¥è¿è¡äºäºåå¹´ä¹ä¹çä¸å±ç±»å è½½å¨æ¶æä»¥ååäº²å§æ´¾æ¨¡åã ä½æ¯ä¸ºäºæ¨¡ååç³»ç»çé¡ºå©æ½è¡ï¼ æ¨¡ååä¸çç±»å è½½å¨ä»ç¶åçäºä¸äºåºè¯¥è¢«æ³¨æå°åå¨ï¼ ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. æ©å±ç±»å è½½å¨ï¼extension class loaderï¼ è¢«å¹³å°ç±»å è½½å¨ï¼platform class loaderï¼ åä»£ã\n 2. jdk 9ä¸­è½ç¶ä»ç¶ç»´æçä¸å±ç±»å è½½å¨ååäº²å§æ´¾çæ¶æï¼ ä½ç±»å è½½çå§æ´¾å³ç³»ä¹åçäºåå¨ã å½å¹³å°ååºç¨ç¨åºç±»å è½½å¨æ¶å°ç±»å è½½è¯·æ±ï¼ å¨å§æ´¾ç»ç¶å è½½å¨å è½½åï¼ è¦åå¤æ­è¯¥ç±»æ¯å¦è½å¤å½å±å°æä¸ä¸ªç³»ç»æ¨¡åä¸­ï¼ å¦æå¯ä»¥æ¾å°è¿æ ·çå½å±å³ç³»ï¼ å°±è¦ä¼åå§æ´¾ç»è´è´£é£ä¸ªæ¨¡åçå è½½å¨å®æå è½½ã\n\nå¨javaæ¨¡ååç³»ç»æç¡®çè§å®äºä¸ä¸ªç±»å è½½å¨è´è´£åèªå è½½çæ¨¡åã\n\n\n\n\n# javaåå­æ¨¡å\n\n\n# ç¡¬ä»¶çæçä¸ä¸è´æ§\n\n\n\nåºäºåè¯ç¼å­çå­å¨äº¤äºå¾å¥½çè§£å³äºå¤çå¨ä¸åå­éåº¦ä¹é´ççç¾ï¼ä½å¸¦æ¥äºä¸ä¸ªæ°é®é¢ï¼ç¼å­ä¸è´æ§ï¼cache coherenceï¼ãä¸ºäºè§£å³ä¸è´æ§é®é¢ï¼éè¦åä¸ªå¤çå¨è®¿é®ç¼å­æ¶é½éµå¾ªä¸äºåè®®ãè¿ç±»åè®®æï¼msiãmesiãmosiããã\n\njavaèææºä¹æèªå·±çåå­æ¨¡åï¼å¹¶ä¸åè¿éçåå­è®¿é®æä½åç¡¬ä»¶çç¼å­æä½è§æé«åº¦çå¯ç±»æ¯æ§ã\n\n\n# javaåå­æ¨¡å\n\njava memory modelï¼jmm\n\n\n\nè¿éçä¸»åå­ãå·¥ä½åå­ä¸javaåå­åºåä¸­çjavaå ãæ ãæ¹æ³åºç­ä¸æ¯ä¸ä¸ªæ¦å¿µï¼æ²¡æå³ç³»ã\n\n * javaåå­æ¨¡åè§å®äºææçåéé½å­å¨å¨ä¸»åå­ä¸­ã\n\n * æ¯æ¡çº¿ç¨è¿æèªå·±çå·¥ä½åå­ï¼çº¿ç¨ä¸­çå·¥ä½åå­ä¸­ä¿å­äºè¢«è¯¥çº¿ç¨ä½¿ç¨çåéçä¸»åå­å¯æ¬ï¼çº¿ç¨å¯¹åéçæææä½ï¼è¯»åãèµå¼ç­ï¼é½å¿é¡»å¨å·¥ä½åå­ä¸­è¿è¡ï¼èä¸è½ç´æ¥è¯»åä¸»åå­ä¸­çæ°æ®ã\n\n * ä¸åççº¿ç¨ä¹é´ä¹æ æ³ç´æ¥è®¿é®å¯¹æ¹å·¥ä½åå­ä¸­çåéï¼çº¿ç¨é´åéå¼çä¼ éåéè¦éè¿ä¸»åå­æ¥å®æã\n\nè¿éè¯´çåéä¸javaç¼ç¨ä¸­çåéææåºå«ï¼å®åæ¬äºå®ä¾å­æ®µãéæå­æ®µåæææ°ç»å¯¹è±¡çåç´ ï¼ä½æ¯ä¸åæ¬å±é¨åéä¸æ¹æ³åæ°ï¼å ä¸ºæ¯çº¿ç¨ç§æçï¼ä¸ä¼è¢«å±äº«ï¼ä¸ä¼å­å¨ç«äºé®é¢ã\n\nå¯¹äºä¸»åå­åå·¥ä½åå­ä¹é´çäº¤äºåè®®ï¼javaåå­æ¨¡åä¸­å®ä¹äº8ç§æä½æ¥å®æï¼javaèææºå®ç°æ¶å¿é¡»ä¿è¯è¿8ç§æä½æ¯ä¸ä¸ªé½æ¯åå­çãåæ¥ï¼ç®åä¸º read, write, lock, unlock åç§ã\n\nvolatile å¯ä»¥è¯´æ¯javaèææºæä¾çæè½»éçº§çåæ­¥æºå¶ãå½ä¸ä¸ªåéè¢«å®ä¸ºæ volatile ä¹åï¼å®å°å·å¤ä¸¤ä¸ªç¹æ§ï¼\n\n 1. ä¿è¯åéå¯¹ææçº¿ç¨çå¯è§æ§ãï¼å¹¶ä¸ä¿è¯åå­æ§ï¼å³ä½¿ç¼è¯åºæ¥åªæä¸æ¡å­èç æä»¤ï¼ä¹ä¸æå³çè¿æ¡æä»¤å°±æ¯ä¸ä¸ªåå­æä½ï¼\n 2. ç¦æ­¢æä»¤éæåºä¼åã\n\nå¤§å¤æ°æåµä¸ volatile çæ»å¼ä¸æ¯éè¦ä½ï¼å æ­¤æä»¬å¨ volatile ä¸éçéæ©ä¸­ï¼å¯ä¸å¤æ­ä¾æ®ä¾¿æ¯ volatileçè¯­ä¹è½å¦æ»¡è¶³ä½¿ç¨åºæ¯çéæ±ã\n\nå¯¹äº volatile åéçç¹æ®è§åï¼\n\n * å¨å·¥ä½åå­ä¸­ï¼æ¯æ¬¡ä½¿ç¨åé½å¿é¡»åä»ä¸»åå­å·æ°ææ°çå¼ï¼ä¿è¯è½çèµ·å¶ä»çº¿ç¨å¯¹åéæåçä¿®æ¹ã\n * å¨å·¥ä½åå­ä¸­ï¼æ¯æ¬¡ä¿®æ¹åé½å¿é¡»ç«å»åæ­¥åä¸»åå­ä¸­ï¼ä¿è¯å¶ä»çº¿ç¨å¯ä»¥çå°èªå·±å¯¹åéçä¿®æ¹ã\n * ä¿®é¥°çåéä¸ä¼è¢«æä»¤éæåºä¼åï¼ä»èä¿è¯ä»£ç çæ§è¡é¡ºåºä¸ç¨åºçé¡ºåºç¸åã\n\nåå­æ§ï¼\n\nå°½ç®¡èææºæªæ lock å unlock æä½ç´æ¥å¼æ¾ç»ç¨æ·ä½¿ç¨ï¼ä½æ¯å´æä¾äºæ´é«å±æ¬¡çå­èç æä»¤ monitorenter å monitorexit æ¥éå¼çä½¿ç¨è¿ä¸¤ä¸ªæä½ãè¿ä¸¤ä¸ªå­èç æä»¤åæ å°javaä»£ç ä¸­å°±æ¯åæ­¥å¿«synchronizedå³é®å­ã\n\nå¯è§æ§ï¼\n\né¤äº volatile ä¹å¤ï¼javaè¿æä¸¤ä¸ªå³é®å­å¯ä»¥å®ç°å¯è§æ§ï¼synchronized å finalã\n\nfinal çå¯è§æ§æ¯æï¼è¢«finalä¿®é¥°çå­æ®µå¨æé å¨ä¸­ä¸æ¦è¢«åå§åå®æï¼å¹¶ä¸æé æ²¡ææ this çå¼ç¨ä¼ éåºå»ï¼é£ä¹å¨å¶ä»çº¿ç¨ä¸­å°±è½çè§ final å­æ®µçå¼ã\n\næåºæ§ï¼\n\nå¦æå¨æ¬çº¿ç¨åè§å¯ï¼æææä½é½æ¯æåºçã\n\nå¦æå¨ä¸ä¸ªçº¿ç¨è§å¯å¦ä¸ä¸ªçº¿ç¨ï¼ææçæä½é½æ¯æ åºçã\n\n\n# åè¡åçï¼happens-beforeï¼åå\n\nå¦æjava åå­æ¨¡åä¸­ææçæåºæ§é½åªé  volatile å synchronized æ¥å®æï¼é£ä¹å¾å¤æä½å°ä¼åå¾éå¸¸å°å¦ã\n\nèjavaéè¿åè¡åçï¼happens-beforeï¼ååï¼å¯¹æ°æ®æ¯å¦å­å¨ç«äºï¼çº¿ç¨æ¯å¦å®å¨è¿è¡äºå¤æ­ã\n\nåè¡åçæ¯æï¼javaåå­æ¨¡åä¸­å®ä¹çä¸¤é¡¹æä½ä¹é´çååºå³ç³»ï¼å¦ææä½aåè¡åçä¸æä½bï¼é£å°±æ¯è¯´å¨åéæä½bä¹åï¼æä½aäº§ççå½±åè½è¢«æä½bè§å¯å°ãå½±ååæ¬ä¿®æ¹äºåå­ä¸­å±äº«åéçå¼ãåéäºæ¶æ¯ãè°ç¨äºæ¹æ³ç­ã\n\nä»¥ä¸æ¯javaåå­æ¨¡åä¸­çåè¡åçå³ç³»ï¼ï¼å¦æä¸¤ä¸ªæä½ä¹é´çå³ç³»ä¸å¨æ­¤åï¼ æ æ³ä»ä¸åè§åæ¨å¯¼åºæ¥ï¼ åå®ä»¬å°±æ²¡æé¡ºåºæ§ä¿éï¼ èææºå¯ä»¥å¯¹å®ä»¬éæå°è¿è¡éæåºãï¼\n\n * ç¨åºæ¬¡åºè§å program order ruleï¼å¨ä¸ä¸ªçº¿ç¨åï¼æç§æ§å¶æµç¨é¡ºåºï¼ä¹¦åå¨åé¢çæä½åè¡åçä¸ä¹¦åå¨åé¢çæä½\n * ç®¡ç¨éå®è§å monitor lock ruleï¼ä¸ä¸ªunlock æä½åè¡åçä¸åé¢å¯¹åä¸ä¸ªéçlockæä½ã\n * çº¿ç¨å¯å¨è§å thread start ruleï¼threadå¯¹è±¡çstart()æ¹æ³åè¡åçä¸æ­¤çº¿ç¨çæ¯ä¸ä¸ªå¨ä½ã\n * çº¿ç¨ç»æ­¢è§å thead termination ruleï¼çº¿ç¨ä¸­çæææä½é½åè¡åçäºå¯¹æ­¤çº¿ç¨çç»æ­¢æ£æµï¼å¯ä»¥éè¿ thread::jion() æ¹æ³æ¯å¦ç»æãthread::isalive()çè¿åå¼ç­ææ®µæ£æµçº¿ç¨æ¯å¦å·²ç»ç»æ­¢æ§è¡ã\n * çº¿ç¨ä¸­æ­è§å thread interruption ruleï¼å¯¹çº¿ç¨interrput()æ¹æ³çè°ç¨åè¡åçäºè¢«ä¸­æ­çº¿ç¨çä»£ç æ£æµå°ä¼ä¸­æ­äºä»¶çåçï¼å¯ä»¥éè¿ thread::interrupted()æ¹æ³æ£æµå°æ¯å¦æä¸­æ­åçã\n * å¯¹è±¡ç»ç»è§å finalize ruleï¼ä¸ä¸ªå¯¹è±¡çåå§åå®æï¼æé å½æ°æ§è¡ç»æï¼åè¡åçäºå®çfinalize()æ¹æ³çå¼å§ã\n * ä¼ éæ§ transitivityï¼å¦ææä½aåè¡åçä¸æä½bï¼æä½båè¡åçä¸æä½cï¼é£ä¹æä½aåè¡åçäºæä½cã\n\n\n# java ä¸çº¿ç¨\n\nçº¿ç¨æ¯æ¯è¿ç¨æ´è½»éçº§çè°åº¦æ§è¡åä½ï¼å¼å¥äºçº¿ç¨ï¼å¯ä»¥æä¸ä¸ªè¿ç¨çèµæºåéåæ§è¡è°åº¦åå¼ï¼åä¸ªçº¿ç¨æ¢å¯ä»¥å±äº«è¿ç¨èµæºï¼åå­å°åãæä»¶i/oç­ï¼ï¼åå¯ä»¥ç¬ç«è°åº¦ã\n\nç®åçº¿ç¨æ¯javaè¿è¡å¤çå¨èµæºè°åº¦çæåºæ¬åä½ã\n\nä¸»æµjavaèææºççº¿ç¨æ¨¡åé½æ¯åºäºæä½ç³»ç»åççº¿ç¨æ¨¡åæ¥å®ç°çï¼å³éç¨1ï¼1çº¿ç¨æ¨¡åã\n\né»å¡åç­å¾çåºå«ï¼\n\n * é»å¡ï¼å¨ç­å¾è·åä¸ä¸ªæä»éï¼è¿ä¸ªäºä»¶å°å¨å¦ä¸ä¸ªçº¿ç¨æ¾å¼è¿ä¸ªéçæ¶ååç\n * ç­å¾ï¼åæ¯å¨ç­å¾ä¸æ®µæ¶é´ï¼æèå¤éå¨ä½çåçã\n\n\n\n\n# java ä¸åç¨ãä¸æ¯å¾çè§£ã\n\n1ï¼ 1çåæ ¸çº¿ç¨æ¨¡åæ¯å¦ä»javaèææºçº¿ç¨å®ç°çä¸»æµéæ©ï¼ ä½æ¯è¿ç§æ å°å°æä½ç³»ç»ä¸ççº¿ç¨å¤©ç¶çç¼ºé·æ¯åæ¢ã è°åº¦ææ¬é«æï¼ ç³»ç»è½å®¹çº³ççº¿ç¨æ°éä¹å¾æéã\n\nä¼ ç»çjava webæå¡å¨ççº¿ç¨æ± çå®¹ééå¸¸å¨å åä¸ªå°ä¸¤ç¾ä¹é´ï¼ å½ç¨åºåææ°ä»¥ç¾ä¸è®¡çè¯·æ±å¾çº¿ç¨æ± éé¢çæ¶ï¼ ç³»ç»å³ä½¿è½å¤çå¾è¿æ¥ï¼ ä½å¶ä¸­çåæ¢æèä¹æ¯ç¸å½å¯è§çã\n\nåæ ¸çº¿ç¨çè°åº¦ææ¬ä¸»è¦æ¥èªäºç¨æ·æä¸æ ¸å¿æä¹é´çç¶æè½¬æ¢ï¼ èè¿ä¸¤ç§ç¶æè½¬æ¢çå¼éä¸»è¦æ¥èªäºååºä¸­æ­ã ä¿æ¤åæ¢å¤æ§è¡ç°åºçææ¬ã\n\nåæ¥ï¼ æä½ç³»ç»å¼å§æä¾å¤çº¿ç¨çæ¯æï¼ é åºç¨èªå·±æ¨¡æå¤çº¿ç¨çåæ³èªç¶æ¯åå°äºè®¸å¤ï¼ ä½ä¹å¹¶æ²¡æå®å¨æ¶å¤±ï¼ èæ¯æ¼åä¸ºç¨æ·çº¿ç¨ç»§ç»­å­å¨ã ç±äºæåå¤æ°çç¨æ·çº¿ç¨æ¯è¢«è®¾è®¡æååå¼è°åº¦ï¼cooperative schedulingï¼ çï¼ æä»¥å®æäºä¸ä¸ªå«åâââåç¨âï¼coroutineï¼ ã åç±äºè¿æ¶åçåç¨ä¼å®æ´å°åè°ç¨æ çä¿æ¤ã æ¢å¤å·¥ä½ï¼ æä»¥ä»å¤©ä¹è¢«ç§°ä¸ºâææ åç¨âï¼stackfull coroutineï¼ ï¼ èµ·è¿æ ·çåå­æ¯ä¸ºäºä¾¿äºè·åæ¥çâæ æ åç¨âï¼stackless coroutineï¼ åºåå¼ã æ æ åç¨ä¸æ¯æ¬èçä¸»è§ï¼ ä¸è¿è¿æ¯å¯ä»¥ç®åæä¸ä¸å®çå¸ååºç¨ï¼ å³åç§è¯­è¨ä¸­çawaitã asyncã yieldè¿ç±»å³é®å­ã æ æ åç¨æ¬è´¨ä¸æ¯ä¸ç§æéç¶ææºï¼ ç¶æä¿å­å¨é­åéï¼ èªç¶æ¯ææ åç¨æ¢å¤è°ç¨æ è¦è½»éå¾å¤ï¼ ä½åè½ä¹ç¸å¯¹æ´æéã\n\nå¯¹äºææ åç¨ï¼ æä¸ç§ç¹ä¾å®ç°åä¸ºçº¤ç¨ï¼fiberï¼\n\n\n# çº¿ç¨å®å¨\n\nçº¿ç¨å®å¨çå®ç°æ¹æ³ï¼\n\n\n# äºæ¥åæ­¥ï¼é»å¡åæ­¥ï¼\n\näºæ¥æ¯ææ®µï¼åæ­¥æ¯ç®çã\n\nä¸´çåºï¼critical sectionï¼ãäºæ¥éï¼mutexï¼ãä¿¡å·éï¼semaphoreï¼é½æ¯å¸¸è§çäºæ¥å®ç°æ¹æ³ã\n\nå¨javaä¸­ï¼æåºæ¬çäºæ¥åæ­¥ææ®µå°±æ¯ synchronized ï¼è¿æ¯ä¸ç§åç»æï¼block structuredï¼çåæ­¥è¯­æ³ã\n\nsynchronized ç»è¿javac ç¼è¯åï¼ä¼å¨åæ­¥ååååå«å½¢æ monitorenter åmonitorexitä¸¤ä¸ªå­èç æä»¤ãè¿ä¸¤ä¸ªå­èç æä»¤é½éè¦ä¸ä¸ªreferenceç±»åçåæ°æ¥ææè¦éå®åè§£éçå¯¹è±¡ãå¦æä»£ç ä¸­synchronizedæç¡®ææäºå¯¹è±¡åæ°ï¼é£å°±ä»¥è¿ä¸ªå¯¹è±¡çå¼ç¨ä½ä¸ºreferenceï¼å³è·å¾çæ¯ä½ ä¼ å¥çï¼ä¼ å¥å¯¹è±¡å°±æ¯å¯¹è±¡éãthisä¹æ¯å¯¹è±¡éãï¼ä¼ å¥ç±»å°±æ¯ç±»éï¼ï¼å¦ææ²¡ææç¡®æå®ï¼å°æ ¹æ®synchronizedä¿®é¥°çæ¹æ³ç±»åï¼å®ä¾æ¹æ³è¿æ¯ç±»æ¹æ³ï¼ï¼æ¥å³å®æ¯è·åå¯¹è±¡å®ä¾è¿æ¯ç±»åå¯¹åºçclasså¯¹è±¡æ¥ä½ä¸ºçº¿ç¨è¦ææçéï¼å³ä¿®é¥°å®ä¾æ¹æ³è·åçæ¯å¯¹è±¡éï¼ä¿®é¥°éææ¹æ³è·åçæ¯ç±»éï¼ã\n\nè¢« synchronized ä¿®é¥°çåæ­¥åå¯¹åä¸æ¡çº¿ç¨æ¥è¯´æ¯å¯éå¥çãè¿æå³çåä¸çº¿ç¨åå¤è¿å¥åæ­¥åä¹ä¸ä¼åºç°æèªå·±éæ­»çæåµã\n\nè¢« synchronized ä¿®é¥°çåæ­¥åå¨ææéççº¿ç¨æ§è¡å®æ¯å¹¶éæ¾éä¹åï¼ä¼æ æ¡ä»¶çé»å¡åé¢å¶ä»çº¿ç¨çè¿å¥ã\n\njdk 5èµ·ï¼javaæä¾äºjava.util.concurrentåï¼j.u.tåï¼ï¼å¶ä¸­java.util.concurrent.locks.lockæ¥å£ä¾¿æäºjavaçå¦ä¸ç§å¨æ°çäºæ¥åæ­¥ææ®µãåºäºlockæ¥å£ï¼ç¨æ·è½å¤ä»¥éåç»æï¼non-block structuredï¼æ¥å®ç°äºæ¥åæ­¥ï¼ä»èæè±è¯­è¨ç¹æ§çæç¼ï¼å¨ç±»åºå±é¢å»å®ç°åæ­¥ã\n\néå¥éï¼reentrantlockï¼æ¯lockæ¥å£æå¸¸è§çä¸ç§å®ç°ãå¨åºæ¬ç¨æ³ä¸ï¼reentrantlock å synchronizedç¸ä¼¼ï¼åªæ¯åæ³ç¨å¾®ä¸åï¼ä¸ reentrantlock æ¯ synchronized å¤äºä¸äºé«çº§åè½ï¼ä¸»è¦æ3é¡¹ï¼\n\n 1. ç­å¾å¯ä¸­æ­\n 2. å¯å®ç°å¬å¹³é\n 3. å¯ç»å®å¤ä¸ªæ¡ä»¶\n\njdk 6 å¼å§å¯¹synchronizedè¿è¡äºéä¼åï¼reentrantlock å synchronized çæ§è½åºæ¬è½æå¹³ï¼å æ­¤æ§è½å·²ä¸åæ¯éæ© reentrantlock æ synchronized çå¤æ­å ç´ ã\n\næ¨èå¨ synchronized å reentrantlock é½è½æ»¡è¶³çåºæ¯ä¼åä½¿ç¨ synchronizedï¼åå å¦ä¸ï¼\n\n * synchronized è¶³å¤æ¸æ°ï¼ç®åã\n * lockè¦ç¡®ä¿å¨finallyä¸­éæ¾éãsynchronizedç±javaèææºæ¥ä¿è¯ã\n * ä»é¿è¿çï¼javaèææºæ´å®¹æéå¯¹synchronizedè¿è¡ä¼åãå ä¸ºjavaèææºéè¿å¨çº¿ç¨åå¯¹è±¡çåæ°æ®ä¸­è®°å½synchronizedä¸­éçç¸å³ä¿¡æ¯ï¼ä½¿ç¨lockçè¯ï¼javaèææºå¾é¾å¾ç¥å·ä½åªäºéå¯¹è±¡æ¯ç±ç¹å®çº¿ç¨æææçã\n\n\n# éé»å¡åæ­¥\n\näºæ¥åæ­¥é¢ä¸´çä¸»è¦é®é¢æ¯è¿è¡çº¿ç¨é»å¡åå¤ééå¸¦æ¥çæ§è½å¼éï¼å æ­¤è¿ç§åæ­¥ä¹è¢«ç§°ä¸ºé»å¡åæ­¥ï¼blocking synchronizationï¼ï¼å±äºæ²è§çå¹¶åç­ç¥ã\n\néé»å¡åæ­¥ï¼non-blocking synchronizationï¼æ¯åºäºå²çªæ£æµçä¹è§å¹¶åç­ç¥ï¼å²çªäºåè¿è¡è¡¥å¿ï¼æå¸¸ç¨çè¡¥å¿æªæ½æ¯ä¸æ­éè¯ï¼ç´å°æ²¡æç«äºçå±äº«æ°æ®ä½ç½®ãä¹ç§°ä¸ºæ éï¼lock-freeï¼ç¼ç¨ã\n\nä¹è§å¹¶åç­ç¥éè¦ä¾èµç¡¬ä»¶æä»¤éçåå±ï¼å ä¸ºè¦ä¿è¯æä½åå²çªæ£æµè¿ä¸¤ä¸ªæ­¥éª¤å·å¤åå­æ§ã\n\nè¿ç±»æä»¤éå¸¸ç¨ï¼\n\n * æµè¯å¹¶è®¾ç½®ï¼test and setï¼\n * è·åå¹¶å¢å ï¼fetch and incrementï¼\n * äº¤æ¢ï¼swapï¼\n * æ¯è¾å¹¶äº¤æ¢ï¼compare and swapï¼casï¼\n * å è½½é¾æ¥/æ¡ä»¶å­å¨ï¼load linked/store conditionalï¼ll/scï¼\n\njavaéæç»æ´é²åºæ¥çæ¯casæä½ï¼casæä»¤éè¦æ3ä¸ªæä½æ°ï¼åå«æ¯åéçåå­å°åvï¼æ§çé¢æå¼aï¼åå¤è®¾ç½®çæ°å¼bãcasæä»¤æ§è¡æ¶ï¼å½ä¸ä»å½vç¬¦åaæ¶ï¼å¤çå¨æä¼ç¨bæ´æ°vçå¼ï¼å¦åä¸æ§è¡æ´æ°ãä½æ è®ºæ¯å¦æ§è¡æ´æ°ï¼é½ä¼è¿åvçæ§å¼ã\n\nå¨jdk 5ä¹åï¼ javaç±»åºä¸­æå¼å§ä½¿ç¨casæä½ï¼ è¯¥æä½ç±sun.misc.unsafeç±»éé¢çcompareandswapint()åcompareandswaplong()ç­å ä¸ªæ¹æ³åè£æä¾ã hotspotèææºå¨åé¨å¯¹è¿äºæ¹æ³åäºç¹æ®å¤çï¼ å³æ¶ç¼è¯åºæ¥çç»æå°±æ¯ä¸æ¡å¹³å°ç¸å³çå¤çå¨casæä»¤ï¼ æ²¡ææ¹æ³è°ç¨çè¿ç¨ã ä¸è¿ç±äºunsafeç±»å¨è®¾è®¡ä¸å°±ä¸æ¯æä¾ç»ç¨æ·ç¨åºè°ç¨çç±»ï¼unsafe::getunsafe()çä»£ç ä¸­éå¶äºåªæå¯å¨ç±»å è½½å¨ï¼bootstrap classloaderï¼ å è½½çclassæè½è®¿é®å®ï¼ ï¼ å æ­¤å¨jdk 9ä¹ååªæjavaç±»åºå¯ä»¥ä½¿ç¨casï¼ è­¬å¦j.u.cåéé¢çæ´æ°åå­ç±»ï¼ å¶ä¸­çcompareandset()ågetandincrement()ç­æ¹æ³é½ä½¿ç¨äºunsafeç±»çcasæä½æ¥å®ç°ã èå¦æç¨æ·ç¨åºä¹æä½¿ç¨casæä½çéæ±ï¼ é£è¦ä¹å°±éç¨åå°ææ®µçªç ´unsafeçè®¿é®éå¶ï¼ è¦ä¹å°±åªè½éè¿javaç±»åºapiæ¥é´æ¥ä½¿ç¨å®ã ç´å°jdk 9ä¹åï¼ javaç±»åºæå¨varhandleç±»éå¼æ¾äºé¢åç¨æ·ç¨åºä½¿ç¨çcasæä½ã\n\nä¸ºäºè§£å³casçabaé®é¢ï¼j.u.cåæä¾äºä¸ä¸ªå¸¦ææ è®°çåå­å¼ç¨ç±»atomicstampedreferenceï¼å®å¯ä»¥éè¿æ§å¶åéå¼ççæ¬æ¥ä¿è¯casçæ­£ç¡®æ§ãä¸ç®¡ç®åè¿ä¸ªç±»ç¸å½é¸¡èï¼å¤§é¨åæåµä¸abaé®é¢ä¸ä¼å½±åç¨åºå¹¶åçæ­£ç¡®æ§ï¼å¦æéè¦è§£å³abaé®é¢ï¼éç¨ä¼ ç»çäºæ¥åæ­¥å¯è½ä¼æ¯åå­ç±»æ´é«æã\n\n\n# æ åæ­¥æ¹æ¡\n\nçº¿ç¨æ¬å°å­å¨ï¼thread local storageï¼ï¼å¦æä¸æ®µä»£ç ä¸­æéè¦çæ°æ®å¿é¡»ä¸å¶ä»ä»£ç å±äº«ï¼é£å°±ççè¿äºå±äº«æ°æ®çä»£ç è½å¦ä¿è¯åªå¨åä¸ä¸ªçº¿ç¨ä¸­æ§è¡ãå¦æè½ä¿è¯ï¼å°±å¯ä»¥æå±äº«æ°æ®çå¯è§èå´éå¶å¨åä¸ä¸ªçº¿ç¨ä¹åï¼è¿æ ·æ é¡»åæ­¥ä¹è½ä¿è¯çº¿ç¨ä¹é´ä¸åºç°æ°æ®ç«äºçé®é¢ã\n\nç¬¦åè¿ç§ç¹ç¹çåºç¨å¹¶ä¸å°è§ï¼å¤§é¨åä½¿ç¨æ¶è´¹éåçæ¶ææ¨¡å¼ï¼egï¼çäº§è-æ¶è´¹èæ¨¡å¼ï¼é½ä¼å°äº§åçæ¶è´¹è¿ç¨éå¶å¨ä¸ä¸ªçº¿ç¨ä¸­æ¶è´¹å®ï¼å¶ä¸­æéè¦çä¸ç§åºç¨å®ä¾å°±æ¯ç»å¸webäº¤äºæ¨¡åä¸­çâä¸ä¸ªè¯·æ±å¯¹åºä¸ä¸ªæå¡å¨çº¿ç¨âï¼thread-pre-requestï¼çå¤çæ¹å¼ï¼è¿ç§å¤çæ¹å¼çå¹¿æ³åºç¨ä½¿å¾å¾å¤webæå¡ç«¯åºç¨é½å¯ä»¥ä½¿ç¨çº¿ç¨æ¬å°å­å¨æ¥è§£å³çº¿ç¨å®å¨é®é¢ã\n\njavaä¸­ï¼å¦æä¸ä¸ªåéè¦è¢«å¤çº¿ç¨è®¿é®ï¼å¯ä»¥ä½¿ç¨ volatileå°å¶å£°æä¸ºâæåçâãå¦æä¸ä¸ªåéåªè¦è¢«æä¸ªçº¿ç¨ç¬äº«ï¼å¯ä»¥éè¿ java.lang.threadlocalç±»æ¥å®ç°çº¿ç¨æ¬å°å­å¨çåè½ãæ¯ä¸ä¸ªçº¿ç¨çthreadå¯¹è±¡ä¸­é½æä¸ä¸ªthreadlocalmapå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡å­å¨äºä¸ç»ä»¥threadlocal.threadlocalhashcodeä¸ºé®ï¼ä»¥æ¬å°çº¿ç¨åéä¸ºå¼çé®å¼å¯¹ï¼threadlocalå¯¹è±¡å°±æ¯å½åçº¿ç¨çthreadlocalmapçè®¿é®å¥å£ï¼æ¯ä¸ä¸ªthreadlocalå¯¹è±¡é½åå«äºä¸ä¸ªç¬ä¸æ äºçthreadlocalhashcodeï¼è¿ä¸ªå¼å°±å¯ä»¥å¨çº¿ç¨é®å¼å¯¹ä¸­æ¾å°å¯¹åºçæ¬å°çº¿ç¨åéã\n\n\n# éä¼å\n\njdk 6ï¼èææºå¢ééè¿è¡äºå¤ç§ä¼åï¼æï¼\n\n * éåºæ§èªæ adaptive spinning\n * éæ¶é¤ lock elimination\n * éè¨è lock coarsening\n * è½»éçº§é lightweight locking\n * ååé biased locking\n\n\n# èªæéä¸èªéåºèªæ\n\näºæ¥åæ­¥å¯¹æ§è½æå¤§çå½±åæ¯é»å¡çå®ç°ï¼ æèµ·çº¿ç¨åæ¢å¤çº¿ç¨çæä½é½éè¦è½¬å¥åæ ¸æä¸­å®æï¼ è¿äºæä½ç»javaèææºçå¹¶åæ§è½å¸¦æ¥äºå¾å¤§çååã åæ¶ï¼ æä»¬æ³¨æå°å¨è®¸å¤åºç¨ä¸ï¼ å±äº«æ°æ®çéå®ç¶æåªä¼æç»­å¾ç­çä¸æ®µæ¶é´ï¼ ä¸ºäºè¿æ®µæ¶é´å»æèµ·åæ¢å¤çº¿ç¨å¹¶ä¸å¼å¾ãå¦æç©çæºå¨æä¸ä¸ªä»¥ä¸çå¤çå¨æèå¤çå¨æ ¸å¿ï¼ è½è®©ä¸¤ä¸ªæä»¥ä¸ççº¿ç¨åæ¶å¹¶è¡æ§è¡ï¼ æä»¬ å°±å¯ä»¥è®©åé¢è¯·æ±éçé£ä¸ªçº¿ç¨âç¨ç­ä¸ä¼âï¼ ä½ä¸æ¾å¼å¤çå¨çæ§è¡æ¶é´ï¼ ççææéççº¿ç¨æ¯å¦å¾å¿«å°±ä¼éæ¾éã ä¸ºäºè®©çº¿ç¨ç­å¾ï¼ æä»¬åªé¡»è®©çº¿ç¨æ§è¡ä¸ä¸ªå¿å¾ªç¯ï¼èªæï¼ ï¼ è¿é¡¹ææ¯å°±æ¯æè°çèªæéã\n\nèªæéå¨1.4.2ä¸­å°±å¼è¿äºï¼ä¸è¿é»è®¤æ¯å³é­çãjdk 6å¼å§æ¹ä¸ºé»è®¤å¼å¯ãé»è®¤èªæ10æ¬¡ã\n\njdk 6 å¯¹èªæéçä¼åï¼å¼å¥äºèªéåºçèªæãèªéåºèªææå³çèªææ¬¡æ°ä¸åæ¯åºå®çäºï¼ç±åä¸æ¬¡å¨åä¸ä¸ªéä¸çèªææ¶é´ä»¥åéçæ¥æèçç¶æå³å®ãå¦æåä¸ä¸ªéå¯¹è±¡ä¸ï¼èªæç­å¾ååæåè·å¾è¿éï¼å¹¶ä¸ææéççº¿ç¨æ­£å¨è¿è¡ä¸­ï¼é£ä¹èææºå°±ä¼è®¤ä¸ºè¿æ¬¡èªæä¹å¾æå¯è½åæ¬¡æåï¼è¿èåè®¸èªæç­å¾æç»­æ´é¿çæ¶é´ãå¦æéåæä¸ªéï¼èªæå¾å°æåè·å¾è¿éï¼é£ä»¥åè¦è·åè¿ä¸ªéå°å¯è½ç´æ¥çç¥èªæè¿ç¨ã\n\n\n# éæ¶é¤\n\néæ¶é¤æ¯æèææºå³æ¶ç¼è¯å¨å¨è¿è¡æ¶ï¼å¯¹ä¸äºä»£ç è¦æ±åæ­¥ï¼ä½æ¯å¯¹è¢«æ£æµå°ä¸å¯è½å­å¨å±äº«æ°æ®ç«äºçéè¿è¡æ¶é¤ã\n\néæ¶é¤çä¸»è¦å¤æ­ä¾æ®æ¥æºäºéé¸åæçæ°æ®æ¯æã\n\nå¦æå¤æ­å°ä¸æ®µä»£ç ï¼å¨å ä¸çæææ°æ®é½ä¸ä¼éé¸åºå»è¢«å¶ä»çº¿ç¨è®¿é®å°ï¼é£å°±å¯ä»¥æä»ä»¬å½åæ ä¸æ°æ®å¯¹å¾ï¼è®¤ä¸ºä»ä»¬æ¯çº¿ç¨ç§æçï¼åæ­¥å éèªç¶å°±ä¸ç¨åè¿è¡äºã\n\n\n# éç²å\n\nå¦æèææºæ£æµå°æä¸ä¸²é¶ç¢çæä½é½å¯¹åä¸ä¸ªå¯¹è±¡å éï¼å°±ä¼æå éåæ­¥çèå´ç²åå°æ´ä¸ªæä½åºåçå¤é¨ã\n\n\n# è½»éçº§é\n\nè½»éçº§éå¹¶ä¸æ¯æ¥æ¿ä»£ééçº§éçï¼å®çè®¾è®¡åè¡·æ¯å¨æ²¡æå¤çº¿ç¨ç«äºçåæä¸ï¼åå°ä¼ ç»çééçº§éä½¿ç¨æä½ç³»ç»äºæ¥éçæ§è½æ¶èã\n\n\n\nå¨ä»£ç å³å°è¿å¥åæ­¥åæ¶ï¼å¦ææ­¤åæ­¥å¯¹è±¡æ²¡æè¢«éå®ï¼éæ å¿ä½ä¸ºâ01âç¶æï¼ï¼èææºé¦åå°å¨å½åçº¿ç¨çæ å¸§ä¸­ç®åä¸ä¸ªåä¸ºéè®°å½ï¼lock recordï¼çç©ºé´ï¼ç¨äºå­å¨éå¯¹è±¡ç®åçmark wordçæ·è´ã\n\nç¶åèææºå°ä½¿ç¨ casæä½å°è¯æå¯¹è±¡çmark wordæ´æ°ä¸ºæålock record çæéã\n\nå¦ææ´æ°å¨ä½æåäºï¼ä»£è¡¨è¯¥çº¿ç¨æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼å¹¶ä¸å¯¹è±¡mark wordçéæ å¿ä½ï¼mark wordçæåä¸¤ä¸ªæ¯ç¹ï¼å°åä¸ºâ00âï¼è¡¨ç¤ºæ­¤å¯¹è±¡æ­£å¤äºè½»éçº§éå®ç¶æã\n\nå¦ææ´æ°æä½å¤±è´¥äºï¼æå³çæçº¿ç¨ä¸å½åçº¿ç¨ç«äºè¯¥å¯¹è±¡çéãèææºé¦åä¼æ£æ¥å¯¹è±¡çmark wordæ¯å¦æåå½åçº¿ç¨çæ å¸§ï¼å¦ææ¯ï¼è¯´æå½åçº¿ç¨å·²ç»æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼ç´æ¥è¿å¥åæ­¥åãå¦åè¯´æè¿ä¸ªéå¯¹è±¡ç»å¶ä»çº¿ç¨æ¢å äºï¼æ­¤æ¶è½»éçº§éåçº§ä¸ºééçº§éï¼éæ å¿ä½ç¶æåä¸ºâ10âã\n\nè½»éçº§éè½æåç¨åºåæ­¥æ§è½çä¾æ®æ¯âå¯¹äºç»å¤§é¨åçéï¼å¨æ´ä¸ªåæ­¥å¨æåé½æ¯ä¸å­å¨ç«äºçâãå¦ææ²¡æç«äºï¼è½»éçº§éä¾¿éè¿casæä½æåé¿åäºä½¿ç¨äºæ¥éçå¼éãä½å¦æç¡®å®å­å¨éç«äºï¼é¤äºäºæ¥éæ¬èº«çå¼éå¤ï¼è¿é¢å¤åçäºcasçå¼éãå æ­¤å¨æç«äºçæåµä¸ï¼è½»éçº§éåèä¼æ¯ä¼ ç»çééçº§éæ´æ¢ã\n\n\n# ååé\n\nååéçç®çæ¯æ¶é¤æ°æ®å¨æ ç«äºæåµä¸çåæ­¥åè¯­ãå¦æè¯´è½»éçº§éæ¯å¨æ ç«äºçæåµä¸ä½¿ç¨casæä½å»æ¶é¤åæ­¥ä½¿ç¨çäºæ¥éï¼é£ååéå°±æ¯å¨æ ç«äºæåµä¸ææ´ä¸ªåæ­¥é½æ¶é¤æï¼è¿casæä½é½ä¸åã\n\nè¿ä¸ªéä¼ååäºç¬¬ä¸ä¸ªè·å¾å®ççº¿ç¨ï¼å¦æå¨æ¥ä¸æ¥çæ§è¡è¿ç¨ä¸­ï¼è¯¥éä¸ç´æ²¡æè¢«å¶ä»ççº¿ç¨è·åï¼åææååéççº¿ç¨å°æ°¸è¿ä¸éè¦åè¿è¡åæ­¥ã\n\nååéé»è®¤æ¯å¼å¯çãå½éå¯¹è±¡ç¬¬ä¸æ¬¡è¢«çº¿ç¨è·åæ¶ï¼èææºä¼æå¯¹è±¡å¤´ä¸­çæ å¿ä½è®¾ç½®ä¸ºâ01âãæååæ¨¡å¼è®¾ç½®ä¸º1ï¼è¡¨ç¤ºè¿å¥ååæ¨¡å¼ãåæ¶ä½¿ç¨casæä½æè·åå°è¿ä¸ªéççº¿ç¨idè®°å½å¨å¯¹è±¡çmark wordä¸­ãæcasæä½æåï¼ ææååéççº¿ç¨ä»¥åæ¯æ¬¡è¿å¥è¿ä¸ªéç¸å³çåæ­¥åæ¶ï¼ èææºé½å¯ä»¥ä¸åè¿è¡ä»»ä½åæ­¥æä½ï¼ä¾å¦å éã è§£éåå¯¹mark wordçæ´æ°æä½ç­ï¼ã\n\nä¸æ¦åºç°å¦å¤ä¸ä¸ªçº¿ç¨å»å°è¯è·åè¿ä¸ªéçæåµï¼ ååæ¨¡å¼å°±é©¬ä¸å®£åç»æã æ ¹æ®éå¯¹è±¡ç®åæ¯å¦å¤äºè¢«éå®çç¶æå³å®æ¯å¦æ¤éååï¼ååæ¨¡å¼è®¾ç½®ä¸ºâ0âï¼ ï¼ æ¤éåæ å¿ä½æ¢å¤å°æªéå®ï¼æ å¿ä½ä¸ºâ01âï¼ æè½»éçº§éå®ï¼æ å¿ä½ä¸ºâ00âï¼ çç¶æï¼ åç»­çåæ­¥æä½å°±æç§ä¸é¢ä»ç»çè½»éçº§éé£æ ·å»æ§è¡ã\n\n\n\nå¦æç¨åºä¸­å¤§å¤æ°çéé½æ»æ¯è¢«å¤ä¸ªä¸åççº¿ç¨è®¿é®ï¼é£ä¹ååæ¨¡å¼å°±æ¯å¤ä½çãææ¶ä½¿ç¨åæ° -xx:-usebisedlocking=falseæ¥ç¦æ­¢ååéä¼ååèå¯ä»¥æåæ§è½ã\n\nï¼jdk 15 åºå¼ååéï¼',charsets:{cjk:!0}},{title:"synchronizedåvolatile",frontmatter:{title:"synchronizedåvolatile",date:"2023-03-28T18:31:38.000Z",permalink:"/pages/concurrent/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/01.synchronized%E5%92%8Cvolatile.html",relativePath:"01.Java/04.Javaå¹¶å/01.synchronizedåvolatile.md",key:"v-99d6e044",path:"/pages/concurrent/",headers:[{level:2,title:"synchronizedççè§£",slug:"synchronizedççè§£",normalizedTitle:"synchronizedççè§£",charIndex:2},{level:2,title:"synchronizedçä½¿ç¨",slug:"synchronizedçä½¿ç¨",normalizedTitle:"synchronizedçä½¿ç¨",charIndex:435},{level:3,title:"åéæ ¡éªéå®ç°åä¾æ¨¡å¼",slug:"åéæ ¡éªéå®ç°åä¾æ¨¡å¼",normalizedTitle:"åéæ ¡éªéå®ç°åä¾æ¨¡å¼",charIndex:1191},{level:2,title:"synchronized å³é®å­åºå±åç",slug:"synchronized-å³é®å­åºå±åç",normalizedTitle:"synchronized å³é®å­åºå±åç",charIndex:1925},{level:3,title:"synchronized åæ­¥è¯­å¥åçåºå±å®ç°",slug:"synchronized-åæ­¥è¯­å¥åçåºå±å®ç°",normalizedTitle:"synchronized åæ­¥è¯­å¥åçåºå±å®ç°",charIndex:2022},{level:3,title:"synchronized ä¿®é¥°æ¹æ³çåºå±å®ç°",slug:"synchronized-ä¿®é¥°æ¹æ³çåºå±å®ç°",normalizedTitle:"synchronized ä¿®é¥°æ¹æ³çåºå±å®ç°",charIndex:2409},{level:2,title:"synchronized éåçº§",slug:"synchronized-éåçº§",normalizedTitle:"synchronized éåçº§",charIndex:3043},{level:2,title:"volatile",slug:"volatile",normalizedTitle:"volatile",charIndex:1272},{level:3,title:"å¦ä½å®ç°å¯è§æ§",slug:"å¦ä½å®ç°å¯è§æ§",normalizedTitle:"å¦ä½å®ç°å¯è§æ§",charIndex:4349},{level:3,title:"ä¸ºä»ä¹ä¸è½å®ç°åå­æ§",slug:"ä¸ºä»ä¹ä¸è½å®ç°åå­æ§",normalizedTitle:"ä¸ºä»ä¹ä¸è½å®ç°åå­æ§",charIndex:4842},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:5314}],headersStr:"synchronizedççè§£ synchronizedçä½¿ç¨ åéæ ¡éªéå®ç°åä¾æ¨¡å¼ synchronized å³é®å­åºå±åç synchronized åæ­¥è¯­å¥åçåºå±å®ç° synchronized ä¿®é¥°æ¹æ³çåºå±å®ç° synchronized éåçº§ volatile å¦ä½å®ç°å¯è§æ§ ä¸ºä»ä¹ä¸è½å®ç°åå­æ§ åè",content:"# synchronizedççè§£\n\nsynchronizedå³é®å­è§£å³çæ¯å¤ä¸ªçº¿ç¨ä¹é´è®¿é®èµæºçåæ­¥æ§ï¼synchronized å³é®å­å¯ä»¥ä¿è¯è¢«å®ä¿®é¥°çæ¹æ³æèä»£ç åå¨ä»»ææ¶å»åªè½æä¸ä¸ªçº¿ç¨æ§è¡ã\n\nå¨ Java æ©æçæ¬ä¸­ï¼synchronized å±äºééçº§éï¼æçä½ä¸ï¼å ä¸ºçè§å¨éï¼monitorï¼æ¯ä¾èµäºåºå±çæä½ç³»ç»ç Mutex Lock æ¥å®ç°çï¼Java ççº¿ç¨æ¯æ å°å°æä½ç³»ç»çåççº¿ç¨ä¹ä¸çãå¦æè¦æèµ·æèå¤éä¸ä¸ªçº¿ç¨ï¼é½éè¦æä½ç³»ç»å¸®å¿å®æï¼èæä½ç³»ç»å®ç°çº¿ç¨ä¹é´çåæ¢æ¶éè¦ä»ç¨æ·æè½¬æ¢å°åæ ¸æï¼è¿ä¸ªç¶æä¹é´çè½¬æ¢éè¦ç¸å¯¹æ¯è¾é¿çæ¶é´ï¼æ¶é´ææ¬ç¸å¯¹è¾é«ã\n\nå¨ JDK6 ä¹å Java å®æ¹å¯¹ä» JVM å±é¢å¯¹synchronized è¾å¤§ä¼åï¼æä»¥ç°å¨ç synchronized éæçä¹ä¼åå¾å¾ä¸éäºãJDK6 å¯¹éçå®ç°å¼å¥äºå¤§éçä¼åï¼å¦èªæéãéåºæ§èªæéãéæ¶é¤ãéç²åãååéãè½»éçº§éç­ææ¯æ¥åå°éæä½çå¼éã\n\n\n# synchronizedçä½¿ç¨\n\næ ¹æ®ä¿®é¥°å¯¹è±¡çåç±»ï¼\n\n * ä¿®é¥°ä»£ç å\n   * synchronized(this|object)\n   * synchronized(ç±».class)\n * ä¿®é¥°æ¹æ³\n   * ä¿®é¥°ééææ¹æ³\n   * ä¿®é¥°éææ¹æ³\n\næ ¹æ®è·åçéæ¥åç±»ï¼\n\n * è·åå¯¹è±¡é\n   * synchronized(this|object)\n   * ä¿®æ¹ééææ¹æ³\n * è·åç±»é\n   * synchronized(ç±».class)\n   * ä¿®é¥°éææ¹æ³\n\n1ã ä¿®é¥°å®ä¾æ¹æ³ï¼ä½ç¨äºå½åå¯¹è±¡å®ä¾å éï¼è¿å¥åæ­¥ä»£ç åè¦è·å¾å½åå¯¹è±¡å®ä¾çéï¼\n\n2ãä¿®é¥°éææ¹æ³ï¼ä½ç¨äºå½åç±»å¯¹è±¡å éï¼è¿å¥åæ­¥ä»£ç åè¦è·å¾å½åç±»å¯¹è±¡çé ãä¹å°±æ¯ç»å½åç±»å éï¼ä¼ä½ç¨äºç±»çææå¯¹è±¡å®ä¾ï¼å ä¸ºéææåä¸å±äºä»»ä½ä¸ä¸ªå®ä¾å¯¹è±¡ï¼æ¯ç±»æåãæä»¥å¦æä¸ä¸ªçº¿ç¨ A è°ç¨ä¸ä¸ªå®ä¾å¯¹è±¡çééæ synchronized æ¹æ³ï¼èçº¿ç¨ B éè¦è°ç¨è¿ä¸ªå®ä¾å¯¹è±¡æå±ç±»çéæ synchronized æ¹æ³ï¼æ¯åè®¸çï¼ä¸ä¼åçäºæ¥ç°è±¡ï¼å ä¸ºè®¿é®éæ synchronized æ¹æ³å ç¨çéæ¯å½åç±»çéï¼èè®¿é®ééæ synchronized æ¹æ³å ç¨çéæ¯å½åå®ä¾å¯¹è±¡éï¼\n\n3ã ä¿®é¥°ä»£ç åï¼æå®å éå¯¹è±¡ï¼å¯¹ç»å®å¯¹è±¡å éï¼è¿å¥åæ­¥ä»£ç åºåè¦è·å¾ç»å®å¯¹è±¡çéãå synchronized æ¹æ³ä¸æ ·ï¼synchronized(this) ä»£ç åä¹æ¯éå®å½åå¯¹è±¡çãsynchronized å³é®å­å å° static éææ¹æ³å synchronized(class) ä»£ç åä¸é½æ¯æ¯ç» Class ç±»ä¸éãå°½éä¸è¦ä½¿ç¨ synchronized(String a) å ä¸º JVM ä¸­ï¼å­ç¬¦ä¸²å¸¸éæ± å·æç¼å²åè½ã\n\n\n# åéæ ¡éªéå®ç°åä¾æ¨¡å¼\n\nä½¿ç¨ synchronized åéæ ¡éªéçæ¹æ³å®ç°åä¾æ¨¡å¼ï¼\n\npublic class Singleton {\n  private volatile static Singleton instance;\n  private Singleton(){}\n  public static Singleton getInstance() {\n    if (instance == null) {\n      synchronized(Singleton.class) {\n        if (instance == null) instance = new Singleton();\n      }\n    }\n    return instance;\n  }\n}\n\n\nå¦å¤ï¼éè¦æ³¨æ instance éç¨ volatile å³é®å­ä¿®é¥°ä¹æ¯å¾æå¿è¦ã å ä¸º instance = new Singleton(); è¿æ®µä»£ç å¶å®æ¯åä¸ºä¸æ­¥æ§è¡ï¼\n\n 1. ä¸º instance åéåå­ç©ºé´\n 2. åå§å instance\n 3. å° instance æååéçåå­å°å\n\nä½æ¯ç±äº JVM å·ææä»¤éæçç¹æ§ï¼æ§è¡é¡ºåºæå¯è½åæ 1 -> 3 -> 2ãæä»¤éæå¨åçº¿ç¨ç¯å¢ä¸ä¸ä¼åºç°é®é¢ï¼ä½æ¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¼å¯¼è´ä¸ä¸ªçº¿ç¨è·å¾è¿æ²¡æåå§åçå®ä¾ãä¾å¦ï¼çº¿ç¨ T1 æ§è¡äº 1 å 3ï¼æ­¤æ¶ T2 è°ç¨ getInstance() ååç° instance ä¸ä¸ºç©ºï¼å æ­¤è¿å instanceï¼ä½æ­¤æ¶ instance è¿æªè¢«åå§åã\n\nä½¿ç¨ volatile å¯ä»¥ç¦æ­¢ JVM çæä»¤éæï¼ä¿è¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¹è½æ­£å¸¸è¿è¡ã\n\n\n# synchronized å³é®å­åºå±åç\n\nsynchronized å³é®å­åºå±åçå±äº JVM å±é¢ã\n\nsynchronized ä½¿ç¨çéå¯¹è±¡æ¯å­å¨å¨Javaå¯¹è±¡å¤´éçæ è®°å­æ®µéã\n\n\n# synchronized åæ­¥è¯­å¥åçåºå±å®ç°\n\nsynchronized åæ­¥è¯­å¥åçå®ç°ä½¿ç¨çæ¯ monitorenter å monitorexit æä»¤ï¼å¶ä¸­ monitorenter æä»¤æååæ­¥ä»£ç åçå¼å§ä½ç½®ï¼monitorexit æä»¤åææåæ­¥ä»£ç åçç»æä½ç½®ã\n\nå½æ§è¡ monitorenter æä»¤æ¶ï¼çº¿ç¨è¯å¾è·åéä¹å°±æ¯è·å monitorçæææãmonitor å¯¹è±¡å­å¨äºæ¯ä¸ª Java å¯¹è±¡çå¯¹è±¡å¤´ä¸­ï¼synchronized éä¾¿æ¯éè¿è¿ç§æ¹å¼è·åéçï¼ä¹æ¯ä¸ºä»ä¹ Java ä¸­ä»»æå¯¹è±¡å¯ä»¥ä½ä¸ºéçåå ãå½è®¡æ°å¨ä¸º 0 åå¯ä»¥æåè·åï¼è·ååå°éè®¡æ°å¨è®¾ä¸º 1 ä¹å°±æ¯å  1ãç¸åºçå¨æ§è¡ monitorexit æä»¤åï¼å°éè®¡æ°å¨è®¾ä¸º 0ï¼è¡¨æéè¢«éæ¾ãå¦æè·åå¯¹è±¡éå¤±è´¥ï¼é£å½åçº¿ç¨å°±è¦é»å¡ç­å¾ï¼ç´å°éè¢«å¦å¤ä¸ä¸ªçº¿ç¨éæ¾ä¸ºæ­¢ã\n\n\n# synchronized ä¿®é¥°æ¹æ³çåºå±å®ç°\n\nsynchronized ä¿®é¥°çæ¹æ³å¹¶æ²¡æ monitorenter æä»¤å monitorexit æä»¤ï¼åå¾ä»£ä¹çç¡®å®æ¯ ACC_SYNCHRONIZED æ è¯ï¼è¯¥æ è¯ææäºè¯¥æ¹æ³æ¯ä¸ä¸ªåæ­¥æ¹æ³ï¼JVM éè¿è¯¥ ACC_SYNCHRONIZED è®¿é®æ å¿æ¥è¾¨å«ä¸ä¸ªæ¹æ³æ¯å¦å£°æä¸ºåæ­¥æ¹æ³ï¼ä»èæ§è¡ç¸åºçåæ­¥è°ç¨ã\n\n * ACC_SYNCHRONIZEDæ å¿è¡¨ç¤ºæ¹æ³ä¸ºåæ­¥æ¹æ³\n * æ  ACC_STATICæ å¿ ä¸ºæ®éåæ­¥æ¹æ³\n * æ ACC_STATICæ å¿ ä¸ºéæåæ­¥æ¹æ³\n\nå¨javaä¸­ï¼synchronizedå¨ç¼è¯åï¼ä¼å¨åæ­¥åçåååå«å½¢æä¸ä¸ªmonitorenteråmonitorexitè¿ä¸¤ä¸ªå­èç æä»¤ï¼è¿ä¸¤ä¸ªå­èç é½éè¦ä¸ä¸ªreferenceç±»åçåæ°æ¥ææè¦éå®åè§£éçå¯¹è±¡ï¼å¦æjavaç¨åºä¸­æç¡®æå®äºå¯¹è±¡ï¼é£å°±æ¯è¿ä¸ªå¯¹è±¡çreferenceï¼å¦ææ²¡æææï¼é£ä¹æ ¹æ®synchronizedä¿®é¥°çæ¯å®ä¾æ¹æ³è¿æ¯ç±»æ¹æ³ï¼å»åå¯¹åºçå¯¹è±¡å®ä¾æèç±»Classå¯¹è±¡æ¥åéå¯¹è±¡ã\n\nå¨æ§è¡monitorenteræ¶ï¼é¦åä¼å°è¯è·åå¯¹è±¡çéï¼å¦æè¿ä¸ªå¯¹è±¡æ²¡æéï¼æèå½åçº¿ç¨å·²ç»æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼é£ä¸ªéçè®¡æ°å¨å 1ï¼ç¸åºçï¼å¨æ§è¡monitorexitæ¶æä»¤æ¶ï¼ä¼å°éè®¡æ°å¨å1ï¼å½è®¡æ°å¨ä¸º0æ¶ï¼è¿ä¸ªéå°±è¢«éæ¾ãå¦æè·åå¯¹è±¡éå¤±è´¥ï¼é£å½åçº¿ç¨å°±è¦é»å¡ç­å¾ï¼ç´å°å¯¹è±¡éè¢«å¦ä¸ä¸ªçº¿ç¨éæ¾ä¸ºæ­¢ã\n\n\n# synchronized éåçº§\n\néåçº§çè¿ç¨ï¼\n\n 1. ä¸å¼å§æ¯å¤äºæ éç¶æç\n\n 2. å½æä¸ä¸ªçº¿ç¨è®¿é®åæ­¥ä»£ç åæ¶ï¼åçº§æååéï¼Mark Word éå­å¨éååççº¿ç¨ ID ï¼å¨çº¿ç¨è¿å¥åéåºåæ­¥åæ¶ä¸åéè¿ CAS æä½æ¥å éåè§£éï¼èæ¯æ£æµ Mark Word éæ¯å¦å­å¨çæåå½åçº¿ç¨çååéï¼\n\n 3. æéç«äºæ¶ï¼åçº§ä¸ºè½»éçº§éï¼èªæè·åé\n\n 4. èªæåæ¬¡å¤±è´¥åï¼åçº§æééçº§éï¼çº¿ç¨é»å¡ï¼\n\néçå¯¹æ¯ï¼\n\né      ä¼ç¹                                 ç¼ºç¹                         éç¨åºæ¯\nååé    å éåè§£éä¸éè¦é¢å¤çæ¶èï¼åæ§è¡éåæ­¥æ¹æ³ç¸æ¯ä»æçº³ç§çº§çå·®è·   å¦æçº¿ç¨é´å­å¨éç«äºï¼ä¼å¸¦æ¥é¢å¤çéæ¤éçæ¶è    éç¨äºåªæä¸ä¸ªçº¿ç¨è®¿é®åæ­¥åçåºæ¯\nè½»éçº§é   ç«äºççº¿ç¨ä¸ä¼é»å¡ï¼æé«äºç¨åºçååºéåº¦               å¦æç«äºççº¿ç¨å§ç»å¾ä¸å°éï¼æ¯ç¨èªæä¼æ¶èCPU   è¿½æ±ååºéåº¦ï¼çä¸å­æ§è¡éåº¦éå¸¸å¿«\nééçº§é   çº¿ç¨ç«äºä¸ä½¿ç¨èªæï¼ä¸ä¼æ¶èCPU                  çº¿ç¨é»å¡ï¼ååºæ¶é´ç¼æ¢                è¿½æ±ååéï¼åæ­¥å¿«æ§è¡éåº¦è¾æ¢\n\nhttps://zhuanlan.zhihu.com/p/482639650\n\n\n# volatile\n\nvolatileæ¯Javaèææºç³»ç»çè½»éçº§åæ­¥æºå¶ã\n\nå¶ç¹ç¹æï¼\n\n * ä¿è¯å¯è§æ§\n * ä¸ä¿è¯åå­æ§\n * ç¦æ­¢æä»¤éæåºã\n   * é¿åäºå¤çº¿ç¨ç¯å¢ä¸ç¨åºåºç°ä¹±åºæ§è¡çç°è±¡ã\n   * æä»¤éæåªä¼ä¿è¯ä¸²è¡è¯­ä¹çæ§è¡çä¸è´æ§ï¼åçº¿ç¨ï¼ï¼ä½å¹¶ä¸å³å¿å¤çº¿ç¨é´çè¯­ä¹ä¸è´æ§ã\n   * å¯¹ volatile åéçè¯»ååæä½ä¼å¨æä»¤åºåä¸­æå¥åå­å±éï¼ä¿è¯äºvolatileåéçè¯»åæä½ä¸ä¼è¢«æä»¤éæåºæå½±åã\n\nåå­å±éï¼Memory Barrierï¼æ¯ä¸ä¸ª CPU æä»¤ï¼ä½ç¨æä¸¤ä¸ªï¼\n\n 1. ä¿è¯ç¹å®æä½çæ§è¡é¡ºåº\n 2. ä¿è¯æäºåéçåå­å¯è§æ§ï¼å©ç¨è¯¥ç¹æ§å®ç° volatile çå¯è§æ§ï¼\n\nåºç¨åºæ¯ï¼\n\nåä¾æ¨¡å¼ä¸DCLä¸ä¸å®çº¿ç¨å®å¨ï¼ç±äºæä»¤éæï¼æä»¥ç¨åºæå°æ¦çä¼åºç° instance != nullï¼ä½ instance çå¼ç¨å¯¹è±¡å¯è½è¿æ²¡å®æåå§åãæä»¥å½ä¸ä¸ªçº¿ç¨è®¿é® instance != nullæ¶ï¼instanceæªå¿å·²ç»åå§åå®æï¼é æäºçº¿ç¨å®å¨é®é¢ã\n\nå ä¸º instance = new Singleton();å¯ä»¥ä¸ºè¢«åä¸ºä¸æ­¥ï¼\n\nmemory = allocate();// 1. åéå¯¹è±¡åå­ç©ºé´\ninstance(memory); // 2.åå§åå¯¹è±¡\ninstance = memory; // 3. è®¾ç½® instance æ§è¡ååéçåå­å°åï¼æ­¤æ¶ instance != null\n\n\nè§£å³æ¹æ¡å¯ä»¥å¨å®ä¾ä¸å ä¸ volatileï¼private static volatile Singleton instance = null;\n\n\n# å¦ä½å®ç°å¯è§æ§\n\nvolatile å³é®å­å¯ä»¥ä¿è¯å¯è§æ§çåå æ¯ï¼å®ä¼åè¯ Java ç¼è¯å¨åè¿è¡æ¶ç³»ç»ï¼æ¯æ¬¡è¯»åè¯¥åéæ¶é½å¿é¡»ä»ä¸»åå­ä¸­éæ°è·åææ°çå¼ï¼èä¸æ¯ä½¿ç¨æ¬å°ç¼å­çå¯æ¬ã\n\nå·ä½æ¥è¯´ï¼å½ä¸ä¸ªçº¿ç¨ä¿®æ¹ä¸ä¸ª volatile åéçå¼æ¶ï¼è¿ä¸ªå¼ä¼ç«å³è¢«ååå°ä¸»åå­ä¸­ï¼èä¸æ¯è¢«ç¼å­å¨è¯¥çº¿ç¨çæ¬å°ç¼å­ä¸­ãåæ¶ï¼å½å¶ä»çº¿ç¨éè¦è¯»åè¿ä¸ªåéçå¼æ¶ï¼å®ä»¬ä¹ä¼ä»ä¸»åå­ä¸­è·åææ°çå¼ï¼èä¸æ¯ä»æ¬å°ç¼å­ä¸­è·åæ§å¼ã\n\nè¿ç§å¼ºå¶å·æ°åå­çè¡ä¸ºç¡®ä¿äºåéçå¯è§æ§ï¼å³ä½¿æå¤ä¸ªçº¿ç¨åæ¶å¯¹åéè¿è¡è¯»ååä¿®æ¹ï¼ä¹è½å¤çå°ææ°çå¼ã\n\nvolatile åéçåå­å¯è§æ§æ¯åºäºåå­å±é(Memory Barrier)å®ç°:\n\n * åå­å±éï¼åç§°åå­æ æ ï¼æ¯ä¸ä¸ª CPU æä»¤ã\n * å¨ç¨åºè¿è¡æ¶ï¼ä¸ºäºæé«æ§è¡æ§è½ï¼ç¼è¯å¨åå¤çå¨ä¼å¯¹æä»¤è¿è¡éæåºï¼JMM ä¸ºäºä¿è¯å¨ä¸åçç¼è¯å¨å CPU ä¸æç¸åçç»æï¼éè¿æå¥ç¹å®ç±»åçåå­å±éæ¥ç¦æ­¢+ ç¹å®ç±»åçç¼è¯å¨éæåºåå¤çå¨éæåºï¼æå¥ä¸æ¡åå­å±éä¼åè¯ç¼è¯å¨å CPUï¼ä¸ç®¡ä»ä¹æä»¤é½ä¸è½åè¿æ¡ Memory Barrier æä»¤éæåºã\n\n\n# ä¸ºä»ä¹ä¸è½å®ç°åå­æ§\n\nï¼å ä¸ºåªä¿è¯å¯è§æ§çæåµä¸ï¼æ¯æ æ³å®ç°åå­æ§çãããæä»¥ä¸è½å®ç°åå­æ§ï¼\n\nvolatile å³é®å­ä¸è½ä¿è¯åå­æ§çåå æ¯ï¼å®åªæ¯ä¿è¯åéçè¯»åæä½å¯¹ææçº¿ç¨çå¯è§æ§ï¼ä½å¹¶ä¸è½ä¿è¯å¨å¤ä¸ªçº¿ç¨åæ¶è®¿é®åä¸ä¸ªåéæ¶ï¼æä½çé¡ºåºåæ­£ç¡®æ§ã\n\nä¾å¦ï¼å¨ä¸ä¸ªå¤çº¿ç¨ç¨åºä¸­ï¼å¦ææä¸¤ä¸ªçº¿ç¨åæ¶å¯¹ä¸ä¸ª volatile åéè¿è¡èªå¢æä½\n\nvolatile int count = 0;\n\npublic void increment() {\n    count++;\n}\n\n\né£ä¹å¯è½ä¼åçä»¥ä¸æåµï¼\n\n 1. çº¿ç¨ A ä»åå­ä¸­è¯»ååéå¼ä¸º 0ã\n 2. çº¿ç¨ B ä»åå­ä¸­è¯»ååéå¼ä¸º 0ã\n 3. çº¿ç¨ A å°åéå¼å  1 å¾å° 1ã\n 4. çº¿ç¨ B å°åéå¼å  1 å¾å° 1ã\n 5. çº¿ç¨ A å°åéå¼åååå­ã\n 6. çº¿ç¨ B å°åéå¼åååå­ã\n\nå¨è¿ä¸ªä¾å­ä¸­ï¼è½ç¶ volatile å³é®å­ä¿è¯äºçº¿ç¨ A åçº¿ç¨ B é½è½å¤çå°ææ°çåéå¼ï¼ä½å®æ æ³ä¿è¯æä½çåå­æ§ï¼å¯¼è´æç»çåéå¼ä¸º 1 èä¸æ¯ 2ã\n\n\n# åè\n\n * https://segmentfault.com/a/1190000041268785\n\n * https://zhuanlan.zhihu.com/p/482639650",normalizedContent:"# synchronizedççè§£\n\nsynchronizedå³é®å­è§£å³çæ¯å¤ä¸ªçº¿ç¨ä¹é´è®¿é®èµæºçåæ­¥æ§ï¼synchronized å³é®å­å¯ä»¥ä¿è¯è¢«å®ä¿®é¥°çæ¹æ³æèä»£ç åå¨ä»»ææ¶å»åªè½æä¸ä¸ªçº¿ç¨æ§è¡ã\n\nå¨ java æ©æçæ¬ä¸­ï¼synchronized å±äºééçº§éï¼æçä½ä¸ï¼å ä¸ºçè§å¨éï¼monitorï¼æ¯ä¾èµäºåºå±çæä½ç³»ç»ç mutex lock æ¥å®ç°çï¼java ççº¿ç¨æ¯æ å°å°æä½ç³»ç»çåççº¿ç¨ä¹ä¸çãå¦æè¦æèµ·æèå¤éä¸ä¸ªçº¿ç¨ï¼é½éè¦æä½ç³»ç»å¸®å¿å®æï¼èæä½ç³»ç»å®ç°çº¿ç¨ä¹é´çåæ¢æ¶éè¦ä»ç¨æ·æè½¬æ¢å°åæ ¸æï¼è¿ä¸ªç¶æä¹é´çè½¬æ¢éè¦ç¸å¯¹æ¯è¾é¿çæ¶é´ï¼æ¶é´ææ¬ç¸å¯¹è¾é«ã\n\nå¨ jdk6 ä¹å java å®æ¹å¯¹ä» jvm å±é¢å¯¹synchronized è¾å¤§ä¼åï¼æä»¥ç°å¨ç synchronized éæçä¹ä¼åå¾å¾ä¸éäºãjdk6 å¯¹éçå®ç°å¼å¥äºå¤§éçä¼åï¼å¦èªæéãéåºæ§èªæéãéæ¶é¤ãéç²åãååéãè½»éçº§éç­ææ¯æ¥åå°éæä½çå¼éã\n\n\n# synchronizedçä½¿ç¨\n\næ ¹æ®ä¿®é¥°å¯¹è±¡çåç±»ï¼\n\n * ä¿®é¥°ä»£ç å\n   * synchronized(this|object)\n   * synchronized(ç±».class)\n * ä¿®é¥°æ¹æ³\n   * ä¿®é¥°ééææ¹æ³\n   * ä¿®é¥°éææ¹æ³\n\næ ¹æ®è·åçéæ¥åç±»ï¼\n\n * è·åå¯¹è±¡é\n   * synchronized(this|object)\n   * ä¿®æ¹ééææ¹æ³\n * è·åç±»é\n   * synchronized(ç±».class)\n   * ä¿®é¥°éææ¹æ³\n\n1ã ä¿®é¥°å®ä¾æ¹æ³ï¼ä½ç¨äºå½åå¯¹è±¡å®ä¾å éï¼è¿å¥åæ­¥ä»£ç åè¦è·å¾å½åå¯¹è±¡å®ä¾çéï¼\n\n2ãä¿®é¥°éææ¹æ³ï¼ä½ç¨äºå½åç±»å¯¹è±¡å éï¼è¿å¥åæ­¥ä»£ç åè¦è·å¾å½åç±»å¯¹è±¡çé ãä¹å°±æ¯ç»å½åç±»å éï¼ä¼ä½ç¨äºç±»çææå¯¹è±¡å®ä¾ï¼å ä¸ºéææåä¸å±äºä»»ä½ä¸ä¸ªå®ä¾å¯¹è±¡ï¼æ¯ç±»æåãæä»¥å¦æä¸ä¸ªçº¿ç¨ a è°ç¨ä¸ä¸ªå®ä¾å¯¹è±¡çééæ synchronized æ¹æ³ï¼èçº¿ç¨ b éè¦è°ç¨è¿ä¸ªå®ä¾å¯¹è±¡æå±ç±»çéæ synchronized æ¹æ³ï¼æ¯åè®¸çï¼ä¸ä¼åçäºæ¥ç°è±¡ï¼å ä¸ºè®¿é®éæ synchronized æ¹æ³å ç¨çéæ¯å½åç±»çéï¼èè®¿é®ééæ synchronized æ¹æ³å ç¨çéæ¯å½åå®ä¾å¯¹è±¡éï¼\n\n3ã ä¿®é¥°ä»£ç åï¼æå®å éå¯¹è±¡ï¼å¯¹ç»å®å¯¹è±¡å éï¼è¿å¥åæ­¥ä»£ç åºåè¦è·å¾ç»å®å¯¹è±¡çéãå synchronized æ¹æ³ä¸æ ·ï¼synchronized(this) ä»£ç åä¹æ¯éå®å½åå¯¹è±¡çãsynchronized å³é®å­å å° static éææ¹æ³å synchronized(class) ä»£ç åä¸é½æ¯æ¯ç» class ç±»ä¸éãå°½éä¸è¦ä½¿ç¨ synchronized(string a) å ä¸º jvm ä¸­ï¼å­ç¬¦ä¸²å¸¸éæ± å·æç¼å²åè½ã\n\n\n# åéæ ¡éªéå®ç°åä¾æ¨¡å¼\n\nä½¿ç¨ synchronized åéæ ¡éªéçæ¹æ³å®ç°åä¾æ¨¡å¼ï¼\n\npublic class singleton {\n  private volatile static singleton instance;\n  private singleton(){}\n  public static singleton getinstance() {\n    if (instance == null) {\n      synchronized(singleton.class) {\n        if (instance == null) instance = new singleton();\n      }\n    }\n    return instance;\n  }\n}\n\n\nå¦å¤ï¼éè¦æ³¨æ instance éç¨ volatile å³é®å­ä¿®é¥°ä¹æ¯å¾æå¿è¦ã å ä¸º instance = new singleton(); è¿æ®µä»£ç å¶å®æ¯åä¸ºä¸æ­¥æ§è¡ï¼\n\n 1. ä¸º instance åéåå­ç©ºé´\n 2. åå§å instance\n 3. å° instance æååéçåå­å°å\n\nä½æ¯ç±äº jvm å·ææä»¤éæçç¹æ§ï¼æ§è¡é¡ºåºæå¯è½åæ 1 -> 3 -> 2ãæä»¤éæå¨åçº¿ç¨ç¯å¢ä¸ä¸ä¼åºç°é®é¢ï¼ä½æ¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¼å¯¼è´ä¸ä¸ªçº¿ç¨è·å¾è¿æ²¡æåå§åçå®ä¾ãä¾å¦ï¼çº¿ç¨ t1 æ§è¡äº 1 å 3ï¼æ­¤æ¶ t2 è°ç¨ getinstance() ååç° instance ä¸ä¸ºç©ºï¼å æ­¤è¿å instanceï¼ä½æ­¤æ¶ instance è¿æªè¢«åå§åã\n\nä½¿ç¨ volatile å¯ä»¥ç¦æ­¢ jvm çæä»¤éæï¼ä¿è¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¹è½æ­£å¸¸è¿è¡ã\n\n\n# synchronized å³é®å­åºå±åç\n\nsynchronized å³é®å­åºå±åçå±äº jvm å±é¢ã\n\nsynchronized ä½¿ç¨çéå¯¹è±¡æ¯å­å¨å¨javaå¯¹è±¡å¤´éçæ è®°å­æ®µéã\n\n\n# synchronized åæ­¥è¯­å¥åçåºå±å®ç°\n\nsynchronized åæ­¥è¯­å¥åçå®ç°ä½¿ç¨çæ¯ monitorenter å monitorexit æä»¤ï¼å¶ä¸­ monitorenter æä»¤æååæ­¥ä»£ç åçå¼å§ä½ç½®ï¼monitorexit æä»¤åææåæ­¥ä»£ç åçç»æä½ç½®ã\n\nå½æ§è¡ monitorenter æä»¤æ¶ï¼çº¿ç¨è¯å¾è·åéä¹å°±æ¯è·å monitorçæææãmonitor å¯¹è±¡å­å¨äºæ¯ä¸ª java å¯¹è±¡çå¯¹è±¡å¤´ä¸­ï¼synchronized éä¾¿æ¯éè¿è¿ç§æ¹å¼è·åéçï¼ä¹æ¯ä¸ºä»ä¹ java ä¸­ä»»æå¯¹è±¡å¯ä»¥ä½ä¸ºéçåå ãå½è®¡æ°å¨ä¸º 0 åå¯ä»¥æåè·åï¼è·ååå°éè®¡æ°å¨è®¾ä¸º 1 ä¹å°±æ¯å  1ãç¸åºçå¨æ§è¡ monitorexit æä»¤åï¼å°éè®¡æ°å¨è®¾ä¸º 0ï¼è¡¨æéè¢«éæ¾ãå¦æè·åå¯¹è±¡éå¤±è´¥ï¼é£å½åçº¿ç¨å°±è¦é»å¡ç­å¾ï¼ç´å°éè¢«å¦å¤ä¸ä¸ªçº¿ç¨éæ¾ä¸ºæ­¢ã\n\n\n# synchronized ä¿®é¥°æ¹æ³çåºå±å®ç°\n\nsynchronized ä¿®é¥°çæ¹æ³å¹¶æ²¡æ monitorenter æä»¤å monitorexit æä»¤ï¼åå¾ä»£ä¹çç¡®å®æ¯ acc_synchronized æ è¯ï¼è¯¥æ è¯ææäºè¯¥æ¹æ³æ¯ä¸ä¸ªåæ­¥æ¹æ³ï¼jvm éè¿è¯¥ acc_synchronized è®¿é®æ å¿æ¥è¾¨å«ä¸ä¸ªæ¹æ³æ¯å¦å£°æä¸ºåæ­¥æ¹æ³ï¼ä»èæ§è¡ç¸åºçåæ­¥è°ç¨ã\n\n * acc_synchronizedæ å¿è¡¨ç¤ºæ¹æ³ä¸ºåæ­¥æ¹æ³\n * æ  acc_staticæ å¿ ä¸ºæ®éåæ­¥æ¹æ³\n * æ acc_staticæ å¿ ä¸ºéæåæ­¥æ¹æ³\n\nå¨javaä¸­ï¼synchronizedå¨ç¼è¯åï¼ä¼å¨åæ­¥åçåååå«å½¢æä¸ä¸ªmonitorenteråmonitorexitè¿ä¸¤ä¸ªå­èç æä»¤ï¼è¿ä¸¤ä¸ªå­èç é½éè¦ä¸ä¸ªreferenceç±»åçåæ°æ¥ææè¦éå®åè§£éçå¯¹è±¡ï¼å¦æjavaç¨åºä¸­æç¡®æå®äºå¯¹è±¡ï¼é£å°±æ¯è¿ä¸ªå¯¹è±¡çreferenceï¼å¦ææ²¡æææï¼é£ä¹æ ¹æ®synchronizedä¿®é¥°çæ¯å®ä¾æ¹æ³è¿æ¯ç±»æ¹æ³ï¼å»åå¯¹åºçå¯¹è±¡å®ä¾æèç±»classå¯¹è±¡æ¥åéå¯¹è±¡ã\n\nå¨æ§è¡monitorenteræ¶ï¼é¦åä¼å°è¯è·åå¯¹è±¡çéï¼å¦æè¿ä¸ªå¯¹è±¡æ²¡æéï¼æèå½åçº¿ç¨å·²ç»æ¥æäºè¿ä¸ªå¯¹è±¡çéï¼é£ä¸ªéçè®¡æ°å¨å 1ï¼ç¸åºçï¼å¨æ§è¡monitorexitæ¶æä»¤æ¶ï¼ä¼å°éè®¡æ°å¨å1ï¼å½è®¡æ°å¨ä¸º0æ¶ï¼è¿ä¸ªéå°±è¢«éæ¾ãå¦æè·åå¯¹è±¡éå¤±è´¥ï¼é£å½åçº¿ç¨å°±è¦é»å¡ç­å¾ï¼ç´å°å¯¹è±¡éè¢«å¦ä¸ä¸ªçº¿ç¨éæ¾ä¸ºæ­¢ã\n\n\n# synchronized éåçº§\n\néåçº§çè¿ç¨ï¼\n\n 1. ä¸å¼å§æ¯å¤äºæ éç¶æç\n\n 2. å½æä¸ä¸ªçº¿ç¨è®¿é®åæ­¥ä»£ç åæ¶ï¼åçº§æååéï¼mark word éå­å¨éååççº¿ç¨ id ï¼å¨çº¿ç¨è¿å¥åéåºåæ­¥åæ¶ä¸åéè¿ cas æä½æ¥å éåè§£éï¼èæ¯æ£æµ mark word éæ¯å¦å­å¨çæåå½åçº¿ç¨çååéï¼\n\n 3. æéç«äºæ¶ï¼åçº§ä¸ºè½»éçº§éï¼èªæè·åé\n\n 4. èªæåæ¬¡å¤±è´¥åï¼åçº§æééçº§éï¼çº¿ç¨é»å¡ï¼\n\néçå¯¹æ¯ï¼\n\né      ä¼ç¹                                 ç¼ºç¹                         éç¨åºæ¯\nååé    å éåè§£éä¸éè¦é¢å¤çæ¶èï¼åæ§è¡éåæ­¥æ¹æ³ç¸æ¯ä»æçº³ç§çº§çå·®è·   å¦æçº¿ç¨é´å­å¨éç«äºï¼ä¼å¸¦æ¥é¢å¤çéæ¤éçæ¶è    éç¨äºåªæä¸ä¸ªçº¿ç¨è®¿é®åæ­¥åçåºæ¯\nè½»éçº§é   ç«äºççº¿ç¨ä¸ä¼é»å¡ï¼æé«äºç¨åºçååºéåº¦               å¦æç«äºççº¿ç¨å§ç»å¾ä¸å°éï¼æ¯ç¨èªæä¼æ¶ècpu   è¿½æ±ååºéåº¦ï¼çä¸å­æ§è¡éåº¦éå¸¸å¿«\nééçº§é   çº¿ç¨ç«äºä¸ä½¿ç¨èªæï¼ä¸ä¼æ¶ècpu                  çº¿ç¨é»å¡ï¼ååºæ¶é´ç¼æ¢                è¿½æ±ååéï¼åæ­¥å¿«æ§è¡éåº¦è¾æ¢\n\nhttps://zhuanlan.zhihu.com/p/482639650\n\n\n# volatile\n\nvolatileæ¯javaèææºç³»ç»çè½»éçº§åæ­¥æºå¶ã\n\nå¶ç¹ç¹æï¼\n\n * ä¿è¯å¯è§æ§\n * ä¸ä¿è¯åå­æ§\n * ç¦æ­¢æä»¤éæåºã\n   * é¿åäºå¤çº¿ç¨ç¯å¢ä¸ç¨åºåºç°ä¹±åºæ§è¡çç°è±¡ã\n   * æä»¤éæåªä¼ä¿è¯ä¸²è¡è¯­ä¹çæ§è¡çä¸è´æ§ï¼åçº¿ç¨ï¼ï¼ä½å¹¶ä¸å³å¿å¤çº¿ç¨é´çè¯­ä¹ä¸è´æ§ã\n   * å¯¹ volatile åéçè¯»ååæä½ä¼å¨æä»¤åºåä¸­æå¥åå­å±éï¼ä¿è¯äºvolatileåéçè¯»åæä½ä¸ä¼è¢«æä»¤éæåºæå½±åã\n\nåå­å±éï¼memory barrierï¼æ¯ä¸ä¸ª cpu æä»¤ï¼ä½ç¨æä¸¤ä¸ªï¼\n\n 1. ä¿è¯ç¹å®æä½çæ§è¡é¡ºåº\n 2. ä¿è¯æäºåéçåå­å¯è§æ§ï¼å©ç¨è¯¥ç¹æ§å®ç° volatile çå¯è§æ§ï¼\n\nåºç¨åºæ¯ï¼\n\nåä¾æ¨¡å¼ä¸dclä¸ä¸å®çº¿ç¨å®å¨ï¼ç±äºæä»¤éæï¼æä»¥ç¨åºæå°æ¦çä¼åºç° instance != nullï¼ä½ instance çå¼ç¨å¯¹è±¡å¯è½è¿æ²¡å®æåå§åãæä»¥å½ä¸ä¸ªçº¿ç¨è®¿é® instance != nullæ¶ï¼instanceæªå¿å·²ç»åå§åå®æï¼é æäºçº¿ç¨å®å¨é®é¢ã\n\nå ä¸º instance = new singleton();å¯ä»¥ä¸ºè¢«åä¸ºä¸æ­¥ï¼\n\nmemory = allocate();// 1. åéå¯¹è±¡åå­ç©ºé´\ninstance(memory); // 2.åå§åå¯¹è±¡\ninstance = memory; // 3. è®¾ç½® instance æ§è¡ååéçåå­å°åï¼æ­¤æ¶ instance != null\n\n\nè§£å³æ¹æ¡å¯ä»¥å¨å®ä¾ä¸å ä¸ volatileï¼private static volatile singleton instance = null;\n\n\n# å¦ä½å®ç°å¯è§æ§\n\nvolatile å³é®å­å¯ä»¥ä¿è¯å¯è§æ§çåå æ¯ï¼å®ä¼åè¯ java ç¼è¯å¨åè¿è¡æ¶ç³»ç»ï¼æ¯æ¬¡è¯»åè¯¥åéæ¶é½å¿é¡»ä»ä¸»åå­ä¸­éæ°è·åææ°çå¼ï¼èä¸æ¯ä½¿ç¨æ¬å°ç¼å­çå¯æ¬ã\n\nå·ä½æ¥è¯´ï¼å½ä¸ä¸ªçº¿ç¨ä¿®æ¹ä¸ä¸ª volatile åéçå¼æ¶ï¼è¿ä¸ªå¼ä¼ç«å³è¢«ååå°ä¸»åå­ä¸­ï¼èä¸æ¯è¢«ç¼å­å¨è¯¥çº¿ç¨çæ¬å°ç¼å­ä¸­ãåæ¶ï¼å½å¶ä»çº¿ç¨éè¦è¯»åè¿ä¸ªåéçå¼æ¶ï¼å®ä»¬ä¹ä¼ä»ä¸»åå­ä¸­è·åææ°çå¼ï¼èä¸æ¯ä»æ¬å°ç¼å­ä¸­è·åæ§å¼ã\n\nè¿ç§å¼ºå¶å·æ°åå­çè¡ä¸ºç¡®ä¿äºåéçå¯è§æ§ï¼å³ä½¿æå¤ä¸ªçº¿ç¨åæ¶å¯¹åéè¿è¡è¯»ååä¿®æ¹ï¼ä¹è½å¤çå°ææ°çå¼ã\n\nvolatile åéçåå­å¯è§æ§æ¯åºäºåå­å±é(memory barrier)å®ç°:\n\n * åå­å±éï¼åç§°åå­æ æ ï¼æ¯ä¸ä¸ª cpu æä»¤ã\n * å¨ç¨åºè¿è¡æ¶ï¼ä¸ºäºæé«æ§è¡æ§è½ï¼ç¼è¯å¨åå¤çå¨ä¼å¯¹æä»¤è¿è¡éæåºï¼jmm ä¸ºäºä¿è¯å¨ä¸åçç¼è¯å¨å cpu ä¸æç¸åçç»æï¼éè¿æå¥ç¹å®ç±»åçåå­å±éæ¥ç¦æ­¢+ ç¹å®ç±»åçç¼è¯å¨éæåºåå¤çå¨éæåºï¼æå¥ä¸æ¡åå­å±éä¼åè¯ç¼è¯å¨å cpuï¼ä¸ç®¡ä»ä¹æä»¤é½ä¸è½åè¿æ¡ memory barrier æä»¤éæåºã\n\n\n# ä¸ºä»ä¹ä¸è½å®ç°åå­æ§\n\nï¼å ä¸ºåªä¿è¯å¯è§æ§çæåµä¸ï¼æ¯æ æ³å®ç°åå­æ§çãããæä»¥ä¸è½å®ç°åå­æ§ï¼\n\nvolatile å³é®å­ä¸è½ä¿è¯åå­æ§çåå æ¯ï¼å®åªæ¯ä¿è¯åéçè¯»åæä½å¯¹ææçº¿ç¨çå¯è§æ§ï¼ä½å¹¶ä¸è½ä¿è¯å¨å¤ä¸ªçº¿ç¨åæ¶è®¿é®åä¸ä¸ªåéæ¶ï¼æä½çé¡ºåºåæ­£ç¡®æ§ã\n\nä¾å¦ï¼å¨ä¸ä¸ªå¤çº¿ç¨ç¨åºä¸­ï¼å¦ææä¸¤ä¸ªçº¿ç¨åæ¶å¯¹ä¸ä¸ª volatile åéè¿è¡èªå¢æä½\n\nvolatile int count = 0;\n\npublic void increment() {\n    count++;\n}\n\n\né£ä¹å¯è½ä¼åçä»¥ä¸æåµï¼\n\n 1. çº¿ç¨ a ä»åå­ä¸­è¯»ååéå¼ä¸º 0ã\n 2. çº¿ç¨ b ä»åå­ä¸­è¯»ååéå¼ä¸º 0ã\n 3. çº¿ç¨ a å°åéå¼å  1 å¾å° 1ã\n 4. çº¿ç¨ b å°åéå¼å  1 å¾å° 1ã\n 5. çº¿ç¨ a å°åéå¼åååå­ã\n 6. çº¿ç¨ b å°åéå¼åååå­ã\n\nå¨è¿ä¸ªä¾å­ä¸­ï¼è½ç¶ volatile å³é®å­ä¿è¯äºçº¿ç¨ a åçº¿ç¨ b é½è½å¤çå°ææ°çåéå¼ï¼ä½å®æ æ³ä¿è¯æä½çåå­æ§ï¼å¯¼è´æç»çåéå¼ä¸º 1 èä¸æ¯ 2ã\n\n\n# åè\n\n * https://segmentfault.com/a/1190000041268785\n\n * https://zhuanlan.zhihu.com/p/482639650",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ThreadLocal",frontmatter:{title:"ThreadLocal",date:"2023-03-29T23:17:11.000Z",permalink:"/pages/41602c/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/02.TreadLocal.html",relativePath:"01.Java/04.Javaå¹¶å/02.TreadLocal.md",key:"v-43826e72",path:"/pages/41602c/",headers:[{level:2,title:"å¯¹ThreadLocalççè§£",slug:"å¯¹threadlocalççè§£",normalizedTitle:"å¯¹threadlocalççè§£",charIndex:2},{level:2,title:"ThreadLocalçå®ç°åç",slug:"threadlocalçå®ç°åç",normalizedTitle:"threadlocalçå®ç°åç",charIndex:705},{level:2,title:"ThreadLocalçä½¿ç¨åºæ¯",slug:"threadlocalçä½¿ç¨åºæ¯",normalizedTitle:"threadlocalçä½¿ç¨åºæ¯",charIndex:1550},{level:3,title:"ä»£æ¿åæ°çæ¾ç¤ºä¼ é",slug:"ä»£æ¿åæ°çæ¾ç¤ºä¼ é",normalizedTitle:"ä»£æ¿åæ°çæ¾ç¤ºä¼ é",charIndex:1571},{level:3,title:"å¨å±å­å¨ç¨æ·ä¿¡æ¯",slug:"å¨å±å­å¨ç¨æ·ä¿¡æ¯",normalizedTitle:"å¨å±å­å¨ç¨æ·ä¿¡æ¯",charIndex:1824},{level:3,title:"è§£å³çº¿ç¨å®å¨é®é¢",slug:"è§£å³çº¿ç¨å®å¨é®é¢",normalizedTitle:"è§£å³çº¿ç¨å®å¨é®é¢",charIndex:2400},{level:3,title:"æç¨çåºæ¯",slug:"æç¨çåºæ¯",normalizedTitle:"æç¨çåºæ¯",charIndex:3861}],headersStr:"å¯¹ThreadLocalççè§£ ThreadLocalçå®ç°åç ThreadLocalçä½¿ç¨åºæ¯ ä»£æ¿åæ°çæ¾ç¤ºä¼ é å¨å±å­å¨ç¨æ·ä¿¡æ¯ è§£å³çº¿ç¨å®å¨é®é¢ æç¨çåºæ¯",content:'# å¯¹ThreadLocalççè§£\n\nThreadLocalæ¯ä¸ä¸ªJavaç±»ï¼ç¨äºå¨å¤çº¿ç¨ç¼ç¨ä¸­ç»´æ¤çº¿ç¨æ¬å°åéãæ¯ä¸ªçº¿ç¨é½æèªå·±çThreadLocalåéå¯æ¬ï¼çº¿ç¨ä¹é´äºä¸å¹²æ°ã\n\nThreadLocalå¯ä»¥ç¨äºå¨å¤çº¿ç¨ç¯å¢ä¸é¿åå±äº«åéçç«äºé®é¢ï¼å¯ä»¥æé«å¤çº¿ç¨ç¨åºçæ§è½åå¹¶ååº¦ã\n\nThreadLocalå¸¸ç¨çæ¹æ³åæ¬get()ãset()åremove()ãå¶ä¸­ï¼get()æ¹æ³ç¨äºè·åå½åçº¿ç¨çThreadLocalåéå¼ï¼å¦æå½åçº¿ç¨æ²¡æè®¾ç½®è¿è¯¥åéï¼åè¿ånullãset()æ¹æ³ç¨äºè®¾ç½®å½åçº¿ç¨çThreadLocalåéå¼ï¼remove()æ¹æ³ç¨äºå é¤å½åçº¿ç¨çThreadLocalåéå¼ã\n\néè¦æ³¨æçæ¯ï¼ä½¿ç¨ThreadLocalæ¶éè¦å°å¿é¿ååå­æ³æ¼é®é¢ï¼å°¤å¶æ¯å¨é¿æ¶é´è¿è¡çå¤çº¿ç¨åºç¨ä¸­ãå½ä¸ä¸ªçº¿ç¨ç»ææ¶ï¼å¦ææ²¡ææå¨å é¤ThreadLocalåéå¼ï¼åå¯è½å¯¼è´è¯¥å¼ä¸ç´å­å¨å¨ThreadLocalMapä¸­ï¼ä»èå¼ååå­æ³æ¼ãä¸ºé¿åè¿ç§æåµï¼å¯ä»¥ä½¿ç¨ThreadLocalçremove()æ¹æ³æ¥æå¨å é¤ThreadLocalåéå¼ã\n\nJava ç Web é¡¹ç®å¤§é¨åé½æ¯åºäº Tomcatãæ¯æ¬¡è®¿é®é½æ¯ä¸ä¸ªæ°ççº¿ç¨ï¼æ¯ä¸ä¸ªçº¿ç¨é½ç¬äº«ä¸ä¸ª ThreadLocalï¼æä»¬å¯ä»¥å¨æ¥æ¶è¯·æ±çæ¶å set ç¹å®åå®¹ï¼å¨éè¦çæ¶å get è¿ä¸ªå¼ã\n\npublic T get() {...}\npublic void set(T value) {...}\npublic void remove() {...}\nprotected T initialValue() {...}\n\n\n\n# ThreadLocalçå®ç°åç\n\nThreadLocalçå®ç°åçå¯ä»¥ç®åæ¦æ¬ä¸ºï¼æ¯ä¸ªThreadå¯¹è±¡ç»´æ¤ä¸ä¸ªThreadLocalMapå¯¹è±¡ï¼ThreadLocalMapå¯¹è±¡çkeyä¸ºThreadLocalå¯¹è±¡ï¼valueä¸ºThreadLocalå¯¹è±¡å¯¹åºçå¼ã\n\nå·ä½æ¥è¯´ï¼ThreadLocalç±»ä¸­æä¸ä¸ªThreadLocalMapç±»åçæååéthreadLocalsï¼æ¯ä¸ªThreadå¯¹è±¡é½æä¸ä¸ªè¯¥æååéçå®ä¾ãThreadLocalMapç±»æ¯ThreadLocalç±»çåé¨ç±»ï¼å®ç¨äºå­å¨ThreadLocalå¯¹è±¡åå¶å¯¹åºçå¼ãThreadLocalMapç±»ä¸­çEntryç±»è¡¨ç¤ºä¸ä¸ªé®å¼å¯¹ï¼å¶ä¸­keyä¸ºThreadLocalå¯¹è±¡ï¼valueä¸ºThreadLocalå¯¹è±¡å¯¹åºçå¼ã\n\nå½è°ç¨ThreadLocalçset()æ¹æ³æ¶ï¼ä¼è·åå½åçº¿ç¨çThreadLocalMapå¯¹è±¡ï¼å°ThreadLocalå¯¹è±¡ä½ä¸ºkeyï¼è®¾ç½®valueä¸ºæå®çå¼ãå½è°ç¨ThreadLocalçget()æ¹æ³æ¶ï¼åæ ·ä¼è·åå½åçº¿ç¨çThreadLocalMapå¯¹è±¡ï¼ä»ä¸­è·åThreadLocalå¯¹è±¡å¯¹åºçå¼ãå¦æå½åçº¿ç¨æ²¡æè®¾ç½®è¿è¯¥ThreadLocalå¯¹è±¡çå¼ï¼åè¿åThreadLocalå¯¹è±¡çåå§å¼ãå½ThreadLocalå¯¹è±¡è¢«åå¾åæ¶æ¶ï¼å¯¹åºçEntryå¯¹è±¡ä¹ä¼è¢«ä»ThreadLocalMapä¸­ç§»é¤ã\n\néè¦æ³¨æçæ¯ï¼ThreadLocalè½ç¶å¯ä»¥å®ç°çº¿ç¨é´æ°æ®éç¦»ï¼ä½æ¯å¨å¤çº¿ç¨å¹¶åè®¿é®æ¶ï¼å¯è½ä¼åºç°åå­æ³æ¼é®é¢ãè¿æ¯å ä¸ºThreadLocalMapä¸­çEntryå¯¹è±¡çkeyææçæ¯ThreadLocalå¯¹è±¡çå¼±å¼ç¨ï¼å¦æThreadLocalå¯¹è±¡æ²¡æè¢«å¤é¨å¼ºå¼ç¨ææï¼å°±å¯è½è¢«åå¾åæ¶ãä½æ¯ï¼ç±äºThreadLocalMapä¸­çEntryå¯¹è±¡æ²¡æè¢«åæ¶æ¸çï¼å°±å¯è½å¯¼è´åå­æ³æ¼ãå æ­¤ï¼ä½¿ç¨ThreadLocalæ¶éè¦æ³¨æåæ¶æ¸çä¸åéè¦çThreadLocalå¯¹è±¡ã\n\n\n# ThreadLocalçä½¿ç¨åºæ¯\n\n\n# ä»£æ¿åæ°çæ¾ç¤ºä¼ é\n\nå½æä»¬å¨åAPIæ¥å£çæ¶åï¼éå¸¸Controllerå±ä¼æ¥åæ¥èªåç«¯çå¥åï¼å½è¿ä¸ªæ¥å£åè½æ¯è¾å¤æçæ¶åï¼å¯è½æä»¬è°ç¨çServiceå±åé¨è¿è°ç¨äºå¾å¤å¶ä»çå¾å¤æ¹æ³ï¼éå¸¸æåµä¸ï¼æä»¬ä¼å¨æ¯ä¸ªè°ç¨çæ¹æ³ä¸å ä¸éè¦ä¼ éçåæ°ãå¯ä»¥é¿ååæ°çå±å±ä¼ éã\n\nä½æ¯å¦ææä»¬å°åæ°å­å¥ThreadLocalä¸­ï¼é£ä¹å°±ä¸ç¨æ¾å¼çä¼ éåæ°äºï¼èæ¯åªéè¦ThreadLocalä¸­è·åå³å¯ã\n\nè¿ä¸ªåºæ¯å¶å®ä½¿ç¨çæ¯è¾å°ï¼ä¸æ¹é¢æ¾å¼ä¼ åæ¯è¾å®¹æçè§£ï¼å¦ä¸æ¹é¢æä»¬å¯ä»¥å°å¤ä¸ªåæ°å°è£ä¸ºå¯¹è±¡å»ä¼ éã\n\n\n# å¨å±å­å¨ç¨æ·ä¿¡æ¯\n\nå¨ç°å¨çç³»ç»è®¾è®¡ä¸­ï¼ååç«¯åç¦»å·²åºæ¬æä¸ºå¸¸æï¼åç¦»ä¹åå¦ä½è·åç¨æ·ä¿¡æ¯å°±æäºä¸ä»¶éº»ç¦äºï¼éå¸¸å¨ç¨æ·ç»å½åï¼ ç¨æ·ä¿¡æ¯ä¼ä¿å­å¨SessionæèTokenä¸­ãè¿ä¸ªæ¶åï¼æä»¬å¦æä½¿ç¨å¸¸è§çææ®µå»è·åç¨æ·ä¿¡æ¯ä¼å¾è´¹å²ï¼æ¿Sessionæ¥è¯´ï¼æä»¬è¦å¨æ¥å£åæ°ä¸­å ä¸HttpServletRequestå¯¹è±¡ï¼ç¶åè°ç¨ getSessionæ¹æ³ï¼ä¸æ¯ä¸ä¸ªéè¦ç¨æ·ä¿¡æ¯çæ¥å£é½è¦å ä¸è¿ä¸ªåæ°ï¼æè½è·åSessionï¼è¿æ ·å®ç°å°±å¾éº»ç¦äºã\n\nå¨å®éçç³»ç»è®¾è®¡ä¸­ï¼æä»¬è¯å®ä¸ä¼éç¨ä¸é¢æè¯´çè¿ç§æ¹å¼ï¼èæ¯ä½¿ç¨ThreadLocalï¼æä»¬ä¼éæ©å¨æ¦æªå¨çä¸å¡ä¸­ï¼ è·åå°ä¿å­çç¨æ·ä¿¡æ¯ï¼ç¶åå­å¥ThreadLocalï¼é£ä¹å½åçº¿ç¨å¨ä»»ä½å°æ¹å¦æéè¦æ¿å°ç¨æ·ä¿¡æ¯é½å¯ä»¥ä½¿ç¨ThreadLocalçget()æ¹æ³ (å¼æ­¥ç¨åºä¸­ThreadLocalæ¯ä¸å¯é ç)\n\nè¿ä¸ªåºæ¯ä½¿ç¨çæ¯è¾å¤ï¼å½ç¨æ·ç»å½åï¼ä¼å°ç¨æ·ä¿¡æ¯å­å¥Tokenä¸­è¿ååç«¯ï¼å½ç¨æ·è°ç¨éè¦ææçæ¥å£æ¶ï¼éè¦å¨headerä¸­æºå¸¦ Tokenï¼ç¶åæ¦æªå¨ä¸­è§£æTokenï¼è·åç¨æ·ä¿¡æ¯ï¼è°ç¨èªå®ä¹çç±»(AuthNHolder)å­å¥ThreadLocalä¸­ï¼å½è¯·æ±ç»æçæ¶åï¼å°ThreadLocalå­å¨æ°æ®æ¸ç©ºï¼ ä¸­é´çè¿ç¨æ éå¨å³æ³¨å¦ä½è·åç¨æ·ä¿¡æ¯ï¼åªéè¦ä½¿ç¨å·¥å·ç±»çgetæ¹æ³å³å¯ã\n\n\n# è§£å³çº¿ç¨å®å¨é®é¢\n\nå¨SpringçWebé¡¹ç®ä¸­ï¼æä»¬éå¸¸ä¼å°ä¸å¡åä¸ºControllerå±ï¼Serviceå±ï¼Daoå±ï¼ æä»¬é½ç¥é@Autowiredæ³¨è§£é»è®¤ä½¿ç¨åä¾æ¨¡å¼ï¼é£ä¹ä¸åè¯·æ±çº¿ç¨è¿æ¥ä¹åï¼ç±äºDaoå±ä½¿ç¨åä¾ï¼é£ä¹è´è´£æ°æ®åºè¿æ¥çConnectionä¹åªæä¸ä¸ªï¼ å¦ææ¯ä¸ªè¯·æ±çº¿ç¨é½å»è¿æ¥æ°æ®åºï¼é£ä¹å°±ä¼é æçº¿ç¨ä¸å®å¨çé®é¢ï¼Springæ¯å¦ä½è§£å³è¿ä¸ªé®é¢çå¢ï¼\n\nå¨Springé¡¹ç®ä¸­Daoå±ä¸­è£éçConnectionè¯å®æ¯çº¿ç¨å®å¨çï¼å¶è§£å³æ¹æ¡å°±æ¯éç¨ThreadLocalæ¹æ³ï¼å½æ¯ä¸ªè¯·æ±çº¿ç¨ä½¿ç¨Connectionçæ¶åï¼ é½ä¼ä»ThreadLocalè·åä¸æ¬¡ï¼å¦æä¸ºnullï¼è¯´ææ²¡æè¿è¡è¿æ°æ®åºè¿æ¥ï¼è¿æ¥åå­å¥ThreadLocalä¸­ï¼å¦æ­¤ä¸æ¥ï¼æ¯ä¸ä¸ªè¯·æ±çº¿ç¨é½ä¿å­æä¸ä»½ èªå·±çConnectionãäºæ¯ä¾¿è§£å³äºçº¿ç¨å®å¨é®é¢ã\n\nThreadLocalå¨è®¾è®¡ä¹åå°±æ¯ä¸ºè§£å³å¹¶åé®é¢èæä¾ä¸ç§æ¹æ¡ï¼æ¯ä¸ªçº¿ç¨ç»´æ¤ä¸ä»½èªå·±çæ°æ®ï¼è¾¾å°çº¿ç¨éç¦»çææã\n\næ¯å¦æ¥ææ ¼å¼åï¼å¨å¤çº¿ç¨ç¯å¢ä¸­ï¼æ¥ææ ¼å¼åæ¯ä¸ä¸ªå¸¸è§çé®é¢ãç±äºSimpleDateFormatæ¯éçº¿ç¨å®å¨çï¼å æ­¤ä¸ºæ¯ä¸ªçº¿ç¨ç»´æ¤èªå·±çSimpleDateFormatå¯¹è±¡å¯æ¬æ¯ä¸ç§è§£å³æ¹æ¡ã\n\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\n\npublic class DateFormatThreadLocal {\n    private static final ThreadLocal<SimpleDateFormat> DATE_FORMAT_THREAD_LOCAL = new ThreadLocal<SimpleDateFormat>() {\n        @Override\n        protected SimpleDateFormat initialValue() {\n            return new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n        }\n    };\n\n    public static void main(String[] args) {\n        Thread thread1 = new Thread(() -> {\n            SimpleDateFormat dateFormat = DATE_FORMAT_THREAD_LOCAL.get();\n            System.out.println("Thread 1 formatted date: " + dateFormat.format(new Date()));\n        });\n\n        Thread thread2 = new Thread(() -> {\n            SimpleDateFormat dateFormat = DATE_FORMAT_THREAD_LOCAL.get();\n            System.out.println("Thread 2 formatted date: " + dateFormat.format(new Date()));\n        });\n\n        thread1.start();\n        thread2.start();\n    }\n}\n\n\n\n# æç¨çåºæ¯\n\n1.çº¿ç¨æ± ä¸­çº¿ç¨è°ç¨ä½¿ç¨ThreadLocal ï¼ç±äºçº¿ç¨æ± ä¸­å¯¹çº¿ç¨ç®¡çé½æ¯éç¨çº¿ç¨å¤ç¨çæ¹æ³ãå¨çº¿ç¨æ± ä¸­çº¿ç¨éå¸¸é¾ç»æçè³äºæ°¸è¿ä¸ä¼ç»æãè¿å°æå³ççº¿ç¨æç»­çæ¶é´å°ä¸å¯é¢æ¸¬ï¼çè³ä¸JVMççå½å¨æä¸è´\n\n2.å¼æ­¥ç¨åºä¸­ï¼ThreadLocalçåæ°ä¼ éæ¯ä¸é è°±çï¼ ç±äºçº¿ç¨å°è¯·æ±åéåãå°±ä¸åç­å¾è¿ç¨è¿åç»æç»§ç»­åä¸è¿è¡äºï¼çæ­£çè¿åç»æå¾å°åï¼å¤çççº¿ç¨å¯è½æ¯å¶ä»ççº¿ç¨ãJava8ä¸­çå¹¶åæµä¹è¦èèè¿ç§æåµ\n\n3.ä½¿ç¨å®ThreadLocal ï¼æå¥½æå¨è°ç¨ remove() æ¹æ³ï¼é²æ­¢åºç°åå­æº¢åºï¼å ä¸ºä¸­ä½¿ç¨çkeyä¸ºThreadLocalçå¼±å¼ç¨ï¼ å¦æThreadLocal æ²¡æè¢«å¤é¨å¼ºå¼ç¨çæåµä¸ï¼å¨åå¾åæ¶çæ¶åä¼è¢«æ¸çæçï¼ä½æ¯å¦ævalueæ¯å¼ºå¼ç¨ï¼ä¸ä¼è¢«æ¸çï¼ è¿æ ·ä¸æ¥å°±ä¼åºç° key ä¸º null ç valueã',normalizedContent:'# å¯¹threadlocalççè§£\n\nthreadlocalæ¯ä¸ä¸ªjavaç±»ï¼ç¨äºå¨å¤çº¿ç¨ç¼ç¨ä¸­ç»´æ¤çº¿ç¨æ¬å°åéãæ¯ä¸ªçº¿ç¨é½æèªå·±çthreadlocalåéå¯æ¬ï¼çº¿ç¨ä¹é´äºä¸å¹²æ°ã\n\nthreadlocalå¯ä»¥ç¨äºå¨å¤çº¿ç¨ç¯å¢ä¸é¿åå±äº«åéçç«äºé®é¢ï¼å¯ä»¥æé«å¤çº¿ç¨ç¨åºçæ§è½åå¹¶ååº¦ã\n\nthreadlocalå¸¸ç¨çæ¹æ³åæ¬get()ãset()åremove()ãå¶ä¸­ï¼get()æ¹æ³ç¨äºè·åå½åçº¿ç¨çthreadlocalåéå¼ï¼å¦æå½åçº¿ç¨æ²¡æè®¾ç½®è¿è¯¥åéï¼åè¿ånullãset()æ¹æ³ç¨äºè®¾ç½®å½åçº¿ç¨çthreadlocalåéå¼ï¼remove()æ¹æ³ç¨äºå é¤å½åçº¿ç¨çthreadlocalåéå¼ã\n\néè¦æ³¨æçæ¯ï¼ä½¿ç¨threadlocalæ¶éè¦å°å¿é¿ååå­æ³æ¼é®é¢ï¼å°¤å¶æ¯å¨é¿æ¶é´è¿è¡çå¤çº¿ç¨åºç¨ä¸­ãå½ä¸ä¸ªçº¿ç¨ç»ææ¶ï¼å¦ææ²¡ææå¨å é¤threadlocalåéå¼ï¼åå¯è½å¯¼è´è¯¥å¼ä¸ç´å­å¨å¨threadlocalmapä¸­ï¼ä»èå¼ååå­æ³æ¼ãä¸ºé¿åè¿ç§æåµï¼å¯ä»¥ä½¿ç¨threadlocalçremove()æ¹æ³æ¥æå¨å é¤threadlocalåéå¼ã\n\njava ç web é¡¹ç®å¤§é¨åé½æ¯åºäº tomcatãæ¯æ¬¡è®¿é®é½æ¯ä¸ä¸ªæ°ççº¿ç¨ï¼æ¯ä¸ä¸ªçº¿ç¨é½ç¬äº«ä¸ä¸ª threadlocalï¼æä»¬å¯ä»¥å¨æ¥æ¶è¯·æ±çæ¶å set ç¹å®åå®¹ï¼å¨éè¦çæ¶å get è¿ä¸ªå¼ã\n\npublic t get() {...}\npublic void set(t value) {...}\npublic void remove() {...}\nprotected t initialvalue() {...}\n\n\n\n# threadlocalçå®ç°åç\n\nthreadlocalçå®ç°åçå¯ä»¥ç®åæ¦æ¬ä¸ºï¼æ¯ä¸ªthreadå¯¹è±¡ç»´æ¤ä¸ä¸ªthreadlocalmapå¯¹è±¡ï¼threadlocalmapå¯¹è±¡çkeyä¸ºthreadlocalå¯¹è±¡ï¼valueä¸ºthreadlocalå¯¹è±¡å¯¹åºçå¼ã\n\nå·ä½æ¥è¯´ï¼threadlocalç±»ä¸­æä¸ä¸ªthreadlocalmapç±»åçæååéthreadlocalsï¼æ¯ä¸ªthreadå¯¹è±¡é½æä¸ä¸ªè¯¥æååéçå®ä¾ãthreadlocalmapç±»æ¯threadlocalç±»çåé¨ç±»ï¼å®ç¨äºå­å¨threadlocalå¯¹è±¡åå¶å¯¹åºçå¼ãthreadlocalmapç±»ä¸­çentryç±»è¡¨ç¤ºä¸ä¸ªé®å¼å¯¹ï¼å¶ä¸­keyä¸ºthreadlocalå¯¹è±¡ï¼valueä¸ºthreadlocalå¯¹è±¡å¯¹åºçå¼ã\n\nå½è°ç¨threadlocalçset()æ¹æ³æ¶ï¼ä¼è·åå½åçº¿ç¨çthreadlocalmapå¯¹è±¡ï¼å°threadlocalå¯¹è±¡ä½ä¸ºkeyï¼è®¾ç½®valueä¸ºæå®çå¼ãå½è°ç¨threadlocalçget()æ¹æ³æ¶ï¼åæ ·ä¼è·åå½åçº¿ç¨çthreadlocalmapå¯¹è±¡ï¼ä»ä¸­è·åthreadlocalå¯¹è±¡å¯¹åºçå¼ãå¦æå½åçº¿ç¨æ²¡æè®¾ç½®è¿è¯¥threadlocalå¯¹è±¡çå¼ï¼åè¿åthreadlocalå¯¹è±¡çåå§å¼ãå½threadlocalå¯¹è±¡è¢«åå¾åæ¶æ¶ï¼å¯¹åºçentryå¯¹è±¡ä¹ä¼è¢«ä»threadlocalmapä¸­ç§»é¤ã\n\néè¦æ³¨æçæ¯ï¼threadlocalè½ç¶å¯ä»¥å®ç°çº¿ç¨é´æ°æ®éç¦»ï¼ä½æ¯å¨å¤çº¿ç¨å¹¶åè®¿é®æ¶ï¼å¯è½ä¼åºç°åå­æ³æ¼é®é¢ãè¿æ¯å ä¸ºthreadlocalmapä¸­çentryå¯¹è±¡çkeyææçæ¯threadlocalå¯¹è±¡çå¼±å¼ç¨ï¼å¦æthreadlocalå¯¹è±¡æ²¡æè¢«å¤é¨å¼ºå¼ç¨ææï¼å°±å¯è½è¢«åå¾åæ¶ãä½æ¯ï¼ç±äºthreadlocalmapä¸­çentryå¯¹è±¡æ²¡æè¢«åæ¶æ¸çï¼å°±å¯è½å¯¼è´åå­æ³æ¼ãå æ­¤ï¼ä½¿ç¨threadlocalæ¶éè¦æ³¨æåæ¶æ¸çä¸åéè¦çthreadlocalå¯¹è±¡ã\n\n\n# threadlocalçä½¿ç¨åºæ¯\n\n\n# ä»£æ¿åæ°çæ¾ç¤ºä¼ é\n\nå½æä»¬å¨åapiæ¥å£çæ¶åï¼éå¸¸controllerå±ä¼æ¥åæ¥èªåç«¯çå¥åï¼å½è¿ä¸ªæ¥å£åè½æ¯è¾å¤æçæ¶åï¼å¯è½æä»¬è°ç¨çserviceå±åé¨è¿è°ç¨äºå¾å¤å¶ä»çå¾å¤æ¹æ³ï¼éå¸¸æåµä¸ï¼æä»¬ä¼å¨æ¯ä¸ªè°ç¨çæ¹æ³ä¸å ä¸éè¦ä¼ éçåæ°ãå¯ä»¥é¿ååæ°çå±å±ä¼ éã\n\nä½æ¯å¦ææä»¬å°åæ°å­å¥threadlocalä¸­ï¼é£ä¹å°±ä¸ç¨æ¾å¼çä¼ éåæ°äºï¼èæ¯åªéè¦threadlocalä¸­è·åå³å¯ã\n\nè¿ä¸ªåºæ¯å¶å®ä½¿ç¨çæ¯è¾å°ï¼ä¸æ¹é¢æ¾å¼ä¼ åæ¯è¾å®¹æçè§£ï¼å¦ä¸æ¹é¢æä»¬å¯ä»¥å°å¤ä¸ªåæ°å°è£ä¸ºå¯¹è±¡å»ä¼ éã\n\n\n# å¨å±å­å¨ç¨æ·ä¿¡æ¯\n\nå¨ç°å¨çç³»ç»è®¾è®¡ä¸­ï¼ååç«¯åç¦»å·²åºæ¬æä¸ºå¸¸æï¼åç¦»ä¹åå¦ä½è·åç¨æ·ä¿¡æ¯å°±æäºä¸ä»¶éº»ç¦äºï¼éå¸¸å¨ç¨æ·ç»å½åï¼ ç¨æ·ä¿¡æ¯ä¼ä¿å­å¨sessionæètokenä¸­ãè¿ä¸ªæ¶åï¼æä»¬å¦æä½¿ç¨å¸¸è§çææ®µå»è·åç¨æ·ä¿¡æ¯ä¼å¾è´¹å²ï¼æ¿sessionæ¥è¯´ï¼æä»¬è¦å¨æ¥å£åæ°ä¸­å ä¸httpservletrequestå¯¹è±¡ï¼ç¶åè°ç¨ getsessionæ¹æ³ï¼ä¸æ¯ä¸ä¸ªéè¦ç¨æ·ä¿¡æ¯çæ¥å£é½è¦å ä¸è¿ä¸ªåæ°ï¼æè½è·åsessionï¼è¿æ ·å®ç°å°±å¾éº»ç¦äºã\n\nå¨å®éçç³»ç»è®¾è®¡ä¸­ï¼æä»¬è¯å®ä¸ä¼éç¨ä¸é¢æè¯´çè¿ç§æ¹å¼ï¼èæ¯ä½¿ç¨threadlocalï¼æä»¬ä¼éæ©å¨æ¦æªå¨çä¸å¡ä¸­ï¼ è·åå°ä¿å­çç¨æ·ä¿¡æ¯ï¼ç¶åå­å¥threadlocalï¼é£ä¹å½åçº¿ç¨å¨ä»»ä½å°æ¹å¦æéè¦æ¿å°ç¨æ·ä¿¡æ¯é½å¯ä»¥ä½¿ç¨threadlocalçget()æ¹æ³ (å¼æ­¥ç¨åºä¸­threadlocalæ¯ä¸å¯é ç)\n\nè¿ä¸ªåºæ¯ä½¿ç¨çæ¯è¾å¤ï¼å½ç¨æ·ç»å½åï¼ä¼å°ç¨æ·ä¿¡æ¯å­å¥tokenä¸­è¿ååç«¯ï¼å½ç¨æ·è°ç¨éè¦ææçæ¥å£æ¶ï¼éè¦å¨headerä¸­æºå¸¦ tokenï¼ç¶åæ¦æªå¨ä¸­è§£ætokenï¼è·åç¨æ·ä¿¡æ¯ï¼è°ç¨èªå®ä¹çç±»(authnholder)å­å¥threadlocalä¸­ï¼å½è¯·æ±ç»æçæ¶åï¼å°threadlocalå­å¨æ°æ®æ¸ç©ºï¼ ä¸­é´çè¿ç¨æ éå¨å³æ³¨å¦ä½è·åç¨æ·ä¿¡æ¯ï¼åªéè¦ä½¿ç¨å·¥å·ç±»çgetæ¹æ³å³å¯ã\n\n\n# è§£å³çº¿ç¨å®å¨é®é¢\n\nå¨springçwebé¡¹ç®ä¸­ï¼æä»¬éå¸¸ä¼å°ä¸å¡åä¸ºcontrollerå±ï¼serviceå±ï¼daoå±ï¼ æä»¬é½ç¥é@autowiredæ³¨è§£é»è®¤ä½¿ç¨åä¾æ¨¡å¼ï¼é£ä¹ä¸åè¯·æ±çº¿ç¨è¿æ¥ä¹åï¼ç±äºdaoå±ä½¿ç¨åä¾ï¼é£ä¹è´è´£æ°æ®åºè¿æ¥çconnectionä¹åªæä¸ä¸ªï¼ å¦ææ¯ä¸ªè¯·æ±çº¿ç¨é½å»è¿æ¥æ°æ®åºï¼é£ä¹å°±ä¼é æçº¿ç¨ä¸å®å¨çé®é¢ï¼springæ¯å¦ä½è§£å³è¿ä¸ªé®é¢çå¢ï¼\n\nå¨springé¡¹ç®ä¸­daoå±ä¸­è£éçconnectionè¯å®æ¯çº¿ç¨å®å¨çï¼å¶è§£å³æ¹æ¡å°±æ¯éç¨threadlocalæ¹æ³ï¼å½æ¯ä¸ªè¯·æ±çº¿ç¨ä½¿ç¨connectionçæ¶åï¼ é½ä¼ä»threadlocalè·åä¸æ¬¡ï¼å¦æä¸ºnullï¼è¯´ææ²¡æè¿è¡è¿æ°æ®åºè¿æ¥ï¼è¿æ¥åå­å¥threadlocalä¸­ï¼å¦æ­¤ä¸æ¥ï¼æ¯ä¸ä¸ªè¯·æ±çº¿ç¨é½ä¿å­æä¸ä»½ èªå·±çconnectionãäºæ¯ä¾¿è§£å³äºçº¿ç¨å®å¨é®é¢ã\n\nthreadlocalå¨è®¾è®¡ä¹åå°±æ¯ä¸ºè§£å³å¹¶åé®é¢èæä¾ä¸ç§æ¹æ¡ï¼æ¯ä¸ªçº¿ç¨ç»´æ¤ä¸ä»½èªå·±çæ°æ®ï¼è¾¾å°çº¿ç¨éç¦»çææã\n\næ¯å¦æ¥ææ ¼å¼åï¼å¨å¤çº¿ç¨ç¯å¢ä¸­ï¼æ¥ææ ¼å¼åæ¯ä¸ä¸ªå¸¸è§çé®é¢ãç±äºsimpledateformatæ¯éçº¿ç¨å®å¨çï¼å æ­¤ä¸ºæ¯ä¸ªçº¿ç¨ç»´æ¤èªå·±çsimpledateformatå¯¹è±¡å¯æ¬æ¯ä¸ç§è§£å³æ¹æ¡ã\n\nimport java.text.simpledateformat;\nimport java.util.date;\n\npublic class dateformatthreadlocal {\n    private static final threadlocal<simpledateformat> date_format_thread_local = new threadlocal<simpledateformat>() {\n        @override\n        protected simpledateformat initialvalue() {\n            return new simpledateformat("yyyy-mm-dd hh:mm:ss");\n        }\n    };\n\n    public static void main(string[] args) {\n        thread thread1 = new thread(() -> {\n            simpledateformat dateformat = date_format_thread_local.get();\n            system.out.println("thread 1 formatted date: " + dateformat.format(new date()));\n        });\n\n        thread thread2 = new thread(() -> {\n            simpledateformat dateformat = date_format_thread_local.get();\n            system.out.println("thread 2 formatted date: " + dateformat.format(new date()));\n        });\n\n        thread1.start();\n        thread2.start();\n    }\n}\n\n\n\n# æç¨çåºæ¯\n\n1.çº¿ç¨æ± ä¸­çº¿ç¨è°ç¨ä½¿ç¨threadlocal ï¼ç±äºçº¿ç¨æ± ä¸­å¯¹çº¿ç¨ç®¡çé½æ¯éç¨çº¿ç¨å¤ç¨çæ¹æ³ãå¨çº¿ç¨æ± ä¸­çº¿ç¨éå¸¸é¾ç»æçè³äºæ°¸è¿ä¸ä¼ç»æãè¿å°æå³ççº¿ç¨æç»­çæ¶é´å°ä¸å¯é¢æ¸¬ï¼çè³ä¸jvmççå½å¨æä¸è´\n\n2.å¼æ­¥ç¨åºä¸­ï¼threadlocalçåæ°ä¼ éæ¯ä¸é è°±çï¼ ç±äºçº¿ç¨å°è¯·æ±åéåãå°±ä¸åç­å¾è¿ç¨è¿åç»æç»§ç»­åä¸è¿è¡äºï¼çæ­£çè¿åç»æå¾å°åï¼å¤çççº¿ç¨å¯è½æ¯å¶ä»ççº¿ç¨ãjava8ä¸­çå¹¶åæµä¹è¦èèè¿ç§æåµ\n\n3.ä½¿ç¨å®threadlocal ï¼æå¥½æå¨è°ç¨ remove() æ¹æ³ï¼é²æ­¢åºç°åå­æº¢åºï¼å ä¸ºä¸­ä½¿ç¨çkeyä¸ºthreadlocalçå¼±å¼ç¨ï¼ å¦æthreadlocal æ²¡æè¢«å¤é¨å¼ºå¼ç¨çæåµä¸ï¼å¨åå¾åæ¶çæ¶åä¼è¢«æ¸çæçï¼ä½æ¯å¦ævalueæ¯å¼ºå¼ç¨ï¼ä¸ä¼è¢«æ¸çï¼ è¿æ ·ä¸æ¥å°±ä¼åºç° key ä¸º null ç valueã',charsets:{cjk:!0}},{title:"ReentranLock",frontmatter:{title:"ReentranLock",date:"2023-03-30T17:30:51.000Z",permalink:"/pages/d1bd01/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/03.ReentrantLock.html",relativePath:"01.Java/04.Javaå¹¶å/03.ReentrantLock.md",key:"v-c20babe6",path:"/pages/d1bd01/",headers:[{level:2,title:"ReentrantLock å®ç°åç",slug:"reentrantlock-å®ç°åç",normalizedTitle:"reentrantlock å®ç°åç",charIndex:69},{level:2,title:"å¬å¹³éåéå¬å¹³é",slug:"å¬å¹³éåéå¬å¹³é",normalizedTitle:"å¬å¹³éåéå¬å¹³é",charIndex:2136},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:2849}],headersStr:"ReentrantLock å®ç°åç å¬å¹³éåéå¬å¹³é åè",content:'ReentrantLock æ¯å¯éå¥çç¬å éï¼åªè½æä¸ä¸ªçº¿ç¨å¯ä»¥è·åè¯¥éï¼å¶å®è·åè¯¥éççº¿ç¨ä¼è¢«é»å¡èè¢«æ¾å¥è¯¥éçé»å¡éåéé¢ã\n\n\n# ReentrantLock å®ç°åç\n\n * RenentrantLockå®ç°äºLockæ¥å£ï¼Lockæ¥å£æä¾äºéçéç¨api,æ¯å¦å élockï¼è§£éunlockç­æä½ã\n * RenentrantLockåºå±å éæ¯éè¿AQSå®ç°çï¼ä¸¤ä¸ªåé¨ç±»FairSyncæå¡äºå¬å¹³éï¼NofaireSyncæå¡äºéå¬å¹³éçå®ç°ï¼ä»ä»¬ç»ä¸ç»§æ¿èªAQSã\n\n// ReentrantLock.Sync#initialTryLock\nabstract boolean initialTryLock();\n\n// ReentrantLock.Sync#lock\nfinal void lock() {\n  if (!initialTryLock())\n    acquire(1);\n}\n\n// ReentrantLock.FairSync#initialTryLock\nfinal boolean initialTryLock() {\n  Thread current = Thread.currentThread();\n  int c = getState();\n  if (c == 0) {\n    if (!hasQueuedThreads() && compareAndSetState(0, 1)) {\n      setExclusiveOwnerThread(current);\n      return true;\n    }\n  } else if (getExclusiveOwnerThread() == current) {\n    if (++c < 0) // overflow\n      throw new Error("Maximum lock count exceeded");\n    setState(c);\n    return true;\n  }\n  return false;\n}\n\n// ReentrantLock.NonfairSync#initialTryLock\nfinal boolean initialTryLock() {\n  Thread current = Thread.currentThread();\n  if (compareAndSetState(0, 1)) { // first attempt is unguarded\n    setExclusiveOwnerThread(current);\n    return true;\n  } else if (getExclusiveOwnerThread() == current) {\n    int c = getState() + 1;\n    if (c < 0) // overflow\n      throw new Error("Maximum lock count exceeded");\n    setState(c);\n    return true;\n  } else\n    return false;\n}\n\n\n\n// AbstractQueuedSynchronizer#acquire\npublic final void acquire(int arg) {\n  if (!tryAcquire(arg))\n    acquire(null, arg, false, false, false, 0L);\n}\n\n// ReentrantLock.FairSync#tryAcquire\n// Acquires only if thread is first waiter or empty\nprotected final boolean tryAcquire(int acquires) {\n  if (getState() == 0 && !hasQueuedPredecessors() &&\n      compareAndSetState(0, acquires)) {\n    setExclusiveOwnerThread(Thread.currentThread());\n    return true;\n  }\n  return false;\n}\n\n// ReentrantLock.NonFairSync#tryAcquire\n// Acquire for non-reentrant cases after initialTryLock prescreen\nprotected final boolean tryAcquire(int acquires) {\n  if (getState() == 0 && compareAndSetState(0, acquires)) {\n    setExclusiveOwnerThread(Thread.currentThread());\n    return true;\n  }\n  return false;\n}\n\n\n\n# å¬å¹³éåéå¬å¹³é\n\nå¬å¹³é FairSync\n\n * å¬å¹³éæ¯æå¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼çº¿ç¨ç´æ¥è¿å¥éåä¸­æéï¼éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨æè½è·å¾é\n\n * å¬å¹³éçä¼ç¹æ¯ç­å¾éççº¿ç¨ä¸ä¼é¥¿æ­»ãç¼ºç¹æ¯æ´ä½ååæçç¸å¯¹éå¬å¹³éè¦ä½ï¼ç­å¾éåä¸­é¤ç¬¬ä¸ä¸ªçº¿ç¨ä»¥å¤çææçº¿ç¨é½ä¼é»å¡ï¼CPU å¤éé»å¡çº¿ç¨çå¼éæ¯éå¬å¹³éå¤§\n\néå¬å¹³é NonfairSync ï¼é»è®¤ï¼\n\n * éå¬å¹³éæ¯å¤ä¸ªçº¿ç¨å éæ¶ç´æ¥å°è¯è·åéï¼è·åä¸å°æä¼å°ç­å¾éåçéå°¾ç­å¾ãä½å¦ææ­¤æ¶éåå¥½å¯ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨å¯ä»¥æ éé»å¡ç´æ¥è·åå°é\n * éå¬å¹³éçä¼ç¹æ¯å¯ä»¥åå°å¤èµ·çº¿ç¨çå¼éï¼æ´ä½çååæçé«ï¼å ä¸ºçº¿ç¨æå çä¸é»å¡ç´æ¥è·å¾éï¼CPU ä¸å¿å¤éææçº¿ç¨ãç¼ºç¹æ¯å¤äºç­å¾éåä¸­ççº¿ç¨å¯è½ä¼é¥¿æ­»ï¼æèç­å¾ä¹æä¼è·å¾é\n\n\n\néå¬å¹³éåå¬å¹³éçä¸¤å¤ä¸åï¼\n\n 1. éå¬å¹³éå¨è°ç¨ lock åï¼é¦åå°±ä¼è°ç¨ CAS è¿è¡ä¸æ¬¡æ¢éï¼å¦æè¿ä¸ªæ¶åæ°å·§éæ²¡æè¢«å ç¨ï¼é£ä¹ç´æ¥å°±è·åå°éè¿åäºã\n 2. éå¬å¹³éå¨ CAS å¤±è´¥åï¼åå¬å¹³éä¸æ ·é½ä¼è¿å¥å° tryAcquire æ¹æ³ï¼å¨ tryAcquire æ¹æ³ä¸­ï¼å¦æåç°éè¿ä¸ªæ¶åè¢«éæ¾äºï¼state == 0ï¼ï¼éå¬å¹³éä¼ç´æ¥ CAS æ¢éï¼ä½æ¯å¬å¹³éä¼å¤æ­ç­å¾éåæ¯å¦æçº¿ç¨å¤äºç­å¾ç¶æï¼å¦ææåä¸å»æ¢éï¼ä¹ä¹æå°åé¢ã\n\nå¬å¹³éåéå¬å¹³éå°±è¿ä¸¤ç¹åºå«ï¼å¦æä¸¤æ¬¡ CAS é½ä¸æåï¼é£ä¹åé¢éå¬å¹³éåå¬å¹³éæ¯ä¸æ ·çï¼é½è¦è¿å¥å°é»å¡éåç­å¾å¤éã\n\nç¸å¯¹æ¥è¯´ï¼éå¬å¹³éä¼ææ´å¥½çæ§è½ï¼å ä¸ºå®çååéæ¯è¾å¤§ãå½ç¶ï¼éå¬å¹³éè®©è·åéçæ¶é´åå¾æ´å ä¸ç¡®å®ï¼å¯è½ä¼å¯¼è´å¨é»å¡éåä¸­ççº¿ç¨é¿æå¤äºé¥¥é¥¿ç¶æã\n\n\n# åè\n\n * å¾è§£ReentrantLockå¬å¹³éåéå¬å¹³éå®ç°åç\n * ',normalizedContent:'reentrantlock æ¯å¯éå¥çç¬å éï¼åªè½æä¸ä¸ªçº¿ç¨å¯ä»¥è·åè¯¥éï¼å¶å®è·åè¯¥éççº¿ç¨ä¼è¢«é»å¡èè¢«æ¾å¥è¯¥éçé»å¡éåéé¢ã\n\n\n# reentrantlock å®ç°åç\n\n * renentrantlockå®ç°äºlockæ¥å£ï¼lockæ¥å£æä¾äºéçéç¨api,æ¯å¦å élockï¼è§£éunlockç­æä½ã\n * renentrantlockåºå±å éæ¯éè¿aqså®ç°çï¼ä¸¤ä¸ªåé¨ç±»fairsyncæå¡äºå¬å¹³éï¼nofairesyncæå¡äºéå¬å¹³éçå®ç°ï¼ä»ä»¬ç»ä¸ç»§æ¿èªaqsã\n\n// reentrantlock.sync#initialtrylock\nabstract boolean initialtrylock();\n\n// reentrantlock.sync#lock\nfinal void lock() {\n  if (!initialtrylock())\n    acquire(1);\n}\n\n// reentrantlock.fairsync#initialtrylock\nfinal boolean initialtrylock() {\n  thread current = thread.currentthread();\n  int c = getstate();\n  if (c == 0) {\n    if (!hasqueuedthreads() && compareandsetstate(0, 1)) {\n      setexclusiveownerthread(current);\n      return true;\n    }\n  } else if (getexclusiveownerthread() == current) {\n    if (++c < 0) // overflow\n      throw new error("maximum lock count exceeded");\n    setstate(c);\n    return true;\n  }\n  return false;\n}\n\n// reentrantlock.nonfairsync#initialtrylock\nfinal boolean initialtrylock() {\n  thread current = thread.currentthread();\n  if (compareandsetstate(0, 1)) { // first attempt is unguarded\n    setexclusiveownerthread(current);\n    return true;\n  } else if (getexclusiveownerthread() == current) {\n    int c = getstate() + 1;\n    if (c < 0) // overflow\n      throw new error("maximum lock count exceeded");\n    setstate(c);\n    return true;\n  } else\n    return false;\n}\n\n\n\n// abstractqueuedsynchronizer#acquire\npublic final void acquire(int arg) {\n  if (!tryacquire(arg))\n    acquire(null, arg, false, false, false, 0l);\n}\n\n// reentrantlock.fairsync#tryacquire\n// acquires only if thread is first waiter or empty\nprotected final boolean tryacquire(int acquires) {\n  if (getstate() == 0 && !hasqueuedpredecessors() &&\n      compareandsetstate(0, acquires)) {\n    setexclusiveownerthread(thread.currentthread());\n    return true;\n  }\n  return false;\n}\n\n// reentrantlock.nonfairsync#tryacquire\n// acquire for non-reentrant cases after initialtrylock prescreen\nprotected final boolean tryacquire(int acquires) {\n  if (getstate() == 0 && compareandsetstate(0, acquires)) {\n    setexclusiveownerthread(thread.currentthread());\n    return true;\n  }\n  return false;\n}\n\n\n\n# å¬å¹³éåéå¬å¹³é\n\nå¬å¹³é fairsync\n\n * å¬å¹³éæ¯æå¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼çº¿ç¨ç´æ¥è¿å¥éåä¸­æéï¼éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨æè½è·å¾é\n\n * å¬å¹³éçä¼ç¹æ¯ç­å¾éççº¿ç¨ä¸ä¼é¥¿æ­»ãç¼ºç¹æ¯æ´ä½ååæçç¸å¯¹éå¬å¹³éè¦ä½ï¼ç­å¾éåä¸­é¤ç¬¬ä¸ä¸ªçº¿ç¨ä»¥å¤çææçº¿ç¨é½ä¼é»å¡ï¼cpu å¤éé»å¡çº¿ç¨çå¼éæ¯éå¬å¹³éå¤§\n\néå¬å¹³é nonfairsync ï¼é»è®¤ï¼\n\n * éå¬å¹³éæ¯å¤ä¸ªçº¿ç¨å éæ¶ç´æ¥å°è¯è·åéï¼è·åä¸å°æä¼å°ç­å¾éåçéå°¾ç­å¾ãä½å¦ææ­¤æ¶éåå¥½å¯ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨å¯ä»¥æ éé»å¡ç´æ¥è·åå°é\n * éå¬å¹³éçä¼ç¹æ¯å¯ä»¥åå°å¤èµ·çº¿ç¨çå¼éï¼æ´ä½çååæçé«ï¼å ä¸ºçº¿ç¨æå çä¸é»å¡ç´æ¥è·å¾éï¼cpu ä¸å¿å¤éææçº¿ç¨ãç¼ºç¹æ¯å¤äºç­å¾éåä¸­ççº¿ç¨å¯è½ä¼é¥¿æ­»ï¼æèç­å¾ä¹æä¼è·å¾é\n\n\n\néå¬å¹³éåå¬å¹³éçä¸¤å¤ä¸åï¼\n\n 1. éå¬å¹³éå¨è°ç¨ lock åï¼é¦åå°±ä¼è°ç¨ cas è¿è¡ä¸æ¬¡æ¢éï¼å¦æè¿ä¸ªæ¶åæ°å·§éæ²¡æè¢«å ç¨ï¼é£ä¹ç´æ¥å°±è·åå°éè¿åäºã\n 2. éå¬å¹³éå¨ cas å¤±è´¥åï¼åå¬å¹³éä¸æ ·é½ä¼è¿å¥å° tryacquire æ¹æ³ï¼å¨ tryacquire æ¹æ³ä¸­ï¼å¦æåç°éè¿ä¸ªæ¶åè¢«éæ¾äºï¼state == 0ï¼ï¼éå¬å¹³éä¼ç´æ¥ cas æ¢éï¼ä½æ¯å¬å¹³éä¼å¤æ­ç­å¾éåæ¯å¦æçº¿ç¨å¤äºç­å¾ç¶æï¼å¦ææåä¸å»æ¢éï¼ä¹ä¹æå°åé¢ã\n\nå¬å¹³éåéå¬å¹³éå°±è¿ä¸¤ç¹åºå«ï¼å¦æä¸¤æ¬¡ cas é½ä¸æåï¼é£ä¹åé¢éå¬å¹³éåå¬å¹³éæ¯ä¸æ ·çï¼é½è¦è¿å¥å°é»å¡éåç­å¾å¤éã\n\nç¸å¯¹æ¥è¯´ï¼éå¬å¹³éä¼ææ´å¥½çæ§è½ï¼å ä¸ºå®çååéæ¯è¾å¤§ãå½ç¶ï¼éå¬å¹³éè®©è·åéçæ¶é´åå¾æ´å ä¸ç¡®å®ï¼å¯è½ä¼å¯¼è´å¨é»å¡éåä¸­ççº¿ç¨é¿æå¤äºé¥¥é¥¿ç¶æã\n\n\n# åè\n\n * å¾è§£reentrantlockå¬å¹³éåéå¬å¹³éå®ç°åç\n * ',charsets:{cjk:!0}},{title:"ConcurrentHashMap",frontmatter:{title:"ConcurrentHashMap",date:"2023-03-30T17:31:10.000Z",permalink:"/pages/019d22/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/04.ConcurrentHashMap.html",relativePath:"01.Java/04.Javaå¹¶å/04.ConcurrentHashMap.md",key:"v-08c71366",path:"/pages/019d22/",headers:[{level:2,title:"å¯¹æ¯æ»ç»",slug:"å¯¹æ¯æ»ç»",normalizedTitle:"å¯¹æ¯æ»ç»",charIndex:2},{level:2,title:"JDK 1.5 ï½ 1.7 ConcurrentHashMap çå®ç°",slug:"jdk-1-5-1-7-concurrenthashmap-çå®ç°",normalizedTitle:"jdk 1.5 ï½ 1.7 concurrenthashmap çå®ç°",charIndex:153},{level:3,title:"get",slug:"get",normalizedTitle:"get",charIndex:419},{level:3,title:"put",slug:"put",normalizedTitle:"put",charIndex:42},{level:2,title:"JDK 1.8 ConcurrentHashMap çå®ç°",slug:"jdk-1-8-concurrenthashmap-çå®ç°",normalizedTitle:"jdk 1.8 concurrenthashmap çå®ç°",charIndex:723},{level:3,title:"get",slug:"get-2",normalizedTitle:"get",charIndex:419},{level:3,title:"put",slug:"put-2",normalizedTitle:"put",charIndex:42},{level:2,title:"CAS",slug:"cas",normalizedTitle:"cas",charIndex:126},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1942}],headersStr:"å¯¹æ¯æ»ç» JDK 1.5 ï½ 1.7 ConcurrentHashMap çå®ç° get put JDK 1.8 ConcurrentHashMap çå®ç° get put CAS åè",content:"# å¯¹æ¯æ»ç»\n\n * HashTable : ä½¿ç¨äºsynchronizedå³é®å­å¯¹putç­æä½è¿è¡å é;\n * ConcurrentHashMap JDK1.7: ä½¿ç¨åæ®µéæºå¶å®ç°;\n * ConcurrentHashMap JDK1.8: åä½¿ç¨CAS + synchronized å®ç°;\n\n\n# JDK 1.5 ï½ 1.7 ConcurrentHashMap çå®ç°\n\nJavaä½¿ç¨äºåæ®µéæºå¶å®ç°ConcurrentHashMapãå¶æå¤§å¹¶ååº¦åSegmentçä¸ªæ°éå¶ãé»è®¤æ¯æ16ä¸ª segmentï¼ä¸åå§ååä¸å¯æ©å®¹ã\n\nConcurrentHashMapå¨å¯¹è±¡ä¸­ä¿å­äºä¸ä¸ªSegmentæ°ç»ï¼å³å°æ´ä¸ªHashè¡¨ååä¸ºå¤ä¸ªåæ®µï¼èæ¯ä¸ªSegmentåç´ ï¼å³æ¯ä¸ªåæ®µåç±»ä¼¼äºä¸ä¸ªHashtableï¼è¿æ ·ï¼å¨æ§è¡putæä½æ¶é¦åæ ¹æ®hashç®æ³å®ä½å°åç´ å±äºåªä¸ªSegmentï¼ç¶åå¯¹è¯¥Segmentå éå³å¯ã\n\n\n\n\n# get\n\n 1. ä¸ºè¾å¥çKeyåHashè¿ç®ï¼å¾å°hashå¼ã\n 2. éè¿hashå¼ï¼å®ä½å°å¯¹åºçSegmentå¯¹è±¡\n 3. åæ¬¡éè¿hashå¼ï¼å®ä½å°Segmentå½ä¸­æ°ç»çå·ä½ä½ç½®ã\n\n\n# put\n\n 1. ä¸ºè¾å¥çKeyåHashè¿ç®ï¼å¾å°hashå¼ã\n 2. éè¿hashå¼ï¼å®ä½å°å¯¹åºçSegmentå¯¹è±¡\n 3. è°ç¨ reentrantLock.tryLock() æ¹æ³å°è¯è·åéãè·åå¤±è´¥çè¯ï¼èªæåæ¬¡è·åwhile(!tryLock()) {}\n 4. åæ¬¡éè¿hashå¼ï¼å®ä½å°Segmentå½ä¸­æ°ç»çå·ä½ä½ç½®ã\n 5. æå¥æè¦çHashEntryå¯¹è±¡ã\n 6. éæ¾éã\n\n\n# JDK 1.8 ConcurrentHashMap çå®ç°\n\nä½¿ç¨CAS + synchronized å®ç°ã\n\n\n\n\n# get\n\n 1. è®¡ç® hash å¼\n 2. æ ¹æ® hash å¼æ¾å°æ°ç»å¯¹åºä½ç½®: (n - 1) & h\n 3. æ ¹æ®è¯¥ä½ç½®å¤ç»ç¹æ§è´¨è¿è¡ç¸åºæ¥æ¾\n\n * å¦æè¯¥ä½ç½®ä¸º nullï¼é£ä¹ç´æ¥è¿å null å°±å¯ä»¥äº\n * å¦æè¯¥ä½ç½®å¤çèç¹åå¥½å°±æ¯æä»¬éè¦çï¼è¿åè¯¥èç¹çå¼å³å¯\n * å¦æè¯¥ä½ç½®èç¹ç hash å¼å°äº 0ï¼è¯´ææ­£å¨æ©å®¹ï¼æèæ¯çº¢é»æ \n * å¦æä»¥ä¸ 3 æ¡é½ä¸æ»¡è¶³ï¼é£å°±æ¯é¾è¡¨ï¼è¿è¡éåæ¯å¯¹å³å¯\n\n\n# put\n\n 1. é¦åä¼å¤æ­ keyãvalueæ¯å¦ä¸ºç©ºï¼å¦æä¸ºç©ºå°±æå¼å¸¸ï¼\n 2. æ¥çä¼å¤æ­å®¹å¨æ°ç»æ¯å¦ä¸ºç©ºï¼å¦æä¸ºç©ºå°±åå§åæ°ç»ï¼\n 3. è·å hash å¼å¯¹åºçæ°ç»ä¸æ ï¼å¾å°å¤´èç¹ fã\n    1. å¦æ f ä¸ºç©ºï¼ä»£è¡¨å½åæ°ç»ä¸æ æ¯å¦ç¬¬ä¸æ¬¡æå¥ï¼å¦ææ¯å°±éè¿ CAS æ¹å¼æå¥ï¼å¦æ CAS å¤±è´¥ï¼ä»£è¡¨æå¹¶åæä½ï¼å¾ªç¯éè¯ã\n    2. å¦æ f ç hash ç­äº MOVEDï¼è¡¨ç¤ºæå¶å®çº¿ç¨æ­£å¨æ©å®¹ï¼åä¸èµ·è¿è¡æ©å®¹æä½ï¼å¸®å©æ°æ®è¿ç§»ï¼ã\n    3. å¶ä»çæåµï¼å³å¦æå¤´èç¹ f ä¸ä¸ºç©ºï¼è·åæ°ç»è¯¥ä½ç½®çå¤´èç¹ççè§å¨é synchronized(f) {}ï¼ææ°çNodeèç¹æé¾è¡¨æçº¢é»æ çæ¹å¼æå¥å°åéçä½ç½®ï¼\n 4. èç¹æå¥å®æä¹åï¼æ¥çå¤æ­é¾è¡¨é¿åº¦æ¯å¦è¶è¿8ï¼å¦æè¶è¿8ä¸ªï¼å°±å°é¾è¡¨è½¬åä¸ºçº¢é»æ ç»æï¼\n 5. æåï¼æå¥å®æä¹åï¼è¿è¡æ©å®¹å¤æ­ã\n\nå¶ä»ç»è\n\n * æ©å®¹: tryPresize\n * æ°æ®è¿ç§»: transfer\n\n\n# CAS\n\ncompare-and-swapãCASéè¦æ3ä¸ªæä½æ°ï¼åå­å°åVï¼æ§çé¢æå¼Aï¼å³å°è¦æ´æ°çç®æ å¼Bã\n\nCASæä»¤æ§è¡æ¶ï¼å½ä¸ä»å½åå­å°åVçå¼ä¸é¢æå¼Aç¸ç­æ¶ï¼å°åå­å°åVçå¼ä¿®æ¹ä¸º B ï¼å¹¶è¿å true ï¼å¦åå°±ä»ä¹é½ä¸åï¼å¹¶è¿å falseãæ´ä¸ªæ¯è¾å¹¶æ¿æ¢çæä½æ¯ä¸ä¸ªåå­æä½ã\n\nJava ä¸­ CAS çå®ç°æ¯è°ç¨äº Unsafe çæ¹æ³ã sun.misc.Unsafe ç±»ï¼å®å¯ä»¥æä¾ç¡¬ä»¶çº§å«çåå­æä½ï¼å®å¯ä»¥è·åæä¸ªå±æ§å¨åå­ä¸­çä½ç½®ï¼ä¹å¯ä»¥ä¿®æ¹å¯¹è±¡çå­æ®µå¼ï¼åªä¸è¿è¯¥ç±»å¯¹ä¸è¬å¼åèè¨ï¼å¾å°ä¼ç¨å°ï¼å¶åºå±æ¯ç¨ C/C++ å®ç°çï¼æä»¥å®çæ¹å¼é½æ¯è¢« native å³é®å­ä¿®é¥°è¿çã\n\nCASè½ç¶å¾é«æçè§£å³äºåå­æä½é®é¢ï¼ä½æ¯CASä»ç¶å­å¨ä¸å¤§é®é¢ã\n\n 1. å¾ªç¯æ¶é´é¿å¼éå¾å¤§ï¼ä¸è¬å¦æCASå¤±è´¥ï¼ä¼ä¸ç´è¿è¡å°è¯ãå¦æCASé¿æ¶é´ä¸ç´ä¸æåï¼å¯è½ä¼ç»CPUå¸¦æ¥å¾å¤§çå¼éã\n 2. åªè½ä¿è¯ä¸ä¸ªå±äº«åéçåå­æä½ã\n 3. ABAé®é¢ï¼Javaæä¾äºä¸ä¸ªå¸¦ææ è®°çåå­å¼ç¨ç±» AtomicStampedReferenceï¼å®å¯ä»¥éè¿æ§å¶åéå¼ççæ¬æ¥ä¿è¯CASçæ­£ç¡®æ§ã\n\n\n# åè\n\n * https://pdai.tech/md/java/thread/java-thread-x-juc-collection-ConcurrentHashMap.html#concurrenthashmap-jdk-1-8\n * https://juejin.cn/post/7064061605185028110#heading-13",normalizedContent:"# å¯¹æ¯æ»ç»\n\n * hashtable : ä½¿ç¨äºsynchronizedå³é®å­å¯¹putç­æä½è¿è¡å é;\n * concurrenthashmap jdk1.7: ä½¿ç¨åæ®µéæºå¶å®ç°;\n * concurrenthashmap jdk1.8: åä½¿ç¨cas + synchronized å®ç°;\n\n\n# jdk 1.5 ï½ 1.7 concurrenthashmap çå®ç°\n\njavaä½¿ç¨äºåæ®µéæºå¶å®ç°concurrenthashmapãå¶æå¤§å¹¶ååº¦åsegmentçä¸ªæ°éå¶ãé»è®¤æ¯æ16ä¸ª segmentï¼ä¸åå§ååä¸å¯æ©å®¹ã\n\nconcurrenthashmapå¨å¯¹è±¡ä¸­ä¿å­äºä¸ä¸ªsegmentæ°ç»ï¼å³å°æ´ä¸ªhashè¡¨ååä¸ºå¤ä¸ªåæ®µï¼èæ¯ä¸ªsegmentåç´ ï¼å³æ¯ä¸ªåæ®µåç±»ä¼¼äºä¸ä¸ªhashtableï¼è¿æ ·ï¼å¨æ§è¡putæä½æ¶é¦åæ ¹æ®hashç®æ³å®ä½å°åç´ å±äºåªä¸ªsegmentï¼ç¶åå¯¹è¯¥segmentå éå³å¯ã\n\n\n\n\n# get\n\n 1. ä¸ºè¾å¥çkeyåhashè¿ç®ï¼å¾å°hashå¼ã\n 2. éè¿hashå¼ï¼å®ä½å°å¯¹åºçsegmentå¯¹è±¡\n 3. åæ¬¡éè¿hashå¼ï¼å®ä½å°segmentå½ä¸­æ°ç»çå·ä½ä½ç½®ã\n\n\n# put\n\n 1. ä¸ºè¾å¥çkeyåhashè¿ç®ï¼å¾å°hashå¼ã\n 2. éè¿hashå¼ï¼å®ä½å°å¯¹åºçsegmentå¯¹è±¡\n 3. è°ç¨ reentrantlock.trylock() æ¹æ³å°è¯è·åéãè·åå¤±è´¥çè¯ï¼èªæåæ¬¡è·åwhile(!trylock()) {}\n 4. åæ¬¡éè¿hashå¼ï¼å®ä½å°segmentå½ä¸­æ°ç»çå·ä½ä½ç½®ã\n 5. æå¥æè¦çhashentryå¯¹è±¡ã\n 6. éæ¾éã\n\n\n# jdk 1.8 concurrenthashmap çå®ç°\n\nä½¿ç¨cas + synchronized å®ç°ã\n\n\n\n\n# get\n\n 1. è®¡ç® hash å¼\n 2. æ ¹æ® hash å¼æ¾å°æ°ç»å¯¹åºä½ç½®: (n - 1) & h\n 3. æ ¹æ®è¯¥ä½ç½®å¤ç»ç¹æ§è´¨è¿è¡ç¸åºæ¥æ¾\n\n * å¦æè¯¥ä½ç½®ä¸º nullï¼é£ä¹ç´æ¥è¿å null å°±å¯ä»¥äº\n * å¦æè¯¥ä½ç½®å¤çèç¹åå¥½å°±æ¯æä»¬éè¦çï¼è¿åè¯¥èç¹çå¼å³å¯\n * å¦æè¯¥ä½ç½®èç¹ç hash å¼å°äº 0ï¼è¯´ææ­£å¨æ©å®¹ï¼æèæ¯çº¢é»æ \n * å¦æä»¥ä¸ 3 æ¡é½ä¸æ»¡è¶³ï¼é£å°±æ¯é¾è¡¨ï¼è¿è¡éåæ¯å¯¹å³å¯\n\n\n# put\n\n 1. é¦åä¼å¤æ­ keyãvalueæ¯å¦ä¸ºç©ºï¼å¦æä¸ºç©ºå°±æå¼å¸¸ï¼\n 2. æ¥çä¼å¤æ­å®¹å¨æ°ç»æ¯å¦ä¸ºç©ºï¼å¦æä¸ºç©ºå°±åå§åæ°ç»ï¼\n 3. è·å hash å¼å¯¹åºçæ°ç»ä¸æ ï¼å¾å°å¤´èç¹ fã\n    1. å¦æ f ä¸ºç©ºï¼ä»£è¡¨å½åæ°ç»ä¸æ æ¯å¦ç¬¬ä¸æ¬¡æå¥ï¼å¦ææ¯å°±éè¿ cas æ¹å¼æå¥ï¼å¦æ cas å¤±è´¥ï¼ä»£è¡¨æå¹¶åæä½ï¼å¾ªç¯éè¯ã\n    2. å¦æ f ç hash ç­äº movedï¼è¡¨ç¤ºæå¶å®çº¿ç¨æ­£å¨æ©å®¹ï¼åä¸èµ·è¿è¡æ©å®¹æä½ï¼å¸®å©æ°æ®è¿ç§»ï¼ã\n    3. å¶ä»çæåµï¼å³å¦æå¤´èç¹ f ä¸ä¸ºç©ºï¼è·åæ°ç»è¯¥ä½ç½®çå¤´èç¹ççè§å¨é synchronized(f) {}ï¼ææ°çnodeèç¹æé¾è¡¨æçº¢é»æ çæ¹å¼æå¥å°åéçä½ç½®ï¼\n 4. èç¹æå¥å®æä¹åï¼æ¥çå¤æ­é¾è¡¨é¿åº¦æ¯å¦è¶è¿8ï¼å¦æè¶è¿8ä¸ªï¼å°±å°é¾è¡¨è½¬åä¸ºçº¢é»æ ç»æï¼\n 5. æåï¼æå¥å®æä¹åï¼è¿è¡æ©å®¹å¤æ­ã\n\nå¶ä»ç»è\n\n * æ©å®¹: trypresize\n * æ°æ®è¿ç§»: transfer\n\n\n# cas\n\ncompare-and-swapãcaséè¦æ3ä¸ªæä½æ°ï¼åå­å°åvï¼æ§çé¢æå¼aï¼å³å°è¦æ´æ°çç®æ å¼bã\n\ncasæä»¤æ§è¡æ¶ï¼å½ä¸ä»å½åå­å°åvçå¼ä¸é¢æå¼aç¸ç­æ¶ï¼å°åå­å°åvçå¼ä¿®æ¹ä¸º b ï¼å¹¶è¿å true ï¼å¦åå°±ä»ä¹é½ä¸åï¼å¹¶è¿å falseãæ´ä¸ªæ¯è¾å¹¶æ¿æ¢çæä½æ¯ä¸ä¸ªåå­æä½ã\n\njava ä¸­ cas çå®ç°æ¯è°ç¨äº unsafe çæ¹æ³ã sun.misc.unsafe ç±»ï¼å®å¯ä»¥æä¾ç¡¬ä»¶çº§å«çåå­æä½ï¼å®å¯ä»¥è·åæä¸ªå±æ§å¨åå­ä¸­çä½ç½®ï¼ä¹å¯ä»¥ä¿®æ¹å¯¹è±¡çå­æ®µå¼ï¼åªä¸è¿è¯¥ç±»å¯¹ä¸è¬å¼åèè¨ï¼å¾å°ä¼ç¨å°ï¼å¶åºå±æ¯ç¨ c/c++ å®ç°çï¼æä»¥å®çæ¹å¼é½æ¯è¢« native å³é®å­ä¿®é¥°è¿çã\n\ncasè½ç¶å¾é«æçè§£å³äºåå­æä½é®é¢ï¼ä½æ¯casä»ç¶å­å¨ä¸å¤§é®é¢ã\n\n 1. å¾ªç¯æ¶é´é¿å¼éå¾å¤§ï¼ä¸è¬å¦æcaså¤±è´¥ï¼ä¼ä¸ç´è¿è¡å°è¯ãå¦æcasé¿æ¶é´ä¸ç´ä¸æåï¼å¯è½ä¼ç»cpuå¸¦æ¥å¾å¤§çå¼éã\n 2. åªè½ä¿è¯ä¸ä¸ªå±äº«åéçåå­æä½ã\n 3. abaé®é¢ï¼javaæä¾äºä¸ä¸ªå¸¦ææ è®°çåå­å¼ç¨ç±» atomicstampedreferenceï¼å®å¯ä»¥éè¿æ§å¶åéå¼ççæ¬æ¥ä¿è¯casçæ­£ç¡®æ§ã\n\n\n# åè\n\n * https://pdai.tech/md/java/thread/java-thread-x-juc-collection-concurrenthashmap.html#concurrenthashmap-jdk-1-8\n * https://juejin.cn/post/7064061605185028110#heading-13",charsets:{cjk:!0}},{title:"ThreadPoolExecutor",frontmatter:{title:"ThreadPoolExecutor",date:"2023-03-30T17:32:00.000Z",permalink:"/pages/854033/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/05.ThreadPoolExecutor.html",relativePath:"01.Java/04.Javaå¹¶å/05.ThreadPoolExecutor.md",key:"v-8ae87632",path:"/pages/854033/",headers:[{level:2,title:"Javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éåï¼",slug:"javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éå",normalizedTitle:"javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éåï¼",charIndex:2},{level:2,title:"æ ¸å¿åæ°",slug:"æ ¸å¿åæ°",normalizedTitle:"æ ¸å¿åæ°",charIndex:369},{level:2,title:"é»å¡éå BlockingQueue",slug:"é»å¡éå-blockingqueue",normalizedTitle:"é»å¡éå blockingqueue",charIndex:758},{level:2,title:"æç»ç­ç¥",slug:"æç»ç­ç¥",normalizedTitle:"æç»ç­ç¥",charIndex:1184},{level:2,title:"threadFactory",slug:"threadfactory",normalizedTitle:"threadfactory",charIndex:674},{level:2,title:"æ§è¡è¿ç¨",slug:"æ§è¡è¿ç¨",normalizedTitle:"æ§è¡è¿ç¨",charIndex:1506},{level:2,title:"ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨Executorså»åå»º? æ¨èæ¹å¼æ¯ä»ä¹?",slug:"ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨executorså»åå»º-æ¨èæ¹å¼æ¯ä»ä¹",normalizedTitle:"ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨executorså»åå»º? æ¨èæ¹å¼æ¯ä»ä¹?",charIndex:1728},{level:2,title:"éç½®çº¿ç¨æ± éè¦èèå ç´ ",slug:"éç½®çº¿ç¨æ± éè¦èèå ç´ ",normalizedTitle:"éç½®çº¿ç¨æ± éè¦èèå ç´ ",charIndex:2085}],headersStr:"Javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éåï¼ æ ¸å¿åæ° é»å¡éå BlockingQueue æç»ç­ç¥ threadFactory æ§è¡è¿ç¨ ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨Executorså»åå»º? æ¨èæ¹å¼æ¯ä»ä¹? éç½®çº¿ç¨æ± éè¦èèå ç´ ",content:"# Javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éåï¼\n\n 1. èµæºå©ç¨çï¼ å¨å¤§å¤æ°æåµä¸ï¼çº¿ç¨çåå»ºåéæ¯é½æ¯è¾æè´µãå¦ææ¯ä¸ªæ°ä»»å¡é½ç«å³åå»ºä¸ä¸ªæ°çº¿ç¨ï¼è¿ä¼å¯¼è´é¢ç¹ççº¿ç¨åå»ºåéæ¯ï¼æµªè´¹ç³»ç»èµæºãéè¿å°ä»»å¡æ¾å¥é»å¡éåï¼å¯ä»¥å°ä»»å¡æéï¼ä»¥ä¾¿çº¿ç¨å¯ä»¥éç¨ï¼ä»èæ´ææå°å©ç¨èµæºã\n 2. æ§å¶å¹¶ååº¦ï¼ éè¿å°ä»»å¡æ¾å¥éåï¼çº¿ç¨æ± å¯ä»¥æ´å¥½å°æ§å¶å¹¶ååº¦ãçº¿ç¨æ± å¯ä»¥æ ¹æ®è´è½½åèµæºæåµæ¥å³å®æ¯å¦éè¦åå»ºæ°çº¿ç¨ï¼ä»¥ä¿æåéçå¹¶ååº¦ãè¿å¯ä»¥é²æ­¢ç³»ç»è¿è½½ï¼é¿ååå»ºè¿å¤ççº¿ç¨å¯¼è´æ§è½ä¸éæèµæºç«äºã\n 3. é¿åçº¿ç¨çç¸ï¼ å¦æä¸ä½¿ç¨é»å¡éåï¼å½æå¤§éä»»å¡åæ¶å°è¾¾æ¶ï¼ä¼å¯¼è´å¤§éçº¿ç¨åæ¶åå»ºï¼è¿å¯è½ä¼å¯¼è´ç³»ç»ççº¿ç¨æ°æ¥å§å¢å ï¼ä»èå¢å äºä¸ä¸æåæ¢çå¼éï¼çè³å¯è½å¯¼è´ç³»ç»å´©æºãéè¿ä½¿ç¨é»å¡éåï¼å¯ä»¥å¹³æ»å°å¤çä»»å¡ï¼é¿åçº¿ç¨çç¸ã\n\n\n# æ ¸å¿åæ°\n\npublic ThreadPoolExecutor(int corePoolSize,\n                              int maximumPoolSize,\n                              long keepAliveTime,\n                              TimeUnit unit,\n                              BlockingQueue<Runnable> workQueue,\n                              ThreadFactory threadFactory,\n                              RejectedExecutionHandler handler)\n\n\n\n# é»å¡éå BlockingQueue\n\nArrayBlockingQueue: åºäºæ°ç»ç»æçæçé»å¡éåï¼æFIFOæåºä»»å¡ï¼\n\nLinkedBlockingQueue: åºäºé¾è¡¨ç»æçé»å¡éåï¼æFIFOæåºä»»å¡ï¼ååééå¸¸è¦é«äºArrayBlockingQueueï¼\n\nSynchronousQueue: ä¸ä¸ªä¸å­å¨åç´ çé»å¡éåï¼æ¯ä¸ªæå¥æä½å¿é¡»ç­å°å¦ä¸ä¸ªçº¿ç¨è°ç¨ç§»é¤æä½ï¼å¦åæå¥æä½ä¸ç´å¤äºé»å¡ç¶æï¼ååééå¸¸è¦é«äºLinkedBlockingQueueï¼\n\nPriorityBlockingQueue: å·æä¼åçº§çæ çé»å¡éåï¼\n\nLinkedBlockingQueueæ¯ArrayBlockingQueueå¨æå¥å é¤èç¹æ§è½æ¹é¢æ´ä¼ï¼ä½æ¯äºèå¨put(), take()ä»»å¡çæ¶åéè¦å éï¼SynchronousQueueä½¿ç¨æ éç®æ³ï¼æ ¹æ®èç¹çç¶æå¤æ­æ§è¡ï¼èä¸éè¦ç¨å°éï¼å¶æ ¸å¿æ¯Transfer.transfer().\n\n\n# æç»ç­ç¥\n\nAbortPolicy: ç´æ¥æåºå¼å¸¸ï¼é»è®¤ç­ç¥ï¼\n\nCallerRunsPolicy: ç¨è°ç¨èæå¨ççº¿ç¨æ¥æ§è¡ä»»å¡ï¼\n\nDiscardOldestPolicy: ä¸¢å¼é»å¡éåä¸­æèçä»»å¡ï¼å°æ­¤ä»»å¡å å¥å°é»å¡éåä¸­ï¼\n\nDiscardPolicy: ç´æ¥ä¸¢å¼ä»»å¡ï¼\n\nä¹å¯ä»¥æ ¹æ®åºç¨åºæ¯å®ç°RejectedExecutionHandleræ¥å£ï¼èªå®ä¹é¥±åç­ç¥ï¼å¦è®°å½æ¥å¿ææä¹åå­å¨ä¸è½å¤ççä»»å¡ã\n\n\n# threadFactory\n\nthreadFactoryåå»ºçº¿ç¨çå·¥åï¼éè¿èªå®ä¹ççº¿ç¨å·¥åå¯ä»¥ç»æ¯ä¸ªæ°å»ºççº¿ç¨è®¾ç½®ä¸ä¸ªå·æè¯å«åº¦ççº¿ç¨åãé»è®¤ä¸ºExecutors.defaultThreadFactory()ã\n\n\n# æ§è¡è¿ç¨\n\n 1. çº¿ç¨æ± é¦åå½åè¿è¡ççº¿ç¨æ°éæ¯å¦å°äºcorePoolSizeãå¦ææ¯ï¼ååå»ºä¸ä¸ªæ°çå·¥ä½çº¿ç¨æ¥æ§è¡ä»»å¡ãå¦æé½å¨æ§è¡ä»»å¡ï¼åè¿å¥2.\n\n 2. å¤æ­BlockingQueueæ¯å¦å·²ç»æ»¡äºï¼åè¥è¿æ²¡ææ»¡ï¼åå°çº¿ç¨æ¾å¥BlockingQueueãå¦åè¿å¥3.\n\n 3. åå»ºä¸ä¸ªæ°çå·¥ä½çº¿ç¨ï¼å¦æä½¿å½åè¿è¡ççº¿ç¨æ°éè¶è¿maximumPoolSizeï¼åäº¤ç»RejectedExecutionHandleræ¥å¤çä»»å¡ã\n\n\n# ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨Executorså»åå»º? æ¨èæ¹å¼æ¯ä»ä¹?\n\nçº¿ç¨æ± ä¸åè®¸ä½¿ç¨Executorså»åå»ºï¼èæ¯éè¿ThreadPoolExecutorçæ¹å¼ï¼è¿æ ·çå¤çæ¹å¼è®©åçåå­¦æ´å æç¡®çº¿ç¨æ± çè¿è¡è§åï¼è§é¿èµæºèå°½çé£é©ã\n\nè¯´æï¼Executorsåä¸ªæ¹æ³çå¼ç«¯ï¼\n\n * newFixedThreadPoolånewSingleThreadExecutorï¼ä¸»è¦é®é¢æ¯å ç§¯çè¯·æ±å¤çéåï¼LinkedBlockingQueue<Runnable>çæ çéåï¼å¯è½ä¼èè´¹éå¸¸å¤§çåå­ï¼çè³OOMã\n * newCachedThreadPoolånewScheduledThreadPoolï¼ä¸»è¦é®é¢æ¯çº¿ç¨æ°æå¤§æ°æ¯Integer.MAX_VALUEï¼å¯è½ä¼åå»ºæ°ééå¸¸å¤ççº¿ç¨ï¼çè³OOMã\n\n\n# éç½®çº¿ç¨æ± éè¦èèå ç´ \n\nä»ä»»å¡çä¼åçº§ï¼ä»»å¡çæ§è¡æ¶é´é¿ç­ï¼ä»»å¡çæ§è´¨(CPUå¯é/ IOå¯é)ï¼ä»»å¡çä¾èµå³ç³»è¿åä¸ªè§åº¦æ¥åæãå¹¶ä¸è¿å¯è½å°ä½¿ç¨æççå·¥ä½éåã\n\næ§è´¨ä¸åçä»»å¡å¯ç¨ä½¿ç¨ä¸åè§æ¨¡ççº¿ç¨æ± åå¼å¤ç:\n\n * CPUå¯éå: å°½å¯è½å°ççº¿ç¨ï¼Ncpu+1\n * IOå¯éå: å°½å¯è½å¤ççº¿ç¨, Ncpu*2ï¼æ¯å¦æ°æ®åºè¿æ¥æ± \n * æ··åå: CPUå¯éåçä»»å¡ä¸IOå¯éåä»»å¡çæ§è¡æ¶é´å·®å«è¾å°ï¼å¦åæ²¡æå¿è¦æåã\n\nãå¾éªè¯ã\n\n 1. ä»»å¡çä¼åçº§ï¼ å¦æä½ çåºç¨ç¨åºä¸­æä¸åä¼åçº§çä»»å¡ï¼å¯ä»¥èèä½¿ç¨ThreadPoolExecutorçæé å½æ°ä¸­çThreadFactoryåæ°æ¥ä¸ºä¸åä¼åçº§çä»»å¡åéä¸åççº¿ç¨æ± ãè¿åè®¸ä½ ä¸ºé«ä¼åçº§çä»»å¡åéæ´å¤ççº¿ç¨èµæºï¼ä»¥ç¡®ä¿å®ä»¬è½å¤åæ¶æ§è¡ãæ­¤å¤ï¼ä½ è¿å¯ä»¥ä½¿ç¨ä¼åçº§éåæ¥ç®¡çä»»å¡çæ§è¡é¡ºåºï¼ç¡®ä¿é«ä¼åçº§ä»»å¡ä¼åæ§è¡ã\n 2. ä»»å¡çæ§è¡æ¶é´é¿ç­ï¼ å¦æä½ çåºç¨ç¨åºåå«æ§è¡æ¶é´é¿çä»»å¡ï¼å¯ä»¥èèè°æ´çº¿ç¨æ± çæ ¸å¿çº¿ç¨æ°åæå¤§çº¿ç¨æ°ãå¦ææ§è¡æ¶é´é¿çä»»å¡è¾å¤ï¼å¯è½éè¦å¢å çº¿ç¨æ± çæå¤§çº¿ç¨æ°ï¼ä»¥é²æ­¢ä»»å¡æéè¿é¿ãå¦å¤ï¼ä½ è¿å¯ä»¥ä½¿ç¨åéçä»»å¡æç»ç­ç¥æ¥å¤çæ§è¡æ¶é´è¿é¿çä»»å¡ï¼ä¾å¦CallerRunsPolicyï¼å®å¯ä»¥å°ä»»å¡å¨è°ç¨çº¿ç¨ä¸æ§è¡ï¼èä¸æ¯æ¾å¥éåç­å¾ã\n 3. ä»»å¡çæ§è´¨ï¼CPUå¯é/IOå¯éï¼ï¼ ä»»å¡çæ§è´¨å³å®äºçº¿ç¨æ± çç±»åãå¦æä»»å¡æ¯CPUå¯éåï¼å³å®ä»¬ä¸»è¦æ¶èCPUèµæºèä¸æ¶åå¤§éçIOæä½ï¼å¯ä»¥èèä½¿ç¨åºå®å¤§å°ççº¿ç¨æ± ï¼ä»¥ååå©ç¨CPUæ ¸å¿ãå¯¹äºIOå¯éåä»»å¡ï¼ä½ å¯ä»¥ä½¿ç¨å¯ç¼©æ¾ççº¿ç¨æ± ï¼åè®¸æ ¹æ®éæ±èªå¨è°æ´çº¿ç¨æ°ï¼ä»¥æå¤§ç¨åº¦å°å©ç¨IOç­å¾æ¶é´ã\n 4. ä»»å¡çä¾èµå³ç³»ï¼ å¦æä»»å¡ä¹é´å­å¨ä¾èµå³ç³»ï¼éè¦ç¡®ä¿çº¿ç¨æ± è½å¤æ­£ç¡®å¤çè¿äºä¾èµå³ç³»ãä½ å¯ä»¥ä½¿ç¨ExecutorCompletionServiceæ¥ç­å¾ä»»å¡çå®æï¼å¹¶æç§å®ä»¬çå®æé¡ºåºå¤çç»æãå¦å¤ï¼å¦æä»»å¡ä¹é´å­å¨ä¾èµå³ç³»ï¼è¦ç¡®ä¿çº¿ç¨æ± ççº¿ç¨æ°è¶³å¤å¤§ï¼ä»¥é¿åç±äºç­å¾ä¾èµä»»å¡èå¯¼è´çæ§è½ä¸éã",normalizedContent:"# javaçº¿ç¨æ± ä¸ºä»ä¹ä¸è®¾è®¡æåæ©å¤§çº¿ç¨æ°åå å¥é»å¡éåï¼\n\n 1. èµæºå©ç¨çï¼ å¨å¤§å¤æ°æåµä¸ï¼çº¿ç¨çåå»ºåéæ¯é½æ¯è¾æè´µãå¦ææ¯ä¸ªæ°ä»»å¡é½ç«å³åå»ºä¸ä¸ªæ°çº¿ç¨ï¼è¿ä¼å¯¼è´é¢ç¹ççº¿ç¨åå»ºåéæ¯ï¼æµªè´¹ç³»ç»èµæºãéè¿å°ä»»å¡æ¾å¥é»å¡éåï¼å¯ä»¥å°ä»»å¡æéï¼ä»¥ä¾¿çº¿ç¨å¯ä»¥éç¨ï¼ä»èæ´ææå°å©ç¨èµæºã\n 2. æ§å¶å¹¶ååº¦ï¼ éè¿å°ä»»å¡æ¾å¥éåï¼çº¿ç¨æ± å¯ä»¥æ´å¥½å°æ§å¶å¹¶ååº¦ãçº¿ç¨æ± å¯ä»¥æ ¹æ®è´è½½åèµæºæåµæ¥å³å®æ¯å¦éè¦åå»ºæ°çº¿ç¨ï¼ä»¥ä¿æåéçå¹¶ååº¦ãè¿å¯ä»¥é²æ­¢ç³»ç»è¿è½½ï¼é¿ååå»ºè¿å¤ççº¿ç¨å¯¼è´æ§è½ä¸éæèµæºç«äºã\n 3. é¿åçº¿ç¨çç¸ï¼ å¦æä¸ä½¿ç¨é»å¡éåï¼å½æå¤§éä»»å¡åæ¶å°è¾¾æ¶ï¼ä¼å¯¼è´å¤§éçº¿ç¨åæ¶åå»ºï¼è¿å¯è½ä¼å¯¼è´ç³»ç»ççº¿ç¨æ°æ¥å§å¢å ï¼ä»èå¢å äºä¸ä¸æåæ¢çå¼éï¼çè³å¯è½å¯¼è´ç³»ç»å´©æºãéè¿ä½¿ç¨é»å¡éåï¼å¯ä»¥å¹³æ»å°å¤çä»»å¡ï¼é¿åçº¿ç¨çç¸ã\n\n\n# æ ¸å¿åæ°\n\npublic threadpoolexecutor(int corepoolsize,\n                              int maximumpoolsize,\n                              long keepalivetime,\n                              timeunit unit,\n                              blockingqueue<runnable> workqueue,\n                              threadfactory threadfactory,\n                              rejectedexecutionhandler handler)\n\n\n\n# é»å¡éå blockingqueue\n\narrayblockingqueue: åºäºæ°ç»ç»æçæçé»å¡éåï¼æfifoæåºä»»å¡ï¼\n\nlinkedblockingqueue: åºäºé¾è¡¨ç»æçé»å¡éåï¼æfifoæåºä»»å¡ï¼ååééå¸¸è¦é«äºarrayblockingqueueï¼\n\nsynchronousqueue: ä¸ä¸ªä¸å­å¨åç´ çé»å¡éåï¼æ¯ä¸ªæå¥æä½å¿é¡»ç­å°å¦ä¸ä¸ªçº¿ç¨è°ç¨ç§»é¤æä½ï¼å¦åæå¥æä½ä¸ç´å¤äºé»å¡ç¶æï¼ååééå¸¸è¦é«äºlinkedblockingqueueï¼\n\npriorityblockingqueue: å·æä¼åçº§çæ çé»å¡éåï¼\n\nlinkedblockingqueueæ¯arrayblockingqueueå¨æå¥å é¤èç¹æ§è½æ¹é¢æ´ä¼ï¼ä½æ¯äºèå¨put(), take()ä»»å¡çæ¶åéè¦å éï¼synchronousqueueä½¿ç¨æ éç®æ³ï¼æ ¹æ®èç¹çç¶æå¤æ­æ§è¡ï¼èä¸éè¦ç¨å°éï¼å¶æ ¸å¿æ¯transfer.transfer().\n\n\n# æç»ç­ç¥\n\nabortpolicy: ç´æ¥æåºå¼å¸¸ï¼é»è®¤ç­ç¥ï¼\n\ncallerrunspolicy: ç¨è°ç¨èæå¨ççº¿ç¨æ¥æ§è¡ä»»å¡ï¼\n\ndiscardoldestpolicy: ä¸¢å¼é»å¡éåä¸­æèçä»»å¡ï¼å°æ­¤ä»»å¡å å¥å°é»å¡éåä¸­ï¼\n\ndiscardpolicy: ç´æ¥ä¸¢å¼ä»»å¡ï¼\n\nä¹å¯ä»¥æ ¹æ®åºç¨åºæ¯å®ç°rejectedexecutionhandleræ¥å£ï¼èªå®ä¹é¥±åç­ç¥ï¼å¦è®°å½æ¥å¿ææä¹åå­å¨ä¸è½å¤ççä»»å¡ã\n\n\n# threadfactory\n\nthreadfactoryåå»ºçº¿ç¨çå·¥åï¼éè¿èªå®ä¹ççº¿ç¨å·¥åå¯ä»¥ç»æ¯ä¸ªæ°å»ºççº¿ç¨è®¾ç½®ä¸ä¸ªå·æè¯å«åº¦ççº¿ç¨åãé»è®¤ä¸ºexecutors.defaultthreadfactory()ã\n\n\n# æ§è¡è¿ç¨\n\n 1. çº¿ç¨æ± é¦åå½åè¿è¡ççº¿ç¨æ°éæ¯å¦å°äºcorepoolsizeãå¦ææ¯ï¼ååå»ºä¸ä¸ªæ°çå·¥ä½çº¿ç¨æ¥æ§è¡ä»»å¡ãå¦æé½å¨æ§è¡ä»»å¡ï¼åè¿å¥2.\n\n 2. å¤æ­blockingqueueæ¯å¦å·²ç»æ»¡äºï¼åè¥è¿æ²¡ææ»¡ï¼åå°çº¿ç¨æ¾å¥blockingqueueãå¦åè¿å¥3.\n\n 3. åå»ºä¸ä¸ªæ°çå·¥ä½çº¿ç¨ï¼å¦æä½¿å½åè¿è¡ççº¿ç¨æ°éè¶è¿maximumpoolsizeï¼åäº¤ç»rejectedexecutionhandleræ¥å¤çä»»å¡ã\n\n\n# ä¸ºä»ä¹çº¿ç¨æ± ä¸åè®¸ä½¿ç¨executorså»åå»º? æ¨èæ¹å¼æ¯ä»ä¹?\n\nçº¿ç¨æ± ä¸åè®¸ä½¿ç¨executorså»åå»ºï¼èæ¯éè¿threadpoolexecutorçæ¹å¼ï¼è¿æ ·çå¤çæ¹å¼è®©åçåå­¦æ´å æç¡®çº¿ç¨æ± çè¿è¡è§åï¼è§é¿èµæºèå°½çé£é©ã\n\nè¯´æï¼executorsåä¸ªæ¹æ³çå¼ç«¯ï¼\n\n * newfixedthreadpoolånewsinglethreadexecutorï¼ä¸»è¦é®é¢æ¯å ç§¯çè¯·æ±å¤çéåï¼linkedblockingqueue<runnable>çæ çéåï¼å¯è½ä¼èè´¹éå¸¸å¤§çåå­ï¼çè³oomã\n * newcachedthreadpoolånewscheduledthreadpoolï¼ä¸»è¦é®é¢æ¯çº¿ç¨æ°æå¤§æ°æ¯integer.max_valueï¼å¯è½ä¼åå»ºæ°ééå¸¸å¤ççº¿ç¨ï¼çè³oomã\n\n\n# éç½®çº¿ç¨æ± éè¦èèå ç´ \n\nä»ä»»å¡çä¼åçº§ï¼ä»»å¡çæ§è¡æ¶é´é¿ç­ï¼ä»»å¡çæ§è´¨(cpuå¯é/ ioå¯é)ï¼ä»»å¡çä¾èµå³ç³»è¿åä¸ªè§åº¦æ¥åæãå¹¶ä¸è¿å¯è½å°ä½¿ç¨æççå·¥ä½éåã\n\næ§è´¨ä¸åçä»»å¡å¯ç¨ä½¿ç¨ä¸åè§æ¨¡ççº¿ç¨æ± åå¼å¤ç:\n\n * cpuå¯éå: å°½å¯è½å°ççº¿ç¨ï¼ncpu+1\n * ioå¯éå: å°½å¯è½å¤ççº¿ç¨, ncpu*2ï¼æ¯å¦æ°æ®åºè¿æ¥æ± \n * æ··åå: cpuå¯éåçä»»å¡ä¸ioå¯éåä»»å¡çæ§è¡æ¶é´å·®å«è¾å°ï¼å¦åæ²¡æå¿è¦æåã\n\nãå¾éªè¯ã\n\n 1. ä»»å¡çä¼åçº§ï¼ å¦æä½ çåºç¨ç¨åºä¸­æä¸åä¼åçº§çä»»å¡ï¼å¯ä»¥èèä½¿ç¨threadpoolexecutorçæé å½æ°ä¸­çthreadfactoryåæ°æ¥ä¸ºä¸åä¼åçº§çä»»å¡åéä¸åççº¿ç¨æ± ãè¿åè®¸ä½ ä¸ºé«ä¼åçº§çä»»å¡åéæ´å¤ççº¿ç¨èµæºï¼ä»¥ç¡®ä¿å®ä»¬è½å¤åæ¶æ§è¡ãæ­¤å¤ï¼ä½ è¿å¯ä»¥ä½¿ç¨ä¼åçº§éåæ¥ç®¡çä»»å¡çæ§è¡é¡ºåºï¼ç¡®ä¿é«ä¼åçº§ä»»å¡ä¼åæ§è¡ã\n 2. ä»»å¡çæ§è¡æ¶é´é¿ç­ï¼ å¦æä½ çåºç¨ç¨åºåå«æ§è¡æ¶é´é¿çä»»å¡ï¼å¯ä»¥èèè°æ´çº¿ç¨æ± çæ ¸å¿çº¿ç¨æ°åæå¤§çº¿ç¨æ°ãå¦ææ§è¡æ¶é´é¿çä»»å¡è¾å¤ï¼å¯è½éè¦å¢å çº¿ç¨æ± çæå¤§çº¿ç¨æ°ï¼ä»¥é²æ­¢ä»»å¡æéè¿é¿ãå¦å¤ï¼ä½ è¿å¯ä»¥ä½¿ç¨åéçä»»å¡æç»ç­ç¥æ¥å¤çæ§è¡æ¶é´è¿é¿çä»»å¡ï¼ä¾å¦callerrunspolicyï¼å®å¯ä»¥å°ä»»å¡å¨è°ç¨çº¿ç¨ä¸æ§è¡ï¼èä¸æ¯æ¾å¥éåç­å¾ã\n 3. ä»»å¡çæ§è´¨ï¼cpuå¯é/ioå¯éï¼ï¼ ä»»å¡çæ§è´¨å³å®äºçº¿ç¨æ± çç±»åãå¦æä»»å¡æ¯cpuå¯éåï¼å³å®ä»¬ä¸»è¦æ¶ècpuèµæºèä¸æ¶åå¤§éçioæä½ï¼å¯ä»¥èèä½¿ç¨åºå®å¤§å°ççº¿ç¨æ± ï¼ä»¥ååå©ç¨cpuæ ¸å¿ãå¯¹äºioå¯éåä»»å¡ï¼ä½ å¯ä»¥ä½¿ç¨å¯ç¼©æ¾ççº¿ç¨æ± ï¼åè®¸æ ¹æ®éæ±èªå¨è°æ´çº¿ç¨æ°ï¼ä»¥æå¤§ç¨åº¦å°å©ç¨ioç­å¾æ¶é´ã\n 4. ä»»å¡çä¾èµå³ç³»ï¼ å¦æä»»å¡ä¹é´å­å¨ä¾èµå³ç³»ï¼éè¦ç¡®ä¿çº¿ç¨æ± è½å¤æ­£ç¡®å¤çè¿äºä¾èµå³ç³»ãä½ å¯ä»¥ä½¿ç¨executorcompletionserviceæ¥ç­å¾ä»»å¡çå®æï¼å¹¶æç§å®ä»¬çå®æé¡ºåºå¤çç»æãå¦å¤ï¼å¦æä»»å¡ä¹é´å­å¨ä¾èµå³ç³»ï¼è¦ç¡®ä¿çº¿ç¨æ± ççº¿ç¨æ°è¶³å¤å¤§ï¼ä»¥é¿åç±äºç­å¾ä¾èµä»»å¡èå¯¼è´çæ§è½ä¸éã",charsets:{cjk:!0}},{title:"Future & CompletableFuture",frontmatter:{title:"Future & CompletableFuture",date:"2023-03-31T17:13:50.000Z",permalink:"/pages/9862ed/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/06.Future%20&%20CompletableFuture.html",relativePath:"01.Java/04.Javaå¹¶å/06.Future & CompletableFuture.md",key:"v-567fbe26",path:"/pages/9862ed/",headers:[{level:2,title:"Future",slug:"future",normalizedTitle:"future",charIndex:2},{level:2,title:"Future å¸¸è§æä½",slug:"future-å¸¸è§æä½",normalizedTitle:"future å¸¸è§æä½",charIndex:449},{level:2,title:"Future æ¥å£æ¹æ³",slug:"future-æ¥å£æ¹æ³",normalizedTitle:"future æ¥å£æ¹æ³",charIndex:895},{level:2,title:"CompletableFuture",slug:"completablefuture",normalizedTitle:"completablefuture",charIndex:1095},{level:2,title:"CompletableFuture å¸¸è§æä½",slug:"completablefuture-å¸¸è§æä½",normalizedTitle:"completablefuture å¸¸è§æä½",charIndex:1632},{level:3,title:"åå»ºCompletableFuture",slug:"åå»ºcompletablefuture",normalizedTitle:"åå»ºcompletablefuture",charIndex:1659},{level:3,title:"å¤çå¼æ­¥ç»ç®çç»æ",slug:"å¤çå¼æ­¥ç»ç®çç»æ",normalizedTitle:"å¤çå¼æ­¥ç»ç®çç»æ",charIndex:2206},{level:3,title:"å¼å¸¸å¤ç",slug:"å¼å¸¸å¤ç",normalizedTitle:"å¼å¸¸å¤ç",charIndex:1598},{level:3,title:"ç»åCompletableFuture",slug:"ç»åcompletablefuture",normalizedTitle:"ç»åcompletablefuture",charIndex:2396},{level:3,title:"å¹¶è¡è¿è¡å¤ä¸ªCompletableFuture",slug:"å¹¶è¡è¿è¡å¤ä¸ªcompletablefuture",normalizedTitle:"å¹¶è¡è¿è¡å¤ä¸ªcompletablefuture",charIndex:2641},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:2800}],headersStr:"Future Future å¸¸è§æä½ Future æ¥å£æ¹æ³ CompletableFuture CompletableFuture å¸¸è§æä½ åå»ºCompletableFuture å¤çå¼æ­¥ç»ç®çç»æ å¼å¸¸å¤ç ç»åCompletableFuture å¹¶è¡è¿è¡å¤ä¸ªCompletableFuture åè",content:"# Future\n\nFuture æ¨¡å¼æ¯å¤çº¿ç¨å¼åä¸­éå¸¸å¸¸è§çä¸ç§è®¾è®¡æ¨¡å¼ï¼å®çæ ¸å¿ææ³æ¯å¼æ­¥è°ç¨ã\n\nå½æä»¬éè¦è°ç¨ä¸ä¸ªå½æ°æ¹æ³æ¶ï¼å¦æè¿ä¸ªå½æ°æ§è¡çå¾æ¢ï¼é£ä¹æä»¬å°±è¦è¿è¡ç­å¾ãä½ææ¶åï¼æä»¬å¯è½å¹¶ä¸æ¥äºè·åç»æãå æ­¤ï¼æä»¬å¯ä»¥è®©è¢«è°ç¨èç«å³è¿åï¼è®©å®å¨åå°æ¢æ¢å¤çè¿ä¸ªè¯·æ±ãå¯¹äºè°ç¨èæ¥è¯´ï¼åå¯ä»¥åå¤çä¸äºå¶ä»ä»»å¡ï¼å¨çæ­£éè¦æ°æ®çåºååå»å°è¯è·åéè¦çæ°æ®ã\n\nå¯¹ Future æ¨¡å¼æ¥è¯´ï¼è½ç¶å®æ æ³ç«å³ç»ä½ éè¦çæ°æ®ï¼ä½å®ä¼ç»ä½ ä¸ä¸ªå¥çº¦ï¼å°æ¥ä½ å¯ä»¥å­åè¿ä¸ªå¥çº¦å»éæ°è·åä½ éè¦çä¿¡æ¯ã\n\nè¿éæä»¬ä¸»è¦è°è®º JDK ä¸­ç Future æ¨¡å¼ï¼å³ java.util.concurrent åä¸ç Future æ¥å£ã\n\nRunnableFutre æ¥å£ï¼ç»§æ¿äº Future å Runnable ä¸¤ä¸ªæ¥å£ãå¶ä¸­run() æ¹æ³ç¨äºæé çå®çæ°æ®ã\n\nFutureTask ç±»ï¼ä¸ä¸ªå·ä½çå®ç°ç±»ãWaitNode æ¯å¶åé¨ç±»ã\n\n\n\nå¾ï¼Diagram for FutureTask\n\n\n# Future å¸¸è§æä½\n\nExecutorService executor = Executors.newFixedThreadPool(4); \n// å®ä¹ä»»å¡:\nCallable<String> task = new Task();\n// æäº¤ä»»å¡å¹¶è·å¾Future:\nFuture<String> future = executor.submit(task);\n// ä»Futureè·åå¼æ­¥æ§è¡è¿åçç»æ:\nString result = future.get(); // å¯è½é»å¡\n\n\næµç¨ï¼\n\n 1. å½æä»¬æäº¤ä¸ä¸ªCallableä»»å¡åï¼Runnable ä»»å¡æ²¡æè¿åå¼ï¼ï¼æä»¬ä¼åæ¶è·å¾ä¸ä¸ªFutureå¯¹è±¡ã\n\n 2. ç¶åï¼æä»¬å¨ä¸»çº¿ç¨æä¸ªæ¶å»è°ç¨Futureå¯¹è±¡çget()æ¹æ³ï¼å°±å¯ä»¥è·å¾å¼æ­¥æ§è¡çç»æã\n\n 3. å¨è°ç¨get()æ¶ï¼å¦æå¼æ­¥ä»»å¡å·²ç»å®æï¼æä»¬å°±ç´æ¥è·å¾ç»æã\n\n 4. å¦æå¼æ­¥ä»»å¡è¿æ²¡æå®æï¼é£ä¹get()ä¼é»å¡ï¼ç´å°ä»»å¡å®æåæè¿åç»æã\n\n\n# Future æ¥å£æ¹æ³\n\nä¸ä¸ªFuture<V>æ¥å£è¡¨ç¤ºä¸ä¸ªæªæ¥å¯è½ä¼è¿åçç»æï¼å®å®ä¹çæ¹æ³æï¼\n\n * get()ï¼è·åç»æï¼å¯è½ä¼ç­å¾ï¼\n * get(long timeout, TimeUnit unit)ï¼è·åç»æï¼ä½åªç­å¾æå®çæ¶é´ï¼\n * cancel(boolean mayInterruptIfRunning)ï¼åæ¶å½åä»»å¡ï¼\n * isDone()ï¼å¤æ­ä»»å¡æ¯å¦å·²å®æã\n\n\n# CompletableFuture\n\nCompletableFuture æ¯ Java8 æ°å¢çå·¥å·ç±»ï¼æ¯å¢å¼ºç Futureã\n\nCompletableFuture å®å®ç°äº Future æ¥å£ï¼è¿å®ç°äº CompletionStage æ¥å£ã\n\nCompletableFuture é¤äºæä¾äºæ´ä¸ºå¥½ç¨åå¼ºå¤§ç Future ç¹æ§ä¹å¤ï¼è¿æä¾äºå½æ°å¼ç¼ç¨çè½åã\n\npublic class CompletableFuture<T> implements Future<T>, CompletionStage<T> {\n}\n\n\nCompletionStage æ¥å£ä¹æ¯ Java8 æ°å¢çãèè¿ä¸ªæ¥å£éæå¤è¾¾40ç§æ¹æ³ï¼æ¯ä¸ºäºå½æ°å¼ç¼ç¨ä¸­çæµå¼è°ç¨åå¤çã\n\néè¿è¿ä¸ªæ¥å£ï¼æä»¬å¯ä»¥å¨ä¸ä¸ªæ§è¡ç»æä¸è¿è¡å¤æ¬¡æµå¼è°ç¨ã\n\nstage.thenApply(x -> square(x)).thenAccept(x -> System.out.print(x)).thenRun(() -> System.out.println)\n\n\nå¶åè½ï¼\n\n * å®æäºå°±éç¥\n * å¼æ­¥æ§è¡ä»»å¡\n * æµå¼è°ç¨\n * å¼å¸¸å¤ç\n * ç»åå¤ä¸ªCompletableFuture\n\n\n# CompletableFuture å¸¸è§æä½\n\n\n# åå»ºCompletableFuture\n\nå¸¸è§çåå»º CompletableFuture å¯¹è±¡çæ¹æ³å¦ä¸ï¼\n\n 1. éè¿ new å³é®å­ã\n 2. åºäº CompletableFuture èªå¸¦çéæå·¥åæ¹æ³ï¼runAsync() ãsupplyAsync() ã\n\nCompletableFuture<RpcResponse<Object>> resultFuture = new CompletableFuture<>();\n\nstatic <U> CompletableFuture<U> supplyAsync(Supplier<U> supplier);\n// ä½¿ç¨èªå®ä¹çº¿ç¨æ± (æ¨è)\nstatic <U> CompletableFuture<U> supplyAsync(Supplier<U> supplier, Executor executor);\nstatic CompletableFuture<Void> runAsync(Runnable runnable);\n// ä½¿ç¨èªå®ä¹çº¿ç¨æ± (æ¨è)\nstatic CompletableFuture<Void> runAsync(Runnable runnable, Executor executor);\n\n\n\n\n# å¤çå¼æ­¥ç»ç®çç»æ\n\nå½æä»¬è·åå°å¼æ­¥è®¡ç®çç»æä¹åï¼è¿å¯ä»¥å¯¹å¶è¿è¡è¿ä¸æ­¥çå¤çï¼æ¯è¾å¸¸ç¨çæ¹æ³æä¸é¢å ä¸ªï¼\n\n * thenApply()\n * thenAccept()\n * thenRun()\n * whenComplete()\n\n\n# å¼å¸¸å¤ç\n\n * handle()\n * exceptionally()\n * completeExceptionally()\n\n\n# ç»åCompletableFuture\n\n * thenCompose()\n * thenCombine()\n\nthenCompose() å thenCombine() æä»ä¹åºå«å¢ï¼\n\n * thenCompose() å¯ä»¥ä¸¤ä¸ª CompletableFuture å¯¹è±¡ï¼å¹¶å°åä¸ä¸ªä»»å¡çè¿åç»æä½ä¸ºä¸ä¸ä¸ªä»»å¡çåæ°ï¼å®ä»¬ä¹é´å­å¨çååé¡ºåºã\n * thenCombine() ä¼å¨ä¸¤ä¸ªä»»å¡é½æ§è¡å®æåï¼æä¸¤ä¸ªä»»å¡çç»æåå¹¶ãä¸¤ä¸ªä»»å¡æ¯å¹¶è¡æ§è¡çï¼å®ä»¬ä¹é´å¹¶æ²¡æååä¾èµé¡ºåºã\n\n\n# å¹¶è¡è¿è¡å¤ä¸ªCompletableFuture\n\n * allOf()\n * anyOf()\n\nallOf() æ¹æ³ä¼ç­å°ææç CompletableFuture é½è¿è¡å®æä¹ååè¿å\n\nanyOf() æ¹æ³ä¸ä¼ç­å¾ææç CompletableFuture é½è¿è¡å®æä¹ååè¿åï¼åªè¦æä¸ä¸ªæ§è¡å®æå³å¯ï¼\n\n\n# åè\n\n[1] ãå®æJavaé«å¹¶åç¨åºè®¾è®¡ã\n\n[2] å»éªå³°-ä½¿ç¨Future\n\n[3] JavaGuide-CompletableFutureå¥é¨",normalizedContent:"# future\n\nfuture æ¨¡å¼æ¯å¤çº¿ç¨å¼åä¸­éå¸¸å¸¸è§çä¸ç§è®¾è®¡æ¨¡å¼ï¼å®çæ ¸å¿ææ³æ¯å¼æ­¥è°ç¨ã\n\nå½æä»¬éè¦è°ç¨ä¸ä¸ªå½æ°æ¹æ³æ¶ï¼å¦æè¿ä¸ªå½æ°æ§è¡çå¾æ¢ï¼é£ä¹æä»¬å°±è¦è¿è¡ç­å¾ãä½ææ¶åï¼æä»¬å¯è½å¹¶ä¸æ¥äºè·åç»æãå æ­¤ï¼æä»¬å¯ä»¥è®©è¢«è°ç¨èç«å³è¿åï¼è®©å®å¨åå°æ¢æ¢å¤çè¿ä¸ªè¯·æ±ãå¯¹äºè°ç¨èæ¥è¯´ï¼åå¯ä»¥åå¤çä¸äºå¶ä»ä»»å¡ï¼å¨çæ­£éè¦æ°æ®çåºååå»å°è¯è·åéè¦çæ°æ®ã\n\nå¯¹ future æ¨¡å¼æ¥è¯´ï¼è½ç¶å®æ æ³ç«å³ç»ä½ éè¦çæ°æ®ï¼ä½å®ä¼ç»ä½ ä¸ä¸ªå¥çº¦ï¼å°æ¥ä½ å¯ä»¥å­åè¿ä¸ªå¥çº¦å»éæ°è·åä½ éè¦çä¿¡æ¯ã\n\nè¿éæä»¬ä¸»è¦è°è®º jdk ä¸­ç future æ¨¡å¼ï¼å³ java.util.concurrent åä¸ç future æ¥å£ã\n\nrunnablefutre æ¥å£ï¼ç»§æ¿äº future å runnable ä¸¤ä¸ªæ¥å£ãå¶ä¸­run() æ¹æ³ç¨äºæé çå®çæ°æ®ã\n\nfuturetask ç±»ï¼ä¸ä¸ªå·ä½çå®ç°ç±»ãwaitnode æ¯å¶åé¨ç±»ã\n\n\n\nå¾ï¼diagram for futuretask\n\n\n# future å¸¸è§æä½\n\nexecutorservice executor = executors.newfixedthreadpool(4); \n// å®ä¹ä»»å¡:\ncallable<string> task = new task();\n// æäº¤ä»»å¡å¹¶è·å¾future:\nfuture<string> future = executor.submit(task);\n// ä»futureè·åå¼æ­¥æ§è¡è¿åçç»æ:\nstring result = future.get(); // å¯è½é»å¡\n\n\næµç¨ï¼\n\n 1. å½æä»¬æäº¤ä¸ä¸ªcallableä»»å¡åï¼runnable ä»»å¡æ²¡æè¿åå¼ï¼ï¼æä»¬ä¼åæ¶è·å¾ä¸ä¸ªfutureå¯¹è±¡ã\n\n 2. ç¶åï¼æä»¬å¨ä¸»çº¿ç¨æä¸ªæ¶å»è°ç¨futureå¯¹è±¡çget()æ¹æ³ï¼å°±å¯ä»¥è·å¾å¼æ­¥æ§è¡çç»æã\n\n 3. å¨è°ç¨get()æ¶ï¼å¦æå¼æ­¥ä»»å¡å·²ç»å®æï¼æä»¬å°±ç´æ¥è·å¾ç»æã\n\n 4. å¦æå¼æ­¥ä»»å¡è¿æ²¡æå®æï¼é£ä¹get()ä¼é»å¡ï¼ç´å°ä»»å¡å®æåæè¿åç»æã\n\n\n# future æ¥å£æ¹æ³\n\nä¸ä¸ªfuture<v>æ¥å£è¡¨ç¤ºä¸ä¸ªæªæ¥å¯è½ä¼è¿åçç»æï¼å®å®ä¹çæ¹æ³æï¼\n\n * get()ï¼è·åç»æï¼å¯è½ä¼ç­å¾ï¼\n * get(long timeout, timeunit unit)ï¼è·åç»æï¼ä½åªç­å¾æå®çæ¶é´ï¼\n * cancel(boolean mayinterruptifrunning)ï¼åæ¶å½åä»»å¡ï¼\n * isdone()ï¼å¤æ­ä»»å¡æ¯å¦å·²å®æã\n\n\n# completablefuture\n\ncompletablefuture æ¯ java8 æ°å¢çå·¥å·ç±»ï¼æ¯å¢å¼ºç futureã\n\ncompletablefuture å®å®ç°äº future æ¥å£ï¼è¿å®ç°äº completionstage æ¥å£ã\n\ncompletablefuture é¤äºæä¾äºæ´ä¸ºå¥½ç¨åå¼ºå¤§ç future ç¹æ§ä¹å¤ï¼è¿æä¾äºå½æ°å¼ç¼ç¨çè½åã\n\npublic class completablefuture<t> implements future<t>, completionstage<t> {\n}\n\n\ncompletionstage æ¥å£ä¹æ¯ java8 æ°å¢çãèè¿ä¸ªæ¥å£éæå¤è¾¾40ç§æ¹æ³ï¼æ¯ä¸ºäºå½æ°å¼ç¼ç¨ä¸­çæµå¼è°ç¨åå¤çã\n\néè¿è¿ä¸ªæ¥å£ï¼æä»¬å¯ä»¥å¨ä¸ä¸ªæ§è¡ç»æä¸è¿è¡å¤æ¬¡æµå¼è°ç¨ã\n\nstage.thenapply(x -> square(x)).thenaccept(x -> system.out.print(x)).thenrun(() -> system.out.println)\n\n\nå¶åè½ï¼\n\n * å®æäºå°±éç¥\n * å¼æ­¥æ§è¡ä»»å¡\n * æµå¼è°ç¨\n * å¼å¸¸å¤ç\n * ç»åå¤ä¸ªcompletablefuture\n\n\n# completablefuture å¸¸è§æä½\n\n\n# åå»ºcompletablefuture\n\nå¸¸è§çåå»º completablefuture å¯¹è±¡çæ¹æ³å¦ä¸ï¼\n\n 1. éè¿ new å³é®å­ã\n 2. åºäº completablefuture èªå¸¦çéæå·¥åæ¹æ³ï¼runasync() ãsupplyasync() ã\n\ncompletablefuture<rpcresponse<object>> resultfuture = new completablefuture<>();\n\nstatic <u> completablefuture<u> supplyasync(supplier<u> supplier);\n// ä½¿ç¨èªå®ä¹çº¿ç¨æ± (æ¨è)\nstatic <u> completablefuture<u> supplyasync(supplier<u> supplier, executor executor);\nstatic completablefuture<void> runasync(runnable runnable);\n// ä½¿ç¨èªå®ä¹çº¿ç¨æ± (æ¨è)\nstatic completablefuture<void> runasync(runnable runnable, executor executor);\n\n\n\n\n# å¤çå¼æ­¥ç»ç®çç»æ\n\nå½æä»¬è·åå°å¼æ­¥è®¡ç®çç»æä¹åï¼è¿å¯ä»¥å¯¹å¶è¿è¡è¿ä¸æ­¥çå¤çï¼æ¯è¾å¸¸ç¨çæ¹æ³æä¸é¢å ä¸ªï¼\n\n * thenapply()\n * thenaccept()\n * thenrun()\n * whencomplete()\n\n\n# å¼å¸¸å¤ç\n\n * handle()\n * exceptionally()\n * completeexceptionally()\n\n\n# ç»åcompletablefuture\n\n * thencompose()\n * thencombine()\n\nthencompose() å thencombine() æä»ä¹åºå«å¢ï¼\n\n * thencompose() å¯ä»¥ä¸¤ä¸ª completablefuture å¯¹è±¡ï¼å¹¶å°åä¸ä¸ªä»»å¡çè¿åç»æä½ä¸ºä¸ä¸ä¸ªä»»å¡çåæ°ï¼å®ä»¬ä¹é´å­å¨çååé¡ºåºã\n * thencombine() ä¼å¨ä¸¤ä¸ªä»»å¡é½æ§è¡å®æåï¼æä¸¤ä¸ªä»»å¡çç»æåå¹¶ãä¸¤ä¸ªä»»å¡æ¯å¹¶è¡æ§è¡çï¼å®ä»¬ä¹é´å¹¶æ²¡æååä¾èµé¡ºåºã\n\n\n# å¹¶è¡è¿è¡å¤ä¸ªcompletablefuture\n\n * allof()\n * anyof()\n\nallof() æ¹æ³ä¼ç­å°ææç completablefuture é½è¿è¡å®æä¹ååè¿å\n\nanyof() æ¹æ³ä¸ä¼ç­å¾ææç completablefuture é½è¿è¡å®æä¹ååè¿åï¼åªè¦æä¸ä¸ªæ§è¡å®æå³å¯ï¼\n\n\n# åè\n\n[1] ãå®æjavaé«å¹¶åç¨åºè®¾è®¡ã\n\n[2] å»éªå³°-ä½¿ç¨future\n\n[3] javaguide-completablefutureå¥é¨",charsets:{cjk:!0}},{title:"ä»çº¿ç¨å°Javaçéæºå¶",frontmatter:{title:"ä»çº¿ç¨å°Javaçéæºå¶",date:"2023-04-03T14:21:57.000Z",permalink:"/pages/646254/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/07.%E4%BB%8E%E7%BA%BF%E7%A8%8B%E5%88%B0Java%E7%9A%84%E9%94%81%E6%9C%BA%E5%88%B6.html",relativePath:"01.Java/04.Javaå¹¶å/07.ä»çº¿ç¨å°Javaçéæºå¶.md",key:"v-0ba27c18",path:"/pages/646254/",headers:[{level:2,title:"ä»ä¹æ¯çº¿ç¨ï¼ä»ä¹æ¯è¿ç¨ï¼",slug:"ä»ä¹æ¯çº¿ç¨-ä»ä¹æ¯è¿ç¨",normalizedTitle:"ä»ä¹æ¯çº¿ç¨ï¼ä»ä¹æ¯è¿ç¨ï¼",charIndex:2},{level:2,title:"çº¿ç¨çç¼ºç¹æä»ä¹ï¼",slug:"çº¿ç¨çç¼ºç¹æä»ä¹",normalizedTitle:"çº¿ç¨çç¼ºç¹æä»ä¹ï¼",charIndex:386},{level:2,title:"æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼",slug:"æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨",normalizedTitle:"æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼",charIndex:658},{level:2,title:"æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨ï¼",slug:"æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨",normalizedTitle:"æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨ï¼",charIndex:1127},{level:2,title:"çº¿ç¨é´çåå­æ¯å±äº«çåï¼",slug:"çº¿ç¨é´çåå­æ¯å±äº«çå",normalizedTitle:"çº¿ç¨é´çåå­æ¯å±äº«çåï¼",charIndex:1590},{level:2,title:"Javaä¸­çéæºå¶",slug:"javaä¸­çéæºå¶",normalizedTitle:"javaä¸­çéæºå¶",charIndex:1975},{level:2,title:"ReentranLockæ¯æ²è§éè¿æ¯ä¹è§éï¼",slug:"reentranlockæ¯æ²è§éè¿æ¯ä¹è§é",normalizedTitle:"reentranlockæ¯æ²è§éè¿æ¯ä¹è§éï¼",charIndex:2959},{level:2,title:"æ²è§éåä¹è§éçåºå«",slug:"æ²è§éåä¹è§éçåºå«",normalizedTitle:"æ²è§éåä¹è§éçåºå«",charIndex:3349},{level:2,title:"Javaä¸­ä¹è§éçå®ç°",slug:"javaä¸­ä¹è§éçå®ç°",normalizedTitle:"javaä¸­ä¹è§éçå®ç°",charIndex:3862},{level:3,title:"CASï¼Compare And Swapï¼å®ç°ä¹è§é",slug:"cas-compare-and-swap-å®ç°ä¹è§é",normalizedTitle:"casï¼compare and swapï¼å®ç°ä¹è§é",charIndex:3911},{level:3,title:"çæ¬å·å®ç°ä¹è§é",slug:"çæ¬å·å®ç°ä¹è§é",normalizedTitle:"çæ¬å·å®ç°ä¹è§é",charIndex:4165},{level:2,title:"Javaä¸­ä¹è§éçç±»",slug:"javaä¸­ä¹è§éçç±»",normalizedTitle:"javaä¸­ä¹è§éçç±»",charIndex:4416},{level:2,title:"Springä¸­çä¹è§é",slug:"springä¸­çä¹è§é",normalizedTitle:"springä¸­çä¹è§é",charIndex:4827},{level:2,title:"MySQLæ¯æçæ¬å·åæ¶é´æ³å­æ®µ",slug:"mysqlæ¯æçæ¬å·åæ¶é´æ³å­æ®µ",normalizedTitle:"mysqlæ¯æçæ¬å·åæ¶é´æ³å­æ®µ",charIndex:5263},{level:2,title:"Spring @Version æ¡ä¾",slug:"spring-version-æ¡ä¾",normalizedTitle:"spring @version æ¡ä¾",charIndex:6477},{level:2,title:"AQS",slug:"aqs",normalizedTitle:"aqs",charIndex:7630},{level:2,title:"AQSå®ç°Reentrantlock",slug:"aqså®ç°reentrantlock",normalizedTitle:"aqså®ç°reentrantlock",charIndex:8491},{level:2,title:"çè§£AQSä¸­çacquireæ¹æ³",slug:"çè§£aqsä¸­çacquireæ¹æ³",normalizedTitle:"çè§£aqsä¸­çacquireæ¹æ³",charIndex:10548},{level:2,title:"ä»ä¹æ¯ä¸­æ­",slug:"ä»ä¹æ¯ä¸­æ­",normalizedTitle:"ä»ä¹æ¯ä¸­æ­",charIndex:11458},{level:2,title:"èªæä¸­æ­",slug:"èªæä¸­æ­",normalizedTitle:"èªæä¸­æ­",charIndex:11432}],headersStr:"ä»ä¹æ¯çº¿ç¨ï¼ä»ä¹æ¯è¿ç¨ï¼ çº¿ç¨çç¼ºç¹æä»ä¹ï¼ æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼ æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨ï¼ çº¿ç¨é´çåå­æ¯å±äº«çåï¼ Javaä¸­çéæºå¶ ReentranLockæ¯æ²è§éè¿æ¯ä¹è§éï¼ æ²è§éåä¹è§éçåºå« Javaä¸­ä¹è§éçå®ç° CASï¼Compare And Swapï¼å®ç°ä¹è§é çæ¬å·å®ç°ä¹è§é Javaä¸­ä¹è§éçç±» Springä¸­çä¹è§é MySQLæ¯æçæ¬å·åæ¶é´æ³å­æ®µ Spring @Version æ¡ä¾ AQS AQSå®ç°Reentrantlock çè§£AQSä¸­çacquireæ¹æ³ ä»ä¹æ¯ä¸­æ­ èªæä¸­æ­",content:'# ä»ä¹æ¯çº¿ç¨ï¼ä»ä¹æ¯è¿ç¨ï¼\n\nçº¿ç¨åè¿ç¨æ¯æä½ç³»ç»ä¸­çä¸¤ä¸ªéè¦æ¦å¿µï¼å®ä»¬é½æ¯å¹¶åæ§è¡çåºæ¬åä½ã\n\nè¿ç¨æ¯ç¨åºçä¸æ¬¡æ§è¡è¿ç¨ï¼æ¯æä½ç³»ç»èµæºåéçåºæ¬åä½ï¼æ¯ä¸ªè¿ç¨é½æç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦ãä¿¡å·å¤çåç¶æç­ä¿¡æ¯ãè¿ç¨å¯ä»¥åå»ºå­è¿ç¨ï¼ä¸åè¿ç¨ä¹é´çéä¿¡éè¦ä½¿ç¨è¿ç¨é´éä¿¡æºå¶ã\n\nçº¿ç¨æ¯è¿ç¨ä¸­çä¸ä¸ªæ§è¡ååï¼æ¯ç¨åºæ§è¡çæå°åä½ï¼æ¯ä¸ªçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´ãæä»¶æè¿°ç¬¦åå¶ä»èµæºãçº¿ç¨å¨åä¸è¿ç¨åæ§è¡ï¼å¯ä»¥è®¿é®å±äº«æ°æ®ï¼å æ­¤éè¦ä½¿ç¨åæ­¥æºå¶æ¥é¿åèµæºç«äºãçº¿ç¨ä¹é´çåæ¢æ¯è¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼ä¸éè¦è¿è¡èµæºçå¤å¶ååæ¢ã\n\næ»çæ¥è¯´ï¼è¿ç¨åçº¿ç¨é½æ¯æä½ç³»ç»ä¸­å¹¶åæ§è¡çåºæ¬åä½ï¼ä½è¿ç¨ä¹é´çéç¦»æ§æ´å¼ºï¼èµæºæ¶èæ´å¤§ï¼çº¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å±äº«èµæºæ´å¤ãå¨ç¼åç¨åºæ¶ï¼éè¦æ ¹æ®å·ä½çéæ±éæ©ä½¿ç¨è¿ç¨è¿æ¯çº¿ç¨æ¥å®ç°å¹¶åæ§è¡ã\n\n\n# çº¿ç¨çç¼ºç¹æä»ä¹ï¼\n\n * é¢ç¹çä¸ä¸æåæ¢ï¼å½ä¸ä¸ªçº¿ç¨éè¦è®¿é®å±äº«èµæºæ¶ï¼å¶ä»çº¿ç¨å¯è½ä¼è¢«æèµ·ï¼è¿ä¼å¯¼è´å¤§éçä¸ä¸æåæ¢ï¼éä½äºç³»ç»çæ§è½ã\n * èµæºç«äºï¼å¤ä¸ªçº¿ç¨è®¿é®åä¸å±äº«èµæºæ¶ï¼å¯è½ä¼å¯¼è´èµæºç«äºåæ­»éé®é¢ï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥è§£å³ã\n * åå­å ç¨ï¼æ¯ä¸ªçº¿ç¨é½éè¦ä¸å®çæ ç©ºé´åçº¿ç¨æ§å¶åç­èµæºï¼å½åå»ºå¤§éçº¿ç¨æ¶ï¼å¯è½ä¼å¯¼è´åå­å ç¨è¿é«ã\n * å¯é æ§é®é¢ï¼çº¿ç¨ä¹é´çéè¯¯åå¼å¸¸å¯è½ä¼å¯¼è´æ´ä¸ªç¨åºå´©æºï¼å æ­¤éè¦å°å¿å°ç¼ååç®¡ççº¿ç¨ä»£ç ã\n * å¤ææ§é®é¢ï¼çº¿ç¨ç¼ç¨éè¦èèçº¿ç¨ä¹é´çäº¤äºååæ­¥ï¼å¢å äºç¨åºçå¤ææ§åç»´æ¤é¾åº¦ã\n\n\n# æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼\n\nè½ç¶è¿ç¨æ¯æä½ç³»ç»èµæºåéçåºæ¬åä½ï¼ä½æ¯çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼æ§è¡éåº¦æ´å¿«ï¼å æ­¤çº¿ç¨å¨å¹¶åç¼ç¨ä¸­æä»¥ä¸ä¼å¿ï¼\n\n * æ´å¿«çåæ¢ï¼çº¿ç¨ä¹é´çåæ¢æ¯è¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼ä¸éè¦è¿è¡èµæºçå¤å¶ååæ¢ãè¿æå³çå¨éè¦å¤§éå¹¶åæ§è¡çåºæ¯ä¸ï¼ä½¿ç¨çº¿ç¨å¯ä»¥æ´ææå°å©ç¨è®¡ç®èµæºã\n * æ´ä½çèµæºæ¶èï¼æ¯ä¸ªè¿ç¨é½éè¦ç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦åå¶ä»èµæºï¼å æ­¤è¿ç¨çèµæºæ¶èæ¯çº¿ç¨æ´å¤§ãä½¿ç¨çº¿ç¨å¯ä»¥åå°ç³»ç»èµæºçå ç¨ï¼æé«ç³»ç»çæ§è½ã\n * æ´å¥½çéä¿¡ååæ­¥ï¼çº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼å æ­¤çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å®¹æå®ç°ãå¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼å¯ä»¥ä½¿ç¨éãä¿¡å·éãæ¡ä»¶åéç­åæ­¥æºå¶æ¥åè°çº¿ç¨ä¹é´çæ§è¡ã\n * æ´å®¹æå®ç°å¹¶åç¼ç¨ï¼ä½¿ç¨çº¿ç¨å¯ä»¥æ´å®¹æå°å®ç°å¹¶åç¼ç¨ï¼å ä¸ºçº¿ç¨å¯ä»¥å©ç¨å¤æ ¸å¤çå¨å¹¶è¡æ§è¡ä»»å¡ï¼èä¸éè¦æå¨ç¼åå¤æçè¿ç¨é´éä¿¡ä»£ç ã\n\næ»ä¹ï¼å°½ç®¡è¿ç¨åçº¿ç¨é½å¯ä»¥å®ç°å¹¶åç¼ç¨ï¼ä½æ¯çº¿ç¨æ´éåäºéè¦é«æå©ç¨è®¡ç®èµæºçåºæ¯ï¼æ´å®¹æå®ç°éä¿¡ååæ­¥ï¼å¹¶ä¸ç¼åèµ·æ¥æ´å ç®åã\n\n\n# æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨ï¼\n\nè½ç¶çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼ä½æ¯è¿ç¨å¨æä½ç³»ç»ä¸­ä»ç¶æ®æ¼çè³å³éè¦çè§è²ï¼æä»¥ä¸å ä¸ªæ¹é¢çä¼å¿ï¼\n\n * æ´å¼ºçéç¦»æ§ï¼æ¯ä¸ªè¿ç¨é½æç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦ãä¿¡å·å¤çåç¶æç­ä¿¡æ¯ï¼å æ­¤ä¸åè¿ç¨ä¹é´çä»£ç åæ°æ®æ¯ç¸äºéç¦»çãè¿æ ·å¯ä»¥ä¿è¯ç¨åºçå®å¨æ§åç¨³å®æ§ï¼é¿åå ä¸ºä¸ä¸ªè¿ç¨çå´©æºå¯¼è´æ´ä¸ªç³»ç»å´©æºã\n * æ´å¥½çå¯é æ§ï¼è¿ç¨ä¹é´çéè¯¯åå¼å¸¸å¯ä»¥è¢«éç¦»ï¼é¿åä¸ä¸ªè¿ç¨çéè¯¯å½±åå¶ä»è¿ç¨çæ­£å¸¸è¿è¡ãæ­¤å¤ï¼è¿ç¨å¯ä»¥ä½¿ç¨æä½ç³»ç»æä¾ççæ§æºå¶æ¥æ£æµåæ¢å¤éè¯¯ï¼å¢å¼ºç¨åºçå¯é æ§åç¨³å®æ§ã\n * æ´å¤çç¼ç¨æ¨¡åï¼è¿ç¨å¯ä»¥ä½¿ç¨å¤ç§ç¼ç¨æ¨¡åæ¥å®ç°å¹¶åç¼ç¨ï¼åæ¬å¤è¿ç¨æ¨¡åãå¤çº¿ç¨æ¨¡åååç¨æ¨¡åç­ãè¿äºæ¨¡åå¯ä»¥æ ¹æ®ä¸åçéæ±éæ©ä½¿ç¨ï¼ä»èå®ç°æ´å çµæ´»çç¼ç¨ã\n * æ´å¤çèµæºï¼æ¯ä¸ªè¿ç¨é½å¯ä»¥æ¥æç¬ç«çèµæºï¼åæ¬æä»¶ãç«¯å£ãsocketç­ãè¿äºèµæºå¯ä»¥è¢«ä¸åçè¿ç¨æå±äº«ï¼ä»èå®ç°æ´å çµæ´»çèµæºç®¡çã\n\nè½ç¶çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼ä½æ¯è¿ç¨ä»ç¶æ¯æä½ç³»ç»ä¸­ä¸å¯æç¼ºçæ¦å¿µï¼å¯ä»¥æä¾æ´å¥½çéç¦»æ§ãå¯é æ§åç¼ç¨æ¨¡åã\n\n\n# çº¿ç¨é´çåå­æ¯å±äº«çåï¼\n\næ¯çï¼çº¿ç¨ä¹é´çåå­æ¯å±äº«çãå¨åä¸ä¸ªè¿ç¨ä¸­çææçº¿ç¨å±äº«åä¸ä»½å°åç©ºé´ï¼è¿æå³çå®ä»¬å¯ä»¥ç´æ¥è®¿é®åä¸ä»½åå­ï¼åæ¬å¨å±åéãéæåéãå¨æåéçåå­åå æ ç­ã\n\nå æ­¤ï¼å¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼éè¦ç¹å«æ³¨æçº¿ç¨é´çåå­è®¿é®ï¼ä»¥é¿ååºç°æ°æ®ç«äºç­é®é¢ãå¦æå¤ä¸ªçº¿ç¨åæ¶è¯»ååä¸ååå­ï¼å¯è½ä¼å¯¼è´æ°æ®çä¸ä¸è´ï¼è¿ç§°ä¸ºç«ææ¡ä»¶ãä¸ºäºé¿åè¿ç§æåµï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥åè°çº¿ç¨ä¹é´çè®¿é®ï¼æ¯å¦ä½¿ç¨éãä¿¡å·éãæ¡ä»¶åéç­ã\n\næ­¤å¤ï¼å¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼è¿éè¦æ³¨æçº¿ç¨ä¹é´çåå­å¯è§æ§ãå¦æä¸ä¸ªçº¿ç¨ä¿®æ¹äºä¸ååå­ï¼å¶ä»çº¿ç¨å¯è½æ æ³ç«å³çå°è¿ä¸ªä¿®æ¹ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥ç¡®ä¿åå­å¯è§æ§ï¼æ¯å¦ä½¿ç¨volatileåéãmemory barrierç­ã\n\næ»ä¹ï¼çº¿ç¨ä¹é´çåå­æ¯å±äº«çï¼éè¦ç¹å«æ³¨æçº¿ç¨ä¹é´çåå­è®¿é®ååæ­¥ï¼ä»¥ç¡®ä¿ç¨åºçæ­£ç¡®æ§åæ§è½ã\n\n\n# Javaä¸­çéæºå¶\n\nJavaä¸­çéæºå¶ä¸»è¦åæ¬ä»¥ä¸å ç§ï¼\n\n * synchronizedå³é®å­ï¼synchronizedæ¯Javaä¸­æåºæ¬çéæºå¶ï¼å®å¯ä»¥å®ç°å¯¹ä»£ç åãæ¹æ³æèå¯¹è±¡çåæ­¥è®¿é®ãsynchronizedå³é®å­å¯ä»¥ä¿è¯å¨åä¸æ¶å»åªæä¸ä¸ªçº¿ç¨å¯ä»¥è¿å¥è¢«éå®çä»£ç åææ¹æ³ï¼ä»èé¿åçº¿ç¨é´çæ°æ®ç«äºã\n\n * ReentrantLockç±»ï¼ReentrantLockæ¯Javaä¸­çä¸ä¸ªå¯éå¥éï¼å®æä¾äºä¸synchronizedç¸ä¼¼çéæºå¶ï¼ä½æ¯æ´å çµæ´»åå¯æ©å±ãä¸synchronizedä¸åçæ¯ï¼ReentrantLockå¯ä»¥å®ç°å¬å¹³éåéå¬å¹³éï¼å¯ä»¥æ¯æå¤ä¸ªæ¡ä»¶åéç­é«çº§ç¹æ§ã\n\n * ReadWriteLockæ¥å£ï¼ReadWriteLockæ¯Javaä¸­çä¸ä¸ªè¯»åéæ¥å£ï¼å®å¯ä»¥å®ç°å¯¹å±äº«æ°æ®çè¯»ååç¦»ãReadWriteLockåè®¸å¤ä¸ªçº¿ç¨åæ¶è¯»åå±äº«æ°æ®ï¼ä½æ¯åªåè®¸ä¸ä¸ªçº¿ç¨åå¥å±äº«æ°æ®ï¼ä»èé¿åäºè¯»åä¹é´çç«ææ¡ä»¶ã\n\n * StampedLockç±»ï¼StampedLockæ¯Javaä¸­çä¸ä¸ªä¹è§è¯»åéï¼å®æä¾äºå¯¹å±äº«æ°æ®çè¯»åè®¿é®ï¼å¹¶æ¯ææ éCASæä½ãStampedLockçä¹è§è¯»åæºå¶å¯ä»¥é¿åè¯»åå²çªçæåµä¸ä½¿ç¨æ²è§éå¸¦æ¥çæ§è½æå¤±ã\n\n * CountDownLatchç±»ï¼CountDownLatchæ¯Javaä¸­çä¸ä¸ªåè®¡æ¶éï¼å®å¯ä»¥è®©ä¸ä¸ªçº¿ç¨ç­å¾å¤ä¸ªçº¿ç¨æ§è¡å®æ¯ä¹ååç»§ç»­æ§è¡ãCountDownLatchçè®¡æ°å¨åå§å¼å¯ä»¥è®¾ç½®ä¸ºå¤å°ä¸ªçº¿ç¨ï¼å½æ¯ä¸ªçº¿ç¨æ§è¡å®æ¯åå°±ä¼éåè®¡æ°å¨ï¼å½è®¡æ°å¨ä¸º0æ¶ï¼ç­å¾ççº¿ç¨å°±ä¼è¢«å¤éã\n\n * Semaphoreç±»ï¼Semaphoreæ¯Javaä¸­çä¸ä¸ªä¿¡å·éï¼å®å¯ä»¥éå¶å¤ä¸ªçº¿ç¨å¯¹èµæºçè®¿é®ãSemaphoreçè®¡æ°å¨å¯ä»¥æå®å¤å°ä¸ªçº¿ç¨å¯ä»¥åæ¶è®¿é®èµæºï¼å½çº¿ç¨è®¿é®å®æ¯ä¹åï¼è®¡æ°å¨ä¼èªå¨éå¢ã\n\n * Exchangerç±»ï¼Exchangeræ¯Javaä¸­çä¸ä¸ªçº¿ç¨é´äº¤æ¢æ°æ®çå·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸¤ä¸ªçº¿ç¨äº¤æ¢å½¼æ­¤çæ°æ®ãExchangerå¯ä»¥ç¨äºè§£å³çº¿ç¨ä¹é´çæ°æ®äº¤æ¢é®é¢ï¼ä¾å¦æ°æ®ä¼ è¾ãç¼å­æ± ç­åºæ¯ã\n\né¤äºä»¥ä¸åä¸¾çéæºå¶ï¼Javaä¸­è¿æä¸äºå¶ä»çå¹¶åå·¥å·ç±»ï¼å¦SemaphoreãCyclicBarrierãLockSupportç­ï¼å®ä»¬å¯ä»¥å¸®å©æä»¬æ´å æ¹ä¾¿åé«æå°å®ç°å¤çº¿ç¨ç¼ç¨ã\n\n\n# ReentranLockæ¯æ²è§éè¿æ¯ä¹è§éï¼\n\nReentrantLock æ¯å±äºæ²è§éçèç´ã\n\næ²è§éæ¯ä¸ç§ä¿å®çéç­ç¥ï¼å®å¨ä½¿ç¨éä¹åæ»æ¯åè®¾æå¶ä»çº¿ç¨æ­£å¨ä½¿ç¨è¯¥å±äº«èµæºï¼å¹¶ä¸å¨å éåç´å°è§£éåé½ä¼å ç¨éï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®è¯¥å±äº«èµæºãè¿ç§ç­ç¥çä¼ç¹æ¯å¯ä»¥ææé¿åå¹¶åè®¿é®çå²çªï¼ä½åæ¶ä¹ä¼å¸¦æ¥ä¸å®çå¼éã\n\nReentrantLock å¨è¿è¡å éæä½æ¶ï¼ä¼å°è¯è·åéï¼å¦æå½åæ²¡æå¶ä»çº¿ç¨ææè¯¥éï¼åä¼æåè·åå¹¶å ç¨éï¼å¦ææå¶ä»çº¿ç¨ææè¯¥éï¼åå½åçº¿ç¨ä¼è¢«é»å¡ï¼ç­å¾å¶ä»çº¿ç¨éæ¾éãç±äº ReentrantLock å¯ä»¥éå¥ï¼å³åä¸ä¸ªçº¿ç¨å¯ä»¥å¤æ¬¡è·ååä¸ä¸ªéèä¸ä¼é ææ­»éï¼æä»¥å®çå½åä¸­åå«äº "Reentrant"ï¼å¯éå¥ï¼è¿ä¸è¯æ±ã\n\nä¸ä¹è§éä¸åï¼æ²è§éçä¸»è¦ç¹ç¹æ¯å¨è®¿é®å±äº«èµæºä¹åï¼æ»æ¯åè·åéï¼å æ­¤ ReentrantLock ä¸å±äºä¹è§éçèç´ã\n\n\n# æ²è§éåä¹è§éçåºå«\n\næ²è§éåä¹è§éæ¯ä¸¤ç§å¹¶åæ§å¶çç­ç¥ï¼å®ä»¬çåºå«å¦ä¸ï¼\n\n * æ§è½å·®å¼ï¼æ²è§éå¨ä½¿ç¨éä¹åæ»æ¯åè®¾æå¶ä»çº¿ç¨æ­£å¨ä½¿ç¨è¯¥å±äº«èµæºï¼å¹¶ä¸å¨å éåç´å°è§£éåé½ä¼å ç¨éï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®è¯¥å±äº«èµæºãè¿ç§ç­ç¥çä¼ç¹æ¯å¯ä»¥ææé¿åå¹¶åè®¿é®çå²çªï¼ä½åæ¶ä¹ä¼å¸¦æ¥ä¸å®çå¼éãä¹è§éååè®¾å¹¶åå²çªä¸ä¼åçï¼ç´æ¥è¿è¡å¹¶åæä½ï¼å¦æåç°å²çªåè¿è¡åæ»æéè¯ãå æ­¤ï¼ä¹è§éçæ§è½ä¸è¬æ¯æ²è§éè¦å¥½ã\n * å®ç°æ¹å¼ï¼æ²è§éçå®ç°æ¹å¼éå¸¸æ¯ä½¿ç¨ synchronizedãReentrantLock ç­éæºå¶ï¼èä¹è§éçå®ç°æ¹å¼éå¸¸æ¯ä½¿ç¨ CASï¼Compare And Swapï¼ç­ä¹è§å¹¶åæ§å¶æºå¶ã\n * å²çªè§£å³æ¹å¼ï¼æ²è§éå¨å éæé´ï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®å±äº«èµæºï¼ä»èé¿åå¹¶åå²çªãä¹è§éååè®¾å¹¶åå²çªä¸ä¼åçï¼å¨æä½ç»æåæä¼æ£æ¥å¹¶åå²çªï¼å¦æåç°å²çªåè¿è¡åæ»æéè¯ã\n * åºç¨åºæ¯ï¼æ²è§ééç¨äºå¹¶åå²çªæ¦çè¾é«çåºæ¯ï¼ä¾å¦å¨é«å¹¶åè®¿é®æ°æ®åºæ¶ï¼ç±äºæ¯æ¬¡è®¿é®éè¦è·åç¬å éï¼å æ­¤æ²è§éçææä¼æ¯è¾å¥½ãèä¹è§ééç¨äºå¹¶åå²çªæ¦çè¾ä½çåºæ¯ï¼ä¾å¦å¨åæºå¤çº¿ç¨ç¯å¢ä¸ï¼ç±äºå¹¶åå²çªæ¦çè¾ä½ï¼ä½¿ç¨ä¹è§éå¯ä»¥æé«æ§è½ã\n\n\n# Javaä¸­ä¹è§éçå®ç°\n\nå¨ Java ä¸­ï¼ä¹è§éä¸»è¦æä¸¤ç§å®ç°æ¹å¼ï¼CAS åçæ¬å·ã\n\n\n# CASï¼Compare And Swapï¼å®ç°ä¹è§é\n\nCAS æ¯ä¸ç§ä¹è§éçå®ç°æ¹å¼ï¼å®ä½¿ç¨åå­æ§æä½æ¥å®ç°å¹¶åæ§å¶ãCAS æä½éè¦æä¾è¦æ´æ°çåéçå¼ãé¢æå¼åæ°å¼ï¼å¦æå½ååéçå¼ç­äºé¢æå¼ï¼å°±ä½¿ç¨æ°å¼æ´æ°åéå¹¶è¿å trueï¼å¦åä¸åä»»ä½æä½å¹¶è¿å falseã\n\nJava ä¸­ç AtomicInteger å AtomicLong ç±»å°±æ¯ä½¿ç¨ CAS å®ç°ä¹è§éçå¸åä¾å­ãä½¿ç¨ CAS å®ç°ä¹è§éæ¶ï¼éè¦æ³¨æ CAS æä½å¯è½ä¼åºç° ABA é®é¢ï¼éè¦é¢å¤çå¤çæªæ½æ¥è§£å³è¿ä¸ªé®é¢ã\n\n\n# çæ¬å·å®ç°ä¹è§é\n\nå¦ä¸ç§å®ç°ä¹è§éçæ¹å¼æ¯éè¿çæ¬å·å®ç°ãå¨å®ç°çæ¬å·ä¹è§éæ¶ï¼æ¯ä¸ªå±äº«æ°æ®é½æä¸ä¸ªçæ¬å·ï¼æ¯æ¬¡æ´æ°æ¶é½éè¦æ¯è¾å½åçæ¬å·åè¦æ´æ°çæ°æ®ççæ¬å·ï¼å¦æä¸è´ï¼åæ´æ°æåï¼å¹¶å¢å çæ¬å·ï¼å¦åæ´æ°å¤±è´¥ã\n\nå¨ Java ä¸­ï¼å®ç°çæ¬å·ä¹è§éå¯ä»¥ä½¿ç¨ AtomicStampedReference ç±»ï¼å®å¯ä»¥å¯¹ä¸ä¸ªå¯¹è±¡çå¼ç¨åçæ¬å·è¿è¡åå­æä½ãä½¿ç¨ AtomicStampedReference æ¶éè¦æ³¨æï¼æ¯æ¬¡æ´æ°æ¶éè¦åæ¶æ´æ°å¯¹è±¡å¼ç¨åçæ¬å·ï¼å¦åå¯è½ä¼åºç°æ°æ®ä¸ä¸è´çé®é¢ã\n\n\n# Javaä¸­ä¹è§éçç±»\n\nJavaä¸­ä¹è§éçå®ç°ç±»åæ¬ï¼\n\n * Atomic åä¸çåå­ç±»ï¼ä¾å¦ AtomicIntegerãAtomicLongãAtomicReference ç­ï¼è¿äºç±»æä¾äºåå­æ§çæä½æ¹æ³ï¼å¯ä»¥å®ç°ä¹è§éæºå¶ã\n\n * CASï¼Compare and Swapï¼ï¼CAS æ¯ä¹è§éçä¸ç§å®ç°æ¹å¼ï¼Java ä¸­æä¾äº sun.misc.Unsafe ç±»ç compareAndSwapXXX() æ¹æ³ï¼å¯ä»¥ç¨äºå®ç° CAS æä½ã\n\n * ä¹è§éæ¡æ¶ï¼Java ä¸­æä¸äºå¼æºçä¹è§éæ¡æ¶ï¼ä¾å¦ JPA çä¹è§éãSpring ä¸­çä¹è§éç­ï¼è¿äºæ¡æ¶å°è£äºä¹è§éçå®ç°ç»èï¼ä½¿å¾å¼åèå¯ä»¥æ´æ¹ä¾¿å°ä½¿ç¨ä¹è§éæºå¶ã\n\néè¦æ³¨æçæ¯ï¼å¨ä½¿ç¨ä¹è§éæ¶éè¦ç¹å«å³æ³¨å¹¶åå²çªçå¤çï¼å ä¸ºä¹è§éä¸ä¼é»å¡å¶ä»çº¿ç¨ï¼æä»¥å¯è½ä¼åºç°å¤ä¸ªçº¿ç¨åæ¶è¿è¡ä¿®æ¹å¯¼è´å²çªçæåµï¼è¿æ¶éè¦ä½¿ç¨ä¸äºç¹æ®çç®æ³æèææ¯æ¥è§£å³ã\n\n\n# Springä¸­çä¹è§é\n\nSpring ä¸­æä¾äºä¸¤ç§ä¹è§éå®ç°æ¹å¼ï¼\n\n * åºäºçæ¬å·ï¼Versionï¼çä¹è§éï¼è¯¥å®ç°æ¹å¼æ¯éè¿ä¸ºæ¯æ¡è®°å½å¢å ä¸ä¸ªçæ¬å·å­æ®µï¼å¨æ´æ°è®°å½æ¶æ¯è¾çæ¬å·æ¯å¦ä¸è´æ¥å¤æ­æ¯å¦åçäºå¹¶åå²çªãå¨ Spring ä¸­ï¼å¯ä»¥éè¿ @Version æ³¨è§£æ¥æå®çæ¬å·å­æ®µï¼åæ¶å¨æ§è¡æ´æ°æä½æ¶ï¼Spring ä¼èªå¨æ£æ¥çæ¬å·å¹¶è¿è¡å¹¶åå²çªæ£æµåå¤çã\n * åºäºæ¶é´æ³ï¼Timestampï¼çä¹è§éï¼è¯¥å®ç°æ¹å¼æ¯éè¿ä¸ºæ¯æ¡è®°å½å¢å ä¸ä¸ªæ¶é´æ³å­æ®µï¼å¨æ´æ°è®°å½æ¶æ¯è¾æ¶é´æ³æ¯å¦ä¸è´æ¥å¤æ­æ¯å¦åçäºå¹¶åå²çªãå¨ Spring ä¸­ï¼å¯ä»¥éè¿ @Timestamp æ³¨è§£æ¥æå®æ¶é´æ³å­æ®µï¼åæ¶å¨æ§è¡æ´æ°æä½æ¶ï¼Spring ä¼èªå¨æ£æ¥æ¶é´æ³å¹¶è¿è¡å¹¶åå²çªæ£æµåå¤çã\n\néè¦æ³¨æçæ¯ï¼å¨ä½¿ç¨ Spring çä¹è§éæºå¶æ¶ï¼éè¦ç¡®ä¿æ°æ®åºä¸­æ¯æä¹è§éå®ç°æéè¦ççæ¬å·ææ¶é´æ³å­æ®µï¼åæ¶éè¦ç¹å«å³æ³¨å¹¶åå²çªçå¤çï¼ç¡®ä¿å¨å¹¶åè®¿é®æ¶ä¸ä¼åçæ°æ®ä¸ä¸è´çæåµã\n\n\n# MySQLæ¯æçæ¬å·åæ¶é´æ³å­æ®µ\n\n 1. åºäºçæ¬å·çä¹è§éï¼å¨ MySQL ä¸­ï¼å¯ä»¥ä½¿ç¨ INT æ BIGINT ç±»åçå­æ®µä½ä¸ºçæ¬å·å­æ®µï¼å¹¶å¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ WHERE å­å¥éå¶çæ¬å·ç¸åçè®°å½æè½è¢«æ´æ°ï¼ä»èå®ç°ä¹è§éæ§å¶ã\n    \n    ä¾å¦ï¼åå»ºä¸ä¸ªåå«çæ¬å·çè¡¨ï¼\n\nCREATE TABLE `user` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) DEFAULT NULL,\n  `age` int(11) DEFAULT NULL,\n  `version` int(11) DEFAULT 0,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n\nå¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ç±»ä¼¼ä»¥ä¸ç SQL è¯­å¥è¿è¡çæ¬å·çæ¯è¾åæ´æ°ï¼\n\nUPDATE `user` SET `age` = #{age}, `version` = `version` + 1 WHERE `id` = #{id} AND `version` = #{version};\n\n\nå¶ä¸­ï¼#{id} å #{version} åå«è¡¨ç¤ºéè¦æ´æ°çè®°å½ç ID åçæ¬å·ï¼#{age} è¡¨ç¤ºéè¦æ´æ°çå¹´é¾å¼ã\n\n 2. åºäºæ¶é´æ³çä¹è§éï¼å¨ MySQL ä¸­ï¼å¯ä»¥ä½¿ç¨ TIMESTAMP æ DATETIME ç±»åçå­æ®µä½ä¸ºæ¶é´æ³å­æ®µï¼å¹¶å¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ WHERE å­å¥éå¶æ¶é´æ³ç¸åçè®°å½æè½è¢«æ´æ°ï¼ä»èå®ç°ä¹è§éæ§å¶ã\n\nä¾å¦ï¼åå»ºä¸ä¸ªåå«æ¶é´æ³çè¡¨ï¼\n\nCREATE TABLE `user` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) DEFAULT NULL,\n  `age` int(11) DEFAULT NULL,\n  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n\nå¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ç±»ä¼¼ä»¥ä¸ç SQL è¯­å¥è¿è¡æ¶é´æ³çæ¯è¾åæ´æ°ï¼\n\nUPDATE `user` SET `age` = #{age}, `update_time` = #{updateTime} WHERE `id` = #{id} AND `update_time` = #{updateTime};\n\n\nå¶ä¸­ï¼#{id} å #{updateTime} åå«è¡¨ç¤ºéè¦æ´æ°çè®°å½ç ID åæ¶é´æ³ï¼#{age} è¡¨ç¤ºéè¦æ´æ°çå¹´é¾å¼ã\n\n\n# Spring @Version æ¡ä¾\n\n@Version æ³¨è§£å¯ä»¥ç¨äºæå®å®ä½ç±»ä¸­ççæ¬å·å­æ®µï¼ä»¥ä¾¿å¨æ´æ°æä½æ¶è¿è¡ä¹è§éæ§å¶ãä¸é¢æ¯ä¸ä¸ªç®åçç¤ºä¾ï¼\n\nåè®¾æä»¬æä¸ä¸ª User å®ä½ç±»ï¼å¶ä¸­åå«äºä¸ä¸ª version å­æ®µè¡¨ç¤ºçæ¬å·ï¼å¯ä»¥ä½¿ç¨ @Version æ³¨è§£æ¥æ è¯ï¼\n\n@Entity\n@Table(name = "user")\npublic class User {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(name = "name")\n    private String name;\n\n    @Column(name = "age")\n    private Integer age;\n\n    @Version\n    @Column(name = "version")\n    private Integer version;\n    \n    // getter and setter methods\n}\n\n\nå¨è¿è¡æ´æ°æä½æ¶ï¼å¯ä»¥éè¿è°ç¨ Spring Data JPA æä¾ç save() æ¹æ³æ¥å®ç°ä¹è§éæ§å¶ãä¾å¦ï¼\n\n@Service\npublic class UserService {\n\n    @Autowired\n    private UserRepository userRepository;\n\n    public void update(User user) {\n        userRepository.save(user);\n    }\n}\n\n\nå½è°ç¨ update() æ¹æ³æ´æ° User å®ä½æ¶ï¼Spring Data JPA ä¼èªå¨æ£æ¥ version å­æ®µçå¼æ¯å¦ä¸æ°æ®åºä¸­çä¸è´ï¼å¦æä¸è´åæ§è¡æ´æ°æä½ï¼å¦åæåº OptimisticLockException å¼å¸¸ãä¾å¦ï¼\n\nUser user = userRepository.findById(1L).orElseThrow();\nuser.setAge(30);\nuserService.update(user);\n\n\nå¨ä¸è¿°ä»£ç ä¸­ï¼é¦åéè¿ UserRepository æ¥è¯¢å° ID ä¸º 1 ç User å®ä½ï¼å¹¶å°å¶å¹´é¾ä¿®æ¹ä¸º 30ãæ¥çï¼è°ç¨ UserService ç update() æ¹æ³è¿è¡æ´æ°æä½ï¼æ­¤æ¶ Spring Data JPA ä¼æ£æ¥ user å®ä½ç version å­æ®µæ¯å¦ä¸æ°æ®åºä¸­çä¸è´ï¼å¦æä¸è´åæ§è¡æ´æ°æä½ï¼å¦åæåº OptimisticLockException å¼å¸¸ã\n\n\n# AQS\n\nAQSï¼AbstractQueuedSynchronizerï¼æ¯ Java å¹¶ååä¸­éååæ­¥å¨çæ ¸å¿å®ç°ï¼å®éè¿ä¸ä¸ªååéååä¸ä¸ªæ´å½¢ç¶æå¼æ¥ç®¡çåæ­¥ç¶æï¼å¹¶æä¾äº acquire å release ä¸¤ä¸ªä¸»è¦çåæ­¥æä½ã\n\nAQS åé¨ç»´æ¤äºä¸ä¸ªç±»ä¼¼äºååé¾è¡¨çéåï¼éåä¸­çèç¹è¡¨ç¤ºæ­£å¨ç­å¾è·åéççº¿ç¨ãå½ä¸ä¸ªçº¿ç¨å°è¯è·åéæ¶ï¼å¦æéå·²ç»è¢«å¶ä»çº¿ç¨å ç¨ï¼åè¯¥çº¿ç¨ä¼è¢«å å¥å°éåçæ«å°¾ï¼å¹¶è¢«é»å¡ãå½éçå ç¨èéæ¾éæ¶ï¼AQS ä¼å°éåå¤´é¨ççº¿ç¨å¤éï¼å¹¶è®©å¶å°è¯è·åéã\n\nAQS åé¨çç¶æå¼å¯ä»¥ç¨æ¥è¡¨ç¤ºéçå ç¨ç¶æï¼åæ¶ä¹å¯ä»¥è¢«å­ç±»ç¨æ¥è¡¨ç¤ºèªå®ä¹çåæ­¥ç¶æãå¨ä½¿ç¨ AQS å®ç°åæ­¥å¨æ¶ï¼ä¸è¬éè¦ç»§æ¿ AQS ç±»ï¼å¹¶éè¿å®ç° tryAcquireãtryRelease ç­æ¹æ³æ¥å®ç°åæ­¥å¨çå éåéæ¾éæä½ï¼åæ¶éè¦æ ¹æ®å·ä½éæ±è¦ç AQS ä¸­çä¸äºæ¹æ³æ¥å®ç°èªå®ä¹çåæ­¥ç­ç¥ã\n\nAQS åé¨çæ ¸å¿æ¹æ³æä»¥ä¸å ä¸ªï¼\n\n * acquire(int arg): å°è¯è·åéï¼å¦æè·åå¤±è´¥åé»å¡ç­å¾ã\n\n * release(int arg): éæ¾éï¼å¹¶å¤éç­å¾éåä¸­çä¸ä¸ªçº¿ç¨ã\n\n * tryAcquire(int arg): å°è¯è·åéï¼è¿å true è¡¨ç¤ºè·åæåï¼è¿å false è¡¨ç¤ºè·åå¤±è´¥ã\n\n * tryRelease(int arg): å°è¯éæ¾éï¼è¿å true è¡¨ç¤ºéæ¾æåï¼è¿å false è¡¨ç¤ºéæ¾å¤±è´¥ã\n\n * tryAcquireShared(int arg): å°è¯è·åå±äº«éï¼è¿åå¼çå«ä¹ä¸ tryAcquire ç¸åã\n\n * tryReleaseShared(int arg): å°è¯éæ¾å±äº«éï¼è¿åå¼çå«ä¹ä¸ tryRelease ç¸åã\n\nAQS æ¯ Java å¹¶ååä¸­éååæ­¥å¨çæ ¸å¿å®ç°ï¼ä½¿ç¨ AQS å®ç°åæ­¥å¨æ¶éè¦å¯¹ AQS çåçåæºå¶æä¸å®çäºè§£ï¼æè½ä¿è¯å®ç°çæ­£ç¡®æ§åé«ææ§ãåæ¶ï¼ä½¿ç¨ AQS å®ç°åæ­¥å¨éè¦è°¨æï¼å¦åå®¹æåºç°æ­»éç­é®é¢ã\n\n\n# AQSå®ç°Reentrantlock\n\nimport java.util.concurrent.locks.AbstractQueuedSynchronizer;\n\npublic class ReentrantLock extends AbstractQueuedSynchronizer {\n    private Thread ownerThread;\n    private int lockCount;\n\n    public ReentrantLock() {\n        ownerThread = null;\n        lockCount = 0;\n    }\n\n    @Override\n    protected boolean tryAcquire(int arg) {\n        Thread currentThread = Thread.currentThread();\n        int c = getState();\n        if (c == 0) {\n            if (compareAndSetState(0, arg)) {\n                ownerThread = currentThread;\n                lockCount++;\n                return true;\n            }\n        } else if (currentThread == ownerThread) {\n            setState(c + arg);\n            lockCount++;\n            return true;\n        }\n        return false;\n    }\n\n    @Override\n    protected boolean tryRelease(int arg) {\n        Thread currentThread = Thread.currentThread();\n        if (currentThread != ownerThread) {\n            throw new IllegalMonitorStateException("Not owner thread");\n        }\n\n        int c = getState() - arg;\n        boolean free = false;\n        if (c == 0) {\n            free = true;\n            ownerThread = null;\n        }\n        setState(c);\n        if (free) {\n            release();\n        }\n        return true;\n    }\n\n    public void lock() {\n        acquire(1);\n    }\n\n    public void unlock() {\n        release(1);\n    }\n}\n\n\nå¨ä¸é¢çç¤ºä¾ä»£ç ä¸­ï¼æä»¬èªå®ä¹äºä¸ä¸ª ReentrantLock ç±»ï¼ç»§æ¿äº AbstractQueuedSynchronizer ç±»ã\n\nè¿ä¸ªç±»æ¯ AQS æä¾çåºç±»ï¼æä»¬å¯ä»¥éè¿ç»§æ¿è¿ä¸ªç±»æ¥å®ç°èªå®ä¹çåæ­¥å¨ã\n\nå¨è¿ä¸ªç±»ä¸­ï¼æä»¬å®ä¹äº ownerThread å lockCount ä¸¤ä¸ªåéæ¥è®°å½å½åçº¿ç¨åå½åçº¿ç¨è·åéçæ¬¡æ°ãæä»¬éåäº tryAcquire å tryRelease æ¹æ³æ¥å®ç°è·åéåéæ¾éçé»è¾ã\n\nå¨ tryAcquire æ¹æ³ä¸­ï¼é¦åå¤æ­å½åçº¿ç¨æ¯å¦å·²ç»è·åäºéï¼å¦æå·²ç»è·åäºéåç´æ¥å¢å  lockCountãå¦åï¼æä»¬å°è¯ä½¿ç¨ compareAndSetState æ¹æ³æ¥æ´æ°ç¶æå¼ãå¦ææ´æ°æåï¼åå°å½åçº¿ç¨è®°å½ä¸º ownerThreadï¼åæ¶å° lockCount è®¾ç½®ä¸º 1ã\n\nå¨ tryRelease æ¹æ³ä¸­ï¼é¦åå¤æ­å½åçº¿ç¨æ¯å¦ä¸º ownerThreadï¼å¦æä¸æ¯åæåºå¼å¸¸ãç¶åæ ¹æ®ä¼ å¥çåæ°æ¥è®¡ç®æ°çç¶æå¼ï¼å¦æç¶æå¼ä¸º 0ï¼åå° ownerThread è®¾ç½®ä¸º nullï¼è¡¨ç¤ºå½åçº¿ç¨å·²ç»éæ¾äºéãæåï¼æä»¬è°ç¨ release æ¹æ³æ¥éæ¾åæ­¥ç¶æã\n\næä»¬è¿å®ä¹äº lock å unlock æ¹æ³ï¼åå«ç¨äºè·åéåéæ¾éãå¨è¿äºæ¹æ³ä¸­ï¼æä»¬ç´æ¥è°ç¨ acquire å release æ¹æ³æ¥å®ç°è·åéåéæ¾éçé»è¾ãacquire å release å¨ AQS ä¸­å°±ä¼å»è°ç¨ tryAcquire å tryReleaseï¼ä»èæ§è¡æä»¬éåçé»è¾ã\n\n\n# çè§£AQSä¸­çacquireæ¹æ³\n\nacquire() æ¯ AQS ä¸­çæ¹æ³ä¹ä¸ï¼ç¨äºè·åéï¼å¶åé¨å®ç°åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼\n\n 1. è°ç¨ tryAcquire() æ¹æ³å°è¯è·åéï¼å¦ææåï¼åç´æ¥è¿åã\n 2. å¦æ tryAcquire() æ¹æ³è¿åå¤±è´¥ï¼å°å½åçº¿ç¨åè£æèç¹ï¼Nodeï¼å¹¶å å¥å°ç­å¾éåä¸­ï¼å³ waiters éåï¼ï¼å¹¶å°è¯¥çº¿ç¨é»å¡ã\n 3. å½éè¢«éæ¾æ¶ï¼ä¼è°ç¨ release() æ¹æ³éæ¾éï¼è¯¥æ¹æ³ä¼å¤éç­å¾éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨ï¼å³éå¤´èç¹ï¼ï¼å¹¶å°å¶ä»éåä¸­ç§»é¤ã\n\néè¿ä¸è¿°æ­¥éª¤ï¼acquire() æ¹æ³å¯ä»¥å®ç°è·åéçæä½ï¼åæ¶è½å¤ä¿è¯å¤çº¿ç¨ä¸çå®å¨æ§ã\n\nè¿æ®µä»£ç æ¯ AQS ä¸­ acquire(int arg) æ¹æ³çå®ç°ï¼\n\npublic final void acquire(int arg) {\n        if (!tryAcquire(arg) &&\n            acquireQueued(addWaiter(Node.EXCLUSIVE), arg))\n            selfInterrupt();\n}\n\n\n 1. ç¬¬ä¸è¡ä»£ç ä¸­ç tryAcquire(arg) æ¯å°è¯è·åéï¼å¦æè¿åæåï¼åç´æ¥è¿åï¼è¿æ¯ä¸ä¸ªå¿«éè·¯å¾ï¼å¯ä»¥é¿ååå»ºèç¹åå å¥ç­å¾éåç­æä½ï¼æé«äºæ§è½ã\n 2. å¦æå¿«éè·¯å¾å¤±è´¥ï¼å°±éè¦è¿å¥å°æ¢éè·¯å¾ãå¶ä¸­ï¼addWaiter(Node.EXCLUSIVE) å°å½åçº¿ç¨å°è£æèç¹å¹¶æ·»å å°ç­å¾éåçå°¾é¨ï¼åæ¶è¿åè¯¥èç¹ã\n 3. acquireQueued(Node node, int arg) æ¯å°è¯è·åéçæ ¸å¿æ¹æ³ï¼å®ä¼è®©å½åçº¿ç¨è¿å¥ç­å¾éåå¹¶ç­å¾éçéæ¾ï¼ç´å°å®æåè·åéä¸ºæ­¢ãå½è·åéå¤±è´¥æ¶ï¼è¯¥æ¹æ³ä¼å°çº¿ç¨æèµ·å¹¶ç­å¾éçéæ¾ï¼åæ¶å¤çå¤çº¿ç¨ä¹é´çç«äºå³ç³»ãè¯¥æ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå½åçº¿ç¨æ¯å¦éè¦è¢«é»å¡ã\n 4. å½ acquireQueued() æ¹æ³è¿å true æ¶ï¼è¯´æå½åçº¿ç¨å·²ç»è¢«é»å¡ï¼éè¦è¢«å¤éï¼åæ¶éè¦è°ç¨ selfInterrupt() æ¹æ³èªæä¸­æ­ï¼ä¿è¯å¨è¢«å¤éåè½å¤åæ¶å¤çä¸­æ­ã\n\n\n# ä»ä¹æ¯ä¸­æ­\n\nä¸­æ­ï¼interruptï¼æ¯æä¸ä¸ªçº¿ç¨è¯·æ±ä¸­æ­¢å¦ä¸ä¸ªæ­£å¨è¿è¡ççº¿ç¨çæ§è¡ãå½ä¸ä¸ªçº¿ç¨è¯·æ±ä¸­æ­¢å¦ä¸ä¸ªçº¿ç¨æ¶ï¼éå¸¸ä¼å°ä¸ä¸ªä¿¡å·åéç»ç®æ çº¿ç¨ï¼è®©å¶åæ­¢æ­£å¨æ§è¡çä»»å¡å¹¶è¿è¡æ¸çå·¥ä½ã\n\nJavaä¸­çä¸­æ­æºå¶æ¯ä¸ç§åä½å¼æºå¶ï¼å³çº¿ç¨éè¦éåæè½å®ç°ä¸­æ­ãå½ä¸ä¸ªçº¿ç¨è°ç¨å¦ä¸ä¸ªçº¿ç¨ç interrupt() æ¹æ³æ¶ï¼ç®æ çº¿ç¨ä¼æ¶å°ä¸ä¸ªä¸­æ­è¯·æ±ï¼å¹¶è®¾ç½®ä¸ä¸ªä¸­æ­ç¶æï¼éç¥ç®æ çº¿ç¨ä¸­æ­è¯·æ±çåçãç®æ çº¿ç¨å¯ä»¥éè¿æ£æ¥èªèº«çä¸­æ­ç¶ææ¥ååºä¸­æ­è¯·æ±ï¼éå¸¸çåæ³æ¯å¨éå½çæ¶åæåº InterruptedException å¼å¸¸ï¼å¹¶å¨å¼å¸¸å¤çä¸­è¿è¡æ¸çå·¥ä½ã\n\néè¦æ³¨æçæ¯ï¼ä¸­æ­æºå¶å¹¶ä¸è½å¼ºå¶ç»æ­¢ä¸ä¸ªçº¿ç¨çæ§è¡ãçº¿ç¨å¯ä»¥å¨ä»»ä½æ¶å»æ£æ¥èªèº«çä¸­æ­ç¶æï¼å¹¶èªè¡å³å®æ¯å¦ååºä¸­æ­è¯·æ±ãå¦å¤ï¼å¦æçº¿ç¨æ²¡ææ§è¡å¯ä¸­æ­çæä½ï¼ä¾å¦å¿ç­å¾æèæ­»å¾ªç¯ï¼é£ä¹ä¸­æ­è¯·æ±æ¯æ æ³èµ·ä½ç¨çï¼çº¿ç¨ä»ç¶ä¼ä¸ç´æ§è¡ä¸å»ãå æ­¤ï¼å¨ç¼åå¤çº¿ç¨ç¨åºæ¶ï¼éè¦æ³¨æé¿åä½¿ç¨å¿ç­å¾åæ­»å¾ªç¯ç­æä½ï¼ä»¥ä¾¿è½å¤åæ¶ååºä¸­æ­è¯·æ±ã\n\n\n# èªæä¸­æ­\n\nèªæä¸­æ­æçæ¯çº¿ç¨å¨ç­å¾éçè¿ç¨ä¸­ï¼è¢«ä¸­æ­çæåµãå¨ Java ä¸­ï¼å¯ä»¥ä½¿ç¨ Thread.interrupt() æ¹æ³å¯¹ä¸ä¸ªçº¿ç¨è¿è¡ä¸­æ­æä½ï¼è¿æ¶çº¿ç¨å°±ä¼è¢«è®¾ç½®ä¸ºä¸­æ­ç¶æï¼ç¶åç±çº¿ç¨èªå·±å³å®å¦ä½å¤çä¸­æ­ã\n\nå¨ AQS ä¸­ï¼å¦æä¸ä¸ªçº¿ç¨å¨ç­å¾éçè¿ç¨ä¸­è¢«ä¸­æ­ï¼å°±ä¼è§¦åèªæä¸­æ­æä½ãè¿æ¶ï¼AQS ä¼å¨ç­å¾éåä¸­æ¾å°è¯¥çº¿ç¨å¯¹åºçèç¹ï¼å¹¶å°å¶æ è®°ä¸ºå·²ä¸­æ­ï¼ç¶åå¨ä¸ä¸æ¬¡è°ç¨ acquire() æ¹æ³æ¶ï¼ä¼æåº InterruptedException å¼å¸¸ãè¿æ ·ï¼çº¿ç¨å°±å¯ä»¥å¨ç­å¾éçè¿ç¨ä¸­ååºä¸­æ­ï¼é¿åå é¿æ¶é´ç­å¾éèå¯¼è´çº¿ç¨æ æ³éåºçé®é¢ã\n\nå¨ AQS ä¸­ï¼èªæä¸­æ­éå¸¸ä¸é»å¡å¼åæ­¥å¨ï¼ä¾å¦ ReentrantLockï¼éåä½¿ç¨ï¼å¯ä»¥æææé«å¤çº¿ç¨ç¨åºçååºè½åã',normalizedContent:'# ä»ä¹æ¯çº¿ç¨ï¼ä»ä¹æ¯è¿ç¨ï¼\n\nçº¿ç¨åè¿ç¨æ¯æä½ç³»ç»ä¸­çä¸¤ä¸ªéè¦æ¦å¿µï¼å®ä»¬é½æ¯å¹¶åæ§è¡çåºæ¬åä½ã\n\nè¿ç¨æ¯ç¨åºçä¸æ¬¡æ§è¡è¿ç¨ï¼æ¯æä½ç³»ç»èµæºåéçåºæ¬åä½ï¼æ¯ä¸ªè¿ç¨é½æç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦ãä¿¡å·å¤çåç¶æç­ä¿¡æ¯ãè¿ç¨å¯ä»¥åå»ºå­è¿ç¨ï¼ä¸åè¿ç¨ä¹é´çéä¿¡éè¦ä½¿ç¨è¿ç¨é´éä¿¡æºå¶ã\n\nçº¿ç¨æ¯è¿ç¨ä¸­çä¸ä¸ªæ§è¡ååï¼æ¯ç¨åºæ§è¡çæå°åä½ï¼æ¯ä¸ªçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´ãæä»¶æè¿°ç¬¦åå¶ä»èµæºãçº¿ç¨å¨åä¸è¿ç¨åæ§è¡ï¼å¯ä»¥è®¿é®å±äº«æ°æ®ï¼å æ­¤éè¦ä½¿ç¨åæ­¥æºå¶æ¥é¿åèµæºç«äºãçº¿ç¨ä¹é´çåæ¢æ¯è¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼ä¸éè¦è¿è¡èµæºçå¤å¶ååæ¢ã\n\næ»çæ¥è¯´ï¼è¿ç¨åçº¿ç¨é½æ¯æä½ç³»ç»ä¸­å¹¶åæ§è¡çåºæ¬åä½ï¼ä½è¿ç¨ä¹é´çéç¦»æ§æ´å¼ºï¼èµæºæ¶èæ´å¤§ï¼çº¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å±äº«èµæºæ´å¤ãå¨ç¼åç¨åºæ¶ï¼éè¦æ ¹æ®å·ä½çéæ±éæ©ä½¿ç¨è¿ç¨è¿æ¯çº¿ç¨æ¥å®ç°å¹¶åæ§è¡ã\n\n\n# çº¿ç¨çç¼ºç¹æä»ä¹ï¼\n\n * é¢ç¹çä¸ä¸æåæ¢ï¼å½ä¸ä¸ªçº¿ç¨éè¦è®¿é®å±äº«èµæºæ¶ï¼å¶ä»çº¿ç¨å¯è½ä¼è¢«æèµ·ï¼è¿ä¼å¯¼è´å¤§éçä¸ä¸æåæ¢ï¼éä½äºç³»ç»çæ§è½ã\n * èµæºç«äºï¼å¤ä¸ªçº¿ç¨è®¿é®åä¸å±äº«èµæºæ¶ï¼å¯è½ä¼å¯¼è´èµæºç«äºåæ­»éé®é¢ï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥è§£å³ã\n * åå­å ç¨ï¼æ¯ä¸ªçº¿ç¨é½éè¦ä¸å®çæ ç©ºé´åçº¿ç¨æ§å¶åç­èµæºï¼å½åå»ºå¤§éçº¿ç¨æ¶ï¼å¯è½ä¼å¯¼è´åå­å ç¨è¿é«ã\n * å¯é æ§é®é¢ï¼çº¿ç¨ä¹é´çéè¯¯åå¼å¸¸å¯è½ä¼å¯¼è´æ´ä¸ªç¨åºå´©æºï¼å æ­¤éè¦å°å¿å°ç¼ååç®¡ççº¿ç¨ä»£ç ã\n * å¤ææ§é®é¢ï¼çº¿ç¨ç¼ç¨éè¦èèçº¿ç¨ä¹é´çäº¤äºååæ­¥ï¼å¢å äºç¨åºçå¤ææ§åç»´æ¤é¾åº¦ã\n\n\n# æäºè¿ç¨ä¸ºä»ä¹è¿è¦çº¿ç¨ï¼\n\nè½ç¶è¿ç¨æ¯æä½ç³»ç»èµæºåéçåºæ¬åä½ï¼ä½æ¯çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼æ§è¡éåº¦æ´å¿«ï¼å æ­¤çº¿ç¨å¨å¹¶åç¼ç¨ä¸­æä»¥ä¸ä¼å¿ï¼\n\n * æ´å¿«çåæ¢ï¼çº¿ç¨ä¹é´çåæ¢æ¯è¿ç¨ä¹é´çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼ä¸éè¦è¿è¡èµæºçå¤å¶ååæ¢ãè¿æå³çå¨éè¦å¤§éå¹¶åæ§è¡çåºæ¯ä¸ï¼ä½¿ç¨çº¿ç¨å¯ä»¥æ´ææå°å©ç¨è®¡ç®èµæºã\n * æ´ä½çèµæºæ¶èï¼æ¯ä¸ªè¿ç¨é½éè¦ç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦åå¶ä»èµæºï¼å æ­¤è¿ç¨çèµæºæ¶èæ¯çº¿ç¨æ´å¤§ãä½¿ç¨çº¿ç¨å¯ä»¥åå°ç³»ç»èµæºçå ç¨ï¼æé«ç³»ç»çæ§è½ã\n * æ´å¥½çéä¿¡ååæ­¥ï¼çº¿ç¨å±äº«è¿ç¨çå°åç©ºé´åå¶ä»èµæºï¼å æ­¤çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å®¹æå®ç°ãå¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼å¯ä»¥ä½¿ç¨éãä¿¡å·éãæ¡ä»¶åéç­åæ­¥æºå¶æ¥åè°çº¿ç¨ä¹é´çæ§è¡ã\n * æ´å®¹æå®ç°å¹¶åç¼ç¨ï¼ä½¿ç¨çº¿ç¨å¯ä»¥æ´å®¹æå°å®ç°å¹¶åç¼ç¨ï¼å ä¸ºçº¿ç¨å¯ä»¥å©ç¨å¤æ ¸å¤çå¨å¹¶è¡æ§è¡ä»»å¡ï¼èä¸éè¦æå¨ç¼åå¤æçè¿ç¨é´éä¿¡ä»£ç ã\n\næ»ä¹ï¼å°½ç®¡è¿ç¨åçº¿ç¨é½å¯ä»¥å®ç°å¹¶åç¼ç¨ï¼ä½æ¯çº¿ç¨æ´éåäºéè¦é«æå©ç¨è®¡ç®èµæºçåºæ¯ï¼æ´å®¹æå®ç°éä¿¡ååæ­¥ï¼å¹¶ä¸ç¼åèµ·æ¥æ´å ç®åã\n\n\n# æäºçº¿ç¨ä¸ºä»ä¹è¦æè¿ç¨ï¼\n\nè½ç¶çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼ä½æ¯è¿ç¨å¨æä½ç³»ç»ä¸­ä»ç¶æ®æ¼çè³å³éè¦çè§è²ï¼æä»¥ä¸å ä¸ªæ¹é¢çä¼å¿ï¼\n\n * æ´å¼ºçéç¦»æ§ï¼æ¯ä¸ªè¿ç¨é½æç¬ç«çå°åç©ºé´ãæä»¶æè¿°ç¬¦ãä¿¡å·å¤çåç¶æç­ä¿¡æ¯ï¼å æ­¤ä¸åè¿ç¨ä¹é´çä»£ç åæ°æ®æ¯ç¸äºéç¦»çãè¿æ ·å¯ä»¥ä¿è¯ç¨åºçå®å¨æ§åç¨³å®æ§ï¼é¿åå ä¸ºä¸ä¸ªè¿ç¨çå´©æºå¯¼è´æ´ä¸ªç³»ç»å´©æºã\n * æ´å¥½çå¯é æ§ï¼è¿ç¨ä¹é´çéè¯¯åå¼å¸¸å¯ä»¥è¢«éç¦»ï¼é¿åä¸ä¸ªè¿ç¨çéè¯¯å½±åå¶ä»è¿ç¨çæ­£å¸¸è¿è¡ãæ­¤å¤ï¼è¿ç¨å¯ä»¥ä½¿ç¨æä½ç³»ç»æä¾ççæ§æºå¶æ¥æ£æµåæ¢å¤éè¯¯ï¼å¢å¼ºç¨åºçå¯é æ§åç¨³å®æ§ã\n * æ´å¤çç¼ç¨æ¨¡åï¼è¿ç¨å¯ä»¥ä½¿ç¨å¤ç§ç¼ç¨æ¨¡åæ¥å®ç°å¹¶åç¼ç¨ï¼åæ¬å¤è¿ç¨æ¨¡åãå¤çº¿ç¨æ¨¡åååç¨æ¨¡åç­ãè¿äºæ¨¡åå¯ä»¥æ ¹æ®ä¸åçéæ±éæ©ä½¿ç¨ï¼ä»èå®ç°æ´å çµæ´»çç¼ç¨ã\n * æ´å¤çèµæºï¼æ¯ä¸ªè¿ç¨é½å¯ä»¥æ¥æç¬ç«çèµæºï¼åæ¬æä»¶ãç«¯å£ãsocketç­ãè¿äºèµæºå¯ä»¥è¢«ä¸åçè¿ç¨æå±äº«ï¼ä»èå®ç°æ´å çµæ´»çèµæºç®¡çã\n\nè½ç¶çº¿ç¨æ¯è¿ç¨æ´è½»éçº§ï¼ä½æ¯è¿ç¨ä»ç¶æ¯æä½ç³»ç»ä¸­ä¸å¯æç¼ºçæ¦å¿µï¼å¯ä»¥æä¾æ´å¥½çéç¦»æ§ãå¯é æ§åç¼ç¨æ¨¡åã\n\n\n# çº¿ç¨é´çåå­æ¯å±äº«çåï¼\n\næ¯çï¼çº¿ç¨ä¹é´çåå­æ¯å±äº«çãå¨åä¸ä¸ªè¿ç¨ä¸­çææçº¿ç¨å±äº«åä¸ä»½å°åç©ºé´ï¼è¿æå³çå®ä»¬å¯ä»¥ç´æ¥è®¿é®åä¸ä»½åå­ï¼åæ¬å¨å±åéãéæåéãå¨æåéçåå­åå æ ç­ã\n\nå æ­¤ï¼å¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼éè¦ç¹å«æ³¨æçº¿ç¨é´çåå­è®¿é®ï¼ä»¥é¿ååºç°æ°æ®ç«äºç­é®é¢ãå¦æå¤ä¸ªçº¿ç¨åæ¶è¯»ååä¸ååå­ï¼å¯è½ä¼å¯¼è´æ°æ®çä¸ä¸è´ï¼è¿ç§°ä¸ºç«ææ¡ä»¶ãä¸ºäºé¿åè¿ç§æåµï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥åè°çº¿ç¨ä¹é´çè®¿é®ï¼æ¯å¦ä½¿ç¨éãä¿¡å·éãæ¡ä»¶åéç­ã\n\næ­¤å¤ï¼å¨å¤çº¿ç¨ç¼ç¨ä¸­ï¼è¿éè¦æ³¨æçº¿ç¨ä¹é´çåå­å¯è§æ§ãå¦æä¸ä¸ªçº¿ç¨ä¿®æ¹äºä¸ååå­ï¼å¶ä»çº¿ç¨å¯è½æ æ³ç«å³çå°è¿ä¸ªä¿®æ¹ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦ä½¿ç¨åæ­¥æºå¶æ¥ç¡®ä¿åå­å¯è§æ§ï¼æ¯å¦ä½¿ç¨volatileåéãmemory barrierç­ã\n\næ»ä¹ï¼çº¿ç¨ä¹é´çåå­æ¯å±äº«çï¼éè¦ç¹å«æ³¨æçº¿ç¨ä¹é´çåå­è®¿é®ååæ­¥ï¼ä»¥ç¡®ä¿ç¨åºçæ­£ç¡®æ§åæ§è½ã\n\n\n# javaä¸­çéæºå¶\n\njavaä¸­çéæºå¶ä¸»è¦åæ¬ä»¥ä¸å ç§ï¼\n\n * synchronizedå³é®å­ï¼synchronizedæ¯javaä¸­æåºæ¬çéæºå¶ï¼å®å¯ä»¥å®ç°å¯¹ä»£ç åãæ¹æ³æèå¯¹è±¡çåæ­¥è®¿é®ãsynchronizedå³é®å­å¯ä»¥ä¿è¯å¨åä¸æ¶å»åªæä¸ä¸ªçº¿ç¨å¯ä»¥è¿å¥è¢«éå®çä»£ç åææ¹æ³ï¼ä»èé¿åçº¿ç¨é´çæ°æ®ç«äºã\n\n * reentrantlockç±»ï¼reentrantlockæ¯javaä¸­çä¸ä¸ªå¯éå¥éï¼å®æä¾äºä¸synchronizedç¸ä¼¼çéæºå¶ï¼ä½æ¯æ´å çµæ´»åå¯æ©å±ãä¸synchronizedä¸åçæ¯ï¼reentrantlockå¯ä»¥å®ç°å¬å¹³éåéå¬å¹³éï¼å¯ä»¥æ¯æå¤ä¸ªæ¡ä»¶åéç­é«çº§ç¹æ§ã\n\n * readwritelockæ¥å£ï¼readwritelockæ¯javaä¸­çä¸ä¸ªè¯»åéæ¥å£ï¼å®å¯ä»¥å®ç°å¯¹å±äº«æ°æ®çè¯»ååç¦»ãreadwritelockåè®¸å¤ä¸ªçº¿ç¨åæ¶è¯»åå±äº«æ°æ®ï¼ä½æ¯åªåè®¸ä¸ä¸ªçº¿ç¨åå¥å±äº«æ°æ®ï¼ä»èé¿åäºè¯»åä¹é´çç«ææ¡ä»¶ã\n\n * stampedlockç±»ï¼stampedlockæ¯javaä¸­çä¸ä¸ªä¹è§è¯»åéï¼å®æä¾äºå¯¹å±äº«æ°æ®çè¯»åè®¿é®ï¼å¹¶æ¯ææ écasæä½ãstampedlockçä¹è§è¯»åæºå¶å¯ä»¥é¿åè¯»åå²çªçæåµä¸ä½¿ç¨æ²è§éå¸¦æ¥çæ§è½æå¤±ã\n\n * countdownlatchç±»ï¼countdownlatchæ¯javaä¸­çä¸ä¸ªåè®¡æ¶éï¼å®å¯ä»¥è®©ä¸ä¸ªçº¿ç¨ç­å¾å¤ä¸ªçº¿ç¨æ§è¡å®æ¯ä¹ååç»§ç»­æ§è¡ãcountdownlatchçè®¡æ°å¨åå§å¼å¯ä»¥è®¾ç½®ä¸ºå¤å°ä¸ªçº¿ç¨ï¼å½æ¯ä¸ªçº¿ç¨æ§è¡å®æ¯åå°±ä¼éåè®¡æ°å¨ï¼å½è®¡æ°å¨ä¸º0æ¶ï¼ç­å¾ççº¿ç¨å°±ä¼è¢«å¤éã\n\n * semaphoreç±»ï¼semaphoreæ¯javaä¸­çä¸ä¸ªä¿¡å·éï¼å®å¯ä»¥éå¶å¤ä¸ªçº¿ç¨å¯¹èµæºçè®¿é®ãsemaphoreçè®¡æ°å¨å¯ä»¥æå®å¤å°ä¸ªçº¿ç¨å¯ä»¥åæ¶è®¿é®èµæºï¼å½çº¿ç¨è®¿é®å®æ¯ä¹åï¼è®¡æ°å¨ä¼èªå¨éå¢ã\n\n * exchangerç±»ï¼exchangeræ¯javaä¸­çä¸ä¸ªçº¿ç¨é´äº¤æ¢æ°æ®çå·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸¤ä¸ªçº¿ç¨äº¤æ¢å½¼æ­¤çæ°æ®ãexchangerå¯ä»¥ç¨äºè§£å³çº¿ç¨ä¹é´çæ°æ®äº¤æ¢é®é¢ï¼ä¾å¦æ°æ®ä¼ è¾ãç¼å­æ± ç­åºæ¯ã\n\né¤äºä»¥ä¸åä¸¾çéæºå¶ï¼javaä¸­è¿æä¸äºå¶ä»çå¹¶åå·¥å·ç±»ï¼å¦semaphoreãcyclicbarrierãlocksupportç­ï¼å®ä»¬å¯ä»¥å¸®å©æä»¬æ´å æ¹ä¾¿åé«æå°å®ç°å¤çº¿ç¨ç¼ç¨ã\n\n\n# reentranlockæ¯æ²è§éè¿æ¯ä¹è§éï¼\n\nreentrantlock æ¯å±äºæ²è§éçèç´ã\n\næ²è§éæ¯ä¸ç§ä¿å®çéç­ç¥ï¼å®å¨ä½¿ç¨éä¹åæ»æ¯åè®¾æå¶ä»çº¿ç¨æ­£å¨ä½¿ç¨è¯¥å±äº«èµæºï¼å¹¶ä¸å¨å éåç´å°è§£éåé½ä¼å ç¨éï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®è¯¥å±äº«èµæºãè¿ç§ç­ç¥çä¼ç¹æ¯å¯ä»¥ææé¿åå¹¶åè®¿é®çå²çªï¼ä½åæ¶ä¹ä¼å¸¦æ¥ä¸å®çå¼éã\n\nreentrantlock å¨è¿è¡å éæä½æ¶ï¼ä¼å°è¯è·åéï¼å¦æå½åæ²¡æå¶ä»çº¿ç¨ææè¯¥éï¼åä¼æåè·åå¹¶å ç¨éï¼å¦ææå¶ä»çº¿ç¨ææè¯¥éï¼åå½åçº¿ç¨ä¼è¢«é»å¡ï¼ç­å¾å¶ä»çº¿ç¨éæ¾éãç±äº reentrantlock å¯ä»¥éå¥ï¼å³åä¸ä¸ªçº¿ç¨å¯ä»¥å¤æ¬¡è·ååä¸ä¸ªéèä¸ä¼é ææ­»éï¼æä»¥å®çå½åä¸­åå«äº "reentrant"ï¼å¯éå¥ï¼è¿ä¸è¯æ±ã\n\nä¸ä¹è§éä¸åï¼æ²è§éçä¸»è¦ç¹ç¹æ¯å¨è®¿é®å±äº«èµæºä¹åï¼æ»æ¯åè·åéï¼å æ­¤ reentrantlock ä¸å±äºä¹è§éçèç´ã\n\n\n# æ²è§éåä¹è§éçåºå«\n\næ²è§éåä¹è§éæ¯ä¸¤ç§å¹¶åæ§å¶çç­ç¥ï¼å®ä»¬çåºå«å¦ä¸ï¼\n\n * æ§è½å·®å¼ï¼æ²è§éå¨ä½¿ç¨éä¹åæ»æ¯åè®¾æå¶ä»çº¿ç¨æ­£å¨ä½¿ç¨è¯¥å±äº«èµæºï¼å¹¶ä¸å¨å éåç´å°è§£éåé½ä¼å ç¨éï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®è¯¥å±äº«èµæºãè¿ç§ç­ç¥çä¼ç¹æ¯å¯ä»¥ææé¿åå¹¶åè®¿é®çå²çªï¼ä½åæ¶ä¹ä¼å¸¦æ¥ä¸å®çå¼éãä¹è§éååè®¾å¹¶åå²çªä¸ä¼åçï¼ç´æ¥è¿è¡å¹¶åæä½ï¼å¦æåç°å²çªåè¿è¡åæ»æéè¯ãå æ­¤ï¼ä¹è§éçæ§è½ä¸è¬æ¯æ²è§éè¦å¥½ã\n * å®ç°æ¹å¼ï¼æ²è§éçå®ç°æ¹å¼éå¸¸æ¯ä½¿ç¨ synchronizedãreentrantlock ç­éæºå¶ï¼èä¹è§éçå®ç°æ¹å¼éå¸¸æ¯ä½¿ç¨ casï¼compare and swapï¼ç­ä¹è§å¹¶åæ§å¶æºå¶ã\n * å²çªè§£å³æ¹å¼ï¼æ²è§éå¨å éæé´ï¼é»æ­¢å¶ä»çº¿ç¨è®¿é®å±äº«èµæºï¼ä»èé¿åå¹¶åå²çªãä¹è§éååè®¾å¹¶åå²çªä¸ä¼åçï¼å¨æä½ç»æåæä¼æ£æ¥å¹¶åå²çªï¼å¦æåç°å²çªåè¿è¡åæ»æéè¯ã\n * åºç¨åºæ¯ï¼æ²è§ééç¨äºå¹¶åå²çªæ¦çè¾é«çåºæ¯ï¼ä¾å¦å¨é«å¹¶åè®¿é®æ°æ®åºæ¶ï¼ç±äºæ¯æ¬¡è®¿é®éè¦è·åç¬å éï¼å æ­¤æ²è§éçææä¼æ¯è¾å¥½ãèä¹è§ééç¨äºå¹¶åå²çªæ¦çè¾ä½çåºæ¯ï¼ä¾å¦å¨åæºå¤çº¿ç¨ç¯å¢ä¸ï¼ç±äºå¹¶åå²çªæ¦çè¾ä½ï¼ä½¿ç¨ä¹è§éå¯ä»¥æé«æ§è½ã\n\n\n# javaä¸­ä¹è§éçå®ç°\n\nå¨ java ä¸­ï¼ä¹è§éä¸»è¦æä¸¤ç§å®ç°æ¹å¼ï¼cas åçæ¬å·ã\n\n\n# casï¼compare and swapï¼å®ç°ä¹è§é\n\ncas æ¯ä¸ç§ä¹è§éçå®ç°æ¹å¼ï¼å®ä½¿ç¨åå­æ§æä½æ¥å®ç°å¹¶åæ§å¶ãcas æä½éè¦æä¾è¦æ´æ°çåéçå¼ãé¢æå¼åæ°å¼ï¼å¦æå½ååéçå¼ç­äºé¢æå¼ï¼å°±ä½¿ç¨æ°å¼æ´æ°åéå¹¶è¿å trueï¼å¦åä¸åä»»ä½æä½å¹¶è¿å falseã\n\njava ä¸­ç atomicinteger å atomiclong ç±»å°±æ¯ä½¿ç¨ cas å®ç°ä¹è§éçå¸åä¾å­ãä½¿ç¨ cas å®ç°ä¹è§éæ¶ï¼éè¦æ³¨æ cas æä½å¯è½ä¼åºç° aba é®é¢ï¼éè¦é¢å¤çå¤çæªæ½æ¥è§£å³è¿ä¸ªé®é¢ã\n\n\n# çæ¬å·å®ç°ä¹è§é\n\nå¦ä¸ç§å®ç°ä¹è§éçæ¹å¼æ¯éè¿çæ¬å·å®ç°ãå¨å®ç°çæ¬å·ä¹è§éæ¶ï¼æ¯ä¸ªå±äº«æ°æ®é½æä¸ä¸ªçæ¬å·ï¼æ¯æ¬¡æ´æ°æ¶é½éè¦æ¯è¾å½åçæ¬å·åè¦æ´æ°çæ°æ®ççæ¬å·ï¼å¦æä¸è´ï¼åæ´æ°æåï¼å¹¶å¢å çæ¬å·ï¼å¦åæ´æ°å¤±è´¥ã\n\nå¨ java ä¸­ï¼å®ç°çæ¬å·ä¹è§éå¯ä»¥ä½¿ç¨ atomicstampedreference ç±»ï¼å®å¯ä»¥å¯¹ä¸ä¸ªå¯¹è±¡çå¼ç¨åçæ¬å·è¿è¡åå­æä½ãä½¿ç¨ atomicstampedreference æ¶éè¦æ³¨æï¼æ¯æ¬¡æ´æ°æ¶éè¦åæ¶æ´æ°å¯¹è±¡å¼ç¨åçæ¬å·ï¼å¦åå¯è½ä¼åºç°æ°æ®ä¸ä¸è´çé®é¢ã\n\n\n# javaä¸­ä¹è§éçç±»\n\njavaä¸­ä¹è§éçå®ç°ç±»åæ¬ï¼\n\n * atomic åä¸çåå­ç±»ï¼ä¾å¦ atomicintegerãatomiclongãatomicreference ç­ï¼è¿äºç±»æä¾äºåå­æ§çæä½æ¹æ³ï¼å¯ä»¥å®ç°ä¹è§éæºå¶ã\n\n * casï¼compare and swapï¼ï¼cas æ¯ä¹è§éçä¸ç§å®ç°æ¹å¼ï¼java ä¸­æä¾äº sun.misc.unsafe ç±»ç compareandswapxxx() æ¹æ³ï¼å¯ä»¥ç¨äºå®ç° cas æä½ã\n\n * ä¹è§éæ¡æ¶ï¼java ä¸­æä¸äºå¼æºçä¹è§éæ¡æ¶ï¼ä¾å¦ jpa çä¹è§éãspring ä¸­çä¹è§éç­ï¼è¿äºæ¡æ¶å°è£äºä¹è§éçå®ç°ç»èï¼ä½¿å¾å¼åèå¯ä»¥æ´æ¹ä¾¿å°ä½¿ç¨ä¹è§éæºå¶ã\n\néè¦æ³¨æçæ¯ï¼å¨ä½¿ç¨ä¹è§éæ¶éè¦ç¹å«å³æ³¨å¹¶åå²çªçå¤çï¼å ä¸ºä¹è§éä¸ä¼é»å¡å¶ä»çº¿ç¨ï¼æä»¥å¯è½ä¼åºç°å¤ä¸ªçº¿ç¨åæ¶è¿è¡ä¿®æ¹å¯¼è´å²çªçæåµï¼è¿æ¶éè¦ä½¿ç¨ä¸äºç¹æ®çç®æ³æèææ¯æ¥è§£å³ã\n\n\n# springä¸­çä¹è§é\n\nspring ä¸­æä¾äºä¸¤ç§ä¹è§éå®ç°æ¹å¼ï¼\n\n * åºäºçæ¬å·ï¼versionï¼çä¹è§éï¼è¯¥å®ç°æ¹å¼æ¯éè¿ä¸ºæ¯æ¡è®°å½å¢å ä¸ä¸ªçæ¬å·å­æ®µï¼å¨æ´æ°è®°å½æ¶æ¯è¾çæ¬å·æ¯å¦ä¸è´æ¥å¤æ­æ¯å¦åçäºå¹¶åå²çªãå¨ spring ä¸­ï¼å¯ä»¥éè¿ @version æ³¨è§£æ¥æå®çæ¬å·å­æ®µï¼åæ¶å¨æ§è¡æ´æ°æä½æ¶ï¼spring ä¼èªå¨æ£æ¥çæ¬å·å¹¶è¿è¡å¹¶åå²çªæ£æµåå¤çã\n * åºäºæ¶é´æ³ï¼timestampï¼çä¹è§éï¼è¯¥å®ç°æ¹å¼æ¯éè¿ä¸ºæ¯æ¡è®°å½å¢å ä¸ä¸ªæ¶é´æ³å­æ®µï¼å¨æ´æ°è®°å½æ¶æ¯è¾æ¶é´æ³æ¯å¦ä¸è´æ¥å¤æ­æ¯å¦åçäºå¹¶åå²çªãå¨ spring ä¸­ï¼å¯ä»¥éè¿ @timestamp æ³¨è§£æ¥æå®æ¶é´æ³å­æ®µï¼åæ¶å¨æ§è¡æ´æ°æä½æ¶ï¼spring ä¼èªå¨æ£æ¥æ¶é´æ³å¹¶è¿è¡å¹¶åå²çªæ£æµåå¤çã\n\néè¦æ³¨æçæ¯ï¼å¨ä½¿ç¨ spring çä¹è§éæºå¶æ¶ï¼éè¦ç¡®ä¿æ°æ®åºä¸­æ¯æä¹è§éå®ç°æéè¦ççæ¬å·ææ¶é´æ³å­æ®µï¼åæ¶éè¦ç¹å«å³æ³¨å¹¶åå²çªçå¤çï¼ç¡®ä¿å¨å¹¶åè®¿é®æ¶ä¸ä¼åçæ°æ®ä¸ä¸è´çæåµã\n\n\n# mysqlæ¯æçæ¬å·åæ¶é´æ³å­æ®µ\n\n 1. åºäºçæ¬å·çä¹è§éï¼å¨ mysql ä¸­ï¼å¯ä»¥ä½¿ç¨ int æ bigint ç±»åçå­æ®µä½ä¸ºçæ¬å·å­æ®µï¼å¹¶å¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ where å­å¥éå¶çæ¬å·ç¸åçè®°å½æè½è¢«æ´æ°ï¼ä»èå®ç°ä¹è§éæ§å¶ã\n    \n    ä¾å¦ï¼åå»ºä¸ä¸ªåå«çæ¬å·çè¡¨ï¼\n\ncreate table `user` (\n  `id` bigint(20) not null auto_increment,\n  `name` varchar(255) default null,\n  `age` int(11) default null,\n  `version` int(11) default 0,\n  primary key (`id`)\n) engine=innodb default charset=utf8mb4;\n\n\nå¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ç±»ä¼¼ä»¥ä¸ç sql è¯­å¥è¿è¡çæ¬å·çæ¯è¾åæ´æ°ï¼\n\nupdate `user` set `age` = #{age}, `version` = `version` + 1 where `id` = #{id} and `version` = #{version};\n\n\nå¶ä¸­ï¼#{id} å #{version} åå«è¡¨ç¤ºéè¦æ´æ°çè®°å½ç id åçæ¬å·ï¼#{age} è¡¨ç¤ºéè¦æ´æ°çå¹´é¾å¼ã\n\n 2. åºäºæ¶é´æ³çä¹è§éï¼å¨ mysql ä¸­ï¼å¯ä»¥ä½¿ç¨ timestamp æ datetime ç±»åçå­æ®µä½ä¸ºæ¶é´æ³å­æ®µï¼å¹¶å¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ where å­å¥éå¶æ¶é´æ³ç¸åçè®°å½æè½è¢«æ´æ°ï¼ä»èå®ç°ä¹è§éæ§å¶ã\n\nä¾å¦ï¼åå»ºä¸ä¸ªåå«æ¶é´æ³çè¡¨ï¼\n\ncreate table `user` (\n  `id` bigint(20) not null auto_increment,\n  `name` varchar(255) default null,\n  `age` int(11) default null,\n  `update_time` timestamp not null default current_timestamp on update current_timestamp,\n  primary key (`id`)\n) engine=innodb default charset=utf8mb4;\n\n\nå¨æ´æ°è®°å½æ¶ï¼ä½¿ç¨ç±»ä¼¼ä»¥ä¸ç sql è¯­å¥è¿è¡æ¶é´æ³çæ¯è¾åæ´æ°ï¼\n\nupdate `user` set `age` = #{age}, `update_time` = #{updatetime} where `id` = #{id} and `update_time` = #{updatetime};\n\n\nå¶ä¸­ï¼#{id} å #{updatetime} åå«è¡¨ç¤ºéè¦æ´æ°çè®°å½ç id åæ¶é´æ³ï¼#{age} è¡¨ç¤ºéè¦æ´æ°çå¹´é¾å¼ã\n\n\n# spring @version æ¡ä¾\n\n@version æ³¨è§£å¯ä»¥ç¨äºæå®å®ä½ç±»ä¸­ççæ¬å·å­æ®µï¼ä»¥ä¾¿å¨æ´æ°æä½æ¶è¿è¡ä¹è§éæ§å¶ãä¸é¢æ¯ä¸ä¸ªç®åçç¤ºä¾ï¼\n\nåè®¾æä»¬æä¸ä¸ª user å®ä½ç±»ï¼å¶ä¸­åå«äºä¸ä¸ª version å­æ®µè¡¨ç¤ºçæ¬å·ï¼å¯ä»¥ä½¿ç¨ @version æ³¨è§£æ¥æ è¯ï¼\n\n@entity\n@table(name = "user")\npublic class user {\n\n    @id\n    @generatedvalue(strategy = generationtype.identity)\n    private long id;\n\n    @column(name = "name")\n    private string name;\n\n    @column(name = "age")\n    private integer age;\n\n    @version\n    @column(name = "version")\n    private integer version;\n    \n    // getter and setter methods\n}\n\n\nå¨è¿è¡æ´æ°æä½æ¶ï¼å¯ä»¥éè¿è°ç¨ spring data jpa æä¾ç save() æ¹æ³æ¥å®ç°ä¹è§éæ§å¶ãä¾å¦ï¼\n\n@service\npublic class userservice {\n\n    @autowired\n    private userrepository userrepository;\n\n    public void update(user user) {\n        userrepository.save(user);\n    }\n}\n\n\nå½è°ç¨ update() æ¹æ³æ´æ° user å®ä½æ¶ï¼spring data jpa ä¼èªå¨æ£æ¥ version å­æ®µçå¼æ¯å¦ä¸æ°æ®åºä¸­çä¸è´ï¼å¦æä¸è´åæ§è¡æ´æ°æä½ï¼å¦åæåº optimisticlockexception å¼å¸¸ãä¾å¦ï¼\n\nuser user = userrepository.findbyid(1l).orelsethrow();\nuser.setage(30);\nuserservice.update(user);\n\n\nå¨ä¸è¿°ä»£ç ä¸­ï¼é¦åéè¿ userrepository æ¥è¯¢å° id ä¸º 1 ç user å®ä½ï¼å¹¶å°å¶å¹´é¾ä¿®æ¹ä¸º 30ãæ¥çï¼è°ç¨ userservice ç update() æ¹æ³è¿è¡æ´æ°æä½ï¼æ­¤æ¶ spring data jpa ä¼æ£æ¥ user å®ä½ç version å­æ®µæ¯å¦ä¸æ°æ®åºä¸­çä¸è´ï¼å¦æä¸è´åæ§è¡æ´æ°æä½ï¼å¦åæåº optimisticlockexception å¼å¸¸ã\n\n\n# aqs\n\naqsï¼abstractqueuedsynchronizerï¼æ¯ java å¹¶ååä¸­éååæ­¥å¨çæ ¸å¿å®ç°ï¼å®éè¿ä¸ä¸ªååéååä¸ä¸ªæ´å½¢ç¶æå¼æ¥ç®¡çåæ­¥ç¶æï¼å¹¶æä¾äº acquire å release ä¸¤ä¸ªä¸»è¦çåæ­¥æä½ã\n\naqs åé¨ç»´æ¤äºä¸ä¸ªç±»ä¼¼äºååé¾è¡¨çéåï¼éåä¸­çèç¹è¡¨ç¤ºæ­£å¨ç­å¾è·åéççº¿ç¨ãå½ä¸ä¸ªçº¿ç¨å°è¯è·åéæ¶ï¼å¦æéå·²ç»è¢«å¶ä»çº¿ç¨å ç¨ï¼åè¯¥çº¿ç¨ä¼è¢«å å¥å°éåçæ«å°¾ï¼å¹¶è¢«é»å¡ãå½éçå ç¨èéæ¾éæ¶ï¼aqs ä¼å°éåå¤´é¨ççº¿ç¨å¤éï¼å¹¶è®©å¶å°è¯è·åéã\n\naqs åé¨çç¶æå¼å¯ä»¥ç¨æ¥è¡¨ç¤ºéçå ç¨ç¶æï¼åæ¶ä¹å¯ä»¥è¢«å­ç±»ç¨æ¥è¡¨ç¤ºèªå®ä¹çåæ­¥ç¶æãå¨ä½¿ç¨ aqs å®ç°åæ­¥å¨æ¶ï¼ä¸è¬éè¦ç»§æ¿ aqs ç±»ï¼å¹¶éè¿å®ç° tryacquireãtryrelease ç­æ¹æ³æ¥å®ç°åæ­¥å¨çå éåéæ¾éæä½ï¼åæ¶éè¦æ ¹æ®å·ä½éæ±è¦ç aqs ä¸­çä¸äºæ¹æ³æ¥å®ç°èªå®ä¹çåæ­¥ç­ç¥ã\n\naqs åé¨çæ ¸å¿æ¹æ³æä»¥ä¸å ä¸ªï¼\n\n * acquire(int arg): å°è¯è·åéï¼å¦æè·åå¤±è´¥åé»å¡ç­å¾ã\n\n * release(int arg): éæ¾éï¼å¹¶å¤éç­å¾éåä¸­çä¸ä¸ªçº¿ç¨ã\n\n * tryacquire(int arg): å°è¯è·åéï¼è¿å true è¡¨ç¤ºè·åæåï¼è¿å false è¡¨ç¤ºè·åå¤±è´¥ã\n\n * tryrelease(int arg): å°è¯éæ¾éï¼è¿å true è¡¨ç¤ºéæ¾æåï¼è¿å false è¡¨ç¤ºéæ¾å¤±è´¥ã\n\n * tryacquireshared(int arg): å°è¯è·åå±äº«éï¼è¿åå¼çå«ä¹ä¸ tryacquire ç¸åã\n\n * tryreleaseshared(int arg): å°è¯éæ¾å±äº«éï¼è¿åå¼çå«ä¹ä¸ tryrelease ç¸åã\n\naqs æ¯ java å¹¶ååä¸­éååæ­¥å¨çæ ¸å¿å®ç°ï¼ä½¿ç¨ aqs å®ç°åæ­¥å¨æ¶éè¦å¯¹ aqs çåçåæºå¶æä¸å®çäºè§£ï¼æè½ä¿è¯å®ç°çæ­£ç¡®æ§åé«ææ§ãåæ¶ï¼ä½¿ç¨ aqs å®ç°åæ­¥å¨éè¦è°¨æï¼å¦åå®¹æåºç°æ­»éç­é®é¢ã\n\n\n# aqså®ç°reentrantlock\n\nimport java.util.concurrent.locks.abstractqueuedsynchronizer;\n\npublic class reentrantlock extends abstractqueuedsynchronizer {\n    private thread ownerthread;\n    private int lockcount;\n\n    public reentrantlock() {\n        ownerthread = null;\n        lockcount = 0;\n    }\n\n    @override\n    protected boolean tryacquire(int arg) {\n        thread currentthread = thread.currentthread();\n        int c = getstate();\n        if (c == 0) {\n            if (compareandsetstate(0, arg)) {\n                ownerthread = currentthread;\n                lockcount++;\n                return true;\n            }\n        } else if (currentthread == ownerthread) {\n            setstate(c + arg);\n            lockcount++;\n            return true;\n        }\n        return false;\n    }\n\n    @override\n    protected boolean tryrelease(int arg) {\n        thread currentthread = thread.currentthread();\n        if (currentthread != ownerthread) {\n            throw new illegalmonitorstateexception("not owner thread");\n        }\n\n        int c = getstate() - arg;\n        boolean free = false;\n        if (c == 0) {\n            free = true;\n            ownerthread = null;\n        }\n        setstate(c);\n        if (free) {\n            release();\n        }\n        return true;\n    }\n\n    public void lock() {\n        acquire(1);\n    }\n\n    public void unlock() {\n        release(1);\n    }\n}\n\n\nå¨ä¸é¢çç¤ºä¾ä»£ç ä¸­ï¼æä»¬èªå®ä¹äºä¸ä¸ª reentrantlock ç±»ï¼ç»§æ¿äº abstractqueuedsynchronizer ç±»ã\n\nè¿ä¸ªç±»æ¯ aqs æä¾çåºç±»ï¼æä»¬å¯ä»¥éè¿ç»§æ¿è¿ä¸ªç±»æ¥å®ç°èªå®ä¹çåæ­¥å¨ã\n\nå¨è¿ä¸ªç±»ä¸­ï¼æä»¬å®ä¹äº ownerthread å lockcount ä¸¤ä¸ªåéæ¥è®°å½å½åçº¿ç¨åå½åçº¿ç¨è·åéçæ¬¡æ°ãæä»¬éåäº tryacquire å tryrelease æ¹æ³æ¥å®ç°è·åéåéæ¾éçé»è¾ã\n\nå¨ tryacquire æ¹æ³ä¸­ï¼é¦åå¤æ­å½åçº¿ç¨æ¯å¦å·²ç»è·åäºéï¼å¦æå·²ç»è·åäºéåç´æ¥å¢å  lockcountãå¦åï¼æä»¬å°è¯ä½¿ç¨ compareandsetstate æ¹æ³æ¥æ´æ°ç¶æå¼ãå¦ææ´æ°æåï¼åå°å½åçº¿ç¨è®°å½ä¸º ownerthreadï¼åæ¶å° lockcount è®¾ç½®ä¸º 1ã\n\nå¨ tryrelease æ¹æ³ä¸­ï¼é¦åå¤æ­å½åçº¿ç¨æ¯å¦ä¸º ownerthreadï¼å¦æä¸æ¯åæåºå¼å¸¸ãç¶åæ ¹æ®ä¼ å¥çåæ°æ¥è®¡ç®æ°çç¶æå¼ï¼å¦æç¶æå¼ä¸º 0ï¼åå° ownerthread è®¾ç½®ä¸º nullï¼è¡¨ç¤ºå½åçº¿ç¨å·²ç»éæ¾äºéãæåï¼æä»¬è°ç¨ release æ¹æ³æ¥éæ¾åæ­¥ç¶æã\n\næä»¬è¿å®ä¹äº lock å unlock æ¹æ³ï¼åå«ç¨äºè·åéåéæ¾éãå¨è¿äºæ¹æ³ä¸­ï¼æä»¬ç´æ¥è°ç¨ acquire å release æ¹æ³æ¥å®ç°è·åéåéæ¾éçé»è¾ãacquire å release å¨ aqs ä¸­å°±ä¼å»è°ç¨ tryacquire å tryreleaseï¼ä»èæ§è¡æä»¬éåçé»è¾ã\n\n\n# çè§£aqsä¸­çacquireæ¹æ³\n\nacquire() æ¯ aqs ä¸­çæ¹æ³ä¹ä¸ï¼ç¨äºè·åéï¼å¶åé¨å®ç°åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼\n\n 1. è°ç¨ tryacquire() æ¹æ³å°è¯è·åéï¼å¦ææåï¼åç´æ¥è¿åã\n 2. å¦æ tryacquire() æ¹æ³è¿åå¤±è´¥ï¼å°å½åçº¿ç¨åè£æèç¹ï¼nodeï¼å¹¶å å¥å°ç­å¾éåä¸­ï¼å³ waiters éåï¼ï¼å¹¶å°è¯¥çº¿ç¨é»å¡ã\n 3. å½éè¢«éæ¾æ¶ï¼ä¼è°ç¨ release() æ¹æ³éæ¾éï¼è¯¥æ¹æ³ä¼å¤éç­å¾éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨ï¼å³éå¤´èç¹ï¼ï¼å¹¶å°å¶ä»éåä¸­ç§»é¤ã\n\néè¿ä¸è¿°æ­¥éª¤ï¼acquire() æ¹æ³å¯ä»¥å®ç°è·åéçæä½ï¼åæ¶è½å¤ä¿è¯å¤çº¿ç¨ä¸çå®å¨æ§ã\n\nè¿æ®µä»£ç æ¯ aqs ä¸­ acquire(int arg) æ¹æ³çå®ç°ï¼\n\npublic final void acquire(int arg) {\n        if (!tryacquire(arg) &&\n            acquirequeued(addwaiter(node.exclusive), arg))\n            selfinterrupt();\n}\n\n\n 1. ç¬¬ä¸è¡ä»£ç ä¸­ç tryacquire(arg) æ¯å°è¯è·åéï¼å¦æè¿åæåï¼åç´æ¥è¿åï¼è¿æ¯ä¸ä¸ªå¿«éè·¯å¾ï¼å¯ä»¥é¿ååå»ºèç¹åå å¥ç­å¾éåç­æä½ï¼æé«äºæ§è½ã\n 2. å¦æå¿«éè·¯å¾å¤±è´¥ï¼å°±éè¦è¿å¥å°æ¢éè·¯å¾ãå¶ä¸­ï¼addwaiter(node.exclusive) å°å½åçº¿ç¨å°è£æèç¹å¹¶æ·»å å°ç­å¾éåçå°¾é¨ï¼åæ¶è¿åè¯¥èç¹ã\n 3. acquirequeued(node node, int arg) æ¯å°è¯è·åéçæ ¸å¿æ¹æ³ï¼å®ä¼è®©å½åçº¿ç¨è¿å¥ç­å¾éåå¹¶ç­å¾éçéæ¾ï¼ç´å°å®æåè·åéä¸ºæ­¢ãå½è·åéå¤±è´¥æ¶ï¼è¯¥æ¹æ³ä¼å°çº¿ç¨æèµ·å¹¶ç­å¾éçéæ¾ï¼åæ¶å¤çå¤çº¿ç¨ä¹é´çç«äºå³ç³»ãè¯¥æ¹æ³è¿åä¸ä¸ªå¸å°å¼ï¼è¡¨ç¤ºå½åçº¿ç¨æ¯å¦éè¦è¢«é»å¡ã\n 4. å½ acquirequeued() æ¹æ³è¿å true æ¶ï¼è¯´æå½åçº¿ç¨å·²ç»è¢«é»å¡ï¼éè¦è¢«å¤éï¼åæ¶éè¦è°ç¨ selfinterrupt() æ¹æ³èªæä¸­æ­ï¼ä¿è¯å¨è¢«å¤éåè½å¤åæ¶å¤çä¸­æ­ã\n\n\n# ä»ä¹æ¯ä¸­æ­\n\nä¸­æ­ï¼interruptï¼æ¯æä¸ä¸ªçº¿ç¨è¯·æ±ä¸­æ­¢å¦ä¸ä¸ªæ­£å¨è¿è¡ççº¿ç¨çæ§è¡ãå½ä¸ä¸ªçº¿ç¨è¯·æ±ä¸­æ­¢å¦ä¸ä¸ªçº¿ç¨æ¶ï¼éå¸¸ä¼å°ä¸ä¸ªä¿¡å·åéç»ç®æ çº¿ç¨ï¼è®©å¶åæ­¢æ­£å¨æ§è¡çä»»å¡å¹¶è¿è¡æ¸çå·¥ä½ã\n\njavaä¸­çä¸­æ­æºå¶æ¯ä¸ç§åä½å¼æºå¶ï¼å³çº¿ç¨éè¦éåæè½å®ç°ä¸­æ­ãå½ä¸ä¸ªçº¿ç¨è°ç¨å¦ä¸ä¸ªçº¿ç¨ç interrupt() æ¹æ³æ¶ï¼ç®æ çº¿ç¨ä¼æ¶å°ä¸ä¸ªä¸­æ­è¯·æ±ï¼å¹¶è®¾ç½®ä¸ä¸ªä¸­æ­ç¶æï¼éç¥ç®æ çº¿ç¨ä¸­æ­è¯·æ±çåçãç®æ çº¿ç¨å¯ä»¥éè¿æ£æ¥èªèº«çä¸­æ­ç¶ææ¥ååºä¸­æ­è¯·æ±ï¼éå¸¸çåæ³æ¯å¨éå½çæ¶åæåº interruptedexception å¼å¸¸ï¼å¹¶å¨å¼å¸¸å¤çä¸­è¿è¡æ¸çå·¥ä½ã\n\néè¦æ³¨æçæ¯ï¼ä¸­æ­æºå¶å¹¶ä¸è½å¼ºå¶ç»æ­¢ä¸ä¸ªçº¿ç¨çæ§è¡ãçº¿ç¨å¯ä»¥å¨ä»»ä½æ¶å»æ£æ¥èªèº«çä¸­æ­ç¶æï¼å¹¶èªè¡å³å®æ¯å¦ååºä¸­æ­è¯·æ±ãå¦å¤ï¼å¦æçº¿ç¨æ²¡ææ§è¡å¯ä¸­æ­çæä½ï¼ä¾å¦å¿ç­å¾æèæ­»å¾ªç¯ï¼é£ä¹ä¸­æ­è¯·æ±æ¯æ æ³èµ·ä½ç¨çï¼çº¿ç¨ä»ç¶ä¼ä¸ç´æ§è¡ä¸å»ãå æ­¤ï¼å¨ç¼åå¤çº¿ç¨ç¨åºæ¶ï¼éè¦æ³¨æé¿åä½¿ç¨å¿ç­å¾åæ­»å¾ªç¯ç­æä½ï¼ä»¥ä¾¿è½å¤åæ¶ååºä¸­æ­è¯·æ±ã\n\n\n# èªæä¸­æ­\n\nèªæä¸­æ­æçæ¯çº¿ç¨å¨ç­å¾éçè¿ç¨ä¸­ï¼è¢«ä¸­æ­çæåµãå¨ java ä¸­ï¼å¯ä»¥ä½¿ç¨ thread.interrupt() æ¹æ³å¯¹ä¸ä¸ªçº¿ç¨è¿è¡ä¸­æ­æä½ï¼è¿æ¶çº¿ç¨å°±ä¼è¢«è®¾ç½®ä¸ºä¸­æ­ç¶æï¼ç¶åç±çº¿ç¨èªå·±å³å®å¦ä½å¤çä¸­æ­ã\n\nå¨ aqs ä¸­ï¼å¦æä¸ä¸ªçº¿ç¨å¨ç­å¾éçè¿ç¨ä¸­è¢«ä¸­æ­ï¼å°±ä¼è§¦åèªæä¸­æ­æä½ãè¿æ¶ï¼aqs ä¼å¨ç­å¾éåä¸­æ¾å°è¯¥çº¿ç¨å¯¹åºçèç¹ï¼å¹¶å°å¶æ è®°ä¸ºå·²ä¸­æ­ï¼ç¶åå¨ä¸ä¸æ¬¡è°ç¨ acquire() æ¹æ³æ¶ï¼ä¼æåº interruptedexception å¼å¸¸ãè¿æ ·ï¼çº¿ç¨å°±å¯ä»¥å¨ç­å¾éçè¿ç¨ä¸­ååºä¸­æ­ï¼é¿åå é¿æ¶é´ç­å¾éèå¯¼è´çº¿ç¨æ æ³éåºçé®é¢ã\n\nå¨ aqs ä¸­ï¼èªæä¸­æ­éå¸¸ä¸é»å¡å¼åæ­¥å¨ï¼ä¾å¦ reentrantlockï¼éåä½¿ç¨ï¼å¯ä»¥æææé«å¤çº¿ç¨ç¨åºçååºè½åã',charsets:{cjk:!0}},{title:"CopyOnWriteArrayList",frontmatter:{title:"CopyOnWriteArrayList",date:"2023-04-12T22:12:32.000Z",permalink:"/pages/9c98d8/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/08.CopyOnWriteArrayList.html",relativePath:"01.Java/04.Javaå¹¶å/08.CopyOnWriteArrayList.md",key:"v-3f862f67",path:"/pages/9c98d8/",headers:[{level:2,title:"CopyOnWriteArrayList.add()",slug:"copyonwritearraylist-add",normalizedTitle:"copyonwritearraylist.add()",charIndex:2}],headersStr:"CopyOnWriteArrayList.add()",content:"# CopyOnWriteArrayList.add()\n\nCopyOnWrite å³åæ¶å¤å¶ï¼å°ä¸ä¸ªåç´ æ·»å å°å®¹å¨ä¸­æ¶ï¼ä¸ç´æ¥å¾å½åå®¹å¨æ·»å ï¼èæ¯åå°å½åå®¹å¨è¿è¡copyï¼å¾æ°å®¹å¨ä¸­æ·»å ï¼æ·»å å®åï¼åå°åå®¹å¨çå¼ç¨æåæ°å®¹å¨ï¼è¿æ ·å¯ä»¥å¯¹å®¹å¨è¿è¡å¹¶åçè¯»ï¼èä¸éå éï¼å ä¸ºå½åå®¹å¨ä¸ä¼æé£å®¶ä»»ä½åç´ ãæä»¥ CopyOnWrite æ¯ä¸ç§è¯»ååç¦»çææ³ï¼è¯»ååæ¯ä¸åçå®¹å¨ã\n\npublic boolean add(E e) {\n        synchronized (lock) {\n            Object[] es = getArray();\n            int len = es.length;\n            es = Arrays.copyOf(es, len + 1);\n            es[len] = e;\n            setArray(es);\n            return true;\n        }\n    }\n",normalizedContent:"# copyonwritearraylist.add()\n\ncopyonwrite å³åæ¶å¤å¶ï¼å°ä¸ä¸ªåç´ æ·»å å°å®¹å¨ä¸­æ¶ï¼ä¸ç´æ¥å¾å½åå®¹å¨æ·»å ï¼èæ¯åå°å½åå®¹å¨è¿è¡copyï¼å¾æ°å®¹å¨ä¸­æ·»å ï¼æ·»å å®åï¼åå°åå®¹å¨çå¼ç¨æåæ°å®¹å¨ï¼è¿æ ·å¯ä»¥å¯¹å®¹å¨è¿è¡å¹¶åçè¯»ï¼èä¸éå éï¼å ä¸ºå½åå®¹å¨ä¸ä¼æé£å®¶ä»»ä½åç´ ãæä»¥ copyonwrite æ¯ä¸ç§è¯»ååç¦»çææ³ï¼è¯»ååæ¯ä¸åçå®¹å¨ã\n\npublic boolean add(e e) {\n        synchronized (lock) {\n            object[] es = getarray();\n            int len = es.length;\n            es = arrays.copyof(es, len + 1);\n            es[len] = e;\n            setarray(es);\n            return true;\n        }\n    }\n",charsets:{cjk:!0}},{title:"CountDownLatch",frontmatter:{title:"CountDownLatch",date:"2023-05-15T23:02:42.000Z",permalink:"/pages/7c31b2/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/10.CountDownLatch.html",relativePath:"01.Java/04.Javaå¹¶å/10.CountDownLatch.md",key:"v-e30b8032",path:"/pages/7c31b2/",headers:[{level:2,title:"æ ¸å¿æ¹æ³",slug:"æ ¸å¿æ¹æ³",normalizedTitle:"æ ¸å¿æ¹æ³",charIndex:675},{level:2,title:"åºç¨åºæ¯ï¼",slug:"åºç¨åºæ¯",normalizedTitle:"åºç¨åºæ¯ï¼",charIndex:766}],headersStr:"æ ¸å¿æ¹æ³ åºç¨åºæ¯ï¼",content:"CountDownLatchæ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ä¸ªæå¤ä¸ªçº¿ç¨ç­å¾ä¸ç»æä½å®æååç»§ç»­æ§è¡ã\n\nCountDownLatch is a synchronization tool that allows one or more threads to wait until a set of operations has completed. It is initialized with a count, and each time the countDown() method is called, the count is decremented. When the count reaches zero, all threads that are waiting on the CountDownLatch are released.\n\nCountDownLatch can be used to solve a variety of synchronization problems. For example, it can be used to ensure that all threads in a group have finished executing before a certain task is started, or to ensure that a certain number of resources are available before a task is started.\n\n\n# æ ¸å¿æ¹æ³\n\nCountDownLatch latch = new CountDownLatch(5);\nlatch.countDown();\nlatch.await();\n\n\n\n# åºç¨åºæ¯ï¼\n\n 1. å¹¶åä»»å¡çååï¼å½ä¸ä¸ªä»»å¡éè¦ç­å¾å¶ä»å¤ä¸ªä»»å¡å®æåæè½ç»§ç»­æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥å®ç°çº¿ç¨ä¹é´çååãä»»å¡ä¸­ççº¿ç¨å¯ä»¥è°ç¨ CountDownLatch ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼èå¶ä»ä»»å¡ä¸­ççº¿ç¨æ§è¡å®èªå·±çæä½åå¯ä»¥è°ç¨ CountDownLatch ç countDown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ç­å¾ä¸­ççº¿ç¨å°±ä¼è¢«å¤éã\n 2. ç­å¾èµæºåå§åï¼å½ä¸ä¸ªç¨åºéè¦ç­å¾ä¸äºèµæºåå§åå®æåæè½æ­£å¸¸è¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥å®ç°ç­å¾ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾åå§åä»»å¡å®æï¼èåå§åä»»å¡ä¸­ççº¿ç¨å¨å®æåå§ååè°ç¨ countDown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ä¸»çº¿ç¨å°±ä¼è¢«å¤éï¼å¯ä»¥å¼å§æ§è¡åç»­çé»è¾ã\n 3. æµè¯å¤çº¿ç¨æ§è½ï¼å¨æ§è½æµè¯ä¸­ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥æ¨¡æå¹¶ååºæ¯ãä¸»çº¿ç¨å¯ä»¥å¯å¨å¤ä¸ªå·¥ä½çº¿ç¨ï¼è¿äºå·¥ä½çº¿ç¨ä¼æ§è¡ç¸åçä»»å¡ï¼å¹¶å¨ä»»å¡å®ææ¶è°ç¨ countDown() æ¹æ³ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾ææå·¥ä½çº¿ç¨å®æï¼ä»¥ä¾¿ç»è®¡æ§è¡æ¶é´åæ§è½ææ ã",normalizedContent:"countdownlatchæ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ä¸ªæå¤ä¸ªçº¿ç¨ç­å¾ä¸ç»æä½å®æååç»§ç»­æ§è¡ã\n\ncountdownlatch is a synchronization tool that allows one or more threads to wait until a set of operations has completed. it is initialized with a count, and each time the countdown() method is called, the count is decremented. when the count reaches zero, all threads that are waiting on the countdownlatch are released.\n\ncountdownlatch can be used to solve a variety of synchronization problems. for example, it can be used to ensure that all threads in a group have finished executing before a certain task is started, or to ensure that a certain number of resources are available before a task is started.\n\n\n# æ ¸å¿æ¹æ³\n\ncountdownlatch latch = new countdownlatch(5);\nlatch.countdown();\nlatch.await();\n\n\n\n# åºç¨åºæ¯ï¼\n\n 1. å¹¶åä»»å¡çååï¼å½ä¸ä¸ªä»»å¡éè¦ç­å¾å¶ä»å¤ä¸ªä»»å¡å®æåæè½ç»§ç»­æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥å®ç°çº¿ç¨ä¹é´çååãä»»å¡ä¸­ççº¿ç¨å¯ä»¥è°ç¨ countdownlatch ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼èå¶ä»ä»»å¡ä¸­ççº¿ç¨æ§è¡å®èªå·±çæä½åå¯ä»¥è°ç¨ countdownlatch ç countdown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ç­å¾ä¸­ççº¿ç¨å°±ä¼è¢«å¤éã\n 2. ç­å¾èµæºåå§åï¼å½ä¸ä¸ªç¨åºéè¦ç­å¾ä¸äºèµæºåå§åå®æåæè½æ­£å¸¸è¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥å®ç°ç­å¾ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾åå§åä»»å¡å®æï¼èåå§åä»»å¡ä¸­ççº¿ç¨å¨å®æåå§ååè°ç¨ countdown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ä¸»çº¿ç¨å°±ä¼è¢«å¤éï¼å¯ä»¥å¼å§æ§è¡åç»­çé»è¾ã\n 3. æµè¯å¤çº¿ç¨æ§è½ï¼å¨æ§è½æµè¯ä¸­ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥æ¨¡æå¹¶ååºæ¯ãä¸»çº¿ç¨å¯ä»¥å¯å¨å¤ä¸ªå·¥ä½çº¿ç¨ï¼è¿äºå·¥ä½çº¿ç¨ä¼æ§è¡ç¸åçä»»å¡ï¼å¹¶å¨ä»»å¡å®ææ¶è°ç¨ countdown() æ¹æ³ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾ææå·¥ä½çº¿ç¨å®æï¼ä»¥ä¾¿ç»è®¡æ§è¡æ¶é´åæ§è½ææ ã",charsets:{cjk:!0}},{title:"å¹¶åç¼ç¨",frontmatter:{title:"å¹¶åç¼ç¨",date:"2023-03-30T15:08:27.000Z",permalink:"/pages/d5fcba/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/100.%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B.html",relativePath:"01.Java/04.Javaå¹¶å/100.å¹¶åç¼ç¨.md",key:"v-03e85d0e",path:"/pages/d5fcba/",headers:[{level:2,title:"åå»ºçº¿ç¨çæ¹å¼",slug:"åå»ºçº¿ç¨çæ¹å¼",normalizedTitle:"åå»ºçº¿ç¨çæ¹å¼",charIndex:2},{level:2,title:"Runnable å Callable æä»ä¹åºå«ï¼",slug:"runnable-å-callable-æä»ä¹åºå«",normalizedTitle:"runnable å callable æä»ä¹åºå«ï¼",charIndex:125},{level:2,title:"Future å FutureTask",slug:"future-å-futuretask",normalizedTitle:"future å futuretask",charIndex:300},{level:2,title:"CallableãFutureãFutureTask çä½¿ç¨",slug:"callableãfutureãfuturetask-çä½¿ç¨",normalizedTitle:"callableãfutureãfuturetask çä½¿ç¨",charIndex:1048},{level:2,title:"çº¿ç¨çç¶æ",slug:"çº¿ç¨çç¶æ",normalizedTitle:"çº¿ç¨çç¶æ",charIndex:2947},{level:2,title:"sleepæ¹æ³åwaitæ¹æ³åºå«",slug:"sleepæ¹æ³åwaitæ¹æ³åºå«",normalizedTitle:"sleepæ¹æ³åwaitæ¹æ³åºå«",charIndex:3063},{level:2,title:"sleep()ãwait()ãjoin()çåºå«",slug:"sleep-ãwait-ãjoin-çåºå«",normalizedTitle:"sleep()ãwait()ãjoin()çåºå«",charIndex:3765},{level:2,title:"Javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨",slug:"javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨",normalizedTitle:"javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨",charIndex:6199},{level:2,title:"Javaçº¿ç¨åæ­¥çå ç§æ¹æ³",slug:"javaçº¿ç¨åæ­¥çå ç§æ¹æ³",normalizedTitle:"javaçº¿ç¨åæ­¥çå ç§æ¹æ³",charIndex:8155}],headersStr:"åå»ºçº¿ç¨çæ¹å¼ Runnable å Callable æä»ä¹åºå«ï¼ Future å FutureTask CallableãFutureãFutureTask çä½¿ç¨ çº¿ç¨çç¶æ sleepæ¹æ³åwaitæ¹æ³åºå« sleep()ãwait()ãjoin()çåºå« Javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨ Javaçº¿ç¨åæ­¥çå ç§æ¹æ³",content:'# åå»ºçº¿ç¨çæ¹å¼\n\n * ç»§æ¿ Thread ç±»åå»ºçº¿ç¨\n * å®ç° Runnable æ¥å£åå»ºçº¿ç¨\n * å®ç° Callable æ¥å£å Futureåå»ºçº¿ç¨ï¼å¹¶è·åç»æã\n * éè¿çº¿ç¨æ±  ThreadPoolExecutor åå»ºã\n\n\n# Runnable å Callable æä»ä¹åºå«ï¼\n\n * Runnable æ¥å£ä¸­ç run() æ¹æ³çè¿åå¼æ¯ voidï¼å®åçäºæåªæ¯çº¯ç²¹å°å»æ§è¡ run() æ¹æ³ä¸­çä»£ç èå·²ï¼\n\n * Callable æ¥å£ä¸­ç call() æ¹æ³æ¯æè¿åå¼çï¼æ¯ä¸ä¸ªæ³åï¼å FutureãFutureTask éåå¯ä»¥ç¨æ¥è·åå¼æ­¥æ§è¡çç»æã\n\n\n# Future å FutureTask\n\nFutureåFutureTaské½æ¯Javaä¸­ç¨äºå¤çå¼æ­¥ä»»å¡çæ¥å£ï¼å®ä»¬ä¹é´çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. Futureæ¯ä¸ä¸ªæ¥å£ï¼å®å®ä¹äºä¸äºæ¹æ³ï¼å¦isDone()ãget()ç­ï¼ç¨äºæä½å¼æ­¥ä»»å¡çç»æãFutureTaskæ¯ä¸ä¸ªå®ç°äºFutureæ¥å£çç±»ï¼å®è¿å®ç°äºRunnableæ¥å£ï¼å¯ä»¥è¢«å½åä¸ä¸ªçº¿ç¨æ¥æ§è¡ã\n 2. Futureæ¥å£åªæ¯ä¸ä¸ªæ åçæ¥å£ï¼å®å¹¶æ²¡ææä¾å®ç°ãå¨ä½¿ç¨Futureæ¶ï¼éè¦ä½¿ç¨å®çå®ç°ç±»ï¼å¦FutureTaskãCompletableFutureç­ã\n 3. Futureæ¥å£çä¸»è¦ä½ç¨æ¯è·åå¼æ­¥ä»»å¡çæ§è¡ç»æï¼å¯ä»¥éè¿get()æ¹æ³æ¥è·åï¼å¦æä»»å¡è¿æ²¡æå®æï¼get()æ¹æ³ä¼é»å¡å½åçº¿ç¨ï¼ç´å°ä»»å¡å®æå¹¶è¿åç»æãFutureTaské¤äºå¯ä»¥è·åä»»å¡çæ§è¡ç»æå¤ï¼è¿å¯ä»¥éè¿å®çcancel()æ¹æ³æ¥åæ¶ä»»å¡çæ§è¡ã\n 4. FutureTaskæ¯ä¸ä¸ªæ¯è¾å¼ºå¤§çç±»ï¼å®å¯ä»¥åå«ä¸ä¸ªCallableæRunnableå¯¹è±¡ï¼å¹¶ä¸æ¯æå°ä»»å¡æäº¤å°Executoræ§è¡å¨ä¸­ãå¨è°ç¨get()æ¹æ³æ¶ï¼å¦æä»»å¡è¿æ²¡ææ§è¡å®æï¼å®ä¼é»å¡å½åçº¿ç¨ï¼ç´å°ä»»å¡æ§è¡å®æå¹¶è¿åç»æãå¦å¤ï¼å¦æä»»å¡è¢«åæ¶ï¼get()æ¹æ³ä¼æåºCancellationExceptionå¼å¸¸ã\n\nç»¼ä¸æè¿°ï¼Futureæ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹å¼æ­¥ä»»å¡çè¿åå¼åæä½æ¹æ³ï¼èFutureTaskæ¯ä¸ä¸ªå®ç°äºFutureæ¥å£çç±»ï¼é¤äºå®ç°Futureæ¥å£çæ¹æ³å¤ï¼è¿å®ç°äºRunnableæ¥å£ï¼å¯ä»¥è¢«å½åä¸ä¸ªçº¿ç¨æ¥æ§è¡ãFutureTaskæ¯ä¸ä¸ªæ¯è¾å¼ºå¤§çç±»ï¼å®ä¸ä»æ¯æè·åå¼æ­¥ä»»å¡çæ§è¡ç»æï¼è¿æ¯æä»»å¡çæäº¤ååæ¶ï¼å¯ä»¥æ¹ä¾¿å°å¤çå¼æ­¥ä»»å¡çæ§è¡åç®¡çã\n\n\n# CallableãFutureãFutureTask çä½¿ç¨\n\nimport java.util.concurrent.Callable;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.FutureTask;\n\npublic class MyCallable implements Callable<Integer> {\n    public Integer call() throws Exception {\n        int sum = 0;\n        for (int i = 1; i <= 100; i++) {\n            sum += i;\n        }\n        return sum;\n    }\n\n    public static void main(String[] args) {\n        // åå»ºCallableå¯¹è±¡\n        Callable<Integer> callable = new MyCallable();\n\n        // åå»ºFutureTaskå¯¹è±¡\n        FutureTask<Integer> futureTask = new FutureTask<Integer>(callable);\n\n        // åå»ºçº¿ç¨å¯¹è±¡\n        Thread thread = new Thread(futureTask);\n\n        // å¯å¨çº¿ç¨\n        thread.start();\n\n        try {\n            // è·åçº¿ç¨è¿åç»æ\n            int sum = futureTask.get();\n            System.out.println("1 + 2 + ... + 100 = " + sum);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } catch (ExecutionException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\n\nimport java.util.concurrent.*;\n\npublic class MyCallable implements Callable<Integer> {\n    public Integer call() throws Exception {\n        int sum = 0;\n        for (int i = 1; i <= 100; i++) {\n            sum += i;\n        }\n        return sum;\n    }\n\n    public static void main(String[] args) throws InterruptedException, ExecutionException {\n        // åå»ºçº¿ç¨æ± \n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n\n        // æäº¤Callableä»»å¡\n        Future<Integer> future = executorService.submit(new MyCallable());\n\n        // é»å¡ç­å¾ä»»å¡æ§è¡å®æ\n        while (!future.isDone()) {\n            System.out.println("ä»»å¡è¿æ²¡ææ§è¡å®æï¼ç»§ç»­ç­å¾...");\n            Thread.sleep(1000);\n        }\n\n        // è·åä»»å¡æ§è¡ç»æ\n        int sum = future.get();\n        System.out.println("1 + 2 + ... + 100 = " + sum);\n\n        // å³é­çº¿ç¨æ± \n        executorService.shutdown();\n    }\n}\n\n\n\n# çº¿ç¨çç¶æ\n\nThread çæºç ä¸­å®ä¹äº6ç§ç¶æï¼newï¼æ°å»ºï¼ãrunnnableï¼å¯è¿è¡ï¼ãblockedï¼é»å¡ï¼ãwaitingï¼ç­å¾ï¼ãtime waiting ï¼å®æ¶ç­å¾ï¼å terminatedï¼ç»æ­¢ï¼ã\n\n\n\n\n# sleepæ¹æ³åwaitæ¹æ³åºå«\n\nsleep()åwait()æ¹æ³é½å¯ä»¥æåçº¿ç¨çæ§è¡ï¼ä½å®ä»¬çä½ç¨åç¨æ³æ¯ä¸åçï¼\n\n 1. sleep() æ¹æ³æ¯ Thread ç±»ä¸­çä¸ä¸ªéææ¹æ³ï¼å®ä¼æåå½åçº¿ç¨çæ§è¡ï¼è®©åºCPUçæ¶é´çï¼ä½æ¯ä¸ä¼éæ¾å½åçº¿ç¨ææçéãsleep() æ¹æ³çè°ç¨å¿é¡»æè· InterruptedException å¼å¸¸ã\n 2. wait() æ¹æ³æ¯ Object ç±»ä¸­çä¸ä¸ªå®ä¾æ¹æ³ï¼å®ä¼è®©å½åçº¿ç¨ç­å¾ï¼ç´å°å¦ä¸ä¸ªçº¿ç¨è°ç¨ notify() æ notifyAll() æ¹æ³å¤éå®ãè°ç¨ wait() æ¹æ³ççº¿ç¨å¿é¡»æ¥æè¯¥å¯¹è±¡çéï¼å¦åä¼æåº IllegalMonitorStateException å¼å¸¸ãwait() æ¹æ³ä¹å¿é¡»æè· InterruptedException å¼å¸¸ã\n\nå æ­¤ï¼sleep() å wait() çåºå«å¨äºï¼\n\n 1. sleep() ä¸ä¼éæ¾éï¼wait() ä¼éæ¾éã\n 2. sleep() åªè½å¨ Thread ç±»ä¸­ä½¿ç¨ï¼è wait() å¯ä»¥å¨ä»»æå¯¹è±¡ä¸è°ç¨ï¼å ä¸º wait() æ¯ Object ç±»çå®ä¾æ¹æ³ã\n 3. wait() å¿é¡»å¨ synchronized åææ¹æ³ä¸­ä½¿ç¨ï¼å¦åä¼æåº IllegalMonitorStateException å¼å¸¸ã\n 4. sleep() çä½ç¨æ¯æåå½åçº¿ç¨çæ§è¡ï¼è®©åºCPUçæ¶é´çï¼è wait() çä½ç¨æ¯è®©çº¿ç¨ç­å¾æä¸ªæ¡ä»¶çæ»¡è¶³ã\n\nå æ­¤ï¼å¦æéè¦æåå½åçº¿ç¨çæ§è¡ï¼å¯ä»¥ä½¿ç¨ sleep() æ¹æ³ï¼å¦æéè¦è®©çº¿ç¨ç­å¾æä¸ªæ¡ä»¶çæ»¡è¶³ï¼å¯ä»¥ä½¿ç¨ wait() æ¹æ³ã\n\n\n# sleep()ãwait()ãjoin()çåºå«\n\nwait() æ¹æ³æ¯ Object ç±»ä¸­çæ¹æ³ï¼ç¨äºä½¿å½åçº¿ç¨ç­å¾ï¼ç´å°å¶ä»çº¿ç¨è°ç¨è¯¥å¯¹è±¡ç notify() æ notifyAll() æ¹æ³å¤éå®ï¼sleep() å join() æ¹æ³æ¯ Thread ç±»ä¸­çæ¹æ³ï¼sleepæ¯éææ¹æ³ï¼ Thread.sleep()ãèjoin()éè¦çº¿ç¨å¯¹è±¡æ¥è°ç¨ã\n\nwait() æ¹æ³å¿é¡»å¨åæ­¥ä»£ç åæåæ­¥æ¹æ³ä¸­ä½¿ç¨ï¼å¦åä¼æåº IllegalMonitorStateException å¼å¸¸ï¼sleep() å join() æ¹æ³å¯ä»¥å¨ä»»ä½å°æ¹è°ç¨ï¼ä¸éè¦å¨åæ­¥ä»£ç åæåæ­¥æ¹æ³ä¸­ã\n\nwait() æ¹æ³ä¼éæ¾éï¼ä½¿å¾å¶ä»çº¿ç¨å¯ä»¥è·åéå¹¶ä¿®æ¹å±äº«åéï¼sleep() æ¹æ³ä¸ä¼éæ¾éï¼å½åçº¿ç¨ä»ç¶ææéã\n\nObjectä¸­çwaitãnotiftãnotifyAllé½æ¯ç¨äºåè°å¤ä¸ªçº¿ç¨å¯¹å±äº«æ°æ®çå­åï¼æä»¥å¿é¡»å¨Synchronizedè¯­å¥ååä½¿ç¨è¿ä¸ä¸ªæ¹æ³ãSynchronized å³é®å­ç¨äºä¿æ¤å±äº«æ°æ®ï¼é»æ­¢å¶ä»çº¿ç¨å¯¹å±äº«æ°æ®çå­åãä½æ¯è¿æ ·ç¨åºçæµç¨å°±å¾ä¸çµæ´»äºï¼å¦ä½æè½å¨å½åçº¿ç¨è¿æ²¡éåºSynchronizedæ°æ®åæ¶è®©å¶ä»çº¿ç¨ä¹ææºä¼è®¿é®å±äº«æ°æ®å¢ï¼æ­¤æ¶å°±ç¨è¿ä¸ä¸ªæ¹æ³æ¥çµæ´»æ§å¶ã\n\n * wait()æ¹æ³ä½¿å½åçº¿ç¨æåæ§è¡å¹¶éæ¾å¯¹è±¡éæ å¿ï¼è®©å¶ä»çº¿ç¨å¯ä»¥è¿å¥Synchronizedæ°æ®åï¼å½åçº¿ç¨è¢«æ¾å¥å¯¹è±¡ç­å¾æ± ä¸­ã\n * å½è°ç¨ notify()æ¹æ³åï¼å°ä»å¯¹è±¡çç­å¾æ± ä¸­ç§»èµ°ä¸ä¸ªä»»æççº¿ç¨å¹¶æ¾å°éæ å¿ç­å¾æ± ä¸­ï¼åªæéæ å¿ç­å¾æ± ä¸­ççº¿ç¨è½å¤è·åéæ å¿ï¼å¦æéæ å¿ç­å¾æ± ä¸­æ²¡æçº¿ç¨ï¼ånotify()ä¸èµ·ä½ç¨ã\n * notifyAll()åä»å¯¹è±¡ç­å¾æ± ä¸­ç§»èµ°ææç­å¾é£ä¸ªå¯¹è±¡ççº¿ç¨å¹¶æ¾å°éæ å¿ç­å¾æ± ä¸­ã\n\npublic class WaitNotifyExample {\n    public static void main(String[] args) {\n        final Object lock = new Object(); // å®ä¹ä¸ä¸ªéå¯¹è±¡\n\n        // çº¿ç¨Aï¼ç­å¾éå¯¹è±¡\n        Thread threadA = new Thread(new Runnable() {\n            public void run() {\n                synchronized (lock) {\n                    try {\n                        System.out.println("ThreadA is waiting...");\n                        lock.wait(); // ç­å¾éå¯¹è±¡\n                        System.out.println("ThreadA is woken up!");\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        });\n\n        // çº¿ç¨Bï¼å¤éç­å¾ççº¿ç¨\n        Thread threadB = new Thread(new Runnable() {\n            public void run() {\n                synchronized (lock) {\n                    System.out.println("ThreadB is notifying...");\n                    lock.notify(); // å¤éç­å¾ççº¿ç¨\n                }\n            }\n        });\n\n        // å¯å¨çº¿ç¨Aåçº¿ç¨B\n        threadA.start();\n        threadB.start();\n    }\n}\n\n\nsleepï¼Threadç±»çæ¹æ³ï¼å¿é¡»å¸¦ä¸ä¸ªæ¶é´åæ°ãä¼è®©å½åçº¿ç¨ä¼ç è¿å¥é»å¡ç¶æå¹¶éæ¾CPUèµæºï¼æä¾å¶ä»çº¿ç¨è¿è¡çæºä¼ä¸ä¸èèä¼åçº§ï¼ä½å¦ææåæ­¥éåsleepä¸ä¼éæ¾éå³å¶ä»çº¿ç¨æ æ³è·å¾åæ­¥éï¼å¯éè¿è°ç¨interrupt()æ¹æ³æ¥å¤éä¼ç çº¿ç¨ã\n\nyieldï¼è®©åºCPUè°åº¦ï¼Threadç±»çæ¹æ³ï¼ç±»ä¼¼sleepåªæ¯ä¸è½ç±ç¨æ·æå®æåå¤é¿æ¶é´ ï¼å¹¶ä¸yield()æ¹æ³åªè½è®©åä¼åçº§ççº¿ç¨ææ§è¡çæºä¼ã yield()åªæ¯ä½¿å½åçº¿ç¨éæ°åå°å¯æ§è¡ç¶æï¼æä»¥æ§è¡yield()ççº¿ç¨æå¯è½å¨è¿å¥å°å¯æ§è¡ç¶æåé©¬ä¸åè¢«æ§è¡ãè°ç¨yieldæ¹æ³åªæ¯ä¸ä¸ªå»ºè®®ï¼åè¯çº¿ç¨è°åº¦å¨æçå·¥ä½å·²ç»åçå·®ä¸å¤äºï¼å¯ä»¥è®©å«çç¸åä¼åçº§ççº¿ç¨ä½¿ç¨CPUäºï¼æ²¡æä»»ä½æºå¶ä¿è¯éçº³ã\n\nwaitï¼Objectç±»çæ¹æ³(notify()ãnotifyAll() ä¹æ¯Objectå¯¹è±¡)ï¼å¿é¡»æ¾å¨å¾ªç¯ä½ååæ­¥ä»£ç åä¸­ï¼æ§è¡è¯¥æ¹æ³ççº¿ç¨ä¼éæ¾éï¼è¿å¥çº¿ç¨ç­å¾æ± ä¸­ç­å¾è¢«åæ¬¡å¤é(notifyéæºå¤éï¼notifyAllå¨é¨å¤éï¼çº¿ç¨ç»æèªå¨å¤é)å³æ¾å¥éæ± ä¸­ç«äºåæ­¥é\n\njoinï¼ä¸ç§ç¹æ®çwaitï¼å½åè¿è¡çº¿ç¨è°ç¨å¦ä¸ä¸ªçº¿ç¨çjoinæ¹æ³ï¼å½åçº¿ç¨è¿å¥é»å¡ç¶æç´å°å¦ä¸ä¸ªçº¿ç¨è¿è¡ç»æç­å¾è¯¥çº¿ç¨ç»æ­¢ã æ³¨æè¯¥æ¹æ³ä¹éè¦ææå¼å¸¸ã\n\nç­å¾è°ç¨joinæ¹æ³ççº¿ç¨ç»æï¼åç»§ç»­æ§è¡ãå¦ï¼t.join();//ä¸»è¦ç¨äºç­å¾tçº¿ç¨è¿è¡ç»æï¼è¥æ æ­¤å¥ï¼mainåä¼æ§è¡å®æ¯ï¼å¯¼è´ç»æä¸å¯é¢æµã\n\n\n# Javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨\n\nçº¿ç¨å®å¨å¨ä¸ä¸ªæ¹é¢ä½ç°ï¼\n\nåå­æ§ï¼æä¾äºæ¥è®¿é®ï¼åä¸æ¶å»åªè½æä¸ä¸ªçº¿ç¨å¯¹æ°æ®è¿è¡æä½ï¼ï¼atomicï¼synchronizedï¼ï¼\n\nå¯è§æ§ï¼ä¸ä¸ªçº¿ç¨å¯¹ä¸»åå­çä¿®æ¹å¯ä»¥åæ¶å°è¢«å¶ä»çº¿ç¨çå°ï¼ï¼synchronizedãvolatileï¼ï¼\n\næåºæ§ï¼ä¸ä¸ªçº¿ç¨è§å¯å¶ä»çº¿ç¨ä¸­çæä»¤æ§è¡é¡ºåºï¼ç±äºæä»¤éæåºï¼è¯¥è§å¯ç»æä¸è¬æä¹±æ åºï¼ï¼happens-before ååï¼ã\n\nå¯è§æ§åæåºæ§ï¼\n\nä¿è¯å¯è§æ§æå³çå½ä¸ä¸ªçº¿ç¨ä¿®æ¹äºæä¸ªå±äº«åéçå¼æ¶ï¼å¶ä»çº¿ç¨è½å¤ç«å³çå°è¿ä¸ªåéçææ°å¼ï¼ä»èé¿åäºæ°æ®ä¸ä¸è´çé®é¢ãJavaä¸­æä¾çvolatileå³é®å­å°±æ¯ä¸ç§ä¿è¯å¯è§æ§çæºå¶ã\n\nèä¿è¯æåºæ§åæ¯è¦ç¡®ä¿å¨å¤çº¿ç¨ç¯å¢ä¸ï¼å¯¹å±äº«åéçè¯»åæä½è½å¤æç§ç¨åºçåæé¡ºåºè¿è¡ï¼é¿åäºæä»¤éæåå¶ä»å ç´ å¼èµ·çæ§è¡é¡ºåºé®é¢ãJavaä¸­çhappens-beforeè§åå¯ä»¥ä¿è¯ç¨åºçæåºæ§ï¼happens-beforeè§åæè¿°äºå¨å¤çº¿ç¨ç¯å¢ä¸çåç§æä½ä¹é´çé¡ºåºå³ç³»ã\n\nå æ­¤ï¼ä¿è¯å¯è§æ§åªæ¯ä¿è¯äºæ°æ®ä¸è´æ§ï¼èä¿è¯æåºæ§å¯ä»¥é¿åç¨åºåºç°åç§é¾ä»¥é¢æçé®é¢ãå¨å®éå¼åä¸­ï¼æä»¬éè¦åæ¶èèä¿è¯å¯è§æ§åæåºæ§ï¼æè½ä¿è¯å¤çº¿ç¨ç¨åºçæ­£ç¡®æ§åæ§è½ã\n\nhappens-beforeååï¼ï¼æ¯Javaåå­æ¨¡åçä¸é¨åï¼ç¨äºå®ä¹å¤çº¿ç¨ç¨åºä¸­å±äº«åéçè¯»åæä½çé¡ºåºå³ç³»ï¼ä¿è¯äºç¨åºçå¯è§æ§åæåºæ§ãï¼\n\n 1. ç¨åºé¡ºåºè§åï¼ä¸ä¸ªçº¿ç¨åæç§ç¨åºä»£ç é¡ºåºæ§è¡çç»æï¼happens-beforeäºè¯¥çº¿ç¨åçä»»æåç»­æä½ã\n 2. éå®è§åï¼ä¸ä¸ªunlockæä½happens-beforeäºåç»­çä»»ælockæä½ï¼åä¸ä¸ªéï¼ï¼åä¹ä¹æç«ã\n 3. volatileåéè§åï¼å¯¹ä¸ä¸ªvolatileåéçåæä½happens-beforeäºåç»­çä»»æè¯»æä½ï¼åä¸ä¸ªvolatileåéï¼ï¼åä¹ä¹æç«ã\n 4. ä¼ éæ§è§åï¼å¦ææä½A happens-beforeäºæä½Bï¼ä¸æä½B happens-beforeäºæä½Cï¼é£ä¹æä½A happens-beforeäºæä½Cã\n 5. çº¿ç¨å¯å¨è§åï¼ä¸ä¸ªçº¿ç¨çå¯å¨æä½happens-beforeäºè¯¥çº¿ç¨ä¸­çä»»ææä½ã\n 6. çº¿ç¨ç»æ­¢è§åï¼çº¿ç¨ä¸­çä»»ææä½happens-beforeäºè¯¥çº¿ç¨çç»æ­¢æä½ã\n 7. çº¿ç¨ä¸­æ­è§åï¼å¯¹çº¿ç¨ interrupt() æ¹æ³çè°ç¨ happens-before äºè¢«ä¸­æ­çº¿ç¨ä¸­çä»»ææä½ã\n 8. å¯¹è±¡ç»ç»è§åï¼ä¸ä¸ªå¯¹è±¡çåå§åæä½ happens-before äºfinalize() æ¹æ³çå¼å§ã\n\nå¨å¤çº¿ç¨ç¨åºä¸­ï¼éµå®happens-beforeè§åå¯ä»¥ä¿è¯ç¨åºçæåºæ§åæ­£ç¡®æ§ãéè¿åçå°ä½¿ç¨åæ­¥æºå¶åvolatileå³é®å­ï¼å¯ä»¥å®ç°çº¿ç¨ä¹é´çé¡ºåºæ§è¡ï¼é¿åæ°æ®ç«äºåæä»¤éæç­é®é¢ã\n\nJavaä¸­æå¤ç§æºå¶å¯ä»¥ä¿è¯å¤çº¿ç¨è¿è¡çå®å¨ï¼ä¸é¢åä¸¾å ç§ä¸»è¦çæ¹å¼ï¼\n\n 1. synchronizedå³é®å­ï¼ä½¿ç¨synchronizedå³é®å­å¯ä»¥å°ä¸æ®µä»£ç åææ¹æ³æ è®°ä¸ºåæ­¥ä»£ç ï¼åä¸æ¶å»åªè½æä¸ä¸ªçº¿ç¨è¿å¥è¯¥ä»£ç åææ¹æ³ãè¿ç§æ¹å¼éè¦æ³¨æéå¯¹è±¡çéæ©ï¼éè¦ä¿è¯ä¸åçº¿ç¨ä½¿ç¨çæ¯åä¸ä¸ªéå¯¹è±¡ã\n 2. ReentrantLockç±»ï¼ä¸synchronizedç±»ä¼¼ï¼ReentrantLockä¹æ¯ä¸ç§åæ­¥æºå¶ãä½¿ç¨ReentrantLockéè¦æå¨è·ååéæ¾éï¼å æ­¤æ´çµæ´»ãå¦å¤ï¼ReentrantLockè¿æä¾äºä¸äºé«çº§ç¹æ§ï¼å¦å¬å¹³éåå¯éå¥éç­ã\n 3. volatileå³é®å­ï¼ä½¿ç¨volatileå³é®å­å¯ä»¥ä¿è¯å¤ä¸ªçº¿ç¨å¯¹åéçå¯è§æ§ãå³ä¸ä¸ªçº¿ç¨ä¿®æ¹äºä¸ä¸ªvolatileåéçå¼ï¼å¶ä»çº¿ç¨å¯ä»¥ç«å³çå°è¿ä¸ªå¼çååãä½æ¯volatileä¸è½ä¿è¯åå­æ§ã\n 4. Atomicç±»ï¼Javaä¸­æä¾äºAtomicIntegerãAtomicBooleanãAtomicLongç­åå­ç±»ï¼ä½¿ç¨è¿äºç±»å¯ä»¥ä¿è¯æä½çåå­æ§ã\n 5. ThreadLocalç±»ï¼ThreadLocalæ¯ä¸ä¸ªçº¿ç¨åé¨çæ°æ®ç»æï¼å¯ä»¥ç¨æ¥ä¿å­çº¿ç¨çå±é¨åéãThreadLocalä¸ºæ¯ä¸ªçº¿ç¨é½æä¾äºä¸ä¸ªç¬ç«çåéå¯æ¬ï¼ä»èé¿åäºçº¿ç¨å®å¨é®é¢ã\n 6. çº¿ç¨æ± ï¼ä½¿ç¨çº¿ç¨æ± å¯ä»¥é¿ååå»ºè¿å¤ççº¿ç¨ï¼ä»èæé«ç¨åºæ§è½åç¨³å®æ§ãJavaä¸­æä¾äºThreadPoolExecutorç±»ï¼å¯ä»¥æ ¹æ®éè¦èªå®ä¹çº¿ç¨æ± çå¤§å°åå¶ä»åæ°ã\n 7. çº¿ç¨å®å¨çå®¹å¨ï¼ConcurrentHashMapãCopyOnWriteArrayListãBlockingQueueãConcurrentSkipListMapãConcurrentSkipListSet\n\n\n# Javaçº¿ç¨åæ­¥çå ç§æ¹æ³\n\n * ä½¿ç¨ synchronized å³é®å­\n * ä½¿ç¨wait å notifyï¼éç»åsynchronizedä½¿ç¨\n * ä½¿ç¨å¯éå¥é ReentrantLock\n * ä½¿ç¨é»å¡éå BlockQueue\n * ä½¿ç¨ä¿¡å·é Semaphone',normalizedContent:'# åå»ºçº¿ç¨çæ¹å¼\n\n * ç»§æ¿ thread ç±»åå»ºçº¿ç¨\n * å®ç° runnable æ¥å£åå»ºçº¿ç¨\n * å®ç° callable æ¥å£å futureåå»ºçº¿ç¨ï¼å¹¶è·åç»æã\n * éè¿çº¿ç¨æ±  threadpoolexecutor åå»ºã\n\n\n# runnable å callable æä»ä¹åºå«ï¼\n\n * runnable æ¥å£ä¸­ç run() æ¹æ³çè¿åå¼æ¯ voidï¼å®åçäºæåªæ¯çº¯ç²¹å°å»æ§è¡ run() æ¹æ³ä¸­çä»£ç èå·²ï¼\n\n * callable æ¥å£ä¸­ç call() æ¹æ³æ¯æè¿åå¼çï¼æ¯ä¸ä¸ªæ³åï¼å futureãfuturetask éåå¯ä»¥ç¨æ¥è·åå¼æ­¥æ§è¡çç»æã\n\n\n# future å futuretask\n\nfutureåfuturetaské½æ¯javaä¸­ç¨äºå¤çå¼æ­¥ä»»å¡çæ¥å£ï¼å®ä»¬ä¹é´çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. futureæ¯ä¸ä¸ªæ¥å£ï¼å®å®ä¹äºä¸äºæ¹æ³ï¼å¦isdone()ãget()ç­ï¼ç¨äºæä½å¼æ­¥ä»»å¡çç»æãfuturetaskæ¯ä¸ä¸ªå®ç°äºfutureæ¥å£çç±»ï¼å®è¿å®ç°äºrunnableæ¥å£ï¼å¯ä»¥è¢«å½åä¸ä¸ªçº¿ç¨æ¥æ§è¡ã\n 2. futureæ¥å£åªæ¯ä¸ä¸ªæ åçæ¥å£ï¼å®å¹¶æ²¡ææä¾å®ç°ãå¨ä½¿ç¨futureæ¶ï¼éè¦ä½¿ç¨å®çå®ç°ç±»ï¼å¦futuretaskãcompletablefutureç­ã\n 3. futureæ¥å£çä¸»è¦ä½ç¨æ¯è·åå¼æ­¥ä»»å¡çæ§è¡ç»æï¼å¯ä»¥éè¿get()æ¹æ³æ¥è·åï¼å¦æä»»å¡è¿æ²¡æå®æï¼get()æ¹æ³ä¼é»å¡å½åçº¿ç¨ï¼ç´å°ä»»å¡å®æå¹¶è¿åç»æãfuturetaské¤äºå¯ä»¥è·åä»»å¡çæ§è¡ç»æå¤ï¼è¿å¯ä»¥éè¿å®çcancel()æ¹æ³æ¥åæ¶ä»»å¡çæ§è¡ã\n 4. futuretaskæ¯ä¸ä¸ªæ¯è¾å¼ºå¤§çç±»ï¼å®å¯ä»¥åå«ä¸ä¸ªcallableærunnableå¯¹è±¡ï¼å¹¶ä¸æ¯æå°ä»»å¡æäº¤å°executoræ§è¡å¨ä¸­ãå¨è°ç¨get()æ¹æ³æ¶ï¼å¦æä»»å¡è¿æ²¡ææ§è¡å®æï¼å®ä¼é»å¡å½åçº¿ç¨ï¼ç´å°ä»»å¡æ§è¡å®æå¹¶è¿åç»æãå¦å¤ï¼å¦æä»»å¡è¢«åæ¶ï¼get()æ¹æ³ä¼æåºcancellationexceptionå¼å¸¸ã\n\nç»¼ä¸æè¿°ï¼futureæ¯ä¸ä¸ªæ¥å£ï¼ç¨äºå®ä¹å¼æ­¥ä»»å¡çè¿åå¼åæä½æ¹æ³ï¼èfuturetaskæ¯ä¸ä¸ªå®ç°äºfutureæ¥å£çç±»ï¼é¤äºå®ç°futureæ¥å£çæ¹æ³å¤ï¼è¿å®ç°äºrunnableæ¥å£ï¼å¯ä»¥è¢«å½åä¸ä¸ªçº¿ç¨æ¥æ§è¡ãfuturetaskæ¯ä¸ä¸ªæ¯è¾å¼ºå¤§çç±»ï¼å®ä¸ä»æ¯æè·åå¼æ­¥ä»»å¡çæ§è¡ç»æï¼è¿æ¯æä»»å¡çæäº¤ååæ¶ï¼å¯ä»¥æ¹ä¾¿å°å¤çå¼æ­¥ä»»å¡çæ§è¡åç®¡çã\n\n\n# callableãfutureãfuturetask çä½¿ç¨\n\nimport java.util.concurrent.callable;\nimport java.util.concurrent.executionexception;\nimport java.util.concurrent.futuretask;\n\npublic class mycallable implements callable<integer> {\n    public integer call() throws exception {\n        int sum = 0;\n        for (int i = 1; i <= 100; i++) {\n            sum += i;\n        }\n        return sum;\n    }\n\n    public static void main(string[] args) {\n        // åå»ºcallableå¯¹è±¡\n        callable<integer> callable = new mycallable();\n\n        // åå»ºfuturetaskå¯¹è±¡\n        futuretask<integer> futuretask = new futuretask<integer>(callable);\n\n        // åå»ºçº¿ç¨å¯¹è±¡\n        thread thread = new thread(futuretask);\n\n        // å¯å¨çº¿ç¨\n        thread.start();\n\n        try {\n            // è·åçº¿ç¨è¿åç»æ\n            int sum = futuretask.get();\n            system.out.println("1 + 2 + ... + 100 = " + sum);\n        } catch (interruptedexception e) {\n            e.printstacktrace();\n        } catch (executionexception e) {\n            e.printstacktrace();\n        }\n    }\n}\n\n\nimport java.util.concurrent.*;\n\npublic class mycallable implements callable<integer> {\n    public integer call() throws exception {\n        int sum = 0;\n        for (int i = 1; i <= 100; i++) {\n            sum += i;\n        }\n        return sum;\n    }\n\n    public static void main(string[] args) throws interruptedexception, executionexception {\n        // åå»ºçº¿ç¨æ± \n        executorservice executorservice = executors.newsinglethreadexecutor();\n\n        // æäº¤callableä»»å¡\n        future<integer> future = executorservice.submit(new mycallable());\n\n        // é»å¡ç­å¾ä»»å¡æ§è¡å®æ\n        while (!future.isdone()) {\n            system.out.println("ä»»å¡è¿æ²¡ææ§è¡å®æï¼ç»§ç»­ç­å¾...");\n            thread.sleep(1000);\n        }\n\n        // è·åä»»å¡æ§è¡ç»æ\n        int sum = future.get();\n        system.out.println("1 + 2 + ... + 100 = " + sum);\n\n        // å³é­çº¿ç¨æ± \n        executorservice.shutdown();\n    }\n}\n\n\n\n# çº¿ç¨çç¶æ\n\nthread çæºç ä¸­å®ä¹äº6ç§ç¶æï¼newï¼æ°å»ºï¼ãrunnnableï¼å¯è¿è¡ï¼ãblockedï¼é»å¡ï¼ãwaitingï¼ç­å¾ï¼ãtime waiting ï¼å®æ¶ç­å¾ï¼å terminatedï¼ç»æ­¢ï¼ã\n\n\n\n\n# sleepæ¹æ³åwaitæ¹æ³åºå«\n\nsleep()åwait()æ¹æ³é½å¯ä»¥æåçº¿ç¨çæ§è¡ï¼ä½å®ä»¬çä½ç¨åç¨æ³æ¯ä¸åçï¼\n\n 1. sleep() æ¹æ³æ¯ thread ç±»ä¸­çä¸ä¸ªéææ¹æ³ï¼å®ä¼æåå½åçº¿ç¨çæ§è¡ï¼è®©åºcpuçæ¶é´çï¼ä½æ¯ä¸ä¼éæ¾å½åçº¿ç¨ææçéãsleep() æ¹æ³çè°ç¨å¿é¡»æè· interruptedexception å¼å¸¸ã\n 2. wait() æ¹æ³æ¯ object ç±»ä¸­çä¸ä¸ªå®ä¾æ¹æ³ï¼å®ä¼è®©å½åçº¿ç¨ç­å¾ï¼ç´å°å¦ä¸ä¸ªçº¿ç¨è°ç¨ notify() æ notifyall() æ¹æ³å¤éå®ãè°ç¨ wait() æ¹æ³ççº¿ç¨å¿é¡»æ¥æè¯¥å¯¹è±¡çéï¼å¦åä¼æåº illegalmonitorstateexception å¼å¸¸ãwait() æ¹æ³ä¹å¿é¡»æè· interruptedexception å¼å¸¸ã\n\nå æ­¤ï¼sleep() å wait() çåºå«å¨äºï¼\n\n 1. sleep() ä¸ä¼éæ¾éï¼wait() ä¼éæ¾éã\n 2. sleep() åªè½å¨ thread ç±»ä¸­ä½¿ç¨ï¼è wait() å¯ä»¥å¨ä»»æå¯¹è±¡ä¸è°ç¨ï¼å ä¸º wait() æ¯ object ç±»çå®ä¾æ¹æ³ã\n 3. wait() å¿é¡»å¨ synchronized åææ¹æ³ä¸­ä½¿ç¨ï¼å¦åä¼æåº illegalmonitorstateexception å¼å¸¸ã\n 4. sleep() çä½ç¨æ¯æåå½åçº¿ç¨çæ§è¡ï¼è®©åºcpuçæ¶é´çï¼è wait() çä½ç¨æ¯è®©çº¿ç¨ç­å¾æä¸ªæ¡ä»¶çæ»¡è¶³ã\n\nå æ­¤ï¼å¦æéè¦æåå½åçº¿ç¨çæ§è¡ï¼å¯ä»¥ä½¿ç¨ sleep() æ¹æ³ï¼å¦æéè¦è®©çº¿ç¨ç­å¾æä¸ªæ¡ä»¶çæ»¡è¶³ï¼å¯ä»¥ä½¿ç¨ wait() æ¹æ³ã\n\n\n# sleep()ãwait()ãjoin()çåºå«\n\nwait() æ¹æ³æ¯ object ç±»ä¸­çæ¹æ³ï¼ç¨äºä½¿å½åçº¿ç¨ç­å¾ï¼ç´å°å¶ä»çº¿ç¨è°ç¨è¯¥å¯¹è±¡ç notify() æ notifyall() æ¹æ³å¤éå®ï¼sleep() å join() æ¹æ³æ¯ thread ç±»ä¸­çæ¹æ³ï¼sleepæ¯éææ¹æ³ï¼ thread.sleep()ãèjoin()éè¦çº¿ç¨å¯¹è±¡æ¥è°ç¨ã\n\nwait() æ¹æ³å¿é¡»å¨åæ­¥ä»£ç åæåæ­¥æ¹æ³ä¸­ä½¿ç¨ï¼å¦åä¼æåº illegalmonitorstateexception å¼å¸¸ï¼sleep() å join() æ¹æ³å¯ä»¥å¨ä»»ä½å°æ¹è°ç¨ï¼ä¸éè¦å¨åæ­¥ä»£ç åæåæ­¥æ¹æ³ä¸­ã\n\nwait() æ¹æ³ä¼éæ¾éï¼ä½¿å¾å¶ä»çº¿ç¨å¯ä»¥è·åéå¹¶ä¿®æ¹å±äº«åéï¼sleep() æ¹æ³ä¸ä¼éæ¾éï¼å½åçº¿ç¨ä»ç¶ææéã\n\nobjectä¸­çwaitãnotiftãnotifyallé½æ¯ç¨äºåè°å¤ä¸ªçº¿ç¨å¯¹å±äº«æ°æ®çå­åï¼æä»¥å¿é¡»å¨synchronizedè¯­å¥ååä½¿ç¨è¿ä¸ä¸ªæ¹æ³ãsynchronized å³é®å­ç¨äºä¿æ¤å±äº«æ°æ®ï¼é»æ­¢å¶ä»çº¿ç¨å¯¹å±äº«æ°æ®çå­åãä½æ¯è¿æ ·ç¨åºçæµç¨å°±å¾ä¸çµæ´»äºï¼å¦ä½æè½å¨å½åçº¿ç¨è¿æ²¡éåºsynchronizedæ°æ®åæ¶è®©å¶ä»çº¿ç¨ä¹ææºä¼è®¿é®å±äº«æ°æ®å¢ï¼æ­¤æ¶å°±ç¨è¿ä¸ä¸ªæ¹æ³æ¥çµæ´»æ§å¶ã\n\n * wait()æ¹æ³ä½¿å½åçº¿ç¨æåæ§è¡å¹¶éæ¾å¯¹è±¡éæ å¿ï¼è®©å¶ä»çº¿ç¨å¯ä»¥è¿å¥synchronizedæ°æ®åï¼å½åçº¿ç¨è¢«æ¾å¥å¯¹è±¡ç­å¾æ± ä¸­ã\n * å½è°ç¨ notify()æ¹æ³åï¼å°ä»å¯¹è±¡çç­å¾æ± ä¸­ç§»èµ°ä¸ä¸ªä»»æççº¿ç¨å¹¶æ¾å°éæ å¿ç­å¾æ± ä¸­ï¼åªæéæ å¿ç­å¾æ± ä¸­ççº¿ç¨è½å¤è·åéæ å¿ï¼å¦æéæ å¿ç­å¾æ± ä¸­æ²¡æçº¿ç¨ï¼ånotify()ä¸èµ·ä½ç¨ã\n * notifyall()åä»å¯¹è±¡ç­å¾æ± ä¸­ç§»èµ°ææç­å¾é£ä¸ªå¯¹è±¡ççº¿ç¨å¹¶æ¾å°éæ å¿ç­å¾æ± ä¸­ã\n\npublic class waitnotifyexample {\n    public static void main(string[] args) {\n        final object lock = new object(); // å®ä¹ä¸ä¸ªéå¯¹è±¡\n\n        // çº¿ç¨aï¼ç­å¾éå¯¹è±¡\n        thread threada = new thread(new runnable() {\n            public void run() {\n                synchronized (lock) {\n                    try {\n                        system.out.println("threada is waiting...");\n                        lock.wait(); // ç­å¾éå¯¹è±¡\n                        system.out.println("threada is woken up!");\n                    } catch (interruptedexception e) {\n                        e.printstacktrace();\n                    }\n                }\n            }\n        });\n\n        // çº¿ç¨bï¼å¤éç­å¾ççº¿ç¨\n        thread threadb = new thread(new runnable() {\n            public void run() {\n                synchronized (lock) {\n                    system.out.println("threadb is notifying...");\n                    lock.notify(); // å¤éç­å¾ççº¿ç¨\n                }\n            }\n        });\n\n        // å¯å¨çº¿ç¨aåçº¿ç¨b\n        threada.start();\n        threadb.start();\n    }\n}\n\n\nsleepï¼threadç±»çæ¹æ³ï¼å¿é¡»å¸¦ä¸ä¸ªæ¶é´åæ°ãä¼è®©å½åçº¿ç¨ä¼ç è¿å¥é»å¡ç¶æå¹¶éæ¾cpuèµæºï¼æä¾å¶ä»çº¿ç¨è¿è¡çæºä¼ä¸ä¸èèä¼åçº§ï¼ä½å¦ææåæ­¥éåsleepä¸ä¼éæ¾éå³å¶ä»çº¿ç¨æ æ³è·å¾åæ­¥éï¼å¯éè¿è°ç¨interrupt()æ¹æ³æ¥å¤éä¼ç çº¿ç¨ã\n\nyieldï¼è®©åºcpuè°åº¦ï¼threadç±»çæ¹æ³ï¼ç±»ä¼¼sleepåªæ¯ä¸è½ç±ç¨æ·æå®æåå¤é¿æ¶é´ ï¼å¹¶ä¸yield()æ¹æ³åªè½è®©åä¼åçº§ççº¿ç¨ææ§è¡çæºä¼ã yield()åªæ¯ä½¿å½åçº¿ç¨éæ°åå°å¯æ§è¡ç¶æï¼æä»¥æ§è¡yield()ççº¿ç¨æå¯è½å¨è¿å¥å°å¯æ§è¡ç¶æåé©¬ä¸åè¢«æ§è¡ãè°ç¨yieldæ¹æ³åªæ¯ä¸ä¸ªå»ºè®®ï¼åè¯çº¿ç¨è°åº¦å¨æçå·¥ä½å·²ç»åçå·®ä¸å¤äºï¼å¯ä»¥è®©å«çç¸åä¼åçº§ççº¿ç¨ä½¿ç¨cpuäºï¼æ²¡æä»»ä½æºå¶ä¿è¯éçº³ã\n\nwaitï¼objectç±»çæ¹æ³(notify()ãnotifyall() ä¹æ¯objectå¯¹è±¡)ï¼å¿é¡»æ¾å¨å¾ªç¯ä½ååæ­¥ä»£ç åä¸­ï¼æ§è¡è¯¥æ¹æ³ççº¿ç¨ä¼éæ¾éï¼è¿å¥çº¿ç¨ç­å¾æ± ä¸­ç­å¾è¢«åæ¬¡å¤é(notifyéæºå¤éï¼notifyallå¨é¨å¤éï¼çº¿ç¨ç»æèªå¨å¤é)å³æ¾å¥éæ± ä¸­ç«äºåæ­¥é\n\njoinï¼ä¸ç§ç¹æ®çwaitï¼å½åè¿è¡çº¿ç¨è°ç¨å¦ä¸ä¸ªçº¿ç¨çjoinæ¹æ³ï¼å½åçº¿ç¨è¿å¥é»å¡ç¶æç´å°å¦ä¸ä¸ªçº¿ç¨è¿è¡ç»æç­å¾è¯¥çº¿ç¨ç»æ­¢ã æ³¨æè¯¥æ¹æ³ä¹éè¦ææå¼å¸¸ã\n\nç­å¾è°ç¨joinæ¹æ³ççº¿ç¨ç»æï¼åç»§ç»­æ§è¡ãå¦ï¼t.join();//ä¸»è¦ç¨äºç­å¾tçº¿ç¨è¿è¡ç»æï¼è¥æ æ­¤å¥ï¼mainåä¼æ§è¡å®æ¯ï¼å¯¼è´ç»æä¸å¯é¢æµã\n\n\n# javaç¨åºå¦ä½ä¿è¯å¤çº¿ç¨è¿è¡å®å¨\n\nçº¿ç¨å®å¨å¨ä¸ä¸ªæ¹é¢ä½ç°ï¼\n\nåå­æ§ï¼æä¾äºæ¥è®¿é®ï¼åä¸æ¶å»åªè½æä¸ä¸ªçº¿ç¨å¯¹æ°æ®è¿è¡æä½ï¼ï¼atomicï¼synchronizedï¼ï¼\n\nå¯è§æ§ï¼ä¸ä¸ªçº¿ç¨å¯¹ä¸»åå­çä¿®æ¹å¯ä»¥åæ¶å°è¢«å¶ä»çº¿ç¨çå°ï¼ï¼synchronizedãvolatileï¼ï¼\n\næåºæ§ï¼ä¸ä¸ªçº¿ç¨è§å¯å¶ä»çº¿ç¨ä¸­çæä»¤æ§è¡é¡ºåºï¼ç±äºæä»¤éæåºï¼è¯¥è§å¯ç»æä¸è¬æä¹±æ åºï¼ï¼happens-before ååï¼ã\n\nå¯è§æ§åæåºæ§ï¼\n\nä¿è¯å¯è§æ§æå³çå½ä¸ä¸ªçº¿ç¨ä¿®æ¹äºæä¸ªå±äº«åéçå¼æ¶ï¼å¶ä»çº¿ç¨è½å¤ç«å³çå°è¿ä¸ªåéçææ°å¼ï¼ä»èé¿åäºæ°æ®ä¸ä¸è´çé®é¢ãjavaä¸­æä¾çvolatileå³é®å­å°±æ¯ä¸ç§ä¿è¯å¯è§æ§çæºå¶ã\n\nèä¿è¯æåºæ§åæ¯è¦ç¡®ä¿å¨å¤çº¿ç¨ç¯å¢ä¸ï¼å¯¹å±äº«åéçè¯»åæä½è½å¤æç§ç¨åºçåæé¡ºåºè¿è¡ï¼é¿åäºæä»¤éæåå¶ä»å ç´ å¼èµ·çæ§è¡é¡ºåºé®é¢ãjavaä¸­çhappens-beforeè§åå¯ä»¥ä¿è¯ç¨åºçæåºæ§ï¼happens-beforeè§åæè¿°äºå¨å¤çº¿ç¨ç¯å¢ä¸çåç§æä½ä¹é´çé¡ºåºå³ç³»ã\n\nå æ­¤ï¼ä¿è¯å¯è§æ§åªæ¯ä¿è¯äºæ°æ®ä¸è´æ§ï¼èä¿è¯æåºæ§å¯ä»¥é¿åç¨åºåºç°åç§é¾ä»¥é¢æçé®é¢ãå¨å®éå¼åä¸­ï¼æä»¬éè¦åæ¶èèä¿è¯å¯è§æ§åæåºæ§ï¼æè½ä¿è¯å¤çº¿ç¨ç¨åºçæ­£ç¡®æ§åæ§è½ã\n\nhappens-beforeååï¼ï¼æ¯javaåå­æ¨¡åçä¸é¨åï¼ç¨äºå®ä¹å¤çº¿ç¨ç¨åºä¸­å±äº«åéçè¯»åæä½çé¡ºåºå³ç³»ï¼ä¿è¯äºç¨åºçå¯è§æ§åæåºæ§ãï¼\n\n 1. ç¨åºé¡ºåºè§åï¼ä¸ä¸ªçº¿ç¨åæç§ç¨åºä»£ç é¡ºåºæ§è¡çç»æï¼happens-beforeäºè¯¥çº¿ç¨åçä»»æåç»­æä½ã\n 2. éå®è§åï¼ä¸ä¸ªunlockæä½happens-beforeäºåç»­çä»»ælockæä½ï¼åä¸ä¸ªéï¼ï¼åä¹ä¹æç«ã\n 3. volatileåéè§åï¼å¯¹ä¸ä¸ªvolatileåéçåæä½happens-beforeäºåç»­çä»»æè¯»æä½ï¼åä¸ä¸ªvolatileåéï¼ï¼åä¹ä¹æç«ã\n 4. ä¼ éæ§è§åï¼å¦ææä½a happens-beforeäºæä½bï¼ä¸æä½b happens-beforeäºæä½cï¼é£ä¹æä½a happens-beforeäºæä½cã\n 5. çº¿ç¨å¯å¨è§åï¼ä¸ä¸ªçº¿ç¨çå¯å¨æä½happens-beforeäºè¯¥çº¿ç¨ä¸­çä»»ææä½ã\n 6. çº¿ç¨ç»æ­¢è§åï¼çº¿ç¨ä¸­çä»»ææä½happens-beforeäºè¯¥çº¿ç¨çç»æ­¢æä½ã\n 7. çº¿ç¨ä¸­æ­è§åï¼å¯¹çº¿ç¨ interrupt() æ¹æ³çè°ç¨ happens-before äºè¢«ä¸­æ­çº¿ç¨ä¸­çä»»ææä½ã\n 8. å¯¹è±¡ç»ç»è§åï¼ä¸ä¸ªå¯¹è±¡çåå§åæä½ happens-before äºfinalize() æ¹æ³çå¼å§ã\n\nå¨å¤çº¿ç¨ç¨åºä¸­ï¼éµå®happens-beforeè§åå¯ä»¥ä¿è¯ç¨åºçæåºæ§åæ­£ç¡®æ§ãéè¿åçå°ä½¿ç¨åæ­¥æºå¶åvolatileå³é®å­ï¼å¯ä»¥å®ç°çº¿ç¨ä¹é´çé¡ºåºæ§è¡ï¼é¿åæ°æ®ç«äºåæä»¤éæç­é®é¢ã\n\njavaä¸­æå¤ç§æºå¶å¯ä»¥ä¿è¯å¤çº¿ç¨è¿è¡çå®å¨ï¼ä¸é¢åä¸¾å ç§ä¸»è¦çæ¹å¼ï¼\n\n 1. synchronizedå³é®å­ï¼ä½¿ç¨synchronizedå³é®å­å¯ä»¥å°ä¸æ®µä»£ç åææ¹æ³æ è®°ä¸ºåæ­¥ä»£ç ï¼åä¸æ¶å»åªè½æä¸ä¸ªçº¿ç¨è¿å¥è¯¥ä»£ç åææ¹æ³ãè¿ç§æ¹å¼éè¦æ³¨æéå¯¹è±¡çéæ©ï¼éè¦ä¿è¯ä¸åçº¿ç¨ä½¿ç¨çæ¯åä¸ä¸ªéå¯¹è±¡ã\n 2. reentrantlockç±»ï¼ä¸synchronizedç±»ä¼¼ï¼reentrantlockä¹æ¯ä¸ç§åæ­¥æºå¶ãä½¿ç¨reentrantlockéè¦æå¨è·ååéæ¾éï¼å æ­¤æ´çµæ´»ãå¦å¤ï¼reentrantlockè¿æä¾äºä¸äºé«çº§ç¹æ§ï¼å¦å¬å¹³éåå¯éå¥éç­ã\n 3. volatileå³é®å­ï¼ä½¿ç¨volatileå³é®å­å¯ä»¥ä¿è¯å¤ä¸ªçº¿ç¨å¯¹åéçå¯è§æ§ãå³ä¸ä¸ªçº¿ç¨ä¿®æ¹äºä¸ä¸ªvolatileåéçå¼ï¼å¶ä»çº¿ç¨å¯ä»¥ç«å³çå°è¿ä¸ªå¼çååãä½æ¯volatileä¸è½ä¿è¯åå­æ§ã\n 4. atomicç±»ï¼javaä¸­æä¾äºatomicintegerãatomicbooleanãatomiclongç­åå­ç±»ï¼ä½¿ç¨è¿äºç±»å¯ä»¥ä¿è¯æä½çåå­æ§ã\n 5. threadlocalç±»ï¼threadlocalæ¯ä¸ä¸ªçº¿ç¨åé¨çæ°æ®ç»æï¼å¯ä»¥ç¨æ¥ä¿å­çº¿ç¨çå±é¨åéãthreadlocalä¸ºæ¯ä¸ªçº¿ç¨é½æä¾äºä¸ä¸ªç¬ç«çåéå¯æ¬ï¼ä»èé¿åäºçº¿ç¨å®å¨é®é¢ã\n 6. çº¿ç¨æ± ï¼ä½¿ç¨çº¿ç¨æ± å¯ä»¥é¿ååå»ºè¿å¤ççº¿ç¨ï¼ä»èæé«ç¨åºæ§è½åç¨³å®æ§ãjavaä¸­æä¾äºthreadpoolexecutorç±»ï¼å¯ä»¥æ ¹æ®éè¦èªå®ä¹çº¿ç¨æ± çå¤§å°åå¶ä»åæ°ã\n 7. çº¿ç¨å®å¨çå®¹å¨ï¼concurrenthashmapãcopyonwritearraylistãblockingqueueãconcurrentskiplistmapãconcurrentskiplistset\n\n\n# javaçº¿ç¨åæ­¥çå ç§æ¹æ³\n\n * ä½¿ç¨ synchronized å³é®å­\n * ä½¿ç¨wait å notifyï¼éç»åsynchronizedä½¿ç¨\n * ä½¿ç¨å¯éå¥é reentrantlock\n * ä½¿ç¨é»å¡éå blockqueue\n * ä½¿ç¨ä¿¡å·é semaphone',charsets:{cjk:!0}},{title:"AQS",frontmatter:{title:"AQS",date:"2023-09-08T14:26:54.000Z",permalink:"/pages/109178/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/12.AQS.html",relativePath:"01.Java/04.Javaå¹¶å/12.AQS.md",key:"v-6b463bfb",path:"/pages/109178/",headersStr:null,content:"AbstractQueuedSynchronizer æ½è±¡åæ­¥éåï¼ç®ç§° AQS ï¼å®æ¯Javaå¹¶ååçæ ¹åºï¼å¹¶ååä¸­çéå°±æ¯åºäºAQSå®ç°çã\n\n * AQSæ¯åºäºä¸ä¸ªFIFOçååéåï¼å¶åé¨å®ä¹äºä¸ä¸ªèç¹ç±»Nodeï¼Node èç¹åé¨ç SHARED ç¨æ¥æ è®°è¯¥çº¿ç¨æ¯è·åå±äº«èµæºæ¶è¢«é»æèµ·åæ¾å¥AQS éåçï¼ EXCLUSIVE ç¨æ¥æ è®°çº¿ç¨æ¯ åç¬å èµæºæ¶è¢«æèµ·åæ¾å¥AQS éå\n * AQS ä½¿ç¨ä¸ä¸ª volatile ä¿®é¥°ç int ç±»åçæååé state æ¥è¡¨ç¤ºåæ­¥ç¶æï¼ä¿®æ¹åæ­¥ç¶ææåå³ä¸ºè·å¾éï¼volatile ä¿è¯äºåéå¨å¤çº¿ç¨ä¹é´çå¯è§æ§ï¼ä¿®æ¹ State å¼æ¶éè¿ CAS æºå¶æ¥ä¿è¯ä¿®æ¹çåå­æ§\n * è·åstateçæ¹å¼åä¸ºä¸¤ç§ï¼ç¬å æ¹å¼åå±äº«æ¹å¼ï¼ä¸ä¸ªçº¿ç¨ä½¿ç¨ç¬å æ¹å¼è·åäºèµæºï¼å¶å®çº¿ç¨å°±ä¼å¨è·åå¤±è´¥åè¢«é»å¡ãä¸ä¸ªçº¿ç¨ä½¿ç¨å±äº«æ¹å¼è·åäºèµæºï¼å¦å¤ä¸ä¸ªçº¿ç¨è¿å¯ä»¥éè¿CASçæ¹å¼è¿è¡è·åã\n * å¦æå±äº«èµæºè¢«å ç¨ï¼éè¦ä¸å®çé»å¡ç­å¾å¤éæºå¶æ¥ä¿è¯éçåéï¼AQS ä¸­ä¼å°ç«äºå±äº«èµæºå¤±è´¥ççº¿ç¨æ·»å å°ä¸ä¸ªåä½ç CLH éåä¸­ã\n\n\n\nAQS ä¸­ç CLH åä½ç­å¾éåæ¥æä»¥ä¸ç¹æ§ï¼\n\n * AQS ä¸­éåæ¯ä¸ªååé¾è¡¨ï¼ä¹æ¯ FIFO åè¿ååºçç¹æ§\n * éè¿ HeadãTail å¤´å°¾ä¸¤ä¸ªèç¹æ¥ç»æéåç»æï¼éè¿ volatile ä¿®é¥°ä¿è¯å¯è§æ§\n * Head æåèç¹ä¸ºå·²è·å¾éçèç¹ï¼æ¯ä¸ä¸ªèæèç¹ï¼èç¹æ¬èº«ä¸ææå·ä½çº¿ç¨\n * è·åä¸å°åæ­¥ç¶æï¼ä¼å°èç¹è¿è¡èªæè·åéï¼èªæä¸å®æ¬¡æ°å¤±è´¥åä¼å°çº¿ç¨é»å¡ï¼ç¸å¯¹äº CLH éåæ§è½è¾å¥½",normalizedContent:"abstractqueuedsynchronizer æ½è±¡åæ­¥éåï¼ç®ç§° aqs ï¼å®æ¯javaå¹¶ååçæ ¹åºï¼å¹¶ååä¸­çéå°±æ¯åºäºaqså®ç°çã\n\n * aqsæ¯åºäºä¸ä¸ªfifoçååéåï¼å¶åé¨å®ä¹äºä¸ä¸ªèç¹ç±»nodeï¼node èç¹åé¨ç shared ç¨æ¥æ è®°è¯¥çº¿ç¨æ¯è·åå±äº«èµæºæ¶è¢«é»æèµ·åæ¾å¥aqs éåçï¼ exclusive ç¨æ¥æ è®°çº¿ç¨æ¯ åç¬å èµæºæ¶è¢«æèµ·åæ¾å¥aqs éå\n * aqs ä½¿ç¨ä¸ä¸ª volatile ä¿®é¥°ç int ç±»åçæååé state æ¥è¡¨ç¤ºåæ­¥ç¶æï¼ä¿®æ¹åæ­¥ç¶ææåå³ä¸ºè·å¾éï¼volatile ä¿è¯äºåéå¨å¤çº¿ç¨ä¹é´çå¯è§æ§ï¼ä¿®æ¹ state å¼æ¶éè¿ cas æºå¶æ¥ä¿è¯ä¿®æ¹çåå­æ§\n * è·åstateçæ¹å¼åä¸ºä¸¤ç§ï¼ç¬å æ¹å¼åå±äº«æ¹å¼ï¼ä¸ä¸ªçº¿ç¨ä½¿ç¨ç¬å æ¹å¼è·åäºèµæºï¼å¶å®çº¿ç¨å°±ä¼å¨è·åå¤±è´¥åè¢«é»å¡ãä¸ä¸ªçº¿ç¨ä½¿ç¨å±äº«æ¹å¼è·åäºèµæºï¼å¦å¤ä¸ä¸ªçº¿ç¨è¿å¯ä»¥éè¿casçæ¹å¼è¿è¡è·åã\n * å¦æå±äº«èµæºè¢«å ç¨ï¼éè¦ä¸å®çé»å¡ç­å¾å¤éæºå¶æ¥ä¿è¯éçåéï¼aqs ä¸­ä¼å°ç«äºå±äº«èµæºå¤±è´¥ççº¿ç¨æ·»å å°ä¸ä¸ªåä½ç clh éåä¸­ã\n\n\n\naqs ä¸­ç clh åä½ç­å¾éåæ¥æä»¥ä¸ç¹æ§ï¼\n\n * aqs ä¸­éåæ¯ä¸ªååé¾è¡¨ï¼ä¹æ¯ fifo åè¿ååºçç¹æ§\n * éè¿ headãtail å¤´å°¾ä¸¤ä¸ªèç¹æ¥ç»æéåç»æï¼éè¿ volatile ä¿®é¥°ä¿è¯å¯è§æ§\n * head æåèç¹ä¸ºå·²è·å¾éçèç¹ï¼æ¯ä¸ä¸ªèæèç¹ï¼èç¹æ¬èº«ä¸ææå·ä½çº¿ç¨\n * è·åä¸å°åæ­¥ç¶æï¼ä¼å°èç¹è¿è¡èªæè·åéï¼èªæä¸å®æ¬¡æ°å¤±è´¥åä¼å°çº¿ç¨é»å¡ï¼ç¸å¯¹äº clh éåæ§è½è¾å¥½",charsets:{cjk:!0}},{title:"å¦ä½å®ç° ReentrantLockï¼",frontmatter:{title:"å¦ä½å®ç° ReentrantLockï¼",date:"2023-03-31T17:17:06.000Z",permalink:"/pages/3c96b3/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/99.%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%20ReentrantLock%EF%BC%9F.html",relativePath:"01.Java/04.Javaå¹¶å/99.å¦ä½å®ç° ReentrantLockï¼.md",key:"v-74777bb3",path:"/pages/3c96b3/",headers:[{level:2,title:"ReentrantLock æ¯ä»ä¹ï¼æä¾ä»ä¹åè½ï¼",slug:"reentrantlock-æ¯ä»ä¹-æä¾ä»ä¹åè½",normalizedTitle:"reentrantlock æ¯ä»ä¹ï¼æä¾ä»ä¹åè½ï¼",charIndex:2},{level:2,title:"ReentrantLock è· Synchronized çå¯¹æ¯",slug:"reentrantlock-è·-synchronized-çå¯¹æ¯",normalizedTitle:"reentrantlock è· synchronized çå¯¹æ¯",charIndex:409},{level:2,title:"ReentrantLock çä½¿ç¨",slug:"reentrantlock-çä½¿ç¨",normalizedTitle:"reentrantlock çä½¿ç¨",charIndex:779},{level:2,title:"ReentrantLock æ¯å¦ä½å®ç°çï¼",slug:"reentrantlock-æ¯å¦ä½å®ç°ç",normalizedTitle:"reentrantlock æ¯å¦ä½å®ç°çï¼",charIndex:948},{level:3,title:"æ´ä½å®ç°æµç¨",slug:"æ´ä½å®ç°æµç¨",normalizedTitle:"æ´ä½å®ç°æµç¨",charIndex:974},{level:3,title:"éå¥éåå¶ä»ééå¥éçå®ç°",slug:"éå¥éåå¶ä»ééå¥éçå®ç°",normalizedTitle:"éå¥éåå¶ä»ééå¥éçå®ç°",charIndex:1244},{level:3,title:"å¬å¹³éåéå¬å¹³éçå®ç°",slug:"å¬å¹³éåéå¬å¹³éçå®ç°",normalizedTitle:"å¬å¹³éåéå¬å¹³éçå®ç°",charIndex:1508},{level:2,title:"ReentranLock ä¸ AQS",slug:"reentranlock-ä¸-aqs",normalizedTitle:"reentranlock ä¸ aqs",charIndex:1998},{level:2,title:"AQS",slug:"aqs",normalizedTitle:"aqs",charIndex:493},{level:3,title:"åºå±æ°æ®ç»æ",slug:"åºå±æ°æ®ç»æ",normalizedTitle:"åºå±æ°æ®ç»æ",charIndex:2255},{level:3,title:"éè¿ä¿®æ¹ state åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼",slug:"éè¿ä¿®æ¹-state-åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼",normalizedTitle:"éè¿ä¿®æ¹ state åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼",charIndex:2439},{level:3,title:"èªå®ä¹åæ­¥å¨",slug:"èªå®ä¹åæ­¥å¨",normalizedTitle:"èªå®ä¹åæ­¥å¨",charIndex:2476},{level:3,title:"AQS åºç¨",slug:"aqs-åºç¨",normalizedTitle:"aqs åºç¨",charIndex:4147},{level:2,title:"Q & Aï¼ReentrantLockï¼",slug:"q-a-reentrantlock",normalizedTitle:"q &amp; aï¼reentrantlockï¼",charIndex:null},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:5272}],headersStr:"ReentrantLock æ¯ä»ä¹ï¼æä¾ä»ä¹åè½ï¼ ReentrantLock è· Synchronized çå¯¹æ¯ ReentrantLock çä½¿ç¨ ReentrantLock æ¯å¦ä½å®ç°çï¼ æ´ä½å®ç°æµç¨ éå¥éåå¶ä»ééå¥éçå®ç° å¬å¹³éåéå¬å¹³éçå®ç° ReentranLock ä¸ AQS AQS åºå±æ°æ®ç»æ éè¿ä¿®æ¹ state åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼ èªå®ä¹åæ­¥å¨ AQS åºç¨ Q & Aï¼ReentrantLockï¼ åèèµæ",content:"# ReentrantLock æ¯ä»ä¹ï¼æä¾ä»ä¹åè½ï¼\n\nReentrantLock ä¸ºå¯éå¥éï¼æä¸ä¸ªçº¿ç¨å¯ä»¥å¯¹ä¸´çèµæºéå¤å éã\n\n * æ¯æå¬å¹³éåéå¬å¹³éã\n\n * æ¯æè®¾ç½®å¤ä¸ªæ¡ä»¶ã\n\n * æ¯æååºä¸­æ­ã\n\nå¬å¹³éåéå¬å¹³éï¼\n\nå¬å¹³éæ¯æå¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼çº¿ç¨ç´æ¥è¿å¥éåä¸­æéï¼éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨æè½è·å¾éãå¬å¹³éçä¼ç¹æ¯ç­å¾éççº¿ç¨ä¸ä¼é¥¿æ­»ãç¼ºç¹æ¯æ´ä½ååæçç¸å¯¹éå¬å¹³éè¦ä½ï¼ç­å¾éåä¸­é¤ç¬¬ä¸ä¸ªçº¿ç¨ä»¥å¤çææçº¿ç¨é½ä¼é»å¡ï¼CPUå¤éé»å¡çº¿ç¨çå¼éæ¯éå¬å¹³éå¤§ã\n\néå¬å¹³éæ¯å¤ä¸ªçº¿ç¨å éæ¶ç´æ¥å°è¯è·åéï¼è·åä¸å°æä¼å°ç­å¾éåçéå°¾ç­å¾ãä½å¦ææ­¤æ¶éåå¥½å¯ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨å¯ä»¥æ éé»å¡ç´æ¥è·åå°éãéå¬å¹³éçä¼ç¹æ¯å¯ä»¥åå°å¤èµ·çº¿ç¨çå¼éï¼æ´ä½çååæçé«ï¼å ä¸ºçº¿ç¨æå çä¸é»å¡ç´æ¥è·å¾éï¼CPUä¸å¿å¤éææçº¿ç¨ãç¼ºç¹æ¯å¤äºç­å¾éåä¸­ççº¿ç¨å¯è½ä¼é¥¿æ­»ï¼æèç­å¾ä¹æä¼è·å¾éã\n\n\n# ReentrantLock è· Synchronized çå¯¹æ¯\n\n        REENTRANTLOCK     SYNCHRONIZED\néå®ç°æºå¶   ä¾èµ AQS            ä¾èµ JDK\nçµæ´»æ§     æ¯æååºä¸­æ­ãè¶æ¶ãå°è¯è·åé   ä¸çµæ´»\nééæ¾å½¢å¼   å¿é¡»æ¾ç¤ºè°ç¨ unlock()   èªå¨éæ¾çè§å¨\néç±»å     å¬å¹³é & éå¬å¹³é        éå¬å¹³é\næ¡ä»¶éå    å¯å³èå¤ä¸ªæ¡ä»¶           åªè½å³èä¸ä¸ªæ¡ä»¶\nå¯éå¥æ§    å¯éå¥               å¯éå¥\n\né½æ¯å¯éå¥éãå¯éå¥çæææ¯åä¸ä¸ªçº¿ç¨å¨å¤å±æ¹æ³è·åéçæ¶åï¼è¯¥çº¿ç¨çåå±æ¹æ³ä¼èªå¨è·åè¯¥éï¼åææ¯éçå¯¹è±¡æ¯åä¸ä¸ªå¯¹è±¡æclassï¼ï¼ä¸ä¼å ä¸ºä¹åè·åè¿è¿æ²¡éæ¾èé»å¡ãå¨ä¸å®ç¨åº¦ä¸å¯ä»¥é¿åæ­»éã\n\n\n# ReentrantLock çä½¿ç¨\n\nReentrantLock lock = new ReentrantLock();\nlock.lock();\ntry {\n    if(lock.tryLock(100, TimeUnit.MILLISECONDS)){ }\n} finally {\n    lock.unlock()\n}\n\n\n\n# ReentrantLock æ¯å¦ä½å®ç°çï¼\n\n\n# æ´ä½å®ç°æµç¨\n\nç»§æ¿ AQSï¼å·ä½è·åéçæ¹æ³ç±åé¨ç±»å¬å¹³éï¼FairSyncï¼åéå¬å¹³éï¼NonfairSyncï¼éå tryAcquire() æ¹æ³å®ç°ï¼è¯¥æ¹æ³éè¿ CAS å»è®¾ç½® stateï¼å¦æè¯¥æ¹æ³è¿åäº trueï¼è¡¨ç¤ºå½åçº¿ç¨è·åéæåï¼æ§è¡ç»æï¼å¦æè¯¥æ¹æ³è¿å falseï¼è¡¨ç¤ºè·åå¤±è´¥ï¼åéè¦å å¥ç­å¾éåä¸­ï¼éè¿æ§è¡ addWaiter(Node.EXCLUSIVE)ã\n\nå¨ ReentrantLock éé¢çå¬å¹³éåéå¬å¹³éçç¶ç±» Sync å®ä¹äºå¯éå¥éçéæ¾éæºå¶ï¼éåäº tryRelease() æ¹æ³ã\n\n\n# éå¥éåå¶ä»ééå¥éçå®ç°\n\néè¿ç¶ç±» AQS ä¸­ç»´æ¤çåæ­¥ç¶æ state æ¥è®¡ç®éå¥æ¬¡æ°ï¼state åå§åä¸º0ã\n\nå½çº¿ç¨å°è¯è·åéæ¶ï¼å¯éå¥éåå°è¯è·åå¹¶æ´æ° state å¼ï¼å¦æ state == 0 è¡¨ç¤ºæ²¡æå¶ä»çº¿ç¨å ç¨ï¼å° state ç½®ä½1ï¼å½åçº¿ç¨å¼å§æ§è¡ï¼å¦æ state != 0ï¼åå¤æ­å½åçº¿ç¨æ¯å¦æ¯è·åå°è¿ä¸ªéççº¿ç¨ï¼å¦ææ¯çè¯ï¼state + 1ï¼ä¸å½åçº¿ç¨å¯ä»¥åæ¬¡è·åéã\n\nééå¥éåæ¯ç´æ¥å»è·åå¹¶å°è¯æ´æ°å½å state çå¼ï¼å¦æ state != 0ï¼åè·åéå¤±è´¥ï¼å½åçº¿ç¨é»å¡ã\n\n\n# å¬å¹³éåéå¬å¹³éçå®ç°\n\nReentrantLock çå¬å¹³éåéå¬å¹³éé½æ¯ç¬äº«éãå½ä¸ä¸ªçº¿ç¨è°ç¨ lock æ¹æ³è·åéæ¶ï¼å¦æåæ­¥èµæºæ²¡æè¢«å¶ä»çº¿ç¨éä½ï¼é£ä¹å½åçº¿ç¨ä½¿ç¨ CAS æ´æ° state å¼æååä¼æ¢å è¯¥èµæºãå¦æåæ­¥èµæºè¢«å ç¨ä¸ä¸æ¯å½åçº¿ç¨å ç¨æ¶ï¼åå éå¤±è´¥ã\n\nReentrantLock ä¸­æä¸ä¸ªåé¨ç±» Syncï¼Sync ç»§æ¿äº AQSï¼AbstractQueuedSynchronizerï¼ï¼å¬å¹³éï¼FairSyncï¼åéå¬å¹³éï¼NonfairSyncï¼ç»§æ¿äºSyncãReentrantLocké»è®¤ä½¿ç¨éå¬å¹³éï¼å¯éè¿æé å¨æå®ä½¿ç¨å¬å¹³éã\n\nå¬å¹³éä¸éå¬å¹³éç lock() æ¹æ³å¯ä¸çåºå«å°±å¨äºå¬å¹³éå¨è·ååæ­¥ç¶ææ¶å¤äºä¸ä¸ªéå¶æ¡ä»¶ï¼hasQueuedPredecessors()ãä¸»è¦æ¯ç¨äºå¤æ­å½åçº¿ç¨æ¯å¦ä½äºåæ­¥éåä¸­çç¬¬ä¸ä¸ªãå¦ææ¯åè¿åtrueï¼å¦åè¿åfalseã\n\nå¬å¹³éå°±æ¯éè¿åæ­¥éåæ¥å®ç°å¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼ä»èå®ç°å¬å¹³çç¹æ§ãéå¬å¹³éå éæ¶ä¸èèæéç­å¾é®é¢ï¼ç´æ¥å°è¯è·åéï¼æä»¥å­å¨åç³è¯·å´åè·å¾éçæåµã\n\n\n# ReentranLock ä¸ AQS\n\nå éé»è¾ï¼éè¿ CAS è®¾ç½® stateï¼è®¾ç½®æåè¡¨ç¤ºè·åéæåãè·åéå¤±è´¥åè¿å¥ç­å¾éåå¤çã\n\nReentrantLock å éè§£éæ¶ API å±æ ¸å¿æ¹æ³çæ å°å³ç³»ï¼\n\n\n\n\n# AQS\n\nAQS çæ ¸å¿ææ³æ¯ï¼å¦æå±äº«èµæºç©ºé²ï¼å°å½åè¯·æ±èµæºççº¿ç¨è®¾ç½®ä¸ºææçå·¥ä½çº¿ç¨ï¼åæ¶éè¿ CAS å°å±äº«èµæºçç¶æï¼stateï¼è®¾ç½®ä¸ºéå®ç¶æãå¦æå±äº«èµæºè¢«å ç¨ï¼åéè¿é»å¡ç­å¾å¤éæºå¶æ¥ä¿è¯éçåéï¼è¿ééè¿ CLH éåçåä½å®ç°ï¼å°ææ¶æ²¡è·åå°éççº¿ç¨å å¥éåã\n\n\n# åºå±æ°æ®ç»æ\n\n * Nodeèç¹ç CLHéåãåå§ç CLH æ¯ååé¾è¡¨ï¼AQS çéåæ¯ CLH çåä½ï¼æ¯èæååéåï¼AQS éè¿å°æ¯æ¡è¯·æ±å±äº«èµæºççº¿ç¨å°è£æä¸ä¸ªèç¹ï¼Nodeï¼æ¥å®ç°éçåéã\n * stateãç¨ volatile int state è¡¨ç¤ºåæ­¥ç¶æï¼éè¿ CAS å®æå¯¹ state å¼çä¿®æ¹ï¼éè¿éåå®æèµæºè·åçæéã\n\n\n\n\n# éè¿ä¿®æ¹ state åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼\n\n\n\n\n# èªå®ä¹åæ­¥å¨\n\n * ç¬å æ¨¡å¼ï¼å®ç° tryAcquire-tryReleaseãå¦ ReentrantLock\n * å±äº«æ¨¡å¼ï¼å®ç° ryAcquireShared-tryReleaseShared\n * åæ¶å®ç°ç¬å åå±äº«ä¸¤ç§æ¨¡å¼ãå¦ ReentrantReadWriteLock\n\npublic class LeeLock  {\n\n    private static class Sync extends AbstractQueuedSynchronizer {\n        @Override\n        protected boolean tryAcquire (int arg) {\n            return compareAndSetState(0, 1);\n        }\n\n        @Override\n        protected boolean tryRelease (int arg) {\n            setState(0);\n            return true;\n        }\n\n        @Override\n        protected boolean isHeldExclusively () {\n            return getState() == 1;\n        }\n    }\n\n    private Sync sync = new Sync();\n\n    public void lock () {\n        sync.acquire(1);\n    }\n\n    public void unlock () {\n        sync.release(1);\n    }\n}\n\n\npublic class LeeMain {\n\n    static int count = 0;\n    static LeeLock leeLock = new LeeLock();\n\n    public static void main (String[] args) throws InterruptedException {\n\n        Runnable runnable = new Runnable() {\n            @Override\n            public void run () {\n                try {\n                    leeLock.lock();\n                    for (int i = 0; i < 10000; i++) {\n                        count++;\n                    }\n                } catch (Exception e) {\n                    e.printStackTrace();\n                } finally {\n                    leeLock.unlock();\n                }\n\n            }\n        };\n        Thread thread1 = new Thread(runnable);\n        Thread thread2 = new Thread(runnable);\n        thread1.start();\n        thread2.start();\n        thread1.join();\n        thread2.join();\n        System.out.println(count);\n    }\n}\n\n\nä¸è¿°ä»£ç æ¯æ¬¡è¿è¡ç»æé½ä¼æ¯ 20000ãéè¿ç®åçå è¡ä»£ç å®ç°åæ­¥åè½ã\n\n\n# AQS åºç¨\n\nå®ç° ReentrantLock å¯éå¥æ§\n\n 1. State åå§åçæ¶åä¸º 0ï¼è¡¨ç¤ºæ²¡æä»»ä½çº¿ç¨ææéã\n 2. å½æçº¿ç¨ææè¯¥éæ¶ï¼å¼å°±ä¼å¨åæ¥çåºç¡ä¸+1ï¼åä¸ä¸ªçº¿ç¨å¤æ¬¡è·å¾éæ¯ï¼å°±ä¼å¤æ¬¡+1ï¼è¿éå°±æ¯å¯éå¥çæ¦å¿µã\n 3. è§£éä¹æ¯å¯¹è¿ä¸ªå­æ®µ-1ï¼ä¸ç´å° 0ï¼æ­¤çº¿ç¨å¯¹ééæ¾ã\n\nåæ­¥å·¥å·\n\nåæ­¥å·¥å·                     åæ­¥å·¥å·ä¸ AQS çå³è\nReentrantLock            ä½¿ç¨ AQS ä¿å­ééå¤ææçæ¬¡æ°ãå½ä¸ä¸ªçº¿ç¨è·åéæ¶ï¼ReentrantLock\n                         è®°å½å½åè·å¾éççº¿ç¨æ è¯ï¼ç¨äºæ£æµæ¯å¦éå¤è·åï¼ä»¥åéè¯¯çº¿ç¨è¯å¾è§£éæä½æ¶å¼å¸¸æåµçå¤çã\nSemaphore                ä½¿ç¨ AQS åæ­¥ç¶ææ¥ä¿å­ä¿¡å·éçå½åè®¡æ°ãtryRelease ä¼å¢å è®¡æ°ï¼acquireShared ä¼åå°è®¡æ°ã\nCountDownLatch           ä½¿ç¨ AQS åæ­¥ç¶ææ¥è¡¨ç¤ºè®¡æ°ãè®¡æ°ä¸º 0 æ¶ï¼ææç Acquire æä½ï¼CountDownLatch ç\n                         await æ¹æ³ï¼æå¯ä»¥éè¿ã\nReentrantReadWriteLock   ä½¿ç¨ AQS åæ­¥ç¶æä¸­ç 16 ä½ä¿å­åéææçæ¬¡æ°ï¼å©ä¸ç 16 ä½ç¨äºä¿å­è¯»éçæææ¬¡æ°ã\nThreadPoolExecutor       Worker å©ç¨ AQS åæ­¥ç¶æå®ç°å¯¹ç¬å çº¿ç¨åéçè®¾ç½®ï¼tryAcquire å tryReleaseï¼ã\n\n\n# Q & Aï¼ReentrantLockï¼\n\nQï¼æä¸ªçº¿ç¨è·åéå¤±è´¥çåç»­æµç¨æ¯ä»ä¹å¢ï¼\n\nAï¼å­å¨æç§æéç­åæºå¶ï¼çº¿ç¨ç»§ç»­ç­å¾ï¼ä»ç¶ä¿çè·åéçå¯è½ï¼è·åéæµç¨ä»å¨ç»§ç»­ã\n\nQï¼æ¢ç¶è¯´å°äºæéç­åæºå¶ï¼é£ä¹å°±ä¸å®ä¼ææç§éåå½¢æï¼è¿æ ·çéåæ¯ä»ä¹æ°æ®ç»æå¢ï¼\n\nAï¼æ¯ CLH åä½ç FIFO åç«¯éåã\n\nQï¼å¤äºæéç­åæºå¶ä¸­ççº¿ç¨ï¼ä»ä¹æ¶åå¯ä»¥ææºä¼è·åéå¢ï¼\n\nAï¼åç½®èç¹æ¯å¤´ç»ç¹ï¼ä¸å½åçº¿ç¨è·åéæå\n\nQï¼å¦æå¤äºæéç­åæºå¶ä¸­ççº¿ç¨ä¸ç´æ æ³è·åéï¼éè¦ä¸ç´ç­å¾ä¹ï¼è¿æ¯æå«çç­ç¥æ¥è§£å³è¿ä¸é®é¢ï¼\n\nAï¼çº¿ç¨æå¨èç¹çç¶æä¼åæåæ¶ç¶æï¼åæ¶ç¶æçèç¹ä¼ä»éåä¸­éæ¾ã\n\nQï¼Lock å½æ°éè¿ Acquire æ¹æ³è¿è¡å éï¼ä½æ¯å·ä½æ¯å¦ä½å éçå¢ï¼\n\nAï¼AQS ç Acquire ä¼è°ç¨ tryAcquire æ¹æ³ï¼tryAcquire ç±åä¸ªèªå®ä¹åæ­¥å¨å®ç°ï¼éè¿ tryAcquire å®æå éè¿ç¨ã\n\n\n# åèèµæ\n\n * ãåºæ¬åãä¸å¯ä¸è¯´çJavaâéâäº\n * ä»ReentrantLockçå®ç°çAQSçåçååºç¨\n * synchronized å®ç°åç | å°ç±³ä¿¡æ¯é¨ææ¯å¢é\n * AQS è¯¦è§£",normalizedContent:"# reentrantlock æ¯ä»ä¹ï¼æä¾ä»ä¹åè½ï¼\n\nreentrantlock ä¸ºå¯éå¥éï¼æä¸ä¸ªçº¿ç¨å¯ä»¥å¯¹ä¸´çèµæºéå¤å éã\n\n * æ¯æå¬å¹³éåéå¬å¹³éã\n\n * æ¯æè®¾ç½®å¤ä¸ªæ¡ä»¶ã\n\n * æ¯æååºä¸­æ­ã\n\nå¬å¹³éåéå¬å¹³éï¼\n\nå¬å¹³éæ¯æå¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼çº¿ç¨ç´æ¥è¿å¥éåä¸­æéï¼éåä¸­çç¬¬ä¸ä¸ªçº¿ç¨æè½è·å¾éãå¬å¹³éçä¼ç¹æ¯ç­å¾éççº¿ç¨ä¸ä¼é¥¿æ­»ãç¼ºç¹æ¯æ´ä½ååæçç¸å¯¹éå¬å¹³éè¦ä½ï¼ç­å¾éåä¸­é¤ç¬¬ä¸ä¸ªçº¿ç¨ä»¥å¤çææçº¿ç¨é½ä¼é»å¡ï¼cpuå¤éé»å¡çº¿ç¨çå¼éæ¯éå¬å¹³éå¤§ã\n\néå¬å¹³éæ¯å¤ä¸ªçº¿ç¨å éæ¶ç´æ¥å°è¯è·åéï¼è·åä¸å°æä¼å°ç­å¾éåçéå°¾ç­å¾ãä½å¦ææ­¤æ¶éåå¥½å¯ç¨ï¼é£ä¹è¿ä¸ªçº¿ç¨å¯ä»¥æ éé»å¡ç´æ¥è·åå°éãéå¬å¹³éçä¼ç¹æ¯å¯ä»¥åå°å¤èµ·çº¿ç¨çå¼éï¼æ´ä½çååæçé«ï¼å ä¸ºçº¿ç¨æå çä¸é»å¡ç´æ¥è·å¾éï¼cpuä¸å¿å¤éææçº¿ç¨ãç¼ºç¹æ¯å¤äºç­å¾éåä¸­ççº¿ç¨å¯è½ä¼é¥¿æ­»ï¼æèç­å¾ä¹æä¼è·å¾éã\n\n\n# reentrantlock è· synchronized çå¯¹æ¯\n\n        reentrantlock     synchronized\néå®ç°æºå¶   ä¾èµ aqs            ä¾èµ jdk\nçµæ´»æ§     æ¯æååºä¸­æ­ãè¶æ¶ãå°è¯è·åé   ä¸çµæ´»\nééæ¾å½¢å¼   å¿é¡»æ¾ç¤ºè°ç¨ unlock()   èªå¨éæ¾çè§å¨\néç±»å     å¬å¹³é & éå¬å¹³é        éå¬å¹³é\næ¡ä»¶éå    å¯å³èå¤ä¸ªæ¡ä»¶           åªè½å³èä¸ä¸ªæ¡ä»¶\nå¯éå¥æ§    å¯éå¥               å¯éå¥\n\né½æ¯å¯éå¥éãå¯éå¥çæææ¯åä¸ä¸ªçº¿ç¨å¨å¤å±æ¹æ³è·åéçæ¶åï¼è¯¥çº¿ç¨çåå±æ¹æ³ä¼èªå¨è·åè¯¥éï¼åææ¯éçå¯¹è±¡æ¯åä¸ä¸ªå¯¹è±¡æclassï¼ï¼ä¸ä¼å ä¸ºä¹åè·åè¿è¿æ²¡éæ¾èé»å¡ãå¨ä¸å®ç¨åº¦ä¸å¯ä»¥é¿åæ­»éã\n\n\n# reentrantlock çä½¿ç¨\n\nreentrantlock lock = new reentrantlock();\nlock.lock();\ntry {\n    if(lock.trylock(100, timeunit.milliseconds)){ }\n} finally {\n    lock.unlock()\n}\n\n\n\n# reentrantlock æ¯å¦ä½å®ç°çï¼\n\n\n# æ´ä½å®ç°æµç¨\n\nç»§æ¿ aqsï¼å·ä½è·åéçæ¹æ³ç±åé¨ç±»å¬å¹³éï¼fairsyncï¼åéå¬å¹³éï¼nonfairsyncï¼éå tryacquire() æ¹æ³å®ç°ï¼è¯¥æ¹æ³éè¿ cas å»è®¾ç½® stateï¼å¦æè¯¥æ¹æ³è¿åäº trueï¼è¡¨ç¤ºå½åçº¿ç¨è·åéæåï¼æ§è¡ç»æï¼å¦æè¯¥æ¹æ³è¿å falseï¼è¡¨ç¤ºè·åå¤±è´¥ï¼åéè¦å å¥ç­å¾éåä¸­ï¼éè¿æ§è¡ addwaiter(node.exclusive)ã\n\nå¨ reentrantlock éé¢çå¬å¹³éåéå¬å¹³éçç¶ç±» sync å®ä¹äºå¯éå¥éçéæ¾éæºå¶ï¼éåäº tryrelease() æ¹æ³ã\n\n\n# éå¥éåå¶ä»ééå¥éçå®ç°\n\néè¿ç¶ç±» aqs ä¸­ç»´æ¤çåæ­¥ç¶æ state æ¥è®¡ç®éå¥æ¬¡æ°ï¼state åå§åä¸º0ã\n\nå½çº¿ç¨å°è¯è·åéæ¶ï¼å¯éå¥éåå°è¯è·åå¹¶æ´æ° state å¼ï¼å¦æ state == 0 è¡¨ç¤ºæ²¡æå¶ä»çº¿ç¨å ç¨ï¼å° state ç½®ä½1ï¼å½åçº¿ç¨å¼å§æ§è¡ï¼å¦æ state != 0ï¼åå¤æ­å½åçº¿ç¨æ¯å¦æ¯è·åå°è¿ä¸ªéççº¿ç¨ï¼å¦ææ¯çè¯ï¼state + 1ï¼ä¸å½åçº¿ç¨å¯ä»¥åæ¬¡è·åéã\n\nééå¥éåæ¯ç´æ¥å»è·åå¹¶å°è¯æ´æ°å½å state çå¼ï¼å¦æ state != 0ï¼åè·åéå¤±è´¥ï¼å½åçº¿ç¨é»å¡ã\n\n\n# å¬å¹³éåéå¬å¹³éçå®ç°\n\nreentrantlock çå¬å¹³éåéå¬å¹³éé½æ¯ç¬äº«éãå½ä¸ä¸ªçº¿ç¨è°ç¨ lock æ¹æ³è·åéæ¶ï¼å¦æåæ­¥èµæºæ²¡æè¢«å¶ä»çº¿ç¨éä½ï¼é£ä¹å½åçº¿ç¨ä½¿ç¨ cas æ´æ° state å¼æååä¼æ¢å è¯¥èµæºãå¦æåæ­¥èµæºè¢«å ç¨ä¸ä¸æ¯å½åçº¿ç¨å ç¨æ¶ï¼åå éå¤±è´¥ã\n\nreentrantlock ä¸­æä¸ä¸ªåé¨ç±» syncï¼sync ç»§æ¿äº aqsï¼abstractqueuedsynchronizerï¼ï¼å¬å¹³éï¼fairsyncï¼åéå¬å¹³éï¼nonfairsyncï¼ç»§æ¿äºsyncãreentrantlocké»è®¤ä½¿ç¨éå¬å¹³éï¼å¯éè¿æé å¨æå®ä½¿ç¨å¬å¹³éã\n\nå¬å¹³éä¸éå¬å¹³éç lock() æ¹æ³å¯ä¸çåºå«å°±å¨äºå¬å¹³éå¨è·ååæ­¥ç¶ææ¶å¤äºä¸ä¸ªéå¶æ¡ä»¶ï¼hasqueuedpredecessors()ãä¸»è¦æ¯ç¨äºå¤æ­å½åçº¿ç¨æ¯å¦ä½äºåæ­¥éåä¸­çç¬¬ä¸ä¸ªãå¦ææ¯åè¿åtrueï¼å¦åè¿åfalseã\n\nå¬å¹³éå°±æ¯éè¿åæ­¥éåæ¥å®ç°å¤ä¸ªçº¿ç¨æç§ç³è¯·éçé¡ºåºæ¥è·åéï¼ä»èå®ç°å¬å¹³çç¹æ§ãéå¬å¹³éå éæ¶ä¸èèæéç­å¾é®é¢ï¼ç´æ¥å°è¯è·åéï¼æä»¥å­å¨åç³è¯·å´åè·å¾éçæåµã\n\n\n# reentranlock ä¸ aqs\n\nå éé»è¾ï¼éè¿ cas è®¾ç½® stateï¼è®¾ç½®æåè¡¨ç¤ºè·åéæåãè·åéå¤±è´¥åè¿å¥ç­å¾éåå¤çã\n\nreentrantlock å éè§£éæ¶ api å±æ ¸å¿æ¹æ³çæ å°å³ç³»ï¼\n\n\n\n\n# aqs\n\naqs çæ ¸å¿ææ³æ¯ï¼å¦æå±äº«èµæºç©ºé²ï¼å°å½åè¯·æ±èµæºççº¿ç¨è®¾ç½®ä¸ºææçå·¥ä½çº¿ç¨ï¼åæ¶éè¿ cas å°å±äº«èµæºçç¶æï¼stateï¼è®¾ç½®ä¸ºéå®ç¶æãå¦æå±äº«èµæºè¢«å ç¨ï¼åéè¿é»å¡ç­å¾å¤éæºå¶æ¥ä¿è¯éçåéï¼è¿ééè¿ clh éåçåä½å®ç°ï¼å°ææ¶æ²¡è·åå°éççº¿ç¨å å¥éåã\n\n\n# åºå±æ°æ®ç»æ\n\n * nodeèç¹ç clhéåãåå§ç clh æ¯ååé¾è¡¨ï¼aqs çéåæ¯ clh çåä½ï¼æ¯èæååéåï¼aqs éè¿å°æ¯æ¡è¯·æ±å±äº«èµæºççº¿ç¨å°è£æä¸ä¸ªèç¹ï¼nodeï¼æ¥å®ç°éçåéã\n * stateãç¨ volatile int state è¡¨ç¤ºåæ­¥ç¶æï¼éè¿ cas å®æå¯¹ state å¼çä¿®æ¹ï¼éè¿éåå®æèµæºè·åçæéã\n\n\n\n\n# éè¿ä¿®æ¹ state åæ­¥ç¶æå®ç°å¤çº¿ç¨çç¬å æ¨¡å¼åå±äº«æ¨¡å¼\n\n\n\n\n# èªå®ä¹åæ­¥å¨\n\n * ç¬å æ¨¡å¼ï¼å®ç° tryacquire-tryreleaseãå¦ reentrantlock\n * å±äº«æ¨¡å¼ï¼å®ç° ryacquireshared-tryreleaseshared\n * åæ¶å®ç°ç¬å åå±äº«ä¸¤ç§æ¨¡å¼ãå¦ reentrantreadwritelock\n\npublic class leelock  {\n\n    private static class sync extends abstractqueuedsynchronizer {\n        @override\n        protected boolean tryacquire (int arg) {\n            return compareandsetstate(0, 1);\n        }\n\n        @override\n        protected boolean tryrelease (int arg) {\n            setstate(0);\n            return true;\n        }\n\n        @override\n        protected boolean isheldexclusively () {\n            return getstate() == 1;\n        }\n    }\n\n    private sync sync = new sync();\n\n    public void lock () {\n        sync.acquire(1);\n    }\n\n    public void unlock () {\n        sync.release(1);\n    }\n}\n\n\npublic class leemain {\n\n    static int count = 0;\n    static leelock leelock = new leelock();\n\n    public static void main (string[] args) throws interruptedexception {\n\n        runnable runnable = new runnable() {\n            @override\n            public void run () {\n                try {\n                    leelock.lock();\n                    for (int i = 0; i < 10000; i++) {\n                        count++;\n                    }\n                } catch (exception e) {\n                    e.printstacktrace();\n                } finally {\n                    leelock.unlock();\n                }\n\n            }\n        };\n        thread thread1 = new thread(runnable);\n        thread thread2 = new thread(runnable);\n        thread1.start();\n        thread2.start();\n        thread1.join();\n        thread2.join();\n        system.out.println(count);\n    }\n}\n\n\nä¸è¿°ä»£ç æ¯æ¬¡è¿è¡ç»æé½ä¼æ¯ 20000ãéè¿ç®åçå è¡ä»£ç å®ç°åæ­¥åè½ã\n\n\n# aqs åºç¨\n\nå®ç° reentrantlock å¯éå¥æ§\n\n 1. state åå§åçæ¶åä¸º 0ï¼è¡¨ç¤ºæ²¡æä»»ä½çº¿ç¨ææéã\n 2. å½æçº¿ç¨ææè¯¥éæ¶ï¼å¼å°±ä¼å¨åæ¥çåºç¡ä¸+1ï¼åä¸ä¸ªçº¿ç¨å¤æ¬¡è·å¾éæ¯ï¼å°±ä¼å¤æ¬¡+1ï¼è¿éå°±æ¯å¯éå¥çæ¦å¿µã\n 3. è§£éä¹æ¯å¯¹è¿ä¸ªå­æ®µ-1ï¼ä¸ç´å° 0ï¼æ­¤çº¿ç¨å¯¹ééæ¾ã\n\nåæ­¥å·¥å·\n\nåæ­¥å·¥å·                     åæ­¥å·¥å·ä¸ aqs çå³è\nreentrantlock            ä½¿ç¨ aqs ä¿å­ééå¤ææçæ¬¡æ°ãå½ä¸ä¸ªçº¿ç¨è·åéæ¶ï¼reentrantlock\n                         è®°å½å½åè·å¾éççº¿ç¨æ è¯ï¼ç¨äºæ£æµæ¯å¦éå¤è·åï¼ä»¥åéè¯¯çº¿ç¨è¯å¾è§£éæä½æ¶å¼å¸¸æåµçå¤çã\nsemaphore                ä½¿ç¨ aqs åæ­¥ç¶ææ¥ä¿å­ä¿¡å·éçå½åè®¡æ°ãtryrelease ä¼å¢å è®¡æ°ï¼acquireshared ä¼åå°è®¡æ°ã\ncountdownlatch           ä½¿ç¨ aqs åæ­¥ç¶ææ¥è¡¨ç¤ºè®¡æ°ãè®¡æ°ä¸º 0 æ¶ï¼ææç acquire æä½ï¼countdownlatch ç\n                         await æ¹æ³ï¼æå¯ä»¥éè¿ã\nreentrantreadwritelock   ä½¿ç¨ aqs åæ­¥ç¶æä¸­ç 16 ä½ä¿å­åéææçæ¬¡æ°ï¼å©ä¸ç 16 ä½ç¨äºä¿å­è¯»éçæææ¬¡æ°ã\nthreadpoolexecutor       worker å©ç¨ aqs åæ­¥ç¶æå®ç°å¯¹ç¬å çº¿ç¨åéçè®¾ç½®ï¼tryacquire å tryreleaseï¼ã\n\n\n# q & aï¼reentrantlockï¼\n\nqï¼æä¸ªçº¿ç¨è·åéå¤±è´¥çåç»­æµç¨æ¯ä»ä¹å¢ï¼\n\naï¼å­å¨æç§æéç­åæºå¶ï¼çº¿ç¨ç»§ç»­ç­å¾ï¼ä»ç¶ä¿çè·åéçå¯è½ï¼è·åéæµç¨ä»å¨ç»§ç»­ã\n\nqï¼æ¢ç¶è¯´å°äºæéç­åæºå¶ï¼é£ä¹å°±ä¸å®ä¼ææç§éåå½¢æï¼è¿æ ·çéåæ¯ä»ä¹æ°æ®ç»æå¢ï¼\n\naï¼æ¯ clh åä½ç fifo åç«¯éåã\n\nqï¼å¤äºæéç­åæºå¶ä¸­ççº¿ç¨ï¼ä»ä¹æ¶åå¯ä»¥ææºä¼è·åéå¢ï¼\n\naï¼åç½®èç¹æ¯å¤´ç»ç¹ï¼ä¸å½åçº¿ç¨è·åéæå\n\nqï¼å¦æå¤äºæéç­åæºå¶ä¸­ççº¿ç¨ä¸ç´æ æ³è·åéï¼éè¦ä¸ç´ç­å¾ä¹ï¼è¿æ¯æå«çç­ç¥æ¥è§£å³è¿ä¸é®é¢ï¼\n\naï¼çº¿ç¨æå¨èç¹çç¶æä¼åæåæ¶ç¶æï¼åæ¶ç¶æçèç¹ä¼ä»éåä¸­éæ¾ã\n\nqï¼lock å½æ°éè¿ acquire æ¹æ³è¿è¡å éï¼ä½æ¯å·ä½æ¯å¦ä½å éçå¢ï¼\n\naï¼aqs ç acquire ä¼è°ç¨ tryacquire æ¹æ³ï¼tryacquire ç±åä¸ªèªå®ä¹åæ­¥å¨å®ç°ï¼éè¿ tryacquire å®æå éè¿ç¨ã\n\n\n# åèèµæ\n\n * ãåºæ¬åãä¸å¯ä¸è¯´çjavaâéâäº\n * ä»reentrantlockçå®ç°çaqsçåçååºç¨\n * synchronized å®ç°åç | å°ç±³ä¿¡æ¯é¨ææ¯å¢é\n * aqs è¯¦è§£",charsets:{cjk:!0}},{title:"MySQL",frontmatter:{title:"MySQL",date:"2023-03-23T15:44:50.000Z",permalink:"/pages/mysql/"},regularPath:"/02.MySQL/00.MySQL.html",relativePath:"02.MySQL/00.MySQL.md",key:"v-6a709319",path:"/pages/mysql/",headers:[{level:2,title:"é",slug:"é",normalizedTitle:"é",charIndex:2}],headersStr:"é",content:"# é",normalizedContent:"# é",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"MySQLå­å¨å¼æ",frontmatter:{title:"MySQLå­å¨å¼æ",date:"2023-03-23T21:42:51.000Z",permalink:"/pages/26cff4/"},regularPath:"/02.MySQL/01.MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E.html",relativePath:"02.MySQL/01.MySQLå­å¨å¼æ.md",key:"v-135d0248",path:"/pages/26cff4/",headers:[{level:2,title:"InnoDB",slug:"innodb",normalizedTitle:"innodb",charIndex:2},{level:2,title:"MyISAM",slug:"myisam",normalizedTitle:"myisam",charIndex:1136},{level:2,title:"å¶ä»å­å¨å¼æ",slug:"å¶ä»å­å¨å¼æ",normalizedTitle:"å¶ä»å­å¨å¼æ",charIndex:1816}],headersStr:"InnoDB MyISAM å¶ä»å­å¨å¼æ",content:"# InnoDB\n\næ¯ MySQL é»è®¤çäºå¡åå­å¨å¼æï¼åªæå¨éè¦å®ä¸æ¯æçç¹æ§æ¶ï¼æèèä½¿ç¨å¶å®å­å¨å¼æã\n\nå®ç°äºåä¸ªæ åçéç¦»çº§å«ï¼é»è®¤çº§å«æ¯å¯éå¤è¯»(REPEATABLE READ)ãå¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼éè¿å¤çæ¬å¹¶åæ§å¶(MVCC)+ é´éé(Next-Key Locking)é²æ­¢å¹»è¯»é®é¢ã\n\nä¸»ç´¢å¼æ¯èç°ç´¢å¼ï¼å¨ç´¢å¼ä¸­ä¿å­äºæ°æ®ï¼ä»èé¿åç´æ¥è¯»åç£çï¼å æ­¤å¯¹æ¥è¯¢æ§è½æå¾å¤§çæåãå¯¹è¡¨ä¸­çæ°æ®ï¼InnoDB éç¨èéï¼clusteredï¼çæ¹å¼ï¼å æ­¤æ¯å¼ è¡¨çå­å¨é½æ¯æä¸»é®é¡ºåºè¿è¡å­æ¾çãå¦ææ²¡ææ¾å¼çå¨è¡¨å®ä¹æ¶æå®ä¸»é®ï¼InnoDB ä¼ä¸ºæ¯ä¸è¡çæä¸ä¸ª6å­èç ROWIDï¼ä½ä¸ºä¸»é®ãè¿ç§å­å¨æ¹å¼çè¡¨ç§°ä¸ºç´¢å¼ç»ç»è¡¨ï¼index organized tableï¼ã\n\nåé¨åäºå¾å¤ä¼åï¼åæ¬ä»ç£çè¯»åæ°æ®æ¶éç¨çå¯é¢æµæ§è¯»ãè½å¤å å¿«è¯»æä½å¹¶ä¸èªå¨åå»ºçèªéåºåå¸ç´¢å¼ãè½å¤å éæå¥æä½çæå¥ç¼å²åºç­ã\n\næ¯æçæ­£çå¨çº¿ç­å¤ä»½ãå¶å®å­å¨å¼æä¸æ¯æå¨çº¿ç­å¤ä»½ï¼è¦è·åä¸è´æ§è§å¾éè¦åæ­¢å¯¹ææè¡¨çåå¥ï¼èå¨è¯»åæ··ååºæ¯ä¸­ï¼åæ­¢åå¥å¯è½ä¹æå³çåæ­¢è¯»åã\n\næä¾äºæå¥ç¼å²ï¼insert bufferï¼ãäºæ¬¡åï¼double writeï¼ãèªéåºåå¸ç´¢å¼ï¼adaptive hash indexï¼ãé¢è¯»ï¼read aheadï¼ç­åè½ã\n\nInnoDBç¹ç¹ï¼\n\n 1. æ¯æACIDäºå¡ï¼InnoDBå­å¨å¼ææ¯æåå­æ§ãä¸è´æ§ãéç¦»æ§åæä¹æ§ï¼å¯ä»¥éè¿äºå¡æ¥ä¿è¯æ°æ®çä¸è´æ§åå®æ´æ§ã\n 2. æ¯æè¡çº§éï¼InnoDBæ¯æè¡çº§éï¼å¯ä»¥æé«å¤ç¨æ·å¹¶åè®¿é®æ¶çæ§è½ã\n 3. æ¯æå¤é®çº¦æï¼InnoDBæ¯æå¤é®çº¦æï¼å¯ä»¥ä¿è¯æ°æ®çå®æ´æ§ã\n 4. æ¯æMVCCï¼InnoDBå­å¨å¼ææ¯æå¤çæ¬å¹¶åæ§å¶ï¼MVCCï¼ï¼å¯ä»¥æé«å¹¶åè®¿é®æ¶çæ§è½ãMVCCéè¿å¨æ¯è¡è®°å½ä¸­æ·»å å¤ä¸ªçæ¬æ¥å®ç°äºå¡çéç¦»æ§ã\n 5. æ¯æç­å¤ä»½ï¼InnoDBæ¯æç­å¤ä»½ï¼å¯ä»¥å¨çº¿å¤ä»½æ°æ®ï¼é¿åäºæ°æ®åæºæ¶é´ã\n 6. æ¯æèªéåºåå¸ç´¢å¼ï¼InnoDBæ¯æèªéåºåå¸ç´¢å¼ï¼å¨ç¹å®çæ¡ä»¶ä¸å¯ä»¥æé«æ¥è¯¢çæ§è½ã\n 7. æ¯æå¤§å®¹éå­å¨ï¼InnoDBå­å¨å¼ææ¯æå¤§å®¹éå­å¨ï¼å¯ä»¥å­å¨TBçº§å«çæ°æ®ã\n\nInnoDB æ¯æä»¥ä¸å ç§å¸¸è§çç´¢å¼ï¼\n\n * B+ æ ç´¢å¼ï¼æ¯ä¸ç§åºäºæ å½¢ç»æçç´¢å¼ç±»åï¼å®æç§é¡ºåºå­å¨æ°æ®å¹¶ä¸æ¯æå¿«éçæ¥æ¾åèå´æ¥æ¾æä½ã\n * å¨æç´¢å¼ï¼ï¼å¨æç´¢å¼å¯ä»¥ç¨äºå¨ææ¬æ°æ®ä¸­è¿è¡å¨ææç´¢ãInnoDBæ¯æå¨æç´¢å¼ï¼ä½æ¯éè¦ä½¿ç¨ç¹å®çè¯­æ³æ¥åå»ºåæ¥è¯¢å¨æç´¢å¼ã\n * åå¸ç´¢å¼ï¼åå¸ç´¢å¼å¯ä»¥ç¨äºå¿«éæ¥æ¾æ°æ®ï¼ä½æ¯åªæ¯æç­å¼æ¥æ¾ã\n\nInnoDBæ¯æå¨ä¸ä¸ªè¡¨ä¸åæ¶åå»ºå¤ä¸ªç´¢å¼ã\n\n\n# MyISAM\n\nè®¾è®¡ç®åï¼æ°æ®ä»¥ç´§å¯æ ¼å¼å­å¨ãå¯¹äºåªè¯»æ°æ®ï¼æèè¡¨æ¯è¾å°ãå¯ä»¥å®¹å¿ä¿®å¤æä½ï¼åä¾ç¶å¯ä»¥ä½¿ç¨å®ã\n\nç¹æ§ï¼åæ¬åç¼©è¡¨ãç©ºé´æ°æ®ç´¢å¼ï¼R-Treeï¼ç­ã\n\nä¼ç¹ï¼\n\n 1. é«éè¯»åï¼MyISAMè¡¨å¨è¯»åå¤§éæ°æ®æ¶éåº¦éå¸¸å¿«ï¼å°¤å¶æ¯å½è¡¨ä¸­æå¾å¤éææ°æ®çæ¶åã\n 2. ç´¢å¼æç´¢æçé«ï¼MyISAMè¡¨çç´¢å¼æç´¢æçéå¸¸é«ï¼å°¤å¶æ¯å¨å¤çå¤§æ°æ®éçæåµä¸ã\n 3. ç¬ç«çè¡¨ç»æï¼MyISAMè¡¨çè¡¨ç»æåæ°æ®æä»¶æ¯åå¼çï¼è¿æ ·å°±ä½¿å¾å¤ä»½åæ¢å¤æ°æ®åå¾æ´å å®¹æã\n 4. æ¯æå¨ææ¬æç´¢ï¼MyISAMè¡¨æ¯æå¨ææ¬æç´¢ï¼è¿ä½¿å¾å¯¹ææ¬æ°æ®è¿è¡é«æçæç´¢ååæåå¾æ´å å®¹æã\n 5. æäºç»´æ¤ï¼MyISAMè¡¨çç»´æ¤éå¸¸ç®åï¼å¯¹äºé¢ç¹è¿è¡è¯»åæä½çè¡¨æ¥è¯´ï¼å¯ä»¥ä½¿ç¨OPTIMIZE TABLEè¯­å¥å¯¹è¡¨è¿è¡ä¼åï¼ä»¥æé«è¡¨çæ§è½ã\n\nä¸æ¯æäºå¡ã\n\nä¸æ¯æè¡çº§éï¼åªè½å¯¹æ´å¼ è¡¨å éï¼è¯»åæ¶ä¼å¯¹éè¦è¯»å°çææè¡¨å å±äº«éï¼åå¥æ¶åå¯¹è¡¨å æå®éãä½å¨è¡¨æè¯»åæä½çåæ¶ï¼ä¹å¯ä»¥å¾è¡¨ä¸­æå¥æ°çè®°å½ï¼è¿è¢«ç§°ä¸ºå¹¶åæå¥(CONCURRENT INSERT)ã\n\nå¯ä»¥æå·¥æèèªå¨æ§è¡æ£æ¥åä¿®å¤æä½ï¼ä½æ¯åäºå¡æ¢å¤ä»¥åå´©æºæ¢å¤ä¸åï¼å¯è½å¯¼è´ä¸äºæ°æ®ä¸¢å¤±ï¼èä¸ä¿®å¤æä½æ¯éå¸¸æ¢çã\n\nå¦ææå®äº DELAY_KEY_WRITE éé¡¹ï¼å¨æ¯æ¬¡ä¿®æ¹æ§è¡å®ææ¶ï¼ä¸ä¼ç«å³å°ä¿®æ¹çç´¢å¼æ°æ®åå¥ç£çï¼èæ¯ä¼åå°åå­ä¸­çé®ç¼å²åºï¼åªæå¨æ¸çé®ç¼å²åºæèå³é­è¡¨çæ¶åæä¼å°å¯¹åºçç´¢å¼ååå¥ç£çãè¿ç§æ¹å¼å¯ä»¥æå¤§çæååå¥æ§è½ï¼ä½æ¯å¨æ°æ®åºæèä¸»æºå´©æºæ¶ä¼é æç´¢å¼æåï¼éè¦æ§è¡ä¿®å¤æä½ã\n\n\n# å¶ä»å­å¨å¼æ\n\n 1. MyISAMï¼MyISAMæ¯MySQLçå¦ä¸ç§å¸¸ç¨å­å¨å¼æï¼å®æ¯InnoDBæ´ç®åãæ´å¿«éï¼éç¨äºè¯»å¯éçåºç¨åºæ¯ãä½æ¯ï¼å®ä¸æ¯æäºå¡ãè¡çº§éãå¤é®çº¦æç­åè½ï¼ä¹ä¸æ¯æç­å¤ä»½åå´©æºæ¢å¤ã\n 2. Memoryï¼Memoryå­å¨å¼ææ¯MySQLä¸­æå¿«çå­å¨å¼æä¹ä¸ï¼éç¨äºå¯¹éåº¦è¦æ±å¾é«çåºæ¯ï¼æ¯å¦ç¼å­æ°æ®åä¸´æ¶è¡¨ç­ãMemoryå­å¨å¼æå°æ°æ®å­å¨å¨åå­ä¸­ï¼å æ­¤ä¸æ¯æå¤§å®¹éæ°æ®å­å¨ãæ­¤å¤ï¼å®ä¸æ¯ææä¹æ§åå´©æºæ¢å¤ç­åè½ï¼ä¹ä¸æ¯æTEXTåBLOBç±»åã\n 3. Archiveï¼Archiveå­å¨å¼æéç¨äºæ°æ®å½æ¡£åå¤ä»½åºæ¯ï¼å¯ä»¥å¨éè¦æ¶å¿«éå­å¨åæ£ç´¢å¤§éåå²æ°æ®ãå®éç¨åç¼©ç®æ³å­å¨æ°æ®ï¼å æ­¤å ç¨ç©ºé´è¾å°ãä½æ¯ï¼Archiveå­å¨å¼æä¸æ¯æç´¢å¼ãäºå¡ãè¡çº§éç­åè½ï¼ä¹ä¸æ¯ææ°æ®ä¿®æ¹æä½ã\n 4. CSVï¼CSVå­å¨å¼æå°æ°æ®ä»¥éå·åéçæ ¼å¼å­å¨å¨ææ¬æä»¶ä¸­ï¼éç¨äºæ°æ®å¯¼å¥ãå¯¼åºåäº¤æ¢ç­åºæ¯ãå®ä¸æ¯æç´¢å¼ãäºå¡ãè¡çº§éç­åè½ï¼ä¹ä¸æ¯æBLOBåTEXTç±»åã",normalizedContent:"# innodb\n\næ¯ mysql é»è®¤çäºå¡åå­å¨å¼æï¼åªæå¨éè¦å®ä¸æ¯æçç¹æ§æ¶ï¼æèèä½¿ç¨å¶å®å­å¨å¼æã\n\nå®ç°äºåä¸ªæ åçéç¦»çº§å«ï¼é»è®¤çº§å«æ¯å¯éå¤è¯»(repeatable read)ãå¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼éè¿å¤çæ¬å¹¶åæ§å¶(mvcc)+ é´éé(next-key locking)é²æ­¢å¹»è¯»é®é¢ã\n\nä¸»ç´¢å¼æ¯èç°ç´¢å¼ï¼å¨ç´¢å¼ä¸­ä¿å­äºæ°æ®ï¼ä»èé¿åç´æ¥è¯»åç£çï¼å æ­¤å¯¹æ¥è¯¢æ§è½æå¾å¤§çæåãå¯¹è¡¨ä¸­çæ°æ®ï¼innodb éç¨èéï¼clusteredï¼çæ¹å¼ï¼å æ­¤æ¯å¼ è¡¨çå­å¨é½æ¯æä¸»é®é¡ºåºè¿è¡å­æ¾çãå¦ææ²¡ææ¾å¼çå¨è¡¨å®ä¹æ¶æå®ä¸»é®ï¼innodb ä¼ä¸ºæ¯ä¸è¡çæä¸ä¸ª6å­èç rowidï¼ä½ä¸ºä¸»é®ãè¿ç§å­å¨æ¹å¼çè¡¨ç§°ä¸ºç´¢å¼ç»ç»è¡¨ï¼index organized tableï¼ã\n\nåé¨åäºå¾å¤ä¼åï¼åæ¬ä»ç£çè¯»åæ°æ®æ¶éç¨çå¯é¢æµæ§è¯»ãè½å¤å å¿«è¯»æä½å¹¶ä¸èªå¨åå»ºçèªéåºåå¸ç´¢å¼ãè½å¤å éæå¥æä½çæå¥ç¼å²åºç­ã\n\næ¯æçæ­£çå¨çº¿ç­å¤ä»½ãå¶å®å­å¨å¼æä¸æ¯æå¨çº¿ç­å¤ä»½ï¼è¦è·åä¸è´æ§è§å¾éè¦åæ­¢å¯¹ææè¡¨çåå¥ï¼èå¨è¯»åæ··ååºæ¯ä¸­ï¼åæ­¢åå¥å¯è½ä¹æå³çåæ­¢è¯»åã\n\næä¾äºæå¥ç¼å²ï¼insert bufferï¼ãäºæ¬¡åï¼double writeï¼ãèªéåºåå¸ç´¢å¼ï¼adaptive hash indexï¼ãé¢è¯»ï¼read aheadï¼ç­åè½ã\n\ninnodbç¹ç¹ï¼\n\n 1. æ¯æacidäºå¡ï¼innodbå­å¨å¼ææ¯æåå­æ§ãä¸è´æ§ãéç¦»æ§åæä¹æ§ï¼å¯ä»¥éè¿äºå¡æ¥ä¿è¯æ°æ®çä¸è´æ§åå®æ´æ§ã\n 2. æ¯æè¡çº§éï¼innodbæ¯æè¡çº§éï¼å¯ä»¥æé«å¤ç¨æ·å¹¶åè®¿é®æ¶çæ§è½ã\n 3. æ¯æå¤é®çº¦æï¼innodbæ¯æå¤é®çº¦æï¼å¯ä»¥ä¿è¯æ°æ®çå®æ´æ§ã\n 4. æ¯æmvccï¼innodbå­å¨å¼ææ¯æå¤çæ¬å¹¶åæ§å¶ï¼mvccï¼ï¼å¯ä»¥æé«å¹¶åè®¿é®æ¶çæ§è½ãmvccéè¿å¨æ¯è¡è®°å½ä¸­æ·»å å¤ä¸ªçæ¬æ¥å®ç°äºå¡çéç¦»æ§ã\n 5. æ¯æç­å¤ä»½ï¼innodbæ¯æç­å¤ä»½ï¼å¯ä»¥å¨çº¿å¤ä»½æ°æ®ï¼é¿åäºæ°æ®åæºæ¶é´ã\n 6. æ¯æèªéåºåå¸ç´¢å¼ï¼innodbæ¯æèªéåºåå¸ç´¢å¼ï¼å¨ç¹å®çæ¡ä»¶ä¸å¯ä»¥æé«æ¥è¯¢çæ§è½ã\n 7. æ¯æå¤§å®¹éå­å¨ï¼innodbå­å¨å¼ææ¯æå¤§å®¹éå­å¨ï¼å¯ä»¥å­å¨tbçº§å«çæ°æ®ã\n\ninnodb æ¯æä»¥ä¸å ç§å¸¸è§çç´¢å¼ï¼\n\n * b+ æ ç´¢å¼ï¼æ¯ä¸ç§åºäºæ å½¢ç»æçç´¢å¼ç±»åï¼å®æç§é¡ºåºå­å¨æ°æ®å¹¶ä¸æ¯æå¿«éçæ¥æ¾åèå´æ¥æ¾æä½ã\n * å¨æç´¢å¼ï¼ï¼å¨æç´¢å¼å¯ä»¥ç¨äºå¨ææ¬æ°æ®ä¸­è¿è¡å¨ææç´¢ãinnodbæ¯æå¨æç´¢å¼ï¼ä½æ¯éè¦ä½¿ç¨ç¹å®çè¯­æ³æ¥åå»ºåæ¥è¯¢å¨æç´¢å¼ã\n * åå¸ç´¢å¼ï¼åå¸ç´¢å¼å¯ä»¥ç¨äºå¿«éæ¥æ¾æ°æ®ï¼ä½æ¯åªæ¯æç­å¼æ¥æ¾ã\n\ninnodbæ¯æå¨ä¸ä¸ªè¡¨ä¸åæ¶åå»ºå¤ä¸ªç´¢å¼ã\n\n\n# myisam\n\nè®¾è®¡ç®åï¼æ°æ®ä»¥ç´§å¯æ ¼å¼å­å¨ãå¯¹äºåªè¯»æ°æ®ï¼æèè¡¨æ¯è¾å°ãå¯ä»¥å®¹å¿ä¿®å¤æä½ï¼åä¾ç¶å¯ä»¥ä½¿ç¨å®ã\n\nç¹æ§ï¼åæ¬åç¼©è¡¨ãç©ºé´æ°æ®ç´¢å¼ï¼r-treeï¼ç­ã\n\nä¼ç¹ï¼\n\n 1. é«éè¯»åï¼myisamè¡¨å¨è¯»åå¤§éæ°æ®æ¶éåº¦éå¸¸å¿«ï¼å°¤å¶æ¯å½è¡¨ä¸­æå¾å¤éææ°æ®çæ¶åã\n 2. ç´¢å¼æç´¢æçé«ï¼myisamè¡¨çç´¢å¼æç´¢æçéå¸¸é«ï¼å°¤å¶æ¯å¨å¤çå¤§æ°æ®éçæåµä¸ã\n 3. ç¬ç«çè¡¨ç»æï¼myisamè¡¨çè¡¨ç»æåæ°æ®æä»¶æ¯åå¼çï¼è¿æ ·å°±ä½¿å¾å¤ä»½åæ¢å¤æ°æ®åå¾æ´å å®¹æã\n 4. æ¯æå¨ææ¬æç´¢ï¼myisamè¡¨æ¯æå¨ææ¬æç´¢ï¼è¿ä½¿å¾å¯¹ææ¬æ°æ®è¿è¡é«æçæç´¢ååæåå¾æ´å å®¹æã\n 5. æäºç»´æ¤ï¼myisamè¡¨çç»´æ¤éå¸¸ç®åï¼å¯¹äºé¢ç¹è¿è¡è¯»åæä½çè¡¨æ¥è¯´ï¼å¯ä»¥ä½¿ç¨optimize tableè¯­å¥å¯¹è¡¨è¿è¡ä¼åï¼ä»¥æé«è¡¨çæ§è½ã\n\nä¸æ¯æäºå¡ã\n\nä¸æ¯æè¡çº§éï¼åªè½å¯¹æ´å¼ è¡¨å éï¼è¯»åæ¶ä¼å¯¹éè¦è¯»å°çææè¡¨å å±äº«éï¼åå¥æ¶åå¯¹è¡¨å æå®éãä½å¨è¡¨æè¯»åæä½çåæ¶ï¼ä¹å¯ä»¥å¾è¡¨ä¸­æå¥æ°çè®°å½ï¼è¿è¢«ç§°ä¸ºå¹¶åæå¥(concurrent insert)ã\n\nå¯ä»¥æå·¥æèèªå¨æ§è¡æ£æ¥åä¿®å¤æä½ï¼ä½æ¯åäºå¡æ¢å¤ä»¥åå´©æºæ¢å¤ä¸åï¼å¯è½å¯¼è´ä¸äºæ°æ®ä¸¢å¤±ï¼èä¸ä¿®å¤æä½æ¯éå¸¸æ¢çã\n\nå¦ææå®äº delay_key_write éé¡¹ï¼å¨æ¯æ¬¡ä¿®æ¹æ§è¡å®ææ¶ï¼ä¸ä¼ç«å³å°ä¿®æ¹çç´¢å¼æ°æ®åå¥ç£çï¼èæ¯ä¼åå°åå­ä¸­çé®ç¼å²åºï¼åªæå¨æ¸çé®ç¼å²åºæèå³é­è¡¨çæ¶åæä¼å°å¯¹åºçç´¢å¼ååå¥ç£çãè¿ç§æ¹å¼å¯ä»¥æå¤§çæååå¥æ§è½ï¼ä½æ¯å¨æ°æ®åºæèä¸»æºå´©æºæ¶ä¼é æç´¢å¼æåï¼éè¦æ§è¡ä¿®å¤æä½ã\n\n\n# å¶ä»å­å¨å¼æ\n\n 1. myisamï¼myisamæ¯mysqlçå¦ä¸ç§å¸¸ç¨å­å¨å¼æï¼å®æ¯innodbæ´ç®åãæ´å¿«éï¼éç¨äºè¯»å¯éçåºç¨åºæ¯ãä½æ¯ï¼å®ä¸æ¯æäºå¡ãè¡çº§éãå¤é®çº¦æç­åè½ï¼ä¹ä¸æ¯æç­å¤ä»½åå´©æºæ¢å¤ã\n 2. memoryï¼memoryå­å¨å¼ææ¯mysqlä¸­æå¿«çå­å¨å¼æä¹ä¸ï¼éç¨äºå¯¹éåº¦è¦æ±å¾é«çåºæ¯ï¼æ¯å¦ç¼å­æ°æ®åä¸´æ¶è¡¨ç­ãmemoryå­å¨å¼æå°æ°æ®å­å¨å¨åå­ä¸­ï¼å æ­¤ä¸æ¯æå¤§å®¹éæ°æ®å­å¨ãæ­¤å¤ï¼å®ä¸æ¯ææä¹æ§åå´©æºæ¢å¤ç­åè½ï¼ä¹ä¸æ¯ætextåblobç±»åã\n 3. archiveï¼archiveå­å¨å¼æéç¨äºæ°æ®å½æ¡£åå¤ä»½åºæ¯ï¼å¯ä»¥å¨éè¦æ¶å¿«éå­å¨åæ£ç´¢å¤§éåå²æ°æ®ãå®éç¨åç¼©ç®æ³å­å¨æ°æ®ï¼å æ­¤å ç¨ç©ºé´è¾å°ãä½æ¯ï¼archiveå­å¨å¼æä¸æ¯æç´¢å¼ãäºå¡ãè¡çº§éç­åè½ï¼ä¹ä¸æ¯ææ°æ®ä¿®æ¹æä½ã\n 4. csvï¼csvå­å¨å¼æå°æ°æ®ä»¥éå·åéçæ ¼å¼å­å¨å¨ææ¬æä»¶ä¸­ï¼éç¨äºæ°æ®å¯¼å¥ãå¯¼åºåäº¤æ¢ç­åºæ¯ãå®ä¸æ¯æç´¢å¼ãäºå¡ãè¡çº§éç­åè½ï¼ä¹ä¸æ¯æblobåtextç±»åã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"CyclicBarrier",frontmatter:{title:"CyclicBarrier",date:"2023-05-15T23:04:48.000Z",permalink:"/pages/fa1dea/"},regularPath:"/01.Java/04.Java%E5%B9%B6%E5%8F%91/11.%20CyclicBarrier.html",relativePath:"01.Java/04.Javaå¹¶å/11. CyclicBarrier.md",key:"v-c3e7532c",path:"/pages/fa1dea/",headers:[{level:2,title:"CyclicBarrier çç¹ç¹å¦ä¸ï¼",slug:"cyclicbarrier-çç¹ç¹å¦ä¸",normalizedTitle:"cyclicbarrier çç¹ç¹å¦ä¸ï¼",charIndex:75},{level:2,title:"æ ¸å¿æ¹æ³",slug:"æ ¸å¿æ¹æ³",normalizedTitle:"æ ¸å¿æ¹æ³",charIndex:335},{level:2,title:"CyclicBarrier å CountDonwLatch çå¯¹æ¯",slug:"cyclicbarrier-å-countdonwlatch-çå¯¹æ¯",normalizedTitle:"cyclicbarrier å countdonwlatch çå¯¹æ¯",charIndex:615},{level:2,title:"CyclicBarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼",slug:"cyclicbarrier-çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢",normalizedTitle:"cyclicbarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼",charIndex:1203}],headersStr:"CyclicBarrier çç¹ç¹å¦ä¸ï¼ æ ¸å¿æ¹æ³ CyclicBarrier å CountDonwLatch çå¯¹æ¯ CyclicBarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼",content:"CyclicBarrierï¼å¾ªç¯å±éï¼æ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ç»çº¿ç¨å¨è¾¾å°æä¸ªå±åç¹ä¹åäºç¸ç­å¾ï¼ç¶ååæ¶ç»§ç»­æ§è¡ã\n\n\n# CyclicBarrier çç¹ç¹å¦ä¸ï¼\n\n 1. å±åç¹ï¼CyclicBarrier å¯ä»¥è®¾ç½®ä¸ä¸ªå±åç¹ï¼å½ç­å¾ççº¿ç¨æ°è¾¾å°æå®æ°éæ¶ï¼ææçº¿ç¨å°åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n 2. å¾ªç¯ä½¿ç¨ï¼CyclicBarrier å¯ä»¥è¢«å¤æ¬¡ä½¿ç¨ãå½ææçº¿ç¨é½è¢«éæ¾åï¼CyclicBarrier ä¼è¢«éç½®ï¼å¹¶å¯ä»¥åæ¬¡ä½¿ç¨ã\n 3. ç­å¾ä¸éæ¾ï¼çº¿ç¨éè¿è°ç¨ CyclicBarrier ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼å½æå®æ°éççº¿ç¨é½è°ç¨äº await() æ¹æ³åï¼ææçº¿ç¨ä¼åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n\n\n# æ ¸å¿æ¹æ³\n\n// æé æ¹æ³\nCyclicBarrier(int, Runnable); // æå®å³èè¯¥CyclicBarrierççº¿ç¨æ°éï¼å¹¶ä¸å¯ä»¥æå®å¨ææçº¿ç¨é½è¿å¥å±éåçæ§è¡å¨ä½ï¼è¯¥æ§è¡å¨ä½ç±æåä¸ä¸ªè¿è¡å±éççº¿ç¨æ§è¡ã\nCyclicBarrier(int);\n\ncb.await();\n\n\nå¨ææçº¿ç¨è¿å¥å±éåä¼è°ç¨ nextGeneration()ï¼å³çæä¸ä¸ä¸ªçæ¬ï¼ææçº¿ç¨åå¯ä»¥éæ°è¿å¥å°å±éä¸­ãè¦æ³¨æbarrier.await()æ¹æ³çè°ç¨æ¬¡æ°åºè¯¥ä¸åå»ºCyclicBarrieræ¶æå®ççº¿ç¨æ°éç¸å¹éï¼ä»¥ç¡®ä¿æ­£ç¡®çåæ­¥åç­å¾è¡ä¸ºã\n\n\n# CyclicBarrier å CountDonwLatch çå¯¹æ¯\n\n * CountDownLatchåè®¡æ°ï¼CyclicBarrierå è®¡æ°ã\n\n * CountDownLatchæ¯ä¸æ¬¡æ§çï¼CyclicBarrierå¯ä»¥éç¨ã\n\n * CountDownLatchåCyclicBarrieré½æè®©å¤ä¸ªçº¿ç¨ç­å¾åæ­¥ç¶ååå¼å§ä¸ä¸æ­¥å¨ä½çææï¼ä½æ¯CountDownLatchçä¸ä¸æ­¥çå¨ä½å®æ½èæ¯ä¸»çº¿ç¨ï¼å·æä¸å¯éå¤æ§ï¼èCyclicBarrierçä¸ä¸æ­¥å¨ä½å®æ½èè¿æ¯âå¶ä»çº¿ç¨âæ¬èº«ï¼å·æå¾å¤å¤æ¬¡å®æ½å¨ä½çç¹ç¹ã\n\n * å¯¹äºCountDownLatchï¼å¶ä»çº¿ç¨ä¸ºæ¸¸æç©å®¶ï¼æ¯å¦è±éèçï¼ä¸»çº¿ç¨ä¸ºæ§å¶æ¸¸æå¼å§ççº¿ç¨ãå¨ææçç©å®¶é½åå¤å¥½ä¹åï¼ä¸»çº¿ç¨æ¯å¤äºç­å¾ç¶æçï¼ä¹å°±æ¯æ¸¸æä¸è½å¼å§ãå½ææçç©å®¶åå¤å¥½ä¹åï¼ä¸ä¸æ­¥çå¨ä½å®æ½èä¸ºä¸»çº¿ç¨ï¼å³å¼å§æ¸¸æã\n\n * å¯¹äºCyclicBarrierï¼åè®¾æä¸å®¶å¬å¸è¦å¨ä½åå·¥è¿è¡å¢å»ºæ´»å¨ï¼æ´»å¨åå®¹ä¸ºç¿»è¶ä¸ä¸ªéç¢ç©ï¼æ¯ä¸ä¸ªäººç¿»è¶éç¢ç©æç¨çæ¶é´æ¯ä¸ä¸æ ·çãä½æ¯å¬å¸è¦æ±ææäººå¨ç¿»è¶å½åéç¢ç©ä¹ååå¼å§ç¿»è¶ä¸ä¸ä¸ªéç¢ç©ï¼ä¹å°±æ¯ææäººç¿»è¶ç¬¬ä¸ä¸ªéç¢ç©ä¹åï¼æå¼å§ç¿»è¶ç¬¬äºä¸ªï¼ä»¥æ­¤ç±»æ¨ãç±»æ¯å°ï¼æ¯ä¸ä¸ªåå·¥é½æ¯ä¸ä¸ªâå¶ä»çº¿ç¨âãå½ææäººé½ç¿»è¶çææçéç¢ç©ä¹åï¼ç¨åºæç»æãèä¸»çº¿ç¨å¯è½æ©å°±ç»æäºï¼è¿éæä»¬ä¸ç¨ç®¡ä¸»çº¿ç¨ã\n\n\n# CyclicBarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. å¹¶è¡è®¡ç®ä»»å¡çæåä¸åå¹¶ï¼å½ä¸ä¸ªå¤§åè®¡ç®ä»»å¡å¯ä»¥è¢«æåä¸ºå¤ä¸ªå­ä»»å¡å¹¶è¡æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥ç­å¾ææå­ä»»å¡å®æååè¿è¡åå¹¶è®¡ç®ã\n 2. å¤çº¿ç¨ä»»å¡çé¶æ®µåæ­¥ï¼å½ä¸ä¸ªä»»å¡éè¦æç§é¶æ®µè¿è¡å¤æ¬¡å¹¶åæä½ï¼æ¯ä¸ªé¶æ®µéè¦ç­å¾ææçº¿ç¨é½å®æåæè½ç»§ç»­ä¸ä¸é¶æ®µï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥å®ç°é¶æ®µé´çåæ­¥ã\n 3. å¹¶åæµæ°´çº¿çæµç¨æ§å¶ï¼å½å¤ä¸ªçº¿ç¨éè¦æç§ç¹å®çæµæ°´çº¿æ¹å¼æ§è¡ä»»å¡ï¼æ¯ä¸ªçº¿ç¨å¨å®æä¸å®æä½åéè¦ç­å¾å¶ä»çº¿ç¨æè½ç»§ç»­ï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥å®ç°çº¿ç¨ä¹é´çåæ­¥ã",normalizedContent:"cyclicbarrierï¼å¾ªç¯å±éï¼æ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ç»çº¿ç¨å¨è¾¾å°æä¸ªå±åç¹ä¹åäºç¸ç­å¾ï¼ç¶ååæ¶ç»§ç»­æ§è¡ã\n\n\n# cyclicbarrier çç¹ç¹å¦ä¸ï¼\n\n 1. å±åç¹ï¼cyclicbarrier å¯ä»¥è®¾ç½®ä¸ä¸ªå±åç¹ï¼å½ç­å¾ççº¿ç¨æ°è¾¾å°æå®æ°éæ¶ï¼ææçº¿ç¨å°åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n 2. å¾ªç¯ä½¿ç¨ï¼cyclicbarrier å¯ä»¥è¢«å¤æ¬¡ä½¿ç¨ãå½ææçº¿ç¨é½è¢«éæ¾åï¼cyclicbarrier ä¼è¢«éç½®ï¼å¹¶å¯ä»¥åæ¬¡ä½¿ç¨ã\n 3. ç­å¾ä¸éæ¾ï¼çº¿ç¨éè¿è°ç¨ cyclicbarrier ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼å½æå®æ°éççº¿ç¨é½è°ç¨äº await() æ¹æ³åï¼ææçº¿ç¨ä¼åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n\n\n# æ ¸å¿æ¹æ³\n\n// æé æ¹æ³\ncyclicbarrier(int, runnable); // æå®å³èè¯¥cyclicbarrierççº¿ç¨æ°éï¼å¹¶ä¸å¯ä»¥æå®å¨ææçº¿ç¨é½è¿å¥å±éåçæ§è¡å¨ä½ï¼è¯¥æ§è¡å¨ä½ç±æåä¸ä¸ªè¿è¡å±éççº¿ç¨æ§è¡ã\ncyclicbarrier(int);\n\ncb.await();\n\n\nå¨ææçº¿ç¨è¿å¥å±éåä¼è°ç¨ nextgeneration()ï¼å³çæä¸ä¸ä¸ªçæ¬ï¼ææçº¿ç¨åå¯ä»¥éæ°è¿å¥å°å±éä¸­ãè¦æ³¨æbarrier.await()æ¹æ³çè°ç¨æ¬¡æ°åºè¯¥ä¸åå»ºcyclicbarrieræ¶æå®ççº¿ç¨æ°éç¸å¹éï¼ä»¥ç¡®ä¿æ­£ç¡®çåæ­¥åç­å¾è¡ä¸ºã\n\n\n# cyclicbarrier å countdonwlatch çå¯¹æ¯\n\n * countdownlatchåè®¡æ°ï¼cyclicbarrierå è®¡æ°ã\n\n * countdownlatchæ¯ä¸æ¬¡æ§çï¼cyclicbarrierå¯ä»¥éç¨ã\n\n * countdownlatchåcyclicbarrieré½æè®©å¤ä¸ªçº¿ç¨ç­å¾åæ­¥ç¶ååå¼å§ä¸ä¸æ­¥å¨ä½çææï¼ä½æ¯countdownlatchçä¸ä¸æ­¥çå¨ä½å®æ½èæ¯ä¸»çº¿ç¨ï¼å·æä¸å¯éå¤æ§ï¼ècyclicbarrierçä¸ä¸æ­¥å¨ä½å®æ½èè¿æ¯âå¶ä»çº¿ç¨âæ¬èº«ï¼å·æå¾å¤å¤æ¬¡å®æ½å¨ä½çç¹ç¹ã\n\n * å¯¹äºcountdownlatchï¼å¶ä»çº¿ç¨ä¸ºæ¸¸æç©å®¶ï¼æ¯å¦è±éèçï¼ä¸»çº¿ç¨ä¸ºæ§å¶æ¸¸æå¼å§ççº¿ç¨ãå¨ææçç©å®¶é½åå¤å¥½ä¹åï¼ä¸»çº¿ç¨æ¯å¤äºç­å¾ç¶æçï¼ä¹å°±æ¯æ¸¸æä¸è½å¼å§ãå½ææçç©å®¶åå¤å¥½ä¹åï¼ä¸ä¸æ­¥çå¨ä½å®æ½èä¸ºä¸»çº¿ç¨ï¼å³å¼å§æ¸¸æã\n\n * å¯¹äºcyclicbarrierï¼åè®¾æä¸å®¶å¬å¸è¦å¨ä½åå·¥è¿è¡å¢å»ºæ´»å¨ï¼æ´»å¨åå®¹ä¸ºç¿»è¶ä¸ä¸ªéç¢ç©ï¼æ¯ä¸ä¸ªäººç¿»è¶éç¢ç©æç¨çæ¶é´æ¯ä¸ä¸æ ·çãä½æ¯å¬å¸è¦æ±ææäººå¨ç¿»è¶å½åéç¢ç©ä¹ååå¼å§ç¿»è¶ä¸ä¸ä¸ªéç¢ç©ï¼ä¹å°±æ¯ææäººç¿»è¶ç¬¬ä¸ä¸ªéç¢ç©ä¹åï¼æå¼å§ç¿»è¶ç¬¬äºä¸ªï¼ä»¥æ­¤ç±»æ¨ãç±»æ¯å°ï¼æ¯ä¸ä¸ªåå·¥é½æ¯ä¸ä¸ªâå¶ä»çº¿ç¨âãå½ææäººé½ç¿»è¶çææçéç¢ç©ä¹åï¼ç¨åºæç»æãèä¸»çº¿ç¨å¯è½æ©å°±ç»æäºï¼è¿éæä»¬ä¸ç¨ç®¡ä¸»çº¿ç¨ã\n\n\n# cyclicbarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. å¹¶è¡è®¡ç®ä»»å¡çæåä¸åå¹¶ï¼å½ä¸ä¸ªå¤§åè®¡ç®ä»»å¡å¯ä»¥è¢«æåä¸ºå¤ä¸ªå­ä»»å¡å¹¶è¡æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥ç­å¾ææå­ä»»å¡å®æååè¿è¡åå¹¶è®¡ç®ã\n 2. å¤çº¿ç¨ä»»å¡çé¶æ®µåæ­¥ï¼å½ä¸ä¸ªä»»å¡éè¦æç§é¶æ®µè¿è¡å¤æ¬¡å¹¶åæä½ï¼æ¯ä¸ªé¶æ®µéè¦ç­å¾ææçº¿ç¨é½å®æåæè½ç»§ç»­ä¸ä¸é¶æ®µï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥å®ç°é¶æ®µé´çåæ­¥ã\n 3. å¹¶åæµæ°´çº¿çæµç¨æ§å¶ï¼å½å¤ä¸ªçº¿ç¨éè¦æç§ç¹å®çæµæ°´çº¿æ¹å¼æ§è¡ä»»å¡ï¼æ¯ä¸ªçº¿ç¨å¨å®æä¸å®æä½åéè¦ç­å¾å¶ä»çº¿ç¨æè½ç»§ç»­ï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥å®ç°çº¿ç¨ä¹é´çåæ­¥ã",charsets:{cjk:!0}},{title:"ç´¢å¼",frontmatter:{title:"ç´¢å¼",date:"2023-03-23T21:35:58.000Z",permalink:"/pages/7ece7e/"},regularPath:"/02.MySQL/02.%E7%B4%A2%E5%BC%95.html",relativePath:"02.MySQL/02.ç´¢å¼.md",key:"v-571aeb12",path:"/pages/7ece7e/",headers:[{level:2,title:"ç´¢å¼æ¯ä»ä¹",slug:"ç´¢å¼æ¯ä»ä¹",normalizedTitle:"ç´¢å¼æ¯ä»ä¹",charIndex:2},{level:2,title:"ç´¢å¼çä¼ç¹",slug:"ç´¢å¼çä¼ç¹",normalizedTitle:"ç´¢å¼çä¼ç¹",charIndex:319},{level:2,title:"ç´¢å¼çä½¿ç¨åºæ¯",slug:"ç´¢å¼çä½¿ç¨åºæ¯",normalizedTitle:"ç´¢å¼çä½¿ç¨åºæ¯",charIndex:516},{level:2,title:"MySQL ç´¢å¼åç±»",slug:"mysql-ç´¢å¼åç±»",normalizedTitle:"mysql ç´¢å¼åç±»",charIndex:665},{level:2,title:"èéç´¢å¼åéèéç´¢å¼",slug:"èéç´¢å¼åéèéç´¢å¼",normalizedTitle:"èéç´¢å¼åéèéç´¢å¼",charIndex:815},{level:2,title:"MySQL åç§ç´¢å¼åºå«",slug:"mysql-åç§ç´¢å¼åºå«",normalizedTitle:"mysql åç§ç´¢å¼åºå«",charIndex:1062},{level:3,title:"å¯ä¸ç´¢å¼",slug:"å¯ä¸ç´¢å¼",normalizedTitle:"å¯ä¸ç´¢å¼",charIndex:979},{level:3,title:"åå¸ç´¢å¼",slug:"åå¸ç´¢å¼",normalizedTitle:"åå¸ç´¢å¼",charIndex:250},{level:2,title:"ç´¢å¼çéæ©",slug:"ç´¢å¼çéæ©",normalizedTitle:"ç´¢å¼çéæ©",charIndex:1498},{level:2,title:"ä»ä¹æ¯change buffer",slug:"ä»ä¹æ¯change-buffer",normalizedTitle:"ä»ä¹æ¯change buffer",charIndex:1574},{level:2,title:"ç´¢å¼ç¸å³SQL",slug:"ç´¢å¼ç¸å³sql",normalizedTitle:"ç´¢å¼ç¸å³sql",charIndex:2440},{level:2,title:"B+ æ ç´¢å¼",slug:"b-æ ç´¢å¼",normalizedTitle:"b+ æ ç´¢å¼",charIndex:2935},{level:2,title:"Bæ åB+æ çå¯¹æ¯",slug:"bæ åb-æ çå¯¹æ¯",normalizedTitle:"bæ åb+æ çå¯¹æ¯",charIndex:3644},{level:2,title:"B+æ åçº¢é»æ çå¯¹æ¯",slug:"b-æ åçº¢é»æ çå¯¹æ¯",normalizedTitle:"b+æ åçº¢é»æ çå¯¹æ¯",charIndex:3858},{level:2,title:"è¦çç´¢å¼ï¼covering indexï¼",slug:"è¦çç´¢å¼-covering-index",normalizedTitle:"è¦çç´¢å¼ï¼covering indexï¼",charIndex:4292},{level:2,title:"ç´¢å¼ä¸æ¨ï¼index condition pushdownï¼ICPï¼",slug:"ç´¢å¼ä¸æ¨-index-condition-pushdown-icp",normalizedTitle:"ç´¢å¼ä¸æ¨ï¼index condition pushdownï¼icpï¼",charIndex:4365},{level:2,title:"ç´¢å¼å¤±æå¸¸è§åºæ¯",slug:"ç´¢å¼å¤±æå¸¸è§åºæ¯",normalizedTitle:"ç´¢å¼å¤±æå¸¸è§åºæ¯",charIndex:4543},{level:2,title:"å»ºç´¢å¼çå å¤§åå",slug:"å»ºç´¢å¼çå å¤§åå",normalizedTitle:"å»ºç´¢å¼çå å¤§åå",charIndex:4848},{level:2,title:"åèèµæï¼",slug:"åèèµæ",normalizedTitle:"åèèµæï¼",charIndex:5264}],headersStr:"ç´¢å¼æ¯ä»ä¹ ç´¢å¼çä¼ç¹ ç´¢å¼çä½¿ç¨åºæ¯ MySQL ç´¢å¼åç±» èéç´¢å¼åéèéç´¢å¼ MySQL åç§ç´¢å¼åºå« å¯ä¸ç´¢å¼ åå¸ç´¢å¼ ç´¢å¼çéæ© ä»ä¹æ¯change buffer ç´¢å¼ç¸å³SQL B+ æ ç´¢å¼ Bæ åB+æ çå¯¹æ¯ B+æ åçº¢é»æ çå¯¹æ¯ è¦çç´¢å¼ï¼covering indexï¼ ç´¢å¼ä¸æ¨ï¼index condition pushdownï¼ICPï¼ ç´¢å¼å¤±æå¸¸è§åºæ¯ å»ºç´¢å¼çå å¤§åå åèèµæï¼",content:"# ç´¢å¼æ¯ä»ä¹\n\nç´¢å¼æ¯ä¸ç§æ°æ®ç»æï¼å®å¯ä»¥å¸®å©æä»¬å¿«éæ¥æ¾åè®¿é®æ°æ®åºä¸­çæ°æ®ãéè¿ä½¿ç¨ç´¢å¼ï¼æ°æ®åºç³»ç»å¯ä»¥é¿åå¨è¡¨æ«æï¼ä»èå å¿«æ°æ®è®¿é®éåº¦ã\n\nå¨æ°æ®åºä¸­ï¼ç´¢å¼å¯ä»¥ç±»æ¯äºä¹¦ç±çç®å½ï¼å®å¯ä»¥åè¯æä»¬å¨åªéè½å¤æ¾å°æä¸ªç¹å®çæ¡ç®ãå¦ææä»¬éè¦æ¥æ¾ä¸ä¸ªç¹å®çè®°å½ï¼èæ²¡æç´¢å¼ï¼é£ä¹æ°æ®åºç³»ç»å°±éè¦æ«ææ´ä¸ªè¡¨æ¥æ¥æ¾è¿ä¸ªè®°å½ï¼è¿ä¼æµªè´¹å¤§éçæ¶é´åèµæºãä½æ¯å¦ææä»¬æäºç´¢å¼ï¼æ°æ®åºç³»ç»å°±å¯ä»¥å¿«éå°å®ä½å°å­å¨è®°å½çä½ç½®ï¼ä»èæ´å¿«å°è·åéè¦çæ°æ®ã\n\nç´¢å¼å¯ä»¥æ ¹æ®å¶æ°æ®ç»æçä¸ååä¸ºå¤ç§ç±»åï¼å¦B+æ ç´¢å¼ãåå¸ç´¢å¼ãå¨æç´¢å¼ç­ãå¶ä¸­ï¼B-æ ç´¢å¼æ¯æå¸¸è§çä¸ç§ï¼å®å¯ä»¥å¤çèå´æ¥è¯¢åæåºæä½ï¼å¹¶ä¸å¯ä»¥å¾å¥½å°æ¯æé«å¹¶ååå¤ç¨æ·è®¿é®çç¯å¢ã\n\n\n# ç´¢å¼çä¼ç¹\n\n * å¤§å¤§åå°äºæå¡å¨éè¦æ«æçæ°æ®è¡æ°ã\n * å¸®å©æå¡å¨é¿åè¿è¡æåºååç»ï¼ä¹å°±ä¸éè¦åå»ºä¸´æ¶è¡¨(B+Tree ç´¢å¼æ¯æåºçï¼å¯ä»¥ç¨äº ORDER BY å GROUP BY æä½ãä¸´æ¶è¡¨ä¸»è¦æ¯å¨æåºååç»è¿ç¨ä¸­åå»ºï¼å ä¸ºä¸éè¦æåºååç»ï¼ä¹å°±ä¸éè¦åå»ºä¸´æ¶è¡¨)ã\n * å°éæº I/O åä¸ºé¡ºåº I/O(B+Tree ç´¢å¼æ¯æåºçï¼ä¹å°±å°ç¸é»çæ°æ®é½å­å¨å¨ä¸èµ·)ã\n\n\n# ç´¢å¼çä½¿ç¨åºæ¯\n\nå¯¹äºéå¸¸å°çè¡¨ãå¤§é¨åæåµä¸ç®åçå¨è¡¨æ«ææ¯å»ºç«ç´¢å¼æ´é«æã\n\nå¯¹äºä¸­å°å¤§åçè¡¨ï¼ç´¢å¼å°±éå¸¸ææã\n\nä½æ¯å¯¹äºç¹å¤§åçè¡¨ï¼å»ºç«åç»´æ¤ç´¢å¼çä»£ä»·å°ä¼éä¹å¢é¿ãè¿ç§æåµä¸ï¼éè¦ç¨å°ä¸ç§ææ¯å¯ä»¥ç´æ¥åºååºéè¦æ¥è¯¢çä¸ç»æ°æ®ï¼èä¸æ¯ä¸æ¡è®°å½ä¸æ¡è®°å½å°å¹éï¼ä¾å¦å¯ä»¥ä½¿ç¨ååºææ¯ã\n\n\n# MySQL ç´¢å¼åç±»\n\nææ°æ®ç»æåç±»å¯åä¸ºï¼B+treeç´¢å¼ãHashç´¢å¼ãFull-textç´¢å¼ã æç©çå­å¨åç±»å¯åä¸ºï¼èç°ç´¢å¼ãäºçº§ç´¢å¼ï¼è¾å©ç´¢å¼ãéèéç´¢å¼ï¼ã æå­æ®µç¹æ§åç±»å¯åä¸ºï¼ä¸»é®ç´¢å¼ãæ®éç´¢å¼ãåç¼ç´¢å¼ã æå­æ®µä¸ªæ°åç±»å¯åä¸ºï¼ååç´¢å¼ãèåç´¢å¼ï¼å¤åç´¢å¼ãç»åç´¢å¼ï¼ã\n\n\n# èéç´¢å¼åéèéç´¢å¼\n\næ¯å¼ è¡¨åªè½æä¸ä¸ªèéç´¢å¼ã\n\nèéç´¢å¼æ¯å¶å­ç»ç¹å­å¨å®æ´æ°æ®ï¼éèéç´¢å¼å¶å­ç»ç¹å­å¨èéç´¢å¼çå°åã\n\nèéç´¢å¼ï¼å¨ç´¢å¼é¡µéç´æ¥å­æ¾æ°æ®ï¼èéèéç´¢å¼å¨ç´¢å¼é¡µéå­æ¾çæ¯ç´¢å¼ï¼è¿äºç´¢å¼æåä¸é¨çæ°æ®é¡µçæ°æ®ã\n\nèéç´¢å¼ä¸è¬æ¯è¡¨ä¸­çä¸»é®ç´¢å¼ï¼å¦æè¡¨ä¸­æ²¡ææ¾ç¤ºæå®ä¸»é®ï¼åä¼éæ©è¡¨ä¸­çç¬¬ä¸ä¸ªä¸åè®¸ä¸ºNULLçå¯ä¸ç´¢å¼ï¼å¦æè¿æ¯æ²¡æçè¯ï¼å°±éç¨Innodbå­å¨å¼æä¸ºæ¯è¡æ°æ®åç½®ç6å­èROWIDä½ä¸ºèéç´¢å¼ã\n\nèéç´¢å¼ä¸å®æ¯å¯ä¸ç´¢å¼ï¼ä½å¯ä¸ç´¢å¼ä¸ä¸å®æ¯èéç´¢å¼ã\n\n\n# MySQL åç§ç´¢å¼åºå«\n\næ®éç´¢å¼ INDEXï¼æåºæ¬çç´¢å¼ï¼æ²¡æä»»ä½éå¶\n\nå¯ä¸ç´¢å¼ UNIQUEï¼ä¸\"æ®éç´¢å¼\"ç±»ä¼¼ï¼ä¸åçå°±æ¯ï¼ç´¢å¼åçå¼å¿é¡»å¯ä¸ï¼ä½åè®¸æç©ºå¼ã\n\nä¸»é®ç´¢å¼ PRIMARY KEYï¼æ¯ä¸ç§ç¹æ®çå¯ä¸ç´¢å¼ï¼ä¸åè®¸æç©ºå¼ã\n\nå¨æç´¢å¼ FULLTEXTï¼InnoDB 5.6å¼å§ä¹æ¯æäºï¼éå¯¹è¾å¤§çæ°æ®ï¼çæå¨æç´¢å¼å¾èæ¶å¥½ç©ºé´ã\n\nç»åç´¢å¼ï¼ä¸ºäºæ´å¤çæé«mysqlæçå¯å»ºç«ç»åç´¢å¼ï¼éµå¾ªâæå·¦åç¼âååã\n\n\n# å¯ä¸ç´¢å¼\n\n * å¯ä¸ç´¢å¼ä¸åè®¸ä¸¤è¡å·æç¸åçç´¢å¼å¼\n * èéç´¢å¼ä¸å®æ¯å¯ä¸ç´¢å¼ï¼ä½å¯ä¸ç´¢å¼ä¸ä¸å®æ¯èéç´¢å¼ã\n * ä¸ä¸ªè¡¨ä¸­å¯ä»¥æå¤ä¸ªå¯ä¸æ§ç´¢å¼ï¼Uniq Indexï¼ï¼ä½åªè½æä¸ä¸ªä¸»é®ã\n * ä¸»é®åä¸åè®¸ç©ºå¼ï¼èå¯ä¸æ§ç´¢å¼åï¼Uniq Indexï¼åè®¸ç©ºå¼ã\n\n\n# åå¸ç´¢å¼\n\nInnoDB æ¯æçåå¸ç´¢å¼æ¯èªéåºçï¼InnoDB ä¼æ ¹æ®è¡¨çä½¿ç¨ç¶åµèªå¨ä¸ºå¶çæåå¸ç´¢å¼ï¼ä¸è½äººä¸ºå¹²é¢æ¯å¦å¨ä¸å¼ è¡¨çæåå¸ç´¢å¼ã\n\n\n# ç´¢å¼çéæ©\n\nä¸å¡åå¤è¯»å°çåºæ¯ï¼ç±äºå¯ä¸ç´¢å¼ç¨ä¸ä¸change bufferçä¼åæºå¶ï¼ä»æ§è½è§åº¦åºåå»ºè®®ä¼åèèéå¯ä¸ç´¢å¼ï¼å³æ®éç´¢å¼ï¼ã\n\n\n# ä»ä¹æ¯change buffer\n\nChange bufferæ¯MySQLæ°æ®åºå¼æInnoDBç¨äºä¼ååå¥æ§è½çä¸ç§æºå¶ãå¨InnoDBå­å¨å¼æä¸­ï¼æ¯æ¬¡è¿è¡åå¥æä½æ¶ï¼éè¦å°æ°æ®åå¥å°ç£çä¸­çæ°æ®æä»¶ä¸­ï¼è¿ä¸ªè¿ç¨æ¯æ¯è¾èæ¶çãä¸ºäºä¼åè¿ä¸ªè¿ç¨ï¼InnoDBä½¿ç¨äºChange bufferæºå¶ãéè¿ä½¿ç¨Change bufferï¼InnoDBå¯ä»¥å°å¤ä¸ªä¿®æ¹æä½åå¹¶æä¸ä¸ªè¾å¤§çæä½ï¼ä»èåå°ç£çI/Oçæ¬¡æ°ï¼æé«åå¥æ§è½ãæ­¤å¤ï¼Change bufferè¿å¯ä»¥åå°ç£çä¸çéæºåå¥æä½ï¼ä»èéä½äºç£ççè¯»åè´è½½ã\n\nå½éè¦æ´æ°ä¸ä¸ªæ°æ®é¡µæ¶ï¼å¦ææ°æ®é¡µå¨åå­ä¸­å°±ç´æ¥æ´æ°ï¼èå¦æè¿ä¸ªæ°æ®é¡µè¿æ²¡æå¨åå­ä¸­çè¯ï¼InooDBä¼å°è¿äºæ´æ°æä½ç¼å­å¨change bufferä¸­ï¼è¿æ ·å°±ä¸éè¦ä»ç£çä¸­è¯»å¥è¿ä¸ªæ°æ®é¡µäºï¼å¨åç»­çæ¥è¯¢ä¸­åå°è¿äºæä½åºç¨å°ç£çä¸çæ°æ®é¡µä¸­ãå¨ä¸æ¬¡æ¥è¯¢éè¦è®¿é®è¿ä¸ªæ°æ®é¡µçæ¶åï¼å°æ°æ®é¡µè¯»å¥åå­ï¼ç¶åæ§è¡change bufferä¸­ä¸è¿ä¸ªé¡µæå³çæä½ï¼ä¿è¯æ°æ®é»è¾çæ­£ç¡®æ§ã\n\nå°change bufferä¸­çæä½åºç¨å°åæ°æ®é¡µï¼å¾å°ææ°ç»æçè¿ç¨ç§°ä¸ºmergeãé¤äºè®¿é®è¿ä¸ªæ°æ®é¡µä¼è§¦åmergeå¤ï¼ç³»ç»æåå°çº¿ç¨ä¼å®æmergeãå¨æ°æ®åºæ­£å¸¸å³é­ï¼shutdownï¼çè¿ç¨ä¸­ï¼ ä¹ä¼æ§è¡mergeæä½ã\n\nchange bufferå¯¹æ´æ°è¿ç¨æå éä½ç¨ï¼change bufferåªéäºç¨å¨æ®éç´¢å¼çåºæ¯ä¸ï¼èä¸éç¨äºå¯ä¸ç´¢å¼ã\n\nchange buffer éååå¤è¯»å°çä¸å¡ï¼å ä¸ºé¡µé¢å¨åå®ä»¥åé©¬ä¸è¢«è®¿é®å°çæ¦çæ¯è¾å°ãè¿ç§ä¸å¡æ¨¡åå¸¸è§çå°±æ¯è´¦åç±»ãæ¥å¿ç±»çç³»ç»ã\n\nåè¿æ¥ï¼åè®¾ä¸ä¸ªä¸å¡çæ´æ°æ¨¡å¼æ¯åå¥ä¹åé©¬ä¸ä¼åæ¥è¯¢ï¼é£ä¹å³ä½¿æ»¡è¶³äºæ¡ä»¶ï¼å°æ´æ°åè®°å½å¨change bufferï¼ä½ä¹åç±äºé©¬ä¸è¦è®¿é®è¿ä¸ªæ°æ®é¡µï¼ä¼ç«å³è§¦åmergeè¿ç¨ãè¿æ ·éæºè®¿é® IOçæ¬¡æ°ä¸ä¼åå°ï¼åèå¢å äºchange bufferçç»´æ¤ä»£ä»·ãæä»¥ï¼å¯¹äºè¿ç§ä¸å¡æ¨¡å¼æ¥è¯´ï¼change bufferåèèµ·å°äºå¯ä½ç¨ã\n\n\n# ç´¢å¼ç¸å³SQL\n\n# æ¥çç´¢å¼\nSHOW INDEX FROM <tableName> [FROM <databaseName>]\n\n# åå»ºç´¢å¼\n1.è¯¥è¯­å¥ä¸è½åå»ºä¸»é®\nCREATE <ç´¢å¼å> ON <è¡¨å> (<åå> [<é¿åº¦>] [ASC | DESC])\n\n2.å¨åå»ºè¡¨æ¶åå»ºï¼å¨CREATE TABLEè¯­å¥ä¸­æ·»å \nCONSTRAINT PRIMARY KEY [ç´¢å¼ç±»å] (<åå>...)\nKEY | INDEX [<ç´¢å¼å>] (<åå>...)\n\n3.å¨ALTER TABLEä¸­æ·»å \nADD PRIMARY KEY [ç´¢å¼ç±»å] (<åå>...)\nADD INDEX [<ç´¢å¼å>] (<åå>...)\nADD UNIQUE [ INDEX | KEY] [<ç´¢å¼å>] [<ç´¢å¼ç±»å>] (<åå>,â¦)\n\nå®æ´SQLï¼\nCREATE INDEX <indexName> ON <tableName> (<columnName>)\nALTER TABLE <tableName> ADD INDEX <indexName> (<columnName>)\n\n\n\n# B+ æ ç´¢å¼\n\nç´¢å¼æ¯å¨å­å¨å¼æå±å®ç°çï¼èä¸æ¯å¨æå¡å¨å±å®ç°çï¼æä»¥ä¸åå­å¨å¼æå·æä¸åçç´¢å¼ç±»ååå®ç°ã\n\nB+ æ ç´¢å¼æ¯å¤§å¤æ° MySQL å­å¨å¼æçé»è®¤ç´¢å¼ç±»åã\n\nB ä»£è¡¨ balanceï¼B+ æ æ¯å¹³è¡¡å¤è·¯æ¥æ¾æ ãB+ æ ä¸­ï¼ææè®°å½èç¹é½æ¯æé®å¼å¤§å°é¡ºåºå­æ¾å¨åä¸å±çå¶å­èç¹ä¸ï¼åå¶å­èç¹éè¿æéè¿è¡ç¸è¿ã\n\nB+æ æ¯é«åº¦å¹³è¡¡çï¼å¶å­èç¹å­æ¾çææçæ°æ®ãå¹¶ä¸ææå¶å­èç¹ä½äºåä¸å±ã\n\nB+ Tree æ¯åºäº B Tree åå¶å­èç¹é¡ºåºè®¿é®æéè¿è¡å®ç°ï¼å®å·æ B Tree çå¹³è¡¡æ§ï¼å¹¶ä¸éè¿é¡ºåºè®¿é®æéæ¥æé«åºé´æ¥è¯¢çæ§è½ã\n\nå¨æ°æ®åºä¸­ï¼B+ æ é«åº¦ä¸è¬å¨ 2~4 å±ï¼å³æ¥è¯¢æä¸é®å¼çè¡è®°å½æå¤åªé 2~4 æ¬¡ IOãä¸è¬æºæ¢°ç£çæ¯ç§å¯ä»¥å100æ¬¡IOï¼2~4 æ¬¡IOåªé0.02~0.04ç§ã\n\nB+ æ ç´¢å¼å¯ä»¥åä¸ºèéç´¢å¼ï¼clustered indexï¼åè¾å©ç´¢å¼ï¼secondary indexï¼ä¹å«éèéç´¢å¼ï¼ãä½ä¸ç®¡æ¯èéè¿æ¯è¾å©ç´¢å¼ï¼åºå±é½æ¯B+æ ãåºå«å¨äºï¼å¶å­èç¹å­æ¾çæ¯å¦æ¯ä¸æ´è¡çæ°æ®ã\n\nèéç´¢å¼çä¼ç¹å¨äºï¼å¯¹ä¸»é®çæåºæ¥æ¾åèå´æ¥æ¾éåº¦éå¸¸å¿«ã\n\nè¾å©ç´¢å¼çå¶å­èç¹ä¸åå«è¡è®°å½çææä¿¡æ¯ï¼åªåå«é®å¼åå¯¹åºè¡æ°æ®çèéç´¢å¼é®ã\n\n\næä½ï¼\n\nè¿è¡æ¥æ¾æä½æ¶ï¼é¦åå¨æ ¹èç¹è¿è¡äºåæ¥æ¾ï¼æ¾å°ä¸ä¸ª key æå¨çæéï¼ç¶åéå½å°å¨æéææåçèç¹è¿è¡æ¥æ¾ãç´å°æ¥æ¾å°å¶å­èç¹ï¼ç¶åå¨å¶å­èç¹ä¸è¿è¡äºåæ¥æ¾ï¼æ¾åº key æå¯¹åºç dataã\n\næå¥å é¤æä½è®°å½ä¼ç ´åå¹³è¡¡æ çå¹³è¡¡æ§ï¼å æ­¤å¨æå¥å é¤æä½ä¹åï¼éè¦å¯¹æ è¿è¡ä¸ä¸ªåè£ãåå¹¶ãæè½¬ç­æä½æ¥ç»´æ¤å¹³è¡¡æ§ã\n\n\n# Bæ åB+æ çå¯¹æ¯\n\nB+ æ å¨Bæ çåºç¡ä¸ï¼ä¸ºå¶å­èç¹å¢å äºé¾è¡¨æéï¼æææ°æ®é½å­å¨å¨å¶å­èç¹ãéå¶å­èç¹ä½ä¸ºå¶å­èç¹çç´¢å¼ã\n\nB+ æ ç¸å¯¹äº Bæ çä¼å¿å¨äºï¼\n\n * åªæå¶å­èç¹å­å¨æ°æ®ï¼åä¸èç¹å¯ä»¥å­å¨çåç´ å°±æ´å¤äºï¼ä½¿å¾æ¥è¯¢çIOæ¬¡æ°æ´å°ï¼å æ­¤æ´éååä¸ºæ°æ®åºåºå±æ°æ®ç»æã\n * ææçå¶å­èç¹å½¢æäºä¸ä¸ªæåºé¾è¡¨ï¼æ´å ä¾¿äºæ¥æ¾ã\n * B+æ æ¯ærange-query(åºé´æ¥è¯¢)éå¸¸æ¹ä¾¿ï¼èBæ ä¸æ¯æã\n\n\n# B+æ åçº¢é»æ çå¯¹æ¯\n\nçº¢é»æ ç­å¹³è¡¡æ ä¹å¯ä»¥ç¨æ¥å®ç°ç´¢å¼ï¼ä½æ¯æä»¶ç³»ç»åæ°æ®åºç³»ç»æ®ééç¨ B+ Tree ä½ä¸ºç´¢å¼ç»æï¼ä¸»è¦æä»¥ä¸ä¸¤ä¸ªåå :\n\n 1. æ´å°çæ¥æ¾æ¬¡æ°\n\nå¹³è¡¡æ æ¥æ¾æä½çæ¶é´å¤æåº¦ç­äºæ é« hï¼èæ é«å¤§è´ä¸º O(h)=O(logdN)ï¼å¶ä¸­ d ä¸ºæ¯ä¸ªèç¹çåºåº¦ã\n\nçº¢é»æ çåºåº¦ä¸º 2ï¼è B+ Tree çåºåº¦ä¸è¬é½éå¸¸å¤§ï¼æä»¥çº¢é»æ çæ é« h å¾ææ¾æ¯ B+ Tree å¤§éå¸¸å¤ï¼æ£ç´¢çæ¬¡æ°ä¹å°±æ´å¤ã\n\n 2. å©ç¨è®¡ç®æºé¢è¯»ç¹æ§\n\nä¸ºäºåå°ç£ç I/Oï¼ç£çå¾å¾ä¸æ¯ä¸¥æ ¼æéè¯»åï¼èæ¯æ¯æ¬¡é½ä¼é¢è¯»ãé¢è¯»è¿ç¨ä¸­ï¼ç£çè¿è¡é¡ºåºè¯»åï¼é¡ºåºè¯»åä¸éè¦è¿è¡ç£çå¯»éï¼å¹¶ä¸åªéè¦å¾ç­çæè½¬æ¶é´ï¼å æ­¤éåº¦ä¼éå¸¸å¿«ã\n\næä½ç³»ç»ä¸è¬å°åå­åç£çåå²æåºæå¤§å°çåï¼æ¯ä¸åç§°ä¸ºä¸é¡µï¼åå­ä¸ç£çä»¥é¡µä¸ºåä½äº¤æ¢æ°æ®ãæ°æ®åºç³»ç»å°ç´¢å¼çä¸ä¸ªèç¹çå¤§å°è®¾ç½®ä¸ºé¡µçå¤§å°ï¼ä½¿å¾ä¸æ¬¡ I/O å°±è½å®å¨è½½å¥ä¸ä¸ªèç¹ï¼å¹¶ä¸å¯ä»¥å©ç¨é¢è¯»ç¹æ§ï¼ç¸é»çèç¹ä¹è½å¤è¢«é¢åè½½å¥ã\n\n\n# è¦çç´¢å¼ï¼covering indexï¼\n\nå³ä»è¾å©ç´¢å¼ä¸­å°±å¯ä»¥æ¥è¯¢å°éè¦çä¿¡æ¯ï¼ä¸éè¦åå»æ¥è¯¢èéç´¢å¼çä¿¡æ¯ï¼åå°äºåè¡¨ï¼åå°äºIOã\n\n\n# ç´¢å¼ä¸æ¨ï¼index condition pushdownï¼ICPï¼\n\nä¸æ¯æ ICP æ¶ï¼å½è¿è¡ç´¢å¼æ¥è¯¢æ¶ï¼é¦åæ ¹æ®ç´¢å¼æ¥æ¾å°è®°å½ï¼åæ ¹æ® where æ¡ä»¶è¿æ»¤è®°å½ãèæ¯æ ICPçè¯ï¼å¨ååºç´¢å¼çåæ¶ï¼è¿è¡ where æ¡ä»¶çè¿æ»¤ï¼å³å° where æä½æ¾å¨äºå­å¨å¼æå±ãå¨æäºæ¥è¯¢ä¸ï¼å¯ä»¥å¤§å¤§åå°ä¸å±SQLå±å¯¹è®°å½çç´¢åï¼ä¹åå°äºåè¡¨æ¬¡æ°ã\n\n\n# ç´¢å¼å¤±æå¸¸è§åºæ¯\n\n * è¿åæå·¦åç¼å¹éååãä¾å¦æç´¢å¼index(a,b)ï¼ä½æ¥è¯¢æ¡ä»¶åªæbå­æ®µã\n * å¨ç´¢å¼åä¸åä»»ä½æä½ï¼åæ¬è®¡ç®ãå½æ°ãç±»åè½¬æ¢ç­ã\n * èå´æ¥è¯¢ä½¿èåç´¢å¼åæ­¢å¹éã\n * åå°select*çä½¿ç¨ãé¿åä¸å¿è¦çåè¡¨æä½å¼éï¼å°½éä½¿ç¨è¦çç´¢å¼ã\n * ä½¿ç¨ä¸ç­äºï¼!=ã<>ï¼ï¼ä½¿ç¨oræä½ã\n * å­ç¬¦ä¸²ä¸å åå¼å·ç´¢å¼å¤±æã\n * likeä»¥ééç¬¦å¼å¤´'%abc'ãæ³¨ælike âabc%â æ¯å¯ä»¥èµ°ç´¢å¼çã\n * order by è¿åæå·¦å¹éååï¼å«éç´¢å¼å­æ®µæåºï¼ä¼äº§çæä»¶æåºã\n * group by è¿åæå·¦å¹éååï¼å«éç´¢å¼å­æ®µåç»ï¼ä¼å¯¼è´äº§çä¸´æ¶è¡¨ã\n\n\n# å»ºç´¢å¼çå å¤§åå\n\n * æå·¦åç¼å¹éååï¼éå¸¸éè¦çåå\n   * mysqlä¼ä¸ç´åå³å¹éç´å°éå°èå´æ¥è¯¢(>ã<ãbetweenãlike)å°±åæ­¢å¹éï¼\n   * æ¯å¦a = 1 and b = 2 and c > 3 and d = 4\n     * å¦æå»ºç«(a,b,c,d)é¡ºåºçç´¢å¼ï¼dæ¯ç¨ä¸å°ç´¢å¼çï¼\n     * å¦æå»ºç«(a,b,d,c)çç´¢å¼åé½å¯ä»¥ç¨å°ï¼a,b,dçé¡ºåºå¯ä»¥ä»»æè°æ´ï¼å»ºç«ç´¢å¼æ¶ä»ä»¬ä¸ä¸ªçé¡ºåºï¼\n * =åinå¯ä»¥ä¹±åºï¼\n   * æ¯å¦a = 1 and b = 2 and c = 3 å»ºç«(a,b,c)ç´¢å¼å¯ä»¥ä»»æé¡ºåºï¼\n   * mysqlçæ¥è¯¢ä¼åå¨ä¼å¸®ä½ ä¼åæç´¢å¼å¯ä»¥è¯å«çå½¢å¼ã\n * å°½ééæ©åºååº¦é«çåä½ä¸ºç´¢å¼ï¼\n   * åºååº¦çå¬å¼æ¯count(distinct col)/count(*)ï¼è¡¨ç¤ºå­æ®µä¸éå¤çæ¯ä¾ï¼æ¯ä¾è¶å¤§æä»¬æ«æçè®°å½æ°è¶å°ï¼å¯ä¸é®çåºååº¦æ¯1\n\n\n# åèèµæï¼\n\n * ä¸»é®ä¸å¯ä¸ç´¢å¼çåºå«\n * MySQLèéç´¢å¼åéèéç´¢å¼\n * MySQLç´¢å¼é½æåªäºåç±»ï¼",normalizedContent:"# ç´¢å¼æ¯ä»ä¹\n\nç´¢å¼æ¯ä¸ç§æ°æ®ç»æï¼å®å¯ä»¥å¸®å©æä»¬å¿«éæ¥æ¾åè®¿é®æ°æ®åºä¸­çæ°æ®ãéè¿ä½¿ç¨ç´¢å¼ï¼æ°æ®åºç³»ç»å¯ä»¥é¿åå¨è¡¨æ«æï¼ä»èå å¿«æ°æ®è®¿é®éåº¦ã\n\nå¨æ°æ®åºä¸­ï¼ç´¢å¼å¯ä»¥ç±»æ¯äºä¹¦ç±çç®å½ï¼å®å¯ä»¥åè¯æä»¬å¨åªéè½å¤æ¾å°æä¸ªç¹å®çæ¡ç®ãå¦ææä»¬éè¦æ¥æ¾ä¸ä¸ªç¹å®çè®°å½ï¼èæ²¡æç´¢å¼ï¼é£ä¹æ°æ®åºç³»ç»å°±éè¦æ«ææ´ä¸ªè¡¨æ¥æ¥æ¾è¿ä¸ªè®°å½ï¼è¿ä¼æµªè´¹å¤§éçæ¶é´åèµæºãä½æ¯å¦ææä»¬æäºç´¢å¼ï¼æ°æ®åºç³»ç»å°±å¯ä»¥å¿«éå°å®ä½å°å­å¨è®°å½çä½ç½®ï¼ä»èæ´å¿«å°è·åéè¦çæ°æ®ã\n\nç´¢å¼å¯ä»¥æ ¹æ®å¶æ°æ®ç»æçä¸ååä¸ºå¤ç§ç±»åï¼å¦b+æ ç´¢å¼ãåå¸ç´¢å¼ãå¨æç´¢å¼ç­ãå¶ä¸­ï¼b-æ ç´¢å¼æ¯æå¸¸è§çä¸ç§ï¼å®å¯ä»¥å¤çèå´æ¥è¯¢åæåºæä½ï¼å¹¶ä¸å¯ä»¥å¾å¥½å°æ¯æé«å¹¶ååå¤ç¨æ·è®¿é®çç¯å¢ã\n\n\n# ç´¢å¼çä¼ç¹\n\n * å¤§å¤§åå°äºæå¡å¨éè¦æ«æçæ°æ®è¡æ°ã\n * å¸®å©æå¡å¨é¿åè¿è¡æåºååç»ï¼ä¹å°±ä¸éè¦åå»ºä¸´æ¶è¡¨(b+tree ç´¢å¼æ¯æåºçï¼å¯ä»¥ç¨äº order by å group by æä½ãä¸´æ¶è¡¨ä¸»è¦æ¯å¨æåºååç»è¿ç¨ä¸­åå»ºï¼å ä¸ºä¸éè¦æåºååç»ï¼ä¹å°±ä¸éè¦åå»ºä¸´æ¶è¡¨)ã\n * å°éæº i/o åä¸ºé¡ºåº i/o(b+tree ç´¢å¼æ¯æåºçï¼ä¹å°±å°ç¸é»çæ°æ®é½å­å¨å¨ä¸èµ·)ã\n\n\n# ç´¢å¼çä½¿ç¨åºæ¯\n\nå¯¹äºéå¸¸å°çè¡¨ãå¤§é¨åæåµä¸ç®åçå¨è¡¨æ«ææ¯å»ºç«ç´¢å¼æ´é«æã\n\nå¯¹äºä¸­å°å¤§åçè¡¨ï¼ç´¢å¼å°±éå¸¸ææã\n\nä½æ¯å¯¹äºç¹å¤§åçè¡¨ï¼å»ºç«åç»´æ¤ç´¢å¼çä»£ä»·å°ä¼éä¹å¢é¿ãè¿ç§æåµä¸ï¼éè¦ç¨å°ä¸ç§ææ¯å¯ä»¥ç´æ¥åºååºéè¦æ¥è¯¢çä¸ç»æ°æ®ï¼èä¸æ¯ä¸æ¡è®°å½ä¸æ¡è®°å½å°å¹éï¼ä¾å¦å¯ä»¥ä½¿ç¨ååºææ¯ã\n\n\n# mysql ç´¢å¼åç±»\n\nææ°æ®ç»æåç±»å¯åä¸ºï¼b+treeç´¢å¼ãhashç´¢å¼ãfull-textç´¢å¼ã æç©çå­å¨åç±»å¯åä¸ºï¼èç°ç´¢å¼ãäºçº§ç´¢å¼ï¼è¾å©ç´¢å¼ãéèéç´¢å¼ï¼ã æå­æ®µç¹æ§åç±»å¯åä¸ºï¼ä¸»é®ç´¢å¼ãæ®éç´¢å¼ãåç¼ç´¢å¼ã æå­æ®µä¸ªæ°åç±»å¯åä¸ºï¼ååç´¢å¼ãèåç´¢å¼ï¼å¤åç´¢å¼ãç»åç´¢å¼ï¼ã\n\n\n# èéç´¢å¼åéèéç´¢å¼\n\næ¯å¼ è¡¨åªè½æä¸ä¸ªèéç´¢å¼ã\n\nèéç´¢å¼æ¯å¶å­ç»ç¹å­å¨å®æ´æ°æ®ï¼éèéç´¢å¼å¶å­ç»ç¹å­å¨èéç´¢å¼çå°åã\n\nèéç´¢å¼ï¼å¨ç´¢å¼é¡µéç´æ¥å­æ¾æ°æ®ï¼èéèéç´¢å¼å¨ç´¢å¼é¡µéå­æ¾çæ¯ç´¢å¼ï¼è¿äºç´¢å¼æåä¸é¨çæ°æ®é¡µçæ°æ®ã\n\nèéç´¢å¼ä¸è¬æ¯è¡¨ä¸­çä¸»é®ç´¢å¼ï¼å¦æè¡¨ä¸­æ²¡ææ¾ç¤ºæå®ä¸»é®ï¼åä¼éæ©è¡¨ä¸­çç¬¬ä¸ä¸ªä¸åè®¸ä¸ºnullçå¯ä¸ç´¢å¼ï¼å¦æè¿æ¯æ²¡æçè¯ï¼å°±éç¨innodbå­å¨å¼æä¸ºæ¯è¡æ°æ®åç½®ç6å­èrowidä½ä¸ºèéç´¢å¼ã\n\nèéç´¢å¼ä¸å®æ¯å¯ä¸ç´¢å¼ï¼ä½å¯ä¸ç´¢å¼ä¸ä¸å®æ¯èéç´¢å¼ã\n\n\n# mysql åç§ç´¢å¼åºå«\n\næ®éç´¢å¼ indexï¼æåºæ¬çç´¢å¼ï¼æ²¡æä»»ä½éå¶\n\nå¯ä¸ç´¢å¼ uniqueï¼ä¸\"æ®éç´¢å¼\"ç±»ä¼¼ï¼ä¸åçå°±æ¯ï¼ç´¢å¼åçå¼å¿é¡»å¯ä¸ï¼ä½åè®¸æç©ºå¼ã\n\nä¸»é®ç´¢å¼ primary keyï¼æ¯ä¸ç§ç¹æ®çå¯ä¸ç´¢å¼ï¼ä¸åè®¸æç©ºå¼ã\n\nå¨æç´¢å¼ fulltextï¼innodb 5.6å¼å§ä¹æ¯æäºï¼éå¯¹è¾å¤§çæ°æ®ï¼çæå¨æç´¢å¼å¾èæ¶å¥½ç©ºé´ã\n\nç»åç´¢å¼ï¼ä¸ºäºæ´å¤çæé«mysqlæçå¯å»ºç«ç»åç´¢å¼ï¼éµå¾ªâæå·¦åç¼âååã\n\n\n# å¯ä¸ç´¢å¼\n\n * å¯ä¸ç´¢å¼ä¸åè®¸ä¸¤è¡å·æç¸åçç´¢å¼å¼\n * èéç´¢å¼ä¸å®æ¯å¯ä¸ç´¢å¼ï¼ä½å¯ä¸ç´¢å¼ä¸ä¸å®æ¯èéç´¢å¼ã\n * ä¸ä¸ªè¡¨ä¸­å¯ä»¥æå¤ä¸ªå¯ä¸æ§ç´¢å¼ï¼uniq indexï¼ï¼ä½åªè½æä¸ä¸ªä¸»é®ã\n * ä¸»é®åä¸åè®¸ç©ºå¼ï¼èå¯ä¸æ§ç´¢å¼åï¼uniq indexï¼åè®¸ç©ºå¼ã\n\n\n# åå¸ç´¢å¼\n\ninnodb æ¯æçåå¸ç´¢å¼æ¯èªéåºçï¼innodb ä¼æ ¹æ®è¡¨çä½¿ç¨ç¶åµèªå¨ä¸ºå¶çæåå¸ç´¢å¼ï¼ä¸è½äººä¸ºå¹²é¢æ¯å¦å¨ä¸å¼ è¡¨çæåå¸ç´¢å¼ã\n\n\n# ç´¢å¼çéæ©\n\nä¸å¡åå¤è¯»å°çåºæ¯ï¼ç±äºå¯ä¸ç´¢å¼ç¨ä¸ä¸change bufferçä¼åæºå¶ï¼ä»æ§è½è§åº¦åºåå»ºè®®ä¼åèèéå¯ä¸ç´¢å¼ï¼å³æ®éç´¢å¼ï¼ã\n\n\n# ä»ä¹æ¯change buffer\n\nchange bufferæ¯mysqlæ°æ®åºå¼æinnodbç¨äºä¼ååå¥æ§è½çä¸ç§æºå¶ãå¨innodbå­å¨å¼æä¸­ï¼æ¯æ¬¡è¿è¡åå¥æä½æ¶ï¼éè¦å°æ°æ®åå¥å°ç£çä¸­çæ°æ®æä»¶ä¸­ï¼è¿ä¸ªè¿ç¨æ¯æ¯è¾èæ¶çãä¸ºäºä¼åè¿ä¸ªè¿ç¨ï¼innodbä½¿ç¨äºchange bufferæºå¶ãéè¿ä½¿ç¨change bufferï¼innodbå¯ä»¥å°å¤ä¸ªä¿®æ¹æä½åå¹¶æä¸ä¸ªè¾å¤§çæä½ï¼ä»èåå°ç£çi/oçæ¬¡æ°ï¼æé«åå¥æ§è½ãæ­¤å¤ï¼change bufferè¿å¯ä»¥åå°ç£çä¸çéæºåå¥æä½ï¼ä»èéä½äºç£ççè¯»åè´è½½ã\n\nå½éè¦æ´æ°ä¸ä¸ªæ°æ®é¡µæ¶ï¼å¦ææ°æ®é¡µå¨åå­ä¸­å°±ç´æ¥æ´æ°ï¼èå¦æè¿ä¸ªæ°æ®é¡µè¿æ²¡æå¨åå­ä¸­çè¯ï¼inoodbä¼å°è¿äºæ´æ°æä½ç¼å­å¨change bufferä¸­ï¼è¿æ ·å°±ä¸éè¦ä»ç£çä¸­è¯»å¥è¿ä¸ªæ°æ®é¡µäºï¼å¨åç»­çæ¥è¯¢ä¸­åå°è¿äºæä½åºç¨å°ç£çä¸çæ°æ®é¡µä¸­ãå¨ä¸æ¬¡æ¥è¯¢éè¦è®¿é®è¿ä¸ªæ°æ®é¡µçæ¶åï¼å°æ°æ®é¡µè¯»å¥åå­ï¼ç¶åæ§è¡change bufferä¸­ä¸è¿ä¸ªé¡µæå³çæä½ï¼ä¿è¯æ°æ®é»è¾çæ­£ç¡®æ§ã\n\nå°change bufferä¸­çæä½åºç¨å°åæ°æ®é¡µï¼å¾å°ææ°ç»æçè¿ç¨ç§°ä¸ºmergeãé¤äºè®¿é®è¿ä¸ªæ°æ®é¡µä¼è§¦åmergeå¤ï¼ç³»ç»æåå°çº¿ç¨ä¼å®æmergeãå¨æ°æ®åºæ­£å¸¸å³é­ï¼shutdownï¼çè¿ç¨ä¸­ï¼ ä¹ä¼æ§è¡mergeæä½ã\n\nchange bufferå¯¹æ´æ°è¿ç¨æå éä½ç¨ï¼change bufferåªéäºç¨å¨æ®éç´¢å¼çåºæ¯ä¸ï¼èä¸éç¨äºå¯ä¸ç´¢å¼ã\n\nchange buffer éååå¤è¯»å°çä¸å¡ï¼å ä¸ºé¡µé¢å¨åå®ä»¥åé©¬ä¸è¢«è®¿é®å°çæ¦çæ¯è¾å°ãè¿ç§ä¸å¡æ¨¡åå¸¸è§çå°±æ¯è´¦åç±»ãæ¥å¿ç±»çç³»ç»ã\n\nåè¿æ¥ï¼åè®¾ä¸ä¸ªä¸å¡çæ´æ°æ¨¡å¼æ¯åå¥ä¹åé©¬ä¸ä¼åæ¥è¯¢ï¼é£ä¹å³ä½¿æ»¡è¶³äºæ¡ä»¶ï¼å°æ´æ°åè®°å½å¨change bufferï¼ä½ä¹åç±äºé©¬ä¸è¦è®¿é®è¿ä¸ªæ°æ®é¡µï¼ä¼ç«å³è§¦åmergeè¿ç¨ãè¿æ ·éæºè®¿é® ioçæ¬¡æ°ä¸ä¼åå°ï¼åèå¢å äºchange bufferçç»´æ¤ä»£ä»·ãæä»¥ï¼å¯¹äºè¿ç§ä¸å¡æ¨¡å¼æ¥è¯´ï¼change bufferåèèµ·å°äºå¯ä½ç¨ã\n\n\n# ç´¢å¼ç¸å³sql\n\n# æ¥çç´¢å¼\nshow index from <tablename> [from <databasename>]\n\n# åå»ºç´¢å¼\n1.è¯¥è¯­å¥ä¸è½åå»ºä¸»é®\ncreate <ç´¢å¼å> on <è¡¨å> (<åå> [<é¿åº¦>] [asc | desc])\n\n2.å¨åå»ºè¡¨æ¶åå»ºï¼å¨create tableè¯­å¥ä¸­æ·»å \nconstraint primary key [ç´¢å¼ç±»å] (<åå>...)\nkey | index [<ç´¢å¼å>] (<åå>...)\n\n3.å¨alter tableä¸­æ·»å \nadd primary key [ç´¢å¼ç±»å] (<åå>...)\nadd index [<ç´¢å¼å>] (<åå>...)\nadd unique [ index | key] [<ç´¢å¼å>] [<ç´¢å¼ç±»å>] (<åå>,â¦)\n\nå®æ´sqlï¼\ncreate index <indexname> on <tablename> (<columnname>)\nalter table <tablename> add index <indexname> (<columnname>)\n\n\n\n# b+ æ ç´¢å¼\n\nç´¢å¼æ¯å¨å­å¨å¼æå±å®ç°çï¼èä¸æ¯å¨æå¡å¨å±å®ç°çï¼æä»¥ä¸åå­å¨å¼æå·æä¸åçç´¢å¼ç±»ååå®ç°ã\n\nb+ æ ç´¢å¼æ¯å¤§å¤æ° mysql å­å¨å¼æçé»è®¤ç´¢å¼ç±»åã\n\nb ä»£è¡¨ balanceï¼b+ æ æ¯å¹³è¡¡å¤è·¯æ¥æ¾æ ãb+ æ ä¸­ï¼ææè®°å½èç¹é½æ¯æé®å¼å¤§å°é¡ºåºå­æ¾å¨åä¸å±çå¶å­èç¹ä¸ï¼åå¶å­èç¹éè¿æéè¿è¡ç¸è¿ã\n\nb+æ æ¯é«åº¦å¹³è¡¡çï¼å¶å­èç¹å­æ¾çææçæ°æ®ãå¹¶ä¸ææå¶å­èç¹ä½äºåä¸å±ã\n\nb+ tree æ¯åºäº b tree åå¶å­èç¹é¡ºåºè®¿é®æéè¿è¡å®ç°ï¼å®å·æ b tree çå¹³è¡¡æ§ï¼å¹¶ä¸éè¿é¡ºåºè®¿é®æéæ¥æé«åºé´æ¥è¯¢çæ§è½ã\n\nå¨æ°æ®åºä¸­ï¼b+ æ é«åº¦ä¸è¬å¨ 2~4 å±ï¼å³æ¥è¯¢æä¸é®å¼çè¡è®°å½æå¤åªé 2~4 æ¬¡ ioãä¸è¬æºæ¢°ç£çæ¯ç§å¯ä»¥å100æ¬¡ioï¼2~4 æ¬¡ioåªé0.02~0.04ç§ã\n\nb+ æ ç´¢å¼å¯ä»¥åä¸ºèéç´¢å¼ï¼clustered indexï¼åè¾å©ç´¢å¼ï¼secondary indexï¼ä¹å«éèéç´¢å¼ï¼ãä½ä¸ç®¡æ¯èéè¿æ¯è¾å©ç´¢å¼ï¼åºå±é½æ¯b+æ ãåºå«å¨äºï¼å¶å­èç¹å­æ¾çæ¯å¦æ¯ä¸æ´è¡çæ°æ®ã\n\nèéç´¢å¼çä¼ç¹å¨äºï¼å¯¹ä¸»é®çæåºæ¥æ¾åèå´æ¥æ¾éåº¦éå¸¸å¿«ã\n\nè¾å©ç´¢å¼çå¶å­èç¹ä¸åå«è¡è®°å½çææä¿¡æ¯ï¼åªåå«é®å¼åå¯¹åºè¡æ°æ®çèéç´¢å¼é®ã\n\n\næä½ï¼\n\nè¿è¡æ¥æ¾æä½æ¶ï¼é¦åå¨æ ¹èç¹è¿è¡äºåæ¥æ¾ï¼æ¾å°ä¸ä¸ª key æå¨çæéï¼ç¶åéå½å°å¨æéææåçèç¹è¿è¡æ¥æ¾ãç´å°æ¥æ¾å°å¶å­èç¹ï¼ç¶åå¨å¶å­èç¹ä¸è¿è¡äºåæ¥æ¾ï¼æ¾åº key æå¯¹åºç dataã\n\næå¥å é¤æä½è®°å½ä¼ç ´åå¹³è¡¡æ çå¹³è¡¡æ§ï¼å æ­¤å¨æå¥å é¤æä½ä¹åï¼éè¦å¯¹æ è¿è¡ä¸ä¸ªåè£ãåå¹¶ãæè½¬ç­æä½æ¥ç»´æ¤å¹³è¡¡æ§ã\n\n\n# bæ åb+æ çå¯¹æ¯\n\nb+ æ å¨bæ çåºç¡ä¸ï¼ä¸ºå¶å­èç¹å¢å äºé¾è¡¨æéï¼æææ°æ®é½å­å¨å¨å¶å­èç¹ãéå¶å­èç¹ä½ä¸ºå¶å­èç¹çç´¢å¼ã\n\nb+ æ ç¸å¯¹äº bæ çä¼å¿å¨äºï¼\n\n * åªæå¶å­èç¹å­å¨æ°æ®ï¼åä¸èç¹å¯ä»¥å­å¨çåç´ å°±æ´å¤äºï¼ä½¿å¾æ¥è¯¢çioæ¬¡æ°æ´å°ï¼å æ­¤æ´éååä¸ºæ°æ®åºåºå±æ°æ®ç»æã\n * ææçå¶å­èç¹å½¢æäºä¸ä¸ªæåºé¾è¡¨ï¼æ´å ä¾¿äºæ¥æ¾ã\n * b+æ æ¯ærange-query(åºé´æ¥è¯¢)éå¸¸æ¹ä¾¿ï¼èbæ ä¸æ¯æã\n\n\n# b+æ åçº¢é»æ çå¯¹æ¯\n\nçº¢é»æ ç­å¹³è¡¡æ ä¹å¯ä»¥ç¨æ¥å®ç°ç´¢å¼ï¼ä½æ¯æä»¶ç³»ç»åæ°æ®åºç³»ç»æ®ééç¨ b+ tree ä½ä¸ºç´¢å¼ç»æï¼ä¸»è¦æä»¥ä¸ä¸¤ä¸ªåå :\n\n 1. æ´å°çæ¥æ¾æ¬¡æ°\n\nå¹³è¡¡æ æ¥æ¾æä½çæ¶é´å¤æåº¦ç­äºæ é« hï¼èæ é«å¤§è´ä¸º o(h)=o(logdn)ï¼å¶ä¸­ d ä¸ºæ¯ä¸ªèç¹çåºåº¦ã\n\nçº¢é»æ çåºåº¦ä¸º 2ï¼è b+ tree çåºåº¦ä¸è¬é½éå¸¸å¤§ï¼æä»¥çº¢é»æ çæ é« h å¾ææ¾æ¯ b+ tree å¤§éå¸¸å¤ï¼æ£ç´¢çæ¬¡æ°ä¹å°±æ´å¤ã\n\n 2. å©ç¨è®¡ç®æºé¢è¯»ç¹æ§\n\nä¸ºäºåå°ç£ç i/oï¼ç£çå¾å¾ä¸æ¯ä¸¥æ ¼æéè¯»åï¼èæ¯æ¯æ¬¡é½ä¼é¢è¯»ãé¢è¯»è¿ç¨ä¸­ï¼ç£çè¿è¡é¡ºåºè¯»åï¼é¡ºåºè¯»åä¸éè¦è¿è¡ç£çå¯»éï¼å¹¶ä¸åªéè¦å¾ç­çæè½¬æ¶é´ï¼å æ­¤éåº¦ä¼éå¸¸å¿«ã\n\næä½ç³»ç»ä¸è¬å°åå­åç£çåå²æåºæå¤§å°çåï¼æ¯ä¸åç§°ä¸ºä¸é¡µï¼åå­ä¸ç£çä»¥é¡µä¸ºåä½äº¤æ¢æ°æ®ãæ°æ®åºç³»ç»å°ç´¢å¼çä¸ä¸ªèç¹çå¤§å°è®¾ç½®ä¸ºé¡µçå¤§å°ï¼ä½¿å¾ä¸æ¬¡ i/o å°±è½å®å¨è½½å¥ä¸ä¸ªèç¹ï¼å¹¶ä¸å¯ä»¥å©ç¨é¢è¯»ç¹æ§ï¼ç¸é»çèç¹ä¹è½å¤è¢«é¢åè½½å¥ã\n\n\n# è¦çç´¢å¼ï¼covering indexï¼\n\nå³ä»è¾å©ç´¢å¼ä¸­å°±å¯ä»¥æ¥è¯¢å°éè¦çä¿¡æ¯ï¼ä¸éè¦åå»æ¥è¯¢èéç´¢å¼çä¿¡æ¯ï¼åå°äºåè¡¨ï¼åå°äºioã\n\n\n# ç´¢å¼ä¸æ¨ï¼index condition pushdownï¼icpï¼\n\nä¸æ¯æ icp æ¶ï¼å½è¿è¡ç´¢å¼æ¥è¯¢æ¶ï¼é¦åæ ¹æ®ç´¢å¼æ¥æ¾å°è®°å½ï¼åæ ¹æ® where æ¡ä»¶è¿æ»¤è®°å½ãèæ¯æ icpçè¯ï¼å¨ååºç´¢å¼çåæ¶ï¼è¿è¡ where æ¡ä»¶çè¿æ»¤ï¼å³å° where æä½æ¾å¨äºå­å¨å¼æå±ãå¨æäºæ¥è¯¢ä¸ï¼å¯ä»¥å¤§å¤§åå°ä¸å±sqlå±å¯¹è®°å½çç´¢åï¼ä¹åå°äºåè¡¨æ¬¡æ°ã\n\n\n# ç´¢å¼å¤±æå¸¸è§åºæ¯\n\n * è¿åæå·¦åç¼å¹éååãä¾å¦æç´¢å¼index(a,b)ï¼ä½æ¥è¯¢æ¡ä»¶åªæbå­æ®µã\n * å¨ç´¢å¼åä¸åä»»ä½æä½ï¼åæ¬è®¡ç®ãå½æ°ãç±»åè½¬æ¢ç­ã\n * èå´æ¥è¯¢ä½¿èåç´¢å¼åæ­¢å¹éã\n * åå°select*çä½¿ç¨ãé¿åä¸å¿è¦çåè¡¨æä½å¼éï¼å°½éä½¿ç¨è¦çç´¢å¼ã\n * ä½¿ç¨ä¸ç­äºï¼!=ã<>ï¼ï¼ä½¿ç¨oræä½ã\n * å­ç¬¦ä¸²ä¸å åå¼å·ç´¢å¼å¤±æã\n * likeä»¥ééç¬¦å¼å¤´'%abc'ãæ³¨ælike âabc%â æ¯å¯ä»¥èµ°ç´¢å¼çã\n * order by è¿åæå·¦å¹éååï¼å«éç´¢å¼å­æ®µæåºï¼ä¼äº§çæä»¶æåºã\n * group by è¿åæå·¦å¹éååï¼å«éç´¢å¼å­æ®µåç»ï¼ä¼å¯¼è´äº§çä¸´æ¶è¡¨ã\n\n\n# å»ºç´¢å¼çå å¤§åå\n\n * æå·¦åç¼å¹éååï¼éå¸¸éè¦çåå\n   * mysqlä¼ä¸ç´åå³å¹éç´å°éå°èå´æ¥è¯¢(>ã<ãbetweenãlike)å°±åæ­¢å¹éï¼\n   * æ¯å¦a = 1 and b = 2 and c > 3 and d = 4\n     * å¦æå»ºç«(a,b,c,d)é¡ºåºçç´¢å¼ï¼dæ¯ç¨ä¸å°ç´¢å¼çï¼\n     * å¦æå»ºç«(a,b,d,c)çç´¢å¼åé½å¯ä»¥ç¨å°ï¼a,b,dçé¡ºåºå¯ä»¥ä»»æè°æ´ï¼å»ºç«ç´¢å¼æ¶ä»ä»¬ä¸ä¸ªçé¡ºåºï¼\n * =åinå¯ä»¥ä¹±åºï¼\n   * æ¯å¦a = 1 and b = 2 and c = 3 å»ºç«(a,b,c)ç´¢å¼å¯ä»¥ä»»æé¡ºåºï¼\n   * mysqlçæ¥è¯¢ä¼åå¨ä¼å¸®ä½ ä¼åæç´¢å¼å¯ä»¥è¯å«çå½¢å¼ã\n * å°½ééæ©åºååº¦é«çåä½ä¸ºç´¢å¼ï¼\n   * åºååº¦çå¬å¼æ¯count(distinct col)/count(*)ï¼è¡¨ç¤ºå­æ®µä¸éå¤çæ¯ä¾ï¼æ¯ä¾è¶å¤§æä»¬æ«æçè®°å½æ°è¶å°ï¼å¯ä¸é®çåºååº¦æ¯1\n\n\n# åèèµæï¼\n\n * ä¸»é®ä¸å¯ä¸ç´¢å¼çåºå«\n * mysqlèéç´¢å¼åéèéç´¢å¼\n * mysqlç´¢å¼é½æåªäºåç±»ï¼",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"äºå¡",frontmatter:{title:"äºå¡",date:"2023-03-23T22:19:19.000Z",permalink:"/pages/e88566/"},regularPath:"/02.MySQL/03.%E4%BA%8B%E5%8A%A1.html",relativePath:"02.MySQL/03.äºå¡.md",key:"v-d0afba64",path:"/pages/e88566/",headers:[{level:2,title:"äºå¡",slug:"äºå¡",normalizedTitle:"äºå¡",charIndex:2},{level:2,title:"äºå¡çåå¤§ç¹æ§ï¼ACIDï¼",slug:"äºå¡çåå¤§ç¹æ§-acid",normalizedTitle:"äºå¡çåå¤§ç¹æ§ï¼acidï¼",charIndex:52},{level:2,title:"äºå¡çéç¦»çº§å«",slug:"äºå¡çéç¦»çº§å«",normalizedTitle:"äºå¡çéç¦»çº§å«",charIndex:134},{level:3,title:"è®¾ç½®éç¦»çº§å«",slug:"è®¾ç½®éç¦»çº§å«",normalizedTitle:"è®¾ç½®éç¦»çº§å«",charIndex:603},{level:3,title:"èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»",slug:"èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»",normalizedTitle:"èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»",charIndex:256},{level:3,title:"æ³¨æ",slug:"æ³¨æ",normalizedTitle:"æ³¨æ",charIndex:1246},{level:2,title:"æ°æ®åºå¦ä½éè¿ ACID æ¥å®ç°äºå¡",slug:"æ°æ®åºå¦ä½éè¿-acid-æ¥å®ç°äºå¡",normalizedTitle:"æ°æ®åºå¦ä½éè¿ acid æ¥å®ç°äºå¡",charIndex:1569},{level:2,title:"å¦ä½å®ç°4ç§éç¦»çº§å«",slug:"å¦ä½å®ç°4ç§éç¦»çº§å«",normalizedTitle:"å¦ä½å®ç°4ç§éç¦»çº§å«",charIndex:1773}],headersStr:"äºå¡ äºå¡çåå¤§ç¹æ§ï¼ACIDï¼ äºå¡çéç¦»çº§å« è®¾ç½®éç¦»çº§å« èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯» æ³¨æ æ°æ®åºå¦ä½éè¿ ACID æ¥å®ç°äºå¡ å¦ä½å®ç°4ç§éç¦»çº§å«",content:"# äºå¡\n\näºå¡çéä¿è§£éï¼äºå¡æ¯ä¸ç»é»è¾æä½ï¼è¦ä¹é½æ§è¡ï¼è¦ä¹é½ä¸æ§è¡ã\n\nç»å¸ä¾å­ï¼è½¬è´¦ã\n\n\n# äºå¡çåå¤§ç¹æ§ï¼ACIDï¼\n\n * åå­æ§\n * ä¸è´æ§ï¼æ§è¡äºå¡ååï¼æ°æ®ä¿æä¸è´ï¼å¤ä¸ªäºå¡å¯¹åä¸ä¸ªæ°æ®è¯»åçç»ææ¯ç¸åçï¼\n * éç¦»æ§\n * æä¹æ§\n\n\n# äºå¡çéç¦»çº§å«\n\nä¸ºäºè¾¾å°äºå¡çåå¤§ç¹æ§ï¼æ°æ®åºå®ä¹äº4ç§ä¸åçäºå¡éç¦»çº§å«ï¼ç±ä½å°é«ä¾æ¬¡ä¸º\n\nRead uncommittedãRead committedãRepeatable readãSerializableï¼\n\nè¿åä¸ªçº§å«å¯ä»¥éä¸ªè§£å³èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»è¿å ç±»é®é¢ã\n\n * READ-UNCOMMITTED(è¯»åæªæäº¤)ï¼ æä½çéç¦»çº§å«ï¼åè®¸è¯»åå°æªæäº¤çæ°æ®åæ´ï¼å¯è½ä¼å¯¼è´èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»é®é¢ã\n\n * READ-COMMITTED(è¯»åå·²æäº¤)ï¼ åè®¸è¯»åå¹¶åäºå¡å·²ç»æäº¤çæ°æ®ï¼å¯ä»¥é»æ­¢èè¯»ï¼ä½æ¯å¹»è¯»æä¸å¯éå¤è¯»ä»æå¯è½åçã\n\n * REPEATABLE-READ(å¯éå¤è¯»)ï¼ å¯¹åä¸å­æ®µçå¤æ¬¡è¯»åç»æé½æ¯ä¸è´çï¼é¤éæ°æ®æ¯è¢«æ¬èº«äºå¡èªå·±æä¿®æ¹ï¼å¯ä»¥é»æ­¢èè¯»åä¸å¯éå¤è¯»ï¼ä½å¹»è¯»ä»æå¯è½åçã\n\n * SERIALIZABLE(å¯ä¸²è¡å)ï¼ æé«çéç¦»çº§å«ï¼å®å¨æä»ACIDçéç¦»çº§å«ãææçäºå¡ä¾æ¬¡éä¸ªæ§è¡ï¼è¿æ ·äºå¡ä¹é´å°±å®å¨ä¸å¯è½äº§çå¹²æ°ï¼ä¹å°±æ¯è¯´ï¼è¯¥çº§å«å¯ä»¥é²æ­¢èè¯»ãä¸å¯éå¤è¯»ä»¥åå¹»è¯»ã\n\n\n# è®¾ç½®éç¦»çº§å«\n\nè®¾ç½®innodbçäºå¡çº§å«æ¹æ³æ¯ï¼set ä½ç¨å transaction isolation level äºå¡éç¦»çº§å«ï¼ä¾å¦ï¼\n\nSET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}\n\nmysql> set global transaction isolation level read committed; //å¨å±ç\n\nmysql> set session transaction isolation level read committed; //å½åä¼è¯ï¼ä¸ä¸ªcmdçªå£ï¼\n\n\n\n# èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»\n\n * èè¯»(Drity Read)ï¼æä¸ªäºå¡å·²æ´æ°ä¸ä»½æ°æ®ï¼å¦ä¸ä¸ªäºå¡å¨æ­¤æ¶è¯»åäºåä¸ä»½æ°æ®ï¼ç±äºæäºåå ï¼åä¸ä¸ªRollBackäºæä½ï¼ååä¸ä¸ªäºå¡æè¯»åçæ°æ®å°±ä¼æ¯ä¸æ­£ç¡®çã\n * ä¸å¯éå¤è¯»(Non-repeatable read):å¨ä¸ä¸ªäºå¡çä¸¤æ¬¡æ¥è¯¢ä¹ä¸­æ°æ®ä¸ä¸è´ï¼è¿å¯è½æ¯ä¸¤æ¬¡æ¥è¯¢è¿ç¨ä¸­é´æå¥äºä¸ä¸ªäºå¡æ´æ°çåæçæ°æ®ã\n * å¹»è¯»(Phantom Read):å¨ä¸ä¸ªäºå¡çä¸¤æ¬¡æ¥è¯¢ä¸­æ°æ®ç¬æ°ä¸ä¸è´ï¼ä¾å¦æä¸ä¸ªäºå¡æ¥è¯¢äºå å(Row)æ°æ®ï¼èå¦ä¸ä¸ªäºå¡å´å¨æ­¤æ¶æå¥äºæ°çå åæ°æ®ï¼ååçäºå¡å¨æ¥ä¸æ¥çæ¥è¯¢ä¸­ï¼å°±ä¼åç°æå åæ°æ®æ¯å®ååææ²¡æçã\n\n\n# æ³¨æ\n\nMysql é»è®¤éç¨ç REPEATABLE_READéç¦»çº§å« Oracle é»è®¤éç¨ç READ_COMMITTEDéç¦»çº§å«\n\näºå¡éç¦»æºå¶çå®ç°åºäºéæºå¶åå¹¶åè°åº¦ãå¶ä¸­å¹¶åè°åº¦ä½¿ç¨çæ¯MVVCï¼å¤çæ¬å¹¶åæ§å¶ï¼ï¼éè¿ä¿å­ä¿®æ¹çæ§çæ¬ä¿¡æ¯æ¥æ¯æå¹¶åä¸è´æ§è¯»ååæ»ç­ç¹æ§ã\n\nå ä¸ºéç¦»çº§å«è¶ä½ï¼äºå¡è¯·æ±çéè¶å°ï¼æä»¥å¤§é¨åæ°æ®åºç³»ç»çéç¦»çº§å«é½æ¯READ-COMMITTED(è¯»åæäº¤åå®¹):ï¼ä½æ¯ä½ è¦ç¥éçæ¯InnoDB å­å¨å¼æé»è®¤ä½¿ç¨ **REPEATABLE-READï¼å¯éè¯»ï¼**å¹¶ä¸ä¼æä»»ä½æ§è½æå¤±ã\n\nInnoDB å­å¨å¼æå¨ åå¸å¼äºå¡ çæåµä¸ä¸è¬ä¼ç¨å°**SERIALIZABLE(å¯ä¸²è¡å)**éç¦»çº§å«ã\n\n\n# æ°æ®åºå¦ä½éè¿ ACID æ¥å®ç°äºå¡\n\nACIDï¼\n\nAIDæ¯ææ®µï¼Cæ¯ç®çãä¸ºäºä¿è¯æ°æ®ç¶æçä¸è´æ§ï¼éè¦éè¿åå­æ§ãéç¦»æ§ãæä¹æ§æ¥ä¿éã\n\nå®ç°åå­æ§ï¼undo log\n\nå®ç°æä¹æ§ï¼redo log\n\nå®ç°éç¦»æ§ï¼å éåæ­¥ + MVCCã\n\né¿éé¢è¯å®ï¼MySQLæ¯å¦ä½å®ç°ACIDçï¼-mysqlæä¹å®ç°acid\n\næ·±å¥å­¦ä¹ MySQLäºå¡ï¼ACIDç¹æ§çå®ç°åç - ç¼ç¨è¿·æ - åå®¢å­\n\n\n# å¦ä½å®ç°4ç§éç¦»çº§å«\n\næä¾äº3ç§éï¼åéãè¯»éãèå´éã\n\næ ¹æ®å éçä¸åï¼æä¾äºä¸åçéç¦»çº§å«ã\n\nä¸²è¡åï¼å¯¹äºå¡ææè¯»ãåçæ°æ®å¨å ä¸è¯»éãåéåèå´éã\n\nå¯éå¤è¯»ï¼å¯¹äºå¡ææ¶åçæ°æ®å è¯»éååéï¼ä¸ç´å°äºå¡ç»æï¼ä½ä¸å èå´éãå¯è½å¯¼è´å¹»è¯»é®é¢ï¼äºå¡æ§è¡è¿ç¨ä¸­ï¼ä¸¤ä¸ªå®å¨ç¸åçèå´æ¥è¯¢å¾å°ä¸åçç»æï¼ã\n\nè¯»å·²æäº¤ï¼å¯¹äºå¡æ¶åçæ°æ®å çåéä¸ç´æç»­å°äºå¡ç»æï¼å çè¯»éå¨æ¥è¯¢æä½ç»æåä¾¿é©¬ä¸éæ¾ãå¯è½å¯¼è´ä¸å¯éå¤è¯»é®é¢ï¼äºå¡æ§è¡è¿ç¨ä¸­ï¼å¯¹åä¸è¡æ°æ®çä¸¤æ¬¡æ¥è¯¢å¾å°ä¸åç»æï¼ã\n\nè¯»æªæäº¤ï¼å¯¹äºå¡æ¶åçæ°æ®åªå åéï¼ä¸æç»­å°äºå¡ç»æãå¯è½å¯¼è´èè¯»é®é¢ï¼å¨äºå¡æ§è¡è¿ç¨ä¸­ï¼ä¸ä¸ªäºå¡è¯»åå°å¦ä¸ä¸ªäºå¡æªæäº¤çæ°æ®ï¼ã\n\nMVCCï¼multi-version concurrency controlï¼å¤çæ¬å¹¶åæ§å¶\n\néå¯¹ä¸ä¸ªäºå¡è¯»+ä¸ä¸ªäºå¡åçåºæ¯ï¼å¯ä»¥è¿è¡MVCCçæ éä¼åæ¹æ¡ãåªéå¯¹âè¯»+åâåºæ¯ä¼åã\n\nåºæ¬æè·¯ï¼å¯¹æ°æ®åºçä»»ä½ä¿®æ¹é½ä¸ä¼è¦çä¹åçæ°æ®ï¼èæ¯äº§çä¸ä¸ªæ°çå¯æ¬ä¸æ§çæ¬å±å­ï¼ä»¥æ­¤è¾¾å°è¯»åæ¶å¯ä»¥å®å¨ä¸ç¨å éçç®çãçæ¬å¯çè§£ä¸ºæ°æ®åºä¸­æ¯ä¸è¡æ°æ®è®°å½é½å­å¨2ä¸ªçä¸è§çå­æ®µï¼CREATE_VERSIONåDELETE_VERSIONï¼ä¸¤ä¸ªå­æ®µè®°å½çé½æ¯äºå¡IDã\n\n * æå¥æ°æ®æ¶ï¼CREATE_VERSION è®°å½æå¥æ°æ®çäºå¡ IDï¼DELETE_VERSION ä¸ºç©ºã\n * å é¤æ°æ®æ¶ï¼DELETE_VERSION è®°å½å é¤æ°æ®çäºå¡ IDï¼CREATE_VERSION ä¸ºç©ºã\n * ä¿®æ¹æ°æ®æ¶ï¼å°ä¿®æ¹æ°æ®è§ä¸ºâå é¤æ§æ°æ®ï¼æå¥æ°æ°æ®âçç»åï¼å³åå°åææ°æ®å¤å¶ä¸ä»½ï¼åææ°æ®ç DELETE_VERSION è®°å½ä¿®æ¹æ°æ®çäºå¡ IDï¼CREATE_VERSION ä¸ºç©ºãå¤å¶åºæ¥çæ°æ°æ®ç CREATE_VERSION è®°å½ä¿®æ¹æ°æ®çäºå¡ IDï¼DELETE_VERSION ä¸ºç©ºã\n\næ­¤æ¶ï¼å¦æå¦å¤ä¸ä¸ªäºå¡è¦è¯»åè¿äºåçäºååçæ°æ®ï¼å°æ ¹æ®éç¦»çº§å«æ¥å³å®å°åºåºè¯¥è¯»ååªä¸ªçæ¬çæ°æ®ã\n\n * éç¦»çº§å«æ¯å¯éå¤è¯»ï¼æ»æ¯è¯»å CREATE_VERSION å°äºæç­äºå½åäºå¡ ID çè®°å½ï¼å¨è¿ä¸ªåæä¸ï¼å¦ææ°æ®ä»æå¤ä¸ªçæ¬ï¼ååææ°ï¼äºå¡ ID æå¤§ï¼çã\n * éç¦»çº§å«æ¯è¯»å·²æäº¤ï¼æ»æ¯åææ°ççæ¬å³å¯ï¼å³æè¿è¢« Commit çé£ä¸ªçæ¬çæ°æ®è®°å½ã\n\nå¦å¤ä¸¤ä¸ªéç¦»çº§å«é½æ²¡æå¿è¦ç¨å° MVCCï¼å ä¸ºè¯»æªæäº¤ç´æ¥ä¿®æ¹åå§æ°æ®å³å¯ï¼å¶ä»äºå¡æ¥çæ°æ®çæ¶åç«å»å¯ä»¥çå°ï¼æ ¹æ¬æ é¡»çæ¬å­æ®µãå¯ä¸²è¡åæ¬æ¥çè¯­ä¹å°±æ¯è¦é»å¡å¶ä»äºå¡çè¯»åæä½ï¼è MVCC æ¯åè¯»åæ¶æ éä¼åçï¼èªç¶å°±ä¸ä¼æ¾å°ä¸èµ·ç¨ã",normalizedContent:"# äºå¡\n\näºå¡çéä¿è§£éï¼äºå¡æ¯ä¸ç»é»è¾æä½ï¼è¦ä¹é½æ§è¡ï¼è¦ä¹é½ä¸æ§è¡ã\n\nç»å¸ä¾å­ï¼è½¬è´¦ã\n\n\n# äºå¡çåå¤§ç¹æ§ï¼acidï¼\n\n * åå­æ§\n * ä¸è´æ§ï¼æ§è¡äºå¡ååï¼æ°æ®ä¿æä¸è´ï¼å¤ä¸ªäºå¡å¯¹åä¸ä¸ªæ°æ®è¯»åçç»ææ¯ç¸åçï¼\n * éç¦»æ§\n * æä¹æ§\n\n\n# äºå¡çéç¦»çº§å«\n\nä¸ºäºè¾¾å°äºå¡çåå¤§ç¹æ§ï¼æ°æ®åºå®ä¹äº4ç§ä¸åçäºå¡éç¦»çº§å«ï¼ç±ä½å°é«ä¾æ¬¡ä¸º\n\nread uncommittedãread committedãrepeatable readãserializableï¼\n\nè¿åä¸ªçº§å«å¯ä»¥éä¸ªè§£å³èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»è¿å ç±»é®é¢ã\n\n * read-uncommitted(è¯»åæªæäº¤)ï¼ æä½çéç¦»çº§å«ï¼åè®¸è¯»åå°æªæäº¤çæ°æ®åæ´ï¼å¯è½ä¼å¯¼è´èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»é®é¢ã\n\n * read-committed(è¯»åå·²æäº¤)ï¼ åè®¸è¯»åå¹¶åäºå¡å·²ç»æäº¤çæ°æ®ï¼å¯ä»¥é»æ­¢èè¯»ï¼ä½æ¯å¹»è¯»æä¸å¯éå¤è¯»ä»æå¯è½åçã\n\n * repeatable-read(å¯éå¤è¯»)ï¼ å¯¹åä¸å­æ®µçå¤æ¬¡è¯»åç»æé½æ¯ä¸è´çï¼é¤éæ°æ®æ¯è¢«æ¬èº«äºå¡èªå·±æä¿®æ¹ï¼å¯ä»¥é»æ­¢èè¯»åä¸å¯éå¤è¯»ï¼ä½å¹»è¯»ä»æå¯è½åçã\n\n * serializable(å¯ä¸²è¡å)ï¼ æé«çéç¦»çº§å«ï¼å®å¨æä»acidçéç¦»çº§å«ãææçäºå¡ä¾æ¬¡éä¸ªæ§è¡ï¼è¿æ ·äºå¡ä¹é´å°±å®å¨ä¸å¯è½äº§çå¹²æ°ï¼ä¹å°±æ¯è¯´ï¼è¯¥çº§å«å¯ä»¥é²æ­¢èè¯»ãä¸å¯éå¤è¯»ä»¥åå¹»è¯»ã\n\n\n# è®¾ç½®éç¦»çº§å«\n\nè®¾ç½®innodbçäºå¡çº§å«æ¹æ³æ¯ï¼set ä½ç¨å transaction isolation level äºå¡éç¦»çº§å«ï¼ä¾å¦ï¼\n\nset [session | global] transaction isolation level {read uncommitted | read committed | repeatable read | serializable}\n\nmysql> set global transaction isolation level read committed; //å¨å±ç\n\nmysql> set session transaction isolation level read committed; //å½åä¼è¯ï¼ä¸ä¸ªcmdçªå£ï¼\n\n\n\n# èè¯»ãä¸å¯éå¤è¯»ãå¹»è¯»\n\n * èè¯»(drity read)ï¼æä¸ªäºå¡å·²æ´æ°ä¸ä»½æ°æ®ï¼å¦ä¸ä¸ªäºå¡å¨æ­¤æ¶è¯»åäºåä¸ä»½æ°æ®ï¼ç±äºæäºåå ï¼åä¸ä¸ªrollbackäºæä½ï¼ååä¸ä¸ªäºå¡æè¯»åçæ°æ®å°±ä¼æ¯ä¸æ­£ç¡®çã\n * ä¸å¯éå¤è¯»(non-repeatable read):å¨ä¸ä¸ªäºå¡çä¸¤æ¬¡æ¥è¯¢ä¹ä¸­æ°æ®ä¸ä¸è´ï¼è¿å¯è½æ¯ä¸¤æ¬¡æ¥è¯¢è¿ç¨ä¸­é´æå¥äºä¸ä¸ªäºå¡æ´æ°çåæçæ°æ®ã\n * å¹»è¯»(phantom read):å¨ä¸ä¸ªäºå¡çä¸¤æ¬¡æ¥è¯¢ä¸­æ°æ®ç¬æ°ä¸ä¸è´ï¼ä¾å¦æä¸ä¸ªäºå¡æ¥è¯¢äºå å(row)æ°æ®ï¼èå¦ä¸ä¸ªäºå¡å´å¨æ­¤æ¶æå¥äºæ°çå åæ°æ®ï¼ååçäºå¡å¨æ¥ä¸æ¥çæ¥è¯¢ä¸­ï¼å°±ä¼åç°æå åæ°æ®æ¯å®ååææ²¡æçã\n\n\n# æ³¨æ\n\nmysql é»è®¤éç¨ç repeatable_readéç¦»çº§å« oracle é»è®¤éç¨ç read_committedéç¦»çº§å«\n\näºå¡éç¦»æºå¶çå®ç°åºäºéæºå¶åå¹¶åè°åº¦ãå¶ä¸­å¹¶åè°åº¦ä½¿ç¨çæ¯mvvcï¼å¤çæ¬å¹¶åæ§å¶ï¼ï¼éè¿ä¿å­ä¿®æ¹çæ§çæ¬ä¿¡æ¯æ¥æ¯æå¹¶åä¸è´æ§è¯»ååæ»ç­ç¹æ§ã\n\nå ä¸ºéç¦»çº§å«è¶ä½ï¼äºå¡è¯·æ±çéè¶å°ï¼æä»¥å¤§é¨åæ°æ®åºç³»ç»çéç¦»çº§å«é½æ¯read-committed(è¯»åæäº¤åå®¹):ï¼ä½æ¯ä½ è¦ç¥éçæ¯innodb å­å¨å¼æé»è®¤ä½¿ç¨ **repeatable-readï¼å¯éè¯»ï¼**å¹¶ä¸ä¼æä»»ä½æ§è½æå¤±ã\n\ninnodb å­å¨å¼æå¨ åå¸å¼äºå¡ çæåµä¸ä¸è¬ä¼ç¨å°**serializable(å¯ä¸²è¡å)**éç¦»çº§å«ã\n\n\n# æ°æ®åºå¦ä½éè¿ acid æ¥å®ç°äºå¡\n\nacidï¼\n\naidæ¯ææ®µï¼cæ¯ç®çãä¸ºäºä¿è¯æ°æ®ç¶æçä¸è´æ§ï¼éè¦éè¿åå­æ§ãéç¦»æ§ãæä¹æ§æ¥ä¿éã\n\nå®ç°åå­æ§ï¼undo log\n\nå®ç°æä¹æ§ï¼redo log\n\nå®ç°éç¦»æ§ï¼å éåæ­¥ + mvccã\n\né¿éé¢è¯å®ï¼mysqlæ¯å¦ä½å®ç°acidçï¼-mysqlæä¹å®ç°acid\n\næ·±å¥å­¦ä¹ mysqläºå¡ï¼acidç¹æ§çå®ç°åç - ç¼ç¨è¿·æ - åå®¢å­\n\n\n# å¦ä½å®ç°4ç§éç¦»çº§å«\n\næä¾äº3ç§éï¼åéãè¯»éãèå´éã\n\næ ¹æ®å éçä¸åï¼æä¾äºä¸åçéç¦»çº§å«ã\n\nä¸²è¡åï¼å¯¹äºå¡ææè¯»ãåçæ°æ®å¨å ä¸è¯»éãåéåèå´éã\n\nå¯éå¤è¯»ï¼å¯¹äºå¡ææ¶åçæ°æ®å è¯»éååéï¼ä¸ç´å°äºå¡ç»æï¼ä½ä¸å èå´éãå¯è½å¯¼è´å¹»è¯»é®é¢ï¼äºå¡æ§è¡è¿ç¨ä¸­ï¼ä¸¤ä¸ªå®å¨ç¸åçèå´æ¥è¯¢å¾å°ä¸åçç»æï¼ã\n\nè¯»å·²æäº¤ï¼å¯¹äºå¡æ¶åçæ°æ®å çåéä¸ç´æç»­å°äºå¡ç»æï¼å çè¯»éå¨æ¥è¯¢æä½ç»æåä¾¿é©¬ä¸éæ¾ãå¯è½å¯¼è´ä¸å¯éå¤è¯»é®é¢ï¼äºå¡æ§è¡è¿ç¨ä¸­ï¼å¯¹åä¸è¡æ°æ®çä¸¤æ¬¡æ¥è¯¢å¾å°ä¸åç»æï¼ã\n\nè¯»æªæäº¤ï¼å¯¹äºå¡æ¶åçæ°æ®åªå åéï¼ä¸æç»­å°äºå¡ç»æãå¯è½å¯¼è´èè¯»é®é¢ï¼å¨äºå¡æ§è¡è¿ç¨ä¸­ï¼ä¸ä¸ªäºå¡è¯»åå°å¦ä¸ä¸ªäºå¡æªæäº¤çæ°æ®ï¼ã\n\nmvccï¼multi-version concurrency controlï¼å¤çæ¬å¹¶åæ§å¶\n\néå¯¹ä¸ä¸ªäºå¡è¯»+ä¸ä¸ªäºå¡åçåºæ¯ï¼å¯ä»¥è¿è¡mvccçæ éä¼åæ¹æ¡ãåªéå¯¹âè¯»+åâåºæ¯ä¼åã\n\nåºæ¬æè·¯ï¼å¯¹æ°æ®åºçä»»ä½ä¿®æ¹é½ä¸ä¼è¦çä¹åçæ°æ®ï¼èæ¯äº§çä¸ä¸ªæ°çå¯æ¬ä¸æ§çæ¬å±å­ï¼ä»¥æ­¤è¾¾å°è¯»åæ¶å¯ä»¥å®å¨ä¸ç¨å éçç®çãçæ¬å¯çè§£ä¸ºæ°æ®åºä¸­æ¯ä¸è¡æ°æ®è®°å½é½å­å¨2ä¸ªçä¸è§çå­æ®µï¼create_versionådelete_versionï¼ä¸¤ä¸ªå­æ®µè®°å½çé½æ¯äºå¡idã\n\n * æå¥æ°æ®æ¶ï¼create_version è®°å½æå¥æ°æ®çäºå¡ idï¼delete_version ä¸ºç©ºã\n * å é¤æ°æ®æ¶ï¼delete_version è®°å½å é¤æ°æ®çäºå¡ idï¼create_version ä¸ºç©ºã\n * ä¿®æ¹æ°æ®æ¶ï¼å°ä¿®æ¹æ°æ®è§ä¸ºâå é¤æ§æ°æ®ï¼æå¥æ°æ°æ®âçç»åï¼å³åå°åææ°æ®å¤å¶ä¸ä»½ï¼åææ°æ®ç delete_version è®°å½ä¿®æ¹æ°æ®çäºå¡ idï¼create_version ä¸ºç©ºãå¤å¶åºæ¥çæ°æ°æ®ç create_version è®°å½ä¿®æ¹æ°æ®çäºå¡ idï¼delete_version ä¸ºç©ºã\n\næ­¤æ¶ï¼å¦æå¦å¤ä¸ä¸ªäºå¡è¦è¯»åè¿äºåçäºååçæ°æ®ï¼å°æ ¹æ®éç¦»çº§å«æ¥å³å®å°åºåºè¯¥è¯»ååªä¸ªçæ¬çæ°æ®ã\n\n * éç¦»çº§å«æ¯å¯éå¤è¯»ï¼æ»æ¯è¯»å create_version å°äºæç­äºå½åäºå¡ id çè®°å½ï¼å¨è¿ä¸ªåæä¸ï¼å¦ææ°æ®ä»æå¤ä¸ªçæ¬ï¼ååææ°ï¼äºå¡ id æå¤§ï¼çã\n * éç¦»çº§å«æ¯è¯»å·²æäº¤ï¼æ»æ¯åææ°ççæ¬å³å¯ï¼å³æè¿è¢« commit çé£ä¸ªçæ¬çæ°æ®è®°å½ã\n\nå¦å¤ä¸¤ä¸ªéç¦»çº§å«é½æ²¡æå¿è¦ç¨å° mvccï¼å ä¸ºè¯»æªæäº¤ç´æ¥ä¿®æ¹åå§æ°æ®å³å¯ï¼å¶ä»äºå¡æ¥çæ°æ®çæ¶åç«å»å¯ä»¥çå°ï¼æ ¹æ¬æ é¡»çæ¬å­æ®µãå¯ä¸²è¡åæ¬æ¥çè¯­ä¹å°±æ¯è¦é»å¡å¶ä»äºå¡çè¯»åæä½ï¼è mvcc æ¯åè¯»åæ¶æ éä¼åçï¼èªç¶å°±ä¸ä¼æ¾å°ä¸èµ·ç¨ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"MySQLä¸­çlog",frontmatter:{title:"MySQLä¸­çlog",date:"2023-03-23T22:23:15.000Z",permalink:"/pages/1d1ed2/"},regularPath:"/02.MySQL/04.MySQL%E4%B8%AD%E7%9A%84log.html",relativePath:"02.MySQL/04.MySQLä¸­çlog.md",key:"v-5ddc1b80",path:"/pages/1d1ed2/",headers:[{level:2,title:"MySQL ä¸­çæ¥å¿åç±»",slug:"mysql-ä¸­çæ¥å¿åç±»",normalizedTitle:"mysql ä¸­çæ¥å¿åç±»",charIndex:2},{level:3,title:"MySQL Server çæ¥å¿åæ¬ï¼",slug:"mysql-server-çæ¥å¿åæ¬",normalizedTitle:"mysql server çæ¥å¿åæ¬ï¼",charIndex:497},{level:3,title:"å­å¨å¼æçæ¥å¿åæ¬ï¼",slug:"å­å¨å¼æçæ¥å¿åæ¬",normalizedTitle:"å­å¨å¼æçæ¥å¿åæ¬ï¼",charIndex:854},{level:2,title:"ä¸ºä»ä¹åªä½¿ç¨bin logæ æ³å®ç°å´©æºæ¢å¤",slug:"ä¸ºä»ä¹åªä½¿ç¨bin-logæ æ³å®ç°å´©æºæ¢å¤",normalizedTitle:"ä¸ºä»ä¹åªä½¿ç¨bin logæ æ³å®ç°å´©æºæ¢å¤",charIndex:1207},{level:2,title:"redo logåbin logçå¯¹æ¯",slug:"redo-logåbin-logçå¯¹æ¯",normalizedTitle:"redo logåbin logçå¯¹æ¯",charIndex:1537},{level:2,title:"redo logæµç¨",slug:"redo-logæµç¨",normalizedTitle:"redo logæµç¨",charIndex:1832},{level:2,title:"Q & A",slug:"q-a",normalizedTitle:"q &amp; a",charIndex:null}],headersStr:"MySQL ä¸­çæ¥å¿åç±» MySQL Server çæ¥å¿åæ¬ï¼ å­å¨å¼æçæ¥å¿åæ¬ï¼ ä¸ºä»ä¹åªä½¿ç¨bin logæ æ³å®ç°å´©æºæ¢å¤ redo logåbin logçå¯¹æ¯ redo logæµç¨ Q & A",content:'# MySQL ä¸­çæ¥å¿åç±»\n\nMySQL ä¸­çæ¥å¿åä¸ºä¸¤ç±»ï¼MySQL Server çæ¥å¿åå­å¨å¼æçæ¥å¿ã\n\nMySQLéç»å¸¸è¯´å°çWALææ¯ï¼WALçå¨ç§°æ¯WriteAhead Loggingï¼å®çå³é®ç¹å°±æ¯ååæ¥å¿ï¼ååç£çã\n\nMySQLæ´ä½æ¥çï¼å¶å®æä¸¤åï¼ä¸åæ¯Serverå±ï¼å®ä¸»è¦åçæ¯MySQLåè½å±é¢çäºæï¼è¿æä¸åæ¯å¼æå±ï¼è´è´£å­å¨ç¸å³çå·ä½äºå®ãredo logæ¯ InnoDBå¼æç¹æçæ¥å¿ï¼èServerå±ä¹æèªå·±çæ¥å¿ï¼ç§°ä¸ºbinlogï¼å½æ¡£æ¥å¿ï¼ã\n\næå¼å§MySQLéå¹¶æ²¡æInnoDBå¼æãMySQLèªå¸¦çå¼ææ¯MyISAMï¼ä½æ¯MyISAMæ²¡æ crash-safeçè½åï¼binlogæ¥å¿åªè½ç¨äºå½æ¡£ãèInnoDBæ¯å¦ä¸ä¸ªå¬å¸ä»¥æä»¶å½¢å¼å¼å¥MySQLçï¼æ¢ç¶åªä¾é binlogæ¯æ²¡æcrash-safeè½åçï¼æä»¥InnoDBä½¿ç¨å¦å¤ä¸å¥æ¥å¿ç³»ç»ï¼ä¹å°±æ¯ redo logæ¥å®ç°crash-safeè½åã\n\næäºredo logï¼InnoDBå°±å¯ä»¥ä¿è¯å³ä½¿æ°æ®åºåçå¼å¸¸éå¯ï¼ä¹åæäº¤çè®°å½é½ä¸ä¼ä¸¢å¤±ï¼è¿ä¸ª è½åç§°ä¸ºcrash-safeã\n\n\n# MySQL Server çæ¥å¿åæ¬ï¼\n\n 1. æ¢æ¥è¯¢æ¥å¿ï¼slow query logï¼ï¼è®°å½æ§è¡æ¶é´è¶è¿éå¼ç SQL è¯­å¥ã\n 2. éè¯¯æ¥å¿ï¼error logï¼ï¼è®°å½ MySQL Server å¨è¿è¡è¿ç¨ä¸­åºç°çéè¯¯ä¿¡æ¯ã\n 3. éç¨æ¥è¯¢æ¥å¿ï¼general query logï¼ï¼è®°å½ææè¿æ¥å° MySQL Server ä¸ç SQL è¯­å¥ã\n 4. äºè¿å¶æ¥å¿ï¼binary log/bin logï¼ï¼è®°å½å¯¹æ°æ®åºçæææ´æ°æä½ï¼åæ¬ INSERTãUPDATE å DELETE ç­è¯­å¥ï¼è®°å½çæ¯SQLè¯­å¥æèè¯­å¥çç»æãbinlog ç¨äºæ°æ®å¤ä»½ãæ¢å¤åå¤å¶ã\n 5. ä¸­ç»§æ¥å¿ï¼relay logï¼ï¼å¨ MySQL ä¸»ä»å¤å¶æ¶æä¸­ï¼è®°å½ä»åºæ¥æ¶å°çäºè¿å¶æ¥å¿ï¼ä»¥ä¾¿åæ­¥ä¸»åºçæ°æ®ã\n\n\n# å­å¨å¼æçæ¥å¿åæ¬ï¼\n\n 1. äºå¡æ¥å¿ï¼transaction logï¼ï¼InnoDB å­å¨å¼æçäºå¡æ¥å¿ï¼ç¨äºå®ç°äºå¡çåå­æ§åæä¹æ§ã\n 2. åæ»æ¥å¿ï¼rollback log/undo logï¼ï¼ç¨äºå®ç°äºå¡çåæ»æä½ï¼åæ¶ä¹æ¯ InnoDB å­å¨å¼æçæ¢å¤æºå¶çä¸é¨åãç¨äºè®°å½äºå¡æ§è¡åçæ°æ®ï¼ä»¥ä¾¿å¨äºå¡åæ»æ¶æ¢å¤æ°æ®çåå§ç¶æãå¨äºå¡æäº¤åï¼undo log ä¸­çæ°æ®å¯ä»¥è¢«å é¤æéç¨ã\n 3. éåæ¥å¿ï¼redo logï¼ï¼ç¨äºä¿è¯æ°æ®åºå¨å´©æºåçæ°æ®ä¸è´æ§åå®æ´æ§ï¼åæ¶ä¹æ¯ InnoDB å­å¨å¼æçæ¢å¤æºå¶çä¸é¨åãç¨äºè®°å½äºå¡æ§è¡çææä¿®æ¹æä½ï¼åæ¬ INSERTãUPDATEãDELETE ç­ãå¨äºå¡æäº¤åï¼redo log è®°å½äºä¿®æ¹çç©çä¿¡æ¯ï¼ä¿è¯äºå¡è½å¤è¢«æ¢å¤ã\n\n\n# ä¸ºä»ä¹åªä½¿ç¨bin logæ æ³å®ç°å´©æºæ¢å¤\n\nBinlog åªè®°å½äºæ°æ®åºçä¿®æ¹æä½ï¼èæ²¡æè®°å½å¯¹åºçæ°æ®å¿«ç§ï¼å æ­¤å¨æ¢å¤æ°æ®æ¶éè¦åæ¢å¤æè¿çä¸æ¬¡æ°æ®å¿«ç§ï¼åä¾æ¬¡æ§è¡ Binlog ä¸­çä¿®æ¹æä½ã\n\nBinlog åªè®°å½äºå·²ç»æäº¤çäºå¡ï¼èæ²¡æè®°å½æªæäº¤çäºå¡ï¼å¦æ MySQL å®ä¾å¨æ§è¡æªæäº¤çäºå¡æ¶å´©æºï¼é£ä¹è¿äºäºå¡ä¸­æåçä¿®æ¹å°±æ æ³éè¿ Binlog è¿è¡æ¢å¤ã\n\nå æ­¤ï¼å¨ MySQL ä¸­ï¼å®ç°å´©æºæ¢å¤åè½éè¦åæ¶ä½¿ç¨ Binlog å InnoDB ç redo logï¼å¶ä¸­ InnoDB ç redo log è®°å½äºæ°æ®åºå¼ææåçä¿®æ¹æä½ï¼åæ¬å·²ç»æäº¤çåæªæäº¤çäºå¡ï¼å¯ä»¥ç¨äºå¨ MySQL å¼å¸¸å´©æºåå¿«éæ¢å¤å°ä¸ä¸ä¸ªç¨³å®ç¶æã\n\n\n# redo logåbin logçå¯¹æ¯\n\nä¸¤ç§æ¥å¿æä»¥ä¸ä¸ç¹ä¸åï¼\n\n 1. redo logæ¯InnoDBå¼æç¹æçï¼binlogæ¯MySQLçServerå±å®ç°çï¼ææå¼æé½å¯ä»¥ä½¿ç¨ã\n 2. redo logæ¯ç©çæ¥å¿ï¼è®°å½çæ¯âå¨æä¸ªæ°æ®é¡µä¸åäºä»ä¹ä¿®æ¹âï¼binlogæ¯é»è¾æ¥å¿ï¼è®°å½çæ¯è¿ä¸ªè¯­å¥çåå§é»è¾ï¼æ¯å¦âç»ID=2è¿ä¸è¡çcå­æ®µå 1 âã ï¼æä»¥bin log ææ æ³å®ç°crash-safeï¼\n 3. redo logæ¯å¾ªç¯åçï¼ç©ºé´åºå®ä¼ç¨å®ï¼binlogæ¯å¯ä»¥è¿½å åå¥çãâè¿½å åâæ¯æbinlogæä»¶åå°ä¸å®å¤§å°åä¼åæ¢å°ä¸ä¸ä¸ªï¼å¹¶ä¸ä¼è¦çä»¥åçæ¥å¿ã\n\n\n# redo logæµç¨\n\nredo logçåå¥ææäºä¸¤ä¸ªæ­¥éª¤ï¼prepareåcommitï¼æ¯"ä¸¤é¶æ®µæäº¤"ã\n\nç¬¬ä¸é¶æ®µï¼é¢æäº¤ï¼Prepareï¼\n\nå½ä¸ä¸ªäºå¡æäº¤æ¶ï¼InnoDB å­å¨å¼æé¦åä¼å°äºå¡æåçä¿®æ¹æä½è®°å½å° redo log ä¸­ï¼è¿ä¸ªè¿ç¨ç§°ä¸ºé¢æäº¤ï¼Prepareï¼ãå¨é¢æäº¤é¶æ®µï¼InnoDB å°ä¿®æ¹æä½åå¥ redo log ç¼å²åºï¼ä½ä¸ä¼å°ä¿®æ¹æä½åå¥ç£çï¼å æ­¤é¢æäº¤æ¯ä¸ä¸ªå¿«éçæä½ã\n\nç¬¬äºé¶æ®µï¼æ­£å¼æäº¤ï¼Commitï¼\n\nå½é¢æäº¤å®æåï¼InnoDB å­å¨å¼æä¼ç­å¾ MySQL ä¸»çº¿ç¨ååºæäº¤æä»¤ãå¨æ¥æ¶å°æäº¤æä»¤åï¼InnoDB ä¼å° redo log ç¼å²åºä¸­çä¿®æ¹æä½åå¥ç£çï¼è¿ä¸ªè¿ç¨ç§°ä¸ºæ­£å¼æäº¤ï¼Commitï¼ãæ­£å¼æäº¤é¶æ®µæ¯ä¸ä¸ªç¸å¯¹æ¢éçæä½ï¼å ä¸ºéè¦å°ä¿®æ¹æä½åå¥ç£çï¼ç¡®ä¿æ°æ®çæä¹æ§ã\n\nå¨ä¸¤é¶æ®µæäº¤çè¿ç¨ä¸­ï¼å¦æé¢æäº¤æåä½å¨æ­£å¼æäº¤ååçäºæéï¼æ¯å¦ MySQL æå¡å¨å´©æºæèæ­çµç­ï¼é£ä¹ InnoDB å­å¨å¼æå¨å¯å¨æ¶ä¼æ£æ¥ redo log ä¸­æªæäº¤çäºå¡ï¼å¹¶å°è¿äºæªæäº¤çäºå¡è¿è¡åæ»ï¼ä»¥ä¿è¯æ°æ®çä¸è´æ§ãå æ­¤ï¼å¨ InnoDB å­å¨å¼æä¸­ï¼redo log çä¸¤é¶æ®µæäº¤ä¿è¯äºäºå¡çåå­æ§åæä¹æ§ã\n\n\nå½ä¸ä¸ªäºå¡æäº¤æ¶ï¼InnoDB é¦åå°ä¿®æ¹æä½åå¥ redo log ä¸­ï¼ç¶ååå°è¿ä¸ªäºå¡çæäº¤æä½è®°å½å° Binlog ä¸­ã\n\n\n# Q & A\n\nQï¼å®æå¨éå¤ä»½çå¨æâåå³äºç³»ç»éè¦æ§ï¼æçæ¯ä¸å¤©ä¸å¤ï¼æçæ¯ä¸å¨ä¸å¤âãé£ä¹å¨ä»ä¹åºæ¯ä¸ï¼ä¸å¤©ä¸å¤ä¼æ¯ä¸å¨ä¸å¤æ´æä¼å¿å¢ï¼æèè¯´ï¼å®å½±åäºè¿ä¸ªæ°æ®åºç³»ç»çåªä¸ªææ ï¼\n\nAï¼ä¸å¤©ä¸å¤ï¼é£ä¹å¦æéè¦æ¢å¤æ°æ®çè¯ï¼åªè¦ä¿è¯å½å¤©çbinlogå®æ´å³å¯ï¼ä¸å¨ä¸å¤çè¯å°±è¦ä¿è¯ä¸å¨çbinlogå®æ´ï¼åæ¶é¢ç¹å¨éå¤ä»½éè¦æ´å¤å­å¨ç©ºé´ï¼å¦ä½éæ©åå³äºä¸å¡çéè¦æ§ï¼å¯¹åºçææ æ¯RTO(ç®æ æ¢å¤æ¶é´)ã',normalizedContent:'# mysql ä¸­çæ¥å¿åç±»\n\nmysql ä¸­çæ¥å¿åä¸ºä¸¤ç±»ï¼mysql server çæ¥å¿åå­å¨å¼æçæ¥å¿ã\n\nmysqléç»å¸¸è¯´å°çwalææ¯ï¼walçå¨ç§°æ¯writeahead loggingï¼å®çå³é®ç¹å°±æ¯ååæ¥å¿ï¼ååç£çã\n\nmysqlæ´ä½æ¥çï¼å¶å®æä¸¤åï¼ä¸åæ¯serverå±ï¼å®ä¸»è¦åçæ¯mysqlåè½å±é¢çäºæï¼è¿æä¸åæ¯å¼æå±ï¼è´è´£å­å¨ç¸å³çå·ä½äºå®ãredo logæ¯ innodbå¼æç¹æçæ¥å¿ï¼èserverå±ä¹æèªå·±çæ¥å¿ï¼ç§°ä¸ºbinlogï¼å½æ¡£æ¥å¿ï¼ã\n\næå¼å§mysqléå¹¶æ²¡æinnodbå¼æãmysqlèªå¸¦çå¼ææ¯myisamï¼ä½æ¯myisamæ²¡æ crash-safeçè½åï¼binlogæ¥å¿åªè½ç¨äºå½æ¡£ãèinnodbæ¯å¦ä¸ä¸ªå¬å¸ä»¥æä»¶å½¢å¼å¼å¥mysqlçï¼æ¢ç¶åªä¾é binlogæ¯æ²¡æcrash-safeè½åçï¼æä»¥innodbä½¿ç¨å¦å¤ä¸å¥æ¥å¿ç³»ç»ï¼ä¹å°±æ¯ redo logæ¥å®ç°crash-safeè½åã\n\næäºredo logï¼innodbå°±å¯ä»¥ä¿è¯å³ä½¿æ°æ®åºåçå¼å¸¸éå¯ï¼ä¹åæäº¤çè®°å½é½ä¸ä¼ä¸¢å¤±ï¼è¿ä¸ª è½åç§°ä¸ºcrash-safeã\n\n\n# mysql server çæ¥å¿åæ¬ï¼\n\n 1. æ¢æ¥è¯¢æ¥å¿ï¼slow query logï¼ï¼è®°å½æ§è¡æ¶é´è¶è¿éå¼ç sql è¯­å¥ã\n 2. éè¯¯æ¥å¿ï¼error logï¼ï¼è®°å½ mysql server å¨è¿è¡è¿ç¨ä¸­åºç°çéè¯¯ä¿¡æ¯ã\n 3. éç¨æ¥è¯¢æ¥å¿ï¼general query logï¼ï¼è®°å½ææè¿æ¥å° mysql server ä¸ç sql è¯­å¥ã\n 4. äºè¿å¶æ¥å¿ï¼binary log/bin logï¼ï¼è®°å½å¯¹æ°æ®åºçæææ´æ°æä½ï¼åæ¬ insertãupdate å delete ç­è¯­å¥ï¼è®°å½çæ¯sqlè¯­å¥æèè¯­å¥çç»æãbinlog ç¨äºæ°æ®å¤ä»½ãæ¢å¤åå¤å¶ã\n 5. ä¸­ç»§æ¥å¿ï¼relay logï¼ï¼å¨ mysql ä¸»ä»å¤å¶æ¶æä¸­ï¼è®°å½ä»åºæ¥æ¶å°çäºè¿å¶æ¥å¿ï¼ä»¥ä¾¿åæ­¥ä¸»åºçæ°æ®ã\n\n\n# å­å¨å¼æçæ¥å¿åæ¬ï¼\n\n 1. äºå¡æ¥å¿ï¼transaction logï¼ï¼innodb å­å¨å¼æçäºå¡æ¥å¿ï¼ç¨äºå®ç°äºå¡çåå­æ§åæä¹æ§ã\n 2. åæ»æ¥å¿ï¼rollback log/undo logï¼ï¼ç¨äºå®ç°äºå¡çåæ»æä½ï¼åæ¶ä¹æ¯ innodb å­å¨å¼æçæ¢å¤æºå¶çä¸é¨åãç¨äºè®°å½äºå¡æ§è¡åçæ°æ®ï¼ä»¥ä¾¿å¨äºå¡åæ»æ¶æ¢å¤æ°æ®çåå§ç¶æãå¨äºå¡æäº¤åï¼undo log ä¸­çæ°æ®å¯ä»¥è¢«å é¤æéç¨ã\n 3. éåæ¥å¿ï¼redo logï¼ï¼ç¨äºä¿è¯æ°æ®åºå¨å´©æºåçæ°æ®ä¸è´æ§åå®æ´æ§ï¼åæ¶ä¹æ¯ innodb å­å¨å¼æçæ¢å¤æºå¶çä¸é¨åãç¨äºè®°å½äºå¡æ§è¡çææä¿®æ¹æä½ï¼åæ¬ insertãupdateãdelete ç­ãå¨äºå¡æäº¤åï¼redo log è®°å½äºä¿®æ¹çç©çä¿¡æ¯ï¼ä¿è¯äºå¡è½å¤è¢«æ¢å¤ã\n\n\n# ä¸ºä»ä¹åªä½¿ç¨bin logæ æ³å®ç°å´©æºæ¢å¤\n\nbinlog åªè®°å½äºæ°æ®åºçä¿®æ¹æä½ï¼èæ²¡æè®°å½å¯¹åºçæ°æ®å¿«ç§ï¼å æ­¤å¨æ¢å¤æ°æ®æ¶éè¦åæ¢å¤æè¿çä¸æ¬¡æ°æ®å¿«ç§ï¼åä¾æ¬¡æ§è¡ binlog ä¸­çä¿®æ¹æä½ã\n\nbinlog åªè®°å½äºå·²ç»æäº¤çäºå¡ï¼èæ²¡æè®°å½æªæäº¤çäºå¡ï¼å¦æ mysql å®ä¾å¨æ§è¡æªæäº¤çäºå¡æ¶å´©æºï¼é£ä¹è¿äºäºå¡ä¸­æåçä¿®æ¹å°±æ æ³éè¿ binlog è¿è¡æ¢å¤ã\n\nå æ­¤ï¼å¨ mysql ä¸­ï¼å®ç°å´©æºæ¢å¤åè½éè¦åæ¶ä½¿ç¨ binlog å innodb ç redo logï¼å¶ä¸­ innodb ç redo log è®°å½äºæ°æ®åºå¼ææåçä¿®æ¹æä½ï¼åæ¬å·²ç»æäº¤çåæªæäº¤çäºå¡ï¼å¯ä»¥ç¨äºå¨ mysql å¼å¸¸å´©æºåå¿«éæ¢å¤å°ä¸ä¸ä¸ªç¨³å®ç¶æã\n\n\n# redo logåbin logçå¯¹æ¯\n\nä¸¤ç§æ¥å¿æä»¥ä¸ä¸ç¹ä¸åï¼\n\n 1. redo logæ¯innodbå¼æç¹æçï¼binlogæ¯mysqlçserverå±å®ç°çï¼ææå¼æé½å¯ä»¥ä½¿ç¨ã\n 2. redo logæ¯ç©çæ¥å¿ï¼è®°å½çæ¯âå¨æä¸ªæ°æ®é¡µä¸åäºä»ä¹ä¿®æ¹âï¼binlogæ¯é»è¾æ¥å¿ï¼è®°å½çæ¯è¿ä¸ªè¯­å¥çåå§é»è¾ï¼æ¯å¦âç»id=2è¿ä¸è¡çcå­æ®µå 1 âã ï¼æä»¥bin log ææ æ³å®ç°crash-safeï¼\n 3. redo logæ¯å¾ªç¯åçï¼ç©ºé´åºå®ä¼ç¨å®ï¼binlogæ¯å¯ä»¥è¿½å åå¥çãâè¿½å åâæ¯æbinlogæä»¶åå°ä¸å®å¤§å°åä¼åæ¢å°ä¸ä¸ä¸ªï¼å¹¶ä¸ä¼è¦çä»¥åçæ¥å¿ã\n\n\n# redo logæµç¨\n\nredo logçåå¥ææäºä¸¤ä¸ªæ­¥éª¤ï¼prepareåcommitï¼æ¯"ä¸¤é¶æ®µæäº¤"ã\n\nç¬¬ä¸é¶æ®µï¼é¢æäº¤ï¼prepareï¼\n\nå½ä¸ä¸ªäºå¡æäº¤æ¶ï¼innodb å­å¨å¼æé¦åä¼å°äºå¡æåçä¿®æ¹æä½è®°å½å° redo log ä¸­ï¼è¿ä¸ªè¿ç¨ç§°ä¸ºé¢æäº¤ï¼prepareï¼ãå¨é¢æäº¤é¶æ®µï¼innodb å°ä¿®æ¹æä½åå¥ redo log ç¼å²åºï¼ä½ä¸ä¼å°ä¿®æ¹æä½åå¥ç£çï¼å æ­¤é¢æäº¤æ¯ä¸ä¸ªå¿«éçæä½ã\n\nç¬¬äºé¶æ®µï¼æ­£å¼æäº¤ï¼commitï¼\n\nå½é¢æäº¤å®æåï¼innodb å­å¨å¼æä¼ç­å¾ mysql ä¸»çº¿ç¨ååºæäº¤æä»¤ãå¨æ¥æ¶å°æäº¤æä»¤åï¼innodb ä¼å° redo log ç¼å²åºä¸­çä¿®æ¹æä½åå¥ç£çï¼è¿ä¸ªè¿ç¨ç§°ä¸ºæ­£å¼æäº¤ï¼commitï¼ãæ­£å¼æäº¤é¶æ®µæ¯ä¸ä¸ªç¸å¯¹æ¢éçæä½ï¼å ä¸ºéè¦å°ä¿®æ¹æä½åå¥ç£çï¼ç¡®ä¿æ°æ®çæä¹æ§ã\n\nå¨ä¸¤é¶æ®µæäº¤çè¿ç¨ä¸­ï¼å¦æé¢æäº¤æåä½å¨æ­£å¼æäº¤ååçäºæéï¼æ¯å¦ mysql æå¡å¨å´©æºæèæ­çµç­ï¼é£ä¹ innodb å­å¨å¼æå¨å¯å¨æ¶ä¼æ£æ¥ redo log ä¸­æªæäº¤çäºå¡ï¼å¹¶å°è¿äºæªæäº¤çäºå¡è¿è¡åæ»ï¼ä»¥ä¿è¯æ°æ®çä¸è´æ§ãå æ­¤ï¼å¨ innodb å­å¨å¼æä¸­ï¼redo log çä¸¤é¶æ®µæäº¤ä¿è¯äºäºå¡çåå­æ§åæä¹æ§ã\n\n\nå½ä¸ä¸ªäºå¡æäº¤æ¶ï¼innodb é¦åå°ä¿®æ¹æä½åå¥ redo log ä¸­ï¼ç¶ååå°è¿ä¸ªäºå¡çæäº¤æä½è®°å½å° binlog ä¸­ã\n\n\n# q & a\n\nqï¼å®æå¨éå¤ä»½çå¨æâåå³äºç³»ç»éè¦æ§ï¼æçæ¯ä¸å¤©ä¸å¤ï¼æçæ¯ä¸å¨ä¸å¤âãé£ä¹å¨ä»ä¹åºæ¯ä¸ï¼ä¸å¤©ä¸å¤ä¼æ¯ä¸å¨ä¸å¤æ´æä¼å¿å¢ï¼æèè¯´ï¼å®å½±åäºè¿ä¸ªæ°æ®åºç³»ç»çåªä¸ªææ ï¼\n\naï¼ä¸å¤©ä¸å¤ï¼é£ä¹å¦æéè¦æ¢å¤æ°æ®çè¯ï¼åªè¦ä¿è¯å½å¤©çbinlogå®æ´å³å¯ï¼ä¸å¨ä¸å¤çè¯å°±è¦ä¿è¯ä¸å¨çbinlogå®æ´ï¼åæ¶é¢ç¹å¨éå¤ä»½éè¦æ´å¤å­å¨ç©ºé´ï¼å¦ä½éæ©åå³äºä¸å¡çéè¦æ§ï¼å¯¹åºçææ æ¯rto(ç®æ æ¢å¤æ¶é´)ã',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"MVCCè§£å³å¹»è¯»é®é¢",frontmatter:{title:"MVCCè§£å³å¹»è¯»é®é¢",date:"2023-03-31T23:17:34.000Z",permalink:"/pages/43cd7b/"},regularPath:"/02.MySQL/05.MVCC%E8%A7%A3%E5%86%B3%E5%B9%BB%E8%AF%BB%E9%97%AE%E9%A2%98.html",relativePath:"02.MySQL/05.MVCCè§£å³å¹»è¯»é®é¢.md",key:"v-47a18848",path:"/pages/43cd7b/",headers:[{level:2,title:"å¿«ç§è¯»åå½åè¯»",slug:"å¿«ç§è¯»åå½åè¯»",normalizedTitle:"å¿«ç§è¯»åå½åè¯»",charIndex:583}],headersStr:"å¿«ç§è¯»åå½åè¯»",content:"InnoDB æ¯ MySQL æ°æ®åºä¸­ä¸ç§å¸¸è§çå­å¨å¼æï¼å®ä½¿ç¨ MVCC ææ¯æ¥å®ç°å¹¶åæ§å¶ã\n\nMVCC çæµç¨å¯ä»¥ä¸å®ç¨åº¦ä¸è§£å³å¹»è¯»é®é¢ãå¹»è¯»æ¯æå¨åä¸äºå¡ä¸­ï¼ç¬¬äºæ¬¡è¯»ååæ ·çæ¥è¯¢æ¡ä»¶ï¼å´å¾å°äºä¸åçç»æï¼éå¸¸åçå¨å¹¶åäºå¡ä¸­æå¥æå é¤æ°æ®æ¶ãMVCC ä½¿ç¨å¿«ç§è¯»ï¼Snapshot Readï¼åå½åè¯»ï¼Current Readï¼æ¥é¿åå¹»è¯»é®é¢ã\n\nå¯¹äº InnoDB å¼æï¼MVCC çå®ç°æ¹å¼æ¯éè¿ä½¿ç¨å¤çæ¬æ°æ®è¡æ¥é¿åéç«äºé®é¢ãå·ä½å°ï¼æ¯è¡æ°æ®å¨è¡¨ä¸­å­å¨å¤ä¸ªçæ¬ï¼æ¯ä¸ªçæ¬é½æä¸ä¸ªæ¶é´æ³ï¼ç¨äºè¡¨ç¤ºè¯¥çæ¬çåå»ºæ¶é´ãäºå¡å¨æ§è¡è¯»æä½æ¶ï¼ä¼æ ¹æ®å¶å¯å¨æ¶é´æ¥éæ©ä¸ä¸ªä¸è´æ§è§å¾ï¼Consistent Read Viewï¼ï¼åªè½çå°è¯¥è§å¾ä¸­å·²ç»å­å¨çæ°æ®ï¼å æ­¤å¯ä»¥é¿åå¹»è¯»çé®é¢ã\n\nå¦æå¨>80çèå´åæå¥ä¸æ¡90çæ°æ®ï¼å¨ InnoDB å¼æä¸­ï¼å¦æè¯¥äºå¡ä½¿ç¨çæ¯å¿«ç§è¯»ï¼é£ä¹å®å°çä¸å°è¿æ¡è®°å½ï¼å æ­¤ä¹ä¸ä¼åºç°å¹»è¯»é®é¢ãå¦æè¯¥äºå¡ä½¿ç¨çæ¯å½åè¯»ï¼é£ä¹å®å°ä¼éå®è®°å½ï¼é¿åå¶ä»å¹¶åäºå¡å¯¹è¯¥è®°å½è¿è¡ä¿®æ¹æå é¤æä½ï¼ä»èé¿åå¹»è¯»çé®é¢ã\n\néè¦æ³¨æçæ¯ï¼InnoDB å¼æä¸­ä»ç¶å­å¨ä¸äºç¹æ®æåµä¸å¯è½ä¼åºç°å¹»è¯»é®é¢ï¼ä¾å¦å¨è¯»åä¸äºç¹æ®çç´¢å¼æ¶ãä¸ºäºé¿åè¿äºé®é¢ï¼å¯ä»¥ä½¿ç¨ä¸äºææ¯æ¥æé« MVCC çå¯é æ§ï¼ä¾å¦ä½¿ç¨é´ééï¼Gap Lockï¼æ¥é¿åå¹»è¯»ã\n\n\n# å¿«ç§è¯»åå½åè¯»\n\nå¨æ°æ®åºä¸­ï¼å¿«ç§è¯»åå½åè¯»æ¯ä¸¤ç§ä¸åçè¯»åæ°æ®çæ¹å¼ã\n\nå¿«ç§è¯»æ¯æå¨è¯»åæ°æ®æ¶ï¼è¯»åçæ¯æ°æ®åºå¨äºå¡å¼å§æ¶çä¸ä¸ªå¿«ç§ï¼ä¸ä¼åå°å¶ä»å¹¶åäºå¡çå½±åãå¨ MySQL æ°æ®åºä¸­ï¼å¯ä»¥ä½¿ç¨ SELECT è¯­å¥æ¥è¿è¡å¿«ç§è¯»åï¼ä¾å¦ï¼\n\nSELECT * FROM table_name;\n\n\nå½åè¯»åä¼éå®è®°å½ï¼ä¿è¯å¨å½åäºå¡åè¯»åçæ°æ®æ¯ææ°çãå¨ MySQL æ°æ®åºä¸­ï¼å¦æéè¦è¿è¡å½åè¯»æä½ï¼å¯ä»¥ä½¿ç¨ FOR UPDATE æè FOR SHARE è¯­å¥æ¥è¿è¡éå®ï¼ä¾å¦ï¼\n\nSELECT * FROM table_name WHERE column_name = value FOR UPDATE;\n\n\nå¨ä»¥ä¸è¯­å¥ä¸­ï¼FOR UPDATE è¡¨ç¤ºå¯¹æ¥è¯¢å°çè®°å½è¿è¡æå®éå®ï¼å¶ä»äºå¡ä¸è½ä¿®æ¹æèéå®è¯¥è®°å½ï¼è FOR SHARE åè¡¨ç¤ºå¯¹æ¥è¯¢å°çè®°å½è¿è¡å±äº«éå®ï¼å¶ä»äºå¡ä¸è½ä¿®æ¹è¯¥è®°å½ï¼ä½å¯ä»¥è¯»åè¯¥è®°å½ã\n\néè¦æ³¨æçæ¯ï¼ä¸åçæ°æ®åºç®¡çç³»ç»ä¸­å¯è½å·æä¸åçè¯­æ³æ¥è¿è¡å¿«ç§è¯»æå½åè¯»æä½ï¼å·ä½çå®ç°æ¹å¼å¯è½ä¼ææä¸åã",normalizedContent:"innodb æ¯ mysql æ°æ®åºä¸­ä¸ç§å¸¸è§çå­å¨å¼æï¼å®ä½¿ç¨ mvcc ææ¯æ¥å®ç°å¹¶åæ§å¶ã\n\nmvcc çæµç¨å¯ä»¥ä¸å®ç¨åº¦ä¸è§£å³å¹»è¯»é®é¢ãå¹»è¯»æ¯æå¨åä¸äºå¡ä¸­ï¼ç¬¬äºæ¬¡è¯»ååæ ·çæ¥è¯¢æ¡ä»¶ï¼å´å¾å°äºä¸åçç»æï¼éå¸¸åçå¨å¹¶åäºå¡ä¸­æå¥æå é¤æ°æ®æ¶ãmvcc ä½¿ç¨å¿«ç§è¯»ï¼snapshot readï¼åå½åè¯»ï¼current readï¼æ¥é¿åå¹»è¯»é®é¢ã\n\nå¯¹äº innodb å¼æï¼mvcc çå®ç°æ¹å¼æ¯éè¿ä½¿ç¨å¤çæ¬æ°æ®è¡æ¥é¿åéç«äºé®é¢ãå·ä½å°ï¼æ¯è¡æ°æ®å¨è¡¨ä¸­å­å¨å¤ä¸ªçæ¬ï¼æ¯ä¸ªçæ¬é½æä¸ä¸ªæ¶é´æ³ï¼ç¨äºè¡¨ç¤ºè¯¥çæ¬çåå»ºæ¶é´ãäºå¡å¨æ§è¡è¯»æä½æ¶ï¼ä¼æ ¹æ®å¶å¯å¨æ¶é´æ¥éæ©ä¸ä¸ªä¸è´æ§è§å¾ï¼consistent read viewï¼ï¼åªè½çå°è¯¥è§å¾ä¸­å·²ç»å­å¨çæ°æ®ï¼å æ­¤å¯ä»¥é¿åå¹»è¯»çé®é¢ã\n\nå¦æå¨>80çèå´åæå¥ä¸æ¡90çæ°æ®ï¼å¨ innodb å¼æä¸­ï¼å¦æè¯¥äºå¡ä½¿ç¨çæ¯å¿«ç§è¯»ï¼é£ä¹å®å°çä¸å°è¿æ¡è®°å½ï¼å æ­¤ä¹ä¸ä¼åºç°å¹»è¯»é®é¢ãå¦æè¯¥äºå¡ä½¿ç¨çæ¯å½åè¯»ï¼é£ä¹å®å°ä¼éå®è®°å½ï¼é¿åå¶ä»å¹¶åäºå¡å¯¹è¯¥è®°å½è¿è¡ä¿®æ¹æå é¤æä½ï¼ä»èé¿åå¹»è¯»çé®é¢ã\n\néè¦æ³¨æçæ¯ï¼innodb å¼æä¸­ä»ç¶å­å¨ä¸äºç¹æ®æåµä¸å¯è½ä¼åºç°å¹»è¯»é®é¢ï¼ä¾å¦å¨è¯»åä¸äºç¹æ®çç´¢å¼æ¶ãä¸ºäºé¿åè¿äºé®é¢ï¼å¯ä»¥ä½¿ç¨ä¸äºææ¯æ¥æé« mvcc çå¯é æ§ï¼ä¾å¦ä½¿ç¨é´ééï¼gap lockï¼æ¥é¿åå¹»è¯»ã\n\n\n# å¿«ç§è¯»åå½åè¯»\n\nå¨æ°æ®åºä¸­ï¼å¿«ç§è¯»åå½åè¯»æ¯ä¸¤ç§ä¸åçè¯»åæ°æ®çæ¹å¼ã\n\nå¿«ç§è¯»æ¯æå¨è¯»åæ°æ®æ¶ï¼è¯»åçæ¯æ°æ®åºå¨äºå¡å¼å§æ¶çä¸ä¸ªå¿«ç§ï¼ä¸ä¼åå°å¶ä»å¹¶åäºå¡çå½±åãå¨ mysql æ°æ®åºä¸­ï¼å¯ä»¥ä½¿ç¨ select è¯­å¥æ¥è¿è¡å¿«ç§è¯»åï¼ä¾å¦ï¼\n\nselect * from table_name;\n\n\nå½åè¯»åä¼éå®è®°å½ï¼ä¿è¯å¨å½åäºå¡åè¯»åçæ°æ®æ¯ææ°çãå¨ mysql æ°æ®åºä¸­ï¼å¦æéè¦è¿è¡å½åè¯»æä½ï¼å¯ä»¥ä½¿ç¨ for update æè for share è¯­å¥æ¥è¿è¡éå®ï¼ä¾å¦ï¼\n\nselect * from table_name where column_name = value for update;\n\n\nå¨ä»¥ä¸è¯­å¥ä¸­ï¼for update è¡¨ç¤ºå¯¹æ¥è¯¢å°çè®°å½è¿è¡æå®éå®ï¼å¶ä»äºå¡ä¸è½ä¿®æ¹æèéå®è¯¥è®°å½ï¼è for share åè¡¨ç¤ºå¯¹æ¥è¯¢å°çè®°å½è¿è¡å±äº«éå®ï¼å¶ä»äºå¡ä¸è½ä¿®æ¹è¯¥è®°å½ï¼ä½å¯ä»¥è¯»åè¯¥è®°å½ã\n\néè¦æ³¨æçæ¯ï¼ä¸åçæ°æ®åºç®¡çç³»ç»ä¸­å¯è½å·æä¸åçè¯­æ³æ¥è¿è¡å¿«ç§è¯»æå½åè¯»æä½ï¼å·ä½çå®ç°æ¹å¼å¯è½ä¼ææä¸åã",charsets:{cjk:!0}},{title:"æ°æ®åºä¸èå¼",frontmatter:{title:"æ°æ®åºä¸èå¼",date:"2023-03-31T23:22:19.000Z",permalink:"/pages/9ed061/"},regularPath:"/02.MySQL/06.%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E8%8C%83%E5%BC%8F.html",relativePath:"02.MySQL/06.æ°æ®åºä¸èå¼.md",key:"v-e231d910",path:"/pages/9ed061/",headers:[{level:2,title:"ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå«",slug:"ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå«",normalizedTitle:"ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå«",charIndex:958},{level:3,title:"ç¬¬äºèå¼",slug:"ç¬¬äºèå¼",normalizedTitle:"ç¬¬äºèå¼",charIndex:145},{level:3,title:"ç¬¬ä¸èå¼",slug:"ç¬¬ä¸èå¼",normalizedTitle:"ç¬¬ä¸èå¼",charIndex:520}],headersStr:"ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå« ç¬¬äºèå¼ ç¬¬ä¸èå¼",content:"æ°æ®åºä¸èå¼æ¯å³ç³»åæ°æ®åºè®¾è®¡ä¸­çåºæ¬ååï¼ç¨äºè§èæ°æ®åºä¸­çæ°æ®ç»æï¼é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§ã\n\n * ç¬¬ä¸èå¼ï¼1NFï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªå±æ§å·æåå­æ§ï¼å³ä¸å¯ååè§£ãä¾å¦ï¼ä¸ä¸ªé¡¾å®¢ä¿¡æ¯è¡¨ä¸­ççµè¯å·ç å­æ®µåºè¯¥æ¯åå­çï¼èä¸è½æçµè¯å·ç åæåºå·ãçµè¯å·ç ãåæºå·ç­å¤ä¸ªå­æ®µã\n\n * ç¬¬äºèå¼ï¼2NFï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ãä¹å°±æ¯è¯´ï¼å¦æä¸ä¸ªå³ç³»ä¸­æå¤ä¸ªä¸»é®ï¼åæ¯ä¸ªéä¸»é®å±æ§é½åºè¯¥åè¿äºä¸»é®ç¸å³ï¼èä¸è½åªåå¶ä¸­ä¸é¨åä¸»é®ç¸å³ã\n   \n   * ä¾å¦ï¼åè®¾æä¸ä¸ªå­¦çè¯¾ç¨è¡¨ï¼StudentCoursesï¼å³ç³»ï¼å¶ä¸­åæ¬å­¦çIDãè¯¾ç¨IDãè¯¾ç¨åç§°ãæå¸IDåæå¸å§åç­å­æ®µãå¶ä¸­ï¼å­¦çIDåè¯¾ç¨IDç»æèåä¸»é®ï¼æå¸IDåæå¸å§åä¸è¯¾ç¨IDç¸å³ã\n     \n     æ­¤æ¶ï¼è¯¾ç¨åç§°åæå¸å§åä¸¤ä¸ªå­æ®µé½ä¸å®å¨ä¾èµäºä¸»é®ï¼å ä¸ºå®ä»¬åªåè¯¾ç¨IDç¸å³ï¼èä¸åå­¦çIDç¸å³ãä¸ºäºæ»¡è¶³ç¬¬äºèå¼ï¼åºè¯¥å°æå¸å§åä»StudentCourseså³ç³»ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çæå¸è¡¨ï¼Teachersï¼ï¼å°æå¸IDãæå¸å§åç­å­æ®µæ¾å¥å¶ä¸­ãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ï¼ä¸ä¼åºç°æ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã\n\n * ç¬¬ä¸èå¼ï¼3NFï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ãä¹å°±æ¯è¯´ï¼å¦æä¸ä¸ªéä¸»é®å±æ§ä¾èµäºå¦ä¸ä¸ªéä¸»é®å±æ§ï¼é£ä¹å®åºè¯¥è¢«æåæåç¬çå³ç³»ï¼ä»¥é¿åæ°æ®åä½åä¸ä¸è´æ§ã\n   \n   * ä¾å¦ï¼åè®¾æä¸ä¸ªè®¢åå³ç³»ï¼Ordersï¼ï¼å¶ä¸­åæ¬è®¢åå·ãå®¢æ·IDãå®¢æ·å§åãå®¢æ·å°åç­å­æ®µãæ­¤æ¶ï¼å®¢æ·å§ååå®¢æ·å°åä¸¤ä¸ªå­æ®µä¹é´å­å¨ä¼ éä¾èµï¼å ä¸ºå®ä»¬é½åå®¢æ·IDç¸å³ãä¸ºäºæ»¡è¶³ç¬¬ä¸èå¼ï¼åºè¯¥å°å®¢æ·å§ååå®¢æ·å°åä¸¤ä¸ªå­æ®µä»è®¢åå³ç³»ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çå®¢æ·è¡¨ï¼Customersï¼ï¼å°å®¢æ·IDãå®¢æ·å§åãå®¢æ·å°åç­å­æ®µæ¾å¥å¶ä¸­ãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åä¸ä¸è´æ§çé®é¢ã\n\nä¸èå¼çå®éåºç¨å¯ä»¥æé«æ°æ®åºçæ°æ®å­å¨æçãåå°åä½æ°æ®ï¼ä»èé¿åæ°æ®ä¸ä¸è´çæåµåºç°ãä½æ¯ï¼å¨å®éçæ°æ®åºè®¾è®¡è¿ç¨ä¸­ï¼ææ¶åä¸¥æ ¼éµå¾ªä¸èå¼å¹¶ä¸ä¸å®æ¯æä¼çéæ©ï¼éè¦æ ¹æ®å·ä½æåµè¿è¡æè¡¡ååèãä¾å¦ï¼å¨æäºæ¥è¯¢é¢ç¹çåºæ¯ä¸ï¼å¯è½éè¦éç¨åèå¼è®¾è®¡æ¥æé«æ¥è¯¢æ§è½ã\n\n\n# ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå«\n\nåè®¾æä¸ä¸ªè®¢åè¡¨ï¼Orderï¼åæ¬ä»¥ä¸å­æ®µï¼è®¢åå·ãå®¢æ·å·ãå®¢æ·åç§°ãå®¢æ·å°åãååå·ãåååç§°ãåååä»·ãååæ°éãè®¢åæ»ä»·ãå¶ä¸­ï¼è®¢åå·ä¸ºä¸»é®ã\n\n\n# ç¬¬äºèå¼\n\nå¦ææä»¬å°åååç§°ååååä»·ä¸¤ä¸ªå­æ®µæ¾å¨è®¢åè¡¨ä¸­ï¼é£ä¹ä¼åºç°ä»¥ä¸é®é¢ï¼\n\næ°æ®åä½ï¼å¦æä¸ç§ååè¢«å¤ä¸ªè®¢åä½¿ç¨ï¼é£ä¹å®çåç§°ååä»·å°±ä¼å¨è®¢åè¡¨ä¸­éå¤åºç°ã æ°æ®ä¸ä¸è´ï¼å¦æä¿®æ¹äºä¸ç§ååçåç§°æåä»·ï¼é£ä¹ææä½¿ç¨è¯¥ååçè®¢åä¸­çç¸åºå­æ®µé½éè¦ä¿®æ¹ã ä¸ºäºé¿åè¿äºé®é¢ï¼æä»¬å¯ä»¥å°åååç§°ååååä»·ä»è®¢åè¡¨ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çååè¡¨ï¼Productï¼ï¼åæ¬ååå·ãåååç§°ãåååä»·ç­å­æ®µãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã\n\n\n# ç¬¬ä¸èå¼\n\nå¦ææä»¬å°å®¢æ·åç§°åå®¢æ·å°åä¸¤ä¸ªå­æ®µæ¾å¨è®¢åè¡¨ä¸­ï¼é£ä¹ä¼åºç°ä»¥ä¸é®é¢ï¼\n\næ°æ®åä½ï¼å¦æä¸ä¸ªå®¢æ·å¨å¤ä¸ªè®¢åä¸­ä½¿ç¨ï¼é£ä¹å®çåç§°åå°åå°±ä¼å¨è®¢åè¡¨ä¸­éå¤åºç°ã æ°æ®ä¸ä¸è´ï¼å¦æä¿®æ¹äºä¸ä¸ªå®¢æ·çåç§°æå°åï¼é£ä¹ææä½¿ç¨è¯¥å®¢æ·çè®¢åä¸­çç¸åºå­æ®µé½éè¦ä¿®æ¹ã ä¸ºäºé¿åè¿äºé®é¢ï¼æä»¬å¯ä»¥å°å®¢æ·åç§°åå®¢æ·å°åä»è®¢åè¡¨ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çå®¢æ·è¡¨ï¼Customerï¼ï¼åæ¬å®¢æ·å·ãå®¢æ·åç§°ãå®¢æ·å°åç­å­æ®µãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã",normalizedContent:"æ°æ®åºä¸èå¼æ¯å³ç³»åæ°æ®åºè®¾è®¡ä¸­çåºæ¬ååï¼ç¨äºè§èæ°æ®åºä¸­çæ°æ®ç»æï¼é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§ã\n\n * ç¬¬ä¸èå¼ï¼1nfï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªå±æ§å·æåå­æ§ï¼å³ä¸å¯ååè§£ãä¾å¦ï¼ä¸ä¸ªé¡¾å®¢ä¿¡æ¯è¡¨ä¸­ççµè¯å·ç å­æ®µåºè¯¥æ¯åå­çï¼èä¸è½æçµè¯å·ç åæåºå·ãçµè¯å·ç ãåæºå·ç­å¤ä¸ªå­æ®µã\n\n * ç¬¬äºèå¼ï¼2nfï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ãä¹å°±æ¯è¯´ï¼å¦æä¸ä¸ªå³ç³»ä¸­æå¤ä¸ªä¸»é®ï¼åæ¯ä¸ªéä¸»é®å±æ§é½åºè¯¥åè¿äºä¸»é®ç¸å³ï¼èä¸è½åªåå¶ä¸­ä¸é¨åä¸»é®ç¸å³ã\n   \n   * ä¾å¦ï¼åè®¾æä¸ä¸ªå­¦çè¯¾ç¨è¡¨ï¼studentcoursesï¼å³ç³»ï¼å¶ä¸­åæ¬å­¦çidãè¯¾ç¨idãè¯¾ç¨åç§°ãæå¸idåæå¸å§åç­å­æ®µãå¶ä¸­ï¼å­¦çidåè¯¾ç¨idç»æèåä¸»é®ï¼æå¸idåæå¸å§åä¸è¯¾ç¨idç¸å³ã\n     \n     æ­¤æ¶ï¼è¯¾ç¨åç§°åæå¸å§åä¸¤ä¸ªå­æ®µé½ä¸å®å¨ä¾èµäºä¸»é®ï¼å ä¸ºå®ä»¬åªåè¯¾ç¨idç¸å³ï¼èä¸åå­¦çidç¸å³ãä¸ºäºæ»¡è¶³ç¬¬äºèå¼ï¼åºè¯¥å°æå¸å§åä»studentcourseså³ç³»ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çæå¸è¡¨ï¼teachersï¼ï¼å°æå¸idãæå¸å§åç­å­æ®µæ¾å¥å¶ä¸­ãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ï¼ä¸ä¼åºç°æ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã\n\n * ç¬¬ä¸èå¼ï¼3nfï¼ï¼è¦æ±å³ç³»ä¸­çæ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ãä¹å°±æ¯è¯´ï¼å¦æä¸ä¸ªéä¸»é®å±æ§ä¾èµäºå¦ä¸ä¸ªéä¸»é®å±æ§ï¼é£ä¹å®åºè¯¥è¢«æåæåç¬çå³ç³»ï¼ä»¥é¿åæ°æ®åä½åä¸ä¸è´æ§ã\n   \n   * ä¾å¦ï¼åè®¾æä¸ä¸ªè®¢åå³ç³»ï¼ordersï¼ï¼å¶ä¸­åæ¬è®¢åå·ãå®¢æ·idãå®¢æ·å§åãå®¢æ·å°åç­å­æ®µãæ­¤æ¶ï¼å®¢æ·å§ååå®¢æ·å°åä¸¤ä¸ªå­æ®µä¹é´å­å¨ä¼ éä¾èµï¼å ä¸ºå®ä»¬é½åå®¢æ·idç¸å³ãä¸ºäºæ»¡è¶³ç¬¬ä¸èå¼ï¼åºè¯¥å°å®¢æ·å§ååå®¢æ·å°åä¸¤ä¸ªå­æ®µä»è®¢åå³ç³»ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çå®¢æ·è¡¨ï¼customersï¼ï¼å°å®¢æ·idãå®¢æ·å§åãå®¢æ·å°åç­å­æ®µæ¾å¥å¶ä¸­ãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åä¸ä¸è´æ§çé®é¢ã\n\nä¸èå¼çå®éåºç¨å¯ä»¥æé«æ°æ®åºçæ°æ®å­å¨æçãåå°åä½æ°æ®ï¼ä»èé¿åæ°æ®ä¸ä¸è´çæåµåºç°ãä½æ¯ï¼å¨å®éçæ°æ®åºè®¾è®¡è¿ç¨ä¸­ï¼ææ¶åä¸¥æ ¼éµå¾ªä¸èå¼å¹¶ä¸ä¸å®æ¯æä¼çéæ©ï¼éè¦æ ¹æ®å·ä½æåµè¿è¡æè¡¡ååèãä¾å¦ï¼å¨æäºæ¥è¯¢é¢ç¹çåºæ¯ä¸ï¼å¯è½éè¦éç¨åèå¼è®¾è®¡æ¥æé«æ¥è¯¢æ§è½ã\n\n\n# ä¾å­è¯´æç¬¬äºèå¼åç¬¬ä¸èå¼çåºå«\n\nåè®¾æä¸ä¸ªè®¢åè¡¨ï¼orderï¼åæ¬ä»¥ä¸å­æ®µï¼è®¢åå·ãå®¢æ·å·ãå®¢æ·åç§°ãå®¢æ·å°åãååå·ãåååç§°ãåååä»·ãååæ°éãè®¢åæ»ä»·ãå¶ä¸­ï¼è®¢åå·ä¸ºä¸»é®ã\n\n\n# ç¬¬äºèå¼\n\nå¦ææä»¬å°åååç§°ååååä»·ä¸¤ä¸ªå­æ®µæ¾å¨è®¢åè¡¨ä¸­ï¼é£ä¹ä¼åºç°ä»¥ä¸é®é¢ï¼\n\næ°æ®åä½ï¼å¦æä¸ç§ååè¢«å¤ä¸ªè®¢åä½¿ç¨ï¼é£ä¹å®çåç§°ååä»·å°±ä¼å¨è®¢åè¡¨ä¸­éå¤åºç°ã æ°æ®ä¸ä¸è´ï¼å¦æä¿®æ¹äºä¸ç§ååçåç§°æåä»·ï¼é£ä¹ææä½¿ç¨è¯¥ååçè®¢åä¸­çç¸åºå­æ®µé½éè¦ä¿®æ¹ã ä¸ºäºé¿åè¿äºé®é¢ï¼æä»¬å¯ä»¥å°åååç§°ååååä»·ä»è®¢åè¡¨ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çååè¡¨ï¼productï¼ï¼åæ¬ååå·ãåååç§°ãåååä»·ç­å­æ®µãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½å®å¨ä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã\n\n\n# ç¬¬ä¸èå¼\n\nå¦ææä»¬å°å®¢æ·åç§°åå®¢æ·å°åä¸¤ä¸ªå­æ®µæ¾å¨è®¢åè¡¨ä¸­ï¼é£ä¹ä¼åºç°ä»¥ä¸é®é¢ï¼\n\næ°æ®åä½ï¼å¦æä¸ä¸ªå®¢æ·å¨å¤ä¸ªè®¢åä¸­ä½¿ç¨ï¼é£ä¹å®çåç§°åå°åå°±ä¼å¨è®¢åè¡¨ä¸­éå¤åºç°ã æ°æ®ä¸ä¸è´ï¼å¦æä¿®æ¹äºä¸ä¸ªå®¢æ·çåç§°æå°åï¼é£ä¹ææä½¿ç¨è¯¥å®¢æ·çè®¢åä¸­çç¸åºå­æ®µé½éè¦ä¿®æ¹ã ä¸ºäºé¿åè¿äºé®é¢ï¼æä»¬å¯ä»¥å°å®¢æ·åç§°åå®¢æ·å°åä»è®¢åè¡¨ä¸­æååºæ¥ï¼å»ºç«ä¸ä¸ªæ°çå®¢æ·è¡¨ï¼customerï¼ï¼åæ¬å®¢æ·å·ãå®¢æ·åç§°ãå®¢æ·å°åç­å­æ®µãè¿æ ·ï¼æ¯ä¸ªéä¸»é®å±æ§é½ä¸ä¼ éä¾èµäºä¸»é®ï¼å¯ä»¥é¿åæ°æ®åä½åæ°æ®ä¸ä¸è´æ§çé®é¢ã",charsets:{cjk:!0}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-08-14T17:12:08.000Z",permalink:"/pages/a4281a/"},regularPath:"/02.MySQL/07.MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html",relativePath:"02.MySQL/07.MySQLæ°æ®ç±»å.md",key:"v-5d98fa16",path:"/pages/a4281a/",headersStr:null,content:" * æ´æ°ç±»å\n   * TINYINT\n   * SMALLINT\n   * INT 4ä¸ªå­è\n   * BIGINT 8ä¸ªå­è\n * æµ®ç¹ç±»ååå®ç¹ç±»å\n   * FLOAT\n   * DOUBLE\n   * DECIMAL\n   * æµ®ç¹æ°åå¨æ°æ®åºä¸­å­æ¾çæ¯è¿ä¼¼å¼ï¼èå®ç¹æ°ç±»åå¨æ°æ®åºä¸­å­æ¾çæ¯ç²¾ç¡®å¼ã\n * charç±»ååvarcharç±»å\n   * char\n   * varchar\n   * CHARç±»åæå®äºnä¹åï¼å¦æå­å¥çå­ç¬¦æ°å°äºnï¼åé¢å°ä¼ä»¥ç©ºæ ¼è¡¥é½ï¼æ¥è¯¢çæ¶ååå°æ«å°¾çç©ºæ ¼å»æï¼æä»¥CHARç±»åå­å¨çå­ç¬¦ä¸²æ«å°¾ä¸è½æç©ºæ ¼ï¼VARCHARä¸åæ­¤éå¶ã\n   * CHARç±»åçå­ç¬¦ä¸²æ£ç´¢éåº¦è¦æ¯VARCHARç±»åçå¿«ã\n * textç±»ååblobç±»å\n   * BLOBåTEXTæ¯å¯¹åºçï¼ä¸è¿å­å¨æ¹å¼ä¸åï¼TEXTæ¯ä»¥ææ¬æ¹å¼å­å¨çï¼èBLOBæ¯ä»¥äºè¿å¶æ¹å¼å­å¨çãå¦æå­å¨è±æçè¯ï¼TEXTåºåå¤§å°åï¼èBLOBä¸åºåå¤§å°åãTEXTå¯ä»¥æå®å­ç¬¦éï¼BLOBä¸ç¨æå®å­ç¬¦éã\n   * tinytest, tinyblob\n   * text, blob\n   * mediumtext, mediumblob\n   * longtext, longblob\n * binaryç±»ååvarbinary\n   * BINARYåVARBINARYæ°æ®ç±»åç±»ä¼¼äºCHARåVARCHARãä¸åä¹å¤å¨äºBINARYä¸VARBINARYä½¿ç¨å­èä¸ºå­å¨åä½ï¼èCHARä¸VARCHARä½¿ç¨å­ç¬¦ä¸ºå­å¨åä½ã\n * æ¶é´åæ¥æç±»å\n   * year\n   * time\n   * date\n   * datetime\n   * timestamp\n * enumåsetç±»å\n\nhttps://www.modb.pro/db/50149",normalizedContent:" * æ´æ°ç±»å\n   * tinyint\n   * smallint\n   * int 4ä¸ªå­è\n   * bigint 8ä¸ªå­è\n * æµ®ç¹ç±»ååå®ç¹ç±»å\n   * float\n   * double\n   * decimal\n   * æµ®ç¹æ°åå¨æ°æ®åºä¸­å­æ¾çæ¯è¿ä¼¼å¼ï¼èå®ç¹æ°ç±»åå¨æ°æ®åºä¸­å­æ¾çæ¯ç²¾ç¡®å¼ã\n * charç±»ååvarcharç±»å\n   * char\n   * varchar\n   * charç±»åæå®äºnä¹åï¼å¦æå­å¥çå­ç¬¦æ°å°äºnï¼åé¢å°ä¼ä»¥ç©ºæ ¼è¡¥é½ï¼æ¥è¯¢çæ¶ååå°æ«å°¾çç©ºæ ¼å»æï¼æä»¥charç±»åå­å¨çå­ç¬¦ä¸²æ«å°¾ä¸è½æç©ºæ ¼ï¼varcharä¸åæ­¤éå¶ã\n   * charç±»åçå­ç¬¦ä¸²æ£ç´¢éåº¦è¦æ¯varcharç±»åçå¿«ã\n * textç±»ååblobç±»å\n   * blobåtextæ¯å¯¹åºçï¼ä¸è¿å­å¨æ¹å¼ä¸åï¼textæ¯ä»¥ææ¬æ¹å¼å­å¨çï¼èblobæ¯ä»¥äºè¿å¶æ¹å¼å­å¨çãå¦æå­å¨è±æçè¯ï¼textåºåå¤§å°åï¼èblobä¸åºåå¤§å°åãtextå¯ä»¥æå®å­ç¬¦éï¼blobä¸ç¨æå®å­ç¬¦éã\n   * tinytest, tinyblob\n   * text, blob\n   * mediumtext, mediumblob\n   * longtext, longblob\n * binaryç±»ååvarbinary\n   * binaryåvarbinaryæ°æ®ç±»åç±»ä¼¼äºcharåvarcharãä¸åä¹å¤å¨äºbinaryä¸varbinaryä½¿ç¨å­èä¸ºå­å¨åä½ï¼ècharä¸varcharä½¿ç¨å­ç¬¦ä¸ºå­å¨åä½ã\n * æ¶é´åæ¥æç±»å\n   * year\n   * time\n   * date\n   * datetime\n   * timestamp\n * enumåsetç±»å\n\nhttps://www.modb.pro/db/50149",charsets:{cjk:!0}},{title:"èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢",frontmatter:{title:"èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢",date:"2023-08-24T22:59:28.000Z",permalink:"/pages/c10308/"},regularPath:"/02.MySQL/08.%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98.html",relativePath:"02.MySQL/08.èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢.md",key:"v-2552a92f",path:"/pages/c10308/",headers:[{level:2,title:"èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é",slug:"èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é",normalizedTitle:"èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é",charIndex:2}],headersStr:"èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é",content:"# èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é\n\nä¸ºä»ä¹èå´æ¥è¯¢ä¼ä½¿èåç´¢å¼åæ­¢å¹éï¼\n\næ¶åå°æå·¦åç¼å¹éåçãåè®¾å»ºç«ä¸ä¸ªèåç´¢å¼ index(a, b)ï¼ä¼åå¯¹aè¿è¡æåºï¼å¨aç¸ç­çæåµä¸å¯¹bè¿è¡æåºï¼å¦ä¸å¾æç¤ºãå¨è¯¥ç´¢å¼æ ä¸ï¼aæ¯å¨å±æåºçï¼èbåå¤äºå¨å±æ åºãå±é¨æåºç¶æãä»å¨å±æ¥çï¼bçå¼ä¸º1ã2ã1ã4ã1ã2ï¼åªæ b=2 æ¥è¯¢æ¡ä»¶æ æ³ç´æ¥ä½¿ç¨è¯¥ç´¢å¼ï¼ä»å±é¨æ¥çï¼å½açå¼ç¡®å®æ¶ï¼båæ¯æåºç¶æï¼a=2 && b=4å¯ä»¥ä½¿ç¨è¯¥ç´¢å¼ãæä»¥èå´æ¥è¯¢ä½¿èåç´¢å¼åæ­¢å¹éçæ ¹æ¬åå æ¯ï¼ç´¢å¼æ ä¸éé¦å­æ®µçæåºç¶æä¾èµåä¸ä¸ªå­æ®µç¸ç­æåµï¼èèå´æ¥è¯¢ç ´åäºä¸ä¸ä¸ªç´¢å¼å­æ®µå±é¨æåºç¶æï¼å¯¼è´ç´¢å¼åæ­¢å¹éã\n\n\n\nèåç´¢å¼çæå·¦å¹éååï¼å¨éå°èå´æ¥è¯¢ï¼å¦ >ã<ï¼çæ¶åï¼å°±ä¼åæ­¢å¹éï¼ä¹å°±æ¯èå´æ¥è¯¢çå­æ®µå¯ä»¥ç¨å°èåç´¢å¼ï¼ä½æ¯å¨èå´æ¥è¯¢å­æ®µåé¢çå­æ®µæ æ³ç¨å°èåç´¢å¼ã\n\næ³¨æï¼å¯¹äº >=ã<=ãBETWEENãlike åç¼å¹éçèå´æ¥è¯¢ï¼å¹¶ä¸ä¼åæ­¢å¹éï¼æ¯å ä¸ºå¯¹äºé¨åaç­äºçæ°æ®ï¼bå¯ä»¥èµ°ç´¢å¼å»è¿æ»¤ï¼ã\n\negï¼select * from t_table where a >= 1 and b = 2\n\nè½ç¶å¨ç¬¦å a>= 1 æ¡ä»¶çäºçº§ç´¢å¼è®°å½çèå´éï¼b å­æ®µçå¼æ¯ãæ åºãçï¼ä½æ¯å¯¹äºç¬¦å a = 1 çäºçº§ç´¢å¼è®°å½çèå´éï¼b å­æ®µçå¼æ¯ãæåºãçã\n\näºæ¯ï¼å¨ç¡®å®éè¦æ«æçäºçº§ç´¢å¼çèå´æ¶ï¼å½äºçº§ç´¢å¼è®°å½ç a å­æ®µå¼ä¸º 1 æ¶ï¼å¯ä»¥éè¿ b = 2 æ¡ä»¶åå°éè¦æ«æçäºçº§ç´¢å¼è®°å½èå´ï¼b å­æ®µå¯ä»¥å©ç¨èåç´¢å¼è¿è¡ç´¢å¼æ¥è¯¢çææï¼ã\n\næä»¥ï¼è¿æ¡æ¥è¯¢è¯­å¥ a å b å­æ®µé½ç¨å°äºèåç´¢å¼è¿è¡ç´¢å¼æ¥è¯¢ã\n\nhttps://www.51cto.com/article/720535.html",normalizedContent:"# èå´æ¥è¯¢å¯¼è´èåç´¢å¼åæ­¢å¹é\n\nä¸ºä»ä¹èå´æ¥è¯¢ä¼ä½¿èåç´¢å¼åæ­¢å¹éï¼\n\næ¶åå°æå·¦åç¼å¹éåçãåè®¾å»ºç«ä¸ä¸ªèåç´¢å¼ index(a, b)ï¼ä¼åå¯¹aè¿è¡æåºï¼å¨aç¸ç­çæåµä¸å¯¹bè¿è¡æåºï¼å¦ä¸å¾æç¤ºãå¨è¯¥ç´¢å¼æ ä¸ï¼aæ¯å¨å±æåºçï¼èbåå¤äºå¨å±æ åºãå±é¨æåºç¶æãä»å¨å±æ¥çï¼bçå¼ä¸º1ã2ã1ã4ã1ã2ï¼åªæ b=2 æ¥è¯¢æ¡ä»¶æ æ³ç´æ¥ä½¿ç¨è¯¥ç´¢å¼ï¼ä»å±é¨æ¥çï¼å½açå¼ç¡®å®æ¶ï¼båæ¯æåºç¶æï¼a=2 && b=4å¯ä»¥ä½¿ç¨è¯¥ç´¢å¼ãæä»¥èå´æ¥è¯¢ä½¿èåç´¢å¼åæ­¢å¹éçæ ¹æ¬åå æ¯ï¼ç´¢å¼æ ä¸éé¦å­æ®µçæåºç¶æä¾èµåä¸ä¸ªå­æ®µç¸ç­æåµï¼èèå´æ¥è¯¢ç ´åäºä¸ä¸ä¸ªç´¢å¼å­æ®µå±é¨æåºç¶æï¼å¯¼è´ç´¢å¼åæ­¢å¹éã\n\n\n\nèåç´¢å¼çæå·¦å¹éååï¼å¨éå°èå´æ¥è¯¢ï¼å¦ >ã<ï¼çæ¶åï¼å°±ä¼åæ­¢å¹éï¼ä¹å°±æ¯èå´æ¥è¯¢çå­æ®µå¯ä»¥ç¨å°èåç´¢å¼ï¼ä½æ¯å¨èå´æ¥è¯¢å­æ®µåé¢çå­æ®µæ æ³ç¨å°èåç´¢å¼ã\n\næ³¨æï¼å¯¹äº >=ã<=ãbetweenãlike åç¼å¹éçèå´æ¥è¯¢ï¼å¹¶ä¸ä¼åæ­¢å¹éï¼æ¯å ä¸ºå¯¹äºé¨åaç­äºçæ°æ®ï¼bå¯ä»¥èµ°ç´¢å¼å»è¿æ»¤ï¼ã\n\negï¼select * from t_table where a >= 1 and b = 2\n\nè½ç¶å¨ç¬¦å a>= 1 æ¡ä»¶çäºçº§ç´¢å¼è®°å½çèå´éï¼b å­æ®µçå¼æ¯ãæ åºãçï¼ä½æ¯å¯¹äºç¬¦å a = 1 çäºçº§ç´¢å¼è®°å½çèå´éï¼b å­æ®µçå¼æ¯ãæåºãçã\n\näºæ¯ï¼å¨ç¡®å®éè¦æ«æçäºçº§ç´¢å¼çèå´æ¶ï¼å½äºçº§ç´¢å¼è®°å½ç a å­æ®µå¼ä¸º 1 æ¶ï¼å¯ä»¥éè¿ b = 2 æ¡ä»¶åå°éè¦æ«æçäºçº§ç´¢å¼è®°å½èå´ï¼b å­æ®µå¯ä»¥å©ç¨èåç´¢å¼è¿è¡ç´¢å¼æ¥è¯¢çææï¼ã\n\næä»¥ï¼è¿æ¡æ¥è¯¢è¯­å¥ a å b å­æ®µé½ç¨å°äºèåç´¢å¼è¿è¡ç´¢å¼æ¥è¯¢ã\n\nhttps://www.51cto.com/article/720535.html",charsets:{cjk:!0}},{title:"Explainåæ",frontmatter:{title:"Explainåæ",date:"2023-08-24T23:02:42.000Z",permalink:"/pages/b85e9d/"},regularPath:"/02.MySQL/09.Explain%E5%88%86%E6%9E%90.html",relativePath:"02.MySQL/09.Explainåæ.md",key:"v-273d7455",path:"/pages/b85e9d/",headersStr:null,content:"æ¢æ¥è¯¢çåæç¦»ä¸å¼mysqlçexplainè¯­å¥ï¼explainä¸»è¦å³æ³¨ä¸¤ä¸ªå­æ®µTypeåExtraã\n\nTypeè¡¨ç¤ºè®¿é®æ°æ®çæ¹å¼ï¼Extraè¡¨ç¤ºè¿æ»¤åæ´çæ°æ®çæ¹å¼ã\n\nTYPE                                   EXTRA                      \nALL      å¨è¡¨æ«æ                          Using index                ä½¿ç¨è¦çç´¢å¼ï¼ä¸éè¦åè¡¨ï¼ä¸éè¦Mysqlæå¡å±è¿æ»¤\nindex    ç´¢å¼æ å¨æ«æ                        Using where                ä»å­å¨å¼æå±è·åæ°æ®ï¼å¨Mysqlæå¡å±ç¨whereæ¥è¯¢æ¡ä»¶è¿æ»¤æ°æ®ã\nrange    ç´¢å¼æ èå´æ«æ                       Using where; Using index   ç´¢å¼èå´æ«æãç´¢å¼æ«æåå¨è¡¨æ«æç±»ä¼¼ï¼åªæ¯åççå±é¢ä¸ä¸æ ·ã\nref      éå¯ä¸æ§ç´¢å¼æ«æï¼æ¯å¦éå¯ä¸ç´¢å¼åå¯ä¸ç´¢å¼çéå¯ä¸åç¼   Using index condition      ä½¿ç¨ç´¢å¼ä¸æ¨ï¼å¨å­å¨å¼æå±ååå©ç¨æ¥è¯¢ç´¢å¼å­æ®µè¿æ»¤æ°æ®\neq_ref   å¯ä¸æ§ç´¢å¼æ«æï¼æ¯å¦å¯ä¸ç´¢å¼ãä¸»é®ç´¢å¼           Using temporary            ä¸´æ¶è¡¨å­å¨ç»æï¼ç¨äºæåºååç»æ¥è¯¢\nconst    å°æ¥è¯¢è½¬åæå¸¸é                      Using filesort             æä»¶æåºï¼ç¨äºæåº\nNULL     ä¸ç¨è®¿é®è¡¨æç´¢å¼                      NULL                       åè¡¨\n\n",normalizedContent:"æ¢æ¥è¯¢çåæç¦»ä¸å¼mysqlçexplainè¯­å¥ï¼explainä¸»è¦å³æ³¨ä¸¤ä¸ªå­æ®µtypeåextraã\n\ntypeè¡¨ç¤ºè®¿é®æ°æ®çæ¹å¼ï¼extraè¡¨ç¤ºè¿æ»¤åæ´çæ°æ®çæ¹å¼ã\n\ntype                                   extra                      \nall      å¨è¡¨æ«æ                          using index                ä½¿ç¨è¦çç´¢å¼ï¼ä¸éè¦åè¡¨ï¼ä¸éè¦mysqlæå¡å±è¿æ»¤\nindex    ç´¢å¼æ å¨æ«æ                        using where                ä»å­å¨å¼æå±è·åæ°æ®ï¼å¨mysqlæå¡å±ç¨whereæ¥è¯¢æ¡ä»¶è¿æ»¤æ°æ®ã\nrange    ç´¢å¼æ èå´æ«æ                       using where; using index   ç´¢å¼èå´æ«æãç´¢å¼æ«æåå¨è¡¨æ«æç±»ä¼¼ï¼åªæ¯åççå±é¢ä¸ä¸æ ·ã\nref      éå¯ä¸æ§ç´¢å¼æ«æï¼æ¯å¦éå¯ä¸ç´¢å¼åå¯ä¸ç´¢å¼çéå¯ä¸åç¼   using index condition      ä½¿ç¨ç´¢å¼ä¸æ¨ï¼å¨å­å¨å¼æå±ååå©ç¨æ¥è¯¢ç´¢å¼å­æ®µè¿æ»¤æ°æ®\neq_ref   å¯ä¸æ§ç´¢å¼æ«æï¼æ¯å¦å¯ä¸ç´¢å¼ãä¸»é®ç´¢å¼           using temporary            ä¸´æ¶è¡¨å­å¨ç»æï¼ç¨äºæåºååç»æ¥è¯¢\nconst    å°æ¥è¯¢è½¬åæå¸¸é                      using filesort             æä»¶æåºï¼ç¨äºæåº\nnull     ä¸ç¨è®¿é®è¡¨æç´¢å¼                      null                       åè¡¨\n\n",charsets:{cjk:!0}},{title:"MySQLä¸­çé",frontmatter:{title:"MySQLä¸­çé",date:"2023-09-06T12:17:13.000Z",permalink:"/pages/92d4ca/"},regularPath:"/02.MySQL/10.MySQL%E4%B8%AD%E7%9A%84%E9%94%81.html",relativePath:"02.MySQL/10.MySQLä¸­çé.md",key:"v-d5dc6db4",path:"/pages/92d4ca/",headers:[{level:2,title:"next-key lock",slug:"next-key-lock",normalizedTitle:"next-key lock",charIndex:1139},{level:3,title:"é´ééånext-key lockçå éè§å",slug:"é´ééånext-key-lockçå éè§å",normalizedTitle:"é´ééånext-key lockçå éè§å",charIndex:1214}],headersStr:"next-key lock é´ééånext-key lockçå éè§å",content:"ä»å éçèå´æ¥åºå«ï¼å¯ä»¥åä¸ºï¼\n\n * å¨å±é\n   * åºç¨åºæ¯ï¼å¨åºé»è¾å¤ä»½ãä½è¿æ¯å»ºè®®å¼å¯äºå¡ï¼åå©å¯éå¤è¯»çRead View æ¥å¤ä»½ã\n * è¡¨çº§é\n   * è¡¨é\n   * åæ°æ®éï¼metadata lockï¼MDLï¼ï¼æä»¬ä¸éè¦æ¾ç¤ºçä½¿ç¨ MDLï¼å ä¸ºå½æä»¬å¯¹æ°æ®åºè¡¨è¿è¡æä½æ¶ï¼ä¼èªå¨ç»è¿ä¸ªè¡¨å ä¸ MDLã\n   * æåéï¼æåå±äº«éåæåç¬å éæ¯è¡¨çº§éï¼ä¸ä¼åè¡çº§çå±äº«éåç¬å éåçå²çªï¼èä¸æåéä¹é´ä¹ä¸ä¼åçå²çªï¼åªä¼åå±äº«è¡¨éï¼lock tables ... readï¼åç¬å è¡¨éï¼lock tables ... writeï¼åçå²çªã\n   * AUTO-INC éï¼AUTO-INC éæ¯ç¹æ®çè¡¨éæºå¶ï¼éä¸æ¯åä¸ä¸ªäºå¡æäº¤åæéæ¾ï¼èæ¯åæ§è¡å®æå¥è¯­å¥åå°±ä¼ç«å³éæ¾ã\n * è¡çº§é\n   * è®°å½é Record Lockï¼ä»æä¸æ¡è®°å½ä¸é\n   * é´éé Gap Lockï¼éå®ä¸ä¸ªèå´ï¼ä½ä¸åå«è®°å½æ¬èº«\n     * é´ééè½ç¶å­å¨ X åé´ééå S åé´ééï¼ä½æ¯å¹¶æ²¡æä»ä¹åºå«ï¼é´ééä¹é´æ¯å¼å®¹çï¼å³ä¸¤ä¸ªäºå¡å¯ä»¥åæ¶ææåå«å±åé´éèå´çé´ééï¼å¹¶ä¸å­å¨äºæ¥å³ç³»ï¼å ä¸ºé´ééçç®çæ¯é²æ­¢æå¥å¹»å½±è®°å½èæåºçã\n   * ä¸´é®é Next-key Lockï¼=Record Lock + Gap Lockï¼éå®ä¸ä¸ªèå´ä»¥åè®°å½æ¬èº«ã\n\nè¡¨éåè¡éæ¯æ»¡è¶³è¯»è¯»å±äº«ãè¯»åäºæ¥ãååäºæ¥çã\n\næ®éç select æ¯ä¸ä¼å è¡çº§éçï¼æ®éç select è¯­å¥æ¯å©ç¨ MVCC å®ç°ä¸è´æ§è¯»ï¼æ¯æ éçã\n\nå¨ InnoDB äºå¡ä¸­ï¼å¯¹è®°å½å éå¸¦åºæ¬åä½æ¯ next-key éï¼ä½æ¯ä¼å ä¸ºä¸äºæ¡ä»¶ä¼éåæé´ééï¼æèè®°å½éãå éçä½ç½®åç¡®çè¯´ï¼éæ¯å å¨ç´¢å¼ä¸çèéè¡ä¸ã\n\n# å¼å¯å¨å±é\nflush tables with read lock\n# éæ¾å¨å±é\nunlock tables\n\n# è¡¨çº§å«çå±äº«éï¼ä¹å°±æ¯è¯»é\nlock tables t read;\n# è¡¨çº§å«çæä»éï¼ä¹å°±æ¯åé\nlock tables t write;\n# éæ¾å½åä¼è¯çææè¡¨é\nunlock tables\n\n# è¿ä¸¤æ¡è¯­å¥å¿é¡»å¨ä¸ä¸ªäºå¡ä¸­ï¼å ä¸ºå½äºå¡æäº¤äºï¼éå°±ä¼è¢«éæ¾ã\n# æä»¥å¨ä½¿ç¨è¿ä¸¤æ¡è¯­å¥çæ¶åï¼è¦å ä¸ beginãstart transaction æè set autocommit = 0ã\n# åå¨è¡¨ä¸å ä¸æåå±äº«éï¼ç¶åå¯¹è¯»åçè®°å½å å±äº«éï¼Séï¼\nselect ... lock in share mode;\n# åè¡¨ä¸å ä¸æåç¬å éï¼ç¶åå¯¹è¯»åçè®°å½å ç¬å éï¼Xéï¼\nselect ... for update;\n\n\n\n# next-key lock\n\nè¡é + è¯¥è¡ä¹åçé´ééåç§° next-key lockï¼æ¯ä¸ª next-key lock æ¯åå¼åé­åºé´ã\n\n\n# é´ééånext-key lockçå éè§å\n\nå éè§åéé¢ï¼åå«äºä¸¤ä¸ªâååâãä¸¤ä¸ªâä¼åâåä¸ä¸ªâbugâã\n\n 1. åå 1ï¼å éçåºæ¬åä½æ¯ next-key lockãnext-key lock æ¯åå¼åé­åºé´ã\n 2. åå 2ï¼æ¥æ¾è¿ç¨ä¸­è®¿é®å°çå¯¹è±¡æä¼å éã\n 3. ä¼å 1ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼ç»å¯ä¸ç´¢å¼å éçæ¶åï¼next-key lock éåä¸ºè¡éã\n 4. ä¼å 2ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼åå³éåæ¶ä¸æåä¸ä¸ªå¼ä¸æ»¡è¶³ç­å¼æ¡ä»¶çæ¶åï¼next-key lock éåä¸ºé´ééã\n 5. ä¸ä¸ª bugï¼å¯ä¸ç´¢å¼ä¸çèå´æ¥è¯¢ä¼è®¿é®å°ä¸æ»¡è¶³æ¡ä»¶çç¬¬ä¸ä¸ªå¼ä¸ºæ­¢ãï¼8.0.26 æ²¡æè¿ä¸ªbugï¼\n\nhttps://www.jianshu.com/p/d1aba64b5c03",normalizedContent:"ä»å éçèå´æ¥åºå«ï¼å¯ä»¥åä¸ºï¼\n\n * å¨å±é\n   * åºç¨åºæ¯ï¼å¨åºé»è¾å¤ä»½ãä½è¿æ¯å»ºè®®å¼å¯äºå¡ï¼åå©å¯éå¤è¯»çread view æ¥å¤ä»½ã\n * è¡¨çº§é\n   * è¡¨é\n   * åæ°æ®éï¼metadata lockï¼mdlï¼ï¼æä»¬ä¸éè¦æ¾ç¤ºçä½¿ç¨ mdlï¼å ä¸ºå½æä»¬å¯¹æ°æ®åºè¡¨è¿è¡æä½æ¶ï¼ä¼èªå¨ç»è¿ä¸ªè¡¨å ä¸ mdlã\n   * æåéï¼æåå±äº«éåæåç¬å éæ¯è¡¨çº§éï¼ä¸ä¼åè¡çº§çå±äº«éåç¬å éåçå²çªï¼èä¸æåéä¹é´ä¹ä¸ä¼åçå²çªï¼åªä¼åå±äº«è¡¨éï¼lock tables ... readï¼åç¬å è¡¨éï¼lock tables ... writeï¼åçå²çªã\n   * auto-inc éï¼auto-inc éæ¯ç¹æ®çè¡¨éæºå¶ï¼éä¸æ¯åä¸ä¸ªäºå¡æäº¤åæéæ¾ï¼èæ¯åæ§è¡å®æå¥è¯­å¥åå°±ä¼ç«å³éæ¾ã\n * è¡çº§é\n   * è®°å½é record lockï¼ä»æä¸æ¡è®°å½ä¸é\n   * é´éé gap lockï¼éå®ä¸ä¸ªèå´ï¼ä½ä¸åå«è®°å½æ¬èº«\n     * é´ééè½ç¶å­å¨ x åé´ééå s åé´ééï¼ä½æ¯å¹¶æ²¡æä»ä¹åºå«ï¼é´ééä¹é´æ¯å¼å®¹çï¼å³ä¸¤ä¸ªäºå¡å¯ä»¥åæ¶ææåå«å±åé´éèå´çé´ééï¼å¹¶ä¸å­å¨äºæ¥å³ç³»ï¼å ä¸ºé´ééçç®çæ¯é²æ­¢æå¥å¹»å½±è®°å½èæåºçã\n   * ä¸´é®é next-key lockï¼=record lock + gap lockï¼éå®ä¸ä¸ªèå´ä»¥åè®°å½æ¬èº«ã\n\nè¡¨éåè¡éæ¯æ»¡è¶³è¯»è¯»å±äº«ãè¯»åäºæ¥ãååäºæ¥çã\n\næ®éç select æ¯ä¸ä¼å è¡çº§éçï¼æ®éç select è¯­å¥æ¯å©ç¨ mvcc å®ç°ä¸è´æ§è¯»ï¼æ¯æ éçã\n\nå¨ innodb äºå¡ä¸­ï¼å¯¹è®°å½å éå¸¦åºæ¬åä½æ¯ next-key éï¼ä½æ¯ä¼å ä¸ºä¸äºæ¡ä»¶ä¼éåæé´ééï¼æèè®°å½éãå éçä½ç½®åç¡®çè¯´ï¼éæ¯å å¨ç´¢å¼ä¸çèéè¡ä¸ã\n\n# å¼å¯å¨å±é\nflush tables with read lock\n# éæ¾å¨å±é\nunlock tables\n\n# è¡¨çº§å«çå±äº«éï¼ä¹å°±æ¯è¯»é\nlock tables t read;\n# è¡¨çº§å«çæä»éï¼ä¹å°±æ¯åé\nlock tables t write;\n# éæ¾å½åä¼è¯çææè¡¨é\nunlock tables\n\n# è¿ä¸¤æ¡è¯­å¥å¿é¡»å¨ä¸ä¸ªäºå¡ä¸­ï¼å ä¸ºå½äºå¡æäº¤äºï¼éå°±ä¼è¢«éæ¾ã\n# æä»¥å¨ä½¿ç¨è¿ä¸¤æ¡è¯­å¥çæ¶åï¼è¦å ä¸ beginãstart transaction æè set autocommit = 0ã\n# åå¨è¡¨ä¸å ä¸æåå±äº«éï¼ç¶åå¯¹è¯»åçè®°å½å å±äº«éï¼séï¼\nselect ... lock in share mode;\n# åè¡¨ä¸å ä¸æåç¬å éï¼ç¶åå¯¹è¯»åçè®°å½å ç¬å éï¼xéï¼\nselect ... for update;\n\n\n\n# next-key lock\n\nè¡é + è¯¥è¡ä¹åçé´ééåç§° next-key lockï¼æ¯ä¸ª next-key lock æ¯åå¼åé­åºé´ã\n\n\n# é´ééånext-key lockçå éè§å\n\nå éè§åéé¢ï¼åå«äºä¸¤ä¸ªâååâãä¸¤ä¸ªâä¼åâåä¸ä¸ªâbugâã\n\n 1. åå 1ï¼å éçåºæ¬åä½æ¯ next-key lockãnext-key lock æ¯åå¼åé­åºé´ã\n 2. åå 2ï¼æ¥æ¾è¿ç¨ä¸­è®¿é®å°çå¯¹è±¡æä¼å éã\n 3. ä¼å 1ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼ç»å¯ä¸ç´¢å¼å éçæ¶åï¼next-key lock éåä¸ºè¡éã\n 4. ä¼å 2ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼åå³éåæ¶ä¸æåä¸ä¸ªå¼ä¸æ»¡è¶³ç­å¼æ¡ä»¶çæ¶åï¼next-key lock éåä¸ºé´ééã\n 5. ä¸ä¸ª bugï¼å¯ä¸ç´¢å¼ä¸çèå´æ¥è¯¢ä¼è®¿é®å°ä¸æ»¡è¶³æ¡ä»¶çç¬¬ä¸ä¸ªå¼ä¸ºæ­¢ãï¼8.0.26 æ²¡æè¿ä¸ªbugï¼\n\nhttps://www.jianshu.com/p/d1aba64b5c03",charsets:{cjk:!0}},{title:"SQLè®°å½",frontmatter:{title:"SQLè®°å½",date:"2023-03-23T22:20:17.000Z",permalink:"/pages/1b8a9e/"},regularPath:"/02.MySQL/100.SQL%E8%AE%B0%E5%BD%95.html",relativePath:"02.MySQL/100.SQLè®°å½.md",key:"v-4a6be083",path:"/pages/1b8a9e/",headers:[{level:2,title:"CASE  WHEN THEN",slug:"case-when-then",normalizedTitle:"case  when then",charIndex:null},{level:2,title:"IFNULL å½æ°",slug:"ifnull-å½æ°",normalizedTitle:"ifnull å½æ°",charIndex:384},{level:2,title:"LIMIT num OFFSET index",slug:"limit-num-offset-index",normalizedTitle:"limit num offset index",charIndex:636}],headersStr:"CASE  WHEN THEN IFNULL å½æ° LIMIT num OFFSET index",content:"# CASE WHEN THEN\n\nSELECT *,\nCASE WHEN NOW() > start_time AND NOW() < end_time THEN 'è¿è¡ä¸­'\n\t\t WHEN NOW() < start_time THEN 'æªå¼å§'\nELSE 'å·²ç»æ'\nEND state\nfrom activity\n\n\n--ç®åcaseå½æ°\ncase sex\n  when '1' then 'ç·'\n  when '2' then 'å¥³â\n  else 'å¶ä»' end\n  \n--caseæç´¢å½æ°\ncase when sex = '1' then 'ç·'\n     when sex = '2' then 'å¥³'\n     else 'å¶ä»' end\n\n\n\n * https://www.w3schools.com/sql/sql_case.asp\n\n\n# IFNULL å½æ°\n\nIFNULL(expression, alt_value);\n\nå¦æç¬¬ä¸ä¸ªåæ°çè¡¨è¾¾å¼ expression ä¸º NULLï¼åè¿åç¬¬äºä¸ªåæ°çå¤ç¨å¼ã\n\nSELECT\n    IFNULL(\n      (SELECT DISTINCT Salary\n       FROM Employee\n       ORDER BY Salary DESC\n        LIMIT 1 OFFSET 1),\n    NULL) AS SecondHighestSalary;\n\n\n\n# LIMIT num OFFSET index",normalizedContent:"# case when then\n\nselect *,\ncase when now() > start_time and now() < end_time then 'è¿è¡ä¸­'\n\t\t when now() < start_time then 'æªå¼å§'\nelse 'å·²ç»æ'\nend state\nfrom activity\n\n\n--ç®åcaseå½æ°\ncase sex\n  when '1' then 'ç·'\n  when '2' then 'å¥³â\n  else 'å¶ä»' end\n  \n--caseæç´¢å½æ°\ncase when sex = '1' then 'ç·'\n     when sex = '2' then 'å¥³'\n     else 'å¶ä»' end\n\n\n\n * https://www.w3schools.com/sql/sql_case.asp\n\n\n# ifnull å½æ°\n\nifnull(expression, alt_value);\n\nå¦æç¬¬ä¸ä¸ªåæ°çè¡¨è¾¾å¼ expression ä¸º nullï¼åè¿åç¬¬äºä¸ªåæ°çå¤ç¨å¼ã\n\nselect\n    ifnull(\n      (select distinct salary\n       from employee\n       order by salary desc\n        limit 1 offset 1),\n    null) as secondhighestsalary;\n\n\n\n# limit num offset index",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"MySQLå®æ45è®²",frontmatter:{title:"MySQLå®æ45è®²",date:"2023-03-23T22:24:39.000Z",permalink:"/pages/4f8fa0/"},regularPath:"/02.MySQL/99.MySQL%E5%AE%9E%E6%88%9845%E8%AE%B2.html",relativePath:"02.MySQL/99.MySQLå®æ45è®².md",key:"v-783fbd46",path:"/pages/4f8fa0/",headers:[{level:2,title:"è¿æ¥å¨",slug:"è¿æ¥å¨",normalizedTitle:"è¿æ¥å¨",charIndex:468},{level:2,title:"æ¥è¯¢ç¼å­",slug:"æ¥è¯¢ç¼å­",normalizedTitle:"æ¥è¯¢ç¼å­",charIndex:1238},{level:2,title:"åæå¨",slug:"åæå¨",normalizedTitle:"åæå¨",charIndex:1667},{level:3,title:"è¯æ³åæ",slug:"è¯æ³åæ",normalizedTitle:"è¯æ³åæ",charIndex:1675},{level:3,title:"è¯­æ³åæ",slug:"è¯­æ³åæ",normalizedTitle:"è¯­æ³åæ",charIndex:1722},{level:2,title:"ä¼åå¨",slug:"ä¼åå¨",normalizedTitle:"ä¼åå¨",charIndex:1760},{level:2,title:"æ§è¡å¨",slug:"æ§è¡å¨",normalizedTitle:"æ§è¡å¨",charIndex:1830},{level:2,title:"InnoDBçç´¢å¼æ¨¡å",slug:"innodbçç´¢å¼æ¨¡å",normalizedTitle:"innodbçç´¢å¼æ¨¡å",charIndex:4895},{level:2,title:"è¦çç´¢å¼",slug:"è¦çç´¢å¼",normalizedTitle:"è¦çç´¢å¼",charIndex:5424},{level:2,title:"æå·¦åç¼åå",slug:"æå·¦åç¼åå",normalizedTitle:"æå·¦åç¼åå",charIndex:5709},{level:2,title:"ç´¢å¼ä¸æ¨",slug:"ç´¢å¼ä¸æ¨",normalizedTitle:"ç´¢å¼ä¸æ¨",charIndex:5890},{level:2,title:"å¨å±é",slug:"å¨å±é",normalizedTitle:"å¨å±é",charIndex:6045},{level:2,title:"è¡¨çº§é",slug:"è¡¨çº§é",normalizedTitle:"è¡¨çº§é",charIndex:6089},{level:2,title:"å°ç»",slug:"å°ç»",normalizedTitle:"å°ç»",charIndex:7449},{level:2,title:"å¯éå¤è¯»éç¦»çº§å«ä¸",slug:"å¯éå¤è¯»éç¦»çº§å«ä¸",normalizedTitle:"å¯éå¤è¯»éç¦»çº§å«ä¸",charIndex:3659},{level:2,title:"è¯»æäº¤éç¦»çº§å«ä¸",slug:"è¯»æäº¤éç¦»çº§å«ä¸",normalizedTitle:"è¯»æäº¤éç¦»çº§å«ä¸",charIndex:15629},{level:2,title:"ä¸»å¤å»¶è¿",slug:"ä¸»å¤å»¶è¿",normalizedTitle:"ä¸»å¤å»¶è¿",charIndex:16572},{level:3,title:"å¯é æ§ä¼åç­ç¥ï¼",slug:"å¯é æ§ä¼åç­ç¥",normalizedTitle:"å¯é æ§ä¼åç­ç¥ï¼",charIndex:16949},{level:3,title:"å¯ç¨æ§æåç­ç¥ï¼",slug:"å¯ç¨æ§æåç­ç¥",normalizedTitle:"å¯ç¨æ§æåç­ç¥ï¼",charIndex:17221},{level:2,title:"GTID",slug:"gtid",normalizedTitle:"gtid",charIndex:18286},{level:2,title:"å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡",slug:"å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡",normalizedTitle:"å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡",charIndex:18956},{level:2,title:"semi-sync replication ååæ­¥æ§å¶",slug:"semi-sync-replication-ååæ­¥æ§å¶",normalizedTitle:"semi-sync replication ååæ­¥æ§å¶",charIndex:19098},{level:2,title:"ç­ä¸»åºä½ç¹æ¹æ¡",slug:"ç­ä¸»åºä½ç¹æ¹æ¡",normalizedTitle:"ç­ä¸»åºä½ç¹æ¹æ¡",charIndex:19061},{level:2,title:"GTIDæ¹æ¡",slug:"gtidæ¹æ¡",normalizedTitle:"gtidæ¹æ¡",charIndex:19073},{level:2,title:"hashç´¢å¼åb-treeç´¢å¼",slug:"hashç´¢å¼åb-treeç´¢å¼",normalizedTitle:"hashç´¢å¼åb-treeç´¢å¼",charIndex:21477},{level:2,title:"ååºè¡¨çåºç¨åºæ¯",slug:"ååºè¡¨çåºç¨åºæ¯",normalizedTitle:"ååºè¡¨çåºç¨åºæ¯",charIndex:23072}],headersStr:"è¿æ¥å¨ æ¥è¯¢ç¼å­ åæå¨ è¯æ³åæ è¯­æ³åæ ä¼åå¨ æ§è¡å¨ InnoDBçç´¢å¼æ¨¡å è¦çç´¢å¼ æå·¦åç¼åå ç´¢å¼ä¸æ¨ å¨å±é è¡¨çº§é å°ç» å¯éå¤è¯»éç¦»çº§å«ä¸ è¯»æäº¤éç¦»çº§å«ä¸ ä¸»å¤å»¶è¿ å¯é æ§ä¼åç­ç¥ï¼ å¯ç¨æ§æåç­ç¥ï¼ GTID å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡ semi-sync replication ååæ­¥æ§å¶ ç­ä¸»åºä½ç¹æ¹æ¡ GTIDæ¹æ¡ hashç´¢å¼åb-treeç´¢å¼ ååºè¡¨çåºç¨åºæ¯",content:"å­¦ä¹ è·¯å¾ï¼åè¦ä¼ç¨ï¼ç¶åå¯ä»¥åç°é®é¢ã\n\nmysqlåèèµæï¼\n\n * mysqlçå®æ¹æåï¼æå®ä½åå»æ¥æ¼è¡¥ç¼º\n * ãé«æ§è½çmysqlã\n\nMDL metadata lockï¼åæ°æ®é\n\nä¸äºå»ºè®®ï¼\n\n * éè·¯åä¸æ¡ï¼å®è·µç¬¬ä¸æ¡ãæå¨æ­å»ºä¸å¥ä¸»å¤å¤å¶ç»æãå¹³æ¶éå°é®é¢ï¼å¨æå¤ç°ãå¨éè¯»å¶ä»ææ¯æç« ãå¾ä¹¦æ¶ï¼å¦æè§å¾èªå·±çè§£äºä¸ä¸ªç¥è¯ç¹ï¼ä¹ä¸å®è¦å°è¯è®¾è®¡ä¸ä¸ªä¾å­æ¥éªè¯å®ãä¹å»ºè®®è®¾ç½®å¯¹ç§çåä¾ï¼è¾¾å°èä¼è´¯éã\n * æä¹è¯æèªå·±æ¯ä¸æ¯ççæåçå¼æ¸æ¥äºï¼è¯´åºæ¥ï¼ååºæ¥ï¼å¦ææäººè¯·æä½ æä¸ªç¥è¯ç¹ï¼ä¸å®è¦è·ä»å°æ¸æ¥ï¼ä¸è¦è§å¾è¿æ¯æµªè´¹æ¶é´ãå ä¸ºè¿æ ·ï¼ä¾ä¸æ¥å¯ä»¥éªè¯èªå·±ç¡®å®ææäºè¿ä¸ªç¥è¯ç¹ï¼äºæ¥å¯ä»¥æåèªå·±çææ¯è¡¨è¾¾è½åãæ¯ç«ä½ ç»ç©¶è¦é¢ä¸´å3ç±»äººè®²æ¸æ¥åççæ¶åï¼èæ¿ãæåç­è¾©çè¯å§ãæ°å·¥ä½çé¢è¯å®ã\n * ç¥è¯è¦æä½ç³»ï¼æä¸å®¹æå¿è®°ã\n * æåè¡¥å¨é¢ï¼æ¡ä¾æ«ç²ç¹ãä¸å¼å§ä¸è¦çæåï¼æååºè¯¥æ¯å¨ä½ ç¥è¯ç½ç»æå»ºçå·®ä¸å¤æ¶åçã\n\n\n# ä¸ãåºç¡æ¶æ\n\nå¤§ä½æ¥è¯´ï¼MySQLå¯ä»¥åä¸ºServerå±åå­å¨å¼æå±ä¸¤é¨åã\n\n\n\n\n# è¿æ¥å¨\n\nä¸è¬çè¿æ¥å½ä»¤ï¼\n\nmysql -h$ip -P$port -u\n\n\nå®æç»å¸çTCPæ¡æåï¼è¿æ¥å¨å°±è¦å¼å§è®¤è¯ä½ çèº«ä»½ï¼è¿ä¸ªæ¶åç¨çå°±æ¯ä½ è¾å¥çç¨æ·ååå¯ç ã\n\n * å¦æç¨æ·åæå¯ç ä¸å¯¹ï¼ä½ å°±ä¼æ¶å°ä¸ä¸ª\"Access denied for user\"çéè¯¯ï¼ç¶åå®¢æ·ç«¯ç¨åº ç»ææ§è¡ã\n\n * å¦æç¨æ·åå¯ç è®¤è¯éè¿ï¼è¿æ¥å¨ä¼å°æéè¡¨éé¢æ¥åºä½ æ¥æçæéãä¹åï¼è¿ä¸ªè¿æ¥éé¢ çæéå¤æ­é»è¾ï¼é½å°ä¾èµäºæ­¤æ¶è¯»å°çæéã\n\nä¸ä¸ªç¨æ·æåå»ºç«è¿æ¥åï¼å³ä½¿ä½ ç¨ç®¡çåè´¦å·å¯¹è¿ä¸ªç¨æ·çæéåäºä¿®æ¹ï¼ä¹ä¸ ä¼å½±åå·²ç»å­å¨è¿æ¥çæéãä¿®æ¹å®æåï¼åªæåæ°å»ºçè¿æ¥æä¼ä½¿ç¨æ°çæéè®¾ç½®ã\n\nè¿æ¥å®æåï¼å¦æä½ æ²¡æåç»­çå¨ä½ï¼è¿ä¸ªè¿æ¥å°±å¤äºç©ºé²ç¶æï¼ä½ å¯ä»¥å¨show processlistå½ä»¤ä¸­çå°å®ã\n\nå®¢æ·ç«¯å¦æå¤ªé¿æ¶é´æ²¡å¨éï¼è¿æ¥å¨å°±ä¼èªå¨å°å®æ­å¼ãè¿ä¸ªæ¶é´æ¯ç±åæ°wait_timeoutæ§å¶ çï¼é»è®¤å¼æ¯8å°æ¶ã\n\nå°½éä½¿ç¨é¿è¿æ¥ã\n\nä½æ¯å¨é¨ä½¿ç¨é¿è¿æ¥åï¼ä½ å¯è½ä¼åç°ï¼æäºæ¶åMySQLå ç¨åå­æ¶¨å¾ç¹å«å¿«ï¼è¿æ¯å ä¸º MySQLå¨æ§è¡è¿ç¨ä¸­ä¸´æ¶ä½¿ç¨çåå­æ¯ç®¡çå¨è¿æ¥å¯¹è±¡éé¢çãè¿äºèµæºä¼å¨è¿æ¥æ­å¼çæ¶åæéæ¾ãæä»¥å¦æé¿è¿æ¥ç´¯ç§¯ä¸æ¥ï¼å¯è½å¯¼è´åå­å ç¨å¤ªå¤§ï¼è¢«ç³»ç»å¼ºè¡ææï¼OOMï¼ï¼ä»ç°è±¡çå°±æ¯MySQLå¼å¸¸éå¯äºã\n\næä¹è§£å³è¿ä¸ªé®é¢å¢ï¼ä½ å¯ä»¥èèä»¥ä¸ä¸¤ç§æ¹æ¡ã\n\n 1. å®ææ­å¼é¿è¿æ¥ãä½¿ç¨ä¸æ®µæ¶é´ï¼æèç¨åºéé¢å¤æ­æ§è¡è¿ä¸ä¸ªå ç¨åå­çå¤§æ¥è¯¢åï¼æ­å¼è¿æ¥ï¼ä¹åè¦æ¥è¯¢åéè¿ã\n\n 2. å¦æä½ ç¨çæ¯MySQL 5.7ææ´æ°çæ¬ï¼å¯ä»¥å¨æ¯æ¬¡æ§è¡ä¸ä¸ªæ¯è¾å¤§çæä½åï¼éè¿æ§è¡mysql_reset_connectionæ¥éæ°åå§åè¿æ¥èµæºãè¿ä¸ªè¿ç¨ä¸éè¦éè¿åéæ°åæééªè¯ï¼ä½æ¯ä¼å°è¿æ¥æ¢å¤å°åååå»ºå®æ¶çç¶æã\n\n\n# æ¥è¯¢ç¼å­\n\nä½æ¯å¤§å¤æ°æåµä¸æä¼å»ºè®®ä½ ä¸è¦ä½¿ç¨æ¥è¯¢ç¼å­ï¼ å ä¸ºæ¥è¯¢ç¼å­å¾å¾å¼å¤§äºå©ã\n\næ¥è¯¢ç¼å­çå¤±æéå¸¸é¢ç¹ï¼åªè¦æå¯¹ä¸ä¸ªè¡¨çæ´æ°ï¼è¿ä¸ªè¡¨ä¸ææçæ¥è¯¢ç¼å­é½ä¼è¢«æ¸ç©ºãå æ­¤ å¾å¯è½ä½ è´¹å²å°æç»æå­èµ·æ¥ï¼è¿æ²¡ä½¿ç¨å¢ï¼å°±è¢«ä¸ä¸ªæ´æ°å¨æ¸ç©ºäºãå¯¹äºæ´æ°ååå¤§çæ°æ®åº æ¥è¯´ï¼æ¥è¯¢ç¼å­çå½ä¸­çä¼éå¸¸ä½ãé¤éä½ çä¸å¡å°±æ¯æä¸å¼ éæè¡¨ï¼å¾é¿æ¶é´æä¼æ´æ°ä¸æ¬¡ã æ¯å¦ï¼ä¸ä¸ªç³»ç»éç½®è¡¨ï¼é£è¿å¼ è¡¨ä¸çæ¥è¯¢æéåä½¿ç¨æ¥è¯¢ç¼å­ã\n\nå¥½å¨MySQLä¹æä¾äºè¿ç§âæéä½¿ç¨âçæ¹å¼ãä½ å¯ä»¥å°åæ°query_cache_typeè®¾ç½®æDEMANDï¼è¿æ ·å¯¹äºé»è®¤çSQLè¯­å¥é½ä¸ä½¿ç¨æ¥è¯¢ç¼å­ãèå¯¹äºä½ ç¡®å®è¦ä½¿ç¨æ¥è¯¢ç¼å­çè¯­ å¥ï¼å¯ä»¥ç¨SQL_CACHEæ¾å¼æå®ï¼åä¸é¢è¿ä¸ªè¯­å¥ä¸æ ·ï¼\n\nselect SQL_CACHE * from T where ID = 10;\n\n\néè¦æ³¨æçæ¯ï¼MySQL 8.0çæ¬ç´æ¥å°æ¥è¯¢ç¼å­çæ´ååè½å æäºï¼ä¹å°±æ¯è¯´8.0å¼å§å½»åºæ²¡æ è¿ä¸ªåè½äºã\n\n\n# åæå¨\n\n\n# è¯æ³åæ\n\næ ¹æ®è¾å¥çå­ç¬¦ä¸²åç©ºæ ¼è¿è¡è¯å«ï¼è¯å«åºéé¢çå­ç¬¦ä¸²åå«æ¯ä»ä¹ï¼ä»£è¡¨ä»ä¹ã\n\n\n# è¯­æ³åæ\n\næ ¹æ®è¯­æ³è§åï¼å¤æ­è¾å¥çsqlæ¯å¦æ»¡è¶³mysqlè¯­æ³ã\n\n\n# ä¼åå¨\n\nä¼åå¨æ¯å¨è¡¨éé¢æå¤ä¸ªç´¢å¼çæ¶åï¼å³å®ä½¿ç¨åªä¸ªç´¢å¼ï¼æèå¨ä¸ä¸ªè¯­å¥æå¤è¡¨å³èï¼joinï¼ çæ¶åï¼å³å®åä¸ªè¡¨çè¿æ¥é¡ºåºã\n\n\n# æ§è¡å¨\n\né¦åå¤æ­ææ²¡å¯¹è¡¨Tçæ§è¡æéãæçè¯å°±æå¼è¡¨ç»§ç»­æ§è¡ã\n\nåä¸ºæç´¢å¼çæåµåæ²¡ç´¢å¼çæåµã\n\nä½ ä¼å¨æ°æ®åºçæ¢æ¥è¯¢æ¥å¿ä¸­çå°ä¸ä¸ªrows_examinedçå­æ®µï¼è¡¨ç¤ºè¿ä¸ªè¯­å¥æ§è¡è¿ç¨ä¸­æ«æäº å¤å°è¡ãè¿ä¸ªå¼å°±æ¯å¨æ§è¡å¨æ¯æ¬¡è°ç¨å¼æè·åæ°æ®è¡çæ¶åç´¯å çã\n\nå¨æäºåºæ¯ä¸ï¼æ§è¡å¨è°ç¨ä¸æ¬¡ï¼å¨å¼æåé¨åæ«æäºå¤è¡ï¼å æ­¤å¼ææ«æè¡æ°è·å¼ææ«æè¡æ°è· rows_examinedå¹¶ä¸æ¯å®å¨ç¸åçã\n\n\n# äºãæ¥å¿ç³»ç»\n\nä¸æ¥è¯¢æµç¨ä¸åï¼æ´æ°æµç¨è¿æ¶åä¸¤ä¸ªéè¦çæ¥å¿æ¨¡åã\n\n * redo logï¼éåæ¥å¿ï¼\n\n * binlogï¼å½æ¡£æ¥å¿ï¼\n\nèç²æ¿åè´¦æ¬éåçæ´ä¸ªè¿ç¨ï¼å¶å®å°±æ¯MySQLéç»å¸¸è¯´å°çWALææ¯ï¼WALçå¨ç§°æ¯WriteAhead Loggingï¼å®çå³é®ç¹å°±æ¯ååæ¥å¿ï¼ååç£çï¼ä¹å°±æ¯ååç²æ¿ï¼ç­ä¸å¿çæ¶åååè´¦æ¬ã\n\nMySQLæ´ä½æ¥çï¼å¶å®å°±æä¸¤åï¼ä¸åæ¯Serverå±ï¼å®ä¸»è¦åçæ¯MySQLåè½å±é¢çäºæï¼è¿æä¸åæ¯å¼æå±ï¼è´è´£å­å¨ç¸å³çå·ä½äºå®ãä¸é¢æä»¬èå°çç²æ¿redo logæ¯ InnoDBå¼æç¹æçæ¥å¿ï¼èServerå±ä¹æèªå·±çæ¥å¿ï¼ç§°ä¸ºbinlogï¼å½æ¡£æ¥å¿ï¼ã\n\næå¼å§MySQLéå¹¶æ²¡æInnoDBå¼æãMySQLèªå¸¦çå¼ææ¯MyISAMï¼ä½æ¯MyISAMæ²¡æ crash-safeçè½åï¼binlogæ¥å¿åªè½ç¨äºå½æ¡£ãèInnoDBæ¯å¦ä¸ä¸ªå¬å¸ä»¥æä»¶å½¢å¼å¼å¥MySQLçï¼æ¢ç¶åªä¾é binlogæ¯æ²¡æcrash-safeè½åçï¼æä»¥InnoDBä½¿ç¨å¦å¤ä¸å¥æ¥å¿ç³»ç»â â ä¹å°±æ¯ redo logæ¥å®ç°crash-safeè½åã\n\næäºredo logï¼InnoDBå°±å¯ä»¥ä¿è¯å³ä½¿æ°æ®åºåçå¼å¸¸éå¯ï¼ä¹åæäº¤çè®°å½é½ä¸ä¼ä¸¢å¤±ï¼è¿ä¸ª è½åç§°ä¸ºcrash-safeã\n\nè¿ä¸¤ç§æ¥å¿æä»¥ä¸ä¸ç¹ä¸åã\n\n 1. redo logæ¯InnoDBå¼æç¹æçï¼binlogæ¯MySQLçServerå±å®ç°çï¼ææå¼æé½å¯ä»¥ä½¿ç¨ã\n 2. redo logæ¯ç©çæ¥å¿ï¼è®°å½çæ¯âå¨æä¸ªæ°æ®é¡µä¸åäºä»ä¹ä¿®æ¹âï¼binlogæ¯é»è¾æ¥å¿ï¼è®°å½çæ¯è¿ä¸ªè¯­å¥çåå§é»è¾ï¼æ¯å¦âç»ID=2è¿ä¸è¡çcå­æ®µå 1 âã\n 3. redo logæ¯å¾ªç¯åçï¼ç©ºé´åºå®ä¼ç¨å®ï¼binlogæ¯å¯ä»¥è¿½å åå¥çãâè¿½å åâæ¯æbinlogæä»¶åå°ä¸å®å¤§å°åä¼åæ¢å°ä¸ä¸ä¸ªï¼å¹¶ä¸ä¼è¦çä»¥åçæ¥å¿ã\n\nredo logçåå¥ææäºä¸¤ä¸ªæ­¥éª¤ï¼prepareåcommitï¼æ¯\"ä¸¤é¶æ®µæäº¤\"ã\n\nå½ä½ éè¦æ©å®¹çæ¶åï¼ä¹å°±æ¯éè¦å å¤æ­å»ºä¸äºå¤åºæ¥å¢å ç³»ç»çè¯»è½åçæ¶åï¼ç°å¨å¸¸è§çåæ³ä¹æ¯ç¨å¨éå¤ä»½å ä¸åºç¨binlogæ¥å®ç°çï¼è¿ä¸ªâä¸ä¸è´âå°±ä¼å¯¼è´ä½ ççº¿ä¸åºç°ä¸»ä»æ°æ®åºä¸ä¸è´çæåµã\n\nç®åè¯´ï¼redo logåbinlogé½å¯ä»¥ç¨äºè¡¨ç¤ºäºå¡çæäº¤ç¶æï¼èä¸¤é¶æ®µæäº¤å°±æ¯è®©è¿ä¸¤ä¸ªç¶æä¿ æé»è¾ä¸çä¸è´ã\n\n**æèä¸ä¸ªé®é¢ï¼**å®æå¨éå¤ä»½çå¨æâåå³äºç³»ç»éè¦æ§ï¼æçæ¯ä¸å¤©ä¸å¤ï¼æçæ¯ä¸å¨ä¸å¤âãé£ä¹å¨ä»ä¹åºæ¯ä¸ï¼ä¸å¤©ä¸å¤ä¼æ¯ä¸å¨ä¸å¤æ´æä¼å¿å¢ï¼æèè¯´ï¼å®å½±åäºè¿ä¸ªæ°æ®åºç³»ç»çåªä¸ªææ ï¼\n\nä¸å¤©ä¸å¤ï¼é£ä¹å¦æéè¦æ¢å¤æ°æ®çè¯ï¼åªè¦ä¿è¯å½å¤©çbinlogå®æ´å³å¯ï¼ä¸å¨ä¸å¤çè¯å°±è¦ä¿è¯ä¸å¨çbinlogå®æ´ï¼åæ¶é¢ç¹å¨éå¤ä»½éè¦æ´å¤å­å¨ç©ºé´ï¼å¦ä½éæ©åå³äºä¸å¡çéè¦æ§ï¼å¯¹åºçææ æ¯RTO(ç®æ æ¢å¤æ¶é´)ã\n\n\n# ä¸ãäºå¡éç¦»\n\næå°äºå¡ï¼æä»¬ä¼æ³å°ACID\n\n * Atomicity åå­æ§\n * Consistency ä¸è´æ§\n * Isolation éç¦»æ§\n * Durability æä¹æ§\n\nè¿éä¸»è¦è°éç¦»æ§ã\n\nå½æ°æ®åºä¸æå¤ä¸ªäºå¡åæ¶æ§è¡çæ¶åï¼å°±å¯è½åºç°èè¯»ï¼dirty readï¼ãä¸å¯éå¤è¯»ï¼non- repeatable readï¼ãå¹»è¯»ï¼phantom readï¼çé®é¢ï¼ä¸ºäºè§£å³è¿äºé®é¢ï¼å°±æäºâéç¦»çº§å«âçæ¦å¿µã\n\néç¦»å¾è¶ä¸¥å®ï¼æçå°±ä¼è¶ä½ã\n\nSQLæ åçäºå¡éç¦»çº§å«åæ¬ï¼\n\n * è¯»æªæäº¤ï¼read uncommittedï¼ï¼ä¸ä¸ªäºå¡è¿æ²¡æäº¤æ¶ï¼å®åçåæ´å°±è½è¢«å«çäºå¡çå°ã\n * è¯»æäº¤ï¼read committedï¼ï¼ä¸ä¸ªäºå¡æäº¤ä¹åï¼å®åçåæ´æä¼è¢«å¶ä»äºå¡çå°ã\n * å¯éå¤è¯»ï¼repeatable readï¼ï¼ä¸ä¸ªäºå¡æ§è¡è¿ç¨ä¸­çå°çæ°æ®ï¼æ»æ¯è·è¿ä¸ªäºå¡å¨å¯å¨æ¶çå°çæ°æ®æ¯ä¸è´çãå½ç¶å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼æªæäº¤åæ´å¯¹å¶ä»äºå¡ä¹æ¯ä¸å¯è§çã\n * ä¸²è¡åï¼serializable ï¼ï¼å¯¹äºåä¸è¡è®°å½ï¼âåâä¼å âåéâï¼âè¯»âä¼å âè¯»éâãå½åºç°è¯»åéå²çªçæ¶åï¼åè®¿é®çäºå¡å¿é¡»ç­åä¸ä¸ªäºå¡æ§è¡å®æï¼æè½ç»§ç»­æ§è¡ã\n\nå¨å®ç°ä¸ï¼æ°æ®åºéé¢ä¼åå»ºä¸ä¸ªè§å¾ï¼è®¿é®çæ¶åä»¥è§å¾çé»è¾ç»æä¸ºåãå¨âå¯éå¤è¯»âéç¦»çº§å«ä¸ï¼è¿ä¸ªè§å¾æ¯å¨äºå¡å¯å¨æ¶åå»ºçï¼æ´ä¸ªäºå¡å­å¨æé´é½ç¨è¿ä¸ªè§å¾ã**å¨âè¯»æäº¤âéç¦»çº§ å«ä¸ï¼è¿ä¸ªè§å¾æ¯å¨æ¯ä¸ªSQLè¯­å¥å¼å§æ§è¡çæ¶ååå»ºçã**è¿ééè¦æ³¨æçæ¯ï¼âè¯»æªæäº¤âéç¦» çº§å«ä¸ç´æ¥è¿åè®°å½ä¸çææ°å¼ï¼æ²¡æè§å¾æ¦å¿µï¼èâä¸²è¡åâéç¦»çº§å«ä¸ç´æ¥ç¨å éçæ¹å¼æ¥é¿ åå¹¶è¡è®¿é®ã\n\nOracleæ°æ®åºçé»è®¤éç¦»çº§å«å¶ å®å°±æ¯âè¯»æäº¤âï¼å æ­¤å¯¹äºä¸äºä»Oracleè¿ç§»å°MySQLçåºç¨ï¼ä¸ºä¿è¯æ°æ®åºéç¦»çº§å«çä¸è´ï¼ ä½ ä¸å®è¦è®°å¾å°MySQLçéç¦»çº§å«è®¾ç½®ä¸ºâè¯»æäº¤âãmysqlé»è®¤éç¦»çº§å«æ¯å¯éå¤è¯»ã\n\néç½®çæ¹å¼æ¯ï¼å°å¯å¨åæ°transaction-isolationçå¼è®¾ç½®æREAD-COMMITTEDãä½ å¯ä»¥ç¨ show variablesæ¥æ¥çå½åçå¼ã\n\nå°½éé¿åé¿äºå¡ã\n\né¿äºå¡æå³çç³»ç»éé¢ä¼å­å¨å¾èçäºå¡è§å¾ãç±äºè¿äºäºå¡éæ¶å¯è½è®¿é®æ°æ®åºéé¢çä»»ä½æ°æ®ï¼æä»¥è¿ä¸ªäºå¡æäº¤ä¹åï¼æ°æ®åºéé¢å®å¯è½ç¨å°çåæ»è®°å½é½å¿é¡»ä¿çï¼è¿å°±ä¼å¯¼è´å¤§éå ç¨å­å¨ç©ºé´ã\n\nå¨MySQL 5.5åä»¥åççæ¬ï¼åæ»æ¥å¿æ¯è·æ°æ®å­å¸ä¸èµ·æ¾å¨ibdataæä»¶éçï¼å³ä½¿é¿äºå¡æç»æäº¤ï¼åæ»æ®µè¢«æ¸çï¼æä»¶ä¹ä¸ä¼åå°ãæè§è¿æ°æ®åªæ20GBï¼èåæ»æ®µæ200GBçåºãæç»åªå¥½ä¸ºäºæ¸çåæ»æ®µï¼éå»ºæ´ä¸ªåºã\n\né¤äºå¯¹åæ»æ®µçå½±åï¼é¿äºå¡è¿å ç¨éèµæºï¼ä¹å¯è½æå®æ´ä¸ªåºã\n\nMySQLçäºå¡å¯å¨æ¹å¼æä»¥ä¸å ç§ï¼\n\n 1. æ¾å¼å¯å¨äºå¡è¯­å¥ï¼ begin æ start transactionãéå¥çæäº¤è¯­å¥æ¯commitï¼åæ»è¯­å¥æ¯rollbackã\n 2. set autocommit=0ï¼è¿ä¸ªå½ä»¤ä¼å°è¿ä¸ªçº¿ç¨çèªå¨æäº¤å³æãæå³çå¦æä½ åªæ§è¡ä¸ä¸ªselectè¯­å¥ï¼è¿ä¸ªäºå¡å°±å¯å¨äºï¼èä¸å¹¶ä¸ä¼èªå¨æäº¤ãè¿ä¸ªäºå¡æç»­å­å¨ç´å°ä½ ä¸»å¨æ§è¡ commit æ rollback è¯­å¥ï¼æèæ­å¼è¿æ¥ã\n\nå»ºè®®ä½ æ»æ¯ä½¿ç¨set autocommit=1, éè¿æ¾å¼è¯­å¥çæ¹å¼æ¥å¯å¨äºå¡ã\n\n\n# å&äºãç´¢å¼\n\nç´¢å¼åºæ¯æ¨¡åï¼\n\n * åå¸è¡¨ï¼éç¨äºåªæç­å¼æ¥è¯¢çåºæ¯ã\n * æåºæ°ç»ï¼å¨ç­å¼æ¥è¯¢åèå´æ¥è¯¢åºæ¯ä¸­æ§è½ä¼ç§ãåªéç¨äºéæå­å¨å¼æï¼æ´æ°æ°æ®ä»£ä»·å¤ªé«ã\n * æç´¢æ ï¼Nåæ ï¼è¯»åæ§è½ä½³ï¼éåç£ççè®¿é®æ¨¡å¼ï¼å¹¿æ³åºç¨å¨æ°æ®åºå¼æä¸­ã\n * è·³è¡¨ãLSMæ ããã\n\nå¨MySQLä¸­ï¼ç´¢å¼æ¯å¨å­å¨å¼æå±å®ç°çï¼æä»¥å¹¶æ²¡æç»ä¸çç´¢å¼æ åï¼å³ä¸åå­å¨å¼æçç´¢ å¼çå·¥ä½æ¹å¼å¹¶ä¸ä¸æ ·ãèå³ä½¿å¤ä¸ªå­å¨å¼ææ¯æåä¸ç§ç±»åçç´¢å¼ï¼å¶åºå±çå®ç°ä¹å¯è½ä¸åã\n\n\n# InnoDBçç´¢å¼æ¨¡å\n\nInnoDBä½¿ç¨B+æ ç´¢å¼æ¨¡åã\n\næ¯ä¸ä¸ªç´¢å¼å¨InnoDBéå¯¹åºä¸æ£µB+æ ã\n\næ ¹æ®å¶å­èç¹çåå®¹ï¼ç´¢å¼ç±»ååä¸ºä¸»é®ç´¢å¼åéä¸»é®ç´¢å¼ã\n\nä¸»é®ç´¢å¼çå¶å­èç¹å­å¨çæ¯æ´è¡æ°æ®ãå¨InnoDBä¸­ï¼ä¸»é®ç´¢å¼ä¹è¢«ç§°ä¸ºèç°ç´¢å¼ï¼clustered indexï¼ã\n\néä¸»é®ç´¢å¼çå¶å­èç¹å­å¨çæ¯ä¸»é®çå¼ãå¨InnoDBä¸­ï¼éä¸»é®ç´¢å¼ä¹è¢«ç§°ä¸ºäºçº§ç´¢å¼ï¼secondary indexï¼ã\n\nå æ­¤ï¼åºäºä¸»é®ç´¢å¼åæ®éç´¢å¼çæ¥è¯¢çåºå«æ¯ï¼ä¸»é®æ¥è¯¢åªéè¦æç´¢IDè¿æ£µB+æ ï¼æ®éç´¢å¼æ¥è¯¢ï¼è¦åæç´¢æ®éç´¢å¼æ ï¼å¾å°IDåï¼åæç´¢IDç´¢å¼æ ãè¿ä¸ªè¿ç¨ç§°ä¸ºåè¡¨ã\n\nä¹å°±æ¯è¯´ï¼åºäºéä¸»é®ç´¢å¼çæ¥è¯¢éè¦å¤æ«æä¸æ£µç´¢å¼æ ãå æ­¤ï¼æä»¬å¨åºç¨ä¸­åºè¯¥å°½éä½¿ç¨ä¸»é®æ¥è¯¢ã\n\nä¸»é®é¿åº¦è¶å°ï¼ æ®éç´¢å¼çå¶å­èç¹å°±è¶å°ï¼ æ®éç´¢å¼å ç¨çç©ºé´ä¹å°±è¶å°ã\n\nä»æ§è½åå­å¨ç©ºé´æ¹é¢èéï¼èªå¢ä¸»é®å¾å¾æ¯æ´åççéæ©ãèªå¢ä¸»é®ä¹ä¸ä¼é æåè£ååå¹¶æä½ã\n\nQï¼éè¿ä¸¤ä¸ªalter è¯­å¥éå»ºç´¢å¼kï¼ä»¥åéè¿ä¸¤ä¸ªalterè¯­å¥éå»ºä¸»é®ç´¢å¼æ¯å¦åçï¼\n\néå»ºç´¢å¼kçåæ³æ¯åççï¼å¯ä»¥è¾¾å°çç©ºé´çç®çãä½æ¯ï¼éå»ºä¸»é®çè¿ç¨ä¸åçãä¸è®ºæ¯å é¤ä¸»é®è¿æ¯åå»ºä¸»é®ï¼é½ä¼å°æ´ä¸ªè¡¨éå»ºã\n\n\n# è¦çç´¢å¼\n\nç±äºè¦çç´¢å¼å¯ä»¥åå°æ çæç´¢æ¬¡æ°ï¼ æ¾èæåæ¥è¯¢æ§è½ï¼ æä»¥ä½¿ç¨è¦çç´¢å¼æ¯ä¸ä¸ªå¸¸ç¨çæ§è½ä¼åææ®µã\n\næä»¬ç¥éï¼èº«ä»½è¯å·æ¯å¸æ°çå¯ä¸æ è¯ãä¹å°±æ¯è¯´ï¼å¦æææ ¹æ®èº«ä»½è¯å·æ¥è¯¢å¸æ°ä¿¡æ¯çéæ±ï¼ æä»¬åªè¦å¨èº«ä»½è¯å·å­æ®µä¸å»ºç«ç´¢å¼å°±å¤äºãèåå»ºç«ä¸ä¸ªï¼èº«ä»½è¯å·ãå§åï¼çèåç´¢å¼ï¼æ¯ä¸æ¯æµªè´¹ç©ºé´ï¼\n\nå¦æç°å¨æä¸ä¸ªé«é¢è¯·æ±ï¼è¦æ ¹æ®å¸æ°çèº«ä»½è¯å·æ¥è¯¢ä»çå§åï¼è¿ä¸ªèåç´¢å¼å°±ææä¹äºãå® å¯ä»¥å¨è¿ä¸ªé«é¢è¯·æ±ä¸ç¨å°è¦çç´¢å¼ï¼ä¸åéè¦åè¡¨æ¥æ´è¡è®°å½ï¼åå°è¯­å¥çæ§è¡æ¶é´ã\n\nå½ç¶ï¼ç´¢å¼å­æ®µçç»´æ¤æ»æ¯æä»£ä»·çãå æ­¤ï¼å¨å»ºç«åä½ç´¢å¼æ¥æ¯æè¦çç´¢å¼æ¶å°±éè¦æè¡¡èè äºã\n\n\n# æå·¦åç¼åå\n\nå¨å»ºç«èåç´¢å¼çæ¶åï¼ å¦ä½å®æç´¢å¼åçå­æ®µé¡ºåºï¼\n\nè¿éæä»¬çè¯ä¼°æ åæ¯ï¼ç´¢å¼çå¤ç¨è½åãå ä¸ºå¯ä»¥æ¯ææå·¦åç¼ï¼æä»¥å½å·²ç»æäº(a,b)è¿ä¸ªèåç´¢å¼åï¼ä¸è¬å°±ä¸éè¦åç¬å¨aä¸å»ºç«ç´¢å¼äºãå æ­¤ï¼ç¬¬ä¸ååæ¯ï¼ å¦æéè¿è°æ´é¡ºåºï¼ å¯ä»¥å°ç»´æ¤ä¸ä¸ªç´¢å¼ï¼ é£ä¹è¿ä¸ªé¡ºåºå¾å¾å°±æ¯éè¦ä¼åèèéç¨çã\n\nå¦æä¸å¾ä¸ç»´æ¤å¦ä¸ä¸ªç´¢å¼ï¼é£ä¹è¦èèç©ºé´ã\n\n\n# ç´¢å¼ä¸æ¨\n\nå¨MySQL 5.6ä¹åï¼åªè½ä»ID3å¼å§ä¸ä¸ªä¸ªåè¡¨ãå°ä¸»é®ç´¢å¼ä¸æ¾åºæ°æ®è¡ï¼åå¯¹æ¯å­æ®µå¼ã\n\nèMySQL 5.6 å¼å¥çç´¢å¼ä¸æ¨ä¼åï¼index condition pushdown)ï¼ å¯ä»¥å¨ç´¢å¼éåè¿ç¨ä¸­ï¼å¯¹ç´¢å¼ä¸­åå«çå­æ®µååå¤æ­ï¼ç´æ¥è¿æ»¤æä¸æ»¡è¶³æ¡ä»¶çè®°å½ï¼åå°åè¡¨æ¬¡æ°ã\n\n\n# å­ãå¨å±éåè¡¨é\n\n\n# å¨å±é\n\næ ¹æ®å éçèå´ï¼ MySQLéé¢çéå¤§è´å¯ä»¥åæå¨å±éãè¡¨çº§éåè¡éä¸ç±» ã\n\né¡¾åæä¹ï¼å¨å±éå°±æ¯å¯¹æ´ä¸ªæ°æ®åºå®ä¾å éãMySQLæä¾äºä¸ä¸ªå å¨å±è¯»éçæ¹æ³ï¼å½ä»¤æ¯ Flush tables with read lock (FTWRL)ãå½ä½ éè¦è®©æ´ä¸ªåºå¤äºåªè¯»ç¶æçæ¶åï¼å¯ä»¥ä½¿ç¨è¿ä¸ªå½ä»¤ï¼ä¹åå¶ä»çº¿ç¨çä»¥ä¸è¯­å¥ä¼è¢«é»å¡ï¼æ°æ®æ´æ°è¯­å¥ï¼æ°æ®çå¢å æ¹ï¼ãæ°æ®å®ä¹è¯­å¥ï¼åæ¬ å»ºè¡¨ãä¿®æ¹è¡¨ç»æç­ï¼åæ´æ°ç±»äºå¡çæäº¤è¯­å¥ã\n\nå¨å±éçå¸åä½¿ç¨åºæ¯æ¯ï¼ åå¨åºé»è¾å¤ä»½ã ä¹å°±æ¯ææ´åºæ¯ä¸ªè¡¨é½selectåºæ¥å­æææ¬ã\n\nä¸å éçè¯ï¼å¤ä»½ç³»ç»å¤ä»½çå¾å°çåºä¸æ¯ä¸ä¸ªé»è¾æ¶é´ç¹ï¼è¿ä¸ªè§å¾æ¯é»è¾ä¸ä¸è´çã\n\nè¯´å°è§å¾ä½ è¯å®æ³èµ·æ¥äºï¼æä»¬å¨åé¢è®²äºå¡éç¦»çæ¶åï¼å¶å®æ¯æä¸ä¸ªæ¹æ³è½å¤æ¿å°ä¸è´æ§è§ å¾çï¼å¯¹å§ï¼\n\næ¯çï¼å°±æ¯å¨å¯éå¤è¯»éç¦»çº§å«ä¸å¼å¯ä¸ä¸ªäºå¡ã\n\nå®æ¹èªå¸¦çé»è¾å¤ä»½å·¥å·æ¯mysqldumpãå½mysqldumpä½¿ç¨åæ°âsingle-transactionçæ¶åï¼å¯¼ æ°æ®ä¹åå°±ä¼å¯å¨ä¸ä¸ªäºå¡ï¼æ¥ç¡®ä¿æ¿å°ä¸è´æ§è§å¾ãèç±äºMVCCçæ¯æï¼è¿ä¸ªè¿ç¨ä¸­æ°æ®æ¯å¯ä»¥æ­£å¸¸æ´æ°çã\n\nä½ ä¸å®å¨çæï¼æäºè¿ä¸ªåè½ï¼ä¸ºä»ä¹è¿éè¦FTWRLå¢ï¼ä¸è´æ§è¯»æ¯å¥½ï¼ä¸è´æ§è¯»æ¯å¥½ï¼ ä½åææ¯å¼æè¦æ¯ æè¿ä¸ªéç¦»çº§å«ã æ¯å¦ï¼å¯¹äºMyISAMè¿ç§ä¸æ¯æäºå¡çå¼æï¼å¦æå¤ä»½è¿ç¨ä¸­ææ´æ°ï¼æ»æ¯ åªè½åå°ææ°çæ°æ®ï¼é£ä¹å°±ç ´åäºå¤ä»½çä¸è´æ§ãè¿æ¶ï¼æä»¬å°±éè¦ä½¿ç¨FTWRLå½ä»¤äºã\n\næä»¥ï¼single-transactionæ¹æ³åªéç¨äºææçè¡¨ä½¿ç¨äºå¡å¼æçåºã å¦ææçè¡¨ä½¿ç¨äºä¸æ¯æäºå¡çå¼æï¼é£ä¹å¤ä»½å°±åªè½éè¿FTWRLæ¹æ³ãè¿å¾å¾æ¯DBAè¦æ±ä¸å¡å¼åäººåä½¿ç¨InnoDBæ¿ä»£MyISAMçåå ä¹ä¸ã\n\n\n# è¡¨çº§é\n\nMySQLéé¢è¡¨çº§å«çéæä¸¤ç§ï¼ä¸ç§æ¯è¡¨éï¼ä¸ç§æ¯åæ°æ®éï¼meta data lockï¼MDL)ã\n\nè¡¨éçè¯­æ³æ¯ lock tables â¦ read/writeã ä¸FTWRLç±»ä¼¼ï¼å¯ä»¥ç¨unlock tablesä¸»å¨éæ¾éï¼ ä¹å¯ä»¥å¨å®¢æ·ç«¯æ­å¼çæ¶åèªå¨éæ¾ãéè¦æ³¨æï¼lock tablesè¯­æ³é¤äºä¼éå¶å«ççº¿ç¨çè¯»åå¤ï¼ä¹éå®äºæ¬çº¿ç¨æ¥ä¸æ¥çæä½å¯¹è±¡ã\n\nå¦ä¸ç±»è¡¨çº§çéæ¯ MDLï¼ metadata lock)ã MDLä¸éè¦æ¾å¼ä½¿ç¨ï¼å¨è®¿é®ä¸ä¸ªè¡¨çæ¶åä¼è¢« èªå¨å ä¸ãMDLçä½ç¨æ¯ï¼ä¿è¯è¯»åçæ­£ç¡®æ§ãä½ å¯ä»¥æ³è±¡ä¸ä¸ï¼å¦æä¸ä¸ªæ¥è¯¢æ­£å¨éåä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼èæ§è¡æé´å¦ä¸ä¸ªçº¿ç¨å¯¹è¿ä¸ªè¡¨ç»æååæ´ï¼å äºä¸åï¼é£ä¹æ¥è¯¢çº¿ç¨æ¿å°çç»æè·è¡¨ç»æå¯¹ä¸ä¸ï¼è¯å®æ¯ä¸è¡çã\n\nå æ­¤ï¼å¨MySQL 5.5çæ¬ä¸­å¼å¥äºMDLï¼å½å¯¹ä¸ä¸ªè¡¨åå¢å æ¹æ¥æä½çæ¶åï¼å MDLè¯»éï¼å½ è¦å¯¹è¡¨åç»æåæ´æä½çæ¶åï¼å MDLåéã\n\nQï¼å¦æä½ è¦åæ´çè¡¨æ¯ä¸ä¸ªç­ç¹è¡¨ï¼è½ç¶æ°æ®éä¸å¤§ï¼ä½æ¯ä¸é¢çè¯·æ±å¾é¢ ç¹ï¼èä½ ä¸å¾ä¸å ä¸ªå­æ®µï¼ä½ è¯¥æä¹åå¢ï¼\n\næ¯è¾çæ³çæºå¶æ¯ï¼å¨alter tableè¯­å¥éé¢ è®¾å®ç­å¾æ¶é´ï¼å¦æå¨è¿ä¸ªæå®çç­å¾æ¶é´éé¢è½å¤æ¿å°MDLåéæå¥½ï¼æ¿ä¸å°ä¹ä¸è¦é»å¡å é¢çä¸å¡è¯­å¥ï¼åæ¾å¼ãä¹åå¼åäººåæèDBAåéè¿éè¯å½ä»¤éå¤è¿ä¸ªè¿ç¨ã\n\nMariaDBå·²ç»åå¹¶äºAliSQLçè¿ä¸ªåè½ï¼æä»¥è¿ä¸¤ä¸ªå¼æºåæ¯ç®åé½æ¯æDDL NOWAIT/WAIT nè¿ä¸ªè¯­æ³ã\n\n\n# å°ç»\n\n * å¨å±éä¸»è¦ç¨å¨é»è¾å¤ä»½è¿ç¨ä¸­ãå¯¹äºå¨é¨æ¯InnoDBå¼æçåºï¼æå»ºè®®ä½ éæ©ä½¿ç¨âsingletransactionåæ°ï¼å¯¹åºç¨ä¼æ´åå¥½ã\n * è¡¨éä¸è¬æ¯å¨æ°æ®åºå¼æä¸æ¯æè¡éçæ¶åæä¼è¢«ç¨å°çãå¦æä½ åç°ä½ çåºç¨ç¨åºéælock tablesè¿æ ·çè¯­å¥ï¼ä½ éè¦è¿½æ¥ä¸ä¸ï¼æ¯è¾å¯è½çæåµæ¯ï¼\n   * è¦ä¹æ¯ä½ çç³»ç»ç°å¨è¿å¨ç¨MyISAMè¿ç±»ä¸æ¯æäºå¡çå¼æï¼é£è¦å®æåçº§æ¢å¼æï¼\n   * è¦ä¹æ¯ä½ çå¼æåçº§äºï¼ä½æ¯ä»£ç è¿æ²¡åçº§ãæè§è¿è¿æ ·çæåµï¼æåä¸å¡å¼åå°±æ¯ælock tables å unlock tables æ¹æ begin å commitï¼é®é¢å°±è§£å³äºã\n   * MDLä¼ç´å°äºå¡æäº¤æéæ¾ï¼å¨åè¡¨ç»æåæ´çæ¶åï¼ä½ ä¸å®è¦å°å¿ä¸è¦å¯¼è´éä½çº¿ä¸æ¥è¯¢åæ´æ°ã\n\n\n# ä¹ãæ®éç´¢å¼åå¯ä¸ç´¢å¼çéæ©\n\nç±äºå¯ä¸ç´¢å¼ç¨ä¸ä¸change bufferçä¼åæºå¶ï¼å æ­¤å¦æä¸å¡å¯ä»¥æ¥åï¼ä»æ§è½è§åº¦åºåæå»ºè®®ä½ ä¼åèèéå¯ä¸ç´¢å¼ã\n\n\n# åãMySQLä¸ºä»ä¹ææ¶åä¼ééç´¢å¼ï¼\n\nç±äºç´¢å¼ç»è®¡çæ´æ°æºå¶ï¼ç»è®¡çè¡æ°ææ¶ä¼æåå·®ã\n\nèä¸ä¼åå¨å­å¨ééç´¢å¼çå¯è½æ§ãä¼åå¨éæ©ç´¢å¼çç®çï¼æ¯æ¾å°ä¸ä¸ªæä¼çæ§è¡æ¹æ¡ï¼å¹¶ç¨æå°çä»£ä»·å»æ§è¡è¯­å¥ãå¨æ°æ®åºéé¢ï¼æ«æè¡æ°æ¯å½±åæ§è¡ä»£ä»·çå ç´ ä¹ä¸ãæ«æçè¡æ°è¶å°ï¼æå³çè®¿é®ç£çæ°æ®çæ¬¡æ°è¶å°ï¼æ¶èçCPUèµæºè¶å°ã\n\næ«æè¡æ°å¹¶ä¸æ¯å¯ä¸çå¤æ­æ åï¼ä¼åå¨è¿ä¼ç»åæ¯å¦ä½¿ç¨ä¸´æ¶è¡¨ãæ¯å¦æåºç­å ç´ è¿è¡ç»¼åå¤æ­ã\n\nå¯¹äºç±äºç´¢å¼ç»è®¡ä¿¡æ¯ä¸åç¡®å¯¼è´çé®é¢ï¼ä½ å¯ä»¥ç¨analyze table t è¯­å¥æ¥è§£å³ãï¼éæ°ç»è®¡ç´¢å¼ä¿¡æ¯ï¼\n\nèå¯¹äºå¶ä»ä¼åå¨è¯¯å¤çæåµï¼ä½ å¯ä»¥å¨åºç¨ç«¯ç¨force indexæ¥å¼ºè¡æå®ç´¢å¼ï¼ä¹å¯ä»¥éè¿ä¿®æ¹è¯­å¥æ¥å¼å¯¼ä¼åå¨ï¼è¿å¯ä»¥éè¿å¢å æèå é¤ç´¢å¼æ¥ç»è¿è¿ä¸ªé®é¢ã\n\nä¼°è®¡è®°å½æ°\n\nmysqléè¿ç»è®¡ä¿¡æ¯æ¥ä¼°ç®è®°å½æ°ï¼è¿ä¸ªç»è®¡ä¿¡æ¯å°±æ¯ç´¢å¼çâåºååº¦âãä¸ä¸ªç´¢å¼ä¸ä¸åçå¼è¶å¤ï¼è¿ä¸ªç´¢å¼çåºååº¦å°±è¶å¥½ãèä¸ä¸ªç´¢å¼ä¸ä¸åå¼çä¸ªæ°ï¼ç§°ä¸ºâåºæ°âï¼cardinalityï¼ã\n\nå¯ä½¿ç¨show index from tï¼æ¥çç´¢å¼çåºæ°ã\n\nmysqléè¿éæ ·ç»è®¡æ¥å¾å°ç´¢å¼çåºæ°ãInnoDBé»è®¤éæ©Nä¸ªæ°æ®é¡µï¼ç»è®¡è¿äºé¡µé¢ä¸çä¸éå¼ï¼å¾å°ä¸ä¸ªå¹³åå¼ï¼ç¶åä¹ä»¥è¿ç´¢å¼çé¡µé¢æ°ï¼å¾å°è¿ä¸ªç´¢å¼çåºæ°ãå½æ°æ®è¡æ°è¶è¿1/Mçæ¶åï¼ä¼èªå¨è§¦åéæ°åä¸æ¬¡ç»è®¡ææã\n\nå¨MySQLä¸­ï¼æä¸¤ç§å­å¨ç´¢å¼ç»è®¡çæ¹å¼ï¼å¯ä»¥éè¿è®¾ç½®åæ°innodb_stats_persistentçå¼æ¥éæ©ï¼\n\n * è®¾ç½®ä¸ºonçæ¶åï¼è¡¨ç¤ºç»è®¡ä¿¡æ¯ä¼æä¹åå­å¨ãè¿æ¶ï¼é»è®¤çNæ¯20ï¼Mæ¯10ã\n\n * è®¾ç½®ä¸ºoffçæ¶åï¼è¡¨ç¤ºç»è®¡ä¿¡æ¯åªå­å¨å¨åå­ä¸­ãè¿æ¶ï¼é»è®¤çNæ¯8ï¼Mæ¯16ã\n\n * ç±äºæ¯éæ ·ç»è®¡ï¼æä»¥ä¸ç®¡Næ¯20è¿æ¯8ï¼è¿ä¸ªåºæ°é½æ¯å¾å®¹æä¸åçã\n\n\n# åä¸ãæä¹ç»å­ç¬¦ä¸²å­æ®µå ç´¢å¼ï¼\n\nmysqlæ¯æåç¼ç´¢å¼ï¼å¯ä»¥å®ä¹å­ç¬¦ä¸²çä¸é¨åä½ä¸ºç´¢å¼ãé»è®¤ç´¢å¼åå«æ´ä¸ªå­ç¬¦ä¸²ã\n\nalter table user add index index1(email);\n\nalter table user add index index2(email(6));\n\n\nä½¿ç¨åç¼ç´¢å¼å¯ä»¥åå°ç©ºé´å ç¨ï¼è¿æ¯ä¼å¿ãä½å¯è½å¯¼è´æ¥è¯¢è¯­å¥è¯»æ°æ®çæ¬¡æ°åå¤ã\n\nå æ­¤ä½¿ç¨åç¼ç´¢å¼ï¼éè¦å®ä¹å¥½é¿åº¦ï¼è¾¾å°å³çç©ºé´ï¼åä¸ç¨é¢å¤å¢å å¤ªå¤çæ¥è¯¢ææ¬ã\n\nå¯ä»¥ä½¿ç¨ä¸ä¸æ¹æ³å¤æ­åç¼çåéé¿åº¦ï¼(è®¾å®ä¸ä¸ªå¯ä»¥æ¥åçæå¤±æ¯ä¾)\n\nselect count(distinct email) as L from user;\n\nselect\n\tcount(distinct left(emial, 4)) as L4,\n\tcount(distinct left(emial, 5)) as L5,\n\tcount(distinct left(emial, 6)) as L6,\n\tcount(distinct left(emial, 7)) as L7,\nfrom user;\n\n\næ­¤å¤ï¼ä½¿ç¨åç¼ç´¢å¼å°±ç¨ä¸ä¸è¦çç´¢å¼å¯¹æ¥è¯¢æ§è½çä¼åã\n\nåç¼å¤æ°ç¸åæ¶çç´¢å¼æè·¯ï¼\n\n * ååºå­å¨\n * å¢å hashå­æ®µï¼å¦ç¨crc()å¾å°æ ¡éªç ã\n\næ»ç»ï¼\n\n 1. ç´æ¥åå»ºå®æ´ç´¢å¼ï¼è¿æ ·å¯è½æ¯è¾å ç¨ç©ºé´ï¼\n 2. åå»ºåç¼ç´¢å¼ï¼èçç©ºé´ï¼ä½ä¼å¢å æ¥è¯¢æ«ææ¬¡æ°ï¼å¹¶ä¸ä¸è½ä½¿ç¨è¦çç´¢å¼ï¼\n 3. ååºå­å¨ï¼ååå»ºåç¼ç´¢å¼ï¼ç¨äºç»è¿å­ç¬¦ä¸²æ¬èº«åç¼çåºååº¦ä¸å¤çé®é¢ï¼\n 4. åå»ºhashå­æ®µç´¢å¼ï¼æ¥è¯¢æ§è½ç¨³å®ï¼æé¢å¤çå­å¨åè®¡ç®æ¶èï¼è·ç¬¬ä¸ç§æ¹å¼ä¸æ ·ï¼é½ä¸æ¯æèå´æ«æã\n\n\n# åäºãä¸ºä»ä¹æçSQLä¼âæâä¸ä¸\n\nå½åå­æ°æ®é¡µè·ç£çæ°æ®é¡µåå®¹ä¸ä¸è´çæ¶åï¼ æä»¬ç§°è¿ä¸ªåå­é¡µä¸º â èé¡µ â ã\n\nå¹³æ¶æ§è¡å¾å¿«çæ´æ°æä½ï¼å¶å®å°±æ¯å¨ååå­åæ¥å¿ï¼è MySQLå¶å°âæâä¸ä¸çé£ä¸ªç¬é´ï¼å¯è½å°±æ¯å¨å·èé¡µï¼flushï¼ã\n\nä»ä¹æåµä¼å¼åæ°æ®åºflushï¼\n\n * InnoDBçredo logåæ»¡äºãè¿æ¶åç³»ç»ä¼åæ­¢æææ´æ°æä½ï¼æ checkpointå¾åæ¨è¿ï¼redo logçåºç©ºé´å¯ä»¥ç»§ç»­åã\n * ç³»ç»åå­ä¸è¶³ãéè¦æ·æ±°ä¸äºæ°æ®é¡µï¼å¦ææ·æ±°çæ¯èé¡µå°±è¦åæèé¡µåå°ç£çã\n * mysqlè®¤ä¸ºç³»ç»ç©ºé²æ¶ã\n * mysqlæ­£å¸¸å³é­æ¶ã\n\næä»¥ï¼å·èé¡µè½ç¶æ¯å¸¸æï¼ä½æ¯åºç°ä»¥ä¸è¿ä¸¤ç§æåµï¼é½æ¯ä¼ææ¾å½±åæ§è½çï¼\n\n 1. ä¸ä¸ªæ¥è¯¢è¦æ·æ±°çèé¡µä¸ªæ°å¤ªå¤ï¼ä¼å¯¼è´æ¥è¯¢çååºæ¶é´ææ¾åé¿ï¼\n\n 2. æ¥å¿åæ»¡ï¼æ´æ°å¨é¨å µä½ï¼åæ§è½è·ä¸º0ï¼è¿ç§æåµå¯¹ææä¸å¡æ¥è¯´ï¼æ¯ä¸è½æ¥åçã\n\næä»¥ï¼InnoDBéè¦ææ§å¶èé¡µæ¯ä¾çæºå¶ï¼æ¥å°½éé¿åä¸é¢çè¿ä¸¤ç§æåµã\n\néè¿innodb_io_capacityåè¯InnoDBä½ çç£çè½åï¼å¨åå·èé¡µæ¶å¯ä»¥å¤å¿«ãå»ºè®®è®¾ä¸ºç£ççIOPSã\n\nåæ°innodb_max_dirty_pages_pctæ¯èé¡µæ¯ä¾ä¸éï¼é»è®¤å¼æ¯75%ã\n\nå¹³æ¶è¦å¤å³æ³¨èé¡µæ¯ä¾ï¼ ä¸è¦è®©å®ç»å¸¸æ¥è¿ 75%ã\n\ninnodb_flush_neighbors åæ°å¼ä¸º1çæ¶åä¼æâè¿åâæºå¶ï¼å¼ä¸º0æ¶è¡¨ç¤ºä¸æ¾é»å±ï¼èªå·±å·èªå·±çãå¨MySQL 8.0ä¸­ï¼innodb_flush_neighborsåæ°çé»è®¤å¼å·²ç»æ¯0äºã\n\n\n# åä¸ãä¸ºä»ä¹è¡¨æ°æ®å æä¸åï¼è¡¨æä»¶å¤§å°ä¸åï¼\n\nå¦æè¦æ¶ç¼©ä¸ä¸ªè¡¨ï¼åªæ¯deleteæè¡¨éé¢ä¸ç¨çæ°æ®çè¯ï¼è¡¨æä»¶çå¤§å°æ¯ä¸ä¼åçï¼ä½ è¿è¦éè¿alter tableå½ä»¤éå»ºè¡¨ï¼æè½è¾¾å°è¡¨æä»¶åå°çç®çãæè·ä½ ä»ç»äºéå»º è¡¨çä¸¤ç§å®ç°æ¹å¼ï¼Online DDLçæ¹å¼æ¯å¯ä»¥èèå¨ä¸å¡ä½å³°æä½¿ç¨çï¼èMySQL 5.5åä¹åç çæ¬ï¼è¿ä¸ªå½ä»¤æ¯ä¼é»å¡DMLçï¼è¿ä¸ªä½ éè¦ç¹å«å°å¿ã\n\noptimize tableãanalyze tableåalter tableè¿ä¸ç§æ¹å¼éå»ºè¡¨çåºå«ã\n\n * ä»MySQL 5.6çæ¬å¼å§ï¼alter table t engine = InnoDBï¼ä¹å°±æ¯recreateï¼é»è®¤çå°±æ¯ä¸é¢å¾4çæµç¨äºï¼\n * analyze table t å¶å®ä¸æ¯éå»ºè¡¨ï¼åªæ¯å¯¹è¡¨çç´¢å¼ä¿¡æ¯åéæ°ç»è®¡ï¼æ²¡æä¿®æ¹æ°æ®ï¼è¿ä¸ªè¿ç¨ä¸­å äºMDLè¯»éï¼\n * optimize table t ç­äºrecreate+analyzeã\n\n\n# ååãcount(*)è¿ä¹æ¢ï¼æä¹åï¼\n\n * MyISAMè¡¨è½ç¶count(*)å¾å¿«ï¼ä½æ¯ä¸æ¯æäºå¡ï¼\n * show table statuså½ä»¤è½ç¶è¿åå¾å¿«ï¼ä½æ¯ä¸åç¡®ï¼\n * InnoDBè¡¨ç´æ¥count(*)ä¼éåå¨è¡¨ï¼è½ç¶ç»æåç¡®ï¼ä½ä¼å¯¼è´æ§è½é®é¢ã\n\nç¨redisæèæ¯ç¨å¦ä¸å¼ è¡¨è®°å½æ»æ°ï¼é½ä¼åºç°æ°æ®ä¸ä¸è´çæåµã\n\næè®¡æ°æ¾å¨Rediséé¢ï¼ä¸è½å¤ä¿è¯è®¡æ°åMySQLè¡¨éçæ°æ®ç²¾ç¡®ä¸è´çåå ï¼æ¯è¿ä¸¤ä¸ªè¿ä¸¤ä¸ªä¸åçå­å¨ææçç³»ç»ï¼ ä¸æ¯æåå¸å¼äºå¡ï¼ æ æ³æ¿å°ç²¾ç¡®ä¸è´çè§å¾ã\n\nèæè®¡æ°å¼ä¹æ¾å¨ MySQLä¸­ï¼å°±è§£å³äºä¸è´æ§è§å¾çé®é¢ã InnoDBå¼ææ¯æäºå¡ï¼æä»¬å©ç¨å¥½äºå¡çåå­æ§åéç¦»æ§ï¼å°±å¯ä»¥ç®åå¨ä¸å¡å¼åæ¶çé»è¾ã è¿ä¹æ¯InnoDBå¼æå¤åéççåå ä¹ä¸ã\n\né®é¢é½æ¯ç±äºInnoDBè¦æ¯æäºå¡ï¼ä»èå¯¼è´InnoDBè¡¨ä¸è½æcount(*) ç´æ¥å­èµ·æ¥ï¼ç¶åæ¥è¯¢çæ¶åç´æ¥è¿åå½¢æçã æè°ä»¥å­ä¹çæ»å­ä¹ç¾ï¼ç°å¨æä»¬å°±å©ç¨âäºå¡âè¿ä¸ªç¹æ§ï¼æé®é¢è§£å³æã\n\n\n\ncount()çè¯­ä¹ãcount()æ¯ä¸ä¸ªèåå½æ°ï¼å¯¹äºè¿åçç»æéï¼ä¸è¡è¡å°å¤æ­ï¼å¦æcountå½æ°çåæ°ä¸æ¯NULLï¼ç´¯è®¡å¼å°±å 1ï¼å¦åä¸å ãæåè¿åç´¯è®¡å¼ã\n\næä»¥ï¼count(*)ãcount(ä¸»é®id)åcount(1) é½è¡¨ç¤ºè¿åæ»¡è¶³æ¡ä»¶çç»æéçæ»è¡æ°ï¼ècount(å­æ®µï¼ï¼åè¡¨ç¤ºè¿åæ»¡è¶³æ¡ä»¶çæ°æ®è¡éé¢ï¼åæ°âå­æ®µâä¸ä¸ºNULLçæ»ä¸ªæ°ã\n\nåææ§è½å·®å«ï¼\n\n * serverå±è¦ä»ä¹å°±ç»ä»ä¹ï¼\n * InnoDBåªç»å¿è¦çå¼ï¼\n * ç°å¨çä¼åå¨åªä¼åäºcount(*)çè¯­ä¹ä¸ºâåè¡æ°âï¼å¶ä»âæ¾èæè§âçä¼åå¹¶æ²¡æåã\n\nç»è®ºæ¯ï¼æç§æçæåºçè¯ï¼count(å­æ®µ)<count(ä¸»é®id)<count(1)âcount(*)ï¼æä»¥æå»ºè®®ä½ ï¼å°½éä½¿ç¨count(*)ã\n\n\n# åäºãç­çï¼æ¥å¿åç´¢å¼ç¸å³\n\nå´©æºæ¢å¤æ¶çå¤æ­è§åï¼\n\n 1. å¦æredo logéé¢çäºå¡æ¯å®æ´çï¼ä¹å°±æ¯å·²ç»æäºcommitæ è¯ï¼åç´æ¥æäº¤ã\n 2. å¦æredo logéé¢çäºå¡åªæå®æ´çprepareï¼åå¤æ­å¯¹åºçäºå¡binlogæ¯å¦å­å¨å¹¶å®æ´ï¼\n    1. å¦ææ¯ï¼åæäº¤äºå¡ã\n    2. å¦åï¼åæ»äºå¡ã\n\nmysqlæä¹ç¥ébinlogæ¯å¦å®æ´ï¼\n\nä¸ä¸ªäºå¡çbinlogæ¯ç±å®æ´æ ¼å¼çï¼\n\n * statementæ ¼å¼çbinlogï¼æåä¼æCOMMITï¼\n * rowæ ¼å¼çbinlogï¼æåä¼æä¸ä¸ªXID eventï¼\n\nå¦å¤ï¼å¨MySQL 5.6.2åï¼è¿å¼å¥äºbinlog-checksumåæ°ï¼ç¨æ¥éªè¯binlogåå®¹çæ­£ç¡®æ§ã\n\nredo log å binlogæ¯æä¹å³èèµ·æ¥çï¼\n\nä»ä»¬æä¸ä¸ªå±åçæ°æ®å­æ®µï¼å«XIDï¼å´©æºæ¢å¤æ¶ï¼ä¼æé¡ºåºæ«æredo logï¼\n\n * å¦æç¢°å°æ¢æprepareï¼åæcommitçredo logï¼ç´æ¥æäº¤ã\n * å¦æç¢°å°åªæprepareï¼æ²¡æcommitçredo logï¼å°±æ¿çXIDå»binlogæ¾å¯¹åºçäºå¡ã\n\n\n# åå­ãorder byæ¯æä¹å·¥ä½çï¼\n\néå¸¸æåµä¸ï¼å¨å­æ®µæåºï¼\n\n 1. åå§åsort_bufferï¼ç¡®å®æ¾å¥nameãcityãageè¿ä¸ä¸ªå­æ®µï¼\n\n 2. ä»ç´¢å¼cityæ¾å°ç¬¬ä¸ä¸ªæ»¡è¶³city='æ­å·âæ¡ä»¶çä¸»é®idï¼ä¹å°±æ¯å¾ä¸­çID_Xï¼\n\n 3. å°ä¸»é®idç´¢å¼ååºæ´è¡ï¼ånameãcityãageä¸ä¸ªå­æ®µçå¼ï¼å­å¥sort_bufferä¸­ï¼\n\n 4. ä»ç´¢å¼cityåä¸ä¸ä¸ªè®°å½çä¸»é®idï¼\n\n 5. éå¤æ­¥éª¤3ã4ç´å°cityçå¼ä¸æ»¡è¶³æ¥è¯¢æ¡ä»¶ä¸ºæ­¢ï¼å¯¹åºçä¸»é®idä¹å°±æ¯å¾ä¸­çID_Yï¼\n\n 6. å¯¹sort_bufferä¸­çæ°æ®æç§å­æ®µnameåå¿«éæåºï¼\n\n 7. æç§æåºç»æåå1000è¡è¿åç»å®¢æ·ç«¯ã\n\nå¦æmysqlè®¤ä¸ºæåºçåè¡é¿åº¦å¤ªå¤§ä¼éç¨rowidæåºï¼\n\nï¼å³æ°çç®æ³æ¾å¥sort_bufferçå­æ®µï¼åªæè¦æåºçåï¼å³nameå­æ®µï¼åä¸»é®idï¼ç¶ååä»åè¡¨åï¼\n\n 1. åå§åsort_bufferï¼ç¡®å®æ¾å¥ä¸¤ä¸ªå­æ®µï¼å³nameåidï¼\n\n 2. ä»ç´¢å¼cityæ¾å°ç¬¬ä¸ä¸ªæ»¡è¶³city='æ­å·âæ¡ä»¶çä¸»é®idï¼ä¹å°±æ¯å¾ä¸­çID_Xï¼\n\n 3. å°ä¸»é®idç´¢å¼ååºæ´è¡ï¼ånameãidè¿ä¸¤ä¸ªå­æ®µï¼å­å¥sort_bufferä¸­ï¼\n\n 4. ä»ç´¢å¼cityåä¸ä¸ä¸ªè®°å½çä¸»é®idï¼\n\n 5. éå¤æ­¥éª¤3ã4ç´å°ä¸æ»¡è¶³city='æ­å·âæ¡ä»¶ä¸ºæ­¢ï¼ä¹å°±æ¯å¾ä¸­çID_Yï¼\n\n 6. å¯¹sort_bufferä¸­çæ°æ®æç§å­æ®µnameè¿è¡æåºï¼\n\n 7. éåæåºç»æï¼åå1000è¡ï¼å¹¶æç§idçå¼åå°åè¡¨ä¸­ååºcityãnameåageä¸ä¸ªå­æ®µè¿å\n\nç»å®¢æ·ç«¯ã\n\nå¦æMySQLå®å¨æ¯æå¿æåºåå­å¤ªå°ï¼ä¼å½±åæåºæçï¼æä¼éç¨rowidæåºç®æ³ï¼è¿æ ·æåºè¿ ç¨ä¸­ä¸æ¬¡å¯ä»¥æåºæ´å¤è¡ï¼ä½æ¯éè¦ååå°åè¡¨å»åæ°æ®ã\n\nå¦æMySQLè®¤ä¸ºåå­è¶³å¤å¤§ï¼ä¼ä¼åéæ©å¨å­æ®µæåºï¼æéè¦çå­æ®µé½æ¾å°sort_bufferä¸­ï¼è¿æ ·æåºåå°±ä¼ç´æ¥ä»åå­éé¢è¿åæ¥è¯¢ç»æäºï¼ä¸ç¨ååå°åè¡¨å»åæ°æ®ã\n\nè¿ä¹å°±ä½ç°äºMySQLçä¸ä¸ªè®¾è®¡ææ³ï¼å¦æåå­å¤ï¼å¦æåå­å¤ï¼ å°±è¦å¤å©ç¨åå­ï¼ å°½éåå°ç£çè®¿é®ã\n\nä¼åï¼ï¼ç´¢å¼çç»´æ¤æä»£ä»·ï¼éè¦æè¡¡ï¼\n\n * å¦æä»ç´¢å¼ä¸ååºæ¥çè¡ï¼å¤©ç¶å°±æåºå¥½äºçè¯ï¼å°±å¯ä»¥ä¸ç¨åæåºäºãå¯ä»¥ä½¿ç¨èåç´¢å¼ã\n * è¿å¯ä»¥è¦çç´¢å¼ï¼ä½¿å¶ç´æ¥è¿åéè¦çå¼ãï¼ä¹æ¯ç¨ä¸èåç´¢å¼ï¼\n\n\n# åä¸ãå¦ä½æ­£ç¡®å°æ¾ç¤ºéæºæ¶æ¯\n\n# éæºéæ©3ä¸ªåè¯\nselect word from words order by rand() limit 3;\n\n\nè¿æ¡è¯­å¥çæ§è¡æµç¨æ¯è¿æ ·çï¼\n\n 1. åå»ºä¸ä¸ªä¸´æ¶è¡¨ãè¿ä¸ªä¸´æ¶è¡¨ä½¿ç¨çæ¯memoryå¼æï¼è¡¨éæä¸¤ä¸ªå­æ®µï¼ç¬¬ä¸ä¸ªå­æ®µæ¯ doubleç±»åï¼ä¸ºäºåé¢æè¿°æ¹ä¾¿ï¼è®°ä¸ºå­æ®µRï¼ç¬¬äºä¸ªå­æ®µæ¯varchar(64)ç±»åï¼è®°ä¸ºå­æ®µ\n\nWãå¹¶ä¸ï¼è¿ä¸ªè¡¨æ²¡æå»ºç´¢å¼ã\n\n 2. ä»wordsè¡¨ä¸­ï¼æä¸»é®é¡ºåºååºææçwordå¼ãå¯¹äºæ¯ä¸ä¸ªwordå¼ï¼è°ç¨rand()å½æ°çæä¸\n\nä¸ªå¤§äº0å°äº1çéæºå°æ°ï¼å¹¶æè¿ä¸ªéæºå°æ°åwordåå«å­å¥ä¸´æ¶è¡¨çRåWå­æ®µä¸­ï¼å° æ­¤ï¼æ«æè¡æ°æ¯10000ã 3. ç°å¨ä¸´æ¶è¡¨æ10000è¡æ°æ®äºï¼æ¥ä¸æ¥ä½ è¦å¨è¿ä¸ªæ²¡æç´¢å¼çåå­ä¸´æ¶è¡¨ä¸ï¼æç§å­æ®µRæ\n\nåºã 4. åå§å sort_bufferãsort_bufferä¸­æä¸¤ä¸ªå­æ®µï¼ä¸ä¸ªæ¯doubleç±»åï¼å¦ä¸ä¸ªæ¯æ´åã\n\n 5. ä»åå­ä¸´æ¶è¡¨ä¸­ä¸è¡ä¸è¡å°ååºRå¼åä½ç½®ä¿¡æ¯ï¼æåé¢ä¼åä½ è§£éè¿éä¸ºä»ä¹æ¯âä½ç½®ä¿¡ æ¯âï¼ï¼åå«å­å¥sort_bufferä¸­çä¸¤ä¸ªå­æ®µéãè¿ä¸ªè¿ç¨è¦å¯¹åå­ä¸´æ¶è¡¨åå¨è¡¨æ«æï¼æ­¤æ¶ æ«æè¡æ°å¢å 10000ï¼åæäº20000ã\n\n 6. å¨sort_bufferä¸­æ ¹æ®Rçå¼è¿è¡æåºãæ³¨æï¼è¿ä¸ªè¿ç¨æ²¡ææ¶åå°è¡¨æä½ï¼æä»¥ä¸ä¼å¢å æ«\n\næè¡æ°ã\n\n 7. æåºå®æåï¼ååºåä¸ä¸ªç»æçä½ç½®ä¿¡æ¯ï¼ä¾æ¬¡å°åå­ä¸´æ¶è¡¨ä¸­ååºwordå¼ï¼è¿åç»å®¢æ·\n\nç«¯ãè¿ä¸ªè¿ç¨ä¸­ï¼è®¿é®äºè¡¨çä¸è¡æ°æ®ï¼æ»æ«æè¡æ°åæäº20003ã\n\nå°ç»ï¼order by rand()ä½¿ç¨äºåå­ä¸´æ¶è¡¨ï¼ åå­ä¸´æ¶è¡¨æåºçæ¶åä½¿ç¨äº rowidæåºæ¹æ³ã\n\n * å¯¹äºå¯¹äº InnoDBè¡¨æ¥è¯´ ï¼æ§è¡å¨å­æ®µæåºä¼åå°ç£çè®¿é®ï¼å æ­¤ä¼è¢«ä¼åéæ©ã\n\n * èå¯¹äºåå­è¡¨ï¼ åè¡¨è¿ç¨åªæ¯ç®åå°æ ¹æ®æ°æ®è¡çä½ ç½®ï¼ ç´æ¥è®¿é®åå­å¾å°æ°æ®ï¼ æ ¹æ¬ä¸ä¼å¯¼è´å¤è®¿é®ç£ç ãä¼åå¨æ²¡æäºè¿ä¸å±é¡¾èï¼é£ä¹å® ä¼ä¼åèèçï¼å°±æ¯ç¨äºæåºçè¡é¿åº¦è¶å°è¶å¥½äºï¼æä»¥ï¼MySQLè¿æ¶å°±ä¼éæ©rowidæåºã\n\ntmp_table_sizeéç½®åå­ä¸´æ¶è¡¨çå¤§å°ï¼é»è®¤æ¯16Mï¼è¶è¿æ¶ä¼è½¬æç£çä¸´æ¶è¡¨ã\n\nMySQL 5.6çæ¬å¼å¥çä¸ä¸ªæ°çæåºç®æ³ï¼ å³ï¼ä¼åéåæåºç®æ³ãï¼ç»´æ¤äºä¸ä¸ªå ï¼\n\nä¸´æ¶æä»¶çç®æ³ä¹å°±æ¯å½å¹¶ç®æ³ã\n\nå¦æä½ ç´æ¥ä½¿ç¨order by rand()ï¼è¿ä¸ªè¯­å¥éè¦Using temporary å Using filesortï¼æ¥è¯¢çæ§è¡ä»£ä»·å¾å¾æ¯æ¯è¾å¤§çãæä»¥ï¼å¨è®¾è®¡çæ¶åä½ è¦éé¿å¼è¿ç§åæ³ã\n\nä¸ºäºè¾¾å°ä¸¥æ ¼çéæºç»æï¼\n\n 1. åå°æ´ä¸ªè¡¨çè¡æ°ï¼è®°ä½Cã\n 2. åå°Y = floor(C * rand())ãfloorå¨è¿éçä½ç¨ï¼å°±æ¯åæ´æ°é¨åã\n 3. åç¨limit Y, 1åå¾ä¸è¡ã\n\n\n# åå«ãä¸ºä»ä¹é»è¾ç¸åçSQLè¯­å¥ï¼æ§è½å·®å¼å·¨å¤§ï¼åpassï¼\n\nå°ç»ï¼å¯¹ç´¢å¼å­æ®µåå½æ°æä½ï¼å¯è½ä¼ç ´åç´¢å¼å¼çæåºæ§ï¼å æ­¤ä¼åå¨å°±å³å®æ¾å¼èµ°æ æç´¢åè½ã\n\n\n# åä¹ãä¸ºä»ä¹åªæ¥ä¸è¡çè¯­å¥ï¼ä¹æ§è¡æ¢ï¼\n\nåæåå æ¶åï¼ä¸è¬åæ§è¡show processlistï¼ççå½åè¯­å¥å¤äºä»ä¹ç¶æã\n\nç¬¬ä¸ç±»ï¼æ¥è¯¢é¿æ¶é´ä¸è¿å\n\n * ç­MDLé\n   \n   åºç°Waiting for table metadata lockï¼è¡¨ç¤ºç°å¨æä¸ä¸ªçº¿ç¨æ­£å¨è¡¨tä¸è¯·æ±æèææMDLåéï¼æselectè¯­å¥å µä½äºã\n   \n   è§£å³ï¼éè¿æ¥è¯¢select blocking_pid from sys.schema_table_lock_waits;æ¥åºé æé»å¡çprocess idï¼æä»killäºã\n\n * ç­flush\n\n * ç­è¡é\n\nç¬¬äºç±»ï¼æ¥è¯¢æ¢\n\n\n# äºåãå¹»è¯»æ¯ä»ä¹ï¼æä»ä¹é®é¢ï¼ï¼è¿æ¯æç¹èåï¼\n\nfor update æä»é\n\nfor updateä»éç¨äºInnoDBï¼ä¸å¿é¡»å¨äºå¡å(BEGIN/COMMIT)ä¸­æè½çæãå¨è¿è¡äºå¡æä½æ¶ï¼éè¿âfor updateâè¯­å¥ï¼MySQLä¼å¯¹æ¥è¯¢ç»æéä¸­æ¯è¡æ°æ®é½æ·»å æä»éï¼å¶ä»çº¿ç¨å¯¹è¯¥è®°å½çæ´æ°ä¸å é¤æä½é½ä¼é»å¡ãæä»éåå«è¡éãè¡¨éã\n\nlock in share mode å±äº«é\n\nå¹»è¯»æçæ¯ä¸ä¸ªäºå¡å¨ååä¸¤æ¬¡æ¥è¯¢åä¸ä¸ªèå´çæ¶åï¼åä¸æ¬¡æ¥è¯¢çå°äºåä¸æ¬¡æ¥è¯¢æ²¡æçå°çè¡ã\n\nâå¹»è¯»âåä¸ä¸ªè¯´æï¼\n\n 1. å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼æ®éçæ¥è¯¢æ¯å¿«ç§è¯»ï¼æ¯ä¸ä¼çå°å«çäºå¡æå¥çæ°æ®çãå æ­¤ï¼ å¹»è¯»å¨âå½åè¯»âä¸æä¼åºç°ã\n\n 2. ä¸é¢session Bçä¿®æ¹ç»æï¼è¢«session Aä¹åçselectè¯­å¥ç¨âå½åè¯»âçå°ï¼ä¸è½ç§°ä¸ºå¹»è¯»ã å¹»è¯»ä»ä¸æâæ°æå¥çè¡âã\n\néçè®¾è®¡æ¯ä¸ºäºä¿è¯æ°æ®çä¸è´æ§ãèè¿ä¸ªä¸è´æ§ï¼ä¸æ­¢æ¯æ°æ®åºåé¨æ°æ®ç¶æå¨æ­¤ å»çä¸è´æ§ï¼è¿åå«äºæ°æ®åæ¥å¿å¨é»è¾ä¸çä¸è´æ§ã\n\nInnoDBå¦ä½è§£å³å¹»è¯»ï¼\n\nå¹»è¯»äº§ççåå æ¯ï¼è¡éåªè½éä½è¡ï¼ä½æ¯æ°æå¥è®°å½è¿ä¸ªå¨ä½ï¼è¦æ´æ°çæ¯è®°å½ä¹é´çâé´éâãå æ­¤ï¼ä¸ºäºè§£å³å¹»è¯»é®é¢ï¼InnoDBåªå¥½å¼å¥æ°çéï¼ä¹å³æ¯é´ééï¼Gap Lockï¼ã\n\né´ééåè¡éåç§°next-key lockãä½å¶å®ä»ä»¬æ¯åå¼å çã\n\né´ééæ¯å¨å¯éå¤è¯»éç¦»çº§å«ä¸æä¼çæçãæä»¥ï¼ä½ å¦ææéç¦»çº§å«è®¾ç½®ä¸ºè¯»æäº¤çè¯ï¼ å°±æ²¡æé´ééäºãä½åæ¶ï¼ä½ è¦è§£å³å¯è½åºç°çæ°æ®åæ¥å¿ä¸ä¸è´é®é¢ï¼éè¦æbinlogæ ¼å¼è®¾ç½® ä¸ºrowãè¿ä¹æ¯ç°å¨ä¸å°å¬å¸ä½¿ç¨çéç½®ç»åã\n\nå¾å¤å¬å¸ä½¿ç¨ï¼è¯»æäº¤éç¦»çº§å«å binlog_format=rowçç»åãå°åºåä¸åçï¼\n\nå¦æè¯»æäº¤éç¦»çº§å«å¤ç¨ï¼å³ä¸å¡ä¸éè¦å¯éå¤è¯»çä¿è¯ï¼è¿æ ·èèå°è¯»æäº¤ä¸æä½æ°æ®çéèå´æ´å°ï¼æ²¡æé´ééï¼ï¼è¿ä¸ªéæ©æ¯åççã\n\næ¯å¦å¤§å®¶é½ç¨è¯»æäº¤ï¼å¯é»è¾å¤ä»½æ¶ï¼mysqldumpä¸ºä»ä¹è¦æå¤ä»½çº¿ç¨è®¾ç½®æå¯éå¤è¯»ï¼ç¶åï¼å¨å¤ä»½æé´ï¼å¤ä»½çº¿ç¨ç¨çæ¯å¯éå¤è¯»ï¼èä¸å¡çº¿ç¨ä½¿ç¨çæ¯è¯»æäº¤ï¼åæ¶å­å¨ä¸¤ç§äºå¡éç¦»çº§å«ä¼ä¸ä¼æé®é¢ï¼\n\n\n# äºåä¸ãå éè§å\n\n\n# å¯éå¤è¯»éç¦»çº§å«ä¸\n\néæ¯å å¨ç´¢å¼ä¸çã\n\nnext-key lock=é´éé+è¡éï¼(]ï¼åå¼åé­åºé´ã\n\né´ééï¼()ï¼åå¼åå¼åºé´ã\n\nè¡éå°±ä¸ä¸ªã\n\nå éè§åï¼2ä¸ªååï¼2ä¸ªä¼åï¼1ä¸ªbug\n\n 1. åå1ï¼å éçåºæ¬åä½æ¯next-key lockã\n\n 2. åå2ï¼æ¥æ¾è¿ç¨ä¸­è®¿é®å°çå¯¹è±¡æä¼å éã\n\n 3. ä¼å1ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼ç»å¯ä¸ç´¢å¼å éçæ¶åï¼next-key lockéåä¸ºè¡éã\n\n 4. ä¼å2ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼åå³éåæ¶ä¸éå°ä¸æ»¡è¶³ç­å¼æ¡ä»¶çå¼æ¶ï¼next-key lockéåä¸ºé´ééã\n\n 5. ä¸ä¸ªbugï¼å¯ä¸ç´¢å¼ä¸çèå´æ¥è¯¢ä¼è®¿é®å°ä¸æ»¡è¶³æ¡ä»¶çç¬¬ä¸ä¸ªå¼ä¸ºæ­¢ã\n\n\n# è¯»æäº¤éç¦»çº§å«ä¸\n\nè¯»æäº¤éç¦»çº§å«çè¯ï¼å»æé´ééçé¨åï¼å©ä¸è¡éçé¨åã\n\nå¶å®è¯»æäº¤éç¦»çº§å«å¨å¤é®åºæ¯ä¸è¿æ¯æé´ééï¼ç¸å¯¹æ¯è¾å¤æï¼æä»¬ä»å¤©åä¸å±å¼ã\n\nå¦å¤ï¼å¨è¯»æäº¤éç¦»çº§å«ä¸è¿æä¸ä¸ªä¼åï¼å³ï¼è¯­å¥æ§è¡è¿ç¨ä¸­å ä¸çè¡éï¼å¨è¯­å¥æ§è¡å®æåï¼å°±è¦æâä¸æ»¡è¶³æ¡ä»¶çè¡âä¸çè¡éç´æ¥éæ¾äºï¼ä¸éè¦ç­å°äºå¡æäº¤ã\n\nä¹å°±æ¯è¯´ï¼è¯»æäº¤éç¦»çº§å«ä¸ï¼éçèå´æ´å°ï¼éçæ¶é´æ´ç­ï¼è¿ä¹æ¯ä¸å°ä¸å¡é½é»è®¤ä½¿ç¨è¯»æäº¤éç¦»çº§å«çåå ã\n\n\n# 24ãmysqlæä¹ä¿æä¸»å¤ä¸è´ï¼\n\nbinlogåä¸å¯æ²¡ã\n\nmysqlæå®¹æå­¦ä¹ åæ¹ä¾¿ä½¿ç¨é«å¯ç¨æ¶æãå ä¹ææçé«å¯ç¨æ¶æï¼é½ç´æ¥ä¾èµäºbinlogãè½ç¶è¶æ¥ä¸å¤æï¼ä½é½æ¯ä»æåºæ¬çä¸ä¸»ä¸å¤æ¼åèæ¥ã\n\nå¨ä¸ä¸ªä¸»å¤å³ç³»ä¸­ï¼æ¯ä¸ªå¤åºæ¥åä¸»åºçbinlogæ§è¡ãåªè¦ä¸»åºæ§è¡æ´æ°çæçææbinlogé½å¯ä»¥ä¼ å°å¤åºè¢«æ­£ç¡®æ§è¡ï¼å¤åºå°±è½è¾¾å°è·ä¸»åºä¸è´çç¶æï¼è¿å°±æ¯æç»ä¸è´æ§ã\n\nå»ºè®®æå¤åºè®¾ç½®æreadonlyæ¨¡å¼ãå¥½å¤å¦ä¸ï¼\n\n * æäºè¿è¥ç±»çæ¥è¯¢è¯­å¥ä¼åå¤åºæ¥ï¼è®¾ç½®ä¸ºåªè¯»å¯é²æ­¢è¯¯æä½ã\n * é²æ­¢åæ¢é»è¾bugï¼å¦åæ¢è¿ç¨ä¸­åºç°ååï¼é æä¸»å¤ä¸ä¸è´ã\n * å¯ç¨readonlyç¶æï¼å¤æ­èç¹çè§è²ã\n\nå ä¸ºreadonlyè®¾ç½®å¯¹superæéè§è²æ æï¼èç¨äºåæ­¥æ´æ°ççº¿ç¨å°±æ¥æè¶çº§æéã\n\nä¸»åºåå¤åºä¹é´ç»´æäºä¸ä¸ªé¿è¿æ¥ãä¸»åºåé¨æä¸ä¸ªçº¿ç¨ï¼ä¸é¨ç¨äºæå¡å¤åºçè¿ä¸ªé¿è¿æ¥ã\n\nbinlogçä¸ç§æ ¼å¼ï¼ï¼éè¿binlog_formatå±æ§è®¾ç½®ï¼\n\n * statementãè®°å½çæ¯è¯­å¥åæãå¯è½å¯¼è´ä¸»å¤ä¸ä¸è´ã\n * rowãè®°å½äºçå®å é¤è¡çä¸»é®idï¼å¦ææ¯å é¤ï¼ãå ç©ºé´ï¼å¦å é¤10wæ¡æ°æ®ã\n * mixedãåä¸¤ç§çæ··åã\n\nç°å¨è¶æ¥è¶å¤çåºæ¯è¦æ±æmysqlçbinlogæ ¼å¼è®¾ç½®ä¸ºrowï¼å¶ä¸­ä¹ä¸å¥½å¤å¨äºï¼æ¢å¤æ°æ®ã\n\nå®éçäº§ä½¿ç¨æ¯è¾å¤çæ¯åMç»æï¼äºä¸ºä¸»å¤ãç¸è¾äºMSç»æï¼åæ¢æ¶ä¸ç¨ä¿®æ¹ä¸»å¤å³ç³»ã\n\nmysqléè¿å¤æ­server idçæ¹å¼ï¼è§£å³å¾ªç¯å¤å¶é®é¢ã\n\néè¿mysqlbinlogå·¥å·è§£æåæ¥çbinlogä¸­çåå®¹ã\n\n\n# 25ãmysqlå¦ä½ä¿è¯é«å¯ç¨ï¼\n\nåªææç»ä¸è´æ§è¿ä¸å¤ï¼mysqlè¿è¦æä¾é«å¯ç¨ã\n\n\n# ä¸»å¤å»¶è¿\n\nå¯éè¿å¨å¤åºæ§è¡ show slave statusæ¾ç¤ºseconds_behind_masterè¡¨ç¤ºå½åå¤åºå»¶è¿äºå¤å°ç§ã\n\nä¸»å¤å»¶è¿çæ¥æºï¼\n\n * å¤åºæå¨çæºå¨æ§è½æ¯ä¸»åºçå·®ãï¼ç°å¨ä¸è¬åå¯¹ç§°é¨ç½²ï¼ä¸»å¤åæ¢ï¼ã\n * å¤åºçååå¤§ã\n * ä¸»åºå¤§äºå¡ã\n   * å ä¸ºä¸»åºå¿é¡»ç­äºå¡æ§è¡å®ææä¼åå¥binlogï¼åä¼ ç»å¤åºã\n   * å¦ä¸è¦ä¸æ¬¡æ§ç¨deleteå é¤å¤ªå¤æ°æ®ï¼å¸åçå¤§äºå¡åºæ¯ã\n   * å¦å¤§è¡¨DDLä¹æ¯å¸åçå¤§äºå¡åºæ¯ãå¤çæ¹æ¡ï¼è®¡ååçDDLï¼å»ºè®®ä½¿ç¨go-ostæ¹æ¡ã\n * å¤åºçå¹¶è¡å¤å¶è½åã\n\nä¸è¬å¤çï¼\n\n * ä¸ä¸»å¤ä»ãï¼è¿éæHAè¿ç¨ä¸­è¢«éææ°ä¸»åºçç§°ä¸ºå¤åºï¼å¶ä»çç§°ä¸ºä»åºãå¤åºåä»åºæ¦å¿µä¸å·®ä¸å¤ï¼\n * éè¿binlogè¾åºå°å¤é¨ç³»ç»ï¼å¦hadoopï¼è®©å¤é¨ç³»ç»æä¾ç»è®¡ç±»æ¥è¯¢çè½åã\n\n\n# å¯é æ§ä¼åç­ç¥ï¼\n\nåMç»æä¸ï¼ä¸»å¤åæ¢ï¼\n\n 1. å¤æ­å¤åºBç°å¨çseconds_behind_masterï¼å¦æå°äºæä¸ªå¼ï¼æ¯å¦5ç§ï¼ç»§ç»­ä¸ä¸æ­¥ï¼å¦å\n\næç»­éè¯è¿ä¸æ­¥ï¼\n\n 2. æä¸»åºAæ¹æåªè¯»ç¶æï¼å³æreadonlyè®¾ç½®ä¸ºtrueï¼\n\n 3. å¤æ­å¤åºBçseconds_behind_masterçå¼ï¼ç´å°è¿ä¸ªå¼åæ0ä¸ºæ­¢ï¼\n\n 4. æå¤åºBæ¹æå¯è¯»åç¶æï¼ä¹å°±æ¯æreadonly è®¾ç½®ä¸ºfalseï¼\n\n 5. æä¸å¡è¯·æ±åå°å¤åºBã\n\nè¿ä¸ªåæ¢æµç¨ï¼ä¸è¬æ¯ç±ä¸é¨çHAç³»ç»æ¥å®æçï¼æä»¬ææ¶ç§°ä¹ä¸ºå¯é æ§ä¼åæµç¨ã\n\n\n# å¯ç¨æ§æåç­ç¥ï¼\n\nå¦ææå¼ºè¡ææ­¥éª¤4ã5è°æ´å°æå¼å§æ§è¡ï¼ä¹å°±æ¯è¯´ä¸ç­ä¸»å¤æ°æ®åæ­¥ï¼ç´æ¥æè¿æ¥åå°å¤åº Bï¼å¹¶ä¸è®©å¤åºBå¯ä»¥è¯»åï¼é£ä¹ç³»ç»å ä¹å°±æ²¡æä¸å¯ç¨æ¶é´äºã\n\nè¿ä¸ªåæ¢æµç¨çä»£ä»·ï¼å°±æ¯å¯è½åºç°æ°æ®ä¸ä¸ è´çæåµã\n\nç»è®ºï¼\n\n 1. ä½¿ç¨rowæ ¼å¼çbinlogæ¶ï¼æ°æ®ä¸ä¸è´çé®é¢æ´å®¹æè¢«åç°ãèä½¿ç¨mixedæèstatementæ ¼å¼çbinlogæ¶ï¼æ°æ®å¾å¯è½ææå°å°±ä¸ä¸è´äºãå¦æä½ è¿äºå¾ä¹æåç°æ°æ®ä¸ä¸è´çé®é¢ï¼ å¾å¯è½è¿æ¶çæ°æ®ä¸ä¸è´å·²ç»ä¸å¯æ¥ï¼æèè¿å¸¦é æäºæ´å¤çæ°æ®é»è¾ä¸ä¸è´ã\n\n 2. ä¸»å¤åæ¢çå¯ç¨æ§ä¼åç­ç¥ä¼å¯¼è´æ°æ®ä¸ä¸è´ãå æ­¤ï¼å¤§å¤æ°æåµä¸ï¼æé½å»ºè®®ä½ ä½¿ç¨å¯é æ§ä¼åç­ç¥ãæ¯ç«å¯¹æ°æ®æå¡æ¥è¯´çè¯ï¼æ°æ®çå¯é æ§ä¸è¬è¿æ¯è¦ä¼äºå¯ç¨æ§çã\n\nå¨æ»¡è¶³æ°æ®å¯é æ§çåæä¸ï¼MySQLé«å¯ç¨ç³»ç»çå¯ç¨æ§ï¼æ¯ä¾èµäºä¸»å¤å»¶è¿çãå»¶è¿çæ¶é´è¶å°ï¼å¨ä¸»åºæéçæ¶åï¼æå¡æ¢å¤éè¦çæ¶é´å°±è¶ç­ï¼å¯ç¨æ§å°±è¶é«ã\n\n\n# 26ãå¤åºä¸ºä»ä¹ä¼å»¶è¿å¥½å ä¸ªå°æ¶ï¼ï¼ç¥çï¼\n\nç®åæ»ç»ï¼\n\nä»ç»äºMySQLçåç§å¤çº¿ç¨å¤å¶ç­ç¥ã\n\nä¸ºä»ä¹è¦æå¤çº¿ç¨å¤å¶å¢ï¼è¿æ¯å ä¸ºåçº¿ç¨å¤å¶çè½åå¨é¢ä½äºå¤çº¿ç¨å¤å¶ï¼å¯¹äºæ´æ°ååè¾å¤§ çä¸»åºï¼å¤åºæ¯å¯è½ä¸ç´è¿½ä¸ä¸ä¸»åºçãä»ç°è±¡ä¸çå°±æ¯ï¼å¤åºä¸seconds_behind_masterçå¼ è¶æ¥è¶å¤§ã\n\nå¤§äºå¡ä¸ä»ä¼å½±åå°ä¸»åºï¼ä¹æ¯é æå¤åºå¤å¶å»¶è¿çä¸»è¦åå ä¹ä¸ã å æ­¤ï¼å¨å¹³æ¶çå¼åå·¥ä½ä¸­ï¼æå»ºè®®ä½ å°½éåå°å¤§äºå¡æä½ï¼æå¤§äºå¡ææå°äºå¡ã\n\nbinlog-transaction-dependency-trackingåæ°ï¼\n\n * COMMIT_ORDER\n * WRITESET\n * WRITE_SESSIOn\n\n\n# 27ãä¸»åºåºé®é¢äºä»åºæä¹åï¼\n\n\n\nä¸ä¸»å¤ä»åºæ¬ç»æã\n\nå°èç¹Bè®¾ç½®æèç¹Açä»åºA`ï¼éè¦æ§è¡change masterå½ä»¤ã\n\nè¿æ¡å½ä»¤æ6ä¸ªåæ°ï¼å¶ä¸­MASTER_LOG_FILEåMASTER_LOG_POSè¡¨ç¤ºä»ä¸»åºçãæä»¶åãããæ¥å¿åç§»éãçæ¥å¿ç»§ç»­åæ­¥ã\n\nè¿ä¸ªposå¾å¾ä¸ç²¾ç¡®ã\n\néå¸¸æä»¬å¨åæ¢ä»»å¡æ¶ï¼è¦åä¸»å¨è·³è¿è¿äºéè¯¯ï¼æä¸¤ç§å¸¸ç¨çæ¹æ³ï¼\n\n * ä¸»å¨è·³è¿ä¸ä¸ªäºå¡set global sql_slave_skip_count = 1;start save;\n * éè¿è®¾ç½®slave_skip_erroråæ°ï¼ç´æ¥è®¾ç½®è·³è¿æå®çéè¯¯ã\n   * 1062éè¯¯æ¯æå¥æ°æ®æ¶å¯ä¸é®å²çªï¼\n   * 1032éè¯¯æ¯å é¤æ°æ®æ¶æ¾ä¸å°è¡ã\n\n\n# GTID\n\néè¿sql_slave_skip_counterè·³è¿äºå¡åéè¿slave_skip_errorså¿½ç¥éè¯¯çæ¹æ³ï¼è½ç¶é½æç»å¯ä»¥ å»ºç«ä»åºBåæ°ä¸»åºAâçä¸»å¤å³ç³»ï¼ä½è¿ä¸¤ç§æä½é½å¾å¤æï¼èä¸å®¹æåºéãæä»¥ï¼MySQL 5.6çæ¬å¼å¥äºGTIDï¼å½»åºè§£å³äºè¿ä¸ªå°é¾ã\n\nGTIDçå¨ç§°æ¯Global Transaction Identifierï¼ä¹å°±æ¯å¨å±äºå¡IDï¼æ¯ä¸ä¸ªäºå¡å¨æäº¤çæ¶åçæçï¼æ¯è¿ä¸ªäºå¡çå¯ä¸æ è¯ã\n\nGTID=server_uuid:gno\n\n * server_uuidæ¯ä¸ä¸ªå®ä¾ç¬¬ä¸æ¬¡å¯å¨æ¶èªå¨çæçï¼æ¯ä¸ä¸ªå¨å±å¯ä¸çå¼ï¼\n\n * gnoæ¯ä¸ä¸ªæ´æ°ï¼åå§å¼æ¯1ï¼æ¯æ¬¡æäº¤äºå¡çæ¶ååéç»è¿ä¸ªäºå¡ï¼å¹¶å 1ã\n\nGTIDä¸»å¤å¤å¶çç¨æ³ï¼\n\næ§è¡change masteï¼åªéä½¿ç¨master_auto_position = 1ä»£æ¿åé¢çMASTER_LOG_FILEåMASTER_LOG_POSã\n\nå¨åºäºGTIDçä¸»å¤å³ç³»éï¼ç³»ç»è®¤ä¸ºåªè¦å»ºç«ä¸»å¤å³ç³»ï¼å°±å¿é¡»ä¿è¯ä¸»åºåç»å¤åºçæ¥å¿æ¯å®æ´çãå æ­¤ï¼å¦æå®ä¾Béè¦çæ¥å¿å·²ç»ä¸å­å¨ï¼Aâå°±æç»ææ¥å¿åç»Bã\n\nè¿è·åºäºä½ç¹çä¸»å¤åè®®ä¸åãåºäºä½ç¹çåè®®ï¼æ¯ç±å¤åºå³å®çï¼å¤åºæå®åªä¸ªä½ç¹ï¼ä¸»åºå°±ååªä¸ªä½ç¹ï¼ä¸åæ¥å¿çå®æ´æ§å¤æ­ã\n\n\n# 28ãè¯»ååç¦»\n\nä¸ä¸»å¤ä»æ¶æçåºç¨åºæ¯ï¼è¯»ååç¦»ã\n\nè¯»ååç¦»çä¸»è¦ç®æ å°±æ¯åæä¸»åºçååã\n\n\n\nå®¢æ·ç«¯ä¸»å¨åè¯»ååç¦»ã\n\n\n\nä¸­é´ä»£çå±proxyååã\n\næ¹æ¡ï¼\n\n * å¼ºå¶èµ°ä¸»åºæ¹æ¡\n * sleepæ¹æ¡\n * å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡\n   * å¤æ­seconds_behind_master æ¯å¦ç­äº0\n   * å¯¹æ¯ä½ç¹quç¡®ä¿ä¸»å¤æ å»¶è¿\n   * å¯¹æ¯GTIDéåç¡®ä¿ä¸»å¤æ å»¶è¿\n * éåsemi-syncæ¹æ¡\n * ç­ä¸»åºä½ç¹æ¹æ¡\n * ç­GTIDæ¹æ¡\n\n\n# å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡\n\n\n# semi-sync replication ååæ­¥æ§å¶\n\n 1. äºå¡æäº¤çæ¶åï¼ä¸»åºæbinlogåç»ä»åºï¼\n\n 2. ä»åºæ¶å°binlogä»¥åï¼ååç»ä¸»åºä¸ä¸ªackï¼è¡¨ç¤ºæ¶å°äºï¼\n\n 3. ä¸»åºæ¶å°è¿ä¸ªackä»¥åï¼æè½ç»å®¢æ·ç«¯è¿åâäºå¡å®æâçç¡®è®¤ã\n\nsemi-syncéååé¢å³äºä½ç¹çå¤æ­ï¼å°±è½å¤ç¡®å®å¨ä»åºä¸æ§è¡çæ¥è¯¢è¯·æ±ï¼å¯ä»¥é¿åè¿æè¯»ã\n\nä½æ¯ï¼semi-sync+ä½ç¹å¤æ­çæ¹æ¡ï¼åªå¯¹ä¸ä¸»ä¸å¤çåºæ¯æ¯æç«çãå¨ä¸ä¸»å¤ä»åºæ¯ä¸­ï¼ä¸»åºåª è¦ç­å°ä¸ä¸ªä»åºçackï¼å°±å¼å§ç»å®¢æ·ç«¯è¿åç¡®è®¤ã\n\nå°ç»ä¸ä¸ï¼semi-syncéåå¤æ­ä¸»å¤æ å»¶è¿çæ¹æ¡ï¼å­å¨ä¸¤ä¸ªé®é¢ï¼\n\n 1. ä¸ä¸»å¤ä»çæ¶åï¼å¨æäºä»åºæ§è¡æ¥è¯¢è¯·æ±ä¼å­å¨è¿æè¯»çç°è±¡ï¼\n\n 2. å¨æç»­å»¶è¿çæåµä¸ï¼å¯è½åºç°è¿åº¦ç­å¾çé®é¢ã\n\nç­ä¸»åºä½ç¹æ¹æ¡ï¼å°±å¯ä»¥è§£å³è¿ä¸¤ä¸ªé®é¢\n\n\n# ç­ä¸»åºä½ç¹æ¹æ¡\n\nselect master_pos_wait(file, pos[, timeout]);\n\n 1. å®æ¯å¨ä»åºæ§è¡çï¼\n\n 2. åæ°fileåposæçæ¯ä¸»åºä¸çæä»¶ååä½ç½®ï¼\n\n 3. timeoutå¯éï¼è®¾ç½®ä¸ºæ­£æ´æ°Nè¡¨ç¤ºè¿ä¸ªå½æ°æå¤ç­å¾Nç§ã\n\nè¿ä¸ªå½ä»¤æ­£å¸¸è¿åçç»ææ¯ä¸ä¸ªæ­£æ´æ°Mï¼è¡¨ç¤ºä»å½ä»¤å¼å§æ§è¡ï¼å°åºç¨å®fileåposè¡¨ç¤ºç binlogä½ç½®ï¼æ§è¡äºå¤å°äºå¡ã\n\nå½ç¶ï¼é¤äºæ­£å¸¸è¿åä¸ä¸ªæ­£æ´æ°Må¤ï¼è¿æ¡å½ä»¤è¿ä¼è¿åä¸äºå¶ä»ç»æï¼åæ¬ï¼\n\n 1. å¦ææ§è¡æé´ï¼å¤åºåæ­¥çº¿ç¨åçå¼å¸¸ï¼åè¿åNULLï¼\n\n 2. å¦æç­å¾è¶è¿Nç§ï¼å°±è¿å-1ï¼\n\n 3. å¦æåå¼å§æ§è¡çæ¶åï¼å°±åç°å·²ç»æ§è¡è¿è¿ä¸ªä½ç½®äºï¼åè¿å0ã\n\n 4. trx1äºå¡æ´æ°å®æåï¼é©¬ä¸æ§è¡show master statuså¾å°å½åä¸»åºæ§è¡å°çFileåPositionï¼\n\n 5. éå®ä¸ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 6. å¨ä»åºä¸æ§è¡select master_pos_wait(File, Position, 1)ï¼\n\n 7. å¦æè¿åå¼æ¯>=0çæ­£æ´æ°ï¼åå¨è¿ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 8. å¦åï¼å°ä¸»åºæ§è¡æ¥è¯¢è¯­å¥ã\n\nå¦ææç§æä»¬è®¾å®ä¸åè®¸è¿æè¯»çè¦æ±ï¼å°±åªæä¸¤ç§éæ©ï¼ä¸ç§æ¯è¶æ¶æ¾å¼ï¼ä¸ç§æ¯è½¬å°ä¸»åºæ¥è¯¢ãå·ä½æä¹éæ©ï¼å°±éè¦ä¸å¡å¼ååå­¦åå¥½éæµç­ç¥äºã\n\n\n# GTIDæ¹æ¡\n\nå¦æä½ çæ°æ®åºå¼å¯äºGTIDæ¨¡å¼ï¼å¯¹åºçä¹æç­å¾GTIDçæ¹æ¡ã\n\nselect wait_for_executed_gtid_set(gtid_set, 1);\n\nè¿æ¡å½ä»¤çé»è¾æ¯ï¼\n\n 1. ç­å¾ï¼ç´å°è¿ä¸ªåºæ§è¡çäºå¡ä¸­åå«ä¼ å¥çgtid_setï¼è¿å0ï¼\n\n 2. è¶æ¶è¿å1ã\n\nå¨åé¢ç­ä½ç¹çæ¹æ¡ä¸­ï¼æä»¬æ§è¡å®äºå¡åï¼è¿è¦ä¸»å¨å»ä¸»åºæ§è¡show master statusãè MySQL 5.7.6çæ¬å¼å§ï¼åè®¸å¨æ§è¡å®æ´æ°ç±»äºå¡åï¼æè¿ä¸ªäºå¡çGTIDè¿åç»å®¢æ·ç«¯ï¼è¿æ ·ç­GTIDçæ¹æ¡å°±å¯ä»¥åå°ä¸æ¬¡æ¥è¯¢ã è¿æ¶ï¼ç­GTIDçæ§è¡æµç¨å°±åæäºï¼\n\n 1. trx1äºå¡æ´æ°å®æåï¼ä»è¿ååç´æ¥è·åè¿ä¸ªäºå¡çGTIDï¼è®°ä¸ºgtid1ï¼\n\n 2. éå®ä¸ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 3. å¨ä»åºä¸æ§è¡ select wait_for_executed_gtid_set(gtid1, 1)ï¼\n\n 4. å¦æè¿åå¼æ¯0ï¼åå¨è¿ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 5. å¦åï¼å°ä¸»åºæ§è¡æ¥è¯¢è¯­å¥ã\n\nè·ç­ä¸»åºä½ç¹çæ¹æ¡ä¸æ ·ï¼ç­å¾è¶æ¶åæ¯å¦ç´æ¥å°ä¸»åºæ¥è¯¢ï¼éè¦ä¸å¡å¼ååå­¦æ¥åéæµèèã\n\nå¨å®éåºç¨ä¸­ï¼è¿å ä¸ªæ¹æ¡æ¯å¯ä»¥æ··åä½¿ç¨çã\n\næ¯å¦ï¼åå¨å®¢æ·ç«¯å¯¹è¯·æ±ååç±»ï¼åºååªäºè¯·æ±å¯ä»¥æ¥åè¿æè¯»ï¼èåªäºè¯·æ±å®å¨ä¸è½æ¥åè¿æè¯»ï¼ç¶åï¼å¯¹äºä¸è½æ¥åè¿æè¯»çè¯­å¥ï¼åä½¿ç¨ç­GTIDæç­ä½ç¹çæ¹æ¡ã\n\nä½è¯è¯´åæ¥ï¼è¿æè¯»å¨æ¬è´¨ä¸æ¯ç±ä¸åå¤è¯»å¯¼è´çãå¨å®éåºç¨ä¸­ï¼å¯è½ä¼æå«çä¸éè¦ç­å¾å°±å¯ä»¥æ°´å¹³æ©å±çæ°æ®åºæ¹æ¡ï¼ä½è¿å¾å¾æ¯ç¨çºç²åæ§è½æ¢æ¥çï¼ä¹å°±æ¯éè¦å¨è¯»æ§è½ååæ§è½ä¸­åæè¡¡ã\n\nå¼æºproxyï¼MariaDB MaxScale\n\n\n# 40ãInnoDBåMemoryå¼æ\n\nInnoDBè¡¨çæ°æ®å°±æ¾å¨ä¸»é®ç´¢å¼æ ä¸ï¼ä¸»é®ç´¢å¼æ¯B+æ ã\n\nMemoryå¼æçæ°æ®åç´¢å¼æ¯åå¼çã\n\nåå­è¡¨çæ°æ®é¨åä»¥æ°ç»çå½¢å¼åç¬å­æ¾ï¼èä¸»é®idç´¢å¼éï¼å­æ¾çæ¯æ¯ä¸ªæ°æ®çä½ç½®ãä¸»é®idæ¯hashç´¢å¼ï¼ç´¢å¼ä¸çkeyä¸æ¯æåºçã\n\nå¯è§ï¼InnoDBåMemoryå¼æçæ°æ®ç»ç»æ¹å¼æ¯ä¸åçï¼\n\n * InnoDBå¼æææ°æ®æ¾å¨ä¸»é®ç´¢å¼ä¸ï¼å¶ä»ç´¢å¼ä¸ä¿å­çæ¯ä¸»é®idãè¿ç§æ¹å¼ï¼æä»¬ç§°ä¹ä¸ºç´¢å¼ç»ç»è¡¨ ï¼Index Organizied Tableï¼ã\n\n * èMemoryå¼æéç¨çæ¯ææ°æ®åç¬å­æ¾ï¼ç´¢å¼ä¸ä¿å­æ°æ®ä½ç½®çæ°æ®ç»ç»å½¢å¼ï¼æä»¬ç§°ä¹ ä¸ºå ç»ç»è¡¨ ï¼Heap Organizied Tableï¼ã\n\nè¿ä¸¤ä¸ªå¼æçä¸äºå¸åä¸åï¼\n\n 1. InnoDBè¡¨çæ°æ®æ»æ¯æåºå­æ¾çï¼èåå­è¡¨çæ°æ®å°±æ¯æç§åå¥é¡ºåºå­æ¾çï¼\n 2. å½æ°æ®æä»¶æç©ºæ´çæ¶åï¼InnoDBè¡¨å¨æå¥æ°æ°æ®çæ¶åï¼ä¸ºäºä¿è¯æ°æ®æåºæ§ï¼åªè½å¨åºå®çä½ç½®åå¥æ°å¼ï¼èåå­è¡¨æ¾å°ç©ºä½å°±å¯ä»¥æå¥æ°å¼ï¼\n 3. æ°æ®ä½ç½®åçååçæ¶åï¼InnoDBè¡¨åªéè¦ä¿®æ¹ä¸»é®ç´¢å¼ï¼èåå­è¡¨éè¦ä¿®æ¹ææç´¢å¼ï¼\n 4. InnoDBè¡¨ç¨ä¸»é®ç´¢å¼æ¥è¯¢æ¶éè¦èµ°ä¸æ¬¡ç´¢å¼æ¥æ¾ï¼ç¨æ®éç´¢å¼æ¥è¯¢çæ¶åï¼éè¦èµ°ä¸¤æ¬¡ç´¢å¼æ¥æ¾ãèåå­è¡¨æ²¡æè¿ä¸ªåºå«ï¼ææç´¢å¼çâå°ä½âé½æ¯ç¸åçã\n 5. InnoDBæ¯æåé¿æ°æ®ç±»åï¼ä¸åè®°å½çé¿åº¦å¯è½ä¸åï¼åå­è¡¨ä¸æ¯æBlob å Textå­æ®µï¼å¹¶ä¸å³ä½¿å®ä¹äºvarchar(N)ï¼å®éä¹å½ä½char(N)ï¼ä¹å°±æ¯åºå®é¿åº¦å­ç¬¦ä¸²æ¥å­å¨ï¼å æ­¤åå­è¡¨çæ¯è¡æ°æ®é¿åº¦ç¸åã\n\n\n# hashç´¢å¼åb-treeç´¢å¼\n\nå®éä¸ï¼åå­è¡¨ä¹æ¯èªæB-Treeç´¢å¼çã\n\nå¨æä»¬çä¸è¬å°è±¡ä¸­ï¼åå­è¡¨çä¼å¿æ¯éåº¦å¿«ï¼å¶ä¸­ä¸ä¸ªåå å°±æ¯Memoryå¼ææ¯æhashç´¢å¼ãæ´éè¦çåå æ¯ï¼åå­è¡¨çæææ°æ®é½ä¿å­å¨åå­ä¸ï¼èåå­çè¯»åéåº¦æ»æ¯æ¯ç£çå¿«ã\n\nä½ä¸å»ºè®®å¨çäº§ç¯å¢ä¸ä½¿ç¨åå­è¡¨ï¼ä¸»è¦æ2ä¸ªåå ï¼\n\n 1. éç²åº¦é®é¢ã\n    1. åå­è¡¨ä¸æ¯æè¡éï¼åªæ¯æè¡¨éã\n 2. æ°æ®æä¹åé®é¢\n\nå»ºè®®ææ®éåå­è¡¨é½ç¨InnoDBè¡¨ä»£æ¿ã\n\nä¾å¤çåºæ¯ï¼åå­ä¸´æ¶è¡¨ãåå­è¡¨æ¯æhashç´¢å¼ï¼è¿ä¸ªç¹æ§å©ç¨èµ·æ¥ï¼å¯¹å¤ææ¥è¯¢çå éææè¿æ¯å¾ä¸éçã\n\n\n# 40ãinsertè¯­å¥çéä¸ºä»ä¹è¿ä¹å¤ï¼ï¼åç¥æ»ç»ï¼\n\nMySQLå¯¹èªå¢ä¸»é®éåäºä¼åï¼å°½éå¨ç³è¯·å°èªå¢idä»¥åï¼å°±éæ¾èªå¢éã\n\næ®éæåµä¸ï¼insertè¯­å¥æ¯ä¸ä¸ªå¾è½»éçæä½ã\n\nç¹æ®æåµä¸ï¼å¦ï¼\n\ninsert â¦select æ¯å¾å¸¸è§çå¨ä¸¤ä¸ªè¡¨ä¹é´æ·è´æ°æ®çæ¹æ³ãä½ éè¦æ³¨æï¼å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼è¿ä¸ªè¯­å¥ä¼ç»selectçè¡¨éæ«æå°çè®°å½åé´éå è¯»éã èå¦æinsertåselectçå¯¹è±¡æ¯åä¸ä¸ªè¡¨ï¼åæå¯è½ä¼é æå¾ªç¯åå¥ãè¿ç§æåµä¸ï¼æä»¬éè¦å¼å¥\n\nç¨æ·ä¸´æ¶è¡¨æ¥åä¼åã\n\ninsert è¯­å¥å¦æåºç°å¯ä¸é®å²çªï¼ä¼å¨å²çªçå¯ä¸å¼ä¸å å±äº«çnext-key lock(Sé)ãå æ­¤ï¼ç¢°å°\n\nç±äºå¯ä¸é®çº¦æå¯¼è´æ¥éåï¼è¦å°½å¿«æäº¤æåæ»äºå¡ï¼é¿åå éæ¶é´è¿é¿ã\n\n\n# 43ãè¦ä¸è¦ä½¿ç¨ååºè¡¨ï¼\n\nååºè¡¨æä»ä¹é®é¢ï¼ä¸ºä»ä¹å¾å¤å¬å¸è§èä¸è®©ä½¿ç¨ååºè¡¨å¢ï¼\n\nååºè¡¨çç»ç»å½¢å¼ï¼\n\nCREATE TABLE `t` (\n\t`ftime` datetime NOTNULL,\n  `c` int(11) DEFAULT NULL,\n  KEY (`ftime`)\n) ENGINE=InnoDB DEFAULT CHARSET = latin1\nPARTITION BY RANGE(YEAR(ftime))\n(PARTITION p_2017 VALUES LESS THAN (2017) ENGINE = InnoDB,\n PARTITION p_2018 VALUES LESS THAN (2018) ENGINE = InnoDB,\n PARTITION p_2019 VALUES LESS THAN (2019) ENGINE = InnoDB,\n PARTITION p_others VALUES LESS THAN MAXVALUE ENGINE = InnoDB);\n \n insert into t value('2017-4-1',1),('2018-4-1',1); \n\n\nå¨è¡¨tä¸­åå§åæå¥äºä¸¤è¡è®°å½ï¼æç§å®ä¹çååºè§åï¼è¿ä¸¤è¡è®°å½åå«è½å¨p_2018åp_2019 è¿ä¸¤ä¸ªååºä¸ã\n\nè¿ä¸ªè¡¨åå«äºä¸ä¸ª.frmæä»¶å4ä¸ª.ibdæä»¶ï¼æ¯ä¸ªååºå¯¹åºä¸ä¸ª.ibdæä»¶ãä¹å°±æ¯è¯´ï¼\n\n * å¯¹äºå¼æå±æ¥è¯´ï¼è¿æ¯4ä¸ªè¡¨ï¼\n * å¯¹äºServerå±æ¥è¯´ï¼è¿æ¯1ä¸ªè¡¨ã\n\næä»¬ä½¿ç¨ååºè¡¨çä¸ä¸ªéè¦åå å°±æ¯åè¡¨è¿å¤§ãé£ä¹ï¼å¦æä¸ä½¿ç¨ååºè¡¨çè¯ï¼æä»¬å°±æ¯è¦ä½¿ç¨æå¨åè¡¨çæ¹å¼ã\n\nååºè¡¨åæå·¥åè¡¨ï¼ä¸ä¸ªæ¯ç±serverå±æ¥å³å®ä½¿ç¨åªä¸ªååºï¼ä¸ä¸ªæ¯ç±åºç¨å±ä»£ç æ¥å³å®ä½¿ç¨åª ä¸ªåè¡¨ãå æ­¤ï¼ä»å¼æå±çï¼è¿ä¸¤ç§æ¹å¼ä¹æ¯æ²¡æå·®å«çã\n\nå¶å®è¿ä¸¤ä¸ªæ¹æ¡çåºå«ï¼ä¸»è¦æ¯å¨serverå±ä¸ãä»serverå±çï¼æä»¬å°±ä¸å¾ä¸æå°ååºè¡¨ä¸ä¸ªè¢«å¹¿ä¸ºè¯ççé®é¢ï¼æå¼è¡¨çè¡ä¸ºã\n\n 1. MySQLå¨ç¬¬ä¸æ¬¡æå¼ååºè¡¨çæ¶åï¼éè¦è®¿é®ææçååºï¼\n\n 2. å¨serverå±ï¼è®¤ä¸ºè¿æ¯åä¸å¼ è¡¨ï¼å æ­¤ææååºå±ç¨åä¸ä¸ªMDLéï¼\n\n 3. å¨å¼æå±ï¼è®¤ä¸ºè¿æ¯ä¸åçè¡¨ï¼å æ­¤MDLéä¹åçæ§è¡è¿ç¨ï¼ä¼æ ¹æ®ååºè¡¨è§åï¼åªè®¿é®å¿è¦çååºã\n\n\n# ååºè¡¨çåºç¨åºæ¯\n\nååºè¡¨çä¸ä¸ªæ¾èæè§çä¼å¿æ¯å¯¹ä¸å¡éæï¼ç¸å¯¹äºç¨æ·åè¡¨æ¥è¯´ï¼ä½¿ç¨ååºè¡¨çä¸å¡ä»£ç æ´ç®æ´ãè¿æï¼ååºè¡¨å¯ä»¥å¾æ¹ä¾¿çæ¸çåå²æ°æ®ã\n\nå¦æä¸é¡¹ä¸å¡è·çæ¶é´è¶³å¤é¿ï¼å¾å¾å°±ä¼ææ ¹æ®æ¶é´å é¤åå²æ°æ®çéæ±ãè¿æ¶åï¼æç§æ¶é´ååºçååºè¡¨ï¼å°±å¯ä»¥ç´æ¥éè¿alter table t drop partitionè¿ä¸ªè¯­æ³å æååºï¼ä»èå æè¿æçåå²æ°æ®ã\n\nè¿ä¸ªalter table t drop partition â¦æä½æ¯ç´æ¥å é¤ååºæä»¶ï¼ææè·dropæ®éè¡¨ç±»ä¼¼ãä¸ä½¿ç¨deleteè¯­å¥å é¤æ°æ®ç¸æ¯ï¼ä¼å¿æ¯éåº¦å¿«ãå¯¹ç³»ç»å½±åå°ã\n\næä»¬ä»¥èå´ååºï¼rangeï¼ä¸ºä¾åä½ ä»ç»çãå®éä¸ï¼MySQLè¿æ¯æhashååºã listååºç­ååºæ¹æ³ãä½ å¯ä»¥å¨éè¦ç¨å°çæ¶åï¼åç¿»ç¿»æåã\n\nå®éä½¿ç¨æ¶ï¼ååºè¡¨è·ç¨æ·åè¡¨æ¯èµ·æ¥ï¼æä¸¤ä¸ªç»ä¸å¼çé®é¢ï¼ä¸ä¸ªæ¯ç¬¬ä¸æ¬¡è®¿é®çæ¶åéè¦è®¿é®ææååºï¼å¦ä¸ä¸ªæ¯å±ç¨MDLéã\n\nå æ­¤ï¼å¦æè¦ä½¿ç¨ååºè¡¨ï¼å°±ä¸è¦åå»ºå¤ªå¤çååºãæè§è¿ä¸ä¸ªç¨æ·åäºæå¤©ååºç­ç¥ï¼ç¶åé¢ååå»ºäº10å¹´çååºãè¿ç§æåµä¸ï¼è®¿é®ååºè¡¨çæ§è½èªç¶æ¯ä¸å¥½çãè¿éæä¸¤ä¸ªé®é¢éè¦æ³¨æï¼\n\n 1. ååºå¹¶ä¸æ¯è¶ç»è¶å¥½ãå®éä¸ï¼åè¡¨æèåååºçæ°æ®ä¸åä¸è¡ï¼åªè¦æ²¡æç¹å«å¤§çç´¢å¼ï¼ å¯¹äºç°å¨çç¡¬ä»¶è½åæ¥è¯´é½å·²ç»æ¯å°è¡¨äºã\n\n 2. ååºä¹ä¸è¦æåé¢çå¤ªå¤ï¼å¨ä½¿ç¨ä¹åé¢ååå»ºå³å¯ãæ¯å¦ï¼å¦ææ¯ææååºï¼æ¯å¹´å¹´åºæ¶åæä¸ä¸å¹´åº¦ç12ä¸ªæ°ååºåå»ºä¸å³å¯ãå¯¹äºæ²¡ææ°æ®çåå²ååºï¼è¦åæ¶çdropæã\n\nè³äºååºè¡¨çå¶ä»é®é¢ï¼æ¯å¦æ¥è¯¢éè¦è·¨å¤ä¸ªååºåæ°æ®ï¼æ¥è¯¢æ§è½å°±ä¼æ¯è¾æ¢ï¼åºæ¬ä¸å°±ä¸æ¯ååºè¡¨æ¬èº«çé®é¢ï¼èæ¯æ°æ®éçé®é¢æèè¯´æ¯ä½¿ç¨æ¹å¼çé®é¢äºã\n\nå½ç¶ï¼å¦æä½ çå¢éå·²ç»ç»´æ¤äºæççååºåè¡¨ä¸­é´ä»¶ï¼ç¨ä¸å¡åè¡¨ï¼å¯¹ä¸å¡å¼ååå­¦æ²¡æé¢å¤çå¤ææ§ï¼å¯¹DBAä¹æ´ç´è§ï¼èªç¶æ¯æ´å¥½çã",normalizedContent:"å­¦ä¹ è·¯å¾ï¼åè¦ä¼ç¨ï¼ç¶åå¯ä»¥åç°é®é¢ã\n\nmysqlåèèµæï¼\n\n * mysqlçå®æ¹æåï¼æå®ä½åå»æ¥æ¼è¡¥ç¼º\n * ãé«æ§è½çmysqlã\n\nmdl metadata lockï¼åæ°æ®é\n\nä¸äºå»ºè®®ï¼\n\n * éè·¯åä¸æ¡ï¼å®è·µç¬¬ä¸æ¡ãæå¨æ­å»ºä¸å¥ä¸»å¤å¤å¶ç»æãå¹³æ¶éå°é®é¢ï¼å¨æå¤ç°ãå¨éè¯»å¶ä»ææ¯æç« ãå¾ä¹¦æ¶ï¼å¦æè§å¾èªå·±çè§£äºä¸ä¸ªç¥è¯ç¹ï¼ä¹ä¸å®è¦å°è¯è®¾è®¡ä¸ä¸ªä¾å­æ¥éªè¯å®ãä¹å»ºè®®è®¾ç½®å¯¹ç§çåä¾ï¼è¾¾å°èä¼è´¯éã\n * æä¹è¯æèªå·±æ¯ä¸æ¯ççæåçå¼æ¸æ¥äºï¼è¯´åºæ¥ï¼ååºæ¥ï¼å¦ææäººè¯·æä½ æä¸ªç¥è¯ç¹ï¼ä¸å®è¦è·ä»å°æ¸æ¥ï¼ä¸è¦è§å¾è¿æ¯æµªè´¹æ¶é´ãå ä¸ºè¿æ ·ï¼ä¾ä¸æ¥å¯ä»¥éªè¯èªå·±ç¡®å®ææäºè¿ä¸ªç¥è¯ç¹ï¼äºæ¥å¯ä»¥æåèªå·±çææ¯è¡¨è¾¾è½åãæ¯ç«ä½ ç»ç©¶è¦é¢ä¸´å3ç±»äººè®²æ¸æ¥åççæ¶åï¼èæ¿ãæåç­è¾©çè¯å§ãæ°å·¥ä½çé¢è¯å®ã\n * ç¥è¯è¦æä½ç³»ï¼æä¸å®¹æå¿è®°ã\n * æåè¡¥å¨é¢ï¼æ¡ä¾æ«ç²ç¹ãä¸å¼å§ä¸è¦çæåï¼æååºè¯¥æ¯å¨ä½ ç¥è¯ç½ç»æå»ºçå·®ä¸å¤æ¶åçã\n\n\n# ä¸ãåºç¡æ¶æ\n\nå¤§ä½æ¥è¯´ï¼mysqlå¯ä»¥åä¸ºserverå±åå­å¨å¼æå±ä¸¤é¨åã\n\n\n\n\n# è¿æ¥å¨\n\nä¸è¬çè¿æ¥å½ä»¤ï¼\n\nmysql -h$ip -p$port -u\n\n\nå®æç»å¸çtcpæ¡æåï¼è¿æ¥å¨å°±è¦å¼å§è®¤è¯ä½ çèº«ä»½ï¼è¿ä¸ªæ¶åç¨çå°±æ¯ä½ è¾å¥çç¨æ·ååå¯ç ã\n\n * å¦æç¨æ·åæå¯ç ä¸å¯¹ï¼ä½ å°±ä¼æ¶å°ä¸ä¸ª\"access denied for user\"çéè¯¯ï¼ç¶åå®¢æ·ç«¯ç¨åº ç»ææ§è¡ã\n\n * å¦æç¨æ·åå¯ç è®¤è¯éè¿ï¼è¿æ¥å¨ä¼å°æéè¡¨éé¢æ¥åºä½ æ¥æçæéãä¹åï¼è¿ä¸ªè¿æ¥éé¢ çæéå¤æ­é»è¾ï¼é½å°ä¾èµäºæ­¤æ¶è¯»å°çæéã\n\nä¸ä¸ªç¨æ·æåå»ºç«è¿æ¥åï¼å³ä½¿ä½ ç¨ç®¡çåè´¦å·å¯¹è¿ä¸ªç¨æ·çæéåäºä¿®æ¹ï¼ä¹ä¸ ä¼å½±åå·²ç»å­å¨è¿æ¥çæéãä¿®æ¹å®æåï¼åªæåæ°å»ºçè¿æ¥æä¼ä½¿ç¨æ°çæéè®¾ç½®ã\n\nè¿æ¥å®æåï¼å¦æä½ æ²¡æåç»­çå¨ä½ï¼è¿ä¸ªè¿æ¥å°±å¤äºç©ºé²ç¶æï¼ä½ å¯ä»¥å¨show processlistå½ä»¤ä¸­çå°å®ã\n\nå®¢æ·ç«¯å¦æå¤ªé¿æ¶é´æ²¡å¨éï¼è¿æ¥å¨å°±ä¼èªå¨å°å®æ­å¼ãè¿ä¸ªæ¶é´æ¯ç±åæ°wait_timeoutæ§å¶ çï¼é»è®¤å¼æ¯8å°æ¶ã\n\nå°½éä½¿ç¨é¿è¿æ¥ã\n\nä½æ¯å¨é¨ä½¿ç¨é¿è¿æ¥åï¼ä½ å¯è½ä¼åç°ï¼æäºæ¶åmysqlå ç¨åå­æ¶¨å¾ç¹å«å¿«ï¼è¿æ¯å ä¸º mysqlå¨æ§è¡è¿ç¨ä¸­ä¸´æ¶ä½¿ç¨çåå­æ¯ç®¡çå¨è¿æ¥å¯¹è±¡éé¢çãè¿äºèµæºä¼å¨è¿æ¥æ­å¼çæ¶åæéæ¾ãæä»¥å¦æé¿è¿æ¥ç´¯ç§¯ä¸æ¥ï¼å¯è½å¯¼è´åå­å ç¨å¤ªå¤§ï¼è¢«ç³»ç»å¼ºè¡ææï¼oomï¼ï¼ä»ç°è±¡çå°±æ¯mysqlå¼å¸¸éå¯äºã\n\næä¹è§£å³è¿ä¸ªé®é¢å¢ï¼ä½ å¯ä»¥èèä»¥ä¸ä¸¤ç§æ¹æ¡ã\n\n 1. å®ææ­å¼é¿è¿æ¥ãä½¿ç¨ä¸æ®µæ¶é´ï¼æèç¨åºéé¢å¤æ­æ§è¡è¿ä¸ä¸ªå ç¨åå­çå¤§æ¥è¯¢åï¼æ­å¼è¿æ¥ï¼ä¹åè¦æ¥è¯¢åéè¿ã\n\n 2. å¦æä½ ç¨çæ¯mysql 5.7ææ´æ°çæ¬ï¼å¯ä»¥å¨æ¯æ¬¡æ§è¡ä¸ä¸ªæ¯è¾å¤§çæä½åï¼éè¿æ§è¡mysql_reset_connectionæ¥éæ°åå§åè¿æ¥èµæºãè¿ä¸ªè¿ç¨ä¸éè¦éè¿åéæ°åæééªè¯ï¼ä½æ¯ä¼å°è¿æ¥æ¢å¤å°åååå»ºå®æ¶çç¶æã\n\n\n# æ¥è¯¢ç¼å­\n\nä½æ¯å¤§å¤æ°æåµä¸æä¼å»ºè®®ä½ ä¸è¦ä½¿ç¨æ¥è¯¢ç¼å­ï¼ å ä¸ºæ¥è¯¢ç¼å­å¾å¾å¼å¤§äºå©ã\n\næ¥è¯¢ç¼å­çå¤±æéå¸¸é¢ç¹ï¼åªè¦æå¯¹ä¸ä¸ªè¡¨çæ´æ°ï¼è¿ä¸ªè¡¨ä¸ææçæ¥è¯¢ç¼å­é½ä¼è¢«æ¸ç©ºãå æ­¤ å¾å¯è½ä½ è´¹å²å°æç»æå­èµ·æ¥ï¼è¿æ²¡ä½¿ç¨å¢ï¼å°±è¢«ä¸ä¸ªæ´æ°å¨æ¸ç©ºäºãå¯¹äºæ´æ°ååå¤§çæ°æ®åº æ¥è¯´ï¼æ¥è¯¢ç¼å­çå½ä¸­çä¼éå¸¸ä½ãé¤éä½ çä¸å¡å°±æ¯æä¸å¼ éæè¡¨ï¼å¾é¿æ¶é´æä¼æ´æ°ä¸æ¬¡ã æ¯å¦ï¼ä¸ä¸ªç³»ç»éç½®è¡¨ï¼é£è¿å¼ è¡¨ä¸çæ¥è¯¢æéåä½¿ç¨æ¥è¯¢ç¼å­ã\n\nå¥½å¨mysqlä¹æä¾äºè¿ç§âæéä½¿ç¨âçæ¹å¼ãä½ å¯ä»¥å°åæ°query_cache_typeè®¾ç½®ædemandï¼è¿æ ·å¯¹äºé»è®¤çsqlè¯­å¥é½ä¸ä½¿ç¨æ¥è¯¢ç¼å­ãèå¯¹äºä½ ç¡®å®è¦ä½¿ç¨æ¥è¯¢ç¼å­çè¯­ å¥ï¼å¯ä»¥ç¨sql_cacheæ¾å¼æå®ï¼åä¸é¢è¿ä¸ªè¯­å¥ä¸æ ·ï¼\n\nselect sql_cache * from t where id = 10;\n\n\néè¦æ³¨æçæ¯ï¼mysql 8.0çæ¬ç´æ¥å°æ¥è¯¢ç¼å­çæ´ååè½å æäºï¼ä¹å°±æ¯è¯´8.0å¼å§å½»åºæ²¡æ è¿ä¸ªåè½äºã\n\n\n# åæå¨\n\n\n# è¯æ³åæ\n\næ ¹æ®è¾å¥çå­ç¬¦ä¸²åç©ºæ ¼è¿è¡è¯å«ï¼è¯å«åºéé¢çå­ç¬¦ä¸²åå«æ¯ä»ä¹ï¼ä»£è¡¨ä»ä¹ã\n\n\n# è¯­æ³åæ\n\næ ¹æ®è¯­æ³è§åï¼å¤æ­è¾å¥çsqlæ¯å¦æ»¡è¶³mysqlè¯­æ³ã\n\n\n# ä¼åå¨\n\nä¼åå¨æ¯å¨è¡¨éé¢æå¤ä¸ªç´¢å¼çæ¶åï¼å³å®ä½¿ç¨åªä¸ªç´¢å¼ï¼æèå¨ä¸ä¸ªè¯­å¥æå¤è¡¨å³èï¼joinï¼ çæ¶åï¼å³å®åä¸ªè¡¨çè¿æ¥é¡ºåºã\n\n\n# æ§è¡å¨\n\né¦åå¤æ­ææ²¡å¯¹è¡¨tçæ§è¡æéãæçè¯å°±æå¼è¡¨ç»§ç»­æ§è¡ã\n\nåä¸ºæç´¢å¼çæåµåæ²¡ç´¢å¼çæåµã\n\nä½ ä¼å¨æ°æ®åºçæ¢æ¥è¯¢æ¥å¿ä¸­çå°ä¸ä¸ªrows_examinedçå­æ®µï¼è¡¨ç¤ºè¿ä¸ªè¯­å¥æ§è¡è¿ç¨ä¸­æ«æäº å¤å°è¡ãè¿ä¸ªå¼å°±æ¯å¨æ§è¡å¨æ¯æ¬¡è°ç¨å¼æè·åæ°æ®è¡çæ¶åç´¯å çã\n\nå¨æäºåºæ¯ä¸ï¼æ§è¡å¨è°ç¨ä¸æ¬¡ï¼å¨å¼æåé¨åæ«æäºå¤è¡ï¼å æ­¤å¼ææ«æè¡æ°è·å¼ææ«æè¡æ°è· rows_examinedå¹¶ä¸æ¯å®å¨ç¸åçã\n\n\n# äºãæ¥å¿ç³»ç»\n\nä¸æ¥è¯¢æµç¨ä¸åï¼æ´æ°æµç¨è¿æ¶åä¸¤ä¸ªéè¦çæ¥å¿æ¨¡åã\n\n * redo logï¼éåæ¥å¿ï¼\n\n * binlogï¼å½æ¡£æ¥å¿ï¼\n\nèç²æ¿åè´¦æ¬éåçæ´ä¸ªè¿ç¨ï¼å¶å®å°±æ¯mysqléç»å¸¸è¯´å°çwalææ¯ï¼walçå¨ç§°æ¯writeahead loggingï¼å®çå³é®ç¹å°±æ¯ååæ¥å¿ï¼ååç£çï¼ä¹å°±æ¯ååç²æ¿ï¼ç­ä¸å¿çæ¶åååè´¦æ¬ã\n\nmysqlæ´ä½æ¥çï¼å¶å®å°±æä¸¤åï¼ä¸åæ¯serverå±ï¼å®ä¸»è¦åçæ¯mysqlåè½å±é¢çäºæï¼è¿æä¸åæ¯å¼æå±ï¼è´è´£å­å¨ç¸å³çå·ä½äºå®ãä¸é¢æä»¬èå°çç²æ¿redo logæ¯ innodbå¼æç¹æçæ¥å¿ï¼èserverå±ä¹æèªå·±çæ¥å¿ï¼ç§°ä¸ºbinlogï¼å½æ¡£æ¥å¿ï¼ã\n\næå¼å§mysqléå¹¶æ²¡æinnodbå¼æãmysqlèªå¸¦çå¼ææ¯myisamï¼ä½æ¯myisamæ²¡æ crash-safeçè½åï¼binlogæ¥å¿åªè½ç¨äºå½æ¡£ãèinnodbæ¯å¦ä¸ä¸ªå¬å¸ä»¥æä»¶å½¢å¼å¼å¥mysqlçï¼æ¢ç¶åªä¾é binlogæ¯æ²¡æcrash-safeè½åçï¼æä»¥innodbä½¿ç¨å¦å¤ä¸å¥æ¥å¿ç³»ç»â â ä¹å°±æ¯ redo logæ¥å®ç°crash-safeè½åã\n\næäºredo logï¼innodbå°±å¯ä»¥ä¿è¯å³ä½¿æ°æ®åºåçå¼å¸¸éå¯ï¼ä¹åæäº¤çè®°å½é½ä¸ä¼ä¸¢å¤±ï¼è¿ä¸ª è½åç§°ä¸ºcrash-safeã\n\nè¿ä¸¤ç§æ¥å¿æä»¥ä¸ä¸ç¹ä¸åã\n\n 1. redo logæ¯innodbå¼æç¹æçï¼binlogæ¯mysqlçserverå±å®ç°çï¼ææå¼æé½å¯ä»¥ä½¿ç¨ã\n 2. redo logæ¯ç©çæ¥å¿ï¼è®°å½çæ¯âå¨æä¸ªæ°æ®é¡µä¸åäºä»ä¹ä¿®æ¹âï¼binlogæ¯é»è¾æ¥å¿ï¼è®°å½çæ¯è¿ä¸ªè¯­å¥çåå§é»è¾ï¼æ¯å¦âç»id=2è¿ä¸è¡çcå­æ®µå 1 âã\n 3. redo logæ¯å¾ªç¯åçï¼ç©ºé´åºå®ä¼ç¨å®ï¼binlogæ¯å¯ä»¥è¿½å åå¥çãâè¿½å åâæ¯æbinlogæä»¶åå°ä¸å®å¤§å°åä¼åæ¢å°ä¸ä¸ä¸ªï¼å¹¶ä¸ä¼è¦çä»¥åçæ¥å¿ã\n\nredo logçåå¥ææäºä¸¤ä¸ªæ­¥éª¤ï¼prepareåcommitï¼æ¯\"ä¸¤é¶æ®µæäº¤\"ã\n\nå½ä½ éè¦æ©å®¹çæ¶åï¼ä¹å°±æ¯éè¦å å¤æ­å»ºä¸äºå¤åºæ¥å¢å ç³»ç»çè¯»è½åçæ¶åï¼ç°å¨å¸¸è§çåæ³ä¹æ¯ç¨å¨éå¤ä»½å ä¸åºç¨binlogæ¥å®ç°çï¼è¿ä¸ªâä¸ä¸è´âå°±ä¼å¯¼è´ä½ ççº¿ä¸åºç°ä¸»ä»æ°æ®åºä¸ä¸è´çæåµã\n\nç®åè¯´ï¼redo logåbinlogé½å¯ä»¥ç¨äºè¡¨ç¤ºäºå¡çæäº¤ç¶æï¼èä¸¤é¶æ®µæäº¤å°±æ¯è®©è¿ä¸¤ä¸ªç¶æä¿ æé»è¾ä¸çä¸è´ã\n\n**æèä¸ä¸ªé®é¢ï¼**å®æå¨éå¤ä»½çå¨æâåå³äºç³»ç»éè¦æ§ï¼æçæ¯ä¸å¤©ä¸å¤ï¼æçæ¯ä¸å¨ä¸å¤âãé£ä¹å¨ä»ä¹åºæ¯ä¸ï¼ä¸å¤©ä¸å¤ä¼æ¯ä¸å¨ä¸å¤æ´æä¼å¿å¢ï¼æèè¯´ï¼å®å½±åäºè¿ä¸ªæ°æ®åºç³»ç»çåªä¸ªææ ï¼\n\nä¸å¤©ä¸å¤ï¼é£ä¹å¦æéè¦æ¢å¤æ°æ®çè¯ï¼åªè¦ä¿è¯å½å¤©çbinlogå®æ´å³å¯ï¼ä¸å¨ä¸å¤çè¯å°±è¦ä¿è¯ä¸å¨çbinlogå®æ´ï¼åæ¶é¢ç¹å¨éå¤ä»½éè¦æ´å¤å­å¨ç©ºé´ï¼å¦ä½éæ©åå³äºä¸å¡çéè¦æ§ï¼å¯¹åºçææ æ¯rto(ç®æ æ¢å¤æ¶é´)ã\n\n\n# ä¸ãäºå¡éç¦»\n\næå°äºå¡ï¼æä»¬ä¼æ³å°acid\n\n * atomicity åå­æ§\n * consistency ä¸è´æ§\n * isolation éç¦»æ§\n * durability æä¹æ§\n\nè¿éä¸»è¦è°éç¦»æ§ã\n\nå½æ°æ®åºä¸æå¤ä¸ªäºå¡åæ¶æ§è¡çæ¶åï¼å°±å¯è½åºç°èè¯»ï¼dirty readï¼ãä¸å¯éå¤è¯»ï¼non- repeatable readï¼ãå¹»è¯»ï¼phantom readï¼çé®é¢ï¼ä¸ºäºè§£å³è¿äºé®é¢ï¼å°±æäºâéç¦»çº§å«âçæ¦å¿µã\n\néç¦»å¾è¶ä¸¥å®ï¼æçå°±ä¼è¶ä½ã\n\nsqlæ åçäºå¡éç¦»çº§å«åæ¬ï¼\n\n * è¯»æªæäº¤ï¼read uncommittedï¼ï¼ä¸ä¸ªäºå¡è¿æ²¡æäº¤æ¶ï¼å®åçåæ´å°±è½è¢«å«çäºå¡çå°ã\n * è¯»æäº¤ï¼read committedï¼ï¼ä¸ä¸ªäºå¡æäº¤ä¹åï¼å®åçåæ´æä¼è¢«å¶ä»äºå¡çå°ã\n * å¯éå¤è¯»ï¼repeatable readï¼ï¼ä¸ä¸ªäºå¡æ§è¡è¿ç¨ä¸­çå°çæ°æ®ï¼æ»æ¯è·è¿ä¸ªäºå¡å¨å¯å¨æ¶çå°çæ°æ®æ¯ä¸è´çãå½ç¶å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼æªæäº¤åæ´å¯¹å¶ä»äºå¡ä¹æ¯ä¸å¯è§çã\n * ä¸²è¡åï¼serializable ï¼ï¼å¯¹äºåä¸è¡è®°å½ï¼âåâä¼å âåéâï¼âè¯»âä¼å âè¯»éâãå½åºç°è¯»åéå²çªçæ¶åï¼åè®¿é®çäºå¡å¿é¡»ç­åä¸ä¸ªäºå¡æ§è¡å®æï¼æè½ç»§ç»­æ§è¡ã\n\nå¨å®ç°ä¸ï¼æ°æ®åºéé¢ä¼åå»ºä¸ä¸ªè§å¾ï¼è®¿é®çæ¶åä»¥è§å¾çé»è¾ç»æä¸ºåãå¨âå¯éå¤è¯»âéç¦»çº§å«ä¸ï¼è¿ä¸ªè§å¾æ¯å¨äºå¡å¯å¨æ¶åå»ºçï¼æ´ä¸ªäºå¡å­å¨æé´é½ç¨è¿ä¸ªè§å¾ã**å¨âè¯»æäº¤âéç¦»çº§ å«ä¸ï¼è¿ä¸ªè§å¾æ¯å¨æ¯ä¸ªsqlè¯­å¥å¼å§æ§è¡çæ¶ååå»ºçã**è¿ééè¦æ³¨æçæ¯ï¼âè¯»æªæäº¤âéç¦» çº§å«ä¸ç´æ¥è¿åè®°å½ä¸çææ°å¼ï¼æ²¡æè§å¾æ¦å¿µï¼èâä¸²è¡åâéç¦»çº§å«ä¸ç´æ¥ç¨å éçæ¹å¼æ¥é¿ åå¹¶è¡è®¿é®ã\n\noracleæ°æ®åºçé»è®¤éç¦»çº§å«å¶ å®å°±æ¯âè¯»æäº¤âï¼å æ­¤å¯¹äºä¸äºä»oracleè¿ç§»å°mysqlçåºç¨ï¼ä¸ºä¿è¯æ°æ®åºéç¦»çº§å«çä¸è´ï¼ ä½ ä¸å®è¦è®°å¾å°mysqlçéç¦»çº§å«è®¾ç½®ä¸ºâè¯»æäº¤âãmysqlé»è®¤éç¦»çº§å«æ¯å¯éå¤è¯»ã\n\néç½®çæ¹å¼æ¯ï¼å°å¯å¨åæ°transaction-isolationçå¼è®¾ç½®æread-committedãä½ å¯ä»¥ç¨ show variablesæ¥æ¥çå½åçå¼ã\n\nå°½éé¿åé¿äºå¡ã\n\né¿äºå¡æå³çç³»ç»éé¢ä¼å­å¨å¾èçäºå¡è§å¾ãç±äºè¿äºäºå¡éæ¶å¯è½è®¿é®æ°æ®åºéé¢çä»»ä½æ°æ®ï¼æä»¥è¿ä¸ªäºå¡æäº¤ä¹åï¼æ°æ®åºéé¢å®å¯è½ç¨å°çåæ»è®°å½é½å¿é¡»ä¿çï¼è¿å°±ä¼å¯¼è´å¤§éå ç¨å­å¨ç©ºé´ã\n\nå¨mysql 5.5åä»¥åççæ¬ï¼åæ»æ¥å¿æ¯è·æ°æ®å­å¸ä¸èµ·æ¾å¨ibdataæä»¶éçï¼å³ä½¿é¿äºå¡æç»æäº¤ï¼åæ»æ®µè¢«æ¸çï¼æä»¶ä¹ä¸ä¼åå°ãæè§è¿æ°æ®åªæ20gbï¼èåæ»æ®µæ200gbçåºãæç»åªå¥½ä¸ºäºæ¸çåæ»æ®µï¼éå»ºæ´ä¸ªåºã\n\né¤äºå¯¹åæ»æ®µçå½±åï¼é¿äºå¡è¿å ç¨éèµæºï¼ä¹å¯è½æå®æ´ä¸ªåºã\n\nmysqlçäºå¡å¯å¨æ¹å¼æä»¥ä¸å ç§ï¼\n\n 1. æ¾å¼å¯å¨äºå¡è¯­å¥ï¼ begin æ start transactionãéå¥çæäº¤è¯­å¥æ¯commitï¼åæ»è¯­å¥æ¯rollbackã\n 2. set autocommit=0ï¼è¿ä¸ªå½ä»¤ä¼å°è¿ä¸ªçº¿ç¨çèªå¨æäº¤å³æãæå³çå¦æä½ åªæ§è¡ä¸ä¸ªselectè¯­å¥ï¼è¿ä¸ªäºå¡å°±å¯å¨äºï¼èä¸å¹¶ä¸ä¼èªå¨æäº¤ãè¿ä¸ªäºå¡æç»­å­å¨ç´å°ä½ ä¸»å¨æ§è¡ commit æ rollback è¯­å¥ï¼æèæ­å¼è¿æ¥ã\n\nå»ºè®®ä½ æ»æ¯ä½¿ç¨set autocommit=1, éè¿æ¾å¼è¯­å¥çæ¹å¼æ¥å¯å¨äºå¡ã\n\n\n# å&äºãç´¢å¼\n\nç´¢å¼åºæ¯æ¨¡åï¼\n\n * åå¸è¡¨ï¼éç¨äºåªæç­å¼æ¥è¯¢çåºæ¯ã\n * æåºæ°ç»ï¼å¨ç­å¼æ¥è¯¢åèå´æ¥è¯¢åºæ¯ä¸­æ§è½ä¼ç§ãåªéç¨äºéæå­å¨å¼æï¼æ´æ°æ°æ®ä»£ä»·å¤ªé«ã\n * æç´¢æ ï¼nåæ ï¼è¯»åæ§è½ä½³ï¼éåç£ççè®¿é®æ¨¡å¼ï¼å¹¿æ³åºç¨å¨æ°æ®åºå¼æä¸­ã\n * è·³è¡¨ãlsmæ ããã\n\nå¨mysqlä¸­ï¼ç´¢å¼æ¯å¨å­å¨å¼æå±å®ç°çï¼æä»¥å¹¶æ²¡æç»ä¸çç´¢å¼æ åï¼å³ä¸åå­å¨å¼æçç´¢ å¼çå·¥ä½æ¹å¼å¹¶ä¸ä¸æ ·ãèå³ä½¿å¤ä¸ªå­å¨å¼ææ¯æåä¸ç§ç±»åçç´¢å¼ï¼å¶åºå±çå®ç°ä¹å¯è½ä¸åã\n\n\n# innodbçç´¢å¼æ¨¡å\n\ninnodbä½¿ç¨b+æ ç´¢å¼æ¨¡åã\n\næ¯ä¸ä¸ªç´¢å¼å¨innodbéå¯¹åºä¸æ£µb+æ ã\n\næ ¹æ®å¶å­èç¹çåå®¹ï¼ç´¢å¼ç±»ååä¸ºä¸»é®ç´¢å¼åéä¸»é®ç´¢å¼ã\n\nä¸»é®ç´¢å¼çå¶å­èç¹å­å¨çæ¯æ´è¡æ°æ®ãå¨innodbä¸­ï¼ä¸»é®ç´¢å¼ä¹è¢«ç§°ä¸ºèç°ç´¢å¼ï¼clustered indexï¼ã\n\néä¸»é®ç´¢å¼çå¶å­èç¹å­å¨çæ¯ä¸»é®çå¼ãå¨innodbä¸­ï¼éä¸»é®ç´¢å¼ä¹è¢«ç§°ä¸ºäºçº§ç´¢å¼ï¼secondary indexï¼ã\n\nå æ­¤ï¼åºäºä¸»é®ç´¢å¼åæ®éç´¢å¼çæ¥è¯¢çåºå«æ¯ï¼ä¸»é®æ¥è¯¢åªéè¦æç´¢idè¿æ£µb+æ ï¼æ®éç´¢å¼æ¥è¯¢ï¼è¦åæç´¢æ®éç´¢å¼æ ï¼å¾å°idåï¼åæç´¢idç´¢å¼æ ãè¿ä¸ªè¿ç¨ç§°ä¸ºåè¡¨ã\n\nä¹å°±æ¯è¯´ï¼åºäºéä¸»é®ç´¢å¼çæ¥è¯¢éè¦å¤æ«æä¸æ£µç´¢å¼æ ãå æ­¤ï¼æä»¬å¨åºç¨ä¸­åºè¯¥å°½éä½¿ç¨ä¸»é®æ¥è¯¢ã\n\nä¸»é®é¿åº¦è¶å°ï¼ æ®éç´¢å¼çå¶å­èç¹å°±è¶å°ï¼ æ®éç´¢å¼å ç¨çç©ºé´ä¹å°±è¶å°ã\n\nä»æ§è½åå­å¨ç©ºé´æ¹é¢èéï¼èªå¢ä¸»é®å¾å¾æ¯æ´åççéæ©ãèªå¢ä¸»é®ä¹ä¸ä¼é æåè£ååå¹¶æä½ã\n\nqï¼éè¿ä¸¤ä¸ªalter è¯­å¥éå»ºç´¢å¼kï¼ä»¥åéè¿ä¸¤ä¸ªalterè¯­å¥éå»ºä¸»é®ç´¢å¼æ¯å¦åçï¼\n\néå»ºç´¢å¼kçåæ³æ¯åççï¼å¯ä»¥è¾¾å°çç©ºé´çç®çãä½æ¯ï¼éå»ºä¸»é®çè¿ç¨ä¸åçãä¸è®ºæ¯å é¤ä¸»é®è¿æ¯åå»ºä¸»é®ï¼é½ä¼å°æ´ä¸ªè¡¨éå»ºã\n\n\n# è¦çç´¢å¼\n\nç±äºè¦çç´¢å¼å¯ä»¥åå°æ çæç´¢æ¬¡æ°ï¼ æ¾èæåæ¥è¯¢æ§è½ï¼ æä»¥ä½¿ç¨è¦çç´¢å¼æ¯ä¸ä¸ªå¸¸ç¨çæ§è½ä¼åææ®µã\n\næä»¬ç¥éï¼èº«ä»½è¯å·æ¯å¸æ°çå¯ä¸æ è¯ãä¹å°±æ¯è¯´ï¼å¦æææ ¹æ®èº«ä»½è¯å·æ¥è¯¢å¸æ°ä¿¡æ¯çéæ±ï¼ æä»¬åªè¦å¨èº«ä»½è¯å·å­æ®µä¸å»ºç«ç´¢å¼å°±å¤äºãèåå»ºç«ä¸ä¸ªï¼èº«ä»½è¯å·ãå§åï¼çèåç´¢å¼ï¼æ¯ä¸æ¯æµªè´¹ç©ºé´ï¼\n\nå¦æç°å¨æä¸ä¸ªé«é¢è¯·æ±ï¼è¦æ ¹æ®å¸æ°çèº«ä»½è¯å·æ¥è¯¢ä»çå§åï¼è¿ä¸ªèåç´¢å¼å°±ææä¹äºãå® å¯ä»¥å¨è¿ä¸ªé«é¢è¯·æ±ä¸ç¨å°è¦çç´¢å¼ï¼ä¸åéè¦åè¡¨æ¥æ´è¡è®°å½ï¼åå°è¯­å¥çæ§è¡æ¶é´ã\n\nå½ç¶ï¼ç´¢å¼å­æ®µçç»´æ¤æ»æ¯æä»£ä»·çãå æ­¤ï¼å¨å»ºç«åä½ç´¢å¼æ¥æ¯æè¦çç´¢å¼æ¶å°±éè¦æè¡¡èè äºã\n\n\n# æå·¦åç¼åå\n\nå¨å»ºç«èåç´¢å¼çæ¶åï¼ å¦ä½å®æç´¢å¼åçå­æ®µé¡ºåºï¼\n\nè¿éæä»¬çè¯ä¼°æ åæ¯ï¼ç´¢å¼çå¤ç¨è½åãå ä¸ºå¯ä»¥æ¯ææå·¦åç¼ï¼æä»¥å½å·²ç»æäº(a,b)è¿ä¸ªèåç´¢å¼åï¼ä¸è¬å°±ä¸éè¦åç¬å¨aä¸å»ºç«ç´¢å¼äºãå æ­¤ï¼ç¬¬ä¸ååæ¯ï¼ å¦æéè¿è°æ´é¡ºåºï¼ å¯ä»¥å°ç»´æ¤ä¸ä¸ªç´¢å¼ï¼ é£ä¹è¿ä¸ªé¡ºåºå¾å¾å°±æ¯éè¦ä¼åèèéç¨çã\n\nå¦æä¸å¾ä¸ç»´æ¤å¦ä¸ä¸ªç´¢å¼ï¼é£ä¹è¦èèç©ºé´ã\n\n\n# ç´¢å¼ä¸æ¨\n\nå¨mysql 5.6ä¹åï¼åªè½ä»id3å¼å§ä¸ä¸ªä¸ªåè¡¨ãå°ä¸»é®ç´¢å¼ä¸æ¾åºæ°æ®è¡ï¼åå¯¹æ¯å­æ®µå¼ã\n\nèmysql 5.6 å¼å¥çç´¢å¼ä¸æ¨ä¼åï¼index condition pushdown)ï¼ å¯ä»¥å¨ç´¢å¼éåè¿ç¨ä¸­ï¼å¯¹ç´¢å¼ä¸­åå«çå­æ®µååå¤æ­ï¼ç´æ¥è¿æ»¤æä¸æ»¡è¶³æ¡ä»¶çè®°å½ï¼åå°åè¡¨æ¬¡æ°ã\n\n\n# å­ãå¨å±éåè¡¨é\n\n\n# å¨å±é\n\næ ¹æ®å éçèå´ï¼ mysqléé¢çéå¤§è´å¯ä»¥åæå¨å±éãè¡¨çº§éåè¡éä¸ç±» ã\n\né¡¾åæä¹ï¼å¨å±éå°±æ¯å¯¹æ´ä¸ªæ°æ®åºå®ä¾å éãmysqlæä¾äºä¸ä¸ªå å¨å±è¯»éçæ¹æ³ï¼å½ä»¤æ¯ flush tables with read lock (ftwrl)ãå½ä½ éè¦è®©æ´ä¸ªåºå¤äºåªè¯»ç¶æçæ¶åï¼å¯ä»¥ä½¿ç¨è¿ä¸ªå½ä»¤ï¼ä¹åå¶ä»çº¿ç¨çä»¥ä¸è¯­å¥ä¼è¢«é»å¡ï¼æ°æ®æ´æ°è¯­å¥ï¼æ°æ®çå¢å æ¹ï¼ãæ°æ®å®ä¹è¯­å¥ï¼åæ¬ å»ºè¡¨ãä¿®æ¹è¡¨ç»æç­ï¼åæ´æ°ç±»äºå¡çæäº¤è¯­å¥ã\n\nå¨å±éçå¸åä½¿ç¨åºæ¯æ¯ï¼ åå¨åºé»è¾å¤ä»½ã ä¹å°±æ¯ææ´åºæ¯ä¸ªè¡¨é½selectåºæ¥å­æææ¬ã\n\nä¸å éçè¯ï¼å¤ä»½ç³»ç»å¤ä»½çå¾å°çåºä¸æ¯ä¸ä¸ªé»è¾æ¶é´ç¹ï¼è¿ä¸ªè§å¾æ¯é»è¾ä¸ä¸è´çã\n\nè¯´å°è§å¾ä½ è¯å®æ³èµ·æ¥äºï¼æä»¬å¨åé¢è®²äºå¡éç¦»çæ¶åï¼å¶å®æ¯æä¸ä¸ªæ¹æ³è½å¤æ¿å°ä¸è´æ§è§ å¾çï¼å¯¹å§ï¼\n\næ¯çï¼å°±æ¯å¨å¯éå¤è¯»éç¦»çº§å«ä¸å¼å¯ä¸ä¸ªäºå¡ã\n\nå®æ¹èªå¸¦çé»è¾å¤ä»½å·¥å·æ¯mysqldumpãå½mysqldumpä½¿ç¨åæ°âsingle-transactionçæ¶åï¼å¯¼ æ°æ®ä¹åå°±ä¼å¯å¨ä¸ä¸ªäºå¡ï¼æ¥ç¡®ä¿æ¿å°ä¸è´æ§è§å¾ãèç±äºmvccçæ¯æï¼è¿ä¸ªè¿ç¨ä¸­æ°æ®æ¯å¯ä»¥æ­£å¸¸æ´æ°çã\n\nä½ ä¸å®å¨çæï¼æäºè¿ä¸ªåè½ï¼ä¸ºä»ä¹è¿éè¦ftwrlå¢ï¼ä¸è´æ§è¯»æ¯å¥½ï¼ä¸è´æ§è¯»æ¯å¥½ï¼ ä½åææ¯å¼æè¦æ¯ æè¿ä¸ªéç¦»çº§å«ã æ¯å¦ï¼å¯¹äºmyisamè¿ç§ä¸æ¯æäºå¡çå¼æï¼å¦æå¤ä»½è¿ç¨ä¸­ææ´æ°ï¼æ»æ¯ åªè½åå°ææ°çæ°æ®ï¼é£ä¹å°±ç ´åäºå¤ä»½çä¸è´æ§ãè¿æ¶ï¼æä»¬å°±éè¦ä½¿ç¨ftwrlå½ä»¤äºã\n\næä»¥ï¼single-transactionæ¹æ³åªéç¨äºææçè¡¨ä½¿ç¨äºå¡å¼æçåºã å¦ææçè¡¨ä½¿ç¨äºä¸æ¯æäºå¡çå¼æï¼é£ä¹å¤ä»½å°±åªè½éè¿ftwrlæ¹æ³ãè¿å¾å¾æ¯dbaè¦æ±ä¸å¡å¼åäººåä½¿ç¨innodbæ¿ä»£myisamçåå ä¹ä¸ã\n\n\n# è¡¨çº§é\n\nmysqléé¢è¡¨çº§å«çéæä¸¤ç§ï¼ä¸ç§æ¯è¡¨éï¼ä¸ç§æ¯åæ°æ®éï¼meta data lockï¼mdl)ã\n\nè¡¨éçè¯­æ³æ¯ lock tables â¦ read/writeã ä¸ftwrlç±»ä¼¼ï¼å¯ä»¥ç¨unlock tablesä¸»å¨éæ¾éï¼ ä¹å¯ä»¥å¨å®¢æ·ç«¯æ­å¼çæ¶åèªå¨éæ¾ãéè¦æ³¨æï¼lock tablesè¯­æ³é¤äºä¼éå¶å«ççº¿ç¨çè¯»åå¤ï¼ä¹éå®äºæ¬çº¿ç¨æ¥ä¸æ¥çæä½å¯¹è±¡ã\n\nå¦ä¸ç±»è¡¨çº§çéæ¯ mdlï¼ metadata lock)ã mdlä¸éè¦æ¾å¼ä½¿ç¨ï¼å¨è®¿é®ä¸ä¸ªè¡¨çæ¶åä¼è¢« èªå¨å ä¸ãmdlçä½ç¨æ¯ï¼ä¿è¯è¯»åçæ­£ç¡®æ§ãä½ å¯ä»¥æ³è±¡ä¸ä¸ï¼å¦æä¸ä¸ªæ¥è¯¢æ­£å¨éåä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼èæ§è¡æé´å¦ä¸ä¸ªçº¿ç¨å¯¹è¿ä¸ªè¡¨ç»æååæ´ï¼å äºä¸åï¼é£ä¹æ¥è¯¢çº¿ç¨æ¿å°çç»æè·è¡¨ç»æå¯¹ä¸ä¸ï¼è¯å®æ¯ä¸è¡çã\n\nå æ­¤ï¼å¨mysql 5.5çæ¬ä¸­å¼å¥äºmdlï¼å½å¯¹ä¸ä¸ªè¡¨åå¢å æ¹æ¥æä½çæ¶åï¼å mdlè¯»éï¼å½ è¦å¯¹è¡¨åç»æåæ´æä½çæ¶åï¼å mdlåéã\n\nqï¼å¦æä½ è¦åæ´çè¡¨æ¯ä¸ä¸ªç­ç¹è¡¨ï¼è½ç¶æ°æ®éä¸å¤§ï¼ä½æ¯ä¸é¢çè¯·æ±å¾é¢ ç¹ï¼èä½ ä¸å¾ä¸å ä¸ªå­æ®µï¼ä½ è¯¥æä¹åå¢ï¼\n\næ¯è¾çæ³çæºå¶æ¯ï¼å¨alter tableè¯­å¥éé¢ è®¾å®ç­å¾æ¶é´ï¼å¦æå¨è¿ä¸ªæå®çç­å¾æ¶é´éé¢è½å¤æ¿å°mdlåéæå¥½ï¼æ¿ä¸å°ä¹ä¸è¦é»å¡å é¢çä¸å¡è¯­å¥ï¼åæ¾å¼ãä¹åå¼åäººåæèdbaåéè¿éè¯å½ä»¤éå¤è¿ä¸ªè¿ç¨ã\n\nmariadbå·²ç»åå¹¶äºalisqlçè¿ä¸ªåè½ï¼æä»¥è¿ä¸¤ä¸ªå¼æºåæ¯ç®åé½æ¯æddl nowait/wait nè¿ä¸ªè¯­æ³ã\n\n\n# å°ç»\n\n * å¨å±éä¸»è¦ç¨å¨é»è¾å¤ä»½è¿ç¨ä¸­ãå¯¹äºå¨é¨æ¯innodbå¼æçåºï¼æå»ºè®®ä½ éæ©ä½¿ç¨âsingletransactionåæ°ï¼å¯¹åºç¨ä¼æ´åå¥½ã\n * è¡¨éä¸è¬æ¯å¨æ°æ®åºå¼æä¸æ¯æè¡éçæ¶åæä¼è¢«ç¨å°çãå¦æä½ åç°ä½ çåºç¨ç¨åºéælock tablesè¿æ ·çè¯­å¥ï¼ä½ éè¦è¿½æ¥ä¸ä¸ï¼æ¯è¾å¯è½çæåµæ¯ï¼\n   * è¦ä¹æ¯ä½ çç³»ç»ç°å¨è¿å¨ç¨myisamè¿ç±»ä¸æ¯æäºå¡çå¼æï¼é£è¦å®æåçº§æ¢å¼æï¼\n   * è¦ä¹æ¯ä½ çå¼æåçº§äºï¼ä½æ¯ä»£ç è¿æ²¡åçº§ãæè§è¿è¿æ ·çæåµï¼æåä¸å¡å¼åå°±æ¯ælock tables å unlock tables æ¹æ begin å commitï¼é®é¢å°±è§£å³äºã\n   * mdlä¼ç´å°äºå¡æäº¤æéæ¾ï¼å¨åè¡¨ç»æåæ´çæ¶åï¼ä½ ä¸å®è¦å°å¿ä¸è¦å¯¼è´éä½çº¿ä¸æ¥è¯¢åæ´æ°ã\n\n\n# ä¹ãæ®éç´¢å¼åå¯ä¸ç´¢å¼çéæ©\n\nç±äºå¯ä¸ç´¢å¼ç¨ä¸ä¸change bufferçä¼åæºå¶ï¼å æ­¤å¦æä¸å¡å¯ä»¥æ¥åï¼ä»æ§è½è§åº¦åºåæå»ºè®®ä½ ä¼åèèéå¯ä¸ç´¢å¼ã\n\n\n# åãmysqlä¸ºä»ä¹ææ¶åä¼ééç´¢å¼ï¼\n\nç±äºç´¢å¼ç»è®¡çæ´æ°æºå¶ï¼ç»è®¡çè¡æ°ææ¶ä¼æåå·®ã\n\nèä¸ä¼åå¨å­å¨ééç´¢å¼çå¯è½æ§ãä¼åå¨éæ©ç´¢å¼çç®çï¼æ¯æ¾å°ä¸ä¸ªæä¼çæ§è¡æ¹æ¡ï¼å¹¶ç¨æå°çä»£ä»·å»æ§è¡è¯­å¥ãå¨æ°æ®åºéé¢ï¼æ«æè¡æ°æ¯å½±åæ§è¡ä»£ä»·çå ç´ ä¹ä¸ãæ«æçè¡æ°è¶å°ï¼æå³çè®¿é®ç£çæ°æ®çæ¬¡æ°è¶å°ï¼æ¶èçcpuèµæºè¶å°ã\n\næ«æè¡æ°å¹¶ä¸æ¯å¯ä¸çå¤æ­æ åï¼ä¼åå¨è¿ä¼ç»åæ¯å¦ä½¿ç¨ä¸´æ¶è¡¨ãæ¯å¦æåºç­å ç´ è¿è¡ç»¼åå¤æ­ã\n\nå¯¹äºç±äºç´¢å¼ç»è®¡ä¿¡æ¯ä¸åç¡®å¯¼è´çé®é¢ï¼ä½ å¯ä»¥ç¨analyze table t è¯­å¥æ¥è§£å³ãï¼éæ°ç»è®¡ç´¢å¼ä¿¡æ¯ï¼\n\nèå¯¹äºå¶ä»ä¼åå¨è¯¯å¤çæåµï¼ä½ å¯ä»¥å¨åºç¨ç«¯ç¨force indexæ¥å¼ºè¡æå®ç´¢å¼ï¼ä¹å¯ä»¥éè¿ä¿®æ¹è¯­å¥æ¥å¼å¯¼ä¼åå¨ï¼è¿å¯ä»¥éè¿å¢å æèå é¤ç´¢å¼æ¥ç»è¿è¿ä¸ªé®é¢ã\n\nä¼°è®¡è®°å½æ°\n\nmysqléè¿ç»è®¡ä¿¡æ¯æ¥ä¼°ç®è®°å½æ°ï¼è¿ä¸ªç»è®¡ä¿¡æ¯å°±æ¯ç´¢å¼çâåºååº¦âãä¸ä¸ªç´¢å¼ä¸ä¸åçå¼è¶å¤ï¼è¿ä¸ªç´¢å¼çåºååº¦å°±è¶å¥½ãèä¸ä¸ªç´¢å¼ä¸ä¸åå¼çä¸ªæ°ï¼ç§°ä¸ºâåºæ°âï¼cardinalityï¼ã\n\nå¯ä½¿ç¨show index from tï¼æ¥çç´¢å¼çåºæ°ã\n\nmysqléè¿éæ ·ç»è®¡æ¥å¾å°ç´¢å¼çåºæ°ãinnodbé»è®¤éæ©nä¸ªæ°æ®é¡µï¼ç»è®¡è¿äºé¡µé¢ä¸çä¸éå¼ï¼å¾å°ä¸ä¸ªå¹³åå¼ï¼ç¶åä¹ä»¥è¿ç´¢å¼çé¡µé¢æ°ï¼å¾å°è¿ä¸ªç´¢å¼çåºæ°ãå½æ°æ®è¡æ°è¶è¿1/mçæ¶åï¼ä¼èªå¨è§¦åéæ°åä¸æ¬¡ç»è®¡ææã\n\nå¨mysqlä¸­ï¼æä¸¤ç§å­å¨ç´¢å¼ç»è®¡çæ¹å¼ï¼å¯ä»¥éè¿è®¾ç½®åæ°innodb_stats_persistentçå¼æ¥éæ©ï¼\n\n * è®¾ç½®ä¸ºonçæ¶åï¼è¡¨ç¤ºç»è®¡ä¿¡æ¯ä¼æä¹åå­å¨ãè¿æ¶ï¼é»è®¤çnæ¯20ï¼mæ¯10ã\n\n * è®¾ç½®ä¸ºoffçæ¶åï¼è¡¨ç¤ºç»è®¡ä¿¡æ¯åªå­å¨å¨åå­ä¸­ãè¿æ¶ï¼é»è®¤çnæ¯8ï¼mæ¯16ã\n\n * ç±äºæ¯éæ ·ç»è®¡ï¼æä»¥ä¸ç®¡næ¯20è¿æ¯8ï¼è¿ä¸ªåºæ°é½æ¯å¾å®¹æä¸åçã\n\n\n# åä¸ãæä¹ç»å­ç¬¦ä¸²å­æ®µå ç´¢å¼ï¼\n\nmysqlæ¯æåç¼ç´¢å¼ï¼å¯ä»¥å®ä¹å­ç¬¦ä¸²çä¸é¨åä½ä¸ºç´¢å¼ãé»è®¤ç´¢å¼åå«æ´ä¸ªå­ç¬¦ä¸²ã\n\nalter table user add index index1(email);\n\nalter table user add index index2(email(6));\n\n\nä½¿ç¨åç¼ç´¢å¼å¯ä»¥åå°ç©ºé´å ç¨ï¼è¿æ¯ä¼å¿ãä½å¯è½å¯¼è´æ¥è¯¢è¯­å¥è¯»æ°æ®çæ¬¡æ°åå¤ã\n\nå æ­¤ä½¿ç¨åç¼ç´¢å¼ï¼éè¦å®ä¹å¥½é¿åº¦ï¼è¾¾å°å³çç©ºé´ï¼åä¸ç¨é¢å¤å¢å å¤ªå¤çæ¥è¯¢ææ¬ã\n\nå¯ä»¥ä½¿ç¨ä¸ä¸æ¹æ³å¤æ­åç¼çåéé¿åº¦ï¼(è®¾å®ä¸ä¸ªå¯ä»¥æ¥åçæå¤±æ¯ä¾)\n\nselect count(distinct email) as l from user;\n\nselect\n\tcount(distinct left(emial, 4)) as l4,\n\tcount(distinct left(emial, 5)) as l5,\n\tcount(distinct left(emial, 6)) as l6,\n\tcount(distinct left(emial, 7)) as l7,\nfrom user;\n\n\næ­¤å¤ï¼ä½¿ç¨åç¼ç´¢å¼å°±ç¨ä¸ä¸è¦çç´¢å¼å¯¹æ¥è¯¢æ§è½çä¼åã\n\nåç¼å¤æ°ç¸åæ¶çç´¢å¼æè·¯ï¼\n\n * ååºå­å¨\n * å¢å hashå­æ®µï¼å¦ç¨crc()å¾å°æ ¡éªç ã\n\næ»ç»ï¼\n\n 1. ç´æ¥åå»ºå®æ´ç´¢å¼ï¼è¿æ ·å¯è½æ¯è¾å ç¨ç©ºé´ï¼\n 2. åå»ºåç¼ç´¢å¼ï¼èçç©ºé´ï¼ä½ä¼å¢å æ¥è¯¢æ«ææ¬¡æ°ï¼å¹¶ä¸ä¸è½ä½¿ç¨è¦çç´¢å¼ï¼\n 3. ååºå­å¨ï¼ååå»ºåç¼ç´¢å¼ï¼ç¨äºç»è¿å­ç¬¦ä¸²æ¬èº«åç¼çåºååº¦ä¸å¤çé®é¢ï¼\n 4. åå»ºhashå­æ®µç´¢å¼ï¼æ¥è¯¢æ§è½ç¨³å®ï¼æé¢å¤çå­å¨åè®¡ç®æ¶èï¼è·ç¬¬ä¸ç§æ¹å¼ä¸æ ·ï¼é½ä¸æ¯æèå´æ«æã\n\n\n# åäºãä¸ºä»ä¹æçsqlä¼âæâä¸ä¸\n\nå½åå­æ°æ®é¡µè·ç£çæ°æ®é¡µåå®¹ä¸ä¸è´çæ¶åï¼ æä»¬ç§°è¿ä¸ªåå­é¡µä¸º â èé¡µ â ã\n\nå¹³æ¶æ§è¡å¾å¿«çæ´æ°æä½ï¼å¶å®å°±æ¯å¨ååå­åæ¥å¿ï¼è mysqlå¶å°âæâä¸ä¸çé£ä¸ªç¬é´ï¼å¯è½å°±æ¯å¨å·èé¡µï¼flushï¼ã\n\nä»ä¹æåµä¼å¼åæ°æ®åºflushï¼\n\n * innodbçredo logåæ»¡äºãè¿æ¶åç³»ç»ä¼åæ­¢æææ´æ°æä½ï¼æ checkpointå¾åæ¨è¿ï¼redo logçåºç©ºé´å¯ä»¥ç»§ç»­åã\n * ç³»ç»åå­ä¸è¶³ãéè¦æ·æ±°ä¸äºæ°æ®é¡µï¼å¦ææ·æ±°çæ¯èé¡µå°±è¦åæèé¡µåå°ç£çã\n * mysqlè®¤ä¸ºç³»ç»ç©ºé²æ¶ã\n * mysqlæ­£å¸¸å³é­æ¶ã\n\næä»¥ï¼å·èé¡µè½ç¶æ¯å¸¸æï¼ä½æ¯åºç°ä»¥ä¸è¿ä¸¤ç§æåµï¼é½æ¯ä¼ææ¾å½±åæ§è½çï¼\n\n 1. ä¸ä¸ªæ¥è¯¢è¦æ·æ±°çèé¡µä¸ªæ°å¤ªå¤ï¼ä¼å¯¼è´æ¥è¯¢çååºæ¶é´ææ¾åé¿ï¼\n\n 2. æ¥å¿åæ»¡ï¼æ´æ°å¨é¨å µä½ï¼åæ§è½è·ä¸º0ï¼è¿ç§æåµå¯¹ææä¸å¡æ¥è¯´ï¼æ¯ä¸è½æ¥åçã\n\næä»¥ï¼innodbéè¦ææ§å¶èé¡µæ¯ä¾çæºå¶ï¼æ¥å°½éé¿åä¸é¢çè¿ä¸¤ç§æåµã\n\néè¿innodb_io_capacityåè¯innodbä½ çç£çè½åï¼å¨åå·èé¡µæ¶å¯ä»¥å¤å¿«ãå»ºè®®è®¾ä¸ºç£ççiopsã\n\nåæ°innodb_max_dirty_pages_pctæ¯èé¡µæ¯ä¾ä¸éï¼é»è®¤å¼æ¯75%ã\n\nå¹³æ¶è¦å¤å³æ³¨èé¡µæ¯ä¾ï¼ ä¸è¦è®©å®ç»å¸¸æ¥è¿ 75%ã\n\ninnodb_flush_neighbors åæ°å¼ä¸º1çæ¶åä¼æâè¿åâæºå¶ï¼å¼ä¸º0æ¶è¡¨ç¤ºä¸æ¾é»å±ï¼èªå·±å·èªå·±çãå¨mysql 8.0ä¸­ï¼innodb_flush_neighborsåæ°çé»è®¤å¼å·²ç»æ¯0äºã\n\n\n# åä¸ãä¸ºä»ä¹è¡¨æ°æ®å æä¸åï¼è¡¨æä»¶å¤§å°ä¸åï¼\n\nå¦æè¦æ¶ç¼©ä¸ä¸ªè¡¨ï¼åªæ¯deleteæè¡¨éé¢ä¸ç¨çæ°æ®çè¯ï¼è¡¨æä»¶çå¤§å°æ¯ä¸ä¼åçï¼ä½ è¿è¦éè¿alter tableå½ä»¤éå»ºè¡¨ï¼æè½è¾¾å°è¡¨æä»¶åå°çç®çãæè·ä½ ä»ç»äºéå»º è¡¨çä¸¤ç§å®ç°æ¹å¼ï¼online ddlçæ¹å¼æ¯å¯ä»¥èèå¨ä¸å¡ä½å³°æä½¿ç¨çï¼èmysql 5.5åä¹åç çæ¬ï¼è¿ä¸ªå½ä»¤æ¯ä¼é»å¡dmlçï¼è¿ä¸ªä½ éè¦ç¹å«å°å¿ã\n\noptimize tableãanalyze tableåalter tableè¿ä¸ç§æ¹å¼éå»ºè¡¨çåºå«ã\n\n * ä»mysql 5.6çæ¬å¼å§ï¼alter table t engine = innodbï¼ä¹å°±æ¯recreateï¼é»è®¤çå°±æ¯ä¸é¢å¾4çæµç¨äºï¼\n * analyze table t å¶å®ä¸æ¯éå»ºè¡¨ï¼åªæ¯å¯¹è¡¨çç´¢å¼ä¿¡æ¯åéæ°ç»è®¡ï¼æ²¡æä¿®æ¹æ°æ®ï¼è¿ä¸ªè¿ç¨ä¸­å äºmdlè¯»éï¼\n * optimize table t ç­äºrecreate+analyzeã\n\n\n# ååãcount(*)è¿ä¹æ¢ï¼æä¹åï¼\n\n * myisamè¡¨è½ç¶count(*)å¾å¿«ï¼ä½æ¯ä¸æ¯æäºå¡ï¼\n * show table statuså½ä»¤è½ç¶è¿åå¾å¿«ï¼ä½æ¯ä¸åç¡®ï¼\n * innodbè¡¨ç´æ¥count(*)ä¼éåå¨è¡¨ï¼è½ç¶ç»æåç¡®ï¼ä½ä¼å¯¼è´æ§è½é®é¢ã\n\nç¨redisæèæ¯ç¨å¦ä¸å¼ è¡¨è®°å½æ»æ°ï¼é½ä¼åºç°æ°æ®ä¸ä¸è´çæåµã\n\næè®¡æ°æ¾å¨rediséé¢ï¼ä¸è½å¤ä¿è¯è®¡æ°åmysqlè¡¨éçæ°æ®ç²¾ç¡®ä¸è´çåå ï¼æ¯è¿ä¸¤ä¸ªè¿ä¸¤ä¸ªä¸åçå­å¨ææçç³»ç»ï¼ ä¸æ¯æåå¸å¼äºå¡ï¼ æ æ³æ¿å°ç²¾ç¡®ä¸è´çè§å¾ã\n\nèæè®¡æ°å¼ä¹æ¾å¨ mysqlä¸­ï¼å°±è§£å³äºä¸è´æ§è§å¾çé®é¢ã innodbå¼ææ¯æäºå¡ï¼æä»¬å©ç¨å¥½äºå¡çåå­æ§åéç¦»æ§ï¼å°±å¯ä»¥ç®åå¨ä¸å¡å¼åæ¶çé»è¾ã è¿ä¹æ¯innodbå¼æå¤åéççåå ä¹ä¸ã\n\né®é¢é½æ¯ç±äºinnodbè¦æ¯æäºå¡ï¼ä»èå¯¼è´innodbè¡¨ä¸è½æcount(*) ç´æ¥å­èµ·æ¥ï¼ç¶åæ¥è¯¢çæ¶åç´æ¥è¿åå½¢æçã æè°ä»¥å­ä¹çæ»å­ä¹ç¾ï¼ç°å¨æä»¬å°±å©ç¨âäºå¡âè¿ä¸ªç¹æ§ï¼æé®é¢è§£å³æã\n\n\n\ncount()çè¯­ä¹ãcount()æ¯ä¸ä¸ªèåå½æ°ï¼å¯¹äºè¿åçç»æéï¼ä¸è¡è¡å°å¤æ­ï¼å¦æcountå½æ°çåæ°ä¸æ¯nullï¼ç´¯è®¡å¼å°±å 1ï¼å¦åä¸å ãæåè¿åç´¯è®¡å¼ã\n\næä»¥ï¼count(*)ãcount(ä¸»é®id)åcount(1) é½è¡¨ç¤ºè¿åæ»¡è¶³æ¡ä»¶çç»æéçæ»è¡æ°ï¼ècount(å­æ®µï¼ï¼åè¡¨ç¤ºè¿åæ»¡è¶³æ¡ä»¶çæ°æ®è¡éé¢ï¼åæ°âå­æ®µâä¸ä¸ºnullçæ»ä¸ªæ°ã\n\nåææ§è½å·®å«ï¼\n\n * serverå±è¦ä»ä¹å°±ç»ä»ä¹ï¼\n * innodbåªç»å¿è¦çå¼ï¼\n * ç°å¨çä¼åå¨åªä¼åäºcount(*)çè¯­ä¹ä¸ºâåè¡æ°âï¼å¶ä»âæ¾èæè§âçä¼åå¹¶æ²¡æåã\n\nç»è®ºæ¯ï¼æç§æçæåºçè¯ï¼count(å­æ®µ)<count(ä¸»é®id)<count(1)âcount(*)ï¼æä»¥æå»ºè®®ä½ ï¼å°½éä½¿ç¨count(*)ã\n\n\n# åäºãç­çï¼æ¥å¿åç´¢å¼ç¸å³\n\nå´©æºæ¢å¤æ¶çå¤æ­è§åï¼\n\n 1. å¦æredo logéé¢çäºå¡æ¯å®æ´çï¼ä¹å°±æ¯å·²ç»æäºcommitæ è¯ï¼åç´æ¥æäº¤ã\n 2. å¦æredo logéé¢çäºå¡åªæå®æ´çprepareï¼åå¤æ­å¯¹åºçäºå¡binlogæ¯å¦å­å¨å¹¶å®æ´ï¼\n    1. å¦ææ¯ï¼åæäº¤äºå¡ã\n    2. å¦åï¼åæ»äºå¡ã\n\nmysqlæä¹ç¥ébinlogæ¯å¦å®æ´ï¼\n\nä¸ä¸ªäºå¡çbinlogæ¯ç±å®æ´æ ¼å¼çï¼\n\n * statementæ ¼å¼çbinlogï¼æåä¼æcommitï¼\n * rowæ ¼å¼çbinlogï¼æåä¼æä¸ä¸ªxid eventï¼\n\nå¦å¤ï¼å¨mysql 5.6.2åï¼è¿å¼å¥äºbinlog-checksumåæ°ï¼ç¨æ¥éªè¯binlogåå®¹çæ­£ç¡®æ§ã\n\nredo log å binlogæ¯æä¹å³èèµ·æ¥çï¼\n\nä»ä»¬æä¸ä¸ªå±åçæ°æ®å­æ®µï¼å«xidï¼å´©æºæ¢å¤æ¶ï¼ä¼æé¡ºåºæ«æredo logï¼\n\n * å¦æç¢°å°æ¢æprepareï¼åæcommitçredo logï¼ç´æ¥æäº¤ã\n * å¦æç¢°å°åªæprepareï¼æ²¡æcommitçredo logï¼å°±æ¿çxidå»binlogæ¾å¯¹åºçäºå¡ã\n\n\n# åå­ãorder byæ¯æä¹å·¥ä½çï¼\n\néå¸¸æåµä¸ï¼å¨å­æ®µæåºï¼\n\n 1. åå§åsort_bufferï¼ç¡®å®æ¾å¥nameãcityãageè¿ä¸ä¸ªå­æ®µï¼\n\n 2. ä»ç´¢å¼cityæ¾å°ç¬¬ä¸ä¸ªæ»¡è¶³city='æ­å·âæ¡ä»¶çä¸»é®idï¼ä¹å°±æ¯å¾ä¸­çid_xï¼\n\n 3. å°ä¸»é®idç´¢å¼ååºæ´è¡ï¼ånameãcityãageä¸ä¸ªå­æ®µçå¼ï¼å­å¥sort_bufferä¸­ï¼\n\n 4. ä»ç´¢å¼cityåä¸ä¸ä¸ªè®°å½çä¸»é®idï¼\n\n 5. éå¤æ­¥éª¤3ã4ç´å°cityçå¼ä¸æ»¡è¶³æ¥è¯¢æ¡ä»¶ä¸ºæ­¢ï¼å¯¹åºçä¸»é®idä¹å°±æ¯å¾ä¸­çid_yï¼\n\n 6. å¯¹sort_bufferä¸­çæ°æ®æç§å­æ®µnameåå¿«éæåºï¼\n\n 7. æç§æåºç»æåå1000è¡è¿åç»å®¢æ·ç«¯ã\n\nå¦æmysqlè®¤ä¸ºæåºçåè¡é¿åº¦å¤ªå¤§ä¼éç¨rowidæåºï¼\n\nï¼å³æ°çç®æ³æ¾å¥sort_bufferçå­æ®µï¼åªæè¦æåºçåï¼å³nameå­æ®µï¼åä¸»é®idï¼ç¶ååä»åè¡¨åï¼\n\n 1. åå§åsort_bufferï¼ç¡®å®æ¾å¥ä¸¤ä¸ªå­æ®µï¼å³nameåidï¼\n\n 2. ä»ç´¢å¼cityæ¾å°ç¬¬ä¸ä¸ªæ»¡è¶³city='æ­å·âæ¡ä»¶çä¸»é®idï¼ä¹å°±æ¯å¾ä¸­çid_xï¼\n\n 3. å°ä¸»é®idç´¢å¼ååºæ´è¡ï¼ånameãidè¿ä¸¤ä¸ªå­æ®µï¼å­å¥sort_bufferä¸­ï¼\n\n 4. ä»ç´¢å¼cityåä¸ä¸ä¸ªè®°å½çä¸»é®idï¼\n\n 5. éå¤æ­¥éª¤3ã4ç´å°ä¸æ»¡è¶³city='æ­å·âæ¡ä»¶ä¸ºæ­¢ï¼ä¹å°±æ¯å¾ä¸­çid_yï¼\n\n 6. å¯¹sort_bufferä¸­çæ°æ®æç§å­æ®µnameè¿è¡æåºï¼\n\n 7. éåæåºç»æï¼åå1000è¡ï¼å¹¶æç§idçå¼åå°åè¡¨ä¸­ååºcityãnameåageä¸ä¸ªå­æ®µè¿å\n\nç»å®¢æ·ç«¯ã\n\nå¦æmysqlå®å¨æ¯æå¿æåºåå­å¤ªå°ï¼ä¼å½±åæåºæçï¼æä¼éç¨rowidæåºç®æ³ï¼è¿æ ·æåºè¿ ç¨ä¸­ä¸æ¬¡å¯ä»¥æåºæ´å¤è¡ï¼ä½æ¯éè¦ååå°åè¡¨å»åæ°æ®ã\n\nå¦æmysqlè®¤ä¸ºåå­è¶³å¤å¤§ï¼ä¼ä¼åéæ©å¨å­æ®µæåºï¼æéè¦çå­æ®µé½æ¾å°sort_bufferä¸­ï¼è¿æ ·æåºåå°±ä¼ç´æ¥ä»åå­éé¢è¿åæ¥è¯¢ç»æäºï¼ä¸ç¨ååå°åè¡¨å»åæ°æ®ã\n\nè¿ä¹å°±ä½ç°äºmysqlçä¸ä¸ªè®¾è®¡ææ³ï¼å¦æåå­å¤ï¼å¦æåå­å¤ï¼ å°±è¦å¤å©ç¨åå­ï¼ å°½éåå°ç£çè®¿é®ã\n\nä¼åï¼ï¼ç´¢å¼çç»´æ¤æä»£ä»·ï¼éè¦æè¡¡ï¼\n\n * å¦æä»ç´¢å¼ä¸ååºæ¥çè¡ï¼å¤©ç¶å°±æåºå¥½äºçè¯ï¼å°±å¯ä»¥ä¸ç¨åæåºäºãå¯ä»¥ä½¿ç¨èåç´¢å¼ã\n * è¿å¯ä»¥è¦çç´¢å¼ï¼ä½¿å¶ç´æ¥è¿åéè¦çå¼ãï¼ä¹æ¯ç¨ä¸èåç´¢å¼ï¼\n\n\n# åä¸ãå¦ä½æ­£ç¡®å°æ¾ç¤ºéæºæ¶æ¯\n\n# éæºéæ©3ä¸ªåè¯\nselect word from words order by rand() limit 3;\n\n\nè¿æ¡è¯­å¥çæ§è¡æµç¨æ¯è¿æ ·çï¼\n\n 1. åå»ºä¸ä¸ªä¸´æ¶è¡¨ãè¿ä¸ªä¸´æ¶è¡¨ä½¿ç¨çæ¯memoryå¼æï¼è¡¨éæä¸¤ä¸ªå­æ®µï¼ç¬¬ä¸ä¸ªå­æ®µæ¯ doubleç±»åï¼ä¸ºäºåé¢æè¿°æ¹ä¾¿ï¼è®°ä¸ºå­æ®µrï¼ç¬¬äºä¸ªå­æ®µæ¯varchar(64)ç±»åï¼è®°ä¸ºå­æ®µ\n\nwãå¹¶ä¸ï¼è¿ä¸ªè¡¨æ²¡æå»ºç´¢å¼ã\n\n 2. ä»wordsè¡¨ä¸­ï¼æä¸»é®é¡ºåºååºææçwordå¼ãå¯¹äºæ¯ä¸ä¸ªwordå¼ï¼è°ç¨rand()å½æ°çæä¸\n\nä¸ªå¤§äº0å°äº1çéæºå°æ°ï¼å¹¶æè¿ä¸ªéæºå°æ°åwordåå«å­å¥ä¸´æ¶è¡¨çråwå­æ®µä¸­ï¼å° æ­¤ï¼æ«æè¡æ°æ¯10000ã 3. ç°å¨ä¸´æ¶è¡¨æ10000è¡æ°æ®äºï¼æ¥ä¸æ¥ä½ è¦å¨è¿ä¸ªæ²¡æç´¢å¼çåå­ä¸´æ¶è¡¨ä¸ï¼æç§å­æ®µræ\n\nåºã 4. åå§å sort_bufferãsort_bufferä¸­æä¸¤ä¸ªå­æ®µï¼ä¸ä¸ªæ¯doubleç±»åï¼å¦ä¸ä¸ªæ¯æ´åã\n\n 5. ä»åå­ä¸´æ¶è¡¨ä¸­ä¸è¡ä¸è¡å°ååºrå¼åä½ç½®ä¿¡æ¯ï¼æåé¢ä¼åä½ è§£éè¿éä¸ºä»ä¹æ¯âä½ç½®ä¿¡ æ¯âï¼ï¼åå«å­å¥sort_bufferä¸­çä¸¤ä¸ªå­æ®µéãè¿ä¸ªè¿ç¨è¦å¯¹åå­ä¸´æ¶è¡¨åå¨è¡¨æ«æï¼æ­¤æ¶ æ«æè¡æ°å¢å 10000ï¼åæäº20000ã\n\n 6. å¨sort_bufferä¸­æ ¹æ®rçå¼è¿è¡æåºãæ³¨æï¼è¿ä¸ªè¿ç¨æ²¡ææ¶åå°è¡¨æä½ï¼æä»¥ä¸ä¼å¢å æ«\n\næè¡æ°ã\n\n 7. æåºå®æåï¼ååºåä¸ä¸ªç»æçä½ç½®ä¿¡æ¯ï¼ä¾æ¬¡å°åå­ä¸´æ¶è¡¨ä¸­ååºwordå¼ï¼è¿åç»å®¢æ·\n\nç«¯ãè¿ä¸ªè¿ç¨ä¸­ï¼è®¿é®äºè¡¨çä¸è¡æ°æ®ï¼æ»æ«æè¡æ°åæäº20003ã\n\nå°ç»ï¼order by rand()ä½¿ç¨äºåå­ä¸´æ¶è¡¨ï¼ åå­ä¸´æ¶è¡¨æåºçæ¶åä½¿ç¨äº rowidæåºæ¹æ³ã\n\n * å¯¹äºå¯¹äº innodbè¡¨æ¥è¯´ ï¼æ§è¡å¨å­æ®µæåºä¼åå°ç£çè®¿é®ï¼å æ­¤ä¼è¢«ä¼åéæ©ã\n\n * èå¯¹äºåå­è¡¨ï¼ åè¡¨è¿ç¨åªæ¯ç®åå°æ ¹æ®æ°æ®è¡çä½ ç½®ï¼ ç´æ¥è®¿é®åå­å¾å°æ°æ®ï¼ æ ¹æ¬ä¸ä¼å¯¼è´å¤è®¿é®ç£ç ãä¼åå¨æ²¡æäºè¿ä¸å±é¡¾èï¼é£ä¹å® ä¼ä¼åèèçï¼å°±æ¯ç¨äºæåºçè¡é¿åº¦è¶å°è¶å¥½äºï¼æä»¥ï¼mysqlè¿æ¶å°±ä¼éæ©rowidæåºã\n\ntmp_table_sizeéç½®åå­ä¸´æ¶è¡¨çå¤§å°ï¼é»è®¤æ¯16mï¼è¶è¿æ¶ä¼è½¬æç£çä¸´æ¶è¡¨ã\n\nmysql 5.6çæ¬å¼å¥çä¸ä¸ªæ°çæåºç®æ³ï¼ å³ï¼ä¼åéåæåºç®æ³ãï¼ç»´æ¤äºä¸ä¸ªå ï¼\n\nä¸´æ¶æä»¶çç®æ³ä¹å°±æ¯å½å¹¶ç®æ³ã\n\nå¦æä½ ç´æ¥ä½¿ç¨order by rand()ï¼è¿ä¸ªè¯­å¥éè¦using temporary å using filesortï¼æ¥è¯¢çæ§è¡ä»£ä»·å¾å¾æ¯æ¯è¾å¤§çãæä»¥ï¼å¨è®¾è®¡çæ¶åä½ è¦éé¿å¼è¿ç§åæ³ã\n\nä¸ºäºè¾¾å°ä¸¥æ ¼çéæºç»æï¼\n\n 1. åå°æ´ä¸ªè¡¨çè¡æ°ï¼è®°ä½cã\n 2. åå°y = floor(c * rand())ãfloorå¨è¿éçä½ç¨ï¼å°±æ¯åæ´æ°é¨åã\n 3. åç¨limit y, 1åå¾ä¸è¡ã\n\n\n# åå«ãä¸ºä»ä¹é»è¾ç¸åçsqlè¯­å¥ï¼æ§è½å·®å¼å·¨å¤§ï¼åpassï¼\n\nå°ç»ï¼å¯¹ç´¢å¼å­æ®µåå½æ°æä½ï¼å¯è½ä¼ç ´åç´¢å¼å¼çæåºæ§ï¼å æ­¤ä¼åå¨å°±å³å®æ¾å¼èµ°æ æç´¢åè½ã\n\n\n# åä¹ãä¸ºä»ä¹åªæ¥ä¸è¡çè¯­å¥ï¼ä¹æ§è¡æ¢ï¼\n\nåæåå æ¶åï¼ä¸è¬åæ§è¡show processlistï¼ççå½åè¯­å¥å¤äºä»ä¹ç¶æã\n\nç¬¬ä¸ç±»ï¼æ¥è¯¢é¿æ¶é´ä¸è¿å\n\n * ç­mdlé\n   \n   åºç°waiting for table metadata lockï¼è¡¨ç¤ºç°å¨æä¸ä¸ªçº¿ç¨æ­£å¨è¡¨tä¸è¯·æ±æèææmdlåéï¼æselectè¯­å¥å µä½äºã\n   \n   è§£å³ï¼éè¿æ¥è¯¢select blocking_pid from sys.schema_table_lock_waits;æ¥åºé æé»å¡çprocess idï¼æä»killäºã\n\n * ç­flush\n\n * ç­è¡é\n\nç¬¬äºç±»ï¼æ¥è¯¢æ¢\n\n\n# äºåãå¹»è¯»æ¯ä»ä¹ï¼æä»ä¹é®é¢ï¼ï¼è¿æ¯æç¹èåï¼\n\nfor update æä»é\n\nfor updateä»éç¨äºinnodbï¼ä¸å¿é¡»å¨äºå¡å(begin/commit)ä¸­æè½çæãå¨è¿è¡äºå¡æä½æ¶ï¼éè¿âfor updateâè¯­å¥ï¼mysqlä¼å¯¹æ¥è¯¢ç»æéä¸­æ¯è¡æ°æ®é½æ·»å æä»éï¼å¶ä»çº¿ç¨å¯¹è¯¥è®°å½çæ´æ°ä¸å é¤æä½é½ä¼é»å¡ãæä»éåå«è¡éãè¡¨éã\n\nlock in share mode å±äº«é\n\nå¹»è¯»æçæ¯ä¸ä¸ªäºå¡å¨ååä¸¤æ¬¡æ¥è¯¢åä¸ä¸ªèå´çæ¶åï¼åä¸æ¬¡æ¥è¯¢çå°äºåä¸æ¬¡æ¥è¯¢æ²¡æçå°çè¡ã\n\nâå¹»è¯»âåä¸ä¸ªè¯´æï¼\n\n 1. å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼æ®éçæ¥è¯¢æ¯å¿«ç§è¯»ï¼æ¯ä¸ä¼çå°å«çäºå¡æå¥çæ°æ®çãå æ­¤ï¼ å¹»è¯»å¨âå½åè¯»âä¸æä¼åºç°ã\n\n 2. ä¸é¢session bçä¿®æ¹ç»æï¼è¢«session aä¹åçselectè¯­å¥ç¨âå½åè¯»âçå°ï¼ä¸è½ç§°ä¸ºå¹»è¯»ã å¹»è¯»ä»ä¸æâæ°æå¥çè¡âã\n\néçè®¾è®¡æ¯ä¸ºäºä¿è¯æ°æ®çä¸è´æ§ãèè¿ä¸ªä¸è´æ§ï¼ä¸æ­¢æ¯æ°æ®åºåé¨æ°æ®ç¶æå¨æ­¤ å»çä¸è´æ§ï¼è¿åå«äºæ°æ®åæ¥å¿å¨é»è¾ä¸çä¸è´æ§ã\n\ninnodbå¦ä½è§£å³å¹»è¯»ï¼\n\nå¹»è¯»äº§ççåå æ¯ï¼è¡éåªè½éä½è¡ï¼ä½æ¯æ°æå¥è®°å½è¿ä¸ªå¨ä½ï¼è¦æ´æ°çæ¯è®°å½ä¹é´çâé´éâãå æ­¤ï¼ä¸ºäºè§£å³å¹»è¯»é®é¢ï¼innodbåªå¥½å¼å¥æ°çéï¼ä¹å³æ¯é´ééï¼gap lockï¼ã\n\né´ééåè¡éåç§°next-key lockãä½å¶å®ä»ä»¬æ¯åå¼å çã\n\né´ééæ¯å¨å¯éå¤è¯»éç¦»çº§å«ä¸æä¼çæçãæä»¥ï¼ä½ å¦ææéç¦»çº§å«è®¾ç½®ä¸ºè¯»æäº¤çè¯ï¼ å°±æ²¡æé´ééäºãä½åæ¶ï¼ä½ è¦è§£å³å¯è½åºç°çæ°æ®åæ¥å¿ä¸ä¸è´é®é¢ï¼éè¦æbinlogæ ¼å¼è®¾ç½® ä¸ºrowãè¿ä¹æ¯ç°å¨ä¸å°å¬å¸ä½¿ç¨çéç½®ç»åã\n\nå¾å¤å¬å¸ä½¿ç¨ï¼è¯»æäº¤éç¦»çº§å«å binlog_format=rowçç»åãå°åºåä¸åçï¼\n\nå¦æè¯»æäº¤éç¦»çº§å«å¤ç¨ï¼å³ä¸å¡ä¸éè¦å¯éå¤è¯»çä¿è¯ï¼è¿æ ·èèå°è¯»æäº¤ä¸æä½æ°æ®çéèå´æ´å°ï¼æ²¡æé´ééï¼ï¼è¿ä¸ªéæ©æ¯åççã\n\næ¯å¦å¤§å®¶é½ç¨è¯»æäº¤ï¼å¯é»è¾å¤ä»½æ¶ï¼mysqldumpä¸ºä»ä¹è¦æå¤ä»½çº¿ç¨è®¾ç½®æå¯éå¤è¯»ï¼ç¶åï¼å¨å¤ä»½æé´ï¼å¤ä»½çº¿ç¨ç¨çæ¯å¯éå¤è¯»ï¼èä¸å¡çº¿ç¨ä½¿ç¨çæ¯è¯»æäº¤ï¼åæ¶å­å¨ä¸¤ç§äºå¡éç¦»çº§å«ä¼ä¸ä¼æé®é¢ï¼\n\n\n# äºåä¸ãå éè§å\n\n\n# å¯éå¤è¯»éç¦»çº§å«ä¸\n\néæ¯å å¨ç´¢å¼ä¸çã\n\nnext-key lock=é´éé+è¡éï¼(]ï¼åå¼åé­åºé´ã\n\né´ééï¼()ï¼åå¼åå¼åºé´ã\n\nè¡éå°±ä¸ä¸ªã\n\nå éè§åï¼2ä¸ªååï¼2ä¸ªä¼åï¼1ä¸ªbug\n\n 1. åå1ï¼å éçåºæ¬åä½æ¯next-key lockã\n\n 2. åå2ï¼æ¥æ¾è¿ç¨ä¸­è®¿é®å°çå¯¹è±¡æä¼å éã\n\n 3. ä¼å1ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼ç»å¯ä¸ç´¢å¼å éçæ¶åï¼next-key lockéåä¸ºè¡éã\n\n 4. ä¼å2ï¼ç´¢å¼ä¸çç­å¼æ¥è¯¢ï¼åå³éåæ¶ä¸éå°ä¸æ»¡è¶³ç­å¼æ¡ä»¶çå¼æ¶ï¼next-key lockéåä¸ºé´ééã\n\n 5. ä¸ä¸ªbugï¼å¯ä¸ç´¢å¼ä¸çèå´æ¥è¯¢ä¼è®¿é®å°ä¸æ»¡è¶³æ¡ä»¶çç¬¬ä¸ä¸ªå¼ä¸ºæ­¢ã\n\n\n# è¯»æäº¤éç¦»çº§å«ä¸\n\nè¯»æäº¤éç¦»çº§å«çè¯ï¼å»æé´ééçé¨åï¼å©ä¸è¡éçé¨åã\n\nå¶å®è¯»æäº¤éç¦»çº§å«å¨å¤é®åºæ¯ä¸è¿æ¯æé´ééï¼ç¸å¯¹æ¯è¾å¤æï¼æä»¬ä»å¤©åä¸å±å¼ã\n\nå¦å¤ï¼å¨è¯»æäº¤éç¦»çº§å«ä¸è¿æä¸ä¸ªä¼åï¼å³ï¼è¯­å¥æ§è¡è¿ç¨ä¸­å ä¸çè¡éï¼å¨è¯­å¥æ§è¡å®æåï¼å°±è¦æâä¸æ»¡è¶³æ¡ä»¶çè¡âä¸çè¡éç´æ¥éæ¾äºï¼ä¸éè¦ç­å°äºå¡æäº¤ã\n\nä¹å°±æ¯è¯´ï¼è¯»æäº¤éç¦»çº§å«ä¸ï¼éçèå´æ´å°ï¼éçæ¶é´æ´ç­ï¼è¿ä¹æ¯ä¸å°ä¸å¡é½é»è®¤ä½¿ç¨è¯»æäº¤éç¦»çº§å«çåå ã\n\n\n# 24ãmysqlæä¹ä¿æä¸»å¤ä¸è´ï¼\n\nbinlogåä¸å¯æ²¡ã\n\nmysqlæå®¹æå­¦ä¹ åæ¹ä¾¿ä½¿ç¨é«å¯ç¨æ¶æãå ä¹ææçé«å¯ç¨æ¶æï¼é½ç´æ¥ä¾èµäºbinlogãè½ç¶è¶æ¥ä¸å¤æï¼ä½é½æ¯ä»æåºæ¬çä¸ä¸»ä¸å¤æ¼åèæ¥ã\n\nå¨ä¸ä¸ªä¸»å¤å³ç³»ä¸­ï¼æ¯ä¸ªå¤åºæ¥åä¸»åºçbinlogæ§è¡ãåªè¦ä¸»åºæ§è¡æ´æ°çæçææbinlogé½å¯ä»¥ä¼ å°å¤åºè¢«æ­£ç¡®æ§è¡ï¼å¤åºå°±è½è¾¾å°è·ä¸»åºä¸è´çç¶æï¼è¿å°±æ¯æç»ä¸è´æ§ã\n\nå»ºè®®æå¤åºè®¾ç½®æreadonlyæ¨¡å¼ãå¥½å¤å¦ä¸ï¼\n\n * æäºè¿è¥ç±»çæ¥è¯¢è¯­å¥ä¼åå¤åºæ¥ï¼è®¾ç½®ä¸ºåªè¯»å¯é²æ­¢è¯¯æä½ã\n * é²æ­¢åæ¢é»è¾bugï¼å¦åæ¢è¿ç¨ä¸­åºç°ååï¼é æä¸»å¤ä¸ä¸è´ã\n * å¯ç¨readonlyç¶æï¼å¤æ­èç¹çè§è²ã\n\nå ä¸ºreadonlyè®¾ç½®å¯¹superæéè§è²æ æï¼èç¨äºåæ­¥æ´æ°ççº¿ç¨å°±æ¥æè¶çº§æéã\n\nä¸»åºåå¤åºä¹é´ç»´æäºä¸ä¸ªé¿è¿æ¥ãä¸»åºåé¨æä¸ä¸ªçº¿ç¨ï¼ä¸é¨ç¨äºæå¡å¤åºçè¿ä¸ªé¿è¿æ¥ã\n\nbinlogçä¸ç§æ ¼å¼ï¼ï¼éè¿binlog_formatå±æ§è®¾ç½®ï¼\n\n * statementãè®°å½çæ¯è¯­å¥åæãå¯è½å¯¼è´ä¸»å¤ä¸ä¸è´ã\n * rowãè®°å½äºçå®å é¤è¡çä¸»é®idï¼å¦ææ¯å é¤ï¼ãå ç©ºé´ï¼å¦å é¤10wæ¡æ°æ®ã\n * mixedãåä¸¤ç§çæ··åã\n\nç°å¨è¶æ¥è¶å¤çåºæ¯è¦æ±æmysqlçbinlogæ ¼å¼è®¾ç½®ä¸ºrowï¼å¶ä¸­ä¹ä¸å¥½å¤å¨äºï¼æ¢å¤æ°æ®ã\n\nå®éçäº§ä½¿ç¨æ¯è¾å¤çæ¯åmç»æï¼äºä¸ºä¸»å¤ãç¸è¾äºmsç»æï¼åæ¢æ¶ä¸ç¨ä¿®æ¹ä¸»å¤å³ç³»ã\n\nmysqléè¿å¤æ­server idçæ¹å¼ï¼è§£å³å¾ªç¯å¤å¶é®é¢ã\n\néè¿mysqlbinlogå·¥å·è§£æåæ¥çbinlogä¸­çåå®¹ã\n\n\n# 25ãmysqlå¦ä½ä¿è¯é«å¯ç¨ï¼\n\nåªææç»ä¸è´æ§è¿ä¸å¤ï¼mysqlè¿è¦æä¾é«å¯ç¨ã\n\n\n# ä¸»å¤å»¶è¿\n\nå¯éè¿å¨å¤åºæ§è¡ show slave statusæ¾ç¤ºseconds_behind_masterè¡¨ç¤ºå½åå¤åºå»¶è¿äºå¤å°ç§ã\n\nä¸»å¤å»¶è¿çæ¥æºï¼\n\n * å¤åºæå¨çæºå¨æ§è½æ¯ä¸»åºçå·®ãï¼ç°å¨ä¸è¬åå¯¹ç§°é¨ç½²ï¼ä¸»å¤åæ¢ï¼ã\n * å¤åºçååå¤§ã\n * ä¸»åºå¤§äºå¡ã\n   * å ä¸ºä¸»åºå¿é¡»ç­äºå¡æ§è¡å®ææä¼åå¥binlogï¼åä¼ ç»å¤åºã\n   * å¦ä¸è¦ä¸æ¬¡æ§ç¨deleteå é¤å¤ªå¤æ°æ®ï¼å¸åçå¤§äºå¡åºæ¯ã\n   * å¦å¤§è¡¨ddlä¹æ¯å¸åçå¤§äºå¡åºæ¯ãå¤çæ¹æ¡ï¼è®¡ååçddlï¼å»ºè®®ä½¿ç¨go-ostæ¹æ¡ã\n * å¤åºçå¹¶è¡å¤å¶è½åã\n\nä¸è¬å¤çï¼\n\n * ä¸ä¸»å¤ä»ãï¼è¿éæhaè¿ç¨ä¸­è¢«éææ°ä¸»åºçç§°ä¸ºå¤åºï¼å¶ä»çç§°ä¸ºä»åºãå¤åºåä»åºæ¦å¿µä¸å·®ä¸å¤ï¼\n * éè¿binlogè¾åºå°å¤é¨ç³»ç»ï¼å¦hadoopï¼è®©å¤é¨ç³»ç»æä¾ç»è®¡ç±»æ¥è¯¢çè½åã\n\n\n# å¯é æ§ä¼åç­ç¥ï¼\n\nåmç»æä¸ï¼ä¸»å¤åæ¢ï¼\n\n 1. å¤æ­å¤åºbç°å¨çseconds_behind_masterï¼å¦æå°äºæä¸ªå¼ï¼æ¯å¦5ç§ï¼ç»§ç»­ä¸ä¸æ­¥ï¼å¦å\n\næç»­éè¯è¿ä¸æ­¥ï¼\n\n 2. æä¸»åºaæ¹æåªè¯»ç¶æï¼å³æreadonlyè®¾ç½®ä¸ºtrueï¼\n\n 3. å¤æ­å¤åºbçseconds_behind_masterçå¼ï¼ç´å°è¿ä¸ªå¼åæ0ä¸ºæ­¢ï¼\n\n 4. æå¤åºbæ¹æå¯è¯»åç¶æï¼ä¹å°±æ¯æreadonly è®¾ç½®ä¸ºfalseï¼\n\n 5. æä¸å¡è¯·æ±åå°å¤åºbã\n\nè¿ä¸ªåæ¢æµç¨ï¼ä¸è¬æ¯ç±ä¸é¨çhaç³»ç»æ¥å®æçï¼æä»¬ææ¶ç§°ä¹ä¸ºå¯é æ§ä¼åæµç¨ã\n\n\n# å¯ç¨æ§æåç­ç¥ï¼\n\nå¦ææå¼ºè¡ææ­¥éª¤4ã5è°æ´å°æå¼å§æ§è¡ï¼ä¹å°±æ¯è¯´ä¸ç­ä¸»å¤æ°æ®åæ­¥ï¼ç´æ¥æè¿æ¥åå°å¤åº bï¼å¹¶ä¸è®©å¤åºbå¯ä»¥è¯»åï¼é£ä¹ç³»ç»å ä¹å°±æ²¡æä¸å¯ç¨æ¶é´äºã\n\nè¿ä¸ªåæ¢æµç¨çä»£ä»·ï¼å°±æ¯å¯è½åºç°æ°æ®ä¸ä¸ è´çæåµã\n\nç»è®ºï¼\n\n 1. ä½¿ç¨rowæ ¼å¼çbinlogæ¶ï¼æ°æ®ä¸ä¸è´çé®é¢æ´å®¹æè¢«åç°ãèä½¿ç¨mixedæèstatementæ ¼å¼çbinlogæ¶ï¼æ°æ®å¾å¯è½ææå°å°±ä¸ä¸è´äºãå¦æä½ è¿äºå¾ä¹æåç°æ°æ®ä¸ä¸è´çé®é¢ï¼ å¾å¯è½è¿æ¶çæ°æ®ä¸ä¸è´å·²ç»ä¸å¯æ¥ï¼æèè¿å¸¦é æäºæ´å¤çæ°æ®é»è¾ä¸ä¸è´ã\n\n 2. ä¸»å¤åæ¢çå¯ç¨æ§ä¼åç­ç¥ä¼å¯¼è´æ°æ®ä¸ä¸è´ãå æ­¤ï¼å¤§å¤æ°æåµä¸ï¼æé½å»ºè®®ä½ ä½¿ç¨å¯é æ§ä¼åç­ç¥ãæ¯ç«å¯¹æ°æ®æå¡æ¥è¯´çè¯ï¼æ°æ®çå¯é æ§ä¸è¬è¿æ¯è¦ä¼äºå¯ç¨æ§çã\n\nå¨æ»¡è¶³æ°æ®å¯é æ§çåæä¸ï¼mysqlé«å¯ç¨ç³»ç»çå¯ç¨æ§ï¼æ¯ä¾èµäºä¸»å¤å»¶è¿çãå»¶è¿çæ¶é´è¶å°ï¼å¨ä¸»åºæéçæ¶åï¼æå¡æ¢å¤éè¦çæ¶é´å°±è¶ç­ï¼å¯ç¨æ§å°±è¶é«ã\n\n\n# 26ãå¤åºä¸ºä»ä¹ä¼å»¶è¿å¥½å ä¸ªå°æ¶ï¼ï¼ç¥çï¼\n\nç®åæ»ç»ï¼\n\nä»ç»äºmysqlçåç§å¤çº¿ç¨å¤å¶ç­ç¥ã\n\nä¸ºä»ä¹è¦æå¤çº¿ç¨å¤å¶å¢ï¼è¿æ¯å ä¸ºåçº¿ç¨å¤å¶çè½åå¨é¢ä½äºå¤çº¿ç¨å¤å¶ï¼å¯¹äºæ´æ°ååè¾å¤§ çä¸»åºï¼å¤åºæ¯å¯è½ä¸ç´è¿½ä¸ä¸ä¸»åºçãä»ç°è±¡ä¸çå°±æ¯ï¼å¤åºä¸seconds_behind_masterçå¼ è¶æ¥è¶å¤§ã\n\nå¤§äºå¡ä¸ä»ä¼å½±åå°ä¸»åºï¼ä¹æ¯é æå¤åºå¤å¶å»¶è¿çä¸»è¦åå ä¹ä¸ã å æ­¤ï¼å¨å¹³æ¶çå¼åå·¥ä½ä¸­ï¼æå»ºè®®ä½ å°½éåå°å¤§äºå¡æä½ï¼æå¤§äºå¡ææå°äºå¡ã\n\nbinlog-transaction-dependency-trackingåæ°ï¼\n\n * commit_order\n * writeset\n * write_session\n\n\n# 27ãä¸»åºåºé®é¢äºä»åºæä¹åï¼\n\n\n\nä¸ä¸»å¤ä»åºæ¬ç»æã\n\nå°èç¹bè®¾ç½®æèç¹açä»åºa`ï¼éè¦æ§è¡change masterå½ä»¤ã\n\nè¿æ¡å½ä»¤æ6ä¸ªåæ°ï¼å¶ä¸­master_log_fileåmaster_log_posè¡¨ç¤ºä»ä¸»åºçãæä»¶åãããæ¥å¿åç§»éãçæ¥å¿ç»§ç»­åæ­¥ã\n\nè¿ä¸ªposå¾å¾ä¸ç²¾ç¡®ã\n\néå¸¸æä»¬å¨åæ¢ä»»å¡æ¶ï¼è¦åä¸»å¨è·³è¿è¿äºéè¯¯ï¼æä¸¤ç§å¸¸ç¨çæ¹æ³ï¼\n\n * ä¸»å¨è·³è¿ä¸ä¸ªäºå¡set global sql_slave_skip_count = 1;start save;\n * éè¿è®¾ç½®slave_skip_erroråæ°ï¼ç´æ¥è®¾ç½®è·³è¿æå®çéè¯¯ã\n   * 1062éè¯¯æ¯æå¥æ°æ®æ¶å¯ä¸é®å²çªï¼\n   * 1032éè¯¯æ¯å é¤æ°æ®æ¶æ¾ä¸å°è¡ã\n\n\n# gtid\n\néè¿sql_slave_skip_counterè·³è¿äºå¡åéè¿slave_skip_errorså¿½ç¥éè¯¯çæ¹æ³ï¼è½ç¶é½æç»å¯ä»¥ å»ºç«ä»åºbåæ°ä¸»åºaâçä¸»å¤å³ç³»ï¼ä½è¿ä¸¤ç§æä½é½å¾å¤æï¼èä¸å®¹æåºéãæä»¥ï¼mysql 5.6çæ¬å¼å¥äºgtidï¼å½»åºè§£å³äºè¿ä¸ªå°é¾ã\n\ngtidçå¨ç§°æ¯global transaction identifierï¼ä¹å°±æ¯å¨å±äºå¡idï¼æ¯ä¸ä¸ªäºå¡å¨æäº¤çæ¶åçæçï¼æ¯è¿ä¸ªäºå¡çå¯ä¸æ è¯ã\n\ngtid=server_uuid:gno\n\n * server_uuidæ¯ä¸ä¸ªå®ä¾ç¬¬ä¸æ¬¡å¯å¨æ¶èªå¨çæçï¼æ¯ä¸ä¸ªå¨å±å¯ä¸çå¼ï¼\n\n * gnoæ¯ä¸ä¸ªæ´æ°ï¼åå§å¼æ¯1ï¼æ¯æ¬¡æäº¤äºå¡çæ¶ååéç»è¿ä¸ªäºå¡ï¼å¹¶å 1ã\n\ngtidä¸»å¤å¤å¶çç¨æ³ï¼\n\næ§è¡change masteï¼åªéä½¿ç¨master_auto_position = 1ä»£æ¿åé¢çmaster_log_fileåmaster_log_posã\n\nå¨åºäºgtidçä¸»å¤å³ç³»éï¼ç³»ç»è®¤ä¸ºåªè¦å»ºç«ä¸»å¤å³ç³»ï¼å°±å¿é¡»ä¿è¯ä¸»åºåç»å¤åºçæ¥å¿æ¯å®æ´çãå æ­¤ï¼å¦æå®ä¾béè¦çæ¥å¿å·²ç»ä¸å­å¨ï¼aâå°±æç»ææ¥å¿åç»bã\n\nè¿è·åºäºä½ç¹çä¸»å¤åè®®ä¸åãåºäºä½ç¹çåè®®ï¼æ¯ç±å¤åºå³å®çï¼å¤åºæå®åªä¸ªä½ç¹ï¼ä¸»åºå°±ååªä¸ªä½ç¹ï¼ä¸åæ¥å¿çå®æ´æ§å¤æ­ã\n\n\n# 28ãè¯»ååç¦»\n\nä¸ä¸»å¤ä»æ¶æçåºç¨åºæ¯ï¼è¯»ååç¦»ã\n\nè¯»ååç¦»çä¸»è¦ç®æ å°±æ¯åæä¸»åºçååã\n\n\n\nå®¢æ·ç«¯ä¸»å¨åè¯»ååç¦»ã\n\n\n\nä¸­é´ä»£çå±proxyååã\n\næ¹æ¡ï¼\n\n * å¼ºå¶èµ°ä¸»åºæ¹æ¡\n * sleepæ¹æ¡\n * å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡\n   * å¤æ­seconds_behind_master æ¯å¦ç­äº0\n   * å¯¹æ¯ä½ç¹quç¡®ä¿ä¸»å¤æ å»¶è¿\n   * å¯¹æ¯gtidéåç¡®ä¿ä¸»å¤æ å»¶è¿\n * éåsemi-syncæ¹æ¡\n * ç­ä¸»åºä½ç¹æ¹æ¡\n * ç­gtidæ¹æ¡\n\n\n# å¤æ­ä¸»å¤æ å»¶è¿æ¹æ¡\n\n\n# semi-sync replication ååæ­¥æ§å¶\n\n 1. äºå¡æäº¤çæ¶åï¼ä¸»åºæbinlogåç»ä»åºï¼\n\n 2. ä»åºæ¶å°binlogä»¥åï¼ååç»ä¸»åºä¸ä¸ªackï¼è¡¨ç¤ºæ¶å°äºï¼\n\n 3. ä¸»åºæ¶å°è¿ä¸ªackä»¥åï¼æè½ç»å®¢æ·ç«¯è¿åâäºå¡å®æâçç¡®è®¤ã\n\nsemi-syncéååé¢å³äºä½ç¹çå¤æ­ï¼å°±è½å¤ç¡®å®å¨ä»åºä¸æ§è¡çæ¥è¯¢è¯·æ±ï¼å¯ä»¥é¿åè¿æè¯»ã\n\nä½æ¯ï¼semi-sync+ä½ç¹å¤æ­çæ¹æ¡ï¼åªå¯¹ä¸ä¸»ä¸å¤çåºæ¯æ¯æç«çãå¨ä¸ä¸»å¤ä»åºæ¯ä¸­ï¼ä¸»åºåª è¦ç­å°ä¸ä¸ªä»åºçackï¼å°±å¼å§ç»å®¢æ·ç«¯è¿åç¡®è®¤ã\n\nå°ç»ä¸ä¸ï¼semi-syncéåå¤æ­ä¸»å¤æ å»¶è¿çæ¹æ¡ï¼å­å¨ä¸¤ä¸ªé®é¢ï¼\n\n 1. ä¸ä¸»å¤ä»çæ¶åï¼å¨æäºä»åºæ§è¡æ¥è¯¢è¯·æ±ä¼å­å¨è¿æè¯»çç°è±¡ï¼\n\n 2. å¨æç»­å»¶è¿çæåµä¸ï¼å¯è½åºç°è¿åº¦ç­å¾çé®é¢ã\n\nç­ä¸»åºä½ç¹æ¹æ¡ï¼å°±å¯ä»¥è§£å³è¿ä¸¤ä¸ªé®é¢\n\n\n# ç­ä¸»åºä½ç¹æ¹æ¡\n\nselect master_pos_wait(file, pos[, timeout]);\n\n 1. å®æ¯å¨ä»åºæ§è¡çï¼\n\n 2. åæ°fileåposæçæ¯ä¸»åºä¸çæä»¶ååä½ç½®ï¼\n\n 3. timeoutå¯éï¼è®¾ç½®ä¸ºæ­£æ´æ°nè¡¨ç¤ºè¿ä¸ªå½æ°æå¤ç­å¾nç§ã\n\nè¿ä¸ªå½ä»¤æ­£å¸¸è¿åçç»ææ¯ä¸ä¸ªæ­£æ´æ°mï¼è¡¨ç¤ºä»å½ä»¤å¼å§æ§è¡ï¼å°åºç¨å®fileåposè¡¨ç¤ºç binlogä½ç½®ï¼æ§è¡äºå¤å°äºå¡ã\n\nå½ç¶ï¼é¤äºæ­£å¸¸è¿åä¸ä¸ªæ­£æ´æ°må¤ï¼è¿æ¡å½ä»¤è¿ä¼è¿åä¸äºå¶ä»ç»æï¼åæ¬ï¼\n\n 1. å¦ææ§è¡æé´ï¼å¤åºåæ­¥çº¿ç¨åçå¼å¸¸ï¼åè¿ånullï¼\n\n 2. å¦æç­å¾è¶è¿nç§ï¼å°±è¿å-1ï¼\n\n 3. å¦æåå¼å§æ§è¡çæ¶åï¼å°±åç°å·²ç»æ§è¡è¿è¿ä¸ªä½ç½®äºï¼åè¿å0ã\n\n 4. trx1äºå¡æ´æ°å®æåï¼é©¬ä¸æ§è¡show master statuså¾å°å½åä¸»åºæ§è¡å°çfileåpositionï¼\n\n 5. éå®ä¸ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 6. å¨ä»åºä¸æ§è¡select master_pos_wait(file, position, 1)ï¼\n\n 7. å¦æè¿åå¼æ¯>=0çæ­£æ´æ°ï¼åå¨è¿ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 8. å¦åï¼å°ä¸»åºæ§è¡æ¥è¯¢è¯­å¥ã\n\nå¦ææç§æä»¬è®¾å®ä¸åè®¸è¿æè¯»çè¦æ±ï¼å°±åªæä¸¤ç§éæ©ï¼ä¸ç§æ¯è¶æ¶æ¾å¼ï¼ä¸ç§æ¯è½¬å°ä¸»åºæ¥è¯¢ãå·ä½æä¹éæ©ï¼å°±éè¦ä¸å¡å¼ååå­¦åå¥½éæµç­ç¥äºã\n\n\n# gtidæ¹æ¡\n\nå¦æä½ çæ°æ®åºå¼å¯äºgtidæ¨¡å¼ï¼å¯¹åºçä¹æç­å¾gtidçæ¹æ¡ã\n\nselect wait_for_executed_gtid_set(gtid_set, 1);\n\nè¿æ¡å½ä»¤çé»è¾æ¯ï¼\n\n 1. ç­å¾ï¼ç´å°è¿ä¸ªåºæ§è¡çäºå¡ä¸­åå«ä¼ å¥çgtid_setï¼è¿å0ï¼\n\n 2. è¶æ¶è¿å1ã\n\nå¨åé¢ç­ä½ç¹çæ¹æ¡ä¸­ï¼æä»¬æ§è¡å®äºå¡åï¼è¿è¦ä¸»å¨å»ä¸»åºæ§è¡show master statusãè mysql 5.7.6çæ¬å¼å§ï¼åè®¸å¨æ§è¡å®æ´æ°ç±»äºå¡åï¼æè¿ä¸ªäºå¡çgtidè¿åç»å®¢æ·ç«¯ï¼è¿æ ·ç­gtidçæ¹æ¡å°±å¯ä»¥åå°ä¸æ¬¡æ¥è¯¢ã è¿æ¶ï¼ç­gtidçæ§è¡æµç¨å°±åæäºï¼\n\n 1. trx1äºå¡æ´æ°å®æåï¼ä»è¿ååç´æ¥è·åè¿ä¸ªäºå¡çgtidï¼è®°ä¸ºgtid1ï¼\n\n 2. éå®ä¸ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 3. å¨ä»åºä¸æ§è¡ select wait_for_executed_gtid_set(gtid1, 1)ï¼\n\n 4. å¦æè¿åå¼æ¯0ï¼åå¨è¿ä¸ªä»åºæ§è¡æ¥è¯¢è¯­å¥ï¼\n\n 5. å¦åï¼å°ä¸»åºæ§è¡æ¥è¯¢è¯­å¥ã\n\nè·ç­ä¸»åºä½ç¹çæ¹æ¡ä¸æ ·ï¼ç­å¾è¶æ¶åæ¯å¦ç´æ¥å°ä¸»åºæ¥è¯¢ï¼éè¦ä¸å¡å¼ååå­¦æ¥åéæµèèã\n\nå¨å®éåºç¨ä¸­ï¼è¿å ä¸ªæ¹æ¡æ¯å¯ä»¥æ··åä½¿ç¨çã\n\næ¯å¦ï¼åå¨å®¢æ·ç«¯å¯¹è¯·æ±ååç±»ï¼åºååªäºè¯·æ±å¯ä»¥æ¥åè¿æè¯»ï¼èåªäºè¯·æ±å®å¨ä¸è½æ¥åè¿æè¯»ï¼ç¶åï¼å¯¹äºä¸è½æ¥åè¿æè¯»çè¯­å¥ï¼åä½¿ç¨ç­gtidæç­ä½ç¹çæ¹æ¡ã\n\nä½è¯è¯´åæ¥ï¼è¿æè¯»å¨æ¬è´¨ä¸æ¯ç±ä¸åå¤è¯»å¯¼è´çãå¨å®éåºç¨ä¸­ï¼å¯è½ä¼æå«çä¸éè¦ç­å¾å°±å¯ä»¥æ°´å¹³æ©å±çæ°æ®åºæ¹æ¡ï¼ä½è¿å¾å¾æ¯ç¨çºç²åæ§è½æ¢æ¥çï¼ä¹å°±æ¯éè¦å¨è¯»æ§è½ååæ§è½ä¸­åæè¡¡ã\n\nå¼æºproxyï¼mariadb maxscale\n\n\n# 40ãinnodbåmemoryå¼æ\n\ninnodbè¡¨çæ°æ®å°±æ¾å¨ä¸»é®ç´¢å¼æ ä¸ï¼ä¸»é®ç´¢å¼æ¯b+æ ã\n\nmemoryå¼æçæ°æ®åç´¢å¼æ¯åå¼çã\n\nåå­è¡¨çæ°æ®é¨åä»¥æ°ç»çå½¢å¼åç¬å­æ¾ï¼èä¸»é®idç´¢å¼éï¼å­æ¾çæ¯æ¯ä¸ªæ°æ®çä½ç½®ãä¸»é®idæ¯hashç´¢å¼ï¼ç´¢å¼ä¸çkeyä¸æ¯æåºçã\n\nå¯è§ï¼innodbåmemoryå¼æçæ°æ®ç»ç»æ¹å¼æ¯ä¸åçï¼\n\n * innodbå¼æææ°æ®æ¾å¨ä¸»é®ç´¢å¼ä¸ï¼å¶ä»ç´¢å¼ä¸ä¿å­çæ¯ä¸»é®idãè¿ç§æ¹å¼ï¼æä»¬ç§°ä¹ä¸ºç´¢å¼ç»ç»è¡¨ ï¼index organizied tableï¼ã\n\n * èmemoryå¼æéç¨çæ¯ææ°æ®åç¬å­æ¾ï¼ç´¢å¼ä¸ä¿å­æ°æ®ä½ç½®çæ°æ®ç»ç»å½¢å¼ï¼æä»¬ç§°ä¹ ä¸ºå ç»ç»è¡¨ ï¼heap organizied tableï¼ã\n\nè¿ä¸¤ä¸ªå¼æçä¸äºå¸åä¸åï¼\n\n 1. innodbè¡¨çæ°æ®æ»æ¯æåºå­æ¾çï¼èåå­è¡¨çæ°æ®å°±æ¯æç§åå¥é¡ºåºå­æ¾çï¼\n 2. å½æ°æ®æä»¶æç©ºæ´çæ¶åï¼innodbè¡¨å¨æå¥æ°æ°æ®çæ¶åï¼ä¸ºäºä¿è¯æ°æ®æåºæ§ï¼åªè½å¨åºå®çä½ç½®åå¥æ°å¼ï¼èåå­è¡¨æ¾å°ç©ºä½å°±å¯ä»¥æå¥æ°å¼ï¼\n 3. æ°æ®ä½ç½®åçååçæ¶åï¼innodbè¡¨åªéè¦ä¿®æ¹ä¸»é®ç´¢å¼ï¼èåå­è¡¨éè¦ä¿®æ¹ææç´¢å¼ï¼\n 4. innodbè¡¨ç¨ä¸»é®ç´¢å¼æ¥è¯¢æ¶éè¦èµ°ä¸æ¬¡ç´¢å¼æ¥æ¾ï¼ç¨æ®éç´¢å¼æ¥è¯¢çæ¶åï¼éè¦èµ°ä¸¤æ¬¡ç´¢å¼æ¥æ¾ãèåå­è¡¨æ²¡æè¿ä¸ªåºå«ï¼ææç´¢å¼çâå°ä½âé½æ¯ç¸åçã\n 5. innodbæ¯æåé¿æ°æ®ç±»åï¼ä¸åè®°å½çé¿åº¦å¯è½ä¸åï¼åå­è¡¨ä¸æ¯æblob å textå­æ®µï¼å¹¶ä¸å³ä½¿å®ä¹äºvarchar(n)ï¼å®éä¹å½ä½char(n)ï¼ä¹å°±æ¯åºå®é¿åº¦å­ç¬¦ä¸²æ¥å­å¨ï¼å æ­¤åå­è¡¨çæ¯è¡æ°æ®é¿åº¦ç¸åã\n\n\n# hashç´¢å¼åb-treeç´¢å¼\n\nå®éä¸ï¼åå­è¡¨ä¹æ¯èªæb-treeç´¢å¼çã\n\nå¨æä»¬çä¸è¬å°è±¡ä¸­ï¼åå­è¡¨çä¼å¿æ¯éåº¦å¿«ï¼å¶ä¸­ä¸ä¸ªåå å°±æ¯memoryå¼ææ¯æhashç´¢å¼ãæ´éè¦çåå æ¯ï¼åå­è¡¨çæææ°æ®é½ä¿å­å¨åå­ä¸ï¼èåå­çè¯»åéåº¦æ»æ¯æ¯ç£çå¿«ã\n\nä½ä¸å»ºè®®å¨çäº§ç¯å¢ä¸ä½¿ç¨åå­è¡¨ï¼ä¸»è¦æ2ä¸ªåå ï¼\n\n 1. éç²åº¦é®é¢ã\n    1. åå­è¡¨ä¸æ¯æè¡éï¼åªæ¯æè¡¨éã\n 2. æ°æ®æä¹åé®é¢\n\nå»ºè®®ææ®éåå­è¡¨é½ç¨innodbè¡¨ä»£æ¿ã\n\nä¾å¤çåºæ¯ï¼åå­ä¸´æ¶è¡¨ãåå­è¡¨æ¯æhashç´¢å¼ï¼è¿ä¸ªç¹æ§å©ç¨èµ·æ¥ï¼å¯¹å¤ææ¥è¯¢çå éææè¿æ¯å¾ä¸éçã\n\n\n# 40ãinsertè¯­å¥çéä¸ºä»ä¹è¿ä¹å¤ï¼ï¼åç¥æ»ç»ï¼\n\nmysqlå¯¹èªå¢ä¸»é®éåäºä¼åï¼å°½éå¨ç³è¯·å°èªå¢idä»¥åï¼å°±éæ¾èªå¢éã\n\næ®éæåµä¸ï¼insertè¯­å¥æ¯ä¸ä¸ªå¾è½»éçæä½ã\n\nç¹æ®æåµä¸ï¼å¦ï¼\n\ninsert â¦select æ¯å¾å¸¸è§çå¨ä¸¤ä¸ªè¡¨ä¹é´æ·è´æ°æ®çæ¹æ³ãä½ éè¦æ³¨æï¼å¨å¯éå¤è¯»éç¦»çº§å«ä¸ï¼è¿ä¸ªè¯­å¥ä¼ç»selectçè¡¨éæ«æå°çè®°å½åé´éå è¯»éã èå¦æinsertåselectçå¯¹è±¡æ¯åä¸ä¸ªè¡¨ï¼åæå¯è½ä¼é æå¾ªç¯åå¥ãè¿ç§æåµä¸ï¼æä»¬éè¦å¼å¥\n\nç¨æ·ä¸´æ¶è¡¨æ¥åä¼åã\n\ninsert è¯­å¥å¦æåºç°å¯ä¸é®å²çªï¼ä¼å¨å²çªçå¯ä¸å¼ä¸å å±äº«çnext-key lock(sé)ãå æ­¤ï¼ç¢°å°\n\nç±äºå¯ä¸é®çº¦æå¯¼è´æ¥éåï¼è¦å°½å¿«æäº¤æåæ»äºå¡ï¼é¿åå éæ¶é´è¿é¿ã\n\n\n# 43ãè¦ä¸è¦ä½¿ç¨ååºè¡¨ï¼\n\nååºè¡¨æä»ä¹é®é¢ï¼ä¸ºä»ä¹å¾å¤å¬å¸è§èä¸è®©ä½¿ç¨ååºè¡¨å¢ï¼\n\nååºè¡¨çç»ç»å½¢å¼ï¼\n\ncreate table `t` (\n\t`ftime` datetime notnull,\n  `c` int(11) default null,\n  key (`ftime`)\n) engine=innodb default charset = latin1\npartition by range(year(ftime))\n(partition p_2017 values less than (2017) engine = innodb,\n partition p_2018 values less than (2018) engine = innodb,\n partition p_2019 values less than (2019) engine = innodb,\n partition p_others values less than maxvalue engine = innodb);\n \n insert into t value('2017-4-1',1),('2018-4-1',1); \n\n\nå¨è¡¨tä¸­åå§åæå¥äºä¸¤è¡è®°å½ï¼æç§å®ä¹çååºè§åï¼è¿ä¸¤è¡è®°å½åå«è½å¨p_2018åp_2019 è¿ä¸¤ä¸ªååºä¸ã\n\nè¿ä¸ªè¡¨åå«äºä¸ä¸ª.frmæä»¶å4ä¸ª.ibdæä»¶ï¼æ¯ä¸ªååºå¯¹åºä¸ä¸ª.ibdæä»¶ãä¹å°±æ¯è¯´ï¼\n\n * å¯¹äºå¼æå±æ¥è¯´ï¼è¿æ¯4ä¸ªè¡¨ï¼\n * å¯¹äºserverå±æ¥è¯´ï¼è¿æ¯1ä¸ªè¡¨ã\n\næä»¬ä½¿ç¨ååºè¡¨çä¸ä¸ªéè¦åå å°±æ¯åè¡¨è¿å¤§ãé£ä¹ï¼å¦æä¸ä½¿ç¨ååºè¡¨çè¯ï¼æä»¬å°±æ¯è¦ä½¿ç¨æå¨åè¡¨çæ¹å¼ã\n\nååºè¡¨åæå·¥åè¡¨ï¼ä¸ä¸ªæ¯ç±serverå±æ¥å³å®ä½¿ç¨åªä¸ªååºï¼ä¸ä¸ªæ¯ç±åºç¨å±ä»£ç æ¥å³å®ä½¿ç¨åª ä¸ªåè¡¨ãå æ­¤ï¼ä»å¼æå±çï¼è¿ä¸¤ç§æ¹å¼ä¹æ¯æ²¡æå·®å«çã\n\nå¶å®è¿ä¸¤ä¸ªæ¹æ¡çåºå«ï¼ä¸»è¦æ¯å¨serverå±ä¸ãä»serverå±çï¼æä»¬å°±ä¸å¾ä¸æå°ååºè¡¨ä¸ä¸ªè¢«å¹¿ä¸ºè¯ççé®é¢ï¼æå¼è¡¨çè¡ä¸ºã\n\n 1. mysqlå¨ç¬¬ä¸æ¬¡æå¼ååºè¡¨çæ¶åï¼éè¦è®¿é®ææçååºï¼\n\n 2. å¨serverå±ï¼è®¤ä¸ºè¿æ¯åä¸å¼ è¡¨ï¼å æ­¤ææååºå±ç¨åä¸ä¸ªmdléï¼\n\n 3. å¨å¼æå±ï¼è®¤ä¸ºè¿æ¯ä¸åçè¡¨ï¼å æ­¤mdléä¹åçæ§è¡è¿ç¨ï¼ä¼æ ¹æ®ååºè¡¨è§åï¼åªè®¿é®å¿è¦çååºã\n\n\n# ååºè¡¨çåºç¨åºæ¯\n\nååºè¡¨çä¸ä¸ªæ¾èæè§çä¼å¿æ¯å¯¹ä¸å¡éæï¼ç¸å¯¹äºç¨æ·åè¡¨æ¥è¯´ï¼ä½¿ç¨ååºè¡¨çä¸å¡ä»£ç æ´ç®æ´ãè¿æï¼ååºè¡¨å¯ä»¥å¾æ¹ä¾¿çæ¸çåå²æ°æ®ã\n\nå¦æä¸é¡¹ä¸å¡è·çæ¶é´è¶³å¤é¿ï¼å¾å¾å°±ä¼ææ ¹æ®æ¶é´å é¤åå²æ°æ®çéæ±ãè¿æ¶åï¼æç§æ¶é´ååºçååºè¡¨ï¼å°±å¯ä»¥ç´æ¥éè¿alter table t drop partitionè¿ä¸ªè¯­æ³å æååºï¼ä»èå æè¿æçåå²æ°æ®ã\n\nè¿ä¸ªalter table t drop partition â¦æä½æ¯ç´æ¥å é¤ååºæä»¶ï¼ææè·dropæ®éè¡¨ç±»ä¼¼ãä¸ä½¿ç¨deleteè¯­å¥å é¤æ°æ®ç¸æ¯ï¼ä¼å¿æ¯éåº¦å¿«ãå¯¹ç³»ç»å½±åå°ã\n\næä»¬ä»¥èå´ååºï¼rangeï¼ä¸ºä¾åä½ ä»ç»çãå®éä¸ï¼mysqlè¿æ¯æhashååºã listååºç­ååºæ¹æ³ãä½ å¯ä»¥å¨éè¦ç¨å°çæ¶åï¼åç¿»ç¿»æåã\n\nå®éä½¿ç¨æ¶ï¼ååºè¡¨è·ç¨æ·åè¡¨æ¯èµ·æ¥ï¼æä¸¤ä¸ªç»ä¸å¼çé®é¢ï¼ä¸ä¸ªæ¯ç¬¬ä¸æ¬¡è®¿é®çæ¶åéè¦è®¿é®ææååºï¼å¦ä¸ä¸ªæ¯å±ç¨mdléã\n\nå æ­¤ï¼å¦æè¦ä½¿ç¨ååºè¡¨ï¼å°±ä¸è¦åå»ºå¤ªå¤çååºãæè§è¿ä¸ä¸ªç¨æ·åäºæå¤©ååºç­ç¥ï¼ç¶åé¢ååå»ºäº10å¹´çååºãè¿ç§æåµä¸ï¼è®¿é®ååºè¡¨çæ§è½èªç¶æ¯ä¸å¥½çãè¿éæä¸¤ä¸ªé®é¢éè¦æ³¨æï¼\n\n 1. ååºå¹¶ä¸æ¯è¶ç»è¶å¥½ãå®éä¸ï¼åè¡¨æèåååºçæ°æ®ä¸åä¸è¡ï¼åªè¦æ²¡æç¹å«å¤§çç´¢å¼ï¼ å¯¹äºç°å¨çç¡¬ä»¶è½åæ¥è¯´é½å·²ç»æ¯å°è¡¨äºã\n\n 2. ååºä¹ä¸è¦æåé¢çå¤ªå¤ï¼å¨ä½¿ç¨ä¹åé¢ååå»ºå³å¯ãæ¯å¦ï¼å¦ææ¯ææååºï¼æ¯å¹´å¹´åºæ¶åæä¸ä¸å¹´åº¦ç12ä¸ªæ°ååºåå»ºä¸å³å¯ãå¯¹äºæ²¡ææ°æ®çåå²ååºï¼è¦åæ¶çdropæã\n\nè³äºååºè¡¨çå¶ä»é®é¢ï¼æ¯å¦æ¥è¯¢éè¦è·¨å¤ä¸ªååºåæ°æ®ï¼æ¥è¯¢æ§è½å°±ä¼æ¯è¾æ¢ï¼åºæ¬ä¸å°±ä¸æ¯ååºè¡¨æ¬èº«çé®é¢ï¼èæ¯æ°æ®éçé®é¢æèè¯´æ¯ä½¿ç¨æ¹å¼çé®é¢äºã\n\nå½ç¶ï¼å¦æä½ çå¢éå·²ç»ç»´æ¤äºæççååºåè¡¨ä¸­é´ä»¶ï¼ç¨ä¸å¡åè¡¨ï¼å¯¹ä¸å¡å¼ååå­¦æ²¡æé¢å¤çå¤ææ§ï¼å¯¹dbaä¹æ´ç´è§ï¼èªç¶æ¯æ´å¥½çã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"test",frontmatter:{title:"test",date:"2023-04-15T17:00:06.000Z",permalink:"/pages/b55c23/",article:!1},regularPath:"/02.MySQL/test.html",relativePath:"02.MySQL/test.md",key:"v-1c9fd64e",path:"/pages/b55c23/",headersStr:null,content:"æ²¡åç¼å·ï¼å°±ä¸ä¼å¨é¡µé¢ä¸­åºç°ãæ¾ç¶è¿ä¸ªç»è®ºæ¯éè¯¯çã",normalizedContent:"æ²¡åç¼å·ï¼å°±ä¸ä¼å¨é¡µé¢ä¸­åºç°ãæ¾ç¶è¿ä¸ªç»è®ºæ¯éè¯¯çã",charsets:{cjk:!0}},{title:"Redisæ»",frontmatter:{title:"Redisæ»",date:"2023-03-16T23:27:49.000Z",permalink:"/pages/redis/"},regularPath:"/03.Redis/01.redis%E6%80%BB.html",relativePath:"03.Redis/01.redisæ».md",key:"v-5f0f30c6",path:"/pages/redis/",headers:[{level:2,title:"Redisåèèµææ±æ»",slug:"redisåèèµææ±æ»",normalizedTitle:"redisåèèµææ±æ»",charIndex:2},{level:2,title:"Redisä¼ç¼ºç¹ï¼",slug:"redisä¼ç¼ºç¹",normalizedTitle:"redisä¼ç¼ºç¹ï¼",charIndex:253},{level:2,title:"Redisä¸ºä»ä¹è¿ä¹å¿«ï¼",slug:"redisä¸ºä»ä¹è¿ä¹å¿«",normalizedTitle:"redisä¸ºä»ä¹è¿ä¹å¿«ï¼",charIndex:701},{level:2,title:"Redis ä¸ºä»ä¹ç¨åçº¿ç¨ï¼",slug:"redis-ä¸ºä»ä¹ç¨åçº¿ç¨",normalizedTitle:"redis ä¸ºä»ä¹ç¨åçº¿ç¨ï¼",charIndex:1010},{level:2,title:"Redis ä¸­çReactoræ¨¡å",slug:"redis-ä¸­çreactoræ¨¡å",normalizedTitle:"redis ä¸­çreactoræ¨¡å",charIndex:1164},{level:2,title:"åºç¨åºæ¯",slug:"åºç¨åºæ¯",normalizedTitle:"åºç¨åºæ¯",charIndex:1903},{level:2,title:"MemcachedåRedisçåºå«",slug:"memcachedåredisçåºå«",normalizedTitle:"memcachedåredisçåºå«",charIndex:2194},{level:2,title:"ä¸ºä»ä¹è¦ç¨ Redis èä¸ç¨ map/guava åç¼å­?",slug:"ä¸ºä»ä¹è¦ç¨-redis-èä¸ç¨-map-guava-åç¼å­",normalizedTitle:"ä¸ºä»ä¹è¦ç¨ redis èä¸ç¨ map/guava åç¼å­?",charIndex:2393}],headersStr:"Redisåèèµææ±æ» Redisä¼ç¼ºç¹ï¼ Redisä¸ºä»ä¹è¿ä¹å¿«ï¼ Redis ä¸ºä»ä¹ç¨åçº¿ç¨ï¼ Redis ä¸­çReactoræ¨¡å åºç¨åºæ¯ MemcachedåRedisçåºå« ä¸ºä»ä¹è¦ç¨ Redis èä¸ç¨ map/guava åç¼å­?",content:"# Redisåèèµææ±æ»\n\n * http://www.topjavaer.cn/redis/redis-basic/\n * https://www.iamshuaidi.com/redis-interview\n * https://xie.infoq.cn/article/6c3500c66c3cdee3d72b88780\n * https://zhuanlan.zhihu.com/p/553803052\n * https://segmentfault.com/blog/magebyte\n\n\n# Redisä¼ç¼ºç¹ï¼\n\nä¼ç¹ï¼\n\n 1. åºäºåå­æä½ï¼åå­è¯»åéåº¦å¿«ã\n 2. æ¯æå¤ç§æ°æ®ç±»åï¼åæ¬StringãHashãListãSetãZSetç­ã\n 3. æ¯ææä¹åãRedisæ¯æRDBåAOFä¸¤ç§æä¹åæºå¶ï¼æä¹ååè½å¯ä»¥ææå°é¿åæ°æ®ä¸¢å¤±é®é¢ã\n 4. æ¯æäºå¡ãRedisçæææä½é½æ¯åå­æ§çï¼åæ¶Redisè¿æ¯æå¯¹å ä¸ªæä½åå¹¶åçåå­æ§æ§è¡ã\n 5. æ¯æä¸»ä»å¤å¶ãä¸»èç¹ä¼èªå¨å°æ°æ®åæ­¥å°ä»èç¹ï¼å¯ä»¥è¿è¡è¯»ååç¦»ã\n 6. Rediså½ä»¤çå¤çæ¯åçº¿ç¨çï¼é¿åçº¿ç¨åæ¢å¼éåå¤çº¿ç¨çç«äºé®é¢ãRedis6.0å¼å¥äºå¤çº¿ç¨ï¼éè¦æ³¨æçæ¯ï¼å¤çº¿ç¨ç¨äºå¤çç½ç»æ°æ®çè¯»åååè®®è§£æï¼Rediså½ä»¤æ§è¡è¿æ¯åçº¿ç¨çã\n\nç¼ºç¹ï¼\n\n 1. å¯¹ç»æåæ¥è¯¢çæ¯ææ¯è¾å·®ã\n 2. æ°æ®åºå®¹éåå°ç©çåå­çéå¶ï¼ä¸éåç¨ä½æµ·éæ°æ®çé«æ§è½è¯»åï¼å æ­¤Rediséåçåºæ¯ä¸»è¦å±éå¨è¾å°æ°æ®éçæä½ã\n 3. Redis è¾é¾æ¯æå¨çº¿æ©å®¹ï¼å¨éç¾¤å®¹éè¾¾å°ä¸éæ¶å¨çº¿æ©å®¹ä¼åå¾å¾å¤æã\n\n\n# Redisä¸ºä»ä¹è¿ä¹å¿«ï¼\n\n * åºäºåå­ï¼Redisæ¯ä½¿ç¨åå­å­å¨ï¼æ²¡æç£çIOä¸çå¼éãæ°æ®å­å¨åå­ä¸­ï¼è¯»åéåº¦å¿«ã\n * IOå¤è·¯å¤ç¨æ¨¡åï¼Redis éç¨ IO å¤è·¯å¤ç¨ææ¯ãRedis ä½¿ç¨åçº¿ç¨æ¥è½®è¯¢æè¿°ç¬¦ï¼å°æ°æ®åºçæä½é½è½¬æ¢æäºäºä»¶ï¼ä¸å¨ç½ç»I/Oä¸æµªè´¹è¿å¤çæ¶é´ãéé»å¡ IOã\n * é«æçæ°æ®ç»æï¼Redis æ¯ç§æ°æ®ç±»ååºå±é½åäºä¼åï¼ç®çå°±æ¯ä¸ºäºè¿½æ±æ´å¿«çéåº¦ãå¨æå­ç¬¦ä¸²(SDS)ï¼é¾è¡¨ï¼å­å¸ï¼è·³è·é¾è¡¨ï¼æ´æ°éåååç¼©åè¡¨ãå¨è¿ä¸ªåºç¡ä¸å»å®ç°ç¨æ·è½æä½çå¯¹è±¡ï¼å­ç¬¦ä¸²ï¼åè¡¨ï¼åå¸ï¼éåï¼æåºéåç­å¯¹è±¡ã\n * åçº¿ç¨é¿åäºå¤çº¿ç¨çé¢ç¹ä¸ä¸æåæ¢å¸¦æ¥çæ§è½é®é¢ï¼ä¹ä¸ç¨èèéçé®é¢ã\n\n\n# Redis ä¸ºä»ä¹ç¨åçº¿ç¨ï¼\n\nå ä¸º Redis æ¯åºäºåå­çæä½ï¼CPU ä¸æ¯ Redis çç¶é¢ï¼Redis çç¶é¢å¯è½æ¯æºå¨åå­çå¤§å°æç½ç»å¸¦å®½ã\n\nå¤§å¤æ°Redisæä½ä¸éè¦å¤ªå¤çCPUè®¡ç®ï¼èæ¯ä¾èµäºåå­çå¿«éè¯»åã\n\nå³ç¶åçº¿ç¨å®¹æå®ç°ï¼CPUåä¸æ¯ç¶é¢ï¼é£å°±ä½¿ç¨åçº¿ç¨ï¼èçå¾å¤éº»ç¦ã\n\n\n# Redis ä¸­çReactoræ¨¡å\n\nIOå¤è·¯å¤ç¨ææ¯çå¥½å¤ï¼å¤ä¸ªsocketè¿æ¥ï¼å¤ç¨ä¸ä¸ªçº¿ç¨ã\n\nIOå¤è·¯å¤ç¨ææ¯ï¼åå©æä½ç³»ç»çæ¯æï¼æå¡ç«¯ä¸ä¸ªçº¿ç¨å¯ä»¥åæ¶çå¬å¤ä¸ªç½ç»è¿æ¥ï¼ä¸æ¦æä¸ªè¿æ¥ä¸æäºä»¶éè¦å¤çï¼å°±è½éç¥çº¿ç¨æ§è¡ç¸åºçè¯»åæä½ã\n\nLinuxææä¾çpoll, select, epollé½å±äºIOå¤è·¯å¤ç¨ææ¯ï¼ç±äºselectåpollå¨å®ç°ä¸çç¼ºé·ï¼å¦åæ ¸åç¨æ·ç©ºé´åå­æ·è´é®é¢ï¼ï¼ç°å¨æå¡ç«¯åæå¤§å¤ä½¿ç¨epollã\n\nReactor æ¨¡åæ¯ä¸ä¸ªæ¯è¾å¹¿æ³çæ¦å¿µãå¯ä»¥æ³æIOå¤è·¯å¤ç¨ææ¯ãReactoræ¨¡å¼ä¹å«Dispatcheræ¨¡å¼ï¼å³I/Oå¤è·¯å¤ç¨ç»ä¸çå¬äºä»¶ï¼æ¶å°äºä»¶ååéï¼Dispatchï¼ç»æä¸ªè¿ç¨ã\n\n> Reactor: The reactor design pattern is an event handling pattern for handling service delivered concurrently to a service handler by one or more inputs. The service handler then demultiplexes the incoming requests and dispatches them synchronously to the associated request handlers.\n\nåI/Oçº¿ç¨æ¨¡åå¾ï¼\n\n\n\n\n\nå¤I/Oçº¿ç¨æ¨¡åå¾ï¼\n\n\n\n * https://www.51cto.com/article/697808.html\n * https://juejin.cn/post/7124667316637270046#heading-1\n\n\n# åºç¨åºæ¯\n\n 1. ç¼å­ç­ç¹æ°æ®ï¼ç¼è§£æ°æ®åºçååã\n 2. å©ç¨Redisä¸­åå­æ§çèªå¢æä½ï¼å¯ä»¥ç¨ä½¿ç¨å®ç°è®¡ç®å¨çåè½ï¼æ¯å¦ç»è®¡ç¨æ·ç¹èµæ°ãç¨æ·è®¿é®æ°ç­ï¼è¿ç±»æä½å¦æç¨MySQLï¼é¢ç¹çè¯»åä¼å¸¦æ¥ç¸å½å¤§çååã\n 3. ç®åæ¶æ¯éåï¼ä¸è¦æ±é«å¯é çæåµä¸ï¼å¯ä»¥ä½¿ç¨Redisèªèº«çåå¸/è®¢éæ¨¡å¼æèListæ¥å®ç°ä¸ä¸ªéåï¼å®ç°å¼æ­¥æä½ã\n 4. å¥½åå³ç³»ï¼å©ç¨éåçä¸äºå½ä»¤ï¼æ¯å¦æ±äº¤éãå¹¶éãå·®éç­ãå¯ä»¥æ¹ä¾¿æå®ä¸äºå±åå¥½åãå±åç±å¥½ä¹ç±»çåè½ã\n 5. éæµï¼æ¯è¾å¸åçä½¿ç¨åºæ¯æ¯éå¶æä¸ªç¨æ·è®¿é®æä¸ªAPIçé¢çï¼å¸¸ç¨çææ¢è´­æ¶ï¼é²æ­¢ç¨æ·ç¯çç¹å»å¸¦æ¥ä¸å¿è¦çååã\n\n\n# MemcachedåRedisçåºå«\n\n * Redisåªä½¿ç¨åæ ¸ï¼èMemcachedå¯ä»¥ä½¿ç¨å¤æ ¸ã\n * MemCachedæ°æ®ç»æåä¸ï¼ä»ç¨æ¥ç¼å­æ°æ®ï¼èRedisæ¯ææ´å ä¸°å¯çæ°æ®ç±»åï¼ä¹å¯ä»¥å¨æå¡å¨ç«¯ç´æ¥å¯¹æ°æ®è¿è¡ä¸°å¯çæä½ï¼è¿æ ·å¯ä»¥åå°ç½ç»IOæ¬¡æ°åæ°æ®ä½ç§¯ã\n * MemCachedä¸æ¯ææ°æ®æä¹åï¼æ­çµæéå¯åæ°æ®æ¶å¤±ãRedisæ¯ææ°æ®æä¹ååæ°æ®æ¢å¤ï¼åè®¸åç¹æéã\n\n\n# ä¸ºä»ä¹è¦ç¨ Redis èä¸ç¨ map/guava åç¼å­?\n\nä½¿ç¨èªå¸¦ç map æè guava å®ç°çæ¯æ¬å°ç¼å­ï¼æä¸»è¦çç¹ç¹æ¯è½»éä»¥åå¿«éï¼çå½å¨æéç jvm çéæ¯èç»æï¼å¹¶ä¸å¨å¤å®ä¾çæåµä¸ï¼æ¯ä¸ªå®ä¾é½éè¦åèªä¿å­ä¸ä»½ç¼å­ï¼ç¼å­ä¸å·æä¸è´æ§ã\n\nä½¿ç¨ redis æ memcached ä¹ç±»çç§°ä¸ºåå¸å¼ç¼å­ï¼å¨å¤å®ä¾çæåµä¸ï¼åå®ä¾å±ç¨ä¸ä»½ç¼å­æ°æ®ï¼ç¼å­å·æä¸è´æ§ãç¼ºç¹æ¯éè¦ä¿æredisæmemcachedæå¡çé«å¯ç¨ï¼æ´ä¸ªç¨åºæ¶æä¸è¾ä¸ºå¤æã\n\næ¯å¦ï¼\n\n1ãRedis å¯ä»¥ç¨å å G åå­æ¥åç¼å­ï¼Map ä¸è¡ï¼ä¸è¬ JVM ä¹å°±åå ä¸ª G æ°æ®å°±å¤å¤§äºï¼\n\n2ãRedis çç¼å­å¯ä»¥æä¹åï¼Map æ¯åå­å¯¹è±¡ï¼ç¨åºä¸éå¯æ°æ®å°±æ²¡äºï¼\n\n3ãRedis å¯ä»¥å®ç°åå¸å¼çç¼å­ï¼Map åªè½å­å¨åå»ºå®çç¨åºéï¼\n\n4ãRedis å¯ä»¥å¤çæ¯ç§ç¾ä¸çº§çå¹¶åï¼æ¯ä¸ä¸çç¼å­æå¡ï¼Map åªæ¯ä¸ä¸ªæ®éçå¯¹è±¡ï¼\n\n5ãRedis ç¼å­æè¿ææºå¶ï¼Map æ¬èº«æ æ­¤åè½ï¼Redis æä¸°å¯ç APIï¼Map å°±ç®åå¤ªå¤äºï¼\n\n6ãRediså¯åç¬é¨ç½²ï¼å¤ä¸ªé¡¹ç®ä¹é´å¯ä»¥å±äº«ï¼æ¬å°åå­æ æ³å±äº«ï¼\n\n7ãRedisæä¸é¨çç®¡çå·¥å·å¯ä»¥æ¥çç¼å­æ°æ®ã",normalizedContent:"# redisåèèµææ±æ»\n\n * http://www.topjavaer.cn/redis/redis-basic/\n * https://www.iamshuaidi.com/redis-interview\n * https://xie.infoq.cn/article/6c3500c66c3cdee3d72b88780\n * https://zhuanlan.zhihu.com/p/553803052\n * https://segmentfault.com/blog/magebyte\n\n\n# redisä¼ç¼ºç¹ï¼\n\nä¼ç¹ï¼\n\n 1. åºäºåå­æä½ï¼åå­è¯»åéåº¦å¿«ã\n 2. æ¯æå¤ç§æ°æ®ç±»åï¼åæ¬stringãhashãlistãsetãzsetç­ã\n 3. æ¯ææä¹åãredisæ¯ærdbåaofä¸¤ç§æä¹åæºå¶ï¼æä¹ååè½å¯ä»¥ææå°é¿åæ°æ®ä¸¢å¤±é®é¢ã\n 4. æ¯æäºå¡ãredisçæææä½é½æ¯åå­æ§çï¼åæ¶redisè¿æ¯æå¯¹å ä¸ªæä½åå¹¶åçåå­æ§æ§è¡ã\n 5. æ¯æä¸»ä»å¤å¶ãä¸»èç¹ä¼èªå¨å°æ°æ®åæ­¥å°ä»èç¹ï¼å¯ä»¥è¿è¡è¯»ååç¦»ã\n 6. rediså½ä»¤çå¤çæ¯åçº¿ç¨çï¼é¿åçº¿ç¨åæ¢å¼éåå¤çº¿ç¨çç«äºé®é¢ãredis6.0å¼å¥äºå¤çº¿ç¨ï¼éè¦æ³¨æçæ¯ï¼å¤çº¿ç¨ç¨äºå¤çç½ç»æ°æ®çè¯»åååè®®è§£æï¼rediså½ä»¤æ§è¡è¿æ¯åçº¿ç¨çã\n\nç¼ºç¹ï¼\n\n 1. å¯¹ç»æåæ¥è¯¢çæ¯ææ¯è¾å·®ã\n 2. æ°æ®åºå®¹éåå°ç©çåå­çéå¶ï¼ä¸éåç¨ä½æµ·éæ°æ®çé«æ§è½è¯»åï¼å æ­¤rediséåçåºæ¯ä¸»è¦å±éå¨è¾å°æ°æ®éçæä½ã\n 3. redis è¾é¾æ¯æå¨çº¿æ©å®¹ï¼å¨éç¾¤å®¹éè¾¾å°ä¸éæ¶å¨çº¿æ©å®¹ä¼åå¾å¾å¤æã\n\n\n# redisä¸ºä»ä¹è¿ä¹å¿«ï¼\n\n * åºäºåå­ï¼redisæ¯ä½¿ç¨åå­å­å¨ï¼æ²¡æç£çioä¸çå¼éãæ°æ®å­å¨åå­ä¸­ï¼è¯»åéåº¦å¿«ã\n * ioå¤è·¯å¤ç¨æ¨¡åï¼redis éç¨ io å¤è·¯å¤ç¨ææ¯ãredis ä½¿ç¨åçº¿ç¨æ¥è½®è¯¢æè¿°ç¬¦ï¼å°æ°æ®åºçæä½é½è½¬æ¢æäºäºä»¶ï¼ä¸å¨ç½ç»i/oä¸æµªè´¹è¿å¤çæ¶é´ãéé»å¡ ioã\n * é«æçæ°æ®ç»æï¼redis æ¯ç§æ°æ®ç±»ååºå±é½åäºä¼åï¼ç®çå°±æ¯ä¸ºäºè¿½æ±æ´å¿«çéåº¦ãå¨æå­ç¬¦ä¸²(sds)ï¼é¾è¡¨ï¼å­å¸ï¼è·³è·é¾è¡¨ï¼æ´æ°éåååç¼©åè¡¨ãå¨è¿ä¸ªåºç¡ä¸å»å®ç°ç¨æ·è½æä½çå¯¹è±¡ï¼å­ç¬¦ä¸²ï¼åè¡¨ï¼åå¸ï¼éåï¼æåºéåç­å¯¹è±¡ã\n * åçº¿ç¨é¿åäºå¤çº¿ç¨çé¢ç¹ä¸ä¸æåæ¢å¸¦æ¥çæ§è½é®é¢ï¼ä¹ä¸ç¨èèéçé®é¢ã\n\n\n# redis ä¸ºä»ä¹ç¨åçº¿ç¨ï¼\n\nå ä¸º redis æ¯åºäºåå­çæä½ï¼cpu ä¸æ¯ redis çç¶é¢ï¼redis çç¶é¢å¯è½æ¯æºå¨åå­çå¤§å°æç½ç»å¸¦å®½ã\n\nå¤§å¤æ°redisæä½ä¸éè¦å¤ªå¤çcpuè®¡ç®ï¼èæ¯ä¾èµäºåå­çå¿«éè¯»åã\n\nå³ç¶åçº¿ç¨å®¹æå®ç°ï¼cpuåä¸æ¯ç¶é¢ï¼é£å°±ä½¿ç¨åçº¿ç¨ï¼èçå¾å¤éº»ç¦ã\n\n\n# redis ä¸­çreactoræ¨¡å\n\nioå¤è·¯å¤ç¨ææ¯çå¥½å¤ï¼å¤ä¸ªsocketè¿æ¥ï¼å¤ç¨ä¸ä¸ªçº¿ç¨ã\n\nioå¤è·¯å¤ç¨ææ¯ï¼åå©æä½ç³»ç»çæ¯æï¼æå¡ç«¯ä¸ä¸ªçº¿ç¨å¯ä»¥åæ¶çå¬å¤ä¸ªç½ç»è¿æ¥ï¼ä¸æ¦æä¸ªè¿æ¥ä¸æäºä»¶éè¦å¤çï¼å°±è½éç¥çº¿ç¨æ§è¡ç¸åºçè¯»åæä½ã\n\nlinuxææä¾çpoll, select, epollé½å±äºioå¤è·¯å¤ç¨ææ¯ï¼ç±äºselectåpollå¨å®ç°ä¸çç¼ºé·ï¼å¦åæ ¸åç¨æ·ç©ºé´åå­æ·è´é®é¢ï¼ï¼ç°å¨æå¡ç«¯åæå¤§å¤ä½¿ç¨epollã\n\nreactor æ¨¡åæ¯ä¸ä¸ªæ¯è¾å¹¿æ³çæ¦å¿µãå¯ä»¥æ³æioå¤è·¯å¤ç¨ææ¯ãreactoræ¨¡å¼ä¹å«dispatcheræ¨¡å¼ï¼å³i/oå¤è·¯å¤ç¨ç»ä¸çå¬äºä»¶ï¼æ¶å°äºä»¶ååéï¼dispatchï¼ç»æä¸ªè¿ç¨ã\n\n> reactor: the reactor design pattern is an event handling pattern for handling service delivered concurrently to a service handler by one or more inputs. the service handler then demultiplexes the incoming requests and dispatches them synchronously to the associated request handlers.\n\nåi/oçº¿ç¨æ¨¡åå¾ï¼\n\n\n\n\n\nå¤i/oçº¿ç¨æ¨¡åå¾ï¼\n\n\n\n * https://www.51cto.com/article/697808.html\n * https://juejin.cn/post/7124667316637270046#heading-1\n\n\n# åºç¨åºæ¯\n\n 1. ç¼å­ç­ç¹æ°æ®ï¼ç¼è§£æ°æ®åºçååã\n 2. å©ç¨redisä¸­åå­æ§çèªå¢æä½ï¼å¯ä»¥ç¨ä½¿ç¨å®ç°è®¡ç®å¨çåè½ï¼æ¯å¦ç»è®¡ç¨æ·ç¹èµæ°ãç¨æ·è®¿é®æ°ç­ï¼è¿ç±»æä½å¦æç¨mysqlï¼é¢ç¹çè¯»åä¼å¸¦æ¥ç¸å½å¤§çååã\n 3. ç®åæ¶æ¯éåï¼ä¸è¦æ±é«å¯é çæåµä¸ï¼å¯ä»¥ä½¿ç¨redisèªèº«çåå¸/è®¢éæ¨¡å¼æèlistæ¥å®ç°ä¸ä¸ªéåï¼å®ç°å¼æ­¥æä½ã\n 4. å¥½åå³ç³»ï¼å©ç¨éåçä¸äºå½ä»¤ï¼æ¯å¦æ±äº¤éãå¹¶éãå·®éç­ãå¯ä»¥æ¹ä¾¿æå®ä¸äºå±åå¥½åãå±åç±å¥½ä¹ç±»çåè½ã\n 5. éæµï¼æ¯è¾å¸åçä½¿ç¨åºæ¯æ¯éå¶æä¸ªç¨æ·è®¿é®æä¸ªapiçé¢çï¼å¸¸ç¨çææ¢è´­æ¶ï¼é²æ­¢ç¨æ·ç¯çç¹å»å¸¦æ¥ä¸å¿è¦çååã\n\n\n# memcachedåredisçåºå«\n\n * redisåªä½¿ç¨åæ ¸ï¼èmemcachedå¯ä»¥ä½¿ç¨å¤æ ¸ã\n * memcachedæ°æ®ç»æåä¸ï¼ä»ç¨æ¥ç¼å­æ°æ®ï¼èredisæ¯ææ´å ä¸°å¯çæ°æ®ç±»åï¼ä¹å¯ä»¥å¨æå¡å¨ç«¯ç´æ¥å¯¹æ°æ®è¿è¡ä¸°å¯çæä½ï¼è¿æ ·å¯ä»¥åå°ç½ç»ioæ¬¡æ°åæ°æ®ä½ç§¯ã\n * memcachedä¸æ¯ææ°æ®æä¹åï¼æ­çµæéå¯åæ°æ®æ¶å¤±ãredisæ¯ææ°æ®æä¹ååæ°æ®æ¢å¤ï¼åè®¸åç¹æéã\n\n\n# ä¸ºä»ä¹è¦ç¨ redis èä¸ç¨ map/guava åç¼å­?\n\nä½¿ç¨èªå¸¦ç map æè guava å®ç°çæ¯æ¬å°ç¼å­ï¼æä¸»è¦çç¹ç¹æ¯è½»éä»¥åå¿«éï¼çå½å¨æéç jvm çéæ¯èç»æï¼å¹¶ä¸å¨å¤å®ä¾çæåµä¸ï¼æ¯ä¸ªå®ä¾é½éè¦åèªä¿å­ä¸ä»½ç¼å­ï¼ç¼å­ä¸å·æä¸è´æ§ã\n\nä½¿ç¨ redis æ memcached ä¹ç±»çç§°ä¸ºåå¸å¼ç¼å­ï¼å¨å¤å®ä¾çæåµä¸ï¼åå®ä¾å±ç¨ä¸ä»½ç¼å­æ°æ®ï¼ç¼å­å·æä¸è´æ§ãç¼ºç¹æ¯éè¦ä¿æredisæmemcachedæå¡çé«å¯ç¨ï¼æ´ä¸ªç¨åºæ¶æä¸è¾ä¸ºå¤æã\n\næ¯å¦ï¼\n\n1ãredis å¯ä»¥ç¨å å g åå­æ¥åç¼å­ï¼map ä¸è¡ï¼ä¸è¬ jvm ä¹å°±åå ä¸ª g æ°æ®å°±å¤å¤§äºï¼\n\n2ãredis çç¼å­å¯ä»¥æä¹åï¼map æ¯åå­å¯¹è±¡ï¼ç¨åºä¸éå¯æ°æ®å°±æ²¡äºï¼\n\n3ãredis å¯ä»¥å®ç°åå¸å¼çç¼å­ï¼map åªè½å­å¨åå»ºå®çç¨åºéï¼\n\n4ãredis å¯ä»¥å¤çæ¯ç§ç¾ä¸çº§çå¹¶åï¼æ¯ä¸ä¸çç¼å­æå¡ï¼map åªæ¯ä¸ä¸ªæ®éçå¯¹è±¡ï¼\n\n5ãredis ç¼å­æè¿ææºå¶ï¼map æ¬èº«æ æ­¤åè½ï¼redis æä¸°å¯ç apiï¼map å°±ç®åå¤ªå¤äºï¼\n\n6ãrediså¯åç¬é¨ç½²ï¼å¤ä¸ªé¡¹ç®ä¹é´å¯ä»¥å±äº«ï¼æ¬å°åå­æ æ³å±äº«ï¼\n\n7ãredisæä¸é¨çç®¡çå·¥å·å¯ä»¥æ¥çç¼å­æ°æ®ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Redisæ°æ®ç±»å",frontmatter:{title:"Redisæ°æ®ç±»å",date:"2023-03-17T16:49:06.000Z",permalink:"/pages/99d0e1/"},regularPath:"/03.Redis/02.redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html",relativePath:"03.Redis/02.redisæ°æ®ç±»å.md",key:"v-51da0e54",path:"/pages/99d0e1/",headers:[{level:2,title:"setéåè¿ç®",slug:"setéåè¿ç®",normalizedTitle:"setéåè¿ç®",charIndex:148},{level:2,title:"zset",slug:"zset",normalizedTitle:"zset",charIndex:77},{level:2,title:"bitmaps",slug:"bitmaps",normalizedTitle:"bitmaps",charIndex:97},{level:3,title:"å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿ï¼",slug:"å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿",normalizedTitle:"å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿ï¼",charIndex:1107},{level:3,title:"å®ç°ç¨æ·æ¯æçç»å½æåµï¼",slug:"å®ç°ç¨æ·æ¯æçç»å½æåµ",normalizedTitle:"å®ç°ç¨æ·æ¯æçç»å½æåµï¼",charIndex:1381},{level:3,title:"å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡",slug:"å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡",normalizedTitle:"å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡",charIndex:1757},{level:2,title:"HyperLogLog",slug:"hyperloglog",normalizedTitle:"hyperloglog",charIndex:2260},{level:3,title:"ç»è®¡é¡µé¢çUVï¼",slug:"ç»è®¡é¡µé¢çuv",normalizedTitle:"ç»è®¡é¡µé¢çuvï¼",charIndex:2731},{level:2,title:"åæ°æ®ç±»åä½¿ç¨åºæ¯",slug:"åæ°æ®ç±»åä½¿ç¨åºæ¯",normalizedTitle:"åæ°æ®ç±»åä½¿ç¨åºæ¯",charIndex:3021}],headersStr:"setéåè¿ç® zset bitmaps å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿ï¼ å®ç°ç¨æ·æ¯æçç»å½æåµï¼ å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡ HyperLogLog ç»è®¡é¡µé¢çUVï¼ åæ°æ®ç±»åä½¿ç¨åºæ¯",content:"Redisæ¯æï¼\n\n * stringï¼å¼å¯ä»¥æ¯å­ç¬¦ä¸²ãæ°å­æèäºè¿å¶ï¼ä½å¼æå¤§ä¸è½è¶è¿512MBã\n * hash\n * list\n * set\n * zset(sorted set)\n * bitmaps\n * hyperloglog\n * stream\n * geospatial\n\n\n# setéåè¿ç®\n\nSDIFF setA setB  //å·®éè¿ç®\nSINTER setA setB //äº¤éè¿ç®\nSUNION setA setB //å¹¶éè¿ç®\n\n\nä¸ä¸ªå½ä»¤é½å¯ä»¥ä¼ è¿å¤ä¸ªé® SDIFF setA setB setC\n\n\n# zset\n\nzadd zsetkey 50 e1 60 e2 30 e3\n\n\nZsetæ¯ä¸ªåç´ é½ä¼å³èä¸ä¸ªdoubleï¼è¶è¿17ä½ä½¿ç¨ç§å­¦è®¡ç®æ³è¡¨ç¤ºï¼å¯è½ä¸¢å¤±ç²¾åº¦ï¼ç±»åçåæ°ï¼éè¿åæ°æ¥ä¸ºéåä¸­çæåè¿è¡æåºãzsetçæåæ¯å¯ä¸ç,ä½åæ°(score)å¯ä»¥éå¤ã\n\næåºéåååè¡¨ç¸åç¹ï¼\n\n 1. é½æ¯æåºçï¼\n 2. é½å¯ä»¥è·å¾æä¸ªèå´åçåç´ ãlrangeåzrange\n\næåºéåååè¡¨ä¸åç¹ï¼\n\n 1. åè¡¨åºäºé¾è¡¨å®ç°ï¼è·åä¸¤ç«¯åç´ éåº¦å¿«ï¼è®¿é®ä¸­é´åç´ éåº¦æ¢ï¼\n 2. æåºéååºäºæ£åè¡¨åè·³è·è¡¨å®ç°ï¼è®¿é®ä¸­é´åç´ æ¶é´å¤æåº¦æ¯OlogNï¼\n 3. åè¡¨ä¸è½ç®åçè°æ´æä¸ªåç´ çä½ç½®ï¼æåºåè¡¨å¯ä»¥ï¼æ´æ¹åç´ çåæ°ï¼ï¼\n 4. æåºéåæ´èåå­ã\n\n\n# bitmaps\n\nBitmapsæ¬èº«ä¸æ¯ä¸ç§æ°æ®ç»æï¼å®éä¸å®å°±æ¯å­ç¬¦ä¸²ï¼ä½æ¯å®å¯ä»¥å¯¹å­ç¬¦ä¸²çä½è¿è¡æä½ï¼å¯ä»¥æBitmapsæ³è±¡æä¸ä¸ªä»¥ä½ä¸ºåä½çæ°ç»ï¼æ°ç»çæ¯ä¸ªåååªè½å­å¨0å1ã\n\nbitmapçé¿åº¦ä¸éåä¸­åç´ ä¸ªæ°æ å³ï¼èæ¯ä¸åºæ°çä¸éæå³ãåå¦è¦è®¡ç®ä¸éä¸º1äº¿çåºæ°ï¼åéè¦12.5Må­èçbitmapãå°±ç®éåä¸­åªæ10ä¸ªåç´ ä¹éè¦12.5Mã\n\noffsetä»0å¼å§ã\n\nSETBIT <key> <offset> <value>\nGETBIT <key> <offset>\nBITCOUNT <key>\nBITPOS key bitValue [start] [end] //è¿åæ°æ®è¡¨ç¤º Bitmap ä¸­ç¬¬ä¸ä¸ªå¼ä¸º bitValue ç offset ä½ç½®ã\nBITOP operation destkey key [key ...] //ç¨äºå¯¹ä¸ä¸ªæèå¤ä¸ª é® = key ç Bitmap è¿è¡ä½åæä½ãopration å¯ä»¥æ¯ andãORãNOTãXORãå¤çä¸åé¿åº¦çå­ç¬¦ä¸²æ¶ï¼è¾ç­çé£ä¸ªå­ç¬¦ä¸²æç¼ºå°çé¨åä¼è¢«çä½ 0 ãç©ºç key ä¹è¢«çä½æ¯åå« 0 çå­ç¬¦ä¸²åºåã\n\n\n\n# å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿ï¼\n\nkey = login_status è¡¨ç¤ºå­å¨ç¨æ·ç»éç¶æéåæ°æ®ï¼ å°ç¨æ· ID ä½ä¸º offsetï¼å¨çº¿å°±è®¾ç½®ä¸º 1ï¼ä¸çº¿è®¾ç½® 0ãéè¿ GETBITå¤æ­å¯¹åºçç¨æ·æ¯å¦å¨çº¿ã 50000 ä¸ ç¨æ·åªéè¦ 6 MB çç©ºé´ã\n\nåå¦æä»¬è¦å¤æ­ ID = 10086 çç¨æ·çç»éæåµï¼\n\n1.è¡¨ç¤ºç¨æ·ç»å½\nSETBIT login_status 10086 1\n2.æ£æ¥ç¨æ·æ¯å¦ç»å½\nGETBIT login_status 10086\n3.ç¨æ·ç»åº\nSETBIT login_status 10086 0\n\n\n\n# å®ç°ç¨æ·æ¯æçç»å½æåµï¼\n\nkey å¯ä»¥è®¾è®¡æ uid:sign:{userId}:{yyyyMM}ï¼æä»½çæ¯ä¸å¤©çå¼ - 1 å¯ä»¥ä½ä¸º offsetï¼å ä¸º offset ä» 0 å¼å§ï¼æä»¥ offset = æ¥æ - 1ï¼ã\n\n1.è¡¨ç¤ºè®°å½ç¨æ·å¨ 2021 å¹´ 5 æ 16 å·æå¡ã\nSETBIT uid:sign:89757:202105 15 1\n2.å¤æ­ç¼å· 89757 ç¨æ·å¨ 2021 å¹´ 5 æ 16 å·æ¯å¦æå¡ã\nGETBIT uid:sign:89757:202105 15\n3.ç»è®¡è¯¥ç¨æ·å¨ 5 æä»½çæå¡æ¬¡æ°ã\nBITCOUNT uid:sign:89757:202105\n4.è·å userID = 89757 å¨ 2021 å¹´ 5 æä»½é¦æ¬¡æå¡æ¥æã\nBITPOS uid:sign:89757:202105 1\n\n\n\n# å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡\n\nå¨è®°å½äºä¸ä¸ªäº¿çç¨æ·è¿ç»­ 7 å¤©çæå¡æ°æ®ï¼å¦ä½ç»è®¡åºè¿è¿ç»­ 7 å¤©è¿ç»­æå¡ç¨æ·æ»æ°å¢ï¼\n\næä»¬ææ¯å¤©çæ¥æä½ä¸º Bitmap ç keyï¼userId ä½ä¸º offsetï¼è¥æ¯æå¡åå° offset ä½ç½®ç bit è®¾ç½®æ 1ã\n\nkey å¯¹åºçéåçæ¯ä¸ª bit ä½çæ°æ®åæ¯ä¸ä¸ªç¨æ·å¨è¯¥æ¥æçæå¡è®°å½ã\n\nä¸å±æ 7 ä¸ªè¿æ ·ç Bitmapï¼å¦ææä»¬è½å¯¹è¿ 7 ä¸ª Bitmap çå¯¹åºç bit ä½å ãä¸ãè¿ç®ã\n\n// ä¸æä½\nBITOP AND destmap bitmap:01 bitmap:02 bitmap:03\n// ç»è®¡ bit ä½ =  1 çä¸ªæ°\nBITCOUNT destmap\n\n\nç®åè®¡ç®ä¸ ä¸ä¸ªä¸äº¿ä¸ªä½ç Bitmapå ç¨çåå­å¼éï¼å¤§çº¦å  12 MB çåå­ï¼10^8/8/1024/1024ï¼ï¼7 å¤©ç Bitmap çåå­å¼éçº¦ä¸º 84 MBãåæ¶æä»¬æå¥½ç» Bitmap è®¾ç½®è¿ææ¶é´ï¼è®© Redis å é¤è¿æçæå¡æ°æ®ï¼èçåå­ã\n\nhttps://segmentfault.com/a/1190000040177140\n\n\n# HyperLogLog\n\nHyperLogLog æ¯ç¨æ¥ååºæ°ç»è®¡çç®æ³ï¼å¶ä¼ç¹æ¯ï¼å®æéçåå­å¹¶ä¸ä¼å ä¸ºéåçå¤§å°èæ¹åï¼æ è®ºéååå«çåç´ æå¤å°ä¸ªï¼HyperLogLogè¿è¡è®¡ç®æéçåå­æ»æ¯åºå®çï¼å¹¶ä¸æ¯éå¸¸å°çã\n\nç®çæ¯ååºæ°ç»è®¡ï¼æä¸æ¯éåï¼ä¸ä¼ä¿å­åæ°æ®ï¼åªè®°å½æ°éèä¸æ¯æ°å¼ã\n\næ¯ä¸ª HyperLogLog æå¤åªéè¦è±è´¹ 12KB åå­ï¼å¨æ åè¯¯å·® 0.81%çåæä¸ï¼å°±å¯ä»¥è®¡ç® 2 ç 64 æ¬¡æ¹ä¸ªåç´ çåºæ°ã\n\nåºæ°ï¼æ¯å¦æ°æ®é {1, 3, 5, 7, 5, 7, 8}ï¼ é£ä¹è¿ä¸ªæ°æ®éçåºæ°éä¸º {1, 3, 5 ,7, 8}ï¼åºæ°å³ä¸éå¤åç´ ä¸º5ã\n\nåºæ°ç»è®¡ï¼ç»è®¡ä¸ä¸ªéåä¸­ä¸éå¤åç´ çä¸ªæ°ã\n\næ ¸å¿æ¯åºæ°ä¼°ç®ç®æ³ï¼ä¸»è¦è¡¨ç°ä¸ºè®¡ç®æ¶åå­çä½¿ç¨åæ°æ®åå¹¶çå¤çãæç»æ°å¼å­å¨ä¸å®è¯¯å·®ã\n\nåºç¨åºæ¯\n\n * ç»è®¡ä¸ä¸ª APP çæ¥æ´»ãææ´»æ°ï¼\n * ç»è®¡ä¸ä¸ªé¡µé¢çæ¯å¤©è¢«å¤å°ä¸ªä¸åè´¦æ·è®¿é®éï¼Unique Visitorï¼UVï¼ï¼ï¼\n * ç»è®¡ç¨æ·æ¯å¤©æç´¢ä¸åè¯æ¡çä¸ªæ°ï¼\n * ç»è®¡æ³¨å IP æ°ã\n\n\n# ç»è®¡é¡µé¢çUVï¼\n\n1.å°è®¿é®é¡µé¢çæ¯ä¸ªç¨æ· ID æ·»å å° HyperLogLog ä¸­ã\nPFADD key:uv userID1 userID2 useID3\n2.å©ç¨ PFCOUNT è·åkeyçUVå¼ã\nPFCOUNT key:uv\n\n\nåå¹¶\nPFADD Redisæ°æ® user1 user2 user3\nPFADD MySQLæ°æ® user1 user2 user4\nPFMERGE æ°æ®åº Redisæ°æ® MySQLæ°æ®\nPFCOUNT æ°æ®åº // è¿åå¼ = 4\n\n\nhttps://segmentfault.com/a/1190000041696066\n\n\n# åæ°æ®ç±»åä½¿ç¨åºæ¯\n\nstringï¼1ãå¸¸è§key-valueç¼å­åºç¨ãå¸¸è§è®¡æ°å¦å¾®åæ°ãç²ä¸æ°ã2ãåå¸å¼éã\n\nhashï¼å­æ¾ç»æåæ°æ®ï¼å¦ç¨æ·ä¿¡æ¯ï¼æµç§°ãå¹´é¾ãæ§å«ãç§¯åç­ï¼ã\n\nlistï¼ç­é¨åå®¢åè¡¨ãæ¶æ¯éåç³»ç»ãä½¿ç¨listå¯ä»¥æå»ºéåç³»ç»ï¼æ¯å¦ï¼å°Redisç¨ä½æ¥å¿æ¶éå¨ï¼å¤ä¸ªç«¯ç¹å°æ¥å¿ä¿¡æ¯åå¥Redisï¼ç¶åä¸ä¸ªworkerç»ä¸å°æææ¥å¿åå°ç£çã\n\nsetï¼1ãå¥½åå³ç³»ï¼å¾®åç²ä¸çå±åå³æ³¨ãå±ååå¥½ãå±åå¥½åç­ï¼2ãå©ç¨å¯ä¸æ§ï¼ç»è®¡è®¿é®ç½ç«çææç¬ç«ip ã\n\nzsetï¼1ãæè¡æ¦ï¼2ãä¼åçº§éåã",normalizedContent:"redisæ¯æï¼\n\n * stringï¼å¼å¯ä»¥æ¯å­ç¬¦ä¸²ãæ°å­æèäºè¿å¶ï¼ä½å¼æå¤§ä¸è½è¶è¿512mbã\n * hash\n * list\n * set\n * zset(sorted set)\n * bitmaps\n * hyperloglog\n * stream\n * geospatial\n\n\n# setéåè¿ç®\n\nsdiff seta setb  //å·®éè¿ç®\nsinter seta setb //äº¤éè¿ç®\nsunion seta setb //å¹¶éè¿ç®\n\n\nä¸ä¸ªå½ä»¤é½å¯ä»¥ä¼ è¿å¤ä¸ªé® sdiff seta setb setc\n\n\n# zset\n\nzadd zsetkey 50 e1 60 e2 30 e3\n\n\nzsetæ¯ä¸ªåç´ é½ä¼å³èä¸ä¸ªdoubleï¼è¶è¿17ä½ä½¿ç¨ç§å­¦è®¡ç®æ³è¡¨ç¤ºï¼å¯è½ä¸¢å¤±ç²¾åº¦ï¼ç±»åçåæ°ï¼éè¿åæ°æ¥ä¸ºéåä¸­çæåè¿è¡æåºãzsetçæåæ¯å¯ä¸ç,ä½åæ°(score)å¯ä»¥éå¤ã\n\næåºéåååè¡¨ç¸åç¹ï¼\n\n 1. é½æ¯æåºçï¼\n 2. é½å¯ä»¥è·å¾æä¸ªèå´åçåç´ ãlrangeåzrange\n\næåºéåååè¡¨ä¸åç¹ï¼\n\n 1. åè¡¨åºäºé¾è¡¨å®ç°ï¼è·åä¸¤ç«¯åç´ éåº¦å¿«ï¼è®¿é®ä¸­é´åç´ éåº¦æ¢ï¼\n 2. æåºéååºäºæ£åè¡¨åè·³è·è¡¨å®ç°ï¼è®¿é®ä¸­é´åç´ æ¶é´å¤æåº¦æ¯olognï¼\n 3. åè¡¨ä¸è½ç®åçè°æ´æä¸ªåç´ çä½ç½®ï¼æåºåè¡¨å¯ä»¥ï¼æ´æ¹åç´ çåæ°ï¼ï¼\n 4. æåºéåæ´èåå­ã\n\n\n# bitmaps\n\nbitmapsæ¬èº«ä¸æ¯ä¸ç§æ°æ®ç»æï¼å®éä¸å®å°±æ¯å­ç¬¦ä¸²ï¼ä½æ¯å®å¯ä»¥å¯¹å­ç¬¦ä¸²çä½è¿è¡æä½ï¼å¯ä»¥æbitmapsæ³è±¡æä¸ä¸ªä»¥ä½ä¸ºåä½çæ°ç»ï¼æ°ç»çæ¯ä¸ªåååªè½å­å¨0å1ã\n\nbitmapçé¿åº¦ä¸éåä¸­åç´ ä¸ªæ°æ å³ï¼èæ¯ä¸åºæ°çä¸éæå³ãåå¦è¦è®¡ç®ä¸éä¸º1äº¿çåºæ°ï¼åéè¦12.5må­èçbitmapãå°±ç®éåä¸­åªæ10ä¸ªåç´ ä¹éè¦12.5mã\n\noffsetä»0å¼å§ã\n\nsetbit <key> <offset> <value>\ngetbit <key> <offset>\nbitcount <key>\nbitpos key bitvalue [start] [end] //è¿åæ°æ®è¡¨ç¤º bitmap ä¸­ç¬¬ä¸ä¸ªå¼ä¸º bitvalue ç offset ä½ç½®ã\nbitop operation destkey key [key ...] //ç¨äºå¯¹ä¸ä¸ªæèå¤ä¸ª é® = key ç bitmap è¿è¡ä½åæä½ãopration å¯ä»¥æ¯ andãorãnotãxorãå¤çä¸åé¿åº¦çå­ç¬¦ä¸²æ¶ï¼è¾ç­çé£ä¸ªå­ç¬¦ä¸²æç¼ºå°çé¨åä¼è¢«çä½ 0 ãç©ºç key ä¹è¢«çä½æ¯åå« 0 çå­ç¬¦ä¸²åºåã\n\n\n\n# å®ç°å¤æ­æµ·éç¨æ·æ¯å¦å¨çº¿ï¼\n\nkey = login_status è¡¨ç¤ºå­å¨ç¨æ·ç»éç¶æéåæ°æ®ï¼ å°ç¨æ· id ä½ä¸º offsetï¼å¨çº¿å°±è®¾ç½®ä¸º 1ï¼ä¸çº¿è®¾ç½® 0ãéè¿ getbitå¤æ­å¯¹åºçç¨æ·æ¯å¦å¨çº¿ã 50000 ä¸ ç¨æ·åªéè¦ 6 mb çç©ºé´ã\n\nåå¦æä»¬è¦å¤æ­ id = 10086 çç¨æ·çç»éæåµï¼\n\n1.è¡¨ç¤ºç¨æ·ç»å½\nsetbit login_status 10086 1\n2.æ£æ¥ç¨æ·æ¯å¦ç»å½\ngetbit login_status 10086\n3.ç¨æ·ç»åº\nsetbit login_status 10086 0\n\n\n\n# å®ç°ç¨æ·æ¯æçç»å½æåµï¼\n\nkey å¯ä»¥è®¾è®¡æ uid:sign:{userid}:{yyyymm}ï¼æä»½çæ¯ä¸å¤©çå¼ - 1 å¯ä»¥ä½ä¸º offsetï¼å ä¸º offset ä» 0 å¼å§ï¼æä»¥ offset = æ¥æ - 1ï¼ã\n\n1.è¡¨ç¤ºè®°å½ç¨æ·å¨ 2021 å¹´ 5 æ 16 å·æå¡ã\nsetbit uid:sign:89757:202105 15 1\n2.å¤æ­ç¼å· 89757 ç¨æ·å¨ 2021 å¹´ 5 æ 16 å·æ¯å¦æå¡ã\ngetbit uid:sign:89757:202105 15\n3.ç»è®¡è¯¥ç¨æ·å¨ 5 æä»½çæå¡æ¬¡æ°ã\nbitcount uid:sign:89757:202105\n4.è·å userid = 89757 å¨ 2021 å¹´ 5 æä»½é¦æ¬¡æå¡æ¥æã\nbitpos uid:sign:89757:202105 1\n\n\n\n# å®ç°è¿ç»­ç­¾å°ç¨æ·æ»æ°ç»è®¡\n\nå¨è®°å½äºä¸ä¸ªäº¿çç¨æ·è¿ç»­ 7 å¤©çæå¡æ°æ®ï¼å¦ä½ç»è®¡åºè¿è¿ç»­ 7 å¤©è¿ç»­æå¡ç¨æ·æ»æ°å¢ï¼\n\næä»¬ææ¯å¤©çæ¥æä½ä¸º bitmap ç keyï¼userid ä½ä¸º offsetï¼è¥æ¯æå¡åå° offset ä½ç½®ç bit è®¾ç½®æ 1ã\n\nkey å¯¹åºçéåçæ¯ä¸ª bit ä½çæ°æ®åæ¯ä¸ä¸ªç¨æ·å¨è¯¥æ¥æçæå¡è®°å½ã\n\nä¸å±æ 7 ä¸ªè¿æ ·ç bitmapï¼å¦ææä»¬è½å¯¹è¿ 7 ä¸ª bitmap çå¯¹åºç bit ä½å ãä¸ãè¿ç®ã\n\n// ä¸æä½\nbitop and destmap bitmap:01 bitmap:02 bitmap:03\n// ç»è®¡ bit ä½ =  1 çä¸ªæ°\nbitcount destmap\n\n\nç®åè®¡ç®ä¸ ä¸ä¸ªä¸äº¿ä¸ªä½ç bitmapå ç¨çåå­å¼éï¼å¤§çº¦å  12 mb çåå­ï¼10^8/8/1024/1024ï¼ï¼7 å¤©ç bitmap çåå­å¼éçº¦ä¸º 84 mbãåæ¶æä»¬æå¥½ç» bitmap è®¾ç½®è¿ææ¶é´ï¼è®© redis å é¤è¿æçæå¡æ°æ®ï¼èçåå­ã\n\nhttps://segmentfault.com/a/1190000040177140\n\n\n# hyperloglog\n\nhyperloglog æ¯ç¨æ¥ååºæ°ç»è®¡çç®æ³ï¼å¶ä¼ç¹æ¯ï¼å®æéçåå­å¹¶ä¸ä¼å ä¸ºéåçå¤§å°èæ¹åï¼æ è®ºéååå«çåç´ æå¤å°ä¸ªï¼hyperloglogè¿è¡è®¡ç®æéçåå­æ»æ¯åºå®çï¼å¹¶ä¸æ¯éå¸¸å°çã\n\nç®çæ¯ååºæ°ç»è®¡ï¼æä¸æ¯éåï¼ä¸ä¼ä¿å­åæ°æ®ï¼åªè®°å½æ°éèä¸æ¯æ°å¼ã\n\næ¯ä¸ª hyperloglog æå¤åªéè¦è±è´¹ 12kb åå­ï¼å¨æ åè¯¯å·® 0.81%çåæä¸ï¼å°±å¯ä»¥è®¡ç® 2 ç 64 æ¬¡æ¹ä¸ªåç´ çåºæ°ã\n\nåºæ°ï¼æ¯å¦æ°æ®é {1, 3, 5, 7, 5, 7, 8}ï¼ é£ä¹è¿ä¸ªæ°æ®éçåºæ°éä¸º {1, 3, 5 ,7, 8}ï¼åºæ°å³ä¸éå¤åç´ ä¸º5ã\n\nåºæ°ç»è®¡ï¼ç»è®¡ä¸ä¸ªéåä¸­ä¸éå¤åç´ çä¸ªæ°ã\n\næ ¸å¿æ¯åºæ°ä¼°ç®ç®æ³ï¼ä¸»è¦è¡¨ç°ä¸ºè®¡ç®æ¶åå­çä½¿ç¨åæ°æ®åå¹¶çå¤çãæç»æ°å¼å­å¨ä¸å®è¯¯å·®ã\n\nåºç¨åºæ¯\n\n * ç»è®¡ä¸ä¸ª app çæ¥æ´»ãææ´»æ°ï¼\n * ç»è®¡ä¸ä¸ªé¡µé¢çæ¯å¤©è¢«å¤å°ä¸ªä¸åè´¦æ·è®¿é®éï¼unique visitorï¼uvï¼ï¼ï¼\n * ç»è®¡ç¨æ·æ¯å¤©æç´¢ä¸åè¯æ¡çä¸ªæ°ï¼\n * ç»è®¡æ³¨å ip æ°ã\n\n\n# ç»è®¡é¡µé¢çuvï¼\n\n1.å°è®¿é®é¡µé¢çæ¯ä¸ªç¨æ· id æ·»å å° hyperloglog ä¸­ã\npfadd key:uv userid1 userid2 useid3\n2.å©ç¨ pfcount è·åkeyçuvå¼ã\npfcount key:uv\n\n\nåå¹¶\npfadd redisæ°æ® user1 user2 user3\npfadd mysqlæ°æ® user1 user2 user4\npfmerge æ°æ®åº redisæ°æ® mysqlæ°æ®\npfcount æ°æ®åº // è¿åå¼ = 4\n\n\nhttps://segmentfault.com/a/1190000041696066\n\n\n# åæ°æ®ç±»åä½¿ç¨åºæ¯\n\nstringï¼1ãå¸¸è§key-valueç¼å­åºç¨ãå¸¸è§è®¡æ°å¦å¾®åæ°ãç²ä¸æ°ã2ãåå¸å¼éã\n\nhashï¼å­æ¾ç»æåæ°æ®ï¼å¦ç¨æ·ä¿¡æ¯ï¼æµç§°ãå¹´é¾ãæ§å«ãç§¯åç­ï¼ã\n\nlistï¼ç­é¨åå®¢åè¡¨ãæ¶æ¯éåç³»ç»ãä½¿ç¨listå¯ä»¥æå»ºéåç³»ç»ï¼æ¯å¦ï¼å°redisç¨ä½æ¥å¿æ¶éå¨ï¼å¤ä¸ªç«¯ç¹å°æ¥å¿ä¿¡æ¯åå¥redisï¼ç¶åä¸ä¸ªworkerç»ä¸å°æææ¥å¿åå°ç£çã\n\nsetï¼1ãå¥½åå³ç³»ï¼å¾®åç²ä¸çå±åå³æ³¨ãå±ååå¥½ãå±åå¥½åç­ï¼2ãå©ç¨å¯ä¸æ§ï¼ç»è®¡è®¿é®ç½ç«çææç¬ç«ip ã\n\nzsetï¼1ãæè¡æ¦ï¼2ãä¼åçº§éåã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Rediså½ä»¤",frontmatter:{title:"Rediså½ä»¤",date:"2023-03-17T17:01:07.000Z",permalink:"/pages/f706e8/"},regularPath:"/03.Redis/03.redis%E5%91%BD%E4%BB%A4.html",relativePath:"03.Redis/03.rediså½ä»¤.md",key:"v-78eeb3d8",path:"/pages/f706e8/",headers:[{level:2,title:"keysåscan",slug:"keysåscan",normalizedTitle:"keysåscan",charIndex:2}],headersStr:"keysåscan",content:'# keysåscan\n\nredisçåçº¿ç¨çãkeysæä»¤ä¼å¯¼è´çº¿ç¨é»å¡ä¸æ®µæ¶é´ï¼ç´å°æ§è¡å®æ¯ï¼æå¡æè½æ¢å¤ã\n\nscanéç¨æ¸è¿å¼éåçæ¹å¼æ¥è§£å³keyså½ä»¤å¯è½å¸¦æ¥çé»å¡é®é¢ï¼æ¯æ¬¡scanå½ä»¤çæ¶é´å¤æåº¦æ¯Oï¼1ï¼ï¼ä½æ¯è¦çæ­£å®ç°keysçåè½ï¼éè¦æ§è¡å¤æ¬¡scanãå½ä»¤æ¯ä¸ä¸ªåºäºæ¸¸æ çè¿­ä»£å¨ï¼æ¯æ¬¡è¢«è°ç¨ä¹åï¼ é½ä¼åç¨æ·è¿åä¸ä¸ªæ°çæ¸¸æ ï¼ ç¨æ·å¨ä¸æ¬¡è¿­ä»£æ¶éè¦ä½¿ç¨è¿ä¸ªæ°æ¸¸æ ä½ä¸º SCAN å½ä»¤çæ¸¸æ åæ°ï¼ ä»¥æ­¤æ¥å»¶ç»­ä¹åçè¿­ä»£è¿ç¨ãSCAN è¿åä¸ä¸ªåå«ä¸¤ä¸ªåç´ çæ°ç»ï¼ ç¬¬ä¸ä¸ªåç´ æ¯ç¨äºè¿è¡ä¸ä¸æ¬¡è¿­ä»£çæ°æ¸¸æ ï¼ èç¬¬äºä¸ªåç´ åæ¯ä¸ä¸ªæ°ç»ï¼ è¿ä¸ªæ°ç»ä¸­åå«äºææè¢«è¿­ä»£çåç´ ãå¦ææ°æ¸¸æ è¿å 0 è¡¨ç¤ºè¿­ä»£å·²ç»æã\n\nscançç¼ºç¹ï¼å¨scançè¿ç¨ä¸­å¦ææé®çååï¼å¢å ãå é¤ãä¿®æ¹ï¼ï¼éåè¿ç¨å¯è½ä¼æä»¥ä¸é®é¢ï¼æ°å¢çé®å¯è½æ²¡æéåå°ï¼éååºäºéå¤çé®ç­æåµï¼ä¹å°±æ¯è¯´scanå¹¶ä¸è½ä¿è¯å®æ´çéååºæ¥ææçé®ã\n\nscanå½ä»¤ç¨äºè¿­ä»£å½åæ°æ®åºä¸­çæ°æ®åºé®ï¼SCAN cursor [MATCH pattern] [COUNT count]\n\nkeys * //æ¥è¯¢ææå»º\nscan 0 match * count 10 //è¿å10ä¸ªåç´ \n\nredis 127.0.0.1:6379> scan 0   # ä½¿ç¨ 0 ä½ä¸ºæ¸¸æ ï¼å¼å§æ°çè¿­ä»£\n1) "17"                        # ç¬¬ä¸æ¬¡è¿­ä»£æ¶è¿åçæ¸¸æ \n2)  1) "key:12"\n    2) "key:8"\n    3) "key:4"\n    4) "key:14"\n    5) "key:16"\n    6) "key:17"\n    7) "key:15"\n    8) "key:10"\n    9) "key:3"\n   10) "key:7"\n   11) "key:1"\nredis 127.0.0.1:6379> scan 17  # ä½¿ç¨çæ¯ç¬¬ä¸æ¬¡è¿­ä»£æ¶è¿åçæ¸¸æ  17 å¼å§æ°çè¿­ä»£\n1) "0"\n2) 1) "key:5"\n   2) "key:18"\n   3) "key:0"\n   4) "key:2"\n   5) "key:19"\n   6) "key:13"\n   7) "key:6"\n   8) "key:9"\n   9) "key:11"\n',normalizedContent:'# keysåscan\n\nredisçåçº¿ç¨çãkeysæä»¤ä¼å¯¼è´çº¿ç¨é»å¡ä¸æ®µæ¶é´ï¼ç´å°æ§è¡å®æ¯ï¼æå¡æè½æ¢å¤ã\n\nscanéç¨æ¸è¿å¼éåçæ¹å¼æ¥è§£å³keyså½ä»¤å¯è½å¸¦æ¥çé»å¡é®é¢ï¼æ¯æ¬¡scanå½ä»¤çæ¶é´å¤æåº¦æ¯oï¼1ï¼ï¼ä½æ¯è¦çæ­£å®ç°keysçåè½ï¼éè¦æ§è¡å¤æ¬¡scanãå½ä»¤æ¯ä¸ä¸ªåºäºæ¸¸æ çè¿­ä»£å¨ï¼æ¯æ¬¡è¢«è°ç¨ä¹åï¼ é½ä¼åç¨æ·è¿åä¸ä¸ªæ°çæ¸¸æ ï¼ ç¨æ·å¨ä¸æ¬¡è¿­ä»£æ¶éè¦ä½¿ç¨è¿ä¸ªæ°æ¸¸æ ä½ä¸º scan å½ä»¤çæ¸¸æ åæ°ï¼ ä»¥æ­¤æ¥å»¶ç»­ä¹åçè¿­ä»£è¿ç¨ãscan è¿åä¸ä¸ªåå«ä¸¤ä¸ªåç´ çæ°ç»ï¼ ç¬¬ä¸ä¸ªåç´ æ¯ç¨äºè¿è¡ä¸ä¸æ¬¡è¿­ä»£çæ°æ¸¸æ ï¼ èç¬¬äºä¸ªåç´ åæ¯ä¸ä¸ªæ°ç»ï¼ è¿ä¸ªæ°ç»ä¸­åå«äºææè¢«è¿­ä»£çåç´ ãå¦ææ°æ¸¸æ è¿å 0 è¡¨ç¤ºè¿­ä»£å·²ç»æã\n\nscançç¼ºç¹ï¼å¨scançè¿ç¨ä¸­å¦ææé®çååï¼å¢å ãå é¤ãä¿®æ¹ï¼ï¼éåè¿ç¨å¯è½ä¼æä»¥ä¸é®é¢ï¼æ°å¢çé®å¯è½æ²¡æéåå°ï¼éååºäºéå¤çé®ç­æåµï¼ä¹å°±æ¯è¯´scanå¹¶ä¸è½ä¿è¯å®æ´çéååºæ¥ææçé®ã\n\nscanå½ä»¤ç¨äºè¿­ä»£å½åæ°æ®åºä¸­çæ°æ®åºé®ï¼scan cursor [match pattern] [count count]\n\nkeys * //æ¥è¯¢ææå»º\nscan 0 match * count 10 //è¿å10ä¸ªåç´ \n\nredis 127.0.0.1:6379> scan 0   # ä½¿ç¨ 0 ä½ä¸ºæ¸¸æ ï¼å¼å§æ°çè¿­ä»£\n1) "17"                        # ç¬¬ä¸æ¬¡è¿­ä»£æ¶è¿åçæ¸¸æ \n2)  1) "key:12"\n    2) "key:8"\n    3) "key:4"\n    4) "key:14"\n    5) "key:16"\n    6) "key:17"\n    7) "key:15"\n    8) "key:10"\n    9) "key:3"\n   10) "key:7"\n   11) "key:1"\nredis 127.0.0.1:6379> scan 17  # ä½¿ç¨çæ¯ç¬¬ä¸æ¬¡è¿­ä»£æ¶è¿åçæ¸¸æ  17 å¼å§æ°çè¿­ä»£\n1) "0"\n2) 1) "key:5"\n   2) "key:18"\n   3) "key:0"\n   4) "key:2"\n   5) "key:19"\n   6) "key:13"\n   7) "key:6"\n   8) "key:9"\n   9) "key:11"\n',charsets:{cjk:!0},lastUpdated:"2023/03/17, 19:41:31",lastUpdatedTimestamp:1679053291e3},{title:"Redisæ°æ®ç»æ",frontmatter:{title:"Redisæ°æ®ç»æ",date:"2023-03-17T20:59:04.000Z",permalink:"/pages/d7a25d/"},regularPath:"/03.Redis/04.redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html",relativePath:"03.Redis/04.redisæ°æ®ç»æ.md",key:"v-26fa598d",path:"/pages/d7a25d/",headers:[{level:2,title:"å¨æå­ç¬¦ä¸²",slug:"å¨æå­ç¬¦ä¸²",normalizedTitle:"å¨æå­ç¬¦ä¸²",charIndex:2},{level:2,title:"è·³è¡¨",slug:"è·³è¡¨",normalizedTitle:"è·³è¡¨",charIndex:478},{level:3,title:"skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾ï¼å¾æ´çï¼",slug:"skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾-å¾æ´ç",normalizedTitle:"skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾ï¼å¾æ´çï¼",charIndex:595},{level:2,title:"å­å¸",slug:"å­å¸",normalizedTitle:"å­å¸",charIndex:1276},{level:2,title:"æ´æ°éå",slug:"æ´æ°éå",normalizedTitle:"æ´æ°éå",charIndex:1283},{level:2,title:"åç¼©åè¡¨",slug:"åç¼©åè¡¨",normalizedTitle:"åç¼©åè¡¨",charIndex:1292},{level:2,title:"å¯¹è±¡",slug:"å¯¹è±¡",normalizedTitle:"å¯¹è±¡",charIndex:1301}],headersStr:"å¨æå­ç¬¦ä¸² è·³è¡¨ skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾ï¼å¾æ´çï¼ å­å¸ æ´æ°éå åç¼©åè¡¨ å¯¹è±¡",content:"# å¨æå­ç¬¦ä¸²\n\nSDS(simple dynamic string)\n\nstruct sdshdr {\n  // è®°å½ buf æ°ç»ä¸­å·²ä½¿ç¨å­èçæ°é\n  // ç­äº SDS æä¿å­å­ç¬¦ä¸²çé¿åº¦\n  int len;\n  // è®°å½ buf æ°ç»ä¸­æªä½¿ç¨å­èçæ°é\n  int free;\n  char buf[];\n}\n\n\nä¸é¢æ¯SDSä¸Cå­ç¬¦ä¸²çåºå«ã\n\nC å­ç¬¦ä¸²                         SDS\nè·åå­ç¬¦ä¸²é¿åº¦çå¤æåº¦ä¸º O(N) ã           è·åå­ç¬¦ä¸²é¿åº¦çå¤æåº¦ä¸º O(1) ã\nAPI æ¯ä¸å®å¨çï¼å¯è½ä¼é æç¼å²åºæº¢åºã         API æ¯å®å¨çï¼ä¸ä¼é æç¼å²åºæº¢åºã\nä¿®æ¹å­ç¬¦ä¸²é¿åº¦ N æ¬¡å¿ç¶éè¦æ§è¡ N æ¬¡åå­éåéã   ä¿®æ¹å­ç¬¦ä¸²é¿åº¦ N æ¬¡æå¤éè¦æ§è¡ N æ¬¡åå­éåéã\nåªè½ä¿å­ææ¬æ°æ®ã                     å¯ä»¥ä¿å­ææ¬æèäºè¿å¶æ°æ®ã\nå¯ä»¥ä½¿ç¨ææ <string.h> åºä¸­çå½æ°ã      å¯ä»¥ä½¿ç¨ä¸é¨å <string.h> åºä¸­çå½æ°ã\n\n\n# è·³è¡¨\n\nè·³è¡¨å¯ä»¥çæå¤å±é¾è¡¨ï¼å®æå¦ä¸çæ§è´¨ï¼\n\n * å¤å±çç»æç»æï¼æ¯å±æ¯ä¸ä¸ªæåºçé¾è¡¨\n * æåºå±çé¾è¡¨åå«ææçåç´ \n * è·³è·è¡¨çæ¥æ¾æ¬¡æ°è¿ä¼¼äºå±æ°ï¼æ¶é´å¤æåº¦ä¸ºO(logn)ï¼æå¥ãå é¤ä¹ä¸º O(logn)\n\n\n\n\n# skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾ï¼å¾æ´çï¼\n\n * skiplistååç§å¹³è¡¡æ ï¼å¦AVLãçº¢é»æ ç­ï¼çåç´ æ¯æåºæåçï¼èåå¸è¡¨ä¸æ¯æåºçãå æ­¤ï¼å¨åå¸è¡¨ä¸åªè½ååä¸ªkeyçæ¥æ¾ï¼ä¸éå®åèå´æ¥æ¾ãæè°èå´æ¥æ¾ï¼æçæ¯æ¥æ¾é£äºå¤§å°å¨æå®çä¸¤ä¸ªå¼ä¹é´çææèç¹ã\n * å¨åèå´æ¥æ¾çæ¶åï¼å¹³è¡¡æ æ¯skiplistæä½è¦å¤æãå¨å¹³è¡¡æ ä¸ï¼æä»¬æ¾å°æå®èå´çå°å¼ä¹åï¼è¿éè¦ä»¥ä¸­åºéåçé¡ºåºç»§ç»­å¯»æ¾å¶å®ä¸è¶è¿å¤§å¼çèç¹ãå¦æä¸å¯¹å¹³è¡¡æ è¿è¡ä¸å®çæ¹é ï¼è¿éçä¸­åºéåå¹¶ä¸å®¹æå®ç°ãèå¨skiplistä¸è¿è¡èå´æ¥æ¾å°±éå¸¸ç®åï¼åªéè¦å¨æ¾å°å°å¼ä¹åï¼å¯¹ç¬¬1å±é¾è¡¨è¿è¡è¥å¹²æ­¥çéåå°±å¯ä»¥å®ç°ã\n * å¹³è¡¡æ çæå¥åå é¤æä½å¯è½å¼åå­æ çè°æ´ï¼é»è¾å¤æï¼èskiplistçæå¥åå é¤åªéè¦ä¿®æ¹ç¸é»èç¹çæéï¼æä½ç®ååå¿«éã\n * ä»åå­å ç¨ä¸æ¥è¯´ï¼skiplistæ¯å¹³è¡¡æ æ´çµæ´»ä¸äºãä¸è¬æ¥è¯´ï¼å¹³è¡¡æ æ¯ä¸ªèç¹åå«2ä¸ªæéï¼åå«æåå·¦å³å­æ ï¼ï¼èskiplistæ¯ä¸ªèç¹åå«çæéæ°ç®å¹³åä¸º1/(1-p)ï¼å·ä½åå³äºåæ°pçå¤§å°ãå¦æåRediséçå®ç°ä¸æ ·ï¼åp=1/4ï¼é£ä¹å¹³åæ¯ä¸ªèç¹åå«1.33ä¸ªæéï¼æ¯å¹³è¡¡æ æ´æä¼å¿ã\n * æ¥æ¾åä¸ªkeyï¼skipliståå¹³è¡¡æ çæ¶é´å¤æåº¦é½ä¸ºO(log n)ï¼å¤§ä½ç¸å½ï¼èåå¸è¡¨å¨ä¿æè¾ä½çåå¸å¼å²çªæ¦ççåæä¸ï¼æ¥æ¾æ¶é´å¤æåº¦æ¥è¿O(1)ï¼æ§è½æ´é«ä¸äºãæä»¥æä»¬å¹³å¸¸ä½¿ç¨çåç§Mapædictionaryç»æï¼å¤§é½æ¯åºäºåå¸è¡¨å®ç°çã\n * ä»ç®æ³å®ç°é¾åº¦ä¸æ¥æ¯è¾ï¼skiplistæ¯å¹³è¡¡æ è¦ç®åå¾å¤ã\n\n\n# å­å¸\n\n\n# æ´æ°éå\n\n\n# åç¼©åè¡¨\n\n\n# å¯¹è±¡\n\nhttp://www.topjavaer.cn/redis/redis-basic/3-data-structure.html",normalizedContent:"# å¨æå­ç¬¦ä¸²\n\nsds(simple dynamic string)\n\nstruct sdshdr {\n  // è®°å½ buf æ°ç»ä¸­å·²ä½¿ç¨å­èçæ°é\n  // ç­äº sds æä¿å­å­ç¬¦ä¸²çé¿åº¦\n  int len;\n  // è®°å½ buf æ°ç»ä¸­æªä½¿ç¨å­èçæ°é\n  int free;\n  char buf[];\n}\n\n\nä¸é¢æ¯sdsä¸cå­ç¬¦ä¸²çåºå«ã\n\nc å­ç¬¦ä¸²                         sds\nè·åå­ç¬¦ä¸²é¿åº¦çå¤æåº¦ä¸º o(n) ã           è·åå­ç¬¦ä¸²é¿åº¦çå¤æåº¦ä¸º o(1) ã\napi æ¯ä¸å®å¨çï¼å¯è½ä¼é æç¼å²åºæº¢åºã         api æ¯å®å¨çï¼ä¸ä¼é æç¼å²åºæº¢åºã\nä¿®æ¹å­ç¬¦ä¸²é¿åº¦ n æ¬¡å¿ç¶éè¦æ§è¡ n æ¬¡åå­éåéã   ä¿®æ¹å­ç¬¦ä¸²é¿åº¦ n æ¬¡æå¤éè¦æ§è¡ n æ¬¡åå­éåéã\nåªè½ä¿å­ææ¬æ°æ®ã                     å¯ä»¥ä¿å­ææ¬æèäºè¿å¶æ°æ®ã\nå¯ä»¥ä½¿ç¨ææ <string.h> åºä¸­çå½æ°ã      å¯ä»¥ä½¿ç¨ä¸é¨å <string.h> åºä¸­çå½æ°ã\n\n\n# è·³è¡¨\n\nè·³è¡¨å¯ä»¥çæå¤å±é¾è¡¨ï¼å®æå¦ä¸çæ§è´¨ï¼\n\n * å¤å±çç»æç»æï¼æ¯å±æ¯ä¸ä¸ªæåºçé¾è¡¨\n * æåºå±çé¾è¡¨åå«ææçåç´ \n * è·³è·è¡¨çæ¥æ¾æ¬¡æ°è¿ä¼¼äºå±æ°ï¼æ¶é´å¤æåº¦ä¸ºo(logn)ï¼æå¥ãå é¤ä¹ä¸º o(logn)\n\n\n\n\n# skiplistä¸å¹³è¡¡æ ãåå¸è¡¨çæ¯è¾ï¼å¾æ´çï¼\n\n * skiplistååç§å¹³è¡¡æ ï¼å¦avlãçº¢é»æ ç­ï¼çåç´ æ¯æåºæåçï¼èåå¸è¡¨ä¸æ¯æåºçãå æ­¤ï¼å¨åå¸è¡¨ä¸åªè½ååä¸ªkeyçæ¥æ¾ï¼ä¸éå®åèå´æ¥æ¾ãæè°èå´æ¥æ¾ï¼æçæ¯æ¥æ¾é£äºå¤§å°å¨æå®çä¸¤ä¸ªå¼ä¹é´çææèç¹ã\n * å¨åèå´æ¥æ¾çæ¶åï¼å¹³è¡¡æ æ¯skiplistæä½è¦å¤æãå¨å¹³è¡¡æ ä¸ï¼æä»¬æ¾å°æå®èå´çå°å¼ä¹åï¼è¿éè¦ä»¥ä¸­åºéåçé¡ºåºç»§ç»­å¯»æ¾å¶å®ä¸è¶è¿å¤§å¼çèç¹ãå¦æä¸å¯¹å¹³è¡¡æ è¿è¡ä¸å®çæ¹é ï¼è¿éçä¸­åºéåå¹¶ä¸å®¹æå®ç°ãèå¨skiplistä¸è¿è¡èå´æ¥æ¾å°±éå¸¸ç®åï¼åªéè¦å¨æ¾å°å°å¼ä¹åï¼å¯¹ç¬¬1å±é¾è¡¨è¿è¡è¥å¹²æ­¥çéåå°±å¯ä»¥å®ç°ã\n * å¹³è¡¡æ çæå¥åå é¤æä½å¯è½å¼åå­æ çè°æ´ï¼é»è¾å¤æï¼èskiplistçæå¥åå é¤åªéè¦ä¿®æ¹ç¸é»èç¹çæéï¼æä½ç®ååå¿«éã\n * ä»åå­å ç¨ä¸æ¥è¯´ï¼skiplistæ¯å¹³è¡¡æ æ´çµæ´»ä¸äºãä¸è¬æ¥è¯´ï¼å¹³è¡¡æ æ¯ä¸ªèç¹åå«2ä¸ªæéï¼åå«æåå·¦å³å­æ ï¼ï¼èskiplistæ¯ä¸ªèç¹åå«çæéæ°ç®å¹³åä¸º1/(1-p)ï¼å·ä½åå³äºåæ°pçå¤§å°ãå¦æårediséçå®ç°ä¸æ ·ï¼åp=1/4ï¼é£ä¹å¹³åæ¯ä¸ªèç¹åå«1.33ä¸ªæéï¼æ¯å¹³è¡¡æ æ´æä¼å¿ã\n * æ¥æ¾åä¸ªkeyï¼skipliståå¹³è¡¡æ çæ¶é´å¤æåº¦é½ä¸ºo(log n)ï¼å¤§ä½ç¸å½ï¼èåå¸è¡¨å¨ä¿æè¾ä½çåå¸å¼å²çªæ¦ççåæä¸ï¼æ¥æ¾æ¶é´å¤æåº¦æ¥è¿o(1)ï¼æ§è½æ´é«ä¸äºãæä»¥æä»¬å¹³å¸¸ä½¿ç¨çåç§mapædictionaryç»æï¼å¤§é½æ¯åºäºåå¸è¡¨å®ç°çã\n * ä»ç®æ³å®ç°é¾åº¦ä¸æ¥æ¯è¾ï¼skiplistæ¯å¹³è¡¡æ è¦ç®åå¾å¤ã\n\n\n# å­å¸\n\n\n# æ´æ°éå\n\n\n# åç¼©åè¡¨\n\n\n# å¯¹è±¡\n\nhttp://www.topjavaer.cn/redis/redis-basic/3-data-structure.html",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"redisæä¹å",frontmatter:{title:"redisæä¹å",date:"2023-03-17T21:11:09.000Z",permalink:"/pages/bc6be1/"},regularPath:"/03.Redis/05.redis%E6%8C%81%E4%B9%85%E5%8C%96.html",relativePath:"03.Redis/05.redisæä¹å.md",key:"v-f5ed38f8",path:"/pages/bc6be1/",headers:[{level:2,title:"RDB",slug:"rdb",normalizedTitle:"rdb",charIndex:19},{level:2,title:"AOF",slug:"aof",normalizedTitle:"aof",charIndex:26},{level:2,title:"æ··åæä¹å",slug:"æ··åæä¹å",normalizedTitle:"æ··åæä¹å",charIndex:1727},{level:2,title:"RDBåAOFå¦ä½éæ©",slug:"rdbåaofå¦ä½éæ©",normalizedTitle:"rdbåaofå¦ä½éæ©",charIndex:2261}],headersStr:"RDB AOF æ··åæä¹å RDBåAOFå¦ä½éæ©",content:"Redis æ¯æä¸¤ç§æä¹åæ¹å¼ï¼ä¸ç§æ¯RDBï¼ä¸ç§æ¯AOFãåèä¼æ ¹æ®æå®çè§åå®æ¶å°åå­ä¸­çæ°æ®å­å¨å¨ç¡¬çä¸ï¼èåèå¨æ¯æ¬¡æ§è¡å®å½ä»¤åå°å½ä»¤è®°å½ä¸æ¥ãä¸è¬å°ä¸¤èç»åä½¿ç¨ã\n\n\n# RDB\n\nRDB æ¯ Redis é»è®¤çæä¹åæ¹æ¡ãRDBæä¹åæ¶ä¼å°åå­ä¸­çæ°æ®åå¥å°ç£çä¸­ï¼å¨æå®ç®å½ä¸çæä¸ä¸ªdump.rdbæä»¶ãRedis éå¯ä¼å è½½dump.rdbæä»¶æ¢å¤æ°æ®ã\n\nRDBæä¹åçè¿ç¨ï¼å³bgsaveï¼æ§è¡SAVEå½ä»¤é¤å¤ï¼ï¼\n\n * fork åå»ºä¸ä¸ªå­è¿ç¨ï¼\n * ç¶è¿ç¨ç»§ç»­æ¥æ¶å¹¶å¤çå®¢æ·ç«¯çè¯·æ±ï¼èå­è¿ç¨å¼å§å°åå­ä¸­çæ°æ®åè¿ç¡¬ççä¸´æ¶æä»¶ï¼\n * å½å­è¿ç¨åå®æææ°æ®åä¼ç¨è¯¥ä¸´æ¶æä»¶æ¿æ¢æ§çRDBæä»¶ã\n\nRediså¯å¨æ¶ä¼è¯»åRDBå¿«ç§æä»¶ï¼å°æ°æ®ä»ç¡¬çè½½å¥åå­ãéè¿RDBæ¹å¼çæä¹åï¼ä¸æ¦Rediså¼å¸¸éåºï¼å°±ä¼ä¸¢å¤±æè¿ä¸æ¬¡æä¹åä»¥åæ´æ¹çæ°æ®ã\n\nè§¦åRDBå¿«ç§ï¼\n\n 1. æå¨è§¦åï¼\n    * ç¨æ·æ§è¡SAVEæBGSAVEå½ä»¤ãSAVEå½ä»¤æ§è¡å¿«ç§çè¿ç¨ä¼é»å¡æææ¥èªå®¢æ·ç«¯çè¯·æ±ï¼åºé¿åå¨çäº§ç¯å¢ä½¿ç¨è¿ä¸ªå½ä»¤ãBGSAVEå½ä»¤å¯ä»¥å¨åå°å¼æ­¥è¿è¡å¿«ç§æä½ï¼å¿«ç§çåæ¶æå¡å¨è¿å¯ä»¥ç»§ç»­ååºå®¢æ·ç«¯çè¯·æ±ï¼å æ­¤éè¦æå¨æ§è¡å¿«ç§æ¶æ¨èä½¿ç¨BGSAVEå½ä»¤ï¼\n 2. è¢«å¨è§¦åï¼\n    * æ ¹æ®éç½®è§åè¿è¡èªå¨å¿«ç§ï¼å¦SAVE 300 10,300ç§åè³å°æ10ä¸ªé®è¢«ä¿®æ¹åè¿è¡å¿«ç§ã\n    * å¦æä»èç¹æ§è¡å¨éå¤å¶æä½ï¼ä¸»èç¹èªå¨æ§è¡bgsaveçæRDBæä»¶å¹¶åéç»ä»èç¹ã\n    * é»è®¤æåµä¸æ§è¡shutdownå½ä»¤æ¶ï¼å¦ææ²¡æå¼å¯AOFæä¹ååè½åèªå¨æ§è¡bgsaveã\n    * æ§è¡debug reloadå½ä»¤éæ°å è½½Redisæ¶ï¼ä¹ä¼èªå¨è§¦åsaveæä½ã\n\nä¼ç¹ï¼Rediså è½½RDBæ¢å¤æ°æ®è¿è¿å¿«äºAOFçæ¹å¼ã\n\nç¼ºç¹ï¼\n\n 1. RDBæ¹å¼æ°æ®æ²¡åæ³åå°å®æ¶æä¹å/ç§çº§æä¹åãå ä¸ºbgsaveæ¯æ¬¡è¿è¡é½è¦æ§è¡forkæä½åå»ºå­è¿ç¨ï¼å±äºééçº§æä½ï¼é¢ç¹æ§è¡ææ¬è¿é«ã\n 2. å­å¨èçæ¬Redisæå¡åæ°çæ¬RDBæ ¼å¼å¼å®¹æ§é®é¢ãRDBæä»¶ä½¿ç¨ç¹å®äºè¿å¶æ ¼å¼ä¿å­ï¼Redisçæ¬æ¼è¿è¿ç¨ä¸­æå¤ä¸ªæ ¼å¼çRDBçæ¬ï¼å­å¨èçæ¬Redisæå¡æ æ³å¼å®¹æ°çRDBæ ¼å¼çé®é¢ã\n\n\n# AOF\n\nAOFï¼append only fileï¼æä¹åï¼ä»¥ç¬ç«æ¥å¿çæ¹å¼è®°å½æ¯æ¬¡åå½ä»¤ï¼Rediséå¯æ¶ä¼éæ°æ§è¡AOFæä»¶ä¸­çå½ä»¤è¾¾å°æ¢å¤æ°æ®çç®çãAOFçä¸»è¦ä½ç¨æ¯è§£å³äºæ°æ®æä¹åçå®æ¶æ§ï¼ç®åå·²ç»æ¯Redisæä¹åçä¸»æµæ¹å¼ã\n\né»è®¤æåµä¸Redisæ²¡æå¼å¯AOFæ¹å¼çæä¹åï¼å¯ä»¥éè¿appendonlyåæ°å¯ç¨appendonly yesãå¼å¯AOFæ¹å¼æä¹ååæ¯æ§è¡ä¸æ¡åå½ä»¤ï¼Rediså°±ä¼å°è¯¥å½ä»¤åè¿aof_bufç¼å²åºï¼AOFç¼å²åºæ ¹æ®å¯¹åºçç­ç¥åç¡¬çååæ­¥æä½ã\n\né»è®¤æåµä¸ç³»ç»æ¯30ç§ä¼æ§è¡ä¸æ¬¡åæ­¥æä½ãä¸ºäºé²æ­¢ç¼å²åºæ°æ®ä¸¢å¤±ï¼å¯ä»¥å¨Redisåå¥AOFæä»¶åä¸»å¨è¦æ±ç³»ç»å°ç¼å²åºæ°æ®åæ­¥å°ç¡¬çä¸ãå¯ä»¥éè¿appendfsyncåæ°è®¾ç½®åæ­¥çæ¶æºã\n\nappendfsync always //æ¯æ¬¡åå¥aofæä»¶é½ä¼æ§è¡åæ­¥ï¼æå®å¨ææ¢ï¼åªè½æ¯æå ç¾TPSåå¥ï¼ä¸å»ºè®®éç½®\nappendfsync everysec  //ä¿è¯äºæ§è½ä¹ä¿è¯äºå®å¨ï¼å»ºè®®éç½®\nappendfsync no //ç±æä½ç³»ç»å³å®ä½æ¶è¿è¡åæ­¥æä½\n\n\néåæºå¶ï¼\n\néçå½ä»¤ä¸æ­åå¥AOFï¼æä»¶ä¼è¶æ¥è¶å¤§ï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼Rediså¼å¥AOFéåæºå¶åç¼©æä»¶ä½ç§¯ãAOFæä»¶éåæ¯æRedisè¿ç¨åçæ°æ®è½¬åä¸ºåå½ä»¤åæ­¥å°æ°AOFæä»¶çè¿ç¨ã\n\nä¼ç¹ï¼\n\n 1. AOFå¯ä»¥æ´å¥½çä¿æ¤æ°æ®ä¸ä¸¢å¤±ï¼ä¸è¬AOFä¼æ¯ç§å»æ§è¡ä¸æ¬¡fsyncæä½ï¼å¦æredisè¿ç¨ææï¼æå¤ä¸¢å¤±1ç§çæ°æ®ã\n 2. AOFä»¥appen-onlyçæ¨¡å¼åå¥ï¼æä»¥æ²¡æä»»ä½ç£çå¯»åçå¼éï¼åå¥æ§è½éå¸¸é«ã\n\nç¼ºç¹\n\n 1. å¯¹äºåä¸ä»½æä»¶AOFæä»¶æ¯RDBæ°æ®å¿«ç§è¦å¤§ã\n 2. ä¸éååå¤è¯»å°åºæ¯ã\n 3. æ°æ®æ¢å¤æ¯è¾æ¢ã\n\n\n# æ··åæä¹å\n\næ··åæä¹åå¹¶ä¸æ¯ä¸ç§å¨æ°çæä¹åæ¹å¼ï¼èæ¯å¯¹å·²ææ¹å¼çä¼åãæ··åæä¹ååªåçäº AOF éåè¿ç¨ãä½¿ç¨äºæ··åæä¹åï¼éååçæ° AOF æä»¶ååæ®µæ¯ RDB æ ¼å¼çå¨éæ°æ®ï¼ååæ®µæ¯ AOF æ ¼å¼çå¢éæ°æ®ã\n\nå¼å¯ï¼æ··åæä¹åçéç½®åæ°ä¸º aof-use-rdb-preambleï¼éç½®ä¸º yes æ¶å¼å¯æ··åæä¹åï¼å¨ redis 4 åå¼å¥æ¶ï¼é»è®¤æ¯å³é­æ··åæä¹åçï¼ä½æ¯å¨ redis 5 ä¸­é»è®¤å·²ç»æå¼äºã\n\nå³é­ï¼ä½¿ç¨ aof-use-rdb-preamble no éç½®å³å¯å³é­æ··åæä¹åã\n\næ··åæä¹åæ¬è´¨æ¯éè¿ AOF åå°éåï¼bgrewriteaof å½ä»¤ï¼å®æçï¼ä¸åçæ¯å½å¼å¯æ··åæä¹åæ¶ï¼fork åºçå­è¿ç¨åå°å½åå¨éæ°æ®ä»¥ RDB æ¹å¼åå¥æ°ç AOF æä»¶ï¼ç¶ååå° AOF éåç¼å²åºï¼aof_rewrite_buf_blocksï¼çå¢éå½ä»¤ä»¥ AOF æ¹å¼åå¥å°æä»¶ï¼åå¥å®æåéç¥ä¸»è¿ç¨å°æ°çå«æ RDB æ ¼å¼å AOF æ ¼å¼ç AOF æä»¶æ¿æ¢æ§çç AOF æä»¶ã\n\nä¼ç¹ï¼ç»å RDB å AOF çä¼ç¹, æ´å¿«çéååæ¢å¤ã\n\nç¼ºç¹ï¼AOF æä»¶éé¢ç RDB é¨åä¸åæ¯ AOF æ ¼å¼ï¼å¯è¯»æ§å·®ã\n\n\n# RDBåAOFå¦ä½éæ©\n\n * ä»ä½¿ç¨RDBè¿æ ·ä¼ä¸¢å¤±å¾å¤æ°æ®ã\n * ä»ä½¿ç¨AOFï¼å ä¸ºè¿ä¸ä¼æä¸¤ä¸ªé®é¢ï¼ç¬¬ä¸éè¿AOFæ¢å¤éåº¦æ¢ï¼ç¬¬äºRDBæ¯æ¬¡ç®åç²æ´çææ°æ®å¿«ç§ï¼æ´å å®å¨å¥å£®ã\n * ä¸è¬æ¥è¯´ï¼ å¦ææ³å°½éä¿è¯æ°æ®å®å¨æ§ï¼ ä½ åºè¯¥åæ¶ä½¿ç¨ RDB å AOF æä¹ååè½ï¼åæ¶å¯ä»¥å¼å¯æ··åæä¹åã\n * ç»¼åAOFåRDBä¸¤ç§æä¹åæ¹å¼ï¼ç¨AOFæ¥ä¿è¯æ°æ®ä¸ä¸¢å¤±ï¼ä½ä¸ºæ¢å¤æ°æ®çç¬¬ä¸éæ©ï¼ç¨RDBæ¥åä¸åç¨åº¦çå·å¤ï¼å¨AOFæä»¶é½ä¸¢å¤±ææåä¸å¯ç¨çæ¶åï¼å¯ä»¥ä½¿ç¨RDBè¿è¡å¿«éçæ°æ®æ¢å¤ã\n\n",normalizedContent:"redis æ¯æä¸¤ç§æä¹åæ¹å¼ï¼ä¸ç§æ¯rdbï¼ä¸ç§æ¯aofãåèä¼æ ¹æ®æå®çè§åå®æ¶å°åå­ä¸­çæ°æ®å­å¨å¨ç¡¬çä¸ï¼èåèå¨æ¯æ¬¡æ§è¡å®å½ä»¤åå°å½ä»¤è®°å½ä¸æ¥ãä¸è¬å°ä¸¤èç»åä½¿ç¨ã\n\n\n# rdb\n\nrdb æ¯ redis é»è®¤çæä¹åæ¹æ¡ãrdbæä¹åæ¶ä¼å°åå­ä¸­çæ°æ®åå¥å°ç£çä¸­ï¼å¨æå®ç®å½ä¸çæä¸ä¸ªdump.rdbæä»¶ãredis éå¯ä¼å è½½dump.rdbæä»¶æ¢å¤æ°æ®ã\n\nrdbæä¹åçè¿ç¨ï¼å³bgsaveï¼æ§è¡saveå½ä»¤é¤å¤ï¼ï¼\n\n * fork åå»ºä¸ä¸ªå­è¿ç¨ï¼\n * ç¶è¿ç¨ç»§ç»­æ¥æ¶å¹¶å¤çå®¢æ·ç«¯çè¯·æ±ï¼èå­è¿ç¨å¼å§å°åå­ä¸­çæ°æ®åè¿ç¡¬ççä¸´æ¶æä»¶ï¼\n * å½å­è¿ç¨åå®æææ°æ®åä¼ç¨è¯¥ä¸´æ¶æä»¶æ¿æ¢æ§çrdbæä»¶ã\n\nrediså¯å¨æ¶ä¼è¯»årdbå¿«ç§æä»¶ï¼å°æ°æ®ä»ç¡¬çè½½å¥åå­ãéè¿rdbæ¹å¼çæä¹åï¼ä¸æ¦rediså¼å¸¸éåºï¼å°±ä¼ä¸¢å¤±æè¿ä¸æ¬¡æä¹åä»¥åæ´æ¹çæ°æ®ã\n\nè§¦årdbå¿«ç§ï¼\n\n 1. æå¨è§¦åï¼\n    * ç¨æ·æ§è¡saveæbgsaveå½ä»¤ãsaveå½ä»¤æ§è¡å¿«ç§çè¿ç¨ä¼é»å¡æææ¥èªå®¢æ·ç«¯çè¯·æ±ï¼åºé¿åå¨çäº§ç¯å¢ä½¿ç¨è¿ä¸ªå½ä»¤ãbgsaveå½ä»¤å¯ä»¥å¨åå°å¼æ­¥è¿è¡å¿«ç§æä½ï¼å¿«ç§çåæ¶æå¡å¨è¿å¯ä»¥ç»§ç»­ååºå®¢æ·ç«¯çè¯·æ±ï¼å æ­¤éè¦æå¨æ§è¡å¿«ç§æ¶æ¨èä½¿ç¨bgsaveå½ä»¤ï¼\n 2. è¢«å¨è§¦åï¼\n    * æ ¹æ®éç½®è§åè¿è¡èªå¨å¿«ç§ï¼å¦save 300 10,300ç§åè³å°æ10ä¸ªé®è¢«ä¿®æ¹åè¿è¡å¿«ç§ã\n    * å¦æä»èç¹æ§è¡å¨éå¤å¶æä½ï¼ä¸»èç¹èªå¨æ§è¡bgsaveçærdbæä»¶å¹¶åéç»ä»èç¹ã\n    * é»è®¤æåµä¸æ§è¡shutdownå½ä»¤æ¶ï¼å¦ææ²¡æå¼å¯aofæä¹ååè½åèªå¨æ§è¡bgsaveã\n    * æ§è¡debug reloadå½ä»¤éæ°å è½½redisæ¶ï¼ä¹ä¼èªå¨è§¦åsaveæä½ã\n\nä¼ç¹ï¼rediså è½½rdbæ¢å¤æ°æ®è¿è¿å¿«äºaofçæ¹å¼ã\n\nç¼ºç¹ï¼\n\n 1. rdbæ¹å¼æ°æ®æ²¡åæ³åå°å®æ¶æä¹å/ç§çº§æä¹åãå ä¸ºbgsaveæ¯æ¬¡è¿è¡é½è¦æ§è¡forkæä½åå»ºå­è¿ç¨ï¼å±äºééçº§æä½ï¼é¢ç¹æ§è¡ææ¬è¿é«ã\n 2. å­å¨èçæ¬redisæå¡åæ°çæ¬rdbæ ¼å¼å¼å®¹æ§é®é¢ãrdbæä»¶ä½¿ç¨ç¹å®äºè¿å¶æ ¼å¼ä¿å­ï¼redisçæ¬æ¼è¿è¿ç¨ä¸­æå¤ä¸ªæ ¼å¼çrdbçæ¬ï¼å­å¨èçæ¬redisæå¡æ æ³å¼å®¹æ°çrdbæ ¼å¼çé®é¢ã\n\n\n# aof\n\naofï¼append only fileï¼æä¹åï¼ä»¥ç¬ç«æ¥å¿çæ¹å¼è®°å½æ¯æ¬¡åå½ä»¤ï¼rediséå¯æ¶ä¼éæ°æ§è¡aofæä»¶ä¸­çå½ä»¤è¾¾å°æ¢å¤æ°æ®çç®çãaofçä¸»è¦ä½ç¨æ¯è§£å³äºæ°æ®æä¹åçå®æ¶æ§ï¼ç®åå·²ç»æ¯redisæä¹åçä¸»æµæ¹å¼ã\n\né»è®¤æåµä¸redisæ²¡æå¼å¯aofæ¹å¼çæä¹åï¼å¯ä»¥éè¿appendonlyåæ°å¯ç¨appendonly yesãå¼å¯aofæ¹å¼æä¹ååæ¯æ§è¡ä¸æ¡åå½ä»¤ï¼rediså°±ä¼å°è¯¥å½ä»¤åè¿aof_bufç¼å²åºï¼aofç¼å²åºæ ¹æ®å¯¹åºçç­ç¥åç¡¬çååæ­¥æä½ã\n\né»è®¤æåµä¸ç³»ç»æ¯30ç§ä¼æ§è¡ä¸æ¬¡åæ­¥æä½ãä¸ºäºé²æ­¢ç¼å²åºæ°æ®ä¸¢å¤±ï¼å¯ä»¥å¨redisåå¥aofæä»¶åä¸»å¨è¦æ±ç³»ç»å°ç¼å²åºæ°æ®åæ­¥å°ç¡¬çä¸ãå¯ä»¥éè¿appendfsyncåæ°è®¾ç½®åæ­¥çæ¶æºã\n\nappendfsync always //æ¯æ¬¡åå¥aofæä»¶é½ä¼æ§è¡åæ­¥ï¼æå®å¨ææ¢ï¼åªè½æ¯æå ç¾tpsåå¥ï¼ä¸å»ºè®®éç½®\nappendfsync everysec  //ä¿è¯äºæ§è½ä¹ä¿è¯äºå®å¨ï¼å»ºè®®éç½®\nappendfsync no //ç±æä½ç³»ç»å³å®ä½æ¶è¿è¡åæ­¥æä½\n\n\néåæºå¶ï¼\n\néçå½ä»¤ä¸æ­åå¥aofï¼æä»¶ä¼è¶æ¥è¶å¤§ï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼rediså¼å¥aoféåæºå¶åç¼©æä»¶ä½ç§¯ãaofæä»¶éåæ¯æredisè¿ç¨åçæ°æ®è½¬åä¸ºåå½ä»¤åæ­¥å°æ°aofæä»¶çè¿ç¨ã\n\nä¼ç¹ï¼\n\n 1. aofå¯ä»¥æ´å¥½çä¿æ¤æ°æ®ä¸ä¸¢å¤±ï¼ä¸è¬aofä¼æ¯ç§å»æ§è¡ä¸æ¬¡fsyncæä½ï¼å¦æredisè¿ç¨ææï¼æå¤ä¸¢å¤±1ç§çæ°æ®ã\n 2. aofä»¥appen-onlyçæ¨¡å¼åå¥ï¼æä»¥æ²¡æä»»ä½ç£çå¯»åçå¼éï¼åå¥æ§è½éå¸¸é«ã\n\nç¼ºç¹\n\n 1. å¯¹äºåä¸ä»½æä»¶aofæä»¶æ¯rdbæ°æ®å¿«ç§è¦å¤§ã\n 2. ä¸éååå¤è¯»å°åºæ¯ã\n 3. æ°æ®æ¢å¤æ¯è¾æ¢ã\n\n\n# æ··åæä¹å\n\næ··åæä¹åå¹¶ä¸æ¯ä¸ç§å¨æ°çæä¹åæ¹å¼ï¼èæ¯å¯¹å·²ææ¹å¼çä¼åãæ··åæä¹ååªåçäº aof éåè¿ç¨ãä½¿ç¨äºæ··åæä¹åï¼éååçæ° aof æä»¶ååæ®µæ¯ rdb æ ¼å¼çå¨éæ°æ®ï¼ååæ®µæ¯ aof æ ¼å¼çå¢éæ°æ®ã\n\nå¼å¯ï¼æ··åæä¹åçéç½®åæ°ä¸º aof-use-rdb-preambleï¼éç½®ä¸º yes æ¶å¼å¯æ··åæä¹åï¼å¨ redis 4 åå¼å¥æ¶ï¼é»è®¤æ¯å³é­æ··åæä¹åçï¼ä½æ¯å¨ redis 5 ä¸­é»è®¤å·²ç»æå¼äºã\n\nå³é­ï¼ä½¿ç¨ aof-use-rdb-preamble no éç½®å³å¯å³é­æ··åæä¹åã\n\næ··åæä¹åæ¬è´¨æ¯éè¿ aof åå°éåï¼bgrewriteaof å½ä»¤ï¼å®æçï¼ä¸åçæ¯å½å¼å¯æ··åæä¹åæ¶ï¼fork åºçå­è¿ç¨åå°å½åå¨éæ°æ®ä»¥ rdb æ¹å¼åå¥æ°ç aof æä»¶ï¼ç¶ååå° aof éåç¼å²åºï¼aof_rewrite_buf_blocksï¼çå¢éå½ä»¤ä»¥ aof æ¹å¼åå¥å°æä»¶ï¼åå¥å®æåéç¥ä¸»è¿ç¨å°æ°çå«æ rdb æ ¼å¼å aof æ ¼å¼ç aof æä»¶æ¿æ¢æ§çç aof æä»¶ã\n\nä¼ç¹ï¼ç»å rdb å aof çä¼ç¹, æ´å¿«çéååæ¢å¤ã\n\nç¼ºç¹ï¼aof æä»¶éé¢ç rdb é¨åä¸åæ¯ aof æ ¼å¼ï¼å¯è¯»æ§å·®ã\n\n\n# rdbåaofå¦ä½éæ©\n\n * ä»ä½¿ç¨rdbè¿æ ·ä¼ä¸¢å¤±å¾å¤æ°æ®ã\n * ä»ä½¿ç¨aofï¼å ä¸ºè¿ä¸ä¼æä¸¤ä¸ªé®é¢ï¼ç¬¬ä¸éè¿aofæ¢å¤éåº¦æ¢ï¼ç¬¬äºrdbæ¯æ¬¡ç®åç²æ´çææ°æ®å¿«ç§ï¼æ´å å®å¨å¥å£®ã\n * ä¸è¬æ¥è¯´ï¼ å¦ææ³å°½éä¿è¯æ°æ®å®å¨æ§ï¼ ä½ åºè¯¥åæ¶ä½¿ç¨ rdb å aof æä¹ååè½ï¼åæ¶å¯ä»¥å¼å¯æ··åæä¹åã\n * ç»¼åaofårdbä¸¤ç§æä¹åæ¹å¼ï¼ç¨aofæ¥ä¿è¯æ°æ®ä¸ä¸¢å¤±ï¼ä½ä¸ºæ¢å¤æ°æ®çç¬¬ä¸éæ©ï¼ç¨rdbæ¥åä¸åç¨åº¦çå·å¤ï¼å¨aofæä»¶é½ä¸¢å¤±ææåä¸å¯ç¨çæ¶åï¼å¯ä»¥ä½¿ç¨rdbè¿è¡å¿«éçæ°æ®æ¢å¤ã\n\n",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Redisé«å¯ç¨",frontmatter:{title:"Redisé«å¯ç¨",date:"2023-03-17T21:24:51.000Z",permalink:"/pages/effbd9/"},regularPath:"/03.Redis/06.redis%E9%AB%98%E5%8F%AF%E7%94%A8.html",relativePath:"03.Redis/06.redisé«å¯ç¨.md",key:"v-120df2fa",path:"/pages/effbd9/",headers:[{level:2,title:"ä¸»ä»æ¨¡å¼",slug:"ä¸»ä»æ¨¡å¼",normalizedTitle:"ä¸»ä»æ¨¡å¼",charIndex:2},{level:2,title:"å¨åµæ¨¡å¼",slug:"å¨åµæ¨¡å¼",normalizedTitle:"å¨åµæ¨¡å¼",charIndex:1398},{level:2,title:"éç¾¤æ¨¡å¼",slug:"éç¾¤æ¨¡å¼",normalizedTitle:"éç¾¤æ¨¡å¼",charIndex:2497},{level:2,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:4198},{level:2,title:"å¤§åç redis éç¾¤æ¹æ¡",slug:"å¤§åç-redis-éç¾¤æ¹æ¡",normalizedTitle:"å¤§åç redis éç¾¤æ¹æ¡",charIndex:4506}],headersStr:"ä¸»ä»æ¨¡å¼ å¨åµæ¨¡å¼ éç¾¤æ¨¡å¼ æ»ç» å¤§åç redis éç¾¤æ¹æ¡",content:"# ä¸»ä»æ¨¡å¼\n\nä¸è¬ï¼ç³»ç»çé«å¯ç¨é½æ¯éè¿é¨ç½²å¤å°æºå¨å®ç°çãredis ä¸ºäºé¿ååç¹æéï¼ä¹éè¦é¨ç½²å¤å°æºå¨ã\n\nå ä¸ºé¨ç½²äºå¤å°æºå¨ï¼æä»¥å°±ä¼æ¶åå°ä¸åæºå¨ççæ°æ®åæ­¥é®é¢ã\n\nä¸ºæ­¤ï¼redis æä¾äº Redis æä¾äºå¤å¶(replication)åè½ï¼å½ä¸å° redis æ°æ®åºä¸­çæ°æ®åçäºååï¼è¿ä¸ªååä¼è¢«èªå¨çåæ­¥å°å¶ä»ç redis æºå¨ä¸å»ã\n\nredis å¤æºå¨é¨ç½²æ¶ï¼è¿äºæºå¨èç¹ä¼è¢«åæä¸¤ç±»ï¼ä¸ç±»æ¯ä¸»èç¹ï¼master èç¹ï¼ï¼ä¸ç±»æ¯ä»èç¹ï¼slave èç¹ï¼ãä¸è¬ä¸»èç¹å¯ä»¥è¿è¡è¯»ãåæä½ï¼èä»èç¹åªè½è¿è¡è¯»æä½ãä¸ä¸ªä¸»èç¹å¯ä»¥æå¤ä¸ªä»èç¹ï¼ä½æ¯ä¸ä¸ªä»èç¹ä¼åªä¼æä¸ä¸ªä¸»èç¹ï¼ä¹å°±æ¯æè°çä¸ä¸»å¤ä»ç»æã\n\nä¸»èç¹æ­£å¸¸éç½®å³å¯ã\n\nä»èç¹éç½®ï¼\n\néç½®ä¸»èç¹çipåç«¯å£\nslaveof 192.168.1.10 6379\n# ä»redis2.6å¼å§ï¼ä»èç¹é»è®¤æ¯åªè¯»ç\nslave-read-only yes\n# åè®¾ä¸»èç¹æç»å½å¯ç ï¼æ¯123456\nmasterauth 123456\n\n\n * ä¹å¯ä»¥ä¸éç½®ä¸é¢çæä»¶ï¼ä½¿ç¨ redis-server å½ä»¤ï¼å¨å¯å¨ä»èç¹æ¶ï¼éè¿åæ°--slaveof æå®ä¸»èç¹æ¯è°./redis-server --slaveof 192.168.1.10 6379\n * ä¹å¯ä»¥ä¸éä¸é¢çæä»¶ï¼æ­£å¸¸å¯å¨ redis æºå¨ï¼ç¶åéè¿redis-cliçå½ä»¤è¡æ§è¡slaveof 192.168.1.10 6379æå®ä¸»èç¹æ¯è°ã\n\nç³»ç»è¿è¡æ¶ï¼å¦æ master ææäºï¼å¯ä»¥å¨ä¸ä¸ªä»åºï¼å¦ slave1ï¼ä¸æå¨æ§è¡å½ä»¤slaveof no oneï¼å° slave1 åææ°ç masterï¼å¨ slave2 å slave3 ä¸åå«æ§è¡slaveof 192.168.1.11 6379 å°è¿ä¸¤ä¸ªæºå¨çä¸»èç¹æåçè¿ä¸ªæ°ç masterï¼åæ¶ï¼ææçå master å¯å¨åä½ä¸ºæ°ç slave ä¹æåæ°ç master ä¸ã\n\næ§è¡å½ä»¤slaveof no oneå½ä»¤ï¼å¯ä»¥å³é­ä»æå¡å¨çå¤å¶åè½ãåæ¶åæ¥åæ­¥çæå¾çæ°æ®éé½ä¸ä¼è¢«ä¸¢å¼ã\n\nä¸»ä»å¤å¶è¿ç¨ï¼\n\n * ä»æ°æ®åºè¿æ¥ä¸»æ°æ®åºï¼åé SYNC å½ä»¤;\n\n * ä¸»æ°æ®åºæ¥æ¶å° SYNC å½ä»¤åï¼å¯ä»¥æ§è¡ BGSAVE å½ä»¤çæ RDB æä»¶å¹¶ä½¿ç¨ç¼å²åºè®°å½æ­¤åæ§è¡çææåå½ä»¤;\n\n * ä¸»æ°æ®åº BGSAVE æ§è¡å®åï¼åææä»æ°æ®åºåéå¿«ç§æä»¶ï¼å¹¶å¨åéæé´ç»§ç»­è®°å½è¢«æ§è¡çåå½ä»¤;\n\n * ä»æ°æ®åºæ¶å°å¿«ç§æä»¶åä¸¢å¼æææ§æ°æ®ï¼è½½å¥æ¶å°çå¿«ç§;\n\n * ä¸»æ°æ®åºå¿«ç§åéå®æ¯åå¼å§åä»æ°æ®åºåéç¼å²åºä¸­çåå½ä»¤;\n\n * ä»æ°æ®åºå®æå¯¹å¿«ç§çè½½å¥ï¼å¼å§æ¥åå½ä»¤è¯·æ±ï¼å¹¶æ§è¡æ¥èªä¸»æ°æ®åºç¼å²åºçåå½ä»¤;(ä»æ°æ®åºåå§åå®æ)\n\n * ä¸»æ°æ®åºæ¯æ§è¡ä¸ä¸ªåå½ä»¤å°±ä¼åä»æ°æ®åºåéç¸åçåå½ä»¤ï¼ä»æ°æ®åºæ¥æ¶å¹¶æ§è¡æ¶å°çåå½ä»¤(ä»æ°æ®åºåå§åå®æåçæä½)\n\n * åºç°æ­å¼éè¿åï¼2.8 ä¹åççæ¬ä¼å°æ­çº¿æé´çå½ä»¤ä¼ ç»ä»æ°æ®åºï¼å¢éå¤å¶ã\n\n * ä¸»ä»ååè¿æ¥çæ¶åï¼è¿è¡å¨éåæ­¥;å¨åæ­¥ç»æåï¼è¿è¡å¢éåæ­¥ãå½ç¶ï¼å¦ææéè¦ï¼slave å¨ä»»ä½æ¶åé½å¯ä»¥åèµ·å¨éåæ­¥ãRedis çç­ç¥æ¯ï¼æ è®ºå¦ä½ï¼é¦åä¼å°è¯è¿è¡å¢éåæ­¥ï¼å¦ä¸æåï¼è¦æ±ä»æºè¿è¡å¨éåæ­¥ã\n\n\n# å¨åµæ¨¡å¼\n\nsentinel\n\nä¸»ä»æ¨¡å¼ä¸ï¼å½ä¸»æå¡å¨å®æºåï¼éè¦æå¨æä¸å°ä»æå¡å¨åæ¢ä¸ºä¸»æå¡å¨ï¼è¿å°±éè¦äººå·¥å¹²é¢ï¼è´¹äºè´¹åï¼è¿ä¼é æä¸æ®µæ¶é´åæå¡ä¸å¯ç¨ãè¿ç§æ¹å¼å¹¶ä¸æ¨èï¼å®éçäº§ä¸­ï¼æä»¬ä¼åèèå¨åµæ¨¡å¼ãè¿ç§æ¨¡å¼ä¸ï¼master å®æºï¼å¨åµä¼èªå¨éä¸¾ master å¹¶å°å¶ä»ç slave æåæ°ç masterã\n\nå¨ä¸»ä»æ¨¡å¼ä¸ï¼redis åæ¶æä¾äºå¨åµå½ä»¤redis-sentinelï¼å¨åµæ¯ä¸ä¸ªç¬ç«çè¿ç¨ï¼ä½ä¸ºè¿ç¨ï¼å®ä¼ç¬ç«è¿è¡ãå¶åçæ¯å¨åµè¿ç¨åææç redis æºå¨åépingå½ä»¤ï¼ç­å¾ Redis æå¡å¨ååºï¼ä»èçæ§è¿è¡çå¤ä¸ª Redis å®ä¾ã\n\nå¨åµå¯ä»¥æå¤ä¸ªï¼ä¸è¬ä¸ºäºä¾¿äºå³ç­éä¸¾ï¼ä½¿ç¨å¥æ°ä¸ªå¨åµãå¨åµå¯ä»¥å redis æºå¨é¨ç½²å¨ä¸èµ·ï¼ä¹å¯ä»¥é¨ç½²å¨å¶ä»çæºå¨ä¸ãå¤ä¸ªå¨åµææä¸ä¸ªå¨åµéç¾¤ï¼å¨åµç´æ¥ä¹ä¼ç¸äºéä¿¡ï¼æ£æ¥å¨åµæ¯å¦æ­£å¸¸è¿è¡ï¼åæ¶åç° master å®æºå¨åµä¹é´ä¼è¿è¡å³ç­éä¸¾æ°ç masterã\n\nå¨åµéç½®æä»¶ï¼\n\n# ç¦æ­¢ä¿æ¤æ¨¡å¼\nprotected-mode no\n# éç½®çå¬çä¸»æå¡å¨ï¼è¿ésentinel monitorä»£è¡¨çæ§ï¼mymasterä»£è¡¨æå¡å¨çåç§°ï¼å¯ä»¥èªå®ä¹ï¼\n#192.168.1.10ä»£è¡¨çæ§çä¸»æå¡å¨ï¼6379ä»£è¡¨ç«¯å£ï¼2ä»£è¡¨åªæä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸çå¨åµè®¤ä¸ºä¸»æå¡å¨ä¸å¯ç¨çæ¶åï¼æä¼è¿è¡failoveræä½ã\nsentinel monitor mymaster 192.168.1.10 6379 2\n# sentinel author-passå®ä¹æå¡çå¯ç ï¼mymasteræ¯æå¡åç§°ï¼123456æ¯Redisæå¡å¨å¯ç \nsentinel auth-pass mymaster 123456\n\n\né¦åå¯å¨ä¸»èç¹ï¼ç¶åä¸å°ä¸å°å¯å¨ä»èç¹ã\n\nredis éç¾¤å¯å¨å®æåï¼åå«å¯å¨å¨åµéç¾¤æå¨æºå¨çä¸ä¸ªå¨åµï¼ä½¿ç¨redis-sentinel /path/to/sentinel.confå½ä»¤ã\n\nåè®¾ master å®æºï¼sentinel 1 åæ£æµå°è¿ä¸ªç»æï¼ç³»ç»å¹¶ä¸ä¼é©¬ä¸è¿è¡ failover(æéè½¬ç§»)éåºæ°ç masterï¼ä»ä»æ¯ sentinel 1 ä¸»è§çè®¤ä¸º master ä¸å¯ç¨ï¼è¿ä¸ªç°è±¡æä¸ºä¸»è§ä¸çº¿ãå½åé¢çå¨åµä¹æ£æµå°ä¸»æå¡å¨ä¸å¯ç¨ï¼å¹¶ä¸æ°éè¾¾å°ä¸å®å¼æ¶ï¼é£ä¹å¨åµä¹é´å°±ä¼è¿è¡ä¸æ¬¡æç¥¨ï¼æç¥¨çç»æç± sentinel 1 åèµ·ï¼è¿è¡ failover æä½ãåæ¢æååï¼å°±ä¼éè¿åå¸è®¢éæ¨¡å¼ï¼è®©åä¸ªå¨åµæèªå·±çæ§çä»æå¡å¨å®ç°åæ¢ä¸»æºï¼è¿ä¸ªè¿ç¨ç§°ä¸ºå®¢è§ä¸çº¿ãè¿æ ·å¯¹äºå®¢æ·ç«¯èè¨ï¼ä¸åé½æ¯éæçã\n\n\n# éç¾¤æ¨¡å¼\n\nRedis cluster\n\nredis éç¾¤æ¶ 3.0 çæ¬æåºç°çï¼åºç°çæ¯è¾æï¼å¨éç¾¤æ¨¡å¼åºç°ä¹åï¼å¾å¤å¬å¸é½åäºèªå·±ç redis éç¾¤äºãè¿äºèªç ç redis éç¾¤çå®ç°æ¹å¼æå¤ç§ï¼æ¯å¦å¨ redis ç jedis å®¢æ·ç«¯ jar åå°±æ¯å®ç°äºä¸è´æ§ hash ç®æ³ï¼å®¢æ·ç«¯æ¨¡å¼ï¼ï¼æèå¨ redis éç¾¤åé¢å ä¸ä¸å±åç½®ä»£çå¦ Twemproxy ä¹å®ç°äº hash ä¸è´æ§ç®æ³ï¼ä»£çæ¨¡å¼ï¼ãTwemproxyï¼æ¯ Twitter å¼æºåºæ¥ç Redis å Memcached ä»£çï¼ä½¿ç¨è¿ç§ä»£çæ¨¡å¼æ­å»ºçéç¾¤ï¼æä»¬çå®¢æ·ç«¯è¿æ¥åªéè¦è¿æ¥ä»£çæå¡å¨å³å¯ï¼ä¸ç¨è¿æ¥ä»£çåé¢å·ä½ç redis æºå¨ãTwemproxy å·ä½ä½¿ç¨åªä¸ç§ hash ç®æ³ä¹æ¯å¯ä»¥éè¿éç½®æä»¶æå®çã\n\nRedis çéç¾¤æ¨¡å¼æ¬èº«æ²¡æä½¿ç¨ä¸è´æ§ hash ç®æ³ï¼èæ¯ä½¿ç¨ slots ææ§½ã\n\nRedis çå¨åµæ¨¡å¼åºæ¬å·²ç»å¯ä»¥å®ç°é«å¯ç¨ï¼è¯»ååç¦» ï¼ä½æ¯å¨è¿ç§æ¨¡å¼ä¸æ¯å° Redis æå¡å¨é½å­å¨ç¸åçæ°æ®ï¼å¾æµªè´¹åå­ï¼æä»¥å¨ redis3.0 ä¸å å¥äº Cluster éç¾¤æ¨¡å¼ï¼å®ç°äº Redis çåå¸å¼å­å¨ï¼å¯¹æ°æ®è¿è¡åçï¼ä¹å°±æ¯è¯´æ¯å° Redis èç¹ä¸å­å¨ä¸åçåå®¹ï¼\n\nredis.config:\n\n# å¼å¯redisçéç¾¤æ¨¡å¼\ncluster-enabled yes\n# éç½®éç¾¤æ¨¡å¼ä¸çéç½®æä»¶åç§°åä½ç½®,redis-cluster.confè¿ä¸ªæä»¶æ¯éç¾¤å¯å¨åèªå¨çæçï¼ä¸éè¦æå¨éç½®ã\ncluster-config-file redis-cluster.conf\n\n\n6 ä¸ª Redis æå¡åå«å¯å¨æåä¹åï¼è¿æ¶è½ç¶éç½®äºéç¾¤å¼å¯ï¼ä½æ¯è¿å­å°æºå¨è¿æ¯ç¬ç«çãä½¿ç¨éç¾¤ç®¡çå½ä»¤å°è¿ 6 å°æºå¨æ·»å å°ä¸ä¸ªéç¾¤ä¸­ã\n\nåå© redis-tri.rb å·¥å·å¯ä»¥å¿«éçé¨ç½²éç¾¤ã\n\nåªéè¦æ§è¡redis-trib.rb create --replicas 1 192.168.1.11:6379 192.168.1.21:6379 192.168.1.12:6379 192.168.1.22:6379 192.168.1.13:6379 192.168.1.23:6379å°±å¯ä»¥æååå»ºéç¾¤ã\n\nè¿è¡æºå¶ï¼\n\nå¨ Redis çæ¯ä¸ä¸ªèç¹ä¸ï¼é½æè¿ä¹ä¸¤ä¸ªä¸è¥¿ï¼ä¸ä¸ªæ¯ææ§½ï¼slotï¼ï¼å®ççåå¼èå´æ¯ï¼0-16383ï¼å¯ä»¥ä»ä¸é¢redis-trib.rbæ§è¡çç»æçå°è¿ 16383 ä¸ª slot å¨ä¸ä¸ª master ä¸çåå¸ãè¿æä¸ä¸ªå°±æ¯ clusterï¼å¯ä»¥çè§£ä¸ºæ¯ä¸ä¸ªéç¾¤ç®¡ççæä»¶ï¼ç±»ä¼¼çå¨åµã\n\nå½æä»¬çå­åç Key å°è¾¾çæ¶åï¼Redis ä¼æ ¹æ® crc16 çç®æ³å¯¹è®¡ç®åå¾åºä¸ä¸ªç»æï¼ç¶åæç»æå 16384 æ±ä½æ°ï¼è¿æ ·æ¯ä¸ª key é½ä¼å¯¹åºä¸ä¸ªç¼å·å¨ 0-16383 ä¹é´çåå¸æ§½ï¼éè¿è¿ä¸ªå¼ï¼å»æ¾å°å¯¹åºçææ§½æå¯¹åºçèç¹ï¼ç¶åç´æ¥èªå¨è·³è½¬å°è¿ä¸ªå¯¹åºçèç¹ä¸è¿è¡å­åæä½ã\n\nå½æ°æ®åå¥å°å¯¹åºç master èç¹åï¼è¿ä¸ªæ°æ®ä¼åæ­¥ç»è¿ä¸ª master å¯¹åºçææ slave èç¹ã\n\nä¸ºäºä¿è¯é«å¯ç¨ï¼redis-cluster éç¾¤å¼å¥äºä¸»ä»æ¨¡å¼ï¼ä¸ä¸ªä¸»èç¹å¯¹åºä¸ä¸ªæèå¤ä¸ªä»èç¹ãå½å¶å®ä¸»èç¹ ping ä¸»èç¹ master 1 æ¶ï¼å¦æåæ°ä»¥ä¸çä¸»èç¹ä¸ master 1 éä¿¡è¶æ¶ï¼é£ä¹è®¤ä¸º master 1 å®æºäºï¼å°±ä¼å¯ç¨ master 1 çä»èç¹ slave 1ï¼å° slave 1 åæä¸»èç¹ç»§ç»­æä¾æå¡ã\n\nå¦æ master 1 åå®çä»èç¹ slave 1 é½å®æºäºï¼æ´ä¸ªéç¾¤å°±ä¼è¿å¥ fail ç¶æï¼å ä¸ºéç¾¤ç slot æ å°ä¸å®æ´ãå¦æéç¾¤è¶è¿åæ°ä»¥ä¸ç master ææï¼æ è®ºæ¯å¦æ slaveï¼éç¾¤é½ä¼è¿å¥ fail ç¶æã\n\nredis-cluster éç¨å»ä¸­å¿åçææ³ï¼æ²¡æä¸­å¿èç¹çè¯´æ³ï¼å®¢æ·ç«¯ä¸ Redis èç¹ç´è¿ï¼ä¸éè¦ä¸­é´ä»£çå±ï¼å®¢æ·ç«¯ä¸éè¦è¿æ¥éç¾¤ææèç¹ï¼è¿æ¥éç¾¤ä¸­ä»»ä½ä¸ä¸ªå¯ç¨èç¹å³å¯ã\n\n\n# æ»ç»\n\nä¸»ä»æ¨¡å¼ï¼master èç¹ææåï¼éè¦æå¨æå®æ°ç masterï¼å¯ç¨æ§ä¸é«ï¼åºæ¬ä¸ç¨ã\n\nå¨åµæ¨¡å¼ï¼master èç¹ææåï¼å¨åµè¿ç¨ä¼ä¸»å¨éä¸¾æ°ç masterï¼å¯ç¨æ§é«ï¼ä½æ¯æ¯ä¸ªèç¹å­å¨çæ°æ®æ¯ä¸æ ·çï¼æµªè´¹åå­ç©ºé´ãæ°æ®éä¸æ¯å¾å¤ï¼éç¾¤è§æ¨¡ä¸æ¯å¾å¤§ï¼éè¦èªå¨å®¹éå®¹ç¾çæ¶åä½¿ç¨ã\n\néç¾¤æ¨¡å¼ï¼æ°æ®éæ¯è¾å¤§ï¼QPS è¦æ±è¾é«çæ¶åä½¿ç¨ã Redis Cluster æ¯ Redis 3.0 ä»¥åææ­£å¼æ¨åºï¼æ¶é´è¾æï¼ç®åè½è¯æå¨å¤§è§æ¨¡çäº§ç¯å¢ä¸æåçæ¡ä¾è¿ä¸æ¯å¾å¤ï¼éè¦æ¶é´æ£éªã\n\nhttps://xie.infoq.cn/article/6c3500c66c3cdee3d72b88780\n\n\n# å¤§åç redis éç¾¤æ¹æ¡\n\n 1. ç±» codis æ¶æ\n 2. åºäºå®æ¹ redis cluster\n\nhttps://www.cnblogs.com/me115/p/9043420.html\n\nhttps://zhuanlan.zhihu.com/p/517257460",normalizedContent:"# ä¸»ä»æ¨¡å¼\n\nä¸è¬ï¼ç³»ç»çé«å¯ç¨é½æ¯éè¿é¨ç½²å¤å°æºå¨å®ç°çãredis ä¸ºäºé¿ååç¹æéï¼ä¹éè¦é¨ç½²å¤å°æºå¨ã\n\nå ä¸ºé¨ç½²äºå¤å°æºå¨ï¼æä»¥å°±ä¼æ¶åå°ä¸åæºå¨ççæ°æ®åæ­¥é®é¢ã\n\nä¸ºæ­¤ï¼redis æä¾äº redis æä¾äºå¤å¶(replication)åè½ï¼å½ä¸å° redis æ°æ®åºä¸­çæ°æ®åçäºååï¼è¿ä¸ªååä¼è¢«èªå¨çåæ­¥å°å¶ä»ç redis æºå¨ä¸å»ã\n\nredis å¤æºå¨é¨ç½²æ¶ï¼è¿äºæºå¨èç¹ä¼è¢«åæä¸¤ç±»ï¼ä¸ç±»æ¯ä¸»èç¹ï¼master èç¹ï¼ï¼ä¸ç±»æ¯ä»èç¹ï¼slave èç¹ï¼ãä¸è¬ä¸»èç¹å¯ä»¥è¿è¡è¯»ãåæä½ï¼èä»èç¹åªè½è¿è¡è¯»æä½ãä¸ä¸ªä¸»èç¹å¯ä»¥æå¤ä¸ªä»èç¹ï¼ä½æ¯ä¸ä¸ªä»èç¹ä¼åªä¼æä¸ä¸ªä¸»èç¹ï¼ä¹å°±æ¯æè°çä¸ä¸»å¤ä»ç»æã\n\nä¸»èç¹æ­£å¸¸éç½®å³å¯ã\n\nä»èç¹éç½®ï¼\n\néç½®ä¸»èç¹çipåç«¯å£\nslaveof 192.168.1.10 6379\n# ä»redis2.6å¼å§ï¼ä»èç¹é»è®¤æ¯åªè¯»ç\nslave-read-only yes\n# åè®¾ä¸»èç¹æç»å½å¯ç ï¼æ¯123456\nmasterauth 123456\n\n\n * ä¹å¯ä»¥ä¸éç½®ä¸é¢çæä»¶ï¼ä½¿ç¨ redis-server å½ä»¤ï¼å¨å¯å¨ä»èç¹æ¶ï¼éè¿åæ°--slaveof æå®ä¸»èç¹æ¯è°./redis-server --slaveof 192.168.1.10 6379\n * ä¹å¯ä»¥ä¸éä¸é¢çæä»¶ï¼æ­£å¸¸å¯å¨ redis æºå¨ï¼ç¶åéè¿redis-cliçå½ä»¤è¡æ§è¡slaveof 192.168.1.10 6379æå®ä¸»èç¹æ¯è°ã\n\nç³»ç»è¿è¡æ¶ï¼å¦æ master ææäºï¼å¯ä»¥å¨ä¸ä¸ªä»åºï¼å¦ slave1ï¼ä¸æå¨æ§è¡å½ä»¤slaveof no oneï¼å° slave1 åææ°ç masterï¼å¨ slave2 å slave3 ä¸åå«æ§è¡slaveof 192.168.1.11 6379 å°è¿ä¸¤ä¸ªæºå¨çä¸»èç¹æåçè¿ä¸ªæ°ç masterï¼åæ¶ï¼ææçå master å¯å¨åä½ä¸ºæ°ç slave ä¹æåæ°ç master ä¸ã\n\næ§è¡å½ä»¤slaveof no oneå½ä»¤ï¼å¯ä»¥å³é­ä»æå¡å¨çå¤å¶åè½ãåæ¶åæ¥åæ­¥çæå¾çæ°æ®éé½ä¸ä¼è¢«ä¸¢å¼ã\n\nä¸»ä»å¤å¶è¿ç¨ï¼\n\n * ä»æ°æ®åºè¿æ¥ä¸»æ°æ®åºï¼åé sync å½ä»¤;\n\n * ä¸»æ°æ®åºæ¥æ¶å° sync å½ä»¤åï¼å¯ä»¥æ§è¡ bgsave å½ä»¤çæ rdb æä»¶å¹¶ä½¿ç¨ç¼å²åºè®°å½æ­¤åæ§è¡çææåå½ä»¤;\n\n * ä¸»æ°æ®åº bgsave æ§è¡å®åï¼åææä»æ°æ®åºåéå¿«ç§æä»¶ï¼å¹¶å¨åéæé´ç»§ç»­è®°å½è¢«æ§è¡çåå½ä»¤;\n\n * ä»æ°æ®åºæ¶å°å¿«ç§æä»¶åä¸¢å¼æææ§æ°æ®ï¼è½½å¥æ¶å°çå¿«ç§;\n\n * ä¸»æ°æ®åºå¿«ç§åéå®æ¯åå¼å§åä»æ°æ®åºåéç¼å²åºä¸­çåå½ä»¤;\n\n * ä»æ°æ®åºå®æå¯¹å¿«ç§çè½½å¥ï¼å¼å§æ¥åå½ä»¤è¯·æ±ï¼å¹¶æ§è¡æ¥èªä¸»æ°æ®åºç¼å²åºçåå½ä»¤;(ä»æ°æ®åºåå§åå®æ)\n\n * ä¸»æ°æ®åºæ¯æ§è¡ä¸ä¸ªåå½ä»¤å°±ä¼åä»æ°æ®åºåéç¸åçåå½ä»¤ï¼ä»æ°æ®åºæ¥æ¶å¹¶æ§è¡æ¶å°çåå½ä»¤(ä»æ°æ®åºåå§åå®æåçæä½)\n\n * åºç°æ­å¼éè¿åï¼2.8 ä¹åççæ¬ä¼å°æ­çº¿æé´çå½ä»¤ä¼ ç»ä»æ°æ®åºï¼å¢éå¤å¶ã\n\n * ä¸»ä»ååè¿æ¥çæ¶åï¼è¿è¡å¨éåæ­¥;å¨åæ­¥ç»æåï¼è¿è¡å¢éåæ­¥ãå½ç¶ï¼å¦ææéè¦ï¼slave å¨ä»»ä½æ¶åé½å¯ä»¥åèµ·å¨éåæ­¥ãredis çç­ç¥æ¯ï¼æ è®ºå¦ä½ï¼é¦åä¼å°è¯è¿è¡å¢éåæ­¥ï¼å¦ä¸æåï¼è¦æ±ä»æºè¿è¡å¨éåæ­¥ã\n\n\n# å¨åµæ¨¡å¼\n\nsentinel\n\nä¸»ä»æ¨¡å¼ä¸ï¼å½ä¸»æå¡å¨å®æºåï¼éè¦æå¨æä¸å°ä»æå¡å¨åæ¢ä¸ºä¸»æå¡å¨ï¼è¿å°±éè¦äººå·¥å¹²é¢ï¼è´¹äºè´¹åï¼è¿ä¼é æä¸æ®µæ¶é´åæå¡ä¸å¯ç¨ãè¿ç§æ¹å¼å¹¶ä¸æ¨èï¼å®éçäº§ä¸­ï¼æä»¬ä¼åèèå¨åµæ¨¡å¼ãè¿ç§æ¨¡å¼ä¸ï¼master å®æºï¼å¨åµä¼èªå¨éä¸¾ master å¹¶å°å¶ä»ç slave æåæ°ç masterã\n\nå¨ä¸»ä»æ¨¡å¼ä¸ï¼redis åæ¶æä¾äºå¨åµå½ä»¤redis-sentinelï¼å¨åµæ¯ä¸ä¸ªç¬ç«çè¿ç¨ï¼ä½ä¸ºè¿ç¨ï¼å®ä¼ç¬ç«è¿è¡ãå¶åçæ¯å¨åµè¿ç¨åææç redis æºå¨åépingå½ä»¤ï¼ç­å¾ redis æå¡å¨ååºï¼ä»èçæ§è¿è¡çå¤ä¸ª redis å®ä¾ã\n\nå¨åµå¯ä»¥æå¤ä¸ªï¼ä¸è¬ä¸ºäºä¾¿äºå³ç­éä¸¾ï¼ä½¿ç¨å¥æ°ä¸ªå¨åµãå¨åµå¯ä»¥å redis æºå¨é¨ç½²å¨ä¸èµ·ï¼ä¹å¯ä»¥é¨ç½²å¨å¶ä»çæºå¨ä¸ãå¤ä¸ªå¨åµææä¸ä¸ªå¨åµéç¾¤ï¼å¨åµç´æ¥ä¹ä¼ç¸äºéä¿¡ï¼æ£æ¥å¨åµæ¯å¦æ­£å¸¸è¿è¡ï¼åæ¶åç° master å®æºå¨åµä¹é´ä¼è¿è¡å³ç­éä¸¾æ°ç masterã\n\nå¨åµéç½®æä»¶ï¼\n\n# ç¦æ­¢ä¿æ¤æ¨¡å¼\nprotected-mode no\n# éç½®çå¬çä¸»æå¡å¨ï¼è¿ésentinel monitorä»£è¡¨çæ§ï¼mymasterä»£è¡¨æå¡å¨çåç§°ï¼å¯ä»¥èªå®ä¹ï¼\n#192.168.1.10ä»£è¡¨çæ§çä¸»æå¡å¨ï¼6379ä»£è¡¨ç«¯å£ï¼2ä»£è¡¨åªæä¸¤ä¸ªæä¸¤ä¸ªä»¥ä¸çå¨åµè®¤ä¸ºä¸»æå¡å¨ä¸å¯ç¨çæ¶åï¼æä¼è¿è¡failoveræä½ã\nsentinel monitor mymaster 192.168.1.10 6379 2\n# sentinel author-passå®ä¹æå¡çå¯ç ï¼mymasteræ¯æå¡åç§°ï¼123456æ¯redisæå¡å¨å¯ç \nsentinel auth-pass mymaster 123456\n\n\né¦åå¯å¨ä¸»èç¹ï¼ç¶åä¸å°ä¸å°å¯å¨ä»èç¹ã\n\nredis éç¾¤å¯å¨å®æåï¼åå«å¯å¨å¨åµéç¾¤æå¨æºå¨çä¸ä¸ªå¨åµï¼ä½¿ç¨redis-sentinel /path/to/sentinel.confå½ä»¤ã\n\nåè®¾ master å®æºï¼sentinel 1 åæ£æµå°è¿ä¸ªç»æï¼ç³»ç»å¹¶ä¸ä¼é©¬ä¸è¿è¡ failover(æéè½¬ç§»)éåºæ°ç masterï¼ä»ä»æ¯ sentinel 1 ä¸»è§çè®¤ä¸º master ä¸å¯ç¨ï¼è¿ä¸ªç°è±¡æä¸ºä¸»è§ä¸çº¿ãå½åé¢çå¨åµä¹æ£æµå°ä¸»æå¡å¨ä¸å¯ç¨ï¼å¹¶ä¸æ°éè¾¾å°ä¸å®å¼æ¶ï¼é£ä¹å¨åµä¹é´å°±ä¼è¿è¡ä¸æ¬¡æç¥¨ï¼æç¥¨çç»æç± sentinel 1 åèµ·ï¼è¿è¡ failover æä½ãåæ¢æååï¼å°±ä¼éè¿åå¸è®¢éæ¨¡å¼ï¼è®©åä¸ªå¨åµæèªå·±çæ§çä»æå¡å¨å®ç°åæ¢ä¸»æºï¼è¿ä¸ªè¿ç¨ç§°ä¸ºå®¢è§ä¸çº¿ãè¿æ ·å¯¹äºå®¢æ·ç«¯èè¨ï¼ä¸åé½æ¯éæçã\n\n\n# éç¾¤æ¨¡å¼\n\nredis cluster\n\nredis éç¾¤æ¶ 3.0 çæ¬æåºç°çï¼åºç°çæ¯è¾æï¼å¨éç¾¤æ¨¡å¼åºç°ä¹åï¼å¾å¤å¬å¸é½åäºèªå·±ç redis éç¾¤äºãè¿äºèªç ç redis éç¾¤çå®ç°æ¹å¼æå¤ç§ï¼æ¯å¦å¨ redis ç jedis å®¢æ·ç«¯ jar åå°±æ¯å®ç°äºä¸è´æ§ hash ç®æ³ï¼å®¢æ·ç«¯æ¨¡å¼ï¼ï¼æèå¨ redis éç¾¤åé¢å ä¸ä¸å±åç½®ä»£çå¦ twemproxy ä¹å®ç°äº hash ä¸è´æ§ç®æ³ï¼ä»£çæ¨¡å¼ï¼ãtwemproxyï¼æ¯ twitter å¼æºåºæ¥ç redis å memcached ä»£çï¼ä½¿ç¨è¿ç§ä»£çæ¨¡å¼æ­å»ºçéç¾¤ï¼æä»¬çå®¢æ·ç«¯è¿æ¥åªéè¦è¿æ¥ä»£çæå¡å¨å³å¯ï¼ä¸ç¨è¿æ¥ä»£çåé¢å·ä½ç redis æºå¨ãtwemproxy å·ä½ä½¿ç¨åªä¸ç§ hash ç®æ³ä¹æ¯å¯ä»¥éè¿éç½®æä»¶æå®çã\n\nredis çéç¾¤æ¨¡å¼æ¬èº«æ²¡æä½¿ç¨ä¸è´æ§ hash ç®æ³ï¼èæ¯ä½¿ç¨ slots ææ§½ã\n\nredis çå¨åµæ¨¡å¼åºæ¬å·²ç»å¯ä»¥å®ç°é«å¯ç¨ï¼è¯»ååç¦» ï¼ä½æ¯å¨è¿ç§æ¨¡å¼ä¸æ¯å° redis æå¡å¨é½å­å¨ç¸åçæ°æ®ï¼å¾æµªè´¹åå­ï¼æä»¥å¨ redis3.0 ä¸å å¥äº cluster éç¾¤æ¨¡å¼ï¼å®ç°äº redis çåå¸å¼å­å¨ï¼å¯¹æ°æ®è¿è¡åçï¼ä¹å°±æ¯è¯´æ¯å° redis èç¹ä¸å­å¨ä¸åçåå®¹ï¼\n\nredis.config:\n\n# å¼å¯redisçéç¾¤æ¨¡å¼\ncluster-enabled yes\n# éç½®éç¾¤æ¨¡å¼ä¸çéç½®æä»¶åç§°åä½ç½®,redis-cluster.confè¿ä¸ªæä»¶æ¯éç¾¤å¯å¨åèªå¨çæçï¼ä¸éè¦æå¨éç½®ã\ncluster-config-file redis-cluster.conf\n\n\n6 ä¸ª redis æå¡åå«å¯å¨æåä¹åï¼è¿æ¶è½ç¶éç½®äºéç¾¤å¼å¯ï¼ä½æ¯è¿å­å°æºå¨è¿æ¯ç¬ç«çãä½¿ç¨éç¾¤ç®¡çå½ä»¤å°è¿ 6 å°æºå¨æ·»å å°ä¸ä¸ªéç¾¤ä¸­ã\n\nåå© redis-tri.rb å·¥å·å¯ä»¥å¿«éçé¨ç½²éç¾¤ã\n\nåªéè¦æ§è¡redis-trib.rb create --replicas 1 192.168.1.11:6379 192.168.1.21:6379 192.168.1.12:6379 192.168.1.22:6379 192.168.1.13:6379 192.168.1.23:6379å°±å¯ä»¥æååå»ºéç¾¤ã\n\nè¿è¡æºå¶ï¼\n\nå¨ redis çæ¯ä¸ä¸ªèç¹ä¸ï¼é½æè¿ä¹ä¸¤ä¸ªä¸è¥¿ï¼ä¸ä¸ªæ¯ææ§½ï¼slotï¼ï¼å®ççåå¼èå´æ¯ï¼0-16383ï¼å¯ä»¥ä»ä¸é¢redis-trib.rbæ§è¡çç»æçå°è¿ 16383 ä¸ª slot å¨ä¸ä¸ª master ä¸çåå¸ãè¿æä¸ä¸ªå°±æ¯ clusterï¼å¯ä»¥çè§£ä¸ºæ¯ä¸ä¸ªéç¾¤ç®¡ççæä»¶ï¼ç±»ä¼¼çå¨åµã\n\nå½æä»¬çå­åç key å°è¾¾çæ¶åï¼redis ä¼æ ¹æ® crc16 çç®æ³å¯¹è®¡ç®åå¾åºä¸ä¸ªç»æï¼ç¶åæç»æå 16384 æ±ä½æ°ï¼è¿æ ·æ¯ä¸ª key é½ä¼å¯¹åºä¸ä¸ªç¼å·å¨ 0-16383 ä¹é´çåå¸æ§½ï¼éè¿è¿ä¸ªå¼ï¼å»æ¾å°å¯¹åºçææ§½æå¯¹åºçèç¹ï¼ç¶åç´æ¥èªå¨è·³è½¬å°è¿ä¸ªå¯¹åºçèç¹ä¸è¿è¡å­åæä½ã\n\nå½æ°æ®åå¥å°å¯¹åºç master èç¹åï¼è¿ä¸ªæ°æ®ä¼åæ­¥ç»è¿ä¸ª master å¯¹åºçææ slave èç¹ã\n\nä¸ºäºä¿è¯é«å¯ç¨ï¼redis-cluster éç¾¤å¼å¥äºä¸»ä»æ¨¡å¼ï¼ä¸ä¸ªä¸»èç¹å¯¹åºä¸ä¸ªæèå¤ä¸ªä»èç¹ãå½å¶å®ä¸»èç¹ ping ä¸»èç¹ master 1 æ¶ï¼å¦æåæ°ä»¥ä¸çä¸»èç¹ä¸ master 1 éä¿¡è¶æ¶ï¼é£ä¹è®¤ä¸º master 1 å®æºäºï¼å°±ä¼å¯ç¨ master 1 çä»èç¹ slave 1ï¼å° slave 1 åæä¸»èç¹ç»§ç»­æä¾æå¡ã\n\nå¦æ master 1 åå®çä»èç¹ slave 1 é½å®æºäºï¼æ´ä¸ªéç¾¤å°±ä¼è¿å¥ fail ç¶æï¼å ä¸ºéç¾¤ç slot æ å°ä¸å®æ´ãå¦æéç¾¤è¶è¿åæ°ä»¥ä¸ç master ææï¼æ è®ºæ¯å¦æ slaveï¼éç¾¤é½ä¼è¿å¥ fail ç¶æã\n\nredis-cluster éç¨å»ä¸­å¿åçææ³ï¼æ²¡æä¸­å¿èç¹çè¯´æ³ï¼å®¢æ·ç«¯ä¸ redis èç¹ç´è¿ï¼ä¸éè¦ä¸­é´ä»£çå±ï¼å®¢æ·ç«¯ä¸éè¦è¿æ¥éç¾¤ææèç¹ï¼è¿æ¥éç¾¤ä¸­ä»»ä½ä¸ä¸ªå¯ç¨èç¹å³å¯ã\n\n\n# æ»ç»\n\nä¸»ä»æ¨¡å¼ï¼master èç¹ææåï¼éè¦æå¨æå®æ°ç masterï¼å¯ç¨æ§ä¸é«ï¼åºæ¬ä¸ç¨ã\n\nå¨åµæ¨¡å¼ï¼master èç¹ææåï¼å¨åµè¿ç¨ä¼ä¸»å¨éä¸¾æ°ç masterï¼å¯ç¨æ§é«ï¼ä½æ¯æ¯ä¸ªèç¹å­å¨çæ°æ®æ¯ä¸æ ·çï¼æµªè´¹åå­ç©ºé´ãæ°æ®éä¸æ¯å¾å¤ï¼éç¾¤è§æ¨¡ä¸æ¯å¾å¤§ï¼éè¦èªå¨å®¹éå®¹ç¾çæ¶åä½¿ç¨ã\n\néç¾¤æ¨¡å¼ï¼æ°æ®éæ¯è¾å¤§ï¼qps è¦æ±è¾é«çæ¶åä½¿ç¨ã redis cluster æ¯ redis 3.0 ä»¥åææ­£å¼æ¨åºï¼æ¶é´è¾æï¼ç®åè½è¯æå¨å¤§è§æ¨¡çäº§ç¯å¢ä¸æåçæ¡ä¾è¿ä¸æ¯å¾å¤ï¼éè¦æ¶é´æ£éªã\n\nhttps://xie.infoq.cn/article/6c3500c66c3cdee3d72b88780\n\n\n# å¤§åç redis éç¾¤æ¹æ¡\n\n 1. ç±» codis æ¶æ\n 2. åºäºå®æ¹ redis cluster\n\nhttps://www.cnblogs.com/me115/p/9043420.html\n\nhttps://zhuanlan.zhihu.com/p/517257460",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Rediså é¤ç­ç¥ååå­æ·æ±°æºå¶",frontmatter:{title:"Rediså é¤ç­ç¥ååå­æ·æ±°æºå¶",date:"2023-03-17T21:52:31.000Z",permalink:"/pages/428106/"},regularPath:"/03.Redis/07.redis%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%E5%8F%8A%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E6%9C%BA%E5%88%B6.html",relativePath:"03.Redis/07.rediså é¤ç­ç¥ååå­æ·æ±°æºå¶.md",key:"v-0082735a",path:"/pages/428106/",headersStr:null,content:"Redis éç¨çæ¯ å®æå é¤+æ°æ§/ææ±å¼å é¤\n\n 1. æ°æ§å é¤ ï¼åªä¼å¨ååº key çæ¶åæå¯¹æ°æ®è¿è¡è¿ææ£æ¥ãè¿æ ·å¯¹ CPU æåå¥½ï¼ä½æ¯å¯è½ä¼é æå¤ªå¤è¿æ key æ²¡æè¢«å é¤ã\n 2. å®æå é¤ ï¼ æ¯éä¸æ®µæ¶é´æ½åä¸æ¹ key æ§è¡å é¤è¿æ key æä½ãå¹¶ä¸ï¼Redis åºå±ä¼éè¿éå¶å é¤æä½æ§è¡çæ¶é¿åé¢çæ¥åå°å é¤æä½å¯¹ CPU æ¶é´çå½±åã\n\nä½æ¯ï¼ä»ä»éè¿ç» key è®¾ç½®è¿ææ¶é´è¿æ¯æé®é¢çãå ä¸ºè¿æ¯å¯è½å­å¨å®æå é¤åæ°æ§å é¤æ¼æäºå¾å¤è¿æ key çæåµãè¿æ ·å°±å¯¼è´å¤§éè¿æ key å ç§¯å¨åå­éï¼ç¶åå°± Out of memory äºã\n\næä¹è§£å³è¿ä¸ªé®é¢å¢ï¼ç­æ¡å°±æ¯ï¼Redis åå­æ·æ±°æºå¶ã\n\nRedis æä¾ 6 ç§æ°æ®æ·æ±°ç­ç¥ï¼\n\n 1. volatile-lruï¼least recently usedï¼ï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n 2. volatile-ttlï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéå°è¦è¿æçæ°æ®æ·æ±°\n 3. volatile-randomï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­ä»»æéæ©æ°æ®æ·æ±°\n 4. allkeys-lruï¼least recently usedï¼ï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªæ¯æå¸¸ç¨çï¼\n 5. allkeys-randomï¼ä»æ°æ®éï¼server.db[i].dictï¼ä¸­ä»»æéæ©æ°æ®æ·æ±°\n 6. no-evictionï¼é»è®¤ç­ç¥ï¼ï¼ç¦æ­¢é©±éæ°æ®ï¼ä¹å°±æ¯è¯´å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼æ°åå¥æä½ä¼æ¥éãè¿ä¸ªåºè¯¥æ²¡äººä½¿ç¨å§ï¼\n\n4.0 çæ¬åå¢å ä»¥ä¸ä¸¤ç§ï¼\n\n 1. volatile-lfuï¼least frequently usedï¼ï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéæä¸ç»å¸¸ä½¿ç¨çæ°æ®æ·æ±°\n 2. allkeys-lfuï¼least frequently usedï¼ï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æä¸ç»å¸¸ä½¿ç¨ç key",normalizedContent:"redis éç¨çæ¯ å®æå é¤+æ°æ§/ææ±å¼å é¤\n\n 1. æ°æ§å é¤ ï¼åªä¼å¨ååº key çæ¶åæå¯¹æ°æ®è¿è¡è¿ææ£æ¥ãè¿æ ·å¯¹ cpu æåå¥½ï¼ä½æ¯å¯è½ä¼é æå¤ªå¤è¿æ key æ²¡æè¢«å é¤ã\n 2. å®æå é¤ ï¼ æ¯éä¸æ®µæ¶é´æ½åä¸æ¹ key æ§è¡å é¤è¿æ key æä½ãå¹¶ä¸ï¼redis åºå±ä¼éè¿éå¶å é¤æä½æ§è¡çæ¶é¿åé¢çæ¥åå°å é¤æä½å¯¹ cpu æ¶é´çå½±åã\n\nä½æ¯ï¼ä»ä»éè¿ç» key è®¾ç½®è¿ææ¶é´è¿æ¯æé®é¢çãå ä¸ºè¿æ¯å¯è½å­å¨å®æå é¤åæ°æ§å é¤æ¼æäºå¾å¤è¿æ key çæåµãè¿æ ·å°±å¯¼è´å¤§éè¿æ key å ç§¯å¨åå­éï¼ç¶åå°± out of memory äºã\n\næä¹è§£å³è¿ä¸ªé®é¢å¢ï¼ç­æ¡å°±æ¯ï¼redis åå­æ·æ±°æºå¶ã\n\nredis æä¾ 6 ç§æ°æ®æ·æ±°ç­ç¥ï¼\n\n 1. volatile-lruï¼least recently usedï¼ï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n 2. volatile-ttlï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéå°è¦è¿æçæ°æ®æ·æ±°\n 3. volatile-randomï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­ä»»æéæ©æ°æ®æ·æ±°\n 4. allkeys-lruï¼least recently usedï¼ï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æè¿æå°ä½¿ç¨ç keyï¼è¿ä¸ªæ¯æå¸¸ç¨çï¼\n 5. allkeys-randomï¼ä»æ°æ®éï¼server.db[i].dictï¼ä¸­ä»»æéæ©æ°æ®æ·æ±°\n 6. no-evictionï¼é»è®¤ç­ç¥ï¼ï¼ç¦æ­¢é©±éæ°æ®ï¼ä¹å°±æ¯è¯´å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼æ°åå¥æä½ä¼æ¥éãè¿ä¸ªåºè¯¥æ²¡äººä½¿ç¨å§ï¼\n\n4.0 çæ¬åå¢å ä»¥ä¸ä¸¤ç§ï¼\n\n 1. volatile-lfuï¼least frequently usedï¼ï¼ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éï¼server.db[i].expiresï¼ä¸­æéæä¸ç»å¸¸ä½¿ç¨çæ°æ®æ·æ±°\n 2. allkeys-lfuï¼least frequently usedï¼ï¼å½åå­ä¸è¶³ä»¥å®¹çº³æ°åå¥æ°æ®æ¶ï¼å¨é®ç©ºé´ä¸­ï¼ç§»é¤æä¸ç»å¸¸ä½¿ç¨ç key",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ç¼å­å¸¸è§é®é¢",frontmatter:{title:"ç¼å­å¸¸è§é®é¢",date:"2023-03-17T21:54:33.000Z",permalink:"/pages/87b330/"},regularPath:"/03.Redis/08.%E7%BC%93%E5%AD%98%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html",relativePath:"03.Redis/08.ç¼å­å¸¸è§é®é¢.md",key:"v-669c40a0",path:"/pages/87b330/",headers:[{level:2,title:"ç¼å­ç©¿é",slug:"ç¼å­ç©¿é",normalizedTitle:"ç¼å­ç©¿é",charIndex:2},{level:2,title:"ç¼å­éªå´©",slug:"ç¼å­éªå´©",normalizedTitle:"ç¼å­éªå´©",charIndex:381},{level:2,title:"ç¼å­å»ç©¿",slug:"ç¼å­å»ç©¿",normalizedTitle:"ç¼å­å»ç©¿",charIndex:929},{level:2,title:"ç¼å­é¢ç­",slug:"ç¼å­é¢ç­",normalizedTitle:"ç¼å­é¢ç­",charIndex:1248},{level:2,title:"ç¼å­éçº§",slug:"ç¼å­éçº§",normalizedTitle:"ç¼å­éçº§",charIndex:1415}],headersStr:"ç¼å­ç©¿é ç¼å­éªå´© ç¼å­å»ç©¿ ç¼å­é¢ç­ ç¼å­éçº§",content:"# ç¼å­ç©¿é\n\nç¼å­ç©¿éæ¯ææ¥è¯¢ä¸ä¸ªä¸å­å¨çæ°æ®ï¼ç±äºç¼å­æ¯ä¸å½ä¸­æ¶è¢«å¨åçï¼å¦æä»DBæ¥ä¸å°æ°æ®åä¸åå¥ç¼å­ï¼è¿å°å¯¼è´è¿ä¸ªä¸å­å¨çæ°æ®æ¯æ¬¡è¯·æ±é½è¦å°DBå»æ¥è¯¢ï¼å¤±å»äºç¼å­çæä¹ãå¨æµéå¤§æ¶ï¼å¯è½DBå°±ææäºã\n\nè§£å³æ¹æ¡ï¼\n\n 1. ç¼å­ç©ºå¼ï¼ä¸ä¼æ¥æ°æ®åºã\n 2. éç¨å¸éè¿æ»¤å¨ï¼å°ææå¯è½å­å¨çæ°æ®åå¸å°ä¸ä¸ªè¶³å¤å¤§çbitmapä¸­ï¼æ¥è¯¢ä¸å­å¨çæ°æ®ä¼è¢«è¿ä¸ªbitmapæ¦æªæï¼ä»èé¿åäºå¯¹DBçæ¥è¯¢ååã\n\nå¸éè¿æ»¤å¨çåçï¼å½ä¸ä¸ªåç´ è¢«å å¥éåæ¶ï¼éè¿Kä¸ªåå¸å½æ°å°è¿ä¸ªåç´ æ å°æä¸ä¸ªä½æ°ç»ä¸­çKä¸ªç¹ï¼æå®ä»¬ç½®ä¸º1ãæ¥è¯¢æ¶ï¼å°åç´ éè¿åå¸å½æ°æ å°ä¹åä¼å¾å°kä¸ªç¹ï¼å¦æè¿äºç¹æä»»ä½ä¸ä¸ª0ï¼åè¢«æ£åç´ ä¸å®ä¸å¨ï¼ç´æ¥è¿åï¼å¦æé½æ¯1ï¼åæ¥è¯¢åç´ å¾å¯è½å­å¨ï¼å°±ä¼å»æ¥è¯¢Redisåæ°æ®åºã\n\nå¸éè¿æ»¤å¨ä¸è¬ç¨äºå¨å¤§æ°æ®éçéåä¸­å¤å®æåç´ æ¯å¦å­å¨ã\n\n\n# ç¼å­éªå´©\n\nç¼å­éªå´©æï¼ç¼å­å¨åä¸æ¶é´å¤§é¢ç§¯çå¤±æï¼åé¢çè¯·æ±é½ç´æ¥è½å°äºæ°æ®åºä¸ï¼é ææ°æ®åºç­æ¶é´åæ¿åå¤§éè¯·æ±ã\n\nå­å¨ä¸¤ç§å¯è½ï¼\n\n * ç³»ç»ç¼å­æ¨¡ååºé®é¢ï¼å®æºä¸å¯ç¨ã\n * å¤§éè®¿é®æ°æ®ï¼ç­ç¹ç¼å­ï¼å¨æä¸æ¶å»å¤§é¢ç§¯å¤±æ\n\nè§£å³æ¹æ¡ï¼\n\néå¯¹ Redis æå¡ä¸å¯ç¨çæåµï¼\n\n 1. éç¨ Redis éç¾¤ï¼é¿ååæºåºç°é®é¢æ´ä¸ªç¼å­æå¡é½æ²¡åæ³ä½¿ç¨ãä¿è¯é«å¯ç¨ï¼redis sentinelãredis clusterã\n 2. éæµï¼é¿ååæ¶å¤çå¤§éçè¯·æ±ãéæµçæ­éçº§ï¼sentinelãhystrixã\n 3. å éæéå¯ä»¥èµ·å°ç¼å²çä½ç¨ï¼é²æ­¢å¤§éçè¯·æ±åæ¶æä½æ°æ®åºï¼ä½å®çç¼ºç¹æ¯å¢å äºç³»ç»çååºæ¶é´ï¼éä½äºç³»ç»çååéï¼çºç²äºä¸é¨åç¨æ·ä½éªãå½ç¼å­æªæ¥è¯¢å°æ¶ï¼å¯¹è¦è¯·æ±ç key è¿è¡å éï¼åªåè®¸ä¸ä¸ªçº¿ç¨å»æ°æ®åºä¸­æ¥ï¼å¶ä»çº¿ç¨ç­åæéã\n 4. è®¾ç½®äºçº§ç¼å­ãäºçº§ç¼å­æçæ¯é¤äº Redis æ¬èº«çç¼å­ï¼åè®¾ç½®ä¸å±ç¼å­ï¼å½ Redis å¤±æä¹åï¼åå»æ¥è¯¢äºçº§ç¼å­ãä¾å¦å¯ä»¥è®¾ç½®ä¸ä¸ªæ¬å°ç¼å­ï¼å¨ Redis ç¼å­å¤±æçæ¶ååå»æ¥è¯¢æ¬å°ç¼å­èéæ¥è¯¢æ°æ®åºã\n\néå¯¹ç­ç¹ç¼å­å¤±æçæåµï¼\n\n 1. è®¾ç½®ä¸åçå¤±ææ¶é´æ¯å¦éæºè®¾ç½®ç¼å­çå¤±ææ¶é´ã\n 2. ç­ç¹ç¼å­æ°¸ä¸å¤±æã\n\n\n# ç¼å­å»ç©¿\n\nç¼å­å»ç©¿ï¼å¤§éçè¯·æ±åæ¶æ¥è¯¢ä¸ä¸ª key æ¶ï¼æ­¤æ¶è¿ä¸ª key æ­£å¥½å¤±æäºï¼å°±ä¼å¯¼è´å¤§éçè¯·æ±é½è½å°æ°æ®åºãç¼å­å»ç©¿æ¯æ¥è¯¢ç¼å­ä¸­å¤±æç keyï¼èç¼å­ç©¿éæ¯æ¥è¯¢ä¸å­å¨ç keyã\n\nè§£å³æ¹æ¡ï¼\n\n1ãå äºæ¥éãå¨å¹¶åçå¤ä¸ªè¯·æ±ä¸­ï¼åªæç¬¬ä¸ä¸ªè¯·æ±çº¿ç¨è½æ¿å°éå¹¶æ§è¡æ°æ®åºæ¥è¯¢æä½ï¼å¶ä»ççº¿ç¨æ¿ä¸å°éå°±é»å¡ç­çï¼ç­å°ç¬¬ä¸ä¸ªçº¿ç¨å°æ°æ®åå¥ç¼å­åï¼ç´æ¥èµ°ç¼å­ãå¯ä»¥ä½¿ç¨Redisåå¸å¼éå®ç°ã\n\n2ãç­ç¹æ°æ®ä¸è¿æãç´æ¥å°ç¼å­è®¾ç½®ä¸ºä¸è¿æï¼ç¶åç±å®æ¶ä»»å¡å»å¼æ­¥å è½½æ°æ®ï¼æ´æ°ç¼å­ãè¿ç§æ¹å¼éç¨äºæ¯è¾æç«¯çåºæ¯ï¼ä¾å¦æµéç¹å«ç¹å«å¤§çåºæ¯ï¼ä½¿ç¨æ¶éè¦èèä¸å¡è½æ¥åæ°æ®ä¸ä¸è´çæ¶é´ï¼è¿æå°±æ¯å¼å¸¸æåµçå¤çï¼ä¿è¯ç¼å­å¯ä»¥å®æ¶å·æ°ã\n\n\n# ç¼å­é¢ç­\n\nç¼å­é¢ç­å°±æ¯ç³»ç»ä¸çº¿åï¼å°ç¸å³çç¼å­æ°æ®ç´æ¥å è½½å°ç¼å­ç³»ç»ãè¿æ ·å°±å¯ä»¥é¿åå¨ç¨æ·è¯·æ±çæ¶åï¼åæ¥è¯¢æ°æ®åºï¼ç¶ååå°æ°æ®ç¼å­çé®é¢ï¼ç¨æ·ç´æ¥æ¥è¯¢äºåè¢«é¢ç­çç¼å­æ°æ®ã\n\nè§£å³æ¹æ¡ï¼\n\n 1. ç´æ¥åä¸ªç¼å­å·æ°é¡µé¢ï¼ä¸çº¿æ¶æå·¥æä½ä¸ä¸ï¼\n 2. æ°æ®éä¸å¤§ï¼å¯ä»¥å¨é¡¹ç®å¯å¨çæ¶åèªå¨è¿è¡å è½½ï¼\n 3. å®æ¶å·æ°ç¼å­ï¼\n\n\n# ç¼å­éçº§\n\nå½è®¿é®éå§å¢ãæå¡åºç°é®é¢ï¼å¦ååºæ¶é´æ¢æä¸ååºï¼æéæ ¸å¿æå¡å½±åå°æ ¸å¿æµç¨çæ§è½æ¶ï¼å³ä½¿æ¯æææå¡ï¼ç³»ç»å¯ä»¥æ ¹æ®ä¸äºå³é®æ°æ®è¿è¡èªå¨éçº§ï¼ä¹å¯ä»¥éç½®å¼å³å®ç°äººå·¥éçº§ã\n\nç¼å­éçº§çæç»ç®çæ¯ä¿è¯æ ¸å¿æå¡å¯ç¨ï¼å³ä½¿æ¯ææçãèä¸æäºæå¡æ¯æ æ³éçº§çï¼å¦å å¥è´­ç©è½¦ãç»ç®ï¼ã\n\nå¨è¿è¡éçº§ä¹åè¦å¯¹ç³»ç»è¿è¡æ¢³çï¼ççç³»ç»æ¯ä¸æ¯å¯ä»¥ä¸¢åä¿å¸ï¼ä»èæ¢³çåºåªäºå¿é¡»èªæ­»ä¿æ¤ï¼åªäºå¯éçº§ï¼æ¯å¦å¯ä»¥åèæ¥å¿çº§å«è®¾ç½®é¢æ¡ï¼\n\n 1. ä¸è¬ï¼æ¯å¦æäºæå¡å¶å°å ä¸ºç½ç»æå¨æèæå¡æ­£å¨ä¸çº¿èè¶æ¶ï¼å¯ä»¥èªå¨éçº§ï¼\n 2. è­¦åï¼æäºæå¡å¨ä¸æ®µæ¶é´åæåçææ³¢å¨ï¼å¦å¨95~100%ä¹é´ï¼ï¼å¯ä»¥èªå¨éçº§æäººå·¥éçº§ï¼å¹¶åéåè­¦ï¼\n 3. éè¯¯ï¼æ¯å¦å¯ç¨çä½äº90%ï¼æèæ°æ®åºè¿æ¥æ± è¢«æçäºï¼æèè®¿é®éçªç¶çå¢å°ç³»ç»è½æ¿åçæå¤§éå¼ï¼æ­¤æ¶å¯ä»¥æ ¹æ®æåµèªå¨éçº§æèäººå·¥éçº§ï¼\n 4. ä¸¥ééè¯¯ï¼æ¯å¦å ä¸ºç¹æ®åå æ°æ®éè¯¯äºï¼æ­¤æ¶éè¦ç´§æ¥äººå·¥éçº§ã\n\næå¡éçº§çç®çï¼æ¯ä¸ºäºé²æ­¢Redisæå¡æéï¼å¯¼è´æ°æ®åºè·çä¸èµ·åçéªå´©é®é¢ãå æ­¤ï¼å¯¹äºä¸éè¦çç¼å­æ°æ®ï¼å¯ä»¥éåæå¡éçº§ç­ç¥ï¼ä¾å¦ä¸ä¸ªæ¯è¾å¸¸è§çåæ³å°±æ¯ï¼Redisåºç°é®é¢ï¼ä¸å»æ°æ®åºæ¥è¯¢ï¼èæ¯ç´æ¥è¿åé»è®¤å¼ç»ç¨æ·ã",normalizedContent:"# ç¼å­ç©¿é\n\nç¼å­ç©¿éæ¯ææ¥è¯¢ä¸ä¸ªä¸å­å¨çæ°æ®ï¼ç±äºç¼å­æ¯ä¸å½ä¸­æ¶è¢«å¨åçï¼å¦æä»dbæ¥ä¸å°æ°æ®åä¸åå¥ç¼å­ï¼è¿å°å¯¼è´è¿ä¸ªä¸å­å¨çæ°æ®æ¯æ¬¡è¯·æ±é½è¦å°dbå»æ¥è¯¢ï¼å¤±å»äºç¼å­çæä¹ãå¨æµéå¤§æ¶ï¼å¯è½dbå°±ææäºã\n\nè§£å³æ¹æ¡ï¼\n\n 1. ç¼å­ç©ºå¼ï¼ä¸ä¼æ¥æ°æ®åºã\n 2. éç¨å¸éè¿æ»¤å¨ï¼å°ææå¯è½å­å¨çæ°æ®åå¸å°ä¸ä¸ªè¶³å¤å¤§çbitmapä¸­ï¼æ¥è¯¢ä¸å­å¨çæ°æ®ä¼è¢«è¿ä¸ªbitmapæ¦æªæï¼ä»èé¿åäºå¯¹dbçæ¥è¯¢ååã\n\nå¸éè¿æ»¤å¨çåçï¼å½ä¸ä¸ªåç´ è¢«å å¥éåæ¶ï¼éè¿kä¸ªåå¸å½æ°å°è¿ä¸ªåç´ æ å°æä¸ä¸ªä½æ°ç»ä¸­çkä¸ªç¹ï¼æå®ä»¬ç½®ä¸º1ãæ¥è¯¢æ¶ï¼å°åç´ éè¿åå¸å½æ°æ å°ä¹åä¼å¾å°kä¸ªç¹ï¼å¦æè¿äºç¹æä»»ä½ä¸ä¸ª0ï¼åè¢«æ£åç´ ä¸å®ä¸å¨ï¼ç´æ¥è¿åï¼å¦æé½æ¯1ï¼åæ¥è¯¢åç´ å¾å¯è½å­å¨ï¼å°±ä¼å»æ¥è¯¢redisåæ°æ®åºã\n\nå¸éè¿æ»¤å¨ä¸è¬ç¨äºå¨å¤§æ°æ®éçéåä¸­å¤å®æåç´ æ¯å¦å­å¨ã\n\n\n# ç¼å­éªå´©\n\nç¼å­éªå´©æï¼ç¼å­å¨åä¸æ¶é´å¤§é¢ç§¯çå¤±æï¼åé¢çè¯·æ±é½ç´æ¥è½å°äºæ°æ®åºä¸ï¼é ææ°æ®åºç­æ¶é´åæ¿åå¤§éè¯·æ±ã\n\nå­å¨ä¸¤ç§å¯è½ï¼\n\n * ç³»ç»ç¼å­æ¨¡ååºé®é¢ï¼å®æºä¸å¯ç¨ã\n * å¤§éè®¿é®æ°æ®ï¼ç­ç¹ç¼å­ï¼å¨æä¸æ¶å»å¤§é¢ç§¯å¤±æ\n\nè§£å³æ¹æ¡ï¼\n\néå¯¹ redis æå¡ä¸å¯ç¨çæåµï¼\n\n 1. éç¨ redis éç¾¤ï¼é¿ååæºåºç°é®é¢æ´ä¸ªç¼å­æå¡é½æ²¡åæ³ä½¿ç¨ãä¿è¯é«å¯ç¨ï¼redis sentinelãredis clusterã\n 2. éæµï¼é¿ååæ¶å¤çå¤§éçè¯·æ±ãéæµçæ­éçº§ï¼sentinelãhystrixã\n 3. å éæéå¯ä»¥èµ·å°ç¼å²çä½ç¨ï¼é²æ­¢å¤§éçè¯·æ±åæ¶æä½æ°æ®åºï¼ä½å®çç¼ºç¹æ¯å¢å äºç³»ç»çååºæ¶é´ï¼éä½äºç³»ç»çååéï¼çºç²äºä¸é¨åç¨æ·ä½éªãå½ç¼å­æªæ¥è¯¢å°æ¶ï¼å¯¹è¦è¯·æ±ç key è¿è¡å éï¼åªåè®¸ä¸ä¸ªçº¿ç¨å»æ°æ®åºä¸­æ¥ï¼å¶ä»çº¿ç¨ç­åæéã\n 4. è®¾ç½®äºçº§ç¼å­ãäºçº§ç¼å­æçæ¯é¤äº redis æ¬èº«çç¼å­ï¼åè®¾ç½®ä¸å±ç¼å­ï¼å½ redis å¤±æä¹åï¼åå»æ¥è¯¢äºçº§ç¼å­ãä¾å¦å¯ä»¥è®¾ç½®ä¸ä¸ªæ¬å°ç¼å­ï¼å¨ redis ç¼å­å¤±æçæ¶ååå»æ¥è¯¢æ¬å°ç¼å­èéæ¥è¯¢æ°æ®åºã\n\néå¯¹ç­ç¹ç¼å­å¤±æçæåµï¼\n\n 1. è®¾ç½®ä¸åçå¤±ææ¶é´æ¯å¦éæºè®¾ç½®ç¼å­çå¤±ææ¶é´ã\n 2. ç­ç¹ç¼å­æ°¸ä¸å¤±æã\n\n\n# ç¼å­å»ç©¿\n\nç¼å­å»ç©¿ï¼å¤§éçè¯·æ±åæ¶æ¥è¯¢ä¸ä¸ª key æ¶ï¼æ­¤æ¶è¿ä¸ª key æ­£å¥½å¤±æäºï¼å°±ä¼å¯¼è´å¤§éçè¯·æ±é½è½å°æ°æ®åºãç¼å­å»ç©¿æ¯æ¥è¯¢ç¼å­ä¸­å¤±æç keyï¼èç¼å­ç©¿éæ¯æ¥è¯¢ä¸å­å¨ç keyã\n\nè§£å³æ¹æ¡ï¼\n\n1ãå äºæ¥éãå¨å¹¶åçå¤ä¸ªè¯·æ±ä¸­ï¼åªæç¬¬ä¸ä¸ªè¯·æ±çº¿ç¨è½æ¿å°éå¹¶æ§è¡æ°æ®åºæ¥è¯¢æä½ï¼å¶ä»ççº¿ç¨æ¿ä¸å°éå°±é»å¡ç­çï¼ç­å°ç¬¬ä¸ä¸ªçº¿ç¨å°æ°æ®åå¥ç¼å­åï¼ç´æ¥èµ°ç¼å­ãå¯ä»¥ä½¿ç¨redisåå¸å¼éå®ç°ã\n\n2ãç­ç¹æ°æ®ä¸è¿æãç´æ¥å°ç¼å­è®¾ç½®ä¸ºä¸è¿æï¼ç¶åç±å®æ¶ä»»å¡å»å¼æ­¥å è½½æ°æ®ï¼æ´æ°ç¼å­ãè¿ç§æ¹å¼éç¨äºæ¯è¾æç«¯çåºæ¯ï¼ä¾å¦æµéç¹å«ç¹å«å¤§çåºæ¯ï¼ä½¿ç¨æ¶éè¦èèä¸å¡è½æ¥åæ°æ®ä¸ä¸è´çæ¶é´ï¼è¿æå°±æ¯å¼å¸¸æåµçå¤çï¼ä¿è¯ç¼å­å¯ä»¥å®æ¶å·æ°ã\n\n\n# ç¼å­é¢ç­\n\nç¼å­é¢ç­å°±æ¯ç³»ç»ä¸çº¿åï¼å°ç¸å³çç¼å­æ°æ®ç´æ¥å è½½å°ç¼å­ç³»ç»ãè¿æ ·å°±å¯ä»¥é¿åå¨ç¨æ·è¯·æ±çæ¶åï¼åæ¥è¯¢æ°æ®åºï¼ç¶ååå°æ°æ®ç¼å­çé®é¢ï¼ç¨æ·ç´æ¥æ¥è¯¢äºåè¢«é¢ç­çç¼å­æ°æ®ã\n\nè§£å³æ¹æ¡ï¼\n\n 1. ç´æ¥åä¸ªç¼å­å·æ°é¡µé¢ï¼ä¸çº¿æ¶æå·¥æä½ä¸ä¸ï¼\n 2. æ°æ®éä¸å¤§ï¼å¯ä»¥å¨é¡¹ç®å¯å¨çæ¶åèªå¨è¿è¡å è½½ï¼\n 3. å®æ¶å·æ°ç¼å­ï¼\n\n\n# ç¼å­éçº§\n\nå½è®¿é®éå§å¢ãæå¡åºç°é®é¢ï¼å¦ååºæ¶é´æ¢æä¸ååºï¼æéæ ¸å¿æå¡å½±åå°æ ¸å¿æµç¨çæ§è½æ¶ï¼å³ä½¿æ¯æææå¡ï¼ç³»ç»å¯ä»¥æ ¹æ®ä¸äºå³é®æ°æ®è¿è¡èªå¨éçº§ï¼ä¹å¯ä»¥éç½®å¼å³å®ç°äººå·¥éçº§ã\n\nç¼å­éçº§çæç»ç®çæ¯ä¿è¯æ ¸å¿æå¡å¯ç¨ï¼å³ä½¿æ¯ææçãèä¸æäºæå¡æ¯æ æ³éçº§çï¼å¦å å¥è´­ç©è½¦ãç»ç®ï¼ã\n\nå¨è¿è¡éçº§ä¹åè¦å¯¹ç³»ç»è¿è¡æ¢³çï¼ççç³»ç»æ¯ä¸æ¯å¯ä»¥ä¸¢åä¿å¸ï¼ä»èæ¢³çåºåªäºå¿é¡»èªæ­»ä¿æ¤ï¼åªäºå¯éçº§ï¼æ¯å¦å¯ä»¥åèæ¥å¿çº§å«è®¾ç½®é¢æ¡ï¼\n\n 1. ä¸è¬ï¼æ¯å¦æäºæå¡å¶å°å ä¸ºç½ç»æå¨æèæå¡æ­£å¨ä¸çº¿èè¶æ¶ï¼å¯ä»¥èªå¨éçº§ï¼\n 2. è­¦åï¼æäºæå¡å¨ä¸æ®µæ¶é´åæåçææ³¢å¨ï¼å¦å¨95~100%ä¹é´ï¼ï¼å¯ä»¥èªå¨éçº§æäººå·¥éçº§ï¼å¹¶åéåè­¦ï¼\n 3. éè¯¯ï¼æ¯å¦å¯ç¨çä½äº90%ï¼æèæ°æ®åºè¿æ¥æ± è¢«æçäºï¼æèè®¿é®éçªç¶çå¢å°ç³»ç»è½æ¿åçæå¤§éå¼ï¼æ­¤æ¶å¯ä»¥æ ¹æ®æåµèªå¨éçº§æèäººå·¥éçº§ï¼\n 4. ä¸¥ééè¯¯ï¼æ¯å¦å ä¸ºç¹æ®åå æ°æ®éè¯¯äºï¼æ­¤æ¶éè¦ç´§æ¥äººå·¥éçº§ã\n\næå¡éçº§çç®çï¼æ¯ä¸ºäºé²æ­¢redisæå¡æéï¼å¯¼è´æ°æ®åºè·çä¸èµ·åçéªå´©é®é¢ãå æ­¤ï¼å¯¹äºä¸éè¦çç¼å­æ°æ®ï¼å¯ä»¥éåæå¡éçº§ç­ç¥ï¼ä¾å¦ä¸ä¸ªæ¯è¾å¸¸è§çåæ³å°±æ¯ï¼redisåºç°é®é¢ï¼ä¸å»æ°æ®åºæ¥è¯¢ï¼èæ¯ç´æ¥è¿åé»è®¤å¼ç»ç¨æ·ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Redisåºæ¯é¢",frontmatter:{title:"Redisåºæ¯é¢",date:"2023-03-17T22:00:32.000Z",permalink:"/pages/c8420f/"},regularPath:"/03.Redis/09.redis%E5%9C%BA%E6%99%AF%E9%A2%98.html",relativePath:"03.Redis/09.redisåºæ¯é¢.md",key:"v-09ae1176",path:"/pages/c8420f/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Redisåå¸å¼é",frontmatter:{title:"Redisåå¸å¼é",date:"2023-03-17T22:20:53.000Z",permalink:"/pages/5f810a/"},regularPath:"/03.Redis/10.redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html",relativePath:"03.Redis/10.redisåå¸å¼é.md",key:"v-4050afac",path:"/pages/5f810a/",headers:[{level:2,title:"1. SEXNX key value",slug:"_1-sexnx-key-value",normalizedTitle:"1. sexnx key value",charIndex:2},{level:2,title:"2. SET key value [EX seconds | PX millseconds] [NX | XX]",slug:"_2-set-key-value-ex-seconds-px-millseconds-nx-xx",normalizedTitle:"2. set key value [ex seconds | px millseconds] [nx | xx]",charIndex:263},{level:2,title:"3. Redlock åä½è",slug:"_3-redlock-åä½è",normalizedTitle:"3. redlock åä½è",charIndex:640},{level:2,title:"4. Redisson",slug:"_4-redisson",normalizedTitle:"4. redisson",charIndex:708}],headersStr:"1. SEXNX key value 2. SET key value [EX seconds | PX millseconds] [NX | XX] 3. Redlock åä½è 4. Redisson",content:'# 1. SEXNX key value\n\nset if not exists\n\nå¦æ key å­å¨ï¼ä¸æ§è¡æä½ãkey ä¸å­å¨ï¼åå° key è®¾ç½®ä¸º valueã\n\n * å¦æ key ä¸å­å¨ï¼åæ¾ç¤ºæå¥æåï¼å¯ä»¥ç¨æ¥è¡¨ç¤ºå éæåï¼\n * å¦æ key å­å¨ï¼åä¼æ¾ç¤ºæå¥å¤±è´¥ï¼å¯ä»¥ç¨æ¥è¡¨ç¤ºå éå¤±è´¥ã\n\nè§£éï¼å é¤ keyãä½ä¸è½ä¹±å ï¼è¦ä¿è¯æ§è¡æä½çå®¢æ·ç«¯å°±æ¯å éçå®¢æ·ç«¯ãæä»¥ï¼è¦åéè¿ value å¤æ­æ¯å¦ä¸ºå éå®¢æ·ç«¯ã\n\nç¼ºç¹ï¼ææ²¡è¿ææ¶é´ï¼éä¸ä¼è¿æãå¯è½åºç°å®¢æ·ç«¯æ¿å°éååçå¼å¸¸ï¼å¯¼è´éä¸ç´æ æ³éæ¾ã\n\n\n# 2. SET key value [EX seconds | PX millseconds] [NX | XX]\n\n * EX seconds â è®¾ç½®é®keyçè¿ææ¶é´ï¼åä½æ¶ç§\n * PX milliseconds â è®¾ç½®é®keyçè¿ææ¶é´ï¼åä½æ¯æ¯«ç§\n * NX â åªæé®keyä¸å­å¨çæ¶åæä¼è®¾ç½®keyçå¼\n * XX â åªæé®keyå­å¨çæ¶åæä¼è®¾ç½®keyçå¼\n\nç¼ºç¹ï¼è§£éæ¶ï¼å¤æ­æ¯å¦æ¯å½åéï¼åå é¤ keyï¼ä¸æ¯åå­æ§æä½ã\n\nè§£å³ï¼ç¨ lua èæ¬\n\n// éæ¾éæ¶ï¼åæ¯è¾ value æ¯å¦ç¸ç­ï¼é¿åéçè¯¯éæ¾\nif redis.call("get",KEYS[1]) == ARGV[1] then\n    return redis.call("del",KEYS[1])\nelse\n    return 0\nend\n\n\n\n# 3. Redlock åä½è\n\nåä¸¤ç§æ¹å¼æ´å¤æ¯éå¯¹åèç¹ç redisï¼éå¯¹å¤èç¹ç redisï¼ä½èæåºäº Redlock\n\n\n# 4. Redisson\n\nå¼é¨çæºå¶',normalizedContent:'# 1. sexnx key value\n\nset if not exists\n\nå¦æ key å­å¨ï¼ä¸æ§è¡æä½ãkey ä¸å­å¨ï¼åå° key è®¾ç½®ä¸º valueã\n\n * å¦æ key ä¸å­å¨ï¼åæ¾ç¤ºæå¥æåï¼å¯ä»¥ç¨æ¥è¡¨ç¤ºå éæåï¼\n * å¦æ key å­å¨ï¼åä¼æ¾ç¤ºæå¥å¤±è´¥ï¼å¯ä»¥ç¨æ¥è¡¨ç¤ºå éå¤±è´¥ã\n\nè§£éï¼å é¤ keyãä½ä¸è½ä¹±å ï¼è¦ä¿è¯æ§è¡æä½çå®¢æ·ç«¯å°±æ¯å éçå®¢æ·ç«¯ãæä»¥ï¼è¦åéè¿ value å¤æ­æ¯å¦ä¸ºå éå®¢æ·ç«¯ã\n\nç¼ºç¹ï¼ææ²¡è¿ææ¶é´ï¼éä¸ä¼è¿æãå¯è½åºç°å®¢æ·ç«¯æ¿å°éååçå¼å¸¸ï¼å¯¼è´éä¸ç´æ æ³éæ¾ã\n\n\n# 2. set key value [ex seconds | px millseconds] [nx | xx]\n\n * ex seconds â è®¾ç½®é®keyçè¿ææ¶é´ï¼åä½æ¶ç§\n * px milliseconds â è®¾ç½®é®keyçè¿ææ¶é´ï¼åä½æ¯æ¯«ç§\n * nx â åªæé®keyä¸å­å¨çæ¶åæä¼è®¾ç½®keyçå¼\n * xx â åªæé®keyå­å¨çæ¶åæä¼è®¾ç½®keyçå¼\n\nç¼ºç¹ï¼è§£éæ¶ï¼å¤æ­æ¯å¦æ¯å½åéï¼åå é¤ keyï¼ä¸æ¯åå­æ§æä½ã\n\nè§£å³ï¼ç¨ lua èæ¬\n\n// éæ¾éæ¶ï¼åæ¯è¾ value æ¯å¦ç¸ç­ï¼é¿åéçè¯¯éæ¾\nif redis.call("get",keys[1]) == argv[1] then\n    return redis.call("del",keys[1])\nelse\n    return 0\nend\n\n\n\n# 3. redlock åä½è\n\nåä¸¤ç§æ¹å¼æ´å¤æ¯éå¯¹åèç¹ç redisï¼éå¯¹å¤èç¹ç redisï¼ä½èæåºäº redlock\n\n\n# 4. redisson\n\nå¼é¨çæºå¶',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"redisçrehash",frontmatter:{title:"redisçrehash",date:"2023-09-01T00:27:59.000Z",permalink:"/pages/fafd87/"},regularPath:"/03.Redis/11.redis%E7%9A%84rehash.html",relativePath:"03.Redis/11.redisçrehash.md",key:"v-7dfe13a8",path:"/pages/fafd87/",headersStr:null,content:"Redisä¸­çhashæ©å®¹æ¸è¿å¼rehashè¿ç¨\n\nèæ¯ï¼ rediså­å¸ï¼hashè¡¨ï¼å½æ°æ®è¶æ¥è¶å¤çæ¶åï¼å°±ä¼åçæ©å®¹ï¼ä¹å°±æ¯rehash\n\nå¯¹æ¯ï¼javaä¸­çhashmapï¼å½æ°æ®æ°éè¾¾å°éå¼çæ¶å(0.75)ï¼å°±ä¼åçrehashï¼hashè¡¨é¿åº¦åä¸ºåæ¥çäºåï¼å°åhashè¡¨æ°æ®å¨é¨éæ°è®¡ç®hashå°åï¼éæ°åéä½ç½®ï¼è¾¾å°rehashç®çã\n\nä¸ºäºé¿å rehash å¯¹æå¡å¨æ§è½é æå½±åï¼ æå¡å¨ä¸æ¯ä¸æ¬¡æ§å° ht[0]éé¢çææé®å¼å¯¹å¨é¨ rehash å° ht[1]ï¼ èæ¯åå¤æ¬¡ãæ¸è¿å¼å°å° ht[0]éé¢çé®å¼å¯¹æ¢æ¢å° rehash å° ht[1]ã\n\næ­¥éª¤ï¼\n\n 1. ä¸ºht[1]åéç©ºé´ï¼è®©å­å¸åæ¶ææht[0]åht[1]ä¸¤ä¸ªåå¸è¡¨\n 2. å°rehashindexçå¼è®¾ç½®ä¸º0ï¼è¡¨ç¤ºrehashå·¥ä½æ­£å¼å¼å§\n 3. å¨rehashæé´ï¼æ¯æ¬¡å¯¹å­å¸æ§è¡å¢å æ¹æ¥æä½æ¯ï¼ç¨åºé¤äºæ§è¡æå®çæä½ä»¥å¤ï¼è¿ä¼é¡ºå¸¦å°ht[0]åå¸è¡¨å¨rehashindexç´¢å¼ä¸çææé®å¼å¯¹rehashå°ht[1]ï¼å½rehashå·¥ä½å®æä»¥åï¼rehashindexçå¼+1\n 4. éçå­å¸æä½çä¸æ­æ§è¡ï¼æç»ä¼å¨æä¸æ¶é´æ®µä¸ht[0]çææé®å¼å¯¹é½ä¼è¢«rehashå°ht[1]ï¼è¿æ¶å°rehashindexçå¼è®¾ç½®ä¸º-1ï¼è¡¨ç¤ºrehashæä½ç»æã\n\næ¸è¿å¼rehashéç¨çæ¯ä¸ç§åèæ²»ä¹çæ¹å¼ï¼å°rehashçæä½åæå¨æ¯ä¸ä¸ªçè®¿é®ä¸­ï¼é¿åéä¸­å¼rehashèå¸¦æ¥çåºå¤§è®¡ç®éã",normalizedContent:"redisä¸­çhashæ©å®¹æ¸è¿å¼rehashè¿ç¨\n\nèæ¯ï¼ rediså­å¸ï¼hashè¡¨ï¼å½æ°æ®è¶æ¥è¶å¤çæ¶åï¼å°±ä¼åçæ©å®¹ï¼ä¹å°±æ¯rehash\n\nå¯¹æ¯ï¼javaä¸­çhashmapï¼å½æ°æ®æ°éè¾¾å°éå¼çæ¶å(0.75)ï¼å°±ä¼åçrehashï¼hashè¡¨é¿åº¦åä¸ºåæ¥çäºåï¼å°åhashè¡¨æ°æ®å¨é¨éæ°è®¡ç®hashå°åï¼éæ°åéä½ç½®ï¼è¾¾å°rehashç®çã\n\nä¸ºäºé¿å rehash å¯¹æå¡å¨æ§è½é æå½±åï¼ æå¡å¨ä¸æ¯ä¸æ¬¡æ§å° ht[0]éé¢çææé®å¼å¯¹å¨é¨ rehash å° ht[1]ï¼ èæ¯åå¤æ¬¡ãæ¸è¿å¼å°å° ht[0]éé¢çé®å¼å¯¹æ¢æ¢å° rehash å° ht[1]ã\n\næ­¥éª¤ï¼\n\n 1. ä¸ºht[1]åéç©ºé´ï¼è®©å­å¸åæ¶ææht[0]åht[1]ä¸¤ä¸ªåå¸è¡¨\n 2. å°rehashindexçå¼è®¾ç½®ä¸º0ï¼è¡¨ç¤ºrehashå·¥ä½æ­£å¼å¼å§\n 3. å¨rehashæé´ï¼æ¯æ¬¡å¯¹å­å¸æ§è¡å¢å æ¹æ¥æä½æ¯ï¼ç¨åºé¤äºæ§è¡æå®çæä½ä»¥å¤ï¼è¿ä¼é¡ºå¸¦å°ht[0]åå¸è¡¨å¨rehashindexç´¢å¼ä¸çææé®å¼å¯¹rehashå°ht[1]ï¼å½rehashå·¥ä½å®æä»¥åï¼rehashindexçå¼+1\n 4. éçå­å¸æä½çä¸æ­æ§è¡ï¼æç»ä¼å¨æä¸æ¶é´æ®µä¸ht[0]çææé®å¼å¯¹é½ä¼è¢«rehashå°ht[1]ï¼è¿æ¶å°rehashindexçå¼è®¾ç½®ä¸º-1ï¼è¡¨ç¤ºrehashæä½ç»æã\n\næ¸è¿å¼rehashéç¨çæ¯ä¸ç§åèæ²»ä¹çæ¹å¼ï¼å°rehashçæä½åæå¨æ¯ä¸ä¸ªçè®¿é®ä¸­ï¼é¿åéä¸­å¼rehashèå¸¦æ¥çåºå¤§è®¡ç®éã",charsets:{cjk:!0}},{title:"ç½ç»åè®®åå±",frontmatter:{title:"ç½ç»åè®®åå±",date:"2023-03-20T19:32:26.000Z",permalink:"/pages/network/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01.%E5%9F%BA%E7%A1%80/01.%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%88%86%E5%B1%82.html",relativePath:"04.è®¡ç®æºç½ç»/01.åºç¡/01.ç½ç»åè®®åå±.md",key:"v-3489417a",path:"/pages/network/",headers:[{level:2,title:"OSIä¸å±æ¨¡å",slug:"osiä¸å±æ¨¡å",normalizedTitle:"osiä¸å±æ¨¡å",charIndex:2},{level:2,title:"TCP/IPçåå±æ¨¡å",slug:"tcp-ipçåå±æ¨¡å",normalizedTitle:"tcp/ipçåå±æ¨¡å",charIndex:438},{level:2,title:"äºå±æ¨¡å",slug:"äºå±æ¨¡å",normalizedTitle:"äºå±æ¨¡å",charIndex:537},{level:2,title:"OSIåTCP/IPçåºå«",slug:"osiåtcp-ipçåºå«",normalizedTitle:"osiåtcp/ipçåºå«",charIndex:619}],headersStr:"OSIä¸å±æ¨¡å TCP/IPçåå±æ¨¡å äºå±æ¨¡å OSIåTCP/IPçåºå«",content:"# OSIä¸å±æ¨¡å\n\nOSIä¸å±æ¨¡å   åè½                               åè®®\nåºç¨å±       åºç¨è½¯ä»¶æä½¿ç¨çåè®®ï¼è§å®äºåºç¨è½¯ä»¶è¯¥ä»¥ä½ç§æ¹å¼è¿è¡éè®¯ã    HTTPï¼SMTPï¼DNSï¼FTPç­\nè¡¨ç¤ºå±       å³å®æ°æ®çå±ç°å½¢å¼ï¼å¦å¾çè¯¥ä½¿ç¨JPEGãBMPè¿æ¯PNGã   æ²¡æåè®®\nä¼è¯å±       è§£é¤åå»ºç«ä¸å«çç«¯ç¹é´çè¿æ¥ã                  æ²¡æåè®®\nä¼ è¾å±       æä¾ç«¯å¯¹ç«¯çæ¥ç¹ï¼ç«¯å£å·è¿éç»åºï¼ï¼å°æ°æ®æ©ä»¶æå°æ®µã      TCPï¼UDP\nç½ç»å±       ä¸ºæ°æ®åéæ©è·¯ç±ï¼è·¯ç±éè·¯ï¼                   IPç­\næ°æ®é¾è·¯å±     ä¼ è¾æå°åçå¸§ä»¥åéè¯¯æ£æµåè½                  PPPï¼ARPç­\nç©çå±       å°æ°æ®ä»¥äºè¿å¶çå½¢å¼å¨ç©çåªä»ä¸è¿è¡ä¼ è¾             ISO2110ï¼IEEE802ï¼IEEE802.2\n\n\n# TCP/IPçåå±æ¨¡å\n\nåºç¨å±ï¼åç¨æ·æä¾æ°æ®å ä¸ç¼ç åå¯¹è¯æ§å¶\n\nä¼ è¾å±ï¼æ¯æä¸åè®¾å¤é´éè¿ä¸åç½ç»éä¿¡\n\nç½ç»å±ï¼ç¡®å®éè¿è¯¥ç½ç»çæä½³è·¯å¾\n\nç½ç»æ¥å¥å±ï¼æ§å¶ç»æç½ç»çç¡¬ä»¶è®¾å¤åä»è´¨\n\n\n# äºå±æ¨¡å\n\nåºç¨å±\n\nä¼ è¾å± Transport layer\n\nç½ç»å± Network layer\n\næ°æ®é¾è·¯å± Data link layer\n\nç©çå±\n\n\n# OSIåTCP/IPçåºå«\n\n * OSI æä¸å±ï¼è TCP/IP æåå±\n * å¨ OSI ä¸­ï¼é¦åå¼åæ¨¡åï¼ç¶åå¼åæ¯ä¸å±çåè®®ãå¨ TCP/IPä¸­ï¼é¦åå¼ååè®®ï¼ç¶åå¼åæ¨¡å\n * OSIæ¨¡åæ¯åºäºæ¯ä¸å±åè½çéç¨æ¨¡åï¼TCP/IPæ¨¡åæ¯ä¸ç§é¢ååè®®çæ å\n * OSIæ¨¡ååºåäºä¸ä¸ªæ¦å¿µï¼å³æå¡ãæ¥å£ååè®®ãTCP/IPå¨è¿ä¸èä¹é´æ²¡ææç¡®çåºå«\n * OSI æ¨¡åæä¾äºæå³å¦ä½è¿è¡éä¿¡çæåï¼è TCP/IPæ¨¡ååå¶å®äº Internet å¼åçæ åãå æ­¤ï¼TCP/IP æ¯ä¸ç§æ´å®ç¨çæ¨¡å",normalizedContent:"# osiä¸å±æ¨¡å\n\nosiä¸å±æ¨¡å   åè½                               åè®®\nåºç¨å±       åºç¨è½¯ä»¶æä½¿ç¨çåè®®ï¼è§å®äºåºç¨è½¯ä»¶è¯¥ä»¥ä½ç§æ¹å¼è¿è¡éè®¯ã    httpï¼smtpï¼dnsï¼ftpç­\nè¡¨ç¤ºå±       å³å®æ°æ®çå±ç°å½¢å¼ï¼å¦å¾çè¯¥ä½¿ç¨jpegãbmpè¿æ¯pngã   æ²¡æåè®®\nä¼è¯å±       è§£é¤åå»ºç«ä¸å«çç«¯ç¹é´çè¿æ¥ã                  æ²¡æåè®®\nä¼ è¾å±       æä¾ç«¯å¯¹ç«¯çæ¥ç¹ï¼ç«¯å£å·è¿éç»åºï¼ï¼å°æ°æ®æ©ä»¶æå°æ®µã      tcpï¼udp\nç½ç»å±       ä¸ºæ°æ®åéæ©è·¯ç±ï¼è·¯ç±éè·¯ï¼                   ipç­\næ°æ®é¾è·¯å±     ä¼ è¾æå°åçå¸§ä»¥åéè¯¯æ£æµåè½                  pppï¼arpç­\nç©çå±       å°æ°æ®ä»¥äºè¿å¶çå½¢å¼å¨ç©çåªä»ä¸è¿è¡ä¼ è¾             iso2110ï¼ieee802ï¼ieee802.2\n\n\n# tcp/ipçåå±æ¨¡å\n\nåºç¨å±ï¼åç¨æ·æä¾æ°æ®å ä¸ç¼ç åå¯¹è¯æ§å¶\n\nä¼ è¾å±ï¼æ¯æä¸åè®¾å¤é´éè¿ä¸åç½ç»éä¿¡\n\nç½ç»å±ï¼ç¡®å®éè¿è¯¥ç½ç»çæä½³è·¯å¾\n\nç½ç»æ¥å¥å±ï¼æ§å¶ç»æç½ç»çç¡¬ä»¶è®¾å¤åä»è´¨\n\n\n# äºå±æ¨¡å\n\nåºç¨å±\n\nä¼ è¾å± transport layer\n\nç½ç»å± network layer\n\næ°æ®é¾è·¯å± data link layer\n\nç©çå±\n\n\n# osiåtcp/ipçåºå«\n\n * osi æä¸å±ï¼è tcp/ip æåå±\n * å¨ osi ä¸­ï¼é¦åå¼åæ¨¡åï¼ç¶åå¼åæ¯ä¸å±çåè®®ãå¨ tcp/ipä¸­ï¼é¦åå¼ååè®®ï¼ç¶åå¼åæ¨¡å\n * osiæ¨¡åæ¯åºäºæ¯ä¸å±åè½çéç¨æ¨¡åï¼tcp/ipæ¨¡åæ¯ä¸ç§é¢ååè®®çæ å\n * osiæ¨¡ååºåäºä¸ä¸ªæ¦å¿µï¼å³æå¡ãæ¥å£ååè®®ãtcp/ipå¨è¿ä¸èä¹é´æ²¡ææç¡®çåºå«\n * osi æ¨¡åæä¾äºæå³å¦ä½è¿è¡éä¿¡çæåï¼è tcp/ipæ¨¡ååå¶å®äº internet å¼åçæ åãå æ­¤ï¼tcp/ip æ¯ä¸ç§æ´å®ç¨çæ¨¡å",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"æµè§å¨å­å¨",frontmatter:{title:"æµè§å¨å­å¨",date:"2023-03-21T20:44:24.000Z",permalink:"/pages/f1d55e/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01.%E5%9F%BA%E7%A1%80/02.%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AD%98%E5%82%A8.html",relativePath:"04.è®¡ç®æºç½ç»/01.åºç¡/02.æµè§å¨å­å¨.md",key:"v-f8c2901e",path:"/pages/f1d55e/",headers:[{level:2,title:"Cookie",slug:"cookie",normalizedTitle:"cookie",charIndex:2},{level:2,title:"CookieåSessionåºå«",slug:"cookieåsessionåºå«",normalizedTitle:"cookieåsessionåºå«",charIndex:1044},{level:2,title:"LocalStorage å SessionStorage åºå«",slug:"localstorage-å-sessionstorage-åºå«",normalizedTitle:"localstorage å sessionstorage åºå«",charIndex:1244},{level:2,title:"localStorageè®¾ç½®è¿ææ¶é´",slug:"localstorageè®¾ç½®è¿ææ¶é´",normalizedTitle:"localstorageè®¾ç½®è¿ææ¶é´",charIndex:1664},{level:2,title:"cookieå¦ä½è·¨å",slug:"cookieå¦ä½è·¨å",normalizedTitle:"cookieå¦ä½è·¨å",charIndex:1846}],headersStr:"Cookie CookieåSessionåºå« LocalStorage å SessionStorage åºå« localStorageè®¾ç½®è¿ææ¶é´ cookieå¦ä½è·¨å",content:'# Cookie\n\n * Cookie æ¯ä¸äºæ°æ®, å­å¨äºä½ çµèä¸çææ¬æä»¶ä¸­\n * å®ç°æ¯æ¬¡HTTPè¯·æ±é½èªå¨å¸¦æ°æ®ç»æå¡å¨çææ¯\n * Cookie çä½ç¨å°±æ¯ç¨äºè§£å³ "å¦ä½è®°å½å®¢æ·ç«¯çç¨æ·ä¿¡æ¯"\n * ä¸è¬éåSessionä¸èµ·ä½¿ç¨ï¼å®¢æ·ç«¯åéè´¦å·å¯ç ç»æå¡å¨ï¼æå¡å¨éè¿è´¦å·å¯ç çæSessionIDç»å®¢æ·ç«¯ï¼ç¶åå®¢æ·ç«¯æ¯æ¬¡è¯·æ±é½éå¸¦è¿ä¸ªå¸¦æSessionIDçcookieã\n\né¦é¨å­æ®µ\n\né¦é¨å­æ®µåç§°       è¯´æ                   é¦é¨ç±»å\nSet-Cookie   å¼å§ç¶æç®¡çæä½¿ç¨çCookieä¿¡æ¯   ååºé¦é¨å­æ®µ\nCookie       æå¡å¨æ¥æ¶å°çCookieä¿¡æ¯      è¯·æ±é¦é¨å­æ®µ\n\nSet-Cookieå­æ®µå±æ§\n\nå±æ§                             è¯´æ\n<cookie-name>=<cookie-value>   ä¸ä¸ªcookieå¿é¡»å§äºä¸ä¸ªåç§°/å¼å¯¹\nExpires=<date>                 (å¯é)cookieçæé¿æææ¶é´\nMax-Age=<non-zero-digit>       (å¯é)ä¼åçº§é«äºExpiresï¼æå¤±ææéç»è¿çç§æ°\nDomain=<domain-value>          (å¯é)æå®cookieå¯ä»¥éè¾¾çä¸»æºå\nPath=<path-value>              (å¯é)å°æå¡å¨çæä»¶ç®å½ï¼å­ç®å½ï¼ä½ä¸ºcookieçéç¨å¯¹è±¡\nSecure                         (å¯é)ä»å¨è¯·æ±ä½¿ç¨SSLåHTTPSåè®®çæ¶åæä¼è¢«åéå°æå¡å¨\nHttpOnly                       (å¯é)è®¾ç½®äº HttpOnly å±æ§ç cookie ä¸è½ä½¿ç¨ JavaScript ç»ç±\n                               Document.cookieå±æ§ãXMLHttpRequeståRequest APIs è¿è¡è®¿é®\nSameSite=Strict/Lax            (å¯é)åè®¸æå¡å¨è®¾å®ä¸åcookieä¸éçè·¨åè¯·æ±ä¸èµ·åé\n\ncookieçsameSiteï¼\n\n * strictï¼è¡¨ç¤ºå®å¨ç¦æ­¢ç¬¬ä¸æ¹cookieï¼ç´æ¥é¿åäºCSRFæ»å»ï¼ä½æ¯åä¸ä¸ªè¿è¥ä½çç½ç«ä¸è½å±ç¨ç»éä¿¡æ¯\n\n * noneï¼å®å¨ä¸åéå¶\n\n * laxï¼åæ¾è¡\n\n\n# CookieåSessionåºå«\n\n * å­å¨ä½ç½®ï¼cookieä¿å­å¨æµè§å¨ç«¯ï¼èsessionä¿å­å¨æå¡å¨ç«¯\n * å­å¨æ¹å¼ï¼cookieåªè½ä¿å­å­ç¬¦ä¸²ç±»åï¼ä»¥ææ¬çæ¹å¼å­å¨ï¼å¦ææ²¡æè®¾ç½®è¿ææ¶é´ï¼ä¼å­å¨å¨åå­ä¸­ï¼ï¼sessionéè¿ç±»ä¼¼ä¸Hashtableçæ°æ®ç»ææ¥ä¿å­\n * å­å¨å¤§å°ï¼cookieå°äº4kbï¼sessionæ²¡æå¤§å°éå¶\n * å®å¨æ§ï¼sessionå¤§äºcookie\n\n\n# LocalStorage å SessionStorage åºå«\n\nWebStorageåæ¬localStorage å sessionStorageä¸¤ç§æ¹å¼ã\n\nlocalStorage å sessionStorage å±æ§ååè®¸å¨æµè§å¨ä¸­å­å¨ key/value å¯¹çæ°æ®ãåæ¯ä¸ºäºå¼¥è¡¥cookieæå¸¦æ¥çéå¶ï¼å½æ°æ®éè¦ä¸¥æ ¼æ§å¶å¨å®¢æ·ç«¯ï¼å¹¶ä¸ä¸éè¦æç»­çå°æ°æ®ååæå¡å¨çæ¶åï¼å°±éè¦ä½¿ç¨WebStorageã\n\nlocalStorageç¨äºé¿ä¹ä¿å­æ°æ®ï¼æ²¡æè¿ææ¶é´è®¾ç½®ï¼sessionStorageç¨äºä¸´æ¶ä¿å­åä¸çªå£(ææ ç­¾é¡µ)çæ°æ®ï¼å³é­å¯¹åºæµè§å¨çªå£ï¼Windowï¼/ tabï¼æ°æ®å°ä¼è¢«æ¸é¤ã\n\n * sessionStorageï¼åªå¨åæºçåçªå£ï¼ææ ç­¾é¡µï¼ä¸­å±äº«æ°æ®ï¼ä¹å°±æ¯åªå¨å½åä¼è¯ä¸­å±äº«\n\n * localStorageï¼å¨ææçåæºçªå£ä¸­é½æ¯å±äº«ç\n\n * cookieï¼å¨ææåæºçªå£ä¸­é½æ¯å±äº«ç\n\n\n# localStorageè®¾ç½®è¿ææ¶é´\n\nå­å¨localStorageçåæ¶ï¼å­å¨ä¸ä¸ªè¿ææ¶é´\n\nlocalStorage[key] = value\nlocalStorage[`${key}__expires__`] = Date.now() + 1000*60*expired\n\n\nå¨è·åçæ¶åï¼ååå¯¹åºçå­å¨æ¶é´ï¼å¦æè¿æï¼åå é¤ãæ²¡è¿æåå»åå¯¹åºçå¼\n\n\n# cookieå¦ä½è·¨å\n\nAç½ç«è®¿é®åæºçæå¡å¨ï¼è·åå°cookieï¼ç¶åAç½ç«åéè¯·æ±å°Bæå¡å¨ï¼æ³è¦å¸¦ä¸è¿ä¸ªcookie\n\n1.å¨è¯·æ±å¤´ä¸­æ·»å Credentialsï¼true\n\n2.å¨Bæå¡å¨éç½®Access-Control-Allow-OriginåAccess-Control-Allow-Credentialså¯¹Aç½ç«çè¯·æ±è¿è¡æ¾è¡\n\nä½æ¯å¨æ°ççchromeä¸­ï¼éè¦å°cookieçsamesiteå±æ§è®¾ç½®ä¸ºnoneï¼å®å¨æ¾è¡ï¼é»è®¤æ¯laxåæ¾è¡ï¼stractç¦æ­¢ï¼ï¼è®¾ç½®ä¸ºnoneçè¯å¹¶ä¸å¿é¡»ä½¿ç¨httpsè¯·æ±',normalizedContent:'# cookie\n\n * cookie æ¯ä¸äºæ°æ®, å­å¨äºä½ çµèä¸çææ¬æä»¶ä¸­\n * å®ç°æ¯æ¬¡httpè¯·æ±é½èªå¨å¸¦æ°æ®ç»æå¡å¨çææ¯\n * cookie çä½ç¨å°±æ¯ç¨äºè§£å³ "å¦ä½è®°å½å®¢æ·ç«¯çç¨æ·ä¿¡æ¯"\n * ä¸è¬éåsessionä¸èµ·ä½¿ç¨ï¼å®¢æ·ç«¯åéè´¦å·å¯ç ç»æå¡å¨ï¼æå¡å¨éè¿è´¦å·å¯ç çæsessionidç»å®¢æ·ç«¯ï¼ç¶åå®¢æ·ç«¯æ¯æ¬¡è¯·æ±é½éå¸¦è¿ä¸ªå¸¦æsessionidçcookieã\n\né¦é¨å­æ®µ\n\né¦é¨å­æ®µåç§°       è¯´æ                   é¦é¨ç±»å\nset-cookie   å¼å§ç¶æç®¡çæä½¿ç¨çcookieä¿¡æ¯   ååºé¦é¨å­æ®µ\ncookie       æå¡å¨æ¥æ¶å°çcookieä¿¡æ¯      è¯·æ±é¦é¨å­æ®µ\n\nset-cookieå­æ®µå±æ§\n\nå±æ§                             è¯´æ\n<cookie-name>=<cookie-value>   ä¸ä¸ªcookieå¿é¡»å§äºä¸ä¸ªåç§°/å¼å¯¹\nexpires=<date>                 (å¯é)cookieçæé¿æææ¶é´\nmax-age=<non-zero-digit>       (å¯é)ä¼åçº§é«äºexpiresï¼æå¤±ææéç»è¿çç§æ°\ndomain=<domain-value>          (å¯é)æå®cookieå¯ä»¥éè¾¾çä¸»æºå\npath=<path-value>              (å¯é)å°æå¡å¨çæä»¶ç®å½ï¼å­ç®å½ï¼ä½ä¸ºcookieçéç¨å¯¹è±¡\nsecure                         (å¯é)ä»å¨è¯·æ±ä½¿ç¨sslåhttpsåè®®çæ¶åæä¼è¢«åéå°æå¡å¨\nhttponly                       (å¯é)è®¾ç½®äº httponly å±æ§ç cookie ä¸è½ä½¿ç¨ javascript ç»ç±\n                               document.cookieå±æ§ãxmlhttprequestårequest apis è¿è¡è®¿é®\nsamesite=strict/lax            (å¯é)åè®¸æå¡å¨è®¾å®ä¸åcookieä¸éçè·¨åè¯·æ±ä¸èµ·åé\n\ncookieçsamesiteï¼\n\n * strictï¼è¡¨ç¤ºå®å¨ç¦æ­¢ç¬¬ä¸æ¹cookieï¼ç´æ¥é¿åäºcsrfæ»å»ï¼ä½æ¯åä¸ä¸ªè¿è¥ä½çç½ç«ä¸è½å±ç¨ç»éä¿¡æ¯\n\n * noneï¼å®å¨ä¸åéå¶\n\n * laxï¼åæ¾è¡\n\n\n# cookieåsessionåºå«\n\n * å­å¨ä½ç½®ï¼cookieä¿å­å¨æµè§å¨ç«¯ï¼èsessionä¿å­å¨æå¡å¨ç«¯\n * å­å¨æ¹å¼ï¼cookieåªè½ä¿å­å­ç¬¦ä¸²ç±»åï¼ä»¥ææ¬çæ¹å¼å­å¨ï¼å¦ææ²¡æè®¾ç½®è¿ææ¶é´ï¼ä¼å­å¨å¨åå­ä¸­ï¼ï¼sessionéè¿ç±»ä¼¼ä¸hashtableçæ°æ®ç»ææ¥ä¿å­\n * å­å¨å¤§å°ï¼cookieå°äº4kbï¼sessionæ²¡æå¤§å°éå¶\n * å®å¨æ§ï¼sessionå¤§äºcookie\n\n\n# localstorage å sessionstorage åºå«\n\nwebstorageåæ¬localstorage å sessionstorageä¸¤ç§æ¹å¼ã\n\nlocalstorage å sessionstorage å±æ§ååè®¸å¨æµè§å¨ä¸­å­å¨ key/value å¯¹çæ°æ®ãåæ¯ä¸ºäºå¼¥è¡¥cookieæå¸¦æ¥çéå¶ï¼å½æ°æ®éè¦ä¸¥æ ¼æ§å¶å¨å®¢æ·ç«¯ï¼å¹¶ä¸ä¸éè¦æç»­çå°æ°æ®ååæå¡å¨çæ¶åï¼å°±éè¦ä½¿ç¨webstorageã\n\nlocalstorageç¨äºé¿ä¹ä¿å­æ°æ®ï¼æ²¡æè¿ææ¶é´è®¾ç½®ï¼sessionstorageç¨äºä¸´æ¶ä¿å­åä¸çªå£(ææ ç­¾é¡µ)çæ°æ®ï¼å³é­å¯¹åºæµè§å¨çªå£ï¼windowï¼/ tabï¼æ°æ®å°ä¼è¢«æ¸é¤ã\n\n * sessionstorageï¼åªå¨åæºçåçªå£ï¼ææ ç­¾é¡µï¼ä¸­å±äº«æ°æ®ï¼ä¹å°±æ¯åªå¨å½åä¼è¯ä¸­å±äº«\n\n * localstorageï¼å¨ææçåæºçªå£ä¸­é½æ¯å±äº«ç\n\n * cookieï¼å¨ææåæºçªå£ä¸­é½æ¯å±äº«ç\n\n\n# localstorageè®¾ç½®è¿ææ¶é´\n\nå­å¨localstorageçåæ¶ï¼å­å¨ä¸ä¸ªè¿ææ¶é´\n\nlocalstorage[key] = value\nlocalstorage[`${key}__expires__`] = date.now() + 1000*60*expired\n\n\nå¨è·åçæ¶åï¼ååå¯¹åºçå­å¨æ¶é´ï¼å¦æè¿æï¼åå é¤ãæ²¡è¿æåå»åå¯¹åºçå¼\n\n\n# cookieå¦ä½è·¨å\n\naç½ç«è®¿é®åæºçæå¡å¨ï¼è·åå°cookieï¼ç¶åaç½ç«åéè¯·æ±å°bæå¡å¨ï¼æ³è¦å¸¦ä¸è¿ä¸ªcookie\n\n1.å¨è¯·æ±å¤´ä¸­æ·»å credentialsï¼true\n\n2.å¨bæå¡å¨éç½®access-control-allow-originåaccess-control-allow-credentialså¯¹aç½ç«çè¯·æ±è¿è¡æ¾è¡\n\nä½æ¯å¨æ°ççchromeä¸­ï¼éè¦å°cookieçsamesiteå±æ§è®¾ç½®ä¸ºnoneï¼å®å¨æ¾è¡ï¼é»è®¤æ¯laxåæ¾è¡ï¼stractç¦æ­¢ï¼ï¼è®¾ç½®ä¸ºnoneçè¯å¹¶ä¸å¿é¡»ä½¿ç¨httpsè¯·æ±',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ç½ç»æ»å»",frontmatter:{title:"ç½ç»æ»å»",date:"2023-03-21T20:59:09.000Z",permalink:"/pages/9ce3d9/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01.%E5%9F%BA%E7%A1%80/03.%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB.html",relativePath:"04.è®¡ç®æºç½ç»/01.åºç¡/03.ç½ç»æ»å».md",key:"v-053a73e8",path:"/pages/9ce3d9/",headers:[{level:2,title:"CSRFæ»å»",slug:"csrfæ»å»",normalizedTitle:"csrfæ»å»",charIndex:2},{level:3,title:"ç®åç CSRF æ»å»ä»£ç ç¤ºä¾ï¼",slug:"ç®åç-csrf-æ»å»ä»£ç ç¤ºä¾",normalizedTitle:"ç®åç csrf æ»å»ä»£ç ç¤ºä¾ï¼",charIndex:533},{level:3,title:"éç¨CSRF-tokençæ¹æ³",slug:"éç¨csrf-tokençæ¹æ³",normalizedTitle:"éç¨csrf-tokençæ¹æ³",charIndex:752},{level:2,title:"XSSæ»å»",slug:"xssæ»å»",normalizedTitle:"xssæ»å»",charIndex:2371},{level:2,title:"CSRFåXSSçåºå«",slug:"csrfåxssçåºå«",normalizedTitle:"csrfåxssçåºå«",charIndex:2538},{level:2,title:"DDoSæ»å»",slug:"ddosæ»å»",normalizedTitle:"ddosæ»å»",charIndex:3028}],headersStr:"CSRFæ»å» ç®åç CSRF æ»å»ä»£ç ç¤ºä¾ï¼ éç¨CSRF-tokençæ¹æ³ XSSæ»å» CSRFåXSSçåºå« DDoSæ»å»",content:'# CSRFæ»å»\n\nCross-Site Request Forgery CSRFï¼è·¨ç«è¯·æ±ä¼ªé ï¼å°±æ¯ç¨æ·å¨ç¬¬ä¸æ¹ç½ç«ä¸åAåéè¯·æ±ï¼ç¶åæºå¸¦ä¸äºcookieï¼\n\nCSRF æ»å»éå¸¸æ¯éè¿å¨æ»å»èæ§å¶çç½ç«ä¸­åµå¥æ¶æä»£ç ï¼æ¥å©ç¨ç¨æ·å¨å¶ä»åä¿¡ä»»ç½ç«ä¸çèº«ä»½è®¤è¯ï¼ä»èå¨ç¨æ·ä¸ç¥æçæåµä¸å®ææ»å»ãæ»å»èéè¿è¿ç§æ¹å¼ä¼ªé ç¨æ·çè¯·æ±ï¼ä»èè¾¾å°çåç¨æ·ææä¿¡æ¯ãä¿®æ¹ç¨æ·æ°æ®ãæ§è¡éæ³æä½ç­ç®çã\n\nCSRF æ»å»çåçæ¯å©ç¨æµè§å¨çèªå¨æäº¤æºå¶ï¼å½ç¨æ·å¨å·²ç»å½çåä¿¡ä»»ç½ç«ä¸­è¿è¡æäºæä½æ¶ï¼æ»å»èéè¿æ¶æä»£ç æäº¤ä¸äºä¼ªé çè¯·æ±ï¼ä»èååç¨æ·å¨å¶ä»ç½ç«ä¸æ§è¡ä¸äºéæ³æä½ãç±äºè¿äºè¯·æ±çæ¥æºæ¯ç¨æ·åä¿¡ä»»çç½ç«ï¼å æ­¤æå¡å¨å¾å¾ä¼è®¤ä¸ºè¿äºè¯·æ±æ¯åæ³çï¼ä»èæ§è¡è¿äºè¯·æ±æè¦æ±çæä½ã\n\nä¸ºäºé²æ­¢ CSRF æ»å»ï¼å¯ä»¥éåä»¥ä¸æªæ½ï¼\n\n 1. å¨è¡¨åä¸­æ·»å  CSRF Tokenï¼ä»¥é²æ­¢æ¶æè¯·æ±è¢«æ§è¡ã\n 2. æ£æµ Referer å¤´ï¼ä»¥é²æ­¢éæ³è¯·æ±è¢«æ§è¡ã\n 3. å¯¹äºæææä½ï¼éç¨åå ç´ è®¤è¯ç­å®å¨æªæ½ï¼å å¼ºèº«ä»½éªè¯ã\n 4. åæ¶æ´æ°è½¯ä»¶åç»ä»¶ï¼ä»¥é¿åå·²ç¥çå®å¨æ¼æ´è¢«æ»å»èå©ç¨ã\n\næ»ä¹ï¼CSRF æ»å»æ¯ä¸ç§å¸¸è§çç½ç»å®å¨æ¼æ´ï¼éè¦éåç¸åºçå®å¨æªæ½æ¥é²èã\n\n\n# ç®åç CSRF æ»å»ä»£ç ç¤ºä¾ï¼\n\n 1. æ»å»èåå¤ä¸ä¸ªéé±¼ç½ç«ï¼ä¼ªè£æé¶è¡ç½ç«ã\n 2. åå®³èç»å½é¶è¡ç½ç«å¹¶ä¿æç»å½ç¶æã\n 3. åå®³èè®¿é®æ»å»èçéé±¼ç½ç«ï¼è§¦åéé±¼ç½ç«çè½¬è´¦è¡¨åæäº¤è¯·æ±ã\n 4. æ»å»èéé±¼ç½ç«ä¸çè¡¨åä¼è¢«èªå¨æäº¤å°é¶è¡ç½ç«çè½¬è´¦æ¥å£ï¼å ä¸ºæµè§å¨ä¼èªå¨å¸¦ä¸åå®³èå¨é¶è¡ç½ç«ä¸çç»å½å­è¯ï¼æ¯å¦ Cookieï¼ï¼æä»¥é¶è¡ç½ç«ä¼è®¤ä¸ºæ¯åå®³èå¨è¿è¡è½¬è´¦æä½ã\n 5. åå®³èçè´¦æ·è¢«æ»å»èè½¬èµ°äº 100 åã\n\n\n# éç¨CSRF-tokençæ¹æ³\n\nCSRF tokenï¼è·¨ç«è¯·æ±ä¼ªé ä»¤çï¼æ¯ä¸ç§é²æ­¢ CSRF æ»å»çå¸¸ç¨æ¹æ³ã\n\nå¶å®ç°åçæ¯å¨é¡µé¢ä¸­çæä¸ä¸ªéæºç tokenï¼ç¶åå°å¶å å¥å°è¡¨åä¸­çéèå­æ®µä¸­ï¼å¹¶å°å¶åæ¶ä¿å­å°æå¡å¨ç«¯ãå¨è¡¨åæäº¤æ¶ï¼é¤äºå°è¡¨åæ°æ®æäº¤å°æå¡å¨å¤ï¼è¿éè¦å° token ä¸åæäº¤å°æå¡å¨ç«¯ãæå¡å¨æ¥æ¶å°è¡¨åè¯·æ±æ¶ï¼é¦åä¼æ ¡éª token çå¼æ¯å¦æ­£ç¡®ï¼åªæ token çå¼æ­£ç¡®ï¼æä¼ç»§ç»­å¤çè¡¨åè¯·æ±ã\n\nè¿æ ·åçåçæ¯ï¼æ»å»èè½ç¶å¯ä»¥ä¼ªé è¯·æ±ï¼ä½æ¯æ»å»èæ æ³ä¼ªé åæ³ç tokenï¼å ä¸º token æ¯éæºçæçï¼å¹¶ä¸åªææå¡å¨ç«¯ç¥éæ­£ç¡®ç token å¼ãå æ­¤ï¼æ»å»èæ æ³å¨ä¼ªé çè¯·æ±ä¸­æºå¸¦æ­£ç¡®ç token å¼ï¼ä»èå®ç°äºé²æ­¢ CSRF æ»å»çç®çã\n\nå¨æå¡ç«¯ï¼å¯ä»¥å°çæç CSRF token ä¿å­å°ä¼è¯ï¼sessionï¼æècookieä¸­ï¼å¹¶å¨è¡¨åæäº¤æ¶éªè¯ token çå¼æ¯å¦åä¼è¯æècookieä¸­çå¼ç¸åã\n\nconst express = require(\'express\');\nconst cookieParser = require(\'cookie-parser\');\nconst csrf = require(\'csurf\');\n\nconst app = express();\nconst csrfProtection = csrf({ cookie: true });\n\n// ä½¿ç¨ cookie-parser ä¸­é´ä»¶æ¥è§£æ cookie\napp.use(cookieParser());\n\n// æ·»å  CSRF token çä¸­é´ä»¶\napp.use(csrfProtection);\n\n// çæ CSRF token å¹¶å°å¶ä¿å­å° cookie ä¸­\napp.get(\'/\', (req, res) => {\n  const token = req.csrfToken();\n  res.cookie(\'XSRF-TOKEN\', token);\n  res.send(`\n    <html>\n      <head>\n        <title>CSRF Demo</title>\n      </head>\n      <body>\n        <form method="POST" action="/transfer">\n          <input type="hidden" name="_csrf" value="${token}">\n          <input type="text" name="to" placeholder="To">\n          <input type="number" name="amount" placeholder="Amount">\n          <button type="submit">Transfer</button>\n        </form>\n      </body>\n    </html>\n  `);\n});\n\n// å¤çè½¬è´¦è¯·æ±\napp.post(\'/transfer\', (req, res) => {\n  // éªè¯ CSRF token çå¼æ¯å¦æ­£ç¡®\n  const token = req.cookies[\'XSRF-TOKEN\'];\n  if (!req.body._csrf || req.body._csrf !== token) {\n    res.status(403).send(\'Invalid CSRF token\');\n    return;\n  }\n\n  // æ§è¡è½¬è´¦æä½\n  // ...\n});\n\napp.listen(3000, () => console.log(\'Server started on port 3000\'));\n\n\n\n\n# XSSæ»å»\n\nCross-site scriptingï¼ XSS è·¨ç«èæ¬æ»å»ã\n\nXSSç®åæ¥è¯´å°±æ¯å¨Webé¡µé¢ä¸­æå¥æ¶æçScriptä»£ç \n\nscriptæ ç­¾å¯ä»¥æå¥ä»£ç ï¼imgä¸­çonerrorä¹å¯ä»¥\n\nevalï¼ï¼ä¼å°ç¼ç ä¹åçè¯­å¥è§£ç å¹¶æ§è¡\n\né²å¾¡ææ®µï¼å¯¹scriptãimgãaæ ç­¾è¿è¡è¿æ»¤\n\nè¾é¿çè¾å¥è¿è¡æªæ­\n\n\n# CSRFåXSSçåºå«\n\nCSRFæ»å»æ¯ä¸ç§å©ç¨ç¨æ·å¨å·²ç»ç»å½çæåµä¸ï¼å¨ç¨æ·ä¸ç¥æçæåµä¸ä¼ªé ç¨æ·è¯·æ±ï¼ä»èå®ç°æ»å»çä¸ç§æ¹å¼ãæ»å»èéè¿åç§æ¹å¼æ¬ºéªç¨æ·ç¹å»æ¶æé¾æ¥æè®¿é®æ¶æç½ç«ï¼å¨ç¨æ·ç»å½çæåµä¸ï¼æ»å»èä¼ªé ä¸ä¸ªæ¶æè¯·æ±ï¼è¿ä¸ªè¯·æ±çèµ·æ¥åæ¯åæ³çè¯·æ±ï¼å®éä¸å´æ¯æ»å»èç²¾å¿æé çï¼ä¸æ¦ç¨æ·ç¹å»è¿ä¸ªè¯·æ±ï¼æ»å»èå°±å¯ä»¥å¯¹ç¨æ·çè´¦æ·è¿è¡æ¶ææä½ã\n\nXSSæ»å»åæ¯ææ»å»èå¨Webåºç¨ç¨åºä¸­æ³¨å¥æ¶æèæ¬æHTMLä»£ç ï¼ä½¿ä¹å¨ç¨æ·æµè§ç½é¡µæ¶è¢«æ§è¡ï¼ä»èè¾¾å°æ»å»çç®çãæ»å»èéè¿åç§ææ®µå°æ¶æèæ¬æHTMLä»£ç æ³¨å¥å°Webé¡µé¢ä¸­ï¼å½ç¨æ·è®¿é®è¿ä¸ªé¡µé¢æ¶ï¼æ¶æèæ¬æHTMLä»£ç ä¼è¢«æ§è¡ï¼ä»èå®ç°æ»å»ãXSSæ»å»å¯ä»¥åä¸ºå­å¨åXSSååå°åXSSä¸¤ç§ï¼åå«æ¯æ»å»èå°æ¶æèæ¬å­å¨å¨Webåºç¨ç¨åºä¸­ï¼æèå°æ¶æèæ¬ä½ä¸ºåæ°åéç»Webåºç¨ç¨åºï¼åéè¿Webåºç¨ç¨åºè¿åç»ç¨æ·ã\n\nç»¼ä¸æè¿°ï¼CSRFåXSSè½ç¶é½æ¯Webå®å¨é®é¢ï¼ä½å®ä»¬çæ»å»æ¹å¼åå®ç°æ¹å¼ä¸åãCSRFæ»å»å©ç¨ç¨æ·å¨å·²ç»ç»å½çæåµä¸å¯¹ç¨æ·è¿è¡ä¼ªé è¯·æ±ï¼èXSSæ»å»åæ¯éè¿æ³¨å¥æ¶æä»£ç æ¥å¯¹ç¨æ·çæµè§å¨è¿è¡æ»å»ã\n\n\n# DDoSæ»å»\n\næç»æå¡ï¼DoSï¼æ»å»æ¯ä¸ç§ç½ç»æ»å»ï¼æ¶æè¡ä¸ºèéè¿ä¸­æ­è®¾å¤çæ­£å¸¸åè½ï¼ä½¿å¶ç®æ ç¨æ·æ æ³ä½¿ç¨è®¡ç®æºæå¶ä»è®¾å¤ãDoS æ»å»éå¸¸éè¿è¯·æ±åå®ææ·¹æ²¡ç®æ è®¡ç®æºï¼ç´å°å¶æ æ³å¤çæ­£å¸¸æµéï¼ä»èå¯¹å¶ä»ç¨æ·é ææç»æå¡ãDoS æ»å»çç¹å¾æ¯ä½¿ç¨ä¸å°è®¡ç®æºæ¥åèµ·æ»å»ã\n\nDoS æ»å»éå¸¸åä¸ºä¸¤ç±»ï¼\n\n * ç¼å²åºæº¢åºæ»å»ï¼å¨è¿ä¸ç§æ»å»ç±»åä¸­ï¼åå­ç¼å²åºæº¢åºå¯è½å¯¼è´è®¡ç®æºèå°½ææå¯ç¨çç¡¬çç©ºé´ãåå­æ CPU æ¶é´ãè¿ç§å©ç¨å½¢å¼éå¸¸ä¼å¯¼è´è¡ä¸ºç¼æ¢ãç³»ç»å´©æºæå¶ä»æå®³çæå¡å¨è¡ä¸ºï¼ä»èé ææç»æå¡ã\n * æ´ªæ°´æ»å»ï¼éè¿ä½¿ç®æ æå¡å¨åæ»¡å¤§éæ°æ®åï¼æ¶æè¡ä¸ºèä¾¿è½å¤ä½¿æå¡å¨å®¹éè¿é¥±åï¼ä»èå¯¼è´æç»æå¡ãå¤§å¤æ° DoS æ´ªæ°´æ»å»è¥è¦å¾éï¼æ¶æè¡ä¸ºèå¿é¡»å·ææ¯ç®æ æ´å¤çå¯ç¨å¸¦å®½ã\n\nDDoS å DoS ä¹é´çæ¾èåºå«æ¯æ»å»ä¸­ä½¿ç¨çè¿æ¥æ°ãDoS æ»å»å©ç¨åä¸ªè¿æ¥ï¼è DDoS æ»å»åå©ç¨è®¸å¤æ»å»æµéæ¥æºï¼éå¸¸éç¨åµå°¸ç½ç»çå½¢å¼ã',normalizedContent:'# csrfæ»å»\n\ncross-site request forgery csrfï¼è·¨ç«è¯·æ±ä¼ªé ï¼å°±æ¯ç¨æ·å¨ç¬¬ä¸æ¹ç½ç«ä¸åaåéè¯·æ±ï¼ç¶åæºå¸¦ä¸äºcookieï¼\n\ncsrf æ»å»éå¸¸æ¯éè¿å¨æ»å»èæ§å¶çç½ç«ä¸­åµå¥æ¶æä»£ç ï¼æ¥å©ç¨ç¨æ·å¨å¶ä»åä¿¡ä»»ç½ç«ä¸çèº«ä»½è®¤è¯ï¼ä»èå¨ç¨æ·ä¸ç¥æçæåµä¸å®ææ»å»ãæ»å»èéè¿è¿ç§æ¹å¼ä¼ªé ç¨æ·çè¯·æ±ï¼ä»èè¾¾å°çåç¨æ·ææä¿¡æ¯ãä¿®æ¹ç¨æ·æ°æ®ãæ§è¡éæ³æä½ç­ç®çã\n\ncsrf æ»å»çåçæ¯å©ç¨æµè§å¨çèªå¨æäº¤æºå¶ï¼å½ç¨æ·å¨å·²ç»å½çåä¿¡ä»»ç½ç«ä¸­è¿è¡æäºæä½æ¶ï¼æ»å»èéè¿æ¶æä»£ç æäº¤ä¸äºä¼ªé çè¯·æ±ï¼ä»èååç¨æ·å¨å¶ä»ç½ç«ä¸æ§è¡ä¸äºéæ³æä½ãç±äºè¿äºè¯·æ±çæ¥æºæ¯ç¨æ·åä¿¡ä»»çç½ç«ï¼å æ­¤æå¡å¨å¾å¾ä¼è®¤ä¸ºè¿äºè¯·æ±æ¯åæ³çï¼ä»èæ§è¡è¿äºè¯·æ±æè¦æ±çæä½ã\n\nä¸ºäºé²æ­¢ csrf æ»å»ï¼å¯ä»¥éåä»¥ä¸æªæ½ï¼\n\n 1. å¨è¡¨åä¸­æ·»å  csrf tokenï¼ä»¥é²æ­¢æ¶æè¯·æ±è¢«æ§è¡ã\n 2. æ£æµ referer å¤´ï¼ä»¥é²æ­¢éæ³è¯·æ±è¢«æ§è¡ã\n 3. å¯¹äºæææä½ï¼éç¨åå ç´ è®¤è¯ç­å®å¨æªæ½ï¼å å¼ºèº«ä»½éªè¯ã\n 4. åæ¶æ´æ°è½¯ä»¶åç»ä»¶ï¼ä»¥é¿åå·²ç¥çå®å¨æ¼æ´è¢«æ»å»èå©ç¨ã\n\næ»ä¹ï¼csrf æ»å»æ¯ä¸ç§å¸¸è§çç½ç»å®å¨æ¼æ´ï¼éè¦éåç¸åºçå®å¨æªæ½æ¥é²èã\n\n\n# ç®åç csrf æ»å»ä»£ç ç¤ºä¾ï¼\n\n 1. æ»å»èåå¤ä¸ä¸ªéé±¼ç½ç«ï¼ä¼ªè£æé¶è¡ç½ç«ã\n 2. åå®³èç»å½é¶è¡ç½ç«å¹¶ä¿æç»å½ç¶æã\n 3. åå®³èè®¿é®æ»å»èçéé±¼ç½ç«ï¼è§¦åéé±¼ç½ç«çè½¬è´¦è¡¨åæäº¤è¯·æ±ã\n 4. æ»å»èéé±¼ç½ç«ä¸çè¡¨åä¼è¢«èªå¨æäº¤å°é¶è¡ç½ç«çè½¬è´¦æ¥å£ï¼å ä¸ºæµè§å¨ä¼èªå¨å¸¦ä¸åå®³èå¨é¶è¡ç½ç«ä¸çç»å½å­è¯ï¼æ¯å¦ cookieï¼ï¼æä»¥é¶è¡ç½ç«ä¼è®¤ä¸ºæ¯åå®³èå¨è¿è¡è½¬è´¦æä½ã\n 5. åå®³èçè´¦æ·è¢«æ»å»èè½¬èµ°äº 100 åã\n\n\n# éç¨csrf-tokençæ¹æ³\n\ncsrf tokenï¼è·¨ç«è¯·æ±ä¼ªé ä»¤çï¼æ¯ä¸ç§é²æ­¢ csrf æ»å»çå¸¸ç¨æ¹æ³ã\n\nå¶å®ç°åçæ¯å¨é¡µé¢ä¸­çæä¸ä¸ªéæºç tokenï¼ç¶åå°å¶å å¥å°è¡¨åä¸­çéèå­æ®µä¸­ï¼å¹¶å°å¶åæ¶ä¿å­å°æå¡å¨ç«¯ãå¨è¡¨åæäº¤æ¶ï¼é¤äºå°è¡¨åæ°æ®æäº¤å°æå¡å¨å¤ï¼è¿éè¦å° token ä¸åæäº¤å°æå¡å¨ç«¯ãæå¡å¨æ¥æ¶å°è¡¨åè¯·æ±æ¶ï¼é¦åä¼æ ¡éª token çå¼æ¯å¦æ­£ç¡®ï¼åªæ token çå¼æ­£ç¡®ï¼æä¼ç»§ç»­å¤çè¡¨åè¯·æ±ã\n\nè¿æ ·åçåçæ¯ï¼æ»å»èè½ç¶å¯ä»¥ä¼ªé è¯·æ±ï¼ä½æ¯æ»å»èæ æ³ä¼ªé åæ³ç tokenï¼å ä¸º token æ¯éæºçæçï¼å¹¶ä¸åªææå¡å¨ç«¯ç¥éæ­£ç¡®ç token å¼ãå æ­¤ï¼æ»å»èæ æ³å¨ä¼ªé çè¯·æ±ä¸­æºå¸¦æ­£ç¡®ç token å¼ï¼ä»èå®ç°äºé²æ­¢ csrf æ»å»çç®çã\n\nå¨æå¡ç«¯ï¼å¯ä»¥å°çæç csrf token ä¿å­å°ä¼è¯ï¼sessionï¼æècookieä¸­ï¼å¹¶å¨è¡¨åæäº¤æ¶éªè¯ token çå¼æ¯å¦åä¼è¯æècookieä¸­çå¼ç¸åã\n\nconst express = require(\'express\');\nconst cookieparser = require(\'cookie-parser\');\nconst csrf = require(\'csurf\');\n\nconst app = express();\nconst csrfprotection = csrf({ cookie: true });\n\n// ä½¿ç¨ cookie-parser ä¸­é´ä»¶æ¥è§£æ cookie\napp.use(cookieparser());\n\n// æ·»å  csrf token çä¸­é´ä»¶\napp.use(csrfprotection);\n\n// çæ csrf token å¹¶å°å¶ä¿å­å° cookie ä¸­\napp.get(\'/\', (req, res) => {\n  const token = req.csrftoken();\n  res.cookie(\'xsrf-token\', token);\n  res.send(`\n    <html>\n      <head>\n        <title>csrf demo</title>\n      </head>\n      <body>\n        <form method="post" action="/transfer">\n          <input type="hidden" name="_csrf" value="${token}">\n          <input type="text" name="to" placeholder="to">\n          <input type="number" name="amount" placeholder="amount">\n          <button type="submit">transfer</button>\n        </form>\n      </body>\n    </html>\n  `);\n});\n\n// å¤çè½¬è´¦è¯·æ±\napp.post(\'/transfer\', (req, res) => {\n  // éªè¯ csrf token çå¼æ¯å¦æ­£ç¡®\n  const token = req.cookies[\'xsrf-token\'];\n  if (!req.body._csrf || req.body._csrf !== token) {\n    res.status(403).send(\'invalid csrf token\');\n    return;\n  }\n\n  // æ§è¡è½¬è´¦æä½\n  // ...\n});\n\napp.listen(3000, () => console.log(\'server started on port 3000\'));\n\n\n\n\n# xssæ»å»\n\ncross-site scriptingï¼ xss è·¨ç«èæ¬æ»å»ã\n\nxssç®åæ¥è¯´å°±æ¯å¨webé¡µé¢ä¸­æå¥æ¶æçscriptä»£ç \n\nscriptæ ç­¾å¯ä»¥æå¥ä»£ç ï¼imgä¸­çonerrorä¹å¯ä»¥\n\nevalï¼ï¼ä¼å°ç¼ç ä¹åçè¯­å¥è§£ç å¹¶æ§è¡\n\né²å¾¡ææ®µï¼å¯¹scriptãimgãaæ ç­¾è¿è¡è¿æ»¤\n\nè¾é¿çè¾å¥è¿è¡æªæ­\n\n\n# csrfåxssçåºå«\n\ncsrfæ»å»æ¯ä¸ç§å©ç¨ç¨æ·å¨å·²ç»ç»å½çæåµä¸ï¼å¨ç¨æ·ä¸ç¥æçæåµä¸ä¼ªé ç¨æ·è¯·æ±ï¼ä»èå®ç°æ»å»çä¸ç§æ¹å¼ãæ»å»èéè¿åç§æ¹å¼æ¬ºéªç¨æ·ç¹å»æ¶æé¾æ¥æè®¿é®æ¶æç½ç«ï¼å¨ç¨æ·ç»å½çæåµä¸ï¼æ»å»èä¼ªé ä¸ä¸ªæ¶æè¯·æ±ï¼è¿ä¸ªè¯·æ±çèµ·æ¥åæ¯åæ³çè¯·æ±ï¼å®éä¸å´æ¯æ»å»èç²¾å¿æé çï¼ä¸æ¦ç¨æ·ç¹å»è¿ä¸ªè¯·æ±ï¼æ»å»èå°±å¯ä»¥å¯¹ç¨æ·çè´¦æ·è¿è¡æ¶ææä½ã\n\nxssæ»å»åæ¯ææ»å»èå¨webåºç¨ç¨åºä¸­æ³¨å¥æ¶æèæ¬æhtmlä»£ç ï¼ä½¿ä¹å¨ç¨æ·æµè§ç½é¡µæ¶è¢«æ§è¡ï¼ä»èè¾¾å°æ»å»çç®çãæ»å»èéè¿åç§ææ®µå°æ¶æèæ¬æhtmlä»£ç æ³¨å¥å°webé¡µé¢ä¸­ï¼å½ç¨æ·è®¿é®è¿ä¸ªé¡µé¢æ¶ï¼æ¶æèæ¬æhtmlä»£ç ä¼è¢«æ§è¡ï¼ä»èå®ç°æ»å»ãxssæ»å»å¯ä»¥åä¸ºå­å¨åxssååå°åxssä¸¤ç§ï¼åå«æ¯æ»å»èå°æ¶æèæ¬å­å¨å¨webåºç¨ç¨åºä¸­ï¼æèå°æ¶æèæ¬ä½ä¸ºåæ°åéç»webåºç¨ç¨åºï¼åéè¿webåºç¨ç¨åºè¿åç»ç¨æ·ã\n\nç»¼ä¸æè¿°ï¼csrfåxssè½ç¶é½æ¯webå®å¨é®é¢ï¼ä½å®ä»¬çæ»å»æ¹å¼åå®ç°æ¹å¼ä¸åãcsrfæ»å»å©ç¨ç¨æ·å¨å·²ç»ç»å½çæåµä¸å¯¹ç¨æ·è¿è¡ä¼ªé è¯·æ±ï¼èxssæ»å»åæ¯éè¿æ³¨å¥æ¶æä»£ç æ¥å¯¹ç¨æ·çæµè§å¨è¿è¡æ»å»ã\n\n\n# ddosæ»å»\n\næç»æå¡ï¼dosï¼æ»å»æ¯ä¸ç§ç½ç»æ»å»ï¼æ¶æè¡ä¸ºèéè¿ä¸­æ­è®¾å¤çæ­£å¸¸åè½ï¼ä½¿å¶ç®æ ç¨æ·æ æ³ä½¿ç¨è®¡ç®æºæå¶ä»è®¾å¤ãdos æ»å»éå¸¸éè¿è¯·æ±åå®ææ·¹æ²¡ç®æ è®¡ç®æºï¼ç´å°å¶æ æ³å¤çæ­£å¸¸æµéï¼ä»èå¯¹å¶ä»ç¨æ·é ææç»æå¡ãdos æ»å»çç¹å¾æ¯ä½¿ç¨ä¸å°è®¡ç®æºæ¥åèµ·æ»å»ã\n\ndos æ»å»éå¸¸åä¸ºä¸¤ç±»ï¼\n\n * ç¼å²åºæº¢åºæ»å»ï¼å¨è¿ä¸ç§æ»å»ç±»åä¸­ï¼åå­ç¼å²åºæº¢åºå¯è½å¯¼è´è®¡ç®æºèå°½ææå¯ç¨çç¡¬çç©ºé´ãåå­æ cpu æ¶é´ãè¿ç§å©ç¨å½¢å¼éå¸¸ä¼å¯¼è´è¡ä¸ºç¼æ¢ãç³»ç»å´©æºæå¶ä»æå®³çæå¡å¨è¡ä¸ºï¼ä»èé ææç»æå¡ã\n * æ´ªæ°´æ»å»ï¼éè¿ä½¿ç®æ æå¡å¨åæ»¡å¤§éæ°æ®åï¼æ¶æè¡ä¸ºèä¾¿è½å¤ä½¿æå¡å¨å®¹éè¿é¥±åï¼ä»èå¯¼è´æç»æå¡ãå¤§å¤æ° dos æ´ªæ°´æ»å»è¥è¦å¾éï¼æ¶æè¡ä¸ºèå¿é¡»å·ææ¯ç®æ æ´å¤çå¯ç¨å¸¦å®½ã\n\nddos å dos ä¹é´çæ¾èåºå«æ¯æ»å»ä¸­ä½¿ç¨çè¿æ¥æ°ãdos æ»å»å©ç¨åä¸ªè¿æ¥ï¼è ddos æ»å»åå©ç¨è®¸å¤æ»å»æµéæ¥æºï¼éå¸¸éç¨åµå°¸ç½ç»çå½¢å¼ã',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"HTTPçæ¬å¯¹æ¯",frontmatter:{title:"HTTPçæ¬å¯¹æ¯",date:"2023-03-21T17:35:01.000Z",permalink:"/pages/e1cd04/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02.%E5%BA%94%E7%94%A8%E5%B1%82/01.http%E7%89%88%E6%9C%AC%E5%AF%B9%E6%AF%94.html",relativePath:"04.è®¡ç®æºç½ç»/02.åºç¨å±/01.httpçæ¬å¯¹æ¯.md",key:"v-6379fc2e",path:"/pages/e1cd04/",headers:[{level:2,title:"http1.1",slug:"http1-1",normalizedTitle:"http1.1",charIndex:47},{level:2,title:"https",slug:"https",normalizedTitle:"https",charIndex:15},{level:2,title:"http2",slug:"http2",normalizedTitle:"http2",charIndex:403},{level:2,title:"http3",slug:"http3",normalizedTitle:"http3",charIndex:678},{level:2,title:"Q & A",slug:"q-a",normalizedTitle:"q &amp; a",charIndex:null}],headersStr:"http1.1 https http2 http3 Q & A",content:" * http/1.1\n * https\n * http/2\n * http/3\n\n\n\n\n# http1.1\n\nä¼ç¹ï¼\n\n * é»è®¤ä½¿ç¨é¿è¿æ¥ãï¼HTTP/1.0åè®®æ¯æï¼ä½æ¯æ¯é»è®¤å³é­çï¼ä»HTTP/1.1ä»¥åï¼è¿æ¥é»è®¤é½æ¯é¿è¿æ¥ãï¼\n * æ¯æç®¡éï¼pipelineï¼ä¼ è¾ï¼å³åè®¸æµè§å¨åæ¶åéå¤ä¸ªè¯·æ±ï¼ä½ååºè¿æ¯è¦æåºã\n\nç¼ºç¹ï¼\n\n * ååºè¦æéï¼å¯è½é æéå¤´é»å¡\n * å¤´é¨æªç»åç¼©\n * æ²¡æè¯·æ±ä¼åçº§\n * è¯·æ±åªè½ä»å®¢æ·ç«¯å¼å§ï¼æå¡ç«¯åªè½è¢«å¨ååº\n * ææä¼ è¾ï¼ä¸å®å¨\n\n\n# https\n\nå¨httpåtcpä¹é´ï¼éè¿å¢å SSL/TLSåè®®å®ç°ã\n\nä¼ç¹ï¼\n\n * éç¨ä¿¡æ¯å å¯ï¼æ··åå å¯ï¼ï¼è§£å³ææä¼ è¾ä¼è¢«çªå¬çé®é¢ã\n * éç¨éªè¯æºå¶ï¼éè¿æè¦ç®æ³ä¿è¯ä¿¡æ¯çå®æ´æ§ï¼è§£å³äºæ¥æå¯è½è¢«ç¯¡æ¹çé®é¢ã\n * éç¨èº«ä»½è¯ä¹¦ï¼æ°å­è¯ä¹¦ï¼ï¼å°å¬é¥æ¾å°è¯ä¹¦ä¸­ãè§£å³å¯è½è¢«ååçé®é¢ã\n\n\n# http2\n\nä¼ç¹ï¼\n\n * åºäºhttpsçï¼å®å¨æä¿éã\n * ä½¿ç¨HPACKç®æ³è¿è¡å¤´é¨åç¼©ãå¦æåæ¶åéè¿ä¸ªè¯·æ±ï¼å¤´é¨æ¯ç¸åçï¼ä¼æ¶é¤éå¤çé¨åã\n * äºè¿å¶æ ¼å¼çæ¥æãç±å¤´ä¿¡æ¯å¸§+æ°æ®å¸§ç»æ\n * éç¨æ°æ®æµï¼æ¯ä¸ªè¯·æ±æååºçææåï¼ç§°ä¸ºä¸ä¸ªæ°æ®æµï¼ç¨æ¥æ è¯åä¸è¯·æ±ãæ¯ä¸ªæ°æ®æµæå¯ä¸çç¼å·ãè¿å¯ä»¥æå®æ°æ®æµçä¼åçº§ï¼ä¼åçº§é«çæå¡ç«¯ä¼åååºã\n * å¤è·¯å¤ç¨è§£å³éå¤´é»å¡é®é¢ã\n * æ¯ææå¡ç«¯æ¨éã\n\nç¼ºç¹ï¼\n\n * å¤ä¸ªhttpè¯·æ±å¤ç¨ä¸ä¸ªtcpè¿æ¥ï¼å¦æä¸¢åï¼ä¼è§¦åtcpéä¼ ï¼åä¸tcpä¸çhttpè¯·æ±é½å¿é¡»ç­è¿ä¸ªåã\n\n\n# http3\n\nä¼ç¹ï¼\n\n * ætcpåè®®æ¹æudpãåºäºudpæåºäºQUICåè®®ã\n\n * * udpä¸ç®¡é¡ºåºï¼ä¸ç®¡ä¸¢åï¼å æ­¤ä¸ä¼æéå¤´é»å¡åä¸¢åéä¼ é®é¢ã\n   * å¯é æ§ç±QUICä¿è¯ã\n\n * TLSåçº§æäºTLS1.3ï¼ä¸ä¸ªRTTå°±å¯ä»¥å®ææ¡æã\n\n * å¤´é¨åç¼©ç®æ³åçº§æäºQPack\n\n\n# Q & A\n\nQï¼TLSçæ¡æé¶æ®µæ¯åä»ä¹æ¶åï¼æ¯å¨TCPè¿æ¥ååï¼æµç¨åæ¯ææ ·çã\n\nAï¼åTCPä¸æ¬¡æ¡æï¼åTLSä¸æ¬¡æ¡æã",normalizedContent:" * http/1.1\n * https\n * http/2\n * http/3\n\n\n\n\n# http1.1\n\nä¼ç¹ï¼\n\n * é»è®¤ä½¿ç¨é¿è¿æ¥ãï¼http/1.0åè®®æ¯æï¼ä½æ¯æ¯é»è®¤å³é­çï¼ä»http/1.1ä»¥åï¼è¿æ¥é»è®¤é½æ¯é¿è¿æ¥ãï¼\n * æ¯æç®¡éï¼pipelineï¼ä¼ è¾ï¼å³åè®¸æµè§å¨åæ¶åéå¤ä¸ªè¯·æ±ï¼ä½ååºè¿æ¯è¦æåºã\n\nç¼ºç¹ï¼\n\n * ååºè¦æéï¼å¯è½é æéå¤´é»å¡\n * å¤´é¨æªç»åç¼©\n * æ²¡æè¯·æ±ä¼åçº§\n * è¯·æ±åªè½ä»å®¢æ·ç«¯å¼å§ï¼æå¡ç«¯åªè½è¢«å¨ååº\n * ææä¼ è¾ï¼ä¸å®å¨\n\n\n# https\n\nå¨httpåtcpä¹é´ï¼éè¿å¢å ssl/tlsåè®®å®ç°ã\n\nä¼ç¹ï¼\n\n * éç¨ä¿¡æ¯å å¯ï¼æ··åå å¯ï¼ï¼è§£å³ææä¼ è¾ä¼è¢«çªå¬çé®é¢ã\n * éç¨éªè¯æºå¶ï¼éè¿æè¦ç®æ³ä¿è¯ä¿¡æ¯çå®æ´æ§ï¼è§£å³äºæ¥æå¯è½è¢«ç¯¡æ¹çé®é¢ã\n * éç¨èº«ä»½è¯ä¹¦ï¼æ°å­è¯ä¹¦ï¼ï¼å°å¬é¥æ¾å°è¯ä¹¦ä¸­ãè§£å³å¯è½è¢«ååçé®é¢ã\n\n\n# http2\n\nä¼ç¹ï¼\n\n * åºäºhttpsçï¼å®å¨æä¿éã\n * ä½¿ç¨hpackç®æ³è¿è¡å¤´é¨åç¼©ãå¦æåæ¶åéè¿ä¸ªè¯·æ±ï¼å¤´é¨æ¯ç¸åçï¼ä¼æ¶é¤éå¤çé¨åã\n * äºè¿å¶æ ¼å¼çæ¥æãç±å¤´ä¿¡æ¯å¸§+æ°æ®å¸§ç»æ\n * éç¨æ°æ®æµï¼æ¯ä¸ªè¯·æ±æååºçææåï¼ç§°ä¸ºä¸ä¸ªæ°æ®æµï¼ç¨æ¥æ è¯åä¸è¯·æ±ãæ¯ä¸ªæ°æ®æµæå¯ä¸çç¼å·ãè¿å¯ä»¥æå®æ°æ®æµçä¼åçº§ï¼ä¼åçº§é«çæå¡ç«¯ä¼åååºã\n * å¤è·¯å¤ç¨è§£å³éå¤´é»å¡é®é¢ã\n * æ¯ææå¡ç«¯æ¨éã\n\nç¼ºç¹ï¼\n\n * å¤ä¸ªhttpè¯·æ±å¤ç¨ä¸ä¸ªtcpè¿æ¥ï¼å¦æä¸¢åï¼ä¼è§¦åtcpéä¼ ï¼åä¸tcpä¸çhttpè¯·æ±é½å¿é¡»ç­è¿ä¸ªåã\n\n\n# http3\n\nä¼ç¹ï¼\n\n * ætcpåè®®æ¹æudpãåºäºudpæåºäºquicåè®®ã\n\n * * udpä¸ç®¡é¡ºåºï¼ä¸ç®¡ä¸¢åï¼å æ­¤ä¸ä¼æéå¤´é»å¡åä¸¢åéä¼ é®é¢ã\n   * å¯é æ§ç±quicä¿è¯ã\n\n * tlsåçº§æäºtls1.3ï¼ä¸ä¸ªrttå°±å¯ä»¥å®ææ¡æã\n\n * å¤´é¨åç¼©ç®æ³åçº§æäºqpack\n\n\n# q & a\n\nqï¼tlsçæ¡æé¶æ®µæ¯åä»ä¹æ¶åï¼æ¯å¨tcpè¿æ¥ååï¼æµç¨åæ¯ææ ·çã\n\naï¼åtcpä¸æ¬¡æ¡æï¼åtlsä¸æ¬¡æ¡æã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"HTTP",frontmatter:{title:"HTTP",date:"2023-03-21T17:54:59.000Z",permalink:"/pages/f502d9/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02.%E5%BA%94%E7%94%A8%E5%B1%82/02.http.html",relativePath:"04.è®¡ç®æºç½ç»/02.åºç¨å±/02.http.md",key:"v-5140306c",path:"/pages/f502d9/",headers:[{level:2,title:"ä»ä¹æ¯ HTTP",slug:"ä»ä¹æ¯-http",normalizedTitle:"ä»ä¹æ¯ http",charIndex:2},{level:2,title:"HTTP ç¶æç ",slug:"http-ç¶æç ",normalizedTitle:"http ç¶æç ",charIndex:190},{level:2,title:"HTTP è¯·æ±æ¹å¼",slug:"http-è¯·æ±æ¹å¼",normalizedTitle:"http è¯·æ±æ¹å¼",charIndex:512},{level:2,title:"content-type",slug:"content-type",normalizedTitle:"content-type",charIndex:798},{level:2,title:"å¸¸è§ç«¯å£å¯¹åºçæå¡",slug:"å¸¸è§ç«¯å£å¯¹åºçæå¡",normalizedTitle:"å¸¸è§ç«¯å£å¯¹åºçæå¡",charIndex:1128},{level:2,title:"GETåPOSTçåºå«",slug:"getåpostçåºå«",normalizedTitle:"getåpostçåºå«",charIndex:1312},{level:2,title:"å¦ä½çè§£ HTTP æ¯æ ç¶æç",slug:"å¦ä½çè§£-http-æ¯æ ç¶æç",normalizedTitle:"å¦ä½çè§£ http æ¯æ ç¶æç",charIndex:1560},{level:2,title:"å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äºï¼è¿ä¸æ³æ­å¼è¿æ¥æä¹åï¼æä¹ç»´æï¼",slug:"å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äº-è¿ä¸æ³æ­å¼è¿æ¥æä¹å-æä¹ç»´æ",normalizedTitle:"å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äºï¼è¿ä¸æ³æ­å¼è¿æ¥æä¹åï¼æä¹ç»´æï¼",charIndex:1655},{level:2,title:"HTTPç¼å­",slug:"httpç¼å­",normalizedTitle:"httpç¼å­",charIndex:1725}],headersStr:"ä»ä¹æ¯ HTTP HTTP ç¶æç  HTTP è¯·æ±æ¹å¼ content-type å¸¸è§ç«¯å£å¯¹åºçæå¡ GETåPOSTçåºå« å¦ä½çè§£ HTTP æ¯æ ç¶æç å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äºï¼è¿ä¸æ³æ­å¼è¿æ¥æä¹åï¼æä¹ç»´æï¼ HTTPç¼å­",content:'# ä»ä¹æ¯ HTTP\n\nè¶ææ¬ä¼ è¾åè®®æ¯ä¸ç§ç¨äºåå¸å¼ãåä½å¼åè¶åªä½ä¿¡æ¯ç³»ç»çåºç¨å±åè®®ï¼æ¯å ç¹ç½ä¸åºç¨æä¸ºå¹¿æ³çä¸ç§ç½ç»ä¼ è¾åè®®ï¼ææç WWW æä»¶é½å¿é¡»éµå®è¿ä¸ªæ åã\n\nHTTP æ¯ä¸º Web æµè§å¨ä¸ Web æå¡å¨ä¹é´çéä¿¡èè®¾è®¡çï¼ä½ä¹å¯ä»¥ç¨äºå¶ä»ç®çã\n\nHTTP æ¯ä¸ä¸ªåºäº TCP/IP éä¿¡åè®®æ¥ä¼ éæ°æ®çï¼HTML æä»¶ãå¾çæä»¶ãæ¥è¯¢ç»æç­ï¼ã\n\n\n# HTTP ç¶æç \n\n * 1xxï¼ä¿¡æ¯æ§ç¶æç \n * 2xxï¼æå\n * 3xxï¼éå®å\n * 4xxï¼å®¢æ·ç«¯éè¯¯\n * 5xxï¼æå¡ç«¯éè¯¯\n\n\nå¸¸è§ç¶æç ï¼\n\n * 101ï¼åæ¢è¯·æ±åè®®ãæ¯å¦åæ¢å° http2 æ websocket åè®®ã\n * 200ï¼è¯·æ±æå\n * 301ï¼æ°¸ä¹éå®åï¼ä¼ç¼å­\n * 302ï¼ä¸´æ¶éå®åï¼ä¸ä¼ç¼å­ãè¯·æ±èä¹ååºç»§ç»­ä½¿ç¨åå°åè¯·æ±ã\n * 304 å½ä¸­ç¼å­ï¼ä¸å·æè·³è½¬æä¹ï¼éå®åå·²å­å¨çç¼å­æä»¶ã\n * 400ï¼å®¢æ·ç«¯è¯·æ±çè¯­æ³éè¯¯\n * 403ï¼æå¡ç«¯ç¦æ­¢è®¿é®ï¼è·æéæå³\n * 404ï¼æå¡ç«¯æ æ³æ ¹æ®å®¢æ·ç«¯è¯·æ±æ¾å°èµæº\n * 500ï¼æå¡ç«¯éè¯¯\n * 503ï¼æå¡å¨å½åå¾å¿ï¼ææ¶æ æ³ååº\n\n\n# HTTP è¯·æ±æ¹å¼\n\n * GETï¼å¯¹æå¡å¨èµæºè·åçè¯·æ±ï¼æ¯å®å¨å¹ç­çã\n * POSTï¼åéåå«ç¨æ·æäº¤æ°æ®çè¯·æ±\n * PUTï¼åæå¡ç«¯æäº¤æ°æ®ï¼ä»¥ä¿®æ¹æ°æ®ãåPOSTä¸æ ·ï¼ä½æ¯PUTæ¯å¹ç­çï¼ç¸åçå¤ä¸ªPUTè¯·æ±ï¼ç­åäºåªåéäºä¸ä¸ªPUTè¯·æ±ï¼å ä¸ºPUTæ¯ç´æ¥æåä¿®æ¹èµæºçï¼èPOSTæ¯æåä¿®æ¹èµæºçç¶çº§èµæºï¼\n * DELETEï¼å é¤æå¡ç«¯æäºèµæº\n * HEADï¼è¯·æ±é¡µé¢çé¦é¨ï¼è·åèµæºçåä¿¡æ¯\n * CONNECTï¼ç¨äºsslé§éçåºäºä»£ççè¯·æ±\n * OPTIONSï¼è¿åææå¯ç¨çæ¹æ³ï¼å¸¸ç¨äºè·¨å\n * TRACEï¼è¿½è¸ªè¯·æ±-ååºçä¼ è¾è·¯å¾\n\n\n# content-type\n\nå³Internet Media Typeï¼äºèç½åªä½ç±»åï¼ãéè¿åç¥ç±»åè®©æ¥æ¶æ¹å¾ä»¥è¿è¡ç¸åºçå¤çã\n\nCONTENT-TYPE                        æè¿°\napplication/xml                     xmlæ°æ®æ ¼å¼\napplication/json                    jsonæ°æ®æ ¼å¼\napplication/pdf                     pdfæ ¼å¼\ntext/html                           HTMLæ ¼å¼\napplication/x-www-form-urlencoded   è¡¨åæäº¤æ°æ®é»è®¤æ ¼å¼\n\n\n# å¸¸è§ç«¯å£å¯¹åºçæå¡\n\n * 21ï¼FTP æä»¶ä¼ è¾åè®®\n * 22ï¼SSH\n * 23ï¼telnet è¿ç¨ç»å½æå¡\n * 25ï¼SMTP ç®åé®ä»¶ä¼ è¾åè®®\n * 53ï¼DSN ååæå¡å¨\n * 80ï¼HTTP\n * 110ï¼POP3 é®ä»¶åè®®\n * 443ï¼HTTPS\n * 1080ï¼SOCKETS\n * 1521ï¼Oracle\n * 3306ï¼MySQL\n\n\n# GETåPOSTçåºå«\n\n * è¯·æ±åæ°ï¼GET çè¯·æ±åæ°å¨ URL ä¸­ï¼ç¨ & è¿æ¥ãPOST çéè¿ request body ä¼ åã\n * åæ°æ°æ®ç±»åï¼GET åªè½æ¯ ASCII çå­ç¬¦ãPOST æ²¡æéå¶ã\n * è¯·æ±ç¼å­ï¼GET ä¼è¢«ä¸»å¨ cacheãPOST ä¸ä¼è¢«ç¼å­ï¼é¤éæå¨è®¾ç½®ã\n * æ°æ®åï¼GET äº§çä¸ä¸ª TCP æ°æ®åãPOST äº§çä¸¤ä¸ªãï¼è¿å¥½åè·æµè§å¨çå®ç°æå³ï¼\n * åå²è®°å½ï¼GET åæ°ä¼è¢«ä¿çãPOST ä¸ä¼ä¿çã\n\ncontinue...\n\n\n# å¦ä½çè§£ HTTP æ¯æ ç¶æç\n\næ ç¶ææå³çåä¸ªæµè§å¨åèµ·å¤æ¬¡è¯·æ±ï¼è½ç¶æå¡å¨ä¼ååºï¼ä½ä¸ä¼ç¥éä½ æ¯åä¸ä¸ªæµè§å¨ã\n\nhttp + cookie/session å¯ä»¥å®ç°æç¶æã\n\n\n# å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äºï¼è¿ä¸æ³æ­å¼è¿æ¥æä¹åï¼æä¹ç»´æï¼\n\nè®¾ç½® connection: keep-aliveï¼ä½¿ç¨é¿è¿æ¥ã\n\n\n# HTTPç¼å­\n\nå¼ºç¼å­ï¼\n\nä¼æè¯·æ±ï¼ä½æ¯ä¸ä¼åæå¡å¨åéè¯·æ±ï¼ç´æ¥ä»ç¼å­ä¸­è¯»åèµæºï¼ä¼æä¸ä¸ªååºä¸º200ï¼from disk cache)çã\n\nååºå¤´ï¼\n\n * Expiresï¼http1.0ï¼ï¼response headeréçè¿ææ¶é´ï¼æµè§å¨åæ¬¡å è½½èµæºæ¶ï¼å¦æå¨è¿ä¸ªè¿ææ¶é´åï¼åå½ä¸­å¼ºç¼å­ã\n\n * Cache-Controlï¼http1.1ï¼ä¼åçº§æ´é«ï¼ï¼å½å¼è®¾ä¸ºmax-age=300æ¶ï¼è¡¨ç¤ºäºåéååæ¬¡å è½½èµæºï¼å°±ä¼å½ä¸­ç¼å­\n\nååç¼å­ï¼å¯¹æ¯ç¼å­ï¼ï¼\n\néè¦åæå¡å¨åéheaderè¯·æ±ï¼æå¡å¨æ ¹æ®è¯·æ±çrequest headerçä¸äºåæ°æ¥å¤æ­æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­ï¼åè¿å304ç¶æç å¹¶å¸¦ä¸æ°çresponse headeréç¥æµè§å¨ä»ç¼å­ä¸­è¯»åèµæºã\n\nè¯·æ±å¤´ï¼\n\n * If-None-Matchï¼å¯é æ§ä¼åï¼ï¼å­æ¾ETagçå¼ã\n\n * If-Modified-Sinceï¼æ§è½ä¼åï¼ï¼å­æ¾Last-Modifiedçå¼ã\n\nååºå¤´ï¼\n\n * ETagï¼å¯é æ§ä¼åï¼ï¼æ¯å¯¹èµæºçä¸ç§å¯ä¸æ è¯ï¼åªè¦èµæºåå®¹æååï¼ETagå°±ä¼éæ°çæã\n\n * Last-Modifiedï¼æ§è½ä¼åï¼ï¼æ¯èµæºæä»¶æåä¸æ¬¡æ´æ¹æ¶é´ï¼æ¶é´åä½æ¯ç§ï¼å¦æ1ç§åä¿®æ¹Næ¬¡ï¼åLast-Modifiedä¸ä¼ååºååï¼ã\n\næµè§å¨ç¼å­è¿ç¨ï¼\n\n1.æµè§å¨ç¬¬ä¸æ¬¡åéè¯·æ±å è½½æ°æ®ï¼æå¡å¨è¿å200ï¼å°èµæºæä»¶ä»æå¡å¨ä¸è½½ä¸æ¥ï¼å¹¶ä¿å­ååºå¤´ä¸­çCache-ControlåExpires\n\n2.ä¸ä¸æ¬¡éè¦å è½½èµæºæ¶ï¼åæ¯è¾å½åæ¶é´ä¸ä¸ä¸æ¬¡è¿å200æ¶çæ¶é´å·®ï¼å¦ææ²¡æè¶è¿Cache-Controlè®¾ç½®çmax-ageï¼åæ²¡æè¿æï¼å½ä¸­å¼ºç¼å­ï¼ä¸åéè¯·æ±ç´æ¥ä»æ¬å°ç¼å­ä¸­è¯»åæä»¶ï¼å¦æä¸æ¯æHTTP1.1ï¼åç¨Expireså¤æ­æ¯å¦è¿æï¼\n\n3.å¦ææ¶é´è¿æï¼æå¡å¨åæ¥çheaderéçIf-None-MatchåIf-Modified-Since\n\n4.æå¡å¨ä¼åæ ¹æ®ETagçå¼å¤æ­è¢«è¯·æ±çæä»¶ææ²¡æåä¿®æ¹ï¼Etagå¼ä¸è´åæ²¡æä¿®æ¹ï¼å½ä¸­ååç¼å­ï¼è¿å304ï¼å¦æä¸ä¸è´åææ¹å¨ï¼ç´æ¥è¿åæ°çèµæºæä»¶å¸¦ä¸æ°çEtagå¼å¹¶è¿å 200ãï¼å¦ææ²¡æETagåå¯¹æ¯last-modifiedï¼\n\nç¨æ·è¡ä¸ºå¯¹æµè§å¨ç¼å­çæ§å¶ï¼\n\n1.å°åæ è®¿é®ï¼æ­£å¸¸ç¼å­æµç¨ã\n\n2.F5å·æ°ï¼è·³è¿å¼ºå¶ç¼å­ï¼ä½æ¯ä¼è¿è¡ååç¼å­ã\n\n3.ctrl+F5å¼ºå¶å·æ°ï¼è·³è¿å¼ºç¼å­ï¼è·³è¿ååç¼å­ï¼å¦åç¬¬ä¸æ¬¡ä¸æ ·åæå¡å¨æåèµæºã\n\nå¦ä½ä¸ç¼å­ï¼\n\nCache-Control: no-cacheï¼å¯¹èµæºä¼ä½¿ç¨ç¼å­ï¼ä½æ¯æ¬¡ä½¿ç¨ç¼å­åéè¦åæå¡å¨å¯¹ç¼å­èµæºè¿è¡éªè¯ï¼, no-storeï¼ä¸ä½¿ç¨ä»»ä½ç¼å­ï¼, must-revalidate\n\n\nExpiresï¼ï¼è®¾ç½®å½åæ¶é´ä¹åï¼\n\n\n//å¨å¼ç¨jsãcssæä»¶çurlåè¾¹å ä¸ ?+Math.random()\n<script type=âtext/javascriptâ src=â/js/test.js?+Math.random()â><\/script> \n\n\n//è®¾ç½®htmlé¡µé¢ä¸è®©æµè§å¨ç¼å­çæ¹æ³\n<meta http-equiv="pragma" content="no-cache"> \n<meta http-equiv="Cache-Control" content="no-cache, must-revalidate"> \n<meta http-equiv="expires" content="Wed, 26 Feb 1997 00:00:00 GMT">\n',normalizedContent:'# ä»ä¹æ¯ http\n\nè¶ææ¬ä¼ è¾åè®®æ¯ä¸ç§ç¨äºåå¸å¼ãåä½å¼åè¶åªä½ä¿¡æ¯ç³»ç»çåºç¨å±åè®®ï¼æ¯å ç¹ç½ä¸åºç¨æä¸ºå¹¿æ³çä¸ç§ç½ç»ä¼ è¾åè®®ï¼ææç www æä»¶é½å¿é¡»éµå®è¿ä¸ªæ åã\n\nhttp æ¯ä¸º web æµè§å¨ä¸ web æå¡å¨ä¹é´çéä¿¡èè®¾è®¡çï¼ä½ä¹å¯ä»¥ç¨äºå¶ä»ç®çã\n\nhttp æ¯ä¸ä¸ªåºäº tcp/ip éä¿¡åè®®æ¥ä¼ éæ°æ®çï¼html æä»¶ãå¾çæä»¶ãæ¥è¯¢ç»æç­ï¼ã\n\n\n# http ç¶æç \n\n * 1xxï¼ä¿¡æ¯æ§ç¶æç \n * 2xxï¼æå\n * 3xxï¼éå®å\n * 4xxï¼å®¢æ·ç«¯éè¯¯\n * 5xxï¼æå¡ç«¯éè¯¯\n\n\nå¸¸è§ç¶æç ï¼\n\n * 101ï¼åæ¢è¯·æ±åè®®ãæ¯å¦åæ¢å° http2 æ websocket åè®®ã\n * 200ï¼è¯·æ±æå\n * 301ï¼æ°¸ä¹éå®åï¼ä¼ç¼å­\n * 302ï¼ä¸´æ¶éå®åï¼ä¸ä¼ç¼å­ãè¯·æ±èä¹ååºç»§ç»­ä½¿ç¨åå°åè¯·æ±ã\n * 304 å½ä¸­ç¼å­ï¼ä¸å·æè·³è½¬æä¹ï¼éå®åå·²å­å¨çç¼å­æä»¶ã\n * 400ï¼å®¢æ·ç«¯è¯·æ±çè¯­æ³éè¯¯\n * 403ï¼æå¡ç«¯ç¦æ­¢è®¿é®ï¼è·æéæå³\n * 404ï¼æå¡ç«¯æ æ³æ ¹æ®å®¢æ·ç«¯è¯·æ±æ¾å°èµæº\n * 500ï¼æå¡ç«¯éè¯¯\n * 503ï¼æå¡å¨å½åå¾å¿ï¼ææ¶æ æ³ååº\n\n\n# http è¯·æ±æ¹å¼\n\n * getï¼å¯¹æå¡å¨èµæºè·åçè¯·æ±ï¼æ¯å®å¨å¹ç­çã\n * postï¼åéåå«ç¨æ·æäº¤æ°æ®çè¯·æ±\n * putï¼åæå¡ç«¯æäº¤æ°æ®ï¼ä»¥ä¿®æ¹æ°æ®ãåpostä¸æ ·ï¼ä½æ¯putæ¯å¹ç­çï¼ç¸åçå¤ä¸ªputè¯·æ±ï¼ç­åäºåªåéäºä¸ä¸ªputè¯·æ±ï¼å ä¸ºputæ¯ç´æ¥æåä¿®æ¹èµæºçï¼èpostæ¯æåä¿®æ¹èµæºçç¶çº§èµæºï¼\n * deleteï¼å é¤æå¡ç«¯æäºèµæº\n * headï¼è¯·æ±é¡µé¢çé¦é¨ï¼è·åèµæºçåä¿¡æ¯\n * connectï¼ç¨äºsslé§éçåºäºä»£ççè¯·æ±\n * optionsï¼è¿åææå¯ç¨çæ¹æ³ï¼å¸¸ç¨äºè·¨å\n * traceï¼è¿½è¸ªè¯·æ±-ååºçä¼ è¾è·¯å¾\n\n\n# content-type\n\nå³internet media typeï¼äºèç½åªä½ç±»åï¼ãéè¿åç¥ç±»åè®©æ¥æ¶æ¹å¾ä»¥è¿è¡ç¸åºçå¤çã\n\ncontent-type                        æè¿°\napplication/xml                     xmlæ°æ®æ ¼å¼\napplication/json                    jsonæ°æ®æ ¼å¼\napplication/pdf                     pdfæ ¼å¼\ntext/html                           htmlæ ¼å¼\napplication/x-www-form-urlencoded   è¡¨åæäº¤æ°æ®é»è®¤æ ¼å¼\n\n\n# å¸¸è§ç«¯å£å¯¹åºçæå¡\n\n * 21ï¼ftp æä»¶ä¼ è¾åè®®\n * 22ï¼ssh\n * 23ï¼telnet è¿ç¨ç»å½æå¡\n * 25ï¼smtp ç®åé®ä»¶ä¼ è¾åè®®\n * 53ï¼dsn ååæå¡å¨\n * 80ï¼http\n * 110ï¼pop3 é®ä»¶åè®®\n * 443ï¼https\n * 1080ï¼sockets\n * 1521ï¼oracle\n * 3306ï¼mysql\n\n\n# getåpostçåºå«\n\n * è¯·æ±åæ°ï¼get çè¯·æ±åæ°å¨ url ä¸­ï¼ç¨ & è¿æ¥ãpost çéè¿ request body ä¼ åã\n * åæ°æ°æ®ç±»åï¼get åªè½æ¯ ascii çå­ç¬¦ãpost æ²¡æéå¶ã\n * è¯·æ±ç¼å­ï¼get ä¼è¢«ä¸»å¨ cacheãpost ä¸ä¼è¢«ç¼å­ï¼é¤éæå¨è®¾ç½®ã\n * æ°æ®åï¼get äº§çä¸ä¸ª tcp æ°æ®åãpost äº§çä¸¤ä¸ªãï¼è¿å¥½åè·æµè§å¨çå®ç°æå³ï¼\n * åå²è®°å½ï¼get åæ°ä¼è¢«ä¿çãpost ä¸ä¼ä¿çã\n\ncontinue...\n\n\n# å¦ä½çè§£ http æ¯æ ç¶æç\n\næ ç¶ææå³çåä¸ªæµè§å¨åèµ·å¤æ¬¡è¯·æ±ï¼è½ç¶æå¡å¨ä¼ååºï¼ä½ä¸ä¼ç¥éä½ æ¯åä¸ä¸ªæµè§å¨ã\n\nhttp + cookie/session å¯ä»¥å®ç°æç¶æã\n\n\n# å¨äº¤äºè¿ç¨ä¸­å¦ææ°æ®ä¼ éå®äºï¼è¿ä¸æ³æ­å¼è¿æ¥æä¹åï¼æä¹ç»´æï¼\n\nè®¾ç½® connection: keep-aliveï¼ä½¿ç¨é¿è¿æ¥ã\n\n\n# httpç¼å­\n\nå¼ºç¼å­ï¼\n\nä¼æè¯·æ±ï¼ä½æ¯ä¸ä¼åæå¡å¨åéè¯·æ±ï¼ç´æ¥ä»ç¼å­ä¸­è¯»åèµæºï¼ä¼æä¸ä¸ªååºä¸º200ï¼from disk cache)çã\n\nååºå¤´ï¼\n\n * expiresï¼http1.0ï¼ï¼response headeréçè¿ææ¶é´ï¼æµè§å¨åæ¬¡å è½½èµæºæ¶ï¼å¦æå¨è¿ä¸ªè¿ææ¶é´åï¼åå½ä¸­å¼ºç¼å­ã\n\n * cache-controlï¼http1.1ï¼ä¼åçº§æ´é«ï¼ï¼å½å¼è®¾ä¸ºmax-age=300æ¶ï¼è¡¨ç¤ºäºåéååæ¬¡å è½½èµæºï¼å°±ä¼å½ä¸­ç¼å­\n\nååç¼å­ï¼å¯¹æ¯ç¼å­ï¼ï¼\n\néè¦åæå¡å¨åéheaderè¯·æ±ï¼æå¡å¨æ ¹æ®è¯·æ±çrequest headerçä¸äºåæ°æ¥å¤æ­æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­ï¼åè¿å304ç¶æç å¹¶å¸¦ä¸æ°çresponse headeréç¥æµè§å¨ä»ç¼å­ä¸­è¯»åèµæºã\n\nè¯·æ±å¤´ï¼\n\n * if-none-matchï¼å¯é æ§ä¼åï¼ï¼å­æ¾etagçå¼ã\n\n * if-modified-sinceï¼æ§è½ä¼åï¼ï¼å­æ¾last-modifiedçå¼ã\n\nååºå¤´ï¼\n\n * etagï¼å¯é æ§ä¼åï¼ï¼æ¯å¯¹èµæºçä¸ç§å¯ä¸æ è¯ï¼åªè¦èµæºåå®¹æååï¼etagå°±ä¼éæ°çæã\n\n * last-modifiedï¼æ§è½ä¼åï¼ï¼æ¯èµæºæä»¶æåä¸æ¬¡æ´æ¹æ¶é´ï¼æ¶é´åä½æ¯ç§ï¼å¦æ1ç§åä¿®æ¹næ¬¡ï¼ålast-modifiedä¸ä¼ååºååï¼ã\n\næµè§å¨ç¼å­è¿ç¨ï¼\n\n1.æµè§å¨ç¬¬ä¸æ¬¡åéè¯·æ±å è½½æ°æ®ï¼æå¡å¨è¿å200ï¼å°èµæºæä»¶ä»æå¡å¨ä¸è½½ä¸æ¥ï¼å¹¶ä¿å­ååºå¤´ä¸­çcache-controlåexpires\n\n2.ä¸ä¸æ¬¡éè¦å è½½èµæºæ¶ï¼åæ¯è¾å½åæ¶é´ä¸ä¸ä¸æ¬¡è¿å200æ¶çæ¶é´å·®ï¼å¦ææ²¡æè¶è¿cache-controlè®¾ç½®çmax-ageï¼åæ²¡æè¿æï¼å½ä¸­å¼ºç¼å­ï¼ä¸åéè¯·æ±ç´æ¥ä»æ¬å°ç¼å­ä¸­è¯»åæä»¶ï¼å¦æä¸æ¯æhttp1.1ï¼åç¨expireså¤æ­æ¯å¦è¿æï¼\n\n3.å¦ææ¶é´è¿æï¼æå¡å¨åæ¥çheaderéçif-none-matchåif-modified-since\n\n4.æå¡å¨ä¼åæ ¹æ®etagçå¼å¤æ­è¢«è¯·æ±çæä»¶ææ²¡æåä¿®æ¹ï¼etagå¼ä¸è´åæ²¡æä¿®æ¹ï¼å½ä¸­ååç¼å­ï¼è¿å304ï¼å¦æä¸ä¸è´åææ¹å¨ï¼ç´æ¥è¿åæ°çèµæºæä»¶å¸¦ä¸æ°çetagå¼å¹¶è¿å 200ãï¼å¦ææ²¡æetagåå¯¹æ¯last-modifiedï¼\n\nç¨æ·è¡ä¸ºå¯¹æµè§å¨ç¼å­çæ§å¶ï¼\n\n1.å°åæ è®¿é®ï¼æ­£å¸¸ç¼å­æµç¨ã\n\n2.f5å·æ°ï¼è·³è¿å¼ºå¶ç¼å­ï¼ä½æ¯ä¼è¿è¡ååç¼å­ã\n\n3.ctrl+f5å¼ºå¶å·æ°ï¼è·³è¿å¼ºç¼å­ï¼è·³è¿ååç¼å­ï¼å¦åç¬¬ä¸æ¬¡ä¸æ ·åæå¡å¨æåèµæºã\n\nå¦ä½ä¸ç¼å­ï¼\n\ncache-control: no-cacheï¼å¯¹èµæºä¼ä½¿ç¨ç¼å­ï¼ä½æ¯æ¬¡ä½¿ç¨ç¼å­åéè¦åæå¡å¨å¯¹ç¼å­èµæºè¿è¡éªè¯ï¼, no-storeï¼ä¸ä½¿ç¨ä»»ä½ç¼å­ï¼, must-revalidate\n\n\nexpiresï¼ï¼è®¾ç½®å½åæ¶é´ä¹åï¼\n\n\n//å¨å¼ç¨jsãcssæä»¶çurlåè¾¹å ä¸ ?+math.random()\n<script type=âtext/javascriptâ src=â/js/test.js?+math.random()â><\/script> \n\n\n//è®¾ç½®htmlé¡µé¢ä¸è®©æµè§å¨ç¼å­çæ¹æ³\n<meta http-equiv="pragma" content="no-cache"> \n<meta http-equiv="cache-control" content="no-cache, must-revalidate"> \n<meta http-equiv="expires" content="wed, 26 feb 1997 00:00:00 gmt">\n',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"HTTPS",frontmatter:{title:"HTTPS",date:"2023-03-21T18:22:20.000Z",permalink:"/pages/43e2c1/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02.%E5%BA%94%E7%94%A8%E5%B1%82/03.https.html",relativePath:"04.è®¡ç®æºç½ç»/02.åºç¨å±/03.https.md",key:"v-0b9e1aec",path:"/pages/43e2c1/",headers:[{level:2,title:"HTTP å HTTPS çåºå«",slug:"http-å-https-çåºå«",normalizedTitle:"http å https çåºå«",charIndex:2},{level:2,title:"HTTPSçç¹ç¹",slug:"httpsçç¹ç¹",normalizedTitle:"httpsçç¹ç¹",charIndex:167},{level:2,title:"HTTPSæµç¨",slug:"httpsæµç¨",normalizedTitle:"httpsæµç¨",charIndex:925},{level:2,title:"å³äºæ°å­è¯ä¹¦",slug:"å³äºæ°å­è¯ä¹¦",normalizedTitle:"å³äºæ°å­è¯ä¹¦",charIndex:1332},{level:2,title:"QA",slug:"qa",normalizedTitle:"qa",charIndex:1685}],headersStr:"HTTP å HTTPS çåºå« HTTPSçç¹ç¹ HTTPSæµç¨ å³äºæ°å­è¯ä¹¦ QA",content:"# HTTP å HTTPS çåºå«\n\n * HTTPä½¿ç¨ç80ç«¯å£ï¼HTTPSä½¿ç¨çæ¯443ç«¯å£\n * HTTPåè®®ä¸æä¾ä»»ä½æ¹å¼çæ°æ®å å¯ï¼HTTPSå¨HTTPåè®®çåºç¡ä¸å å¥äºSSL/TSLåè®®ï¼å¨åºç¨å±åä¼ è¾å±ä¹é´æ·»å äºå®å¨å±ï¼\n * HTTPSåè®®éè¦åCAï¼è¯ä¹¦æå¨æºæï¼ç³è¯·æ°å­è¯ä¹¦ï¼æ¥ä¿è¯æå¡å¨çèº«ä»½æ¯å¯ä¿¡ç\n\n\n# HTTPSçç¹ç¹\n\n * æ··åå å¯ï¼å¯¹ç§°å å¯åéå¯¹ç§°å å¯ç»åï¼\n   \n   éä¿¡å»ºç«åéç¨éå¯¹ç§°å å¯çæ¹å¼äº¤æ¢ä¼è¯å¯é¥ï¼åç»­å°ä¸åä½¿ç¨éå¯¹ç§°å å¯ãéä¿¡è¿ç¨ä¸­ä½¿ç¨å¯¹ç§°å å¯çä¼è¯å¯é¥çæ¹å¼å å¯æææ°æ®ã\n   \n   ä¸ºä»ä¹è¦ä½¿ç¨æ··åå å¯çæ¹å¼\n   \n   å¯¹ç§°å å¯ä½¿ç¨ä¸ä¸ªå¯é¥ï¼è¿è¡éåº¦å¿«ï¼å¯é¥å¿é¡»ä¿å¯ï¼æ æ³åå°å®å¨çå¯é¥äº¤æ¢ãéå¯¹ç§°å å¯ä½¿ç¨ä¸¤ä¸ªå¯é¥ï¼å¬é¥åç§é¥ï¼å¬é¥å¯ä»¥ä»»æååèç§é¥ä¿å¯ï¼è§£å³äºå¯é¥äº¤æ¢é®é¢ä½æ¯éåº¦æ¢ã\n\n * æè¦ç®æ³\n   \n   è¦æ¥éªè¯æ°æ®çå®æ´æ§\n   \n   ä¼ è¾ä¹åå°ææä½¿ç¨æè¦ç®æ³è¿è¡å å¯çææè¦ï¼ç¶åå°ææåæè¦éè¿ä¼è¯å¯é¥è¿è¡å å¯åä¼ è¾ç»å¯¹æ¹ï¼å¯¹æ¹ä½¿ç¨ä¼è¯å¯é¥è§£å¯ä¹åï¼å¯¹ææåæ¬¡è¿è¡æè¦ç®æ³ï¼å¯¹æ¯ååçæçæè¦æ¯å¦ä¸è´æ¥éªè¯ä¼ è¾æ°æ®çå®æ´æ§\n\n * æ°å­è¯ä¹¦ï¼å¯¹éå¯¹ç§°å å¯çå¬é¥è¿è¡å å¯ï¼\n\n 1. ç³è¯·è¯ä¹¦ï¼ç³è¯·äººåæ°å­è¯ä¹¦é¢åæºæï¼CAï¼æäº¤è¯ä¹¦ç³è¯·ï¼å¹¶æä¾å¿è¦çèº«ä»½ä¿¡æ¯ï¼å¦å§åãå¬å¸åç§°ãé®ç®±å°åç­ã\n 2. èº«ä»½éªè¯ï¼CAä¼å¯¹ç³è¯·äººè¿è¡èº«ä»½éªè¯ï¼ä»¥ç¡®ä¿ç³è¯·äººçèº«ä»½çå®å¯ä¿¡ï¼ä¸è¬åæ¬éªè¯èº«ä»½è¯æãèç³»å¬å¸ç­æ¹å¼ã\n 3. çæå¯é¥å¯¹ï¼CAä¸ºç³è¯·äººçæå¯é¥å¯¹ï¼å¬é¥åç§é¥ï¼ï¼å¬é¥ç¨äºå å¯æ°æ®ï¼ç§é¥ç¨äºè§£å¯æ°æ®ã\n 4. è¯ä¹¦ç­¾åï¼CAä½¿ç¨èªå·±çç§é¥å¯¹ç³è¯·äººçå¬é¥åèº«ä»½ä¿¡æ¯è¿è¡æ°å­ç­¾åï¼çææ°å­è¯ä¹¦ã\n 5. è¯ä¹¦åå¸ï¼CAå°æ°å­è¯ä¹¦åå¸å°è¯ä¹¦åå¸ç³»ç»ä¸­ï¼ç³è¯·äººå¯ä»¥éè¿ä¸è½½è¯ä¹¦è·å¾èªå·±çå¬é¥åæ°å­ç­¾åç­ä¿¡æ¯ãCA çå¬é¥ä¹æ¯éè¦ä½¿ç¨è¯ä¹¦æ¥ååçï¼æä»¥çµèå¿é¡»å®è£ CA çè¯ä¹¦ï¼è¯ä¹¦éåå«äº CA çå¬é¥ã\n 6. è¯ä¹¦éªè¯ï¼å¶ä»ç¨æ·ï¼å¦æµè§å¨ï¼å¨ä¸ç³è¯·äººè¿è¡éä¿¡æ¶ï¼ä¼éè¿CAçæ°å­è¯ä¹¦éªè¯ç³è¯·äººçèº«ä»½åå¬é¥ççå®æ§ï¼å¹¶ç¡®ä¿éä¿¡è¿ç¨çå®å¨åå®æ´æ§ã\n\n\n# HTTPSæµç¨\n\n 1. å®¢æ·ç«¯åèµ·HTTPSè¯·æ±ï¼å®¢æ·ç«¯åæå¡å¨åèµ·HTTPSè¯·æ±ï¼è¯·æ±è¿æ¥å°æå¡å¨ãï¼åè¿è¡TCPä¸æ¬¡æ¡æï¼\n 2. æå¡å¨ååºè¯·æ±ï¼æå¡å¨æ¥æ¶å°å®¢æ·ç«¯è¯·æ±åï¼è¿åæ°å­è¯ä¹¦ã\n 3. å®¢æ·ç«¯éªè¯è¯ä¹¦ï¼å®¢æ·ç«¯ä½¿ç¨CAçå¬é¥å¯¹æ°å­è¯ä¹¦è§£å¯ï¼éªè¯æå¡å¨çèº«ä»½ï¼å¹¶æ£æ¥è¯ä¹¦çæææ§åå®æ´æ§ï¼å¹¶å¾å°æå¡å¨çå¬é¥ã\n 4. å®¢æ·ç«¯çæéæºå¯é¥ï¼å®¢æ·ç«¯çæä¸ä¸ªéæºçå¯¹ç§°å¯é¥ï¼ä¼è¯å¯é¥ï¼ï¼ç¨äºå å¯éä¿¡è¿ç¨ä¸­çæ°æ®ã\n 5. å®¢æ·ç«¯ä½¿ç¨æå¡å¨å¬é¥å å¯å¯é¥ï¼å®¢æ·ç«¯ä½¿ç¨æå¡å¨å¬é¥å¯¹éæºçæçå¯¹ç§°å¯é¥è¿è¡å å¯ï¼ç¶åå°å å¯åçå¯é¥åéç»æå¡å¨ã\n 6. æå¡å¨ä½¿ç¨ç§é¥è§£å¯å¯é¥ï¼æå¡å¨ä½¿ç¨èªå·±çç§é¥å¯¹æ¥æ¶å°çå å¯å¯é¥è¿è¡è§£å¯ï¼å¾å°å¯¹ç§°å¯é¥ã\n 7. å®¢æ·ç«¯ä¸æå¡å¨å¼å§å å¯éä¿¡ï¼å®¢æ·ç«¯åæå¡å¨ä½¿ç¨å¯¹ç§°å¯é¥è¿è¡å å¯éä¿¡ï¼ç¡®ä¿éä¿¡è¿ç¨çå®å¨æ§åéç§æ§ã\n 8. éä¿¡ç»æï¼å®¢æ·ç«¯åæå¡å¨å¨éä¿¡ç»ææ¶ï¼å³é­è¿æ¥ã\n\n\n# å³äºæ°å­è¯ä¹¦\n\nè¯ä¹¦é¢åæºææ¯æå±çº§å³ç³»çï¼ä¸çº§ CA çè¯ä¹¦æ¯éè¦ç±ä¸çº§ CA ç­¾åçã\n\næ¢å¥è¯è¯´ä¸å®å­å¨æ ¹è¯ä¹¦é¢åæºæï¼æ ¹è¯ä¹¦å¯ä»¥èªç­¾ï¼èªå·±ç»èªå·±è®¤è¯ã\n\nå¦ä½ä¿è¯æ ¹è¯ä¹¦çå¯é æ§ï¼è¿æ¯æä½ç³»ç»åæµè§å¨é¢è£çï¼ç±å¾®è½¯ãè¹æç­æä½ç³»ç»ååæ¥éæ©æ ¹è¯ä¹¦ã\n\nè¯ä¹¦ä¸å¯ä¿¡ï¼é£ä¹ä»ä¹æåµä¸æµè§å¨ä¼æç¤º âè¯ä¹¦ä¸å¯ä¿¡â å¢ï¼\n\nå¯è½çåå ï¼\n\n * è¯ä¹¦ä¸æ¯æå¨ CA é¢åï¼æäºä¼ä¸ä¸ºäºè´ªå¾ä¾¿å®ä½¿ç¨çççè¯ä¹¦ï¼æ²¡æç»è¿ CA è®¤è¯ãä¹å°±æ¯æ æ³ä½¿ç¨æµè§å¨åç½® CA å¬é¥è¿è¡éªè¯ã\n\n * è¯ä¹¦è¿æï¼è¯ä¹¦éæä¸é¡¹å°±æ¯æææï¼ä¸è¬å°±æ¯ä¸å¹´æèä¸¤å¹´çæ¶é´ãå¦æè¯ä¹¦è¿æï¼é£ä¹æµè§å¨å°±ä¼æç¤ºâè¯ä¹¦ä¸å¯ä¿¡â\n\n * è¯ä¹¦é¨ç½²éè¯¯ï¼å¯è½æ¯æå¡å¨è¯ä¹¦é¨ç½²åºéï¼æ¯å¦è¯ä¹¦ä¸ååä¸å¹éï¼å ä¸ºè¯ä¹¦éæä¸é¡¹æ¯ææäººä¿¡æ¯çã\n\n\n# QA\n\n 1. éå¯¹ç§°å å¯ä¸­å¬ç§é¥é½å¯ä»¥å å¯ï¼é£ä¹ä»ä¹æ¶åç¨å¬é¥å å¯ï¼ä»ä¹æ¶åç¨ç§é¥âå å¯â ï¼\n    * å å¯åºæ¯ï¼é£ä¹è¯å®å¸æåªæææè½è§£å¯ï¼å«äººåªè½å å¯ãå³å¬é¥å å¯ï¼ç§é¥è§£å¯ã\n    * ç­¾ååºæ¯ï¼æ¢ç¶æ¯ç­¾åï¼å°±å¸æåªè½ææè½ç­¾åï¼å«äººåªè½éªè¯ãå³ç§é¥ç­¾åï¼å¬é¥éªç­¾\n 2. ä»ä¹æ¯æ°å­ç­¾åï¼æ°å­ç­¾åçä½ç¨æ¯ä»ä¹ï¼\n    * æ°å­ç­¾åå°±æ¯ä½¿ç¨ç§é¥å¯¹æ°æ®æè¦è¿è¡ç­¾åï¼å¹¶éå¸¦åæ°æ®ä¸èµ·åéã\n    * å¯ä»¥èµ·å°é²ç¯¡æ¹ãé²ä¼ªè£ãé²å¦è®¤çä½ç¨ã\n 3. ä¸ºä»ä¹è¦å¯¹æ°æ®çæè¦è¿è¡ç­¾åï¼èä¸æ¯ç´æ¥è®¡ç®åå§æ°æ®çæ°å­ç­¾åï¼\n    * æ°æ®å¯è½æ¯è¾å¤§ï¼ç­¾åæ¯ä½¿ç¨éå¯¹ç§°å å¯ç®æ³ï¼æ¯è¾èæ¶\n    * é²æ­¢ç¬¬ä¸æ¹ä½¿ç¨å¬é¥è§£å¼ç­¾ååï¼æ¿å°åå§æ°æ®\n 4. ä»ä¹æ¯æ°å­è¯ä¹¦ï¼æ°å­è¯ä¹¦å­å¨è§£å³äºä»ä¹é®é¢ï¼\n    * æ°å­è¯ä¹¦å°±æ¯ç± CA æºæä½¿ç¨èªå·±ç§é¥ï¼å¯¹è¯ä¹¦ç³è¯·èçå¬é¥è¿è¡ç­¾åè®¤è¯ã\n    * æ°å­è¯ä¹¦è§£å³äºå¦ä½å®å¨ååå¬é¥çé®é¢ï¼ä¹å¥ å®äºä¿¡ä»»é¾çåºç¡ã",normalizedContent:"# http å https çåºå«\n\n * httpä½¿ç¨ç80ç«¯å£ï¼httpsä½¿ç¨çæ¯443ç«¯å£\n * httpåè®®ä¸æä¾ä»»ä½æ¹å¼çæ°æ®å å¯ï¼httpså¨httpåè®®çåºç¡ä¸å å¥äºssl/tslåè®®ï¼å¨åºç¨å±åä¼ è¾å±ä¹é´æ·»å äºå®å¨å±ï¼\n * httpsåè®®éè¦åcaï¼è¯ä¹¦æå¨æºæï¼ç³è¯·æ°å­è¯ä¹¦ï¼æ¥ä¿è¯æå¡å¨çèº«ä»½æ¯å¯ä¿¡ç\n\n\n# httpsçç¹ç¹\n\n * æ··åå å¯ï¼å¯¹ç§°å å¯åéå¯¹ç§°å å¯ç»åï¼\n   \n   éä¿¡å»ºç«åéç¨éå¯¹ç§°å å¯çæ¹å¼äº¤æ¢ä¼è¯å¯é¥ï¼åç»­å°ä¸åä½¿ç¨éå¯¹ç§°å å¯ãéä¿¡è¿ç¨ä¸­ä½¿ç¨å¯¹ç§°å å¯çä¼è¯å¯é¥çæ¹å¼å å¯æææ°æ®ã\n   \n   ä¸ºä»ä¹è¦ä½¿ç¨æ··åå å¯çæ¹å¼\n   \n   å¯¹ç§°å å¯ä½¿ç¨ä¸ä¸ªå¯é¥ï¼è¿è¡éåº¦å¿«ï¼å¯é¥å¿é¡»ä¿å¯ï¼æ æ³åå°å®å¨çå¯é¥äº¤æ¢ãéå¯¹ç§°å å¯ä½¿ç¨ä¸¤ä¸ªå¯é¥ï¼å¬é¥åç§é¥ï¼å¬é¥å¯ä»¥ä»»æååèç§é¥ä¿å¯ï¼è§£å³äºå¯é¥äº¤æ¢é®é¢ä½æ¯éåº¦æ¢ã\n\n * æè¦ç®æ³\n   \n   è¦æ¥éªè¯æ°æ®çå®æ´æ§\n   \n   ä¼ è¾ä¹åå°ææä½¿ç¨æè¦ç®æ³è¿è¡å å¯çææè¦ï¼ç¶åå°ææåæè¦éè¿ä¼è¯å¯é¥è¿è¡å å¯åä¼ è¾ç»å¯¹æ¹ï¼å¯¹æ¹ä½¿ç¨ä¼è¯å¯é¥è§£å¯ä¹åï¼å¯¹ææåæ¬¡è¿è¡æè¦ç®æ³ï¼å¯¹æ¯ååçæçæè¦æ¯å¦ä¸è´æ¥éªè¯ä¼ è¾æ°æ®çå®æ´æ§\n\n * æ°å­è¯ä¹¦ï¼å¯¹éå¯¹ç§°å å¯çå¬é¥è¿è¡å å¯ï¼\n\n 1. ç³è¯·è¯ä¹¦ï¼ç³è¯·äººåæ°å­è¯ä¹¦é¢åæºæï¼caï¼æäº¤è¯ä¹¦ç³è¯·ï¼å¹¶æä¾å¿è¦çèº«ä»½ä¿¡æ¯ï¼å¦å§åãå¬å¸åç§°ãé®ç®±å°åç­ã\n 2. èº«ä»½éªè¯ï¼caä¼å¯¹ç³è¯·äººè¿è¡èº«ä»½éªè¯ï¼ä»¥ç¡®ä¿ç³è¯·äººçèº«ä»½çå®å¯ä¿¡ï¼ä¸è¬åæ¬éªè¯èº«ä»½è¯æãèç³»å¬å¸ç­æ¹å¼ã\n 3. çæå¯é¥å¯¹ï¼caä¸ºç³è¯·äººçæå¯é¥å¯¹ï¼å¬é¥åç§é¥ï¼ï¼å¬é¥ç¨äºå å¯æ°æ®ï¼ç§é¥ç¨äºè§£å¯æ°æ®ã\n 4. è¯ä¹¦ç­¾åï¼caä½¿ç¨èªå·±çç§é¥å¯¹ç³è¯·äººçå¬é¥åèº«ä»½ä¿¡æ¯è¿è¡æ°å­ç­¾åï¼çææ°å­è¯ä¹¦ã\n 5. è¯ä¹¦åå¸ï¼caå°æ°å­è¯ä¹¦åå¸å°è¯ä¹¦åå¸ç³»ç»ä¸­ï¼ç³è¯·äººå¯ä»¥éè¿ä¸è½½è¯ä¹¦è·å¾èªå·±çå¬é¥åæ°å­ç­¾åç­ä¿¡æ¯ãca çå¬é¥ä¹æ¯éè¦ä½¿ç¨è¯ä¹¦æ¥ååçï¼æä»¥çµèå¿é¡»å®è£ ca çè¯ä¹¦ï¼è¯ä¹¦éåå«äº ca çå¬é¥ã\n 6. è¯ä¹¦éªè¯ï¼å¶ä»ç¨æ·ï¼å¦æµè§å¨ï¼å¨ä¸ç³è¯·äººè¿è¡éä¿¡æ¶ï¼ä¼éè¿caçæ°å­è¯ä¹¦éªè¯ç³è¯·äººçèº«ä»½åå¬é¥ççå®æ§ï¼å¹¶ç¡®ä¿éä¿¡è¿ç¨çå®å¨åå®æ´æ§ã\n\n\n# httpsæµç¨\n\n 1. å®¢æ·ç«¯åèµ·httpsè¯·æ±ï¼å®¢æ·ç«¯åæå¡å¨åèµ·httpsè¯·æ±ï¼è¯·æ±è¿æ¥å°æå¡å¨ãï¼åè¿è¡tcpä¸æ¬¡æ¡æï¼\n 2. æå¡å¨ååºè¯·æ±ï¼æå¡å¨æ¥æ¶å°å®¢æ·ç«¯è¯·æ±åï¼è¿åæ°å­è¯ä¹¦ã\n 3. å®¢æ·ç«¯éªè¯è¯ä¹¦ï¼å®¢æ·ç«¯ä½¿ç¨caçå¬é¥å¯¹æ°å­è¯ä¹¦è§£å¯ï¼éªè¯æå¡å¨çèº«ä»½ï¼å¹¶æ£æ¥è¯ä¹¦çæææ§åå®æ´æ§ï¼å¹¶å¾å°æå¡å¨çå¬é¥ã\n 4. å®¢æ·ç«¯çæéæºå¯é¥ï¼å®¢æ·ç«¯çæä¸ä¸ªéæºçå¯¹ç§°å¯é¥ï¼ä¼è¯å¯é¥ï¼ï¼ç¨äºå å¯éä¿¡è¿ç¨ä¸­çæ°æ®ã\n 5. å®¢æ·ç«¯ä½¿ç¨æå¡å¨å¬é¥å å¯å¯é¥ï¼å®¢æ·ç«¯ä½¿ç¨æå¡å¨å¬é¥å¯¹éæºçæçå¯¹ç§°å¯é¥è¿è¡å å¯ï¼ç¶åå°å å¯åçå¯é¥åéç»æå¡å¨ã\n 6. æå¡å¨ä½¿ç¨ç§é¥è§£å¯å¯é¥ï¼æå¡å¨ä½¿ç¨èªå·±çç§é¥å¯¹æ¥æ¶å°çå å¯å¯é¥è¿è¡è§£å¯ï¼å¾å°å¯¹ç§°å¯é¥ã\n 7. å®¢æ·ç«¯ä¸æå¡å¨å¼å§å å¯éä¿¡ï¼å®¢æ·ç«¯åæå¡å¨ä½¿ç¨å¯¹ç§°å¯é¥è¿è¡å å¯éä¿¡ï¼ç¡®ä¿éä¿¡è¿ç¨çå®å¨æ§åéç§æ§ã\n 8. éä¿¡ç»æï¼å®¢æ·ç«¯åæå¡å¨å¨éä¿¡ç»ææ¶ï¼å³é­è¿æ¥ã\n\n\n# å³äºæ°å­è¯ä¹¦\n\nè¯ä¹¦é¢åæºææ¯æå±çº§å³ç³»çï¼ä¸çº§ ca çè¯ä¹¦æ¯éè¦ç±ä¸çº§ ca ç­¾åçã\n\næ¢å¥è¯è¯´ä¸å®å­å¨æ ¹è¯ä¹¦é¢åæºæï¼æ ¹è¯ä¹¦å¯ä»¥èªç­¾ï¼èªå·±ç»èªå·±è®¤è¯ã\n\nå¦ä½ä¿è¯æ ¹è¯ä¹¦çå¯é æ§ï¼è¿æ¯æä½ç³»ç»åæµè§å¨é¢è£çï¼ç±å¾®è½¯ãè¹æç­æä½ç³»ç»ååæ¥éæ©æ ¹è¯ä¹¦ã\n\nè¯ä¹¦ä¸å¯ä¿¡ï¼é£ä¹ä»ä¹æåµä¸æµè§å¨ä¼æç¤º âè¯ä¹¦ä¸å¯ä¿¡â å¢ï¼\n\nå¯è½çåå ï¼\n\n * è¯ä¹¦ä¸æ¯æå¨ ca é¢åï¼æäºä¼ä¸ä¸ºäºè´ªå¾ä¾¿å®ä½¿ç¨çççè¯ä¹¦ï¼æ²¡æç»è¿ ca è®¤è¯ãä¹å°±æ¯æ æ³ä½¿ç¨æµè§å¨åç½® ca å¬é¥è¿è¡éªè¯ã\n\n * è¯ä¹¦è¿æï¼è¯ä¹¦éæä¸é¡¹å°±æ¯æææï¼ä¸è¬å°±æ¯ä¸å¹´æèä¸¤å¹´çæ¶é´ãå¦æè¯ä¹¦è¿æï¼é£ä¹æµè§å¨å°±ä¼æç¤ºâè¯ä¹¦ä¸å¯ä¿¡â\n\n * è¯ä¹¦é¨ç½²éè¯¯ï¼å¯è½æ¯æå¡å¨è¯ä¹¦é¨ç½²åºéï¼æ¯å¦è¯ä¹¦ä¸ååä¸å¹éï¼å ä¸ºè¯ä¹¦éæä¸é¡¹æ¯ææäººä¿¡æ¯çã\n\n\n# qa\n\n 1. éå¯¹ç§°å å¯ä¸­å¬ç§é¥é½å¯ä»¥å å¯ï¼é£ä¹ä»ä¹æ¶åç¨å¬é¥å å¯ï¼ä»ä¹æ¶åç¨ç§é¥âå å¯â ï¼\n    * å å¯åºæ¯ï¼é£ä¹è¯å®å¸æåªæææè½è§£å¯ï¼å«äººåªè½å å¯ãå³å¬é¥å å¯ï¼ç§é¥è§£å¯ã\n    * ç­¾ååºæ¯ï¼æ¢ç¶æ¯ç­¾åï¼å°±å¸æåªè½ææè½ç­¾åï¼å«äººåªè½éªè¯ãå³ç§é¥ç­¾åï¼å¬é¥éªç­¾\n 2. ä»ä¹æ¯æ°å­ç­¾åï¼æ°å­ç­¾åçä½ç¨æ¯ä»ä¹ï¼\n    * æ°å­ç­¾åå°±æ¯ä½¿ç¨ç§é¥å¯¹æ°æ®æè¦è¿è¡ç­¾åï¼å¹¶éå¸¦åæ°æ®ä¸èµ·åéã\n    * å¯ä»¥èµ·å°é²ç¯¡æ¹ãé²ä¼ªè£ãé²å¦è®¤çä½ç¨ã\n 3. ä¸ºä»ä¹è¦å¯¹æ°æ®çæè¦è¿è¡ç­¾åï¼èä¸æ¯ç´æ¥è®¡ç®åå§æ°æ®çæ°å­ç­¾åï¼\n    * æ°æ®å¯è½æ¯è¾å¤§ï¼ç­¾åæ¯ä½¿ç¨éå¯¹ç§°å å¯ç®æ³ï¼æ¯è¾èæ¶\n    * é²æ­¢ç¬¬ä¸æ¹ä½¿ç¨å¬é¥è§£å¼ç­¾ååï¼æ¿å°åå§æ°æ®\n 4. ä»ä¹æ¯æ°å­è¯ä¹¦ï¼æ°å­è¯ä¹¦å­å¨è§£å³äºä»ä¹é®é¢ï¼\n    * æ°å­è¯ä¹¦å°±æ¯ç± ca æºæä½¿ç¨èªå·±ç§é¥ï¼å¯¹è¯ä¹¦ç³è¯·èçå¬é¥è¿è¡ç­¾åè®¤è¯ã\n    * æ°å­è¯ä¹¦è§£å³äºå¦ä½å®å¨ååå¬é¥çé®é¢ï¼ä¹å¥ å®äºä¿¡ä»»é¾çåºç¡ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"DNS",frontmatter:{title:"DNS",date:"2023-03-21T18:49:35.000Z",permalink:"/pages/524e17/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/02.%E5%BA%94%E7%94%A8%E5%B1%82/04.dns.html",relativePath:"04.è®¡ç®æºç½ç»/02.åºç¨å±/04.dns.md",key:"v-0bf64c24",path:"/pages/524e17/",headers:[{level:2,title:"DNSçè§£ææµç¨",slug:"dnsçè§£ææµç¨",normalizedTitle:"dnsçè§£ææµç¨",charIndex:153},{level:2,title:"DNSè§£æä¼å",slug:"dnsè§£æä¼å",normalizedTitle:"dnsè§£æä¼å",charIndex:915}],headersStr:"DNSçè§£ææµç¨ DNSè§£æä¼å",content:'DNS(Domain Name System)æ¯âååç³»ç»âçè±æç¼©åï¼æä¾å°åååIPå°åç¸äºæ å°çæå¡ï¼DNSæ¯åºç¨å±åè®®ï¼ä»æ¯ä¸ºå¶ä»åºç¨å±åè®®å·¥ä½çï¼åæ¬å¹¶ä¸éäºHTTPåSMTPä»¥åFTPï¼å·ä½å°ç¨æ·æä¾çä¸»æºåè§£æä¸ºipå°åãææDNSè¯·æ±ååç­æ¥æä½¿ç¨çUDPæ°æ®æ¥ç»è¿ç«¯å£53åéã\n\n\n# DNSçè§£ææµç¨\n\nå¦ææ¥æ¾www.baidu.com\n\n * **æµè§å¨ç¼å­ï¼**æµè§å¨åæ£æ¥èªèº«ç¼å­ä¸­ææ²¡æè¿ä¸ªååå¯¹åºçIPå°åï¼å¦ææï¼å®æååè§£æã\n * **æ¬å°hostsæä»¶ï¼**æä½ç³»ç»ä¼åæ£æ¥èªå·±æ¬å°çhostsæä»¶æ¯å¦æè¿ä¸ªç½åæ å°å³ç³»ï¼å¦ææï¼å°±åè°ç¨è¿ä¸ªIPå°åæ å°ï¼å®æååè§£æã\n * **æ¬å°DNSå®¢æ·ç«¯ç¼å­ï¼**å¦æhostséæ²¡æè¿ä¸ªååçæ å°ï¼åæ¥æ¾æ¬å°DNSè§£æå¨ç¼å­ï¼æ¯å¦æè¿ä¸ªç½åæ å°å³ç³»ï¼å¦ææï¼ç´æ¥è¿åï¼å®æååè§£æã\n * æ¬å°DNSæå¡å¨éç½®åºåèµæºï¼ï¼è½ä¸qqä¸è½ä¸ç½ï¼æ¯DNSè§£æå¨éé¢çDNSæå¡å¨å°åéäºï¼å¦æhostsä¸æ¬å°DNSè§£æå¨ç¼å­é½æ²¡æç¸åºçç½åæ å°å³ç³»ï¼é¦åä¼æ¾TCP/ipåæ°ä¸­è®¾ç½®çé¦éDNSæå¡å¨ï¼å¨æ­¤æä»¬å«å®æ¬å°DNSæå¡å¨ï¼æ­¤æå¡å¨æ¶å°æ¥è¯¢æ¶ï¼å¦æè¦æ¥è¯¢çååï¼åå«å¨æ¬å°éç½®åºåèµæºä¸­ï¼åè¿åè§£æç»æç»å®¢æ·æºï¼å®æååè§£æï¼æ­¤è§£æå·ææå¨æ§ã\n * æ¬å°DNSæå¡å¨ç¼å­ï¼å¦æè¦æ¥è¯¢çååï¼ä¸ç±æ¬å°DNSæå¡å¨åºåè§£æï¼ä½è¯¥æå¡å¨å·²ç¼å­äºæ­¤ç½åæ å°å³ç³»ï¼åè°ç¨è¿ä¸ªIPå°åæ å°ï¼å®æååè§£æï¼æ­¤è§£ææ¯éæå¨çã\n * **è¿­ä»£æ¥è¯¢ï¼**æ¬å°DNSå°±æè¯·æ±åè³13å°æ ¹DNSï¼æ ¹DNSæå¡å¨æ¶å°è¯·æ±åä¼å¤æ­è¿ä¸ªåå(.com)æ¯è°æ¥ææç®¡çï¼å¹¶ä¼è¿åä¸ä¸ªè´è´£è¯¥é¡¶çº§ååæå¡å¨çä¸ä¸ªIPãæ¬å°DNSæå¡å¨æ¶å°IPä¿¡æ¯åï¼å°ä¼èç³»è´è´£.comåçè¿å°æå¡å¨ãè¿å°è´è´£.comåçæå¡å¨æ¶å°è¯·æ±åï¼å¦æèªå·±æ æ³è§£æï¼å®å°±ä¼æ¾ä¸ä¸ªç®¡ç.comåçä¸ä¸çº§DNSæå¡å¨å°åbaidu.comç»æ¬å°DNSæå¡å¨ãå½æ¬å°DNSæå¡å¨æ¶å°è¿ä¸ªå°ååï¼å°±ä¼æ¾baidu.comåæå¡å¨ï¼éå¤ä¸é¢çå¨ä½ï¼è¿è¡æ¥è¯¢ï¼ç´è³æ¾å°www.baidu.comä¸»æºã\n\n\n# DNSè§£æä¼å\n\n * åå°DNSæ¥æ¾ï¼\n\nä½¿ç¨æµè§å¨DNSç¼å­ãè®¡ç®æºDNSç¼å­ãæå¡å¨DNSç¼å­ï¼é²æ­¢DNSè¿­ä»£æ¥æ¾ï½ä½¿ç¨Keep-Aliveç¹æ§æ¥åå°DNSæ¥æ¾çé¢çï½ä½¿ç¨è¾å°çååï¼æå¡å¨ï¼æ¥åå°DNSæ¥æ¾çæ°é\n\næå¡å¨æ¥æ¾è¿åçDNSè®°å½åå«TTLï¼å­æ´»æ¶é´ï¼ç¨äºåè¯å®¢æ·ç«¯è¯¥è®°å½å¯ä»¥ç¼å­å¤ä¹ï¼ï¼æä½ç³»ç»ä¼èèTTLï¼ä½æ¯æµè§å¨ä¼å¿½ç¥è¯¥å¼ï¼å¹¶è®¾ç½®èªå·±çæ¶é´éå¶ãHTTPåè®®ä¸­çKeep-Aliveç¹æ§å¯ä»¥åæ¶è¦çTTLåæµè§å¨çæ¶é´éå¶ï¼åªè¦è¿ä¿æçTCPè¿æ¥æå¼ç¶æï¼é£ä¹å°±ä¸ä¼è¿è¡DNSæ¥è¯¢ï¼ãæµè§å¨å¯¹DNSè®°å½ç¼å­æ°éæéå¶ï¼æªå°æ¶é´ï¼ä½æ¯è¶åºéå¶çæèä¸æ¹è®°å½å°ä¼è¢«éå¿ã\n\n * å¨åç«¯ä»£ç ä¸­æ·»å DNSé¢è§£æï¼\n\nå¼å¯/å³é­èªå¨è§£æåè½ï¼\n\n<meta http-equiv="x-dns-prefetch-control" content="on">\n// off åæ¯å³é­\n\n\næå¨æ·»å è§£æï¼\n\n<link rel="dns-prefetch" href="http://www.google.com">\n',normalizedContent:'dns(domain name system)æ¯âååç³»ç»âçè±æç¼©åï¼æä¾å°åååipå°åç¸äºæ å°çæå¡ï¼dnsæ¯åºç¨å±åè®®ï¼ä»æ¯ä¸ºå¶ä»åºç¨å±åè®®å·¥ä½çï¼åæ¬å¹¶ä¸éäºhttpåsmtpä»¥åftpï¼å·ä½å°ç¨æ·æä¾çä¸»æºåè§£æä¸ºipå°åãæædnsè¯·æ±ååç­æ¥æä½¿ç¨çudpæ°æ®æ¥ç»è¿ç«¯å£53åéã\n\n\n# dnsçè§£ææµç¨\n\nå¦ææ¥æ¾www.baidu.com\n\n * **æµè§å¨ç¼å­ï¼**æµè§å¨åæ£æ¥èªèº«ç¼å­ä¸­ææ²¡æè¿ä¸ªååå¯¹åºçipå°åï¼å¦ææï¼å®æååè§£æã\n * **æ¬å°hostsæä»¶ï¼**æä½ç³»ç»ä¼åæ£æ¥èªå·±æ¬å°çhostsæä»¶æ¯å¦æè¿ä¸ªç½åæ å°å³ç³»ï¼å¦ææï¼å°±åè°ç¨è¿ä¸ªipå°åæ å°ï¼å®æååè§£æã\n * **æ¬å°dnså®¢æ·ç«¯ç¼å­ï¼**å¦æhostséæ²¡æè¿ä¸ªååçæ å°ï¼åæ¥æ¾æ¬å°dnsè§£æå¨ç¼å­ï¼æ¯å¦æè¿ä¸ªç½åæ å°å³ç³»ï¼å¦ææï¼ç´æ¥è¿åï¼å®æååè§£æã\n * æ¬å°dnsæå¡å¨éç½®åºåèµæºï¼ï¼è½ä¸qqä¸è½ä¸ç½ï¼æ¯dnsè§£æå¨éé¢çdnsæå¡å¨å°åéäºï¼å¦æhostsä¸æ¬å°dnsè§£æå¨ç¼å­é½æ²¡æç¸åºçç½åæ å°å³ç³»ï¼é¦åä¼æ¾tcp/ipåæ°ä¸­è®¾ç½®çé¦édnsæå¡å¨ï¼å¨æ­¤æä»¬å«å®æ¬å°dnsæå¡å¨ï¼æ­¤æå¡å¨æ¶å°æ¥è¯¢æ¶ï¼å¦æè¦æ¥è¯¢çååï¼åå«å¨æ¬å°éç½®åºåèµæºä¸­ï¼åè¿åè§£æç»æç»å®¢æ·æºï¼å®æååè§£æï¼æ­¤è§£æå·ææå¨æ§ã\n * æ¬å°dnsæå¡å¨ç¼å­ï¼å¦æè¦æ¥è¯¢çååï¼ä¸ç±æ¬å°dnsæå¡å¨åºåè§£æï¼ä½è¯¥æå¡å¨å·²ç¼å­äºæ­¤ç½åæ å°å³ç³»ï¼åè°ç¨è¿ä¸ªipå°åæ å°ï¼å®æååè§£æï¼æ­¤è§£ææ¯éæå¨çã\n * **è¿­ä»£æ¥è¯¢ï¼**æ¬å°dnså°±æè¯·æ±åè³13å°æ ¹dnsï¼æ ¹dnsæå¡å¨æ¶å°è¯·æ±åä¼å¤æ­è¿ä¸ªåå(.com)æ¯è°æ¥ææç®¡çï¼å¹¶ä¼è¿åä¸ä¸ªè´è´£è¯¥é¡¶çº§ååæå¡å¨çä¸ä¸ªipãæ¬å°dnsæå¡å¨æ¶å°ipä¿¡æ¯åï¼å°ä¼èç³»è´è´£.comåçè¿å°æå¡å¨ãè¿å°è´è´£.comåçæå¡å¨æ¶å°è¯·æ±åï¼å¦æèªå·±æ æ³è§£æï¼å®å°±ä¼æ¾ä¸ä¸ªç®¡ç.comåçä¸ä¸çº§dnsæå¡å¨å°åbaidu.comç»æ¬å°dnsæå¡å¨ãå½æ¬å°dnsæå¡å¨æ¶å°è¿ä¸ªå°ååï¼å°±ä¼æ¾baidu.comåæå¡å¨ï¼éå¤ä¸é¢çå¨ä½ï¼è¿è¡æ¥è¯¢ï¼ç´è³æ¾å°www.baidu.comä¸»æºã\n\n\n# dnsè§£æä¼å\n\n * åå°dnsæ¥æ¾ï¼\n\nä½¿ç¨æµè§å¨dnsç¼å­ãè®¡ç®æºdnsç¼å­ãæå¡å¨dnsç¼å­ï¼é²æ­¢dnsè¿­ä»£æ¥æ¾ï½ä½¿ç¨keep-aliveç¹æ§æ¥åå°dnsæ¥æ¾çé¢çï½ä½¿ç¨è¾å°çååï¼æå¡å¨ï¼æ¥åå°dnsæ¥æ¾çæ°é\n\næå¡å¨æ¥æ¾è¿åçdnsè®°å½åå«ttlï¼å­æ´»æ¶é´ï¼ç¨äºåè¯å®¢æ·ç«¯è¯¥è®°å½å¯ä»¥ç¼å­å¤ä¹ï¼ï¼æä½ç³»ç»ä¼èèttlï¼ä½æ¯æµè§å¨ä¼å¿½ç¥è¯¥å¼ï¼å¹¶è®¾ç½®èªå·±çæ¶é´éå¶ãhttpåè®®ä¸­çkeep-aliveç¹æ§å¯ä»¥åæ¶è¦çttlåæµè§å¨çæ¶é´éå¶ï¼åªè¦è¿ä¿æçtcpè¿æ¥æå¼ç¶æï¼é£ä¹å°±ä¸ä¼è¿è¡dnsæ¥è¯¢ï¼ãæµè§å¨å¯¹dnsè®°å½ç¼å­æ°éæéå¶ï¼æªå°æ¶é´ï¼ä½æ¯è¶åºéå¶çæèä¸æ¹è®°å½å°ä¼è¢«éå¿ã\n\n * å¨åç«¯ä»£ç ä¸­æ·»å dnsé¢è§£æï¼\n\nå¼å¯/å³é­èªå¨è§£æåè½ï¼\n\n<meta http-equiv="x-dns-prefetch-control" content="on">\n// off åæ¯å³é­\n\n\næå¨æ·»å è§£æï¼\n\n<link rel="dns-prefetch" href="http://www.google.com">\n',charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"TCP",frontmatter:{title:"TCP",date:"2023-03-21T18:54:20.000Z",permalink:"/pages/5e312c/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/03.%E4%BC%A0%E8%BE%93%E5%B1%82/01.tcp.html",relativePath:"04.è®¡ç®æºç½ç»/03.ä¼ è¾å±/01.tcp.md",key:"v-2767b19c",path:"/pages/5e312c/",headers:[{level:2,title:"TCPåUDPçåºå«",slug:"tcpåudpçåºå«",normalizedTitle:"tcpåudpçåºå«",charIndex:2},{level:3,title:"TCPåUDPåºç¨",slug:"tcpåudpåºç¨",normalizedTitle:"tcpåudpåºç¨",charIndex:630},{level:3,title:"å­èæµåæ¥ææ®µ",slug:"å­èæµåæ¥ææ®µ",normalizedTitle:"å­èæµåæ¥ææ®µ",charIndex:728},{level:2,title:"TCPç²åãæåé®é¢",slug:"tcpç²åãæåé®é¢",normalizedTitle:"tcpç²åãæåé®é¢",charIndex:897},{level:2,title:"TCPä¸æ¬¡æ¡æ",slug:"tcpä¸æ¬¡æ¡æ",normalizedTitle:"tcpä¸æ¬¡æ¡æ",charIndex:1374},{level:2,title:"TCPåæ¬¡æ¥æ",slug:"tcpåæ¬¡æ¥æ",normalizedTitle:"tcpåæ¬¡æ¥æ",charIndex:2363},{level:2,title:"TCPå¯é ä¼ è¾",slug:"tcpå¯é ä¼ è¾",normalizedTitle:"tcpå¯é ä¼ è¾",charIndex:3263},{level:3,title:"éä¼ æºå¶",slug:"éä¼ æºå¶",normalizedTitle:"éä¼ æºå¶",charIndex:3277},{level:3,title:"æµéæ§å¶åæ¥å¡æ§å¶çåºå«",slug:"æµéæ§å¶åæ¥å¡æ§å¶çåºå«",normalizedTitle:"æµéæ§å¶åæ¥å¡æ§å¶çåºå«",charIndex:3804},{level:3,title:"æµéæ§å¶",slug:"æµéæ§å¶",normalizedTitle:"æµéæ§å¶",charIndex:215},{level:3,title:"æ¥å¡æ§å¶",slug:"æ¥å¡æ§å¶",normalizedTitle:"æ¥å¡æ§å¶",charIndex:76},{level:2,title:"TCP åºåå·çä½ç¨",slug:"tcp-åºåå·çä½ç¨",normalizedTitle:"tcp åºåå·çä½ç¨",charIndex:5009},{level:2,title:"æ»å¨çªå£åæ¥å¡çªå£",slug:"æ»å¨çªå£åæ¥å¡çªå£",normalizedTitle:"æ»å¨çªå£åæ¥å¡çªå£",charIndex:5983}],headersStr:"TCPåUDPçåºå« TCPåUDPåºç¨ å­èæµåæ¥ææ®µ TCPç²åãæåé®é¢ TCPä¸æ¬¡æ¡æ TCPåæ¬¡æ¥æ TCPå¯é ä¼ è¾ éä¼ æºå¶ æµéæ§å¶åæ¥å¡æ§å¶çåºå« æµéæ§å¶ æ¥å¡æ§å¶ TCP åºåå·çä½ç¨ æ»å¨çªå£åæ¥å¡çªå£",content:"# TCPåUDPçåºå«\n\nç¨æ·æ°æ®æ¥åè®®UDPï¼User Datagram Protocolï¼ï¼\n\næ¯æ è¿æ¥çï¼å°½æå¤§å¯è½äº¤ä»ï¼ä¸è½ä¿è¯æ°æ®é¡ºåºï¼æ²¡ææ¥å¡æ§å¶ï¼é¢åæ¥æï¼å¯¹äºåºç¨ç¨åºä¼ ä¸æ¥çæ¥æä¸åå¹¶ä¹ä¸æåï¼åªæ¯æ·»å UDPé¦é¨ï¼ï¼æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹ä¸åå¤å¯¹å¤çäº¤äºéä¿¡ã\n\nä¼ è¾æ§å¶åè®®TCPï¼Transmission Control Protocolï¼ï¼\n\næ¯é¢åè¿æ¥çï¼æä¾å¯é äº¤ä»ï¼ä¿è¯æ°æ®é¡ºåºï¼ç±äºä½¿ç¨åºå·ï¼ï¼ææµéæ§å¶ï¼ææ¥å¡æ§å¶ï¼æä¾å¨åå·¥éä¿¡ï¼é¢åå­èæµï¼æåºç¨å±ä¼ ä¸æ¥çæ¥æçæå­èæµï¼æå­èæµç»ç»æå¤§å°ä¸ç­çæ°æ®åï¼ï¼ä»æ¯æä¸å¯¹ä¸ã\n\n\n * tcpæ¯é¢åè¿æ¥çå¯é ä¼ è¾åè®®ï¼æ¯é¢åå­èæµçï¼ä¼åçç²ååæåç°è±¡ï¼ææµéæ§å¶åæ¥å¡æ§å¶ä¿è¯å¯é ä¼ è¾ï¼éåè¦æ±å¯¹æ°æ®ä¼ è¾å¯é æ§è¦æ±é«çåºæ¯ã\n\n * udpæ¯æ è¿æ¥çï¼ä¸å¯é çä¼ è¾åè®®ï¼ä¼å°½æå¤§åªåè¿è¡äº¤ä»ï¼é¢åæ¥æï¼ä¸ä¼è¿è¡æåååå¹¶ï¼æ²¡ææ¥å¡æ§å¶ï¼éååè®¸æ°æ®å°éä¸¢å¤±çåºæ¯ï¼è½å¤å®ç°1å¯¹1ï¼1å¯¹å¤ï¼å¤å¯¹å¤çå®æ¶äº¤äºéä¿¡ã\n\n * udpé¦é¨é¿åº¦åªæ8Bï¼æ¯TCPå°ã\n\n * é¢åè¿æ¥ï¼ä¸å®æ¯ãä¸å¯¹ä¸ãæè½è¿æ¥ï¼ä¸è½å UDP åè®®å¯ä»¥ä¸ä¸ªä¸»æºåæ¶åå¤ä¸ªä¸»æºåéæ¶æ¯ï¼ä¹å°±æ¯ä¸å¯¹å¤æ¯æ æ³åå°çã\n\n * å¯é äº¤ä»ï¼æ è®ºçç½ç»é¾è·¯ä¸­åºç°äºææ ·çé¾è·¯ååï¼TCP é½å¯ä»¥ä¿è¯ä¸ä¸ªæ¥æä¸å®è½å¤å°è¾¾æ¥æ¶ç«¯ã\n\n * é¢åå­èæµï¼ä¹å°±æ¯è¯´ä»ä»æä¸å±åè®®ä¼ éè¿æ¥çæ°æ®å½æå­èä¼ è¾ã\n\n\n# TCPåUDPåºç¨\n\nTCPï¼è¦æ±éä¿¡æ°æ®çå®æ´æ§ååç¡®æ§è¾é«ï¼æä»¶ä¼ è¾ãé®ä»¶åéãéè¦ç¶æçæ´æ°ï¼\n\nUDPï¼è¦æ±éä¿¡ååºåº¦é«ï¼å¯¹æ°æ®ä¿¡æ¯çå®å¨æ§åå®æ´æ§è¦æ±è¾ä½ï¼ç½ç»çµè¯ãç½ç»è§é¢ï¼\n\n\n# å­èæµåæ¥ææ®µ\n\nåºåå­èæµåæ¥æå³é®å¨äºï¼å¯¹ä½¿ç¨åè®®çç¨æ·èè¨ï¼è¯»æ°æ®çæ¶åï¼æ¯ä¸æ¯æâè¾¹çâï¼æè¾¹çå°±æ¯æ¥æï¼æ²¡æè¾¹çå°±æ¯å­èæµ\n\næ²¡æè¾¹çï¼ä¸å±åè®®è¯»åæ°æ®çæ¶åä¸ç¥éè¯»å°äºå ä¸ªTCPæ°æ®åï¼å ä¸ºæç¼å²æ± ï¼æä»¥åéç«¯åéæ°æ®åæ¥æ¶ç«¯å¤çæ°æ®çé¢çæ¯å¯ä»¥ä¸å¯¹ç­çï¼\n\næè¾¹çï¼ä¸å±åè®®æ¯ä¸æ¬¡è¯»åå¿å®æ¯ä¸ä¸ªæ°æ®åï¼æ²¡æç¼å²æ± ï¼\n\n\n# TCPç²åãæåé®é¢\n\nTCP æ¯ä»¥æµçæ¹å¼æ¥å¤çæ°æ®ï¼ä¸ä¸ªå®æ´çåå¯è½ä¼è¢« TCP æåæå¤ä¸ªåè¿è¡åéï¼ä¹å¯è½æå°çå°è£æä¸ä¸ªå¤§çæ°æ®ååéã\n\n\nåéæ¹ï¼å³é­Nagleç®æ³ãæ¥æ¶æ¹ï¼æ²¡æ³å¤çï¼åªè½äº¤ç»åºç¨å±æ¥è¿è¡å¤ç\n\nåºç¨å±ï¼\n\n * ä½¿ç¨æ åçåºç¨å±åè®®ï¼httpï¼httpsç­ï¼æ¥å°è£è¦ä¼ è¾çä¸å®é¿çæ°æ®å\n * å¨æ¯æ¡æ°æ®çå°¾é¨æ·»å ç¹æ®å­ç¬¦ï¼å¦æéå°ç¹æ®å­ç¬¦è¡¨æå½æ¡æ°æ®æ¥åå®æ¯\n * å¨åéæ°æ®åæ·»å åå¤´ï¼æ°æ®æ ¼å¼ä¸ºï¼æ°æ®å¤´+æ°æ®å\n\n\nnettyçè§£å³æ¹æ¡ï¼\n\n * æ¶æ¯å®é¿ï¼FixedLengthFrameDecoder\n * åå°¾å¢å ç¹æ®å­ç¬¦åå²ï¼\n   * è¡åéç¬¦ç±»ï¼LineBasedFrameDecoder\n   * èªå®ä¹åéç¬¦ç±» ï¼DelimiterBasedFrameDecoder\n * å°æ¶æ¯åä¸ºæ¶æ¯å¤´åæ¶æ¯ä½ï¼LengthFieldBasedFrameDecoder ç±»ãåä¸ºæå¤´é¨çæåä¸ç²åãé¿åº¦å­æ®µå¨åä¸æå¤´é¨çæåä¸ç²åãå¤æ©å±å¤´é¨çæåä¸ç²åã\n\nä¹å¯ä»¥ä½¿ç¨èªå®ä¹åè®®ï¼éè¿å­æ®µæ æåé¿åº¦ã\n\n\n# TCPä¸æ¬¡æ¡æ\n\nè¿ç¨ï¼\n\n * A å B åéè¿æ¥è¯·æ±æ¥æï¼SYN=1ï¼ACK=0ï¼seq=xã\n * B æ¶å°è¿æ¥è¯·æ±æ¥æï¼å¦æåæå»ºç«è¿æ¥ï¼åå A åéè¿æ¥ç¡®è®¤æ¥æï¼SYN=1ï¼ACK=1ï¼ack=x+1ï¼seq= yã\n * A æ¶å° B çè¿æ¥ç¡®è®¤æ¥æåï¼è¿è¦å B ååºç¡®è®¤ï¼ACK=1ï¼ack= y+1ï¼seq=x+1ã\n\nç¬¬äºæ¬¡æ¡æå®æåSYNå°è¢«ç½®ä¸º0ï¼ç¬¬ä¸æ¬¡æ¡æå¯ä»¥æºå¸¦æ°æ®ï¼åä¸¤æ¬¡ä¸å¯ä»¥æºå¸¦æ°æ®ã\n\nä¸ºä»ä¹éè¦ä¸æ¬¡ï¼\n\n * ä¸æ¬¡è¿æ¥æè½å¯é çåæ­¥åæ¹çåå§åºåå·ããtcpçå¯é ä¼ è¾æ¯é åæ­¥åºåå·å®ç°ï¼åºåå·è½ä¿è¯æ°æ®åä¸éå¤ãä¸ä¸¢å¼åæåºä¼ è¾ã\n * é²æ­¢éå¤çåå²è¿æ¥çå»ºç«ï¼é ææ··ä¹±ã\n * é¿åèµæºæµªè´¹ããéä¼ æåµã\n\néå¤åå²è¿æ¥å»ºç«çå·ä½åºæ¯ï¼å®¢æ·ç«¯ååéäº SYNï¼seq = 90ï¼ æ¥æï¼ç¶åå®¢æ·ç«¯å®æºäºï¼èä¸è¿ä¸ª SYN æ¥æè¿è¢«ç½ç»é»å¡äºï¼æå¡ç«¯å¹¶æ²¡ææ¶å°ï¼æ¥çå®¢æ·ç«¯éå¯åï¼åéæ°åæå¡ç«¯å»ºç«è¿æ¥ï¼åéäº SYNï¼seq = 100ï¼ æ¥æï¼æ³¨æä¸æ¯éä¼  SYNï¼éä¼ ç SYN çåºåå·æ¯ä¸æ ·çï¼ã\n\nå®¢æ·ç«¯è¿ç»­åéå¤æ¬¡ SYN å»ºç«è¿æ¥çæ¥æï¼å¨ç½ç»æ¥å µæåµä¸ï¼\n\n * ä¸ä¸ªãæ§ SYN æ¥æãæ¯ãææ°ç SYN ã æ¥ææ©å°è¾¾äºæå¡ç«¯ï¼\n * é£ä¹æ­¤æ¶æå¡ç«¯å°±ä¼åä¸ä¸ª SYN + ACK æ¥æç»å®¢æ·ç«¯ï¼\n * å®¢æ·ç«¯æ¶å°åå¯ä»¥æ ¹æ®èªèº«çä¸ä¸æï¼å¤æ­è¿æ¯ä¸ä¸ªåå²è¿æ¥ï¼åºåå·è¿ææè¶æ¶ï¼ï¼é£ä¹å®¢æ·ç«¯å°±ä¼åé RST æ¥æç»æå¡ç«¯ï¼è¡¨ç¤ºä¸­æ­¢è¿ä¸æ¬¡è¿æ¥ã\n\n**å¦ææ¯ä¸¤æ¬¡æ¡æè¿æ¥ï¼å°±æ æ³é»æ­¢åå²è¿æ¥ã**ä¸¤æ¬¡æ¡æçæåµä¸ï¼ãè¢«å¨åèµ·æ¹ãå¨æ¶å° SYN æ¥æåï¼å°±è¿å¥ ESTABLISHED ç¶æï¼æå³çè¿æ¶å¯ä»¥ç»å¯¹æ¹åéæ°æ®ï¼ä½æ¯ãä¸»å¨åèµ·æ¹ãæ­¤æ¶è¿æ²¡æè¿å¥ ESTABLISHED ç¶æï¼åè®¾è¿æ¬¡æ¯åå²è¿æ¥ï¼ãä¸»å¨åèµ·æ¹ãå¤æ­å°æ­¤æ¬¡è¿æ¥ä¸ºåå²è¿æ¥ï¼é£ä¹å°±ä¼å RST æ¥ææ¥æ­å¼è¿æ¥ï¼èãè¢«å¨åèµ·æ¹ãå¨ç¬¬ä¸æ¬¡æ¡æçæ¶åå°±è¿å¥ ESTABLISHED ç¶æï¼æä»¥å®å¯ä»¥åéæ°æ®çï¼ä½æ¯å®å¹¶ä¸ç¥éè¿ä¸ªæ¯åå²è¿æ¥ï¼å®åªæå¨æ¶å° RST æ¥æåï¼æä¼æ­å¼è¿æ¥ã\n\nä¸¤æ¬¡æ¡æçè¯ï¼å½å®¢æ·ç«¯è¿ç»­åéå¤ä¸ªå»ºç«è¿æ¥çæ¥æï¼å¨ç½ç»é»å¡çæåµä¸ï¼ç±äºæå¡ç«¯æ¶å°åºç­åå°±å»ºç«äºè¿æ¥ï¼æä»¥ä¼é ææå¡ç«¯å¤ä¸ªè¿æ¥çå»ºç«ï¼ä»èå°è¯æ··ä¹±ã\n\n\n# TCPåæ¬¡æ¥æ\n\n * è¿ç¨ï¼\n   \n   * å®¢æ·ç«¯ååºè¿æ¥éæ¾æ¥ææ®µï¼FIN=1ï¼åºå·seq=uï¼ï¼å¹¶åæ­¢ååéæ°æ®ï¼ä¸»å¨å³é­TCPè¿æ¥ï¼è¿å¥FIN_WAIT1ï¼ç»æ­¢ç­å¾1ï¼ç¶æï¼ç­å¾æå¡ç«¯çç¡®è®¤ã\n   * æå¡ç«¯æ¶å°è¿æ¥éæ¾æ¥ææ®µåå³ååºç¡®è®¤æ¥ææ®µï¼ACK=1ï¼ç¡®è®¤å·ack=u+1ï¼åºå·seq=vï¼ï¼æå¡ç«¯è¿å¥CLOSE_WAITï¼å³é­ç­å¾ï¼ç¶æï¼æ­¤æ¶çTCPå¤äºåå³é­ç¶æï¼å®¢æ·ç«¯å°æå¡ç«¯çè¿æ¥éæ¾ãå®¢æ·ç«¯æ¶å°æå¡ç«¯çç¡®è®¤åï¼è¿å¥FIN_WAIT2ï¼ç»æ­¢ç­å¾2ï¼ç¶æï¼ç­å¾æå¡ç«¯ååºçè¿æ¥éæ¾æ¥ææ®µã\n   * æå¡ç«¯æ²¡æè¦åå®¢æ·ç«¯ååºçæ°æ®ï¼æå¡ç«¯ååºè¿æ¥éæ¾æ¥ææ®µï¼FIN=1ï¼ACK=1ï¼åºå·seq=wï¼ç¡®è®¤å·ack=u+1ï¼ï¼æå¡ç«¯è¿å¥LAST_ACKï¼æåç¡®è®¤ï¼ç¶æï¼ç­å¾å®¢æ·ç«¯çç¡®è®¤ã\n   * å®¢æ·ç«¯æ¶å°æå¡ç«¯çè¿æ¥éæ¾æ¥ææ®µåï¼å¯¹æ­¤ååºç¡®è®¤æ¥ææ®µï¼ACK=1ï¼seq=u+1ï¼ack=w+1ï¼ï¼å®¢æ·ç«¯è¿å¥TIME_WAITï¼æ¶é´ç­å¾ï¼ç¶æãæ­¤æ¶TCPæªéæ¾æï¼éè¦ç»è¿æ¶é´ç­å¾è®¡æ¶å¨è®¾ç½®çæ¶é´2MSLåï¼å®¢æ·ç«¯æè¿å¥CLOSEDç¶æã\n   \n   \n   \n   ä¸ºä»ä¹æ¯åæ¬¡ï¼\n   \n   è¿ç±TCPçåå³é­ï¼half-closeï¼é æçãæè°çåå³é­ï¼å¶å®å°±æ¯TCPæä¾äºè¿æ¥çä¸ç«¯å¨ç»æå®çåéåè¿è½æ¥æ¶æ¥èªå¦ä¸ç«¯æ°æ®çè½åã\n   \n   ä¸ºä»ä¹éè¦ç­å¾2ä¸ªMSL\n   \n   é²æ­¢ä¸»å¨æ¥åæ¹åéçæåç¡®è®¤æ¥æï¼è¢«å¨æ¥åæ¹æ²¡è½æ¥åå°ï¼è§¦åè¢«å¨æ¥åæ¹çè¶æ¶éä¼ ï¼ä¸æ¥ä¸ååå¥½ä¸¤ä¸ª2MSL\n   \n   MSLï¼Maximum Segment Lifetimeï¼ä¸ºæ¥ææå¤§çå­æ¶é´ï¼ä»æ¯ä»»ä½æ¥æå¨ç½ç»ä¸å­å¨çæé¿æ¶é´ï¼è¶è¿è¿ä¸ªæ¶é´æ¥æå°ä¼è¢«ä¸¢å¼ï¼è¢«æ¥æ¶æ¹å¤çååååéæ¹åéååºï¼ä¸æ¥ä¸åéè¦ç­å¾2åçæ¶é´\n   \n   ä¸ºä»ä¹ç¬¬äºæ¬¡æ¥æåç¬¬ä¸æ¬¡æ¥æä¸è½åå¹¶æä¸æ¬¡\n   \n   æå¡å¨éè¦ååºç­æ¥åå°äºå®¢æ·ç«¯éè¦æ­å¼çè¯·æ±ï¼ä½æ¯æå¡å¨å¯è½è¿ææ°æ®éè¦å¤çååéï¼å¹¶ä¸TCPå·æä¸ç«¯å¨ç»æå®åéåä»è½æ¥åæ°æ®çè½åï¼å æ­¤æå¡å¨è¿è½åå®¢æ·ç«¯è¿è¡åéæ°æ®\n\n\n# TCPå¯é ä¼ è¾\n\nTCPéè¿éä¼ æºå¶ãæµéæ§å¶ãæ¥å¡æ§å¶æ¥å®ç°å¯é ä¼ è¾\n\n\n# éä¼ æºå¶\n\néä¼ æºå¶     æè¿°\nè¶æ¶éä¼      è¶åºä¸å®æ¶é´æ²¡ææ¶å°ååºè§¦åéä¼ æºå¶\nå¿«ééä¼      è¿ç»­æ¶å°ä¸æ¬¡ç¸åçACKè§¦åéä¼ æºå¶\nSACK     TCPçå­æ®µä¸­æ·»å SACKï¼æ¾ç¤ºåªäºæ°æ®è¢«æ¥æ¶å°\nD-SACK   ç¨SACKå­æ®µè¡¨æåªäºæ°æ®è¢«éå¤æ¥æ¶ï¼ç¨ACKè¡¨æåªäºå­æ®µä¸¢å¤±ï¼å¯ä»¥ç¨æ¥æ£æµæ¯ååºä¸¢å¤±è¿æ¯è¯·æ±ä¸¢å¤±\n\nTCPè¶æ¶éä¼ åå¿«ééä¼ é½æ¯TCPåè®®å¨æ°æ®ä¼ è¾æ¶ä½¿ç¨çæºå¶ï¼ç¨äºæé«æ°æ®ä¼ è¾çå¯é æ§ãå®ä»¬çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. è§¦åæºå¶ï¼TCPè¶æ¶éä¼ æ¯å¨åéæ°æ®åç­å¾ä¸æ®µæ¶é´ï¼å¦ææªæ¶å°ç¡®è®¤åºç­ï¼å°±ä¼è§¦åéä¼ æºå¶ï¼èå¿«ééä¼ æ¯å¨æ¥æ¶å°éå¤ç¡®è®¤åºç­æ¶è§¦åçï¼è¿æå³çç½ç»åºç°æ¥å¡ï¼å¯¼è´æ°æ®åä¸¢å¤±ã\n 2. éä¼ æ¬¡æ°ï¼TCPè¶æ¶éä¼ ä¼å¨æ¯æ¬¡è¶æ¶åéä¼ æ°æ®åï¼ç´å°æ¶å°ç¡®è®¤åºç­ä¸ºæ­¢ï¼èå¿«ééä¼ åªä¼å¨æ¥æ¶å°3ä¸ªéå¤ç¡®è®¤åºç­åç«å³éä¼ æ°æ®åï¼é¿åäºç­å¾è¶æ¶æ¶é´çå»¶è¿ã\n 3. å¯¹ç½ç»æ§è½çå½±åï¼TCPè¶æ¶éä¼ ä¼å¯¼è´ç½ç»åºç°æ´å¤çæ¥å¡ï¼å ä¸ºæ¯æ¬¡éä¼ é½ä¼éæ°åéæææ°æ®åï¼èè¿äºæ°æ®åå¯è½ä¼å¢å ç½ç»æ¥å¡çç¨åº¦ãèå¿«ééä¼ éè¿åå°æ°æ®åçéä¼ æ¬¡æ°ï¼å¯ä»¥åè½»ç½ç»æ¥å¡çç¨åº¦ã\n\n\n# æµéæ§å¶åæ¥å¡æ§å¶çåºå«\n\nTCPæµéæ§å¶åæ¥å¡æ§å¶æ¯TCPåè®®ä¸­ä¸¤ä¸ªéè¦çæºå¶ï¼å®ä»¬çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. ç®çä¸åï¼TCPæµéæ§å¶çç®çæ¯ç¡®ä¿åéæ¹ä¸ä¼åéä½¿æ¥æ¶æ¹æ æ³å¤çæ°æ®ï¼éè¿å¨æè°æ´åéæ¹åéçæ°æ®éï¼æ§å¶æ¥æ¶æ¹çæ¥æ¶éçï¼ä»¥è¾¾å°å¹³è¡¡åéæ¹åæ¥æ¶æ¹ä¹é´çæ°æ®æµéãæ¥å¡æ§å¶åæ¯ä¸ºäºé²æ­¢ç½ç»æ¥å¡èéåçä¸ç§æºå¶ã\n\n 2. æ§å¶å¯¹è±¡ä¸åï¼TCPæµéæ§å¶æ¯å¯¹åä¸ªè¿æ¥çåéæ¹åæ¥æ¶æ¹ä¹é´çæ°æ®æµéè¿è¡æ§å¶ï¼èæ¥å¡æ§å¶æ¯å¯¹æ´ä¸ªç½ç»çæµéè¿è¡æ§å¶ã\n\n 3. è§¦åæºå¶ä¸åï¼TCPæµéæ§å¶æ¯ç±æ¥æ¶æ¹æ¥è§¦åçï¼å½æ¥æ¶æ¹å¤çä¸è¿æ¥æ°æ®æ¶ï¼ä¼åéçªå£éåï¼Window Sizeï¼ï¼åè¯åéæ¹å¯ä»¥åéçæ°æ®éï¼ä»èæ§å¶åéæ¹çåééçãèæ¥å¡æ§å¶åæ¯ç±ç½ç»çæ¥å¡æåµæ¥è§¦åçï¼å½ç½ç»æ¥å¡æ¶ï¼åéæ¹ä¼æ¶å°æ¥å¡ä¿¡å·ï¼Congestion Signalï¼ï¼ä»èè°æ´åééçã\n\n 4. å®ç°æ¹æ³ä¸åï¼TCPæµéæ§å¶éè¿è°æ´çªå£å¤§å°æ¥æ§å¶åéæ¹çåééçãçªå£å¤§å°æ¯åéæ¹åæ¥æ¶æ¹ä¹é´çä¸ä¸ªåæ°ï¼åéæ¹å¯ä»¥æ ¹æ®çªå£å¤§å°æ¥ç¡®å®å¯ä»¥åéçæ°æ®éãèæ¥å¡æ§å¶åéç¨äºå¤ç§ç®æ³ï¼ä¾å¦TCP RenoãTCP Vegasç­ï¼éè¿ä¸åçç®æ³æ¥è°æ´åéæ¹çåééçï¼ä»¥é¿åç½ç»æ¥å¡ã\n\n\n# æµéæ§å¶\n\néè¿ä½¿ç¨æ»å¨çªå£æ¥è¿è¡æµéæ§å¶\n\n * æ»å¨çªå£çå¤§å°å°±æ¯æåéæ¹æ éç­å¾ç¡®è®¤åºç­ï¼èå¯ä»¥ç»§ç»­åéæ°æ®çæå¤§å¼\n\n * æ»å¨çªå£çå¤§å°æ¯ç±æ¥æ¶æ¹ççªå£å¤§å°å³å®çï¼æ¥æ¶æ¹åè¯åéæ¹èªå·±æå¤å°ç¼å²åºå¯ä»¥æ¥æ¶æ°æ®ï¼åéæ¹æ ¹æ®è¿ä¸ªæ¥æ¶ç«¯çå¤çè½åæ¥åéæ°æ®ï¼èä¸ä¼å¯¼è´æ¥æ¶ç«¯å¤çä¸è¿æ¥\n\n * åå§æ»å¨çªå£çå¤§å°=ç¼å­æ± ä¸­æ°æ®é+å¨æåå¨åçæ»å¨çªå£å¤§å°\n\næ³¨æäºé¡¹ï¼\n\n * æ¥æ¶æ¹éè¦æ´æ¹æ»å¨çªå£çå¤§å°æ¶ï¼éè¦ååéæ´æ¹å¤§å°çè¯·æ±ï¼ç¶åååæ´å¤§å°\n * å¦æçªå£å¤§å°ä¸º0çæ¶ï¼éè¦è®¾ç½®èªå¨åéè¯¢é®æ¥ææ¥è¯¢é®æ¥æ¶æ¹æ¯å¦ç¼å­æ± æå¯ç¨å¤§å°ï¼çªå£å³é­é®é¢ï¼\n * æ»å¨çªå£è¿å°çæ¶åï¼ä¸è¿è¡æ°æ®åéï¼ç­çªå£æ¢å¤å°ä¸å®å¤§å°æ¶åè¿è¡åéï¼ç³æ¶çªå£ç»¼åçï¼\n\n\n# æ¥å¡æ§å¶\n\næ ¹æ®ç½ç»ç¯å¢ï¼æ¯å¦ä¸¢åï¼ä½¿ç¨æ¥å¡çªå£è¿è¡æ¥å¡æ§å¶ï¼æ¥å¡æ§å¶ç®æ³å¦ä¸\n\n * æ¢å¯å¨\n   \n   æ¥å¡çªå£<=æ¢å¯å¨é¨éï¼æ¥å¡çªå£åææ°åå¢é¿\n\n * æ¥å¡é¿åç®æ³\n   \n   æ¥å¡çªå£>=æ¢å¯å¨é¨éï¼æ¥å¡çªå£åçº¿æ§å¢é¿\n\n * æ¥å¡åçç®æ³\n   \n   åºç°ä¸¢åæ¶ï¼\n   \n   ä½¿ç¨è¶æ¶éä¼ ï¼æ¢å¯å¨é¨é=æ¥å¡çªå£/2ï½æ¥å¡çªå£=1ï½éæ°å¯å¨æ¢å¯å¨\n   \n   ä½¿ç¨å¿«ééä¼ ï¼æ¥å¡çªå£ = æ¥å¡çªå£/2ï½æ¢å¯å¨é¨é = æ¥å¡çªå£ï½è¿å¥å¿«éæ¢å¤ç®æ³\n\n * å¿«éæ¢å¤\n   \n   æ¥å¡çªå£ = æ¢å¯å¨é¨é+3ï¼éè¿éä¼ ä¸ä¸ªåã\n   \n   å¦ææ¥æ¶å°éå¤çACKçè¯ï¼é£ä¹æ¥å¡çªå£+1ï¼ç»§ç»­éä¼ \n   \n   å¦ææ¯æ°çACKï¼è¿å¥æ¥å¡é¿åç®æ³\n\n\n# TCP åºåå·çä½ç¨\n\nTCPï¼ä¼ è¾æ§å¶åè®®ï¼ä¸­çåºåå·ç¨äºæ è¯TCPæ¥ææ®µä¸­çæ°æ®é¨åãæ¯ä¸ªTCPæ¥ææ®µé½åå«ä¸ä¸ªåºåå·å­æ®µï¼è¯¥å­æ®µæç¤ºäºæ¥ææ®µä¸­ç¬¬ä¸ä¸ªå­èçåºå·ãå¨åç»­çæ¥ææ®µä¸­ï¼åºåå·å°éå¢ï¼ä»¥æç¤ºä¸ä¸ä¸ªå­èçåºå·ã\n\nTCPåºåå·æ¯ä¸ä¸ª32ä½çæ ç¬¦å·æ´æ°ãå®æ¯å¨TCPè¿æ¥å»ºç«é¶æ®µç±åéæ¹éæºçæçãåºåå·çåå§å¼å¯ä»¥æ¯ä»»æå¼ï¼ä½éå¸¸æåµä¸ï¼å®æ¯éæºçæçãåºåå·çéæºæ§å¯ä»¥åå°è¿æ¥è¢«æ»å»èçæµãéæ¾ææ¬ºéªçé£é©ã\n\nå¨ä¼ è¾æ°æ®æ¶ï¼åéæ¹å°æ°æ®æåæä¸ä¸ªä¸ªTCPæ¥ææ®µï¼å¹¶å°æ¯ä¸ªæ¥ææ®µä¸­çæ°æ®é¨åæç§åºåå·éä¸ªåéãæ¥æ¶æ¹å¨æ¥æ¶å°æ¥ææ®µæ¶ï¼éè¿æ£æ¥åºåå·å­æ®µæ¥ç¡®å®æ¥æ¶å°çæ°æ®çé¡ºåºãå¦ææ¥æ¶å°çæ¥ææ®µçåºåå·ä¸æ¯æç§é¢æçé¡ºåºå°è¾¾ï¼åæ¥æ¶æ¹å¯ä»¥ä¸¢å¼è¯¥æ¥ææ®µå¹¶è¯·æ±åéæ¹éæ°åéè¯¥æ°æ®ã\n\nå¨TCPè¿æ¥ä¸­ï¼åºåå·ä¸ä»ç¨äºæ è¯æ°æ®é¨åçé¡ºåºï¼è¿ç¨äºå®ç°TCPçæµéæ§å¶åæ¥å¡æ§å¶æºå¶ãTCPè¿æ¥çæ¯ä¸ªç«¯ç¹é½ç»´æ¤ä¸ä¸ªåéçªå£åä¸ä¸ªæ¥æ¶çªå£ãåéæ¹ä½¿ç¨åºåå·ååéçªå£æ¥ç¡®å®å¯ä»¥åéçæ°æ®éï¼ä»¥é¿ååéæ¹è¿åº¦åéå¯¼è´æ¥æ¶æ¹æ æ³å¤ççæåµãæ¥æ¶æ¹ä½¿ç¨åºåå·åæ¥æ¶çªå£æ¥ç¡®å®å¯ä»¥æ¥æ¶çæ°æ®éï¼å¹¶éç¥åéæ¹çªå£å¤§å°ä»¥æ§å¶åééçï¼ä»¥é¿åç½ç»æ¥å¡ã\n\næ»ä¹ï¼TCPåºåå·æ¯TCPè¿æ¥ä¸­çéè¦ç»æé¨åï¼ç¨äºæ è¯æ°æ®é¨åçé¡ºåºåå®ç°TCPçæµéæ§å¶åæ¥å¡æ§å¶æºå¶ãå®æ¯ç±åéæ¹éæºçæç32ä½æ ç¬¦å·æ´æ°ã\n\nTCPçåºåå·æ»ç»èµ·æ¥ä¸»è¦æä»¥ä¸å ä¸ªä½ç¨ï¼\n\n 1. æ°æ®åçä¸éç»ï¼å½ä¸ä¸ªå¤§æ°æ®åè¢«åå²æå¤ä¸ªå°çTCPæ¥ææ®µè¿è¡ä¼ è¾æ¶ï¼åºåå·ç¨äºæ è¯è¿äºæ¥ææ®µä¸­çæ¯ä¸ä¸ªå­èãæ¥æ¶ç«¯éè¿æ£æ¥åºåå·ï¼å¯ä»¥åç¡®å°å°è¿äºæ¥ææ®µéæ°ç»åæå®æ´çæ°æ®åã\n 2. æ°æ®ä¼ è¾çå¯é æ§ï¼åºåå·ç¨äºè¿½è¸ªåç¡®è®¤å·²åéåå·²æ¥æ¶çæ°æ®ãæ¥æ¶ç«¯åéç¡®è®¤ï¼ACKï¼æ¥æç»åéç«¯æ¶ï¼å°ç¡®è®¤çåºåå·æ¾å¥ACKå­æ®µãè¿æ ·ï¼åéç«¯å°±ç¥éæ¥æ¶ç«¯å·²ç»æåæ¥æ¶å°äºè¯¥åºåå·ä¹åçæææ°æ®ã\n 3. æµéæ§å¶ï¼TCPä½¿ç¨æ»å¨çªå£æºå¶è¿è¡æµéæ§å¶ãåºåå·ä¸æ¥æ¶çªå£å¤§å°ä¸èµ·ï¼å¸®å©åéç«¯ç¡®å®å¯ä»¥åéçæ°æ®éï¼é²æ­¢æ¥æ¶ç«¯è¢«åéç«¯çæ°æ®æ·¹æ²¡ã\n 4. é²æ­¢æ§æ¥ææ®µçå¹²æ°ï¼å¨ç½ç»ä¸­ï¼æ¥æå¯è½ä¼å ä¸ºåç§åå èå»¶è¿å°è¾¾ç®çå°ãåºåå·å¯ä»¥å¸®å©æ¥æ¶ç«¯åºåæ°æ§æ¥ææ®µï¼ä»èé¿åå æ§æ¥ææ®µçéä¼ èå¼åçæ°æ®éè¯¯ã\n\n\n# æ»å¨çªå£åæ¥å¡çªå£\n\n * æ»å¨çªå£ï¼æ¥æ¶æ¹éè¿éååéæ¹èªå·±çå¯ä»¥æ¥åç¼å²åºå¤§å°ï¼è¿ä¸ªå­æ®µè¶å¤§è¯´æç½ç»ååéè¶é«ï¼ï¼ä»èæ§å¶åéæ¹çåééåº¦ã\n\n * æ¥å¡çªå£ï¼ä¸ä¸ªè¿æ¥çTCPåç«¯åªæ¯ç½ç»æè¾¹ç¼çä¸¤å°ä¸»æºï¼ä»ä»¬ä¸ç¥éæ´ä¸ªç½ç»æ¯å¦ä½å·¥ä½çï¼å æ­¤ä»ä»¬ä¸ç¥éå½¼æ­¤ä¹é´çææååéãå æ­¤ï¼ä»ä»¬å¿é¡»æ¾å°ä¸ç§æ¹æ³æ¥ç¡®å®å®ãæä»¬ç§°ä¹ä¸ºæ¥å¡çªå£ (CWND)ãè¿æ¯å¨æä»¬å¿é¡»åæ­¢å¹¶ç­å¾ç¡®è®¤ä¹åå¯ä»¥åéçå­èæ°ãæ¥å¡çªå£æ¯å³å®ä»»ä½æ¶åå¯ä»¥ååºçå­èæ°çå ç´ ä¹ä¸ãæ¥å¡çªå£ç±åéæ¹ç»´æ¤ï¼æ¯é»æ­¢åéæ¹åæ¥æ¶æ¹ä¹é´çé¾è·¯å æµéè¿å¤èè¿è½½çä¸ç§ææ®µãè¿ä¸åºä¸åéæ¹ç»´æ¤çæ»å¨çªå£ç¸æ··æ·ï¼æ»å¨çªå£çå­å¨æ¯ä¸ºäºé²æ­¢æ¥æ¶æ¹è¿è½½ãæ¥å¡çªå£æ¯éè¿ä¼°è®¡é¾è·¯ä¸æå¤å°æ¥å¡æ¥è®¡ç®çã\n\nå±åç¹ï¼æé«ç½ç»æ§è½ã\n\nä¸åç¹ï¼\n\n * æµéæ§å¶ï¼å¨TCPè¿æ¥ä¸å®ç°å¯¹åéæµéçæ§å¶ï¼èèç¹å¯¹ç¹ä¹é´å¯¹éä¿¡éçæ§å¶ï¼ç«¯å°ç«¯ï¼å³ï¼æ§å¶åéç«¯çæ°æ®åééçï¼ä½¿æ¥æ¶ç«¯å¯ä»¥æ¥å¾åæ¥æ¶ï¼ä¿è¯ç½ç»é«æç¨³å®è¿è¡ã\n * æ¥å¡æ§å¶ï¼å¤çç½ç»æ¥å¡ç°è±¡ï¼èèç½ç»è½å¤æ¿åç°æçç½ç»è´è·ï¼å¨å±æ§åéï¼æ¶åææçè·¯ç±å¨ãä¸»æºä»¥åä¸éä½ç½ç»ä¼ è¾æ§è½æå³çå ç´ ãé²æ­¢è¿å¤çæ°æ®æ³¨å¥å°ç½ç»ï¼ä½¿ç½ç»ä¸­çè·¯ç±å¨æé¾è·¯ä¸è´è¿è½½ï¼ç¡®ä¿éä¿¡å­ç½å¯ä»¥ææä¸ºä¸»æºä¼ éåç»ã",normalizedContent:"# tcpåudpçåºå«\n\nç¨æ·æ°æ®æ¥åè®®udpï¼user datagram protocolï¼ï¼\n\næ¯æ è¿æ¥çï¼å°½æå¤§å¯è½äº¤ä»ï¼ä¸è½ä¿è¯æ°æ®é¡ºåºï¼æ²¡ææ¥å¡æ§å¶ï¼é¢åæ¥æï¼å¯¹äºåºç¨ç¨åºä¼ ä¸æ¥çæ¥æä¸åå¹¶ä¹ä¸æåï¼åªæ¯æ·»å udpé¦é¨ï¼ï¼æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹ä¸åå¤å¯¹å¤çäº¤äºéä¿¡ã\n\nä¼ è¾æ§å¶åè®®tcpï¼transmission control protocolï¼ï¼\n\næ¯é¢åè¿æ¥çï¼æä¾å¯é äº¤ä»ï¼ä¿è¯æ°æ®é¡ºåºï¼ç±äºä½¿ç¨åºå·ï¼ï¼ææµéæ§å¶ï¼ææ¥å¡æ§å¶ï¼æä¾å¨åå·¥éä¿¡ï¼é¢åå­èæµï¼æåºç¨å±ä¼ ä¸æ¥çæ¥æçæå­èæµï¼æå­èæµç»ç»æå¤§å°ä¸ç­çæ°æ®åï¼ï¼ä»æ¯æä¸å¯¹ä¸ã\n\n\n * tcpæ¯é¢åè¿æ¥çå¯é ä¼ è¾åè®®ï¼æ¯é¢åå­èæµçï¼ä¼åçç²ååæåç°è±¡ï¼ææµéæ§å¶åæ¥å¡æ§å¶ä¿è¯å¯é ä¼ è¾ï¼éåè¦æ±å¯¹æ°æ®ä¼ è¾å¯é æ§è¦æ±é«çåºæ¯ã\n\n * udpæ¯æ è¿æ¥çï¼ä¸å¯é çä¼ è¾åè®®ï¼ä¼å°½æå¤§åªåè¿è¡äº¤ä»ï¼é¢åæ¥æï¼ä¸ä¼è¿è¡æåååå¹¶ï¼æ²¡ææ¥å¡æ§å¶ï¼éååè®¸æ°æ®å°éä¸¢å¤±çåºæ¯ï¼è½å¤å®ç°1å¯¹1ï¼1å¯¹å¤ï¼å¤å¯¹å¤çå®æ¶äº¤äºéä¿¡ã\n\n * udpé¦é¨é¿åº¦åªæ8bï¼æ¯tcpå°ã\n\n * é¢åè¿æ¥ï¼ä¸å®æ¯ãä¸å¯¹ä¸ãæè½è¿æ¥ï¼ä¸è½å udp åè®®å¯ä»¥ä¸ä¸ªä¸»æºåæ¶åå¤ä¸ªä¸»æºåéæ¶æ¯ï¼ä¹å°±æ¯ä¸å¯¹å¤æ¯æ æ³åå°çã\n\n * å¯é äº¤ä»ï¼æ è®ºçç½ç»é¾è·¯ä¸­åºç°äºææ ·çé¾è·¯ååï¼tcp é½å¯ä»¥ä¿è¯ä¸ä¸ªæ¥æä¸å®è½å¤å°è¾¾æ¥æ¶ç«¯ã\n\n * é¢åå­èæµï¼ä¹å°±æ¯è¯´ä»ä»æä¸å±åè®®ä¼ éè¿æ¥çæ°æ®å½æå­èä¼ è¾ã\n\n\n# tcpåudpåºç¨\n\ntcpï¼è¦æ±éä¿¡æ°æ®çå®æ´æ§ååç¡®æ§è¾é«ï¼æä»¶ä¼ è¾ãé®ä»¶åéãéè¦ç¶æçæ´æ°ï¼\n\nudpï¼è¦æ±éä¿¡ååºåº¦é«ï¼å¯¹æ°æ®ä¿¡æ¯çå®å¨æ§åå®æ´æ§è¦æ±è¾ä½ï¼ç½ç»çµè¯ãç½ç»è§é¢ï¼\n\n\n# å­èæµåæ¥ææ®µ\n\nåºåå­èæµåæ¥æå³é®å¨äºï¼å¯¹ä½¿ç¨åè®®çç¨æ·èè¨ï¼è¯»æ°æ®çæ¶åï¼æ¯ä¸æ¯æâè¾¹çâï¼æè¾¹çå°±æ¯æ¥æï¼æ²¡æè¾¹çå°±æ¯å­èæµ\n\næ²¡æè¾¹çï¼ä¸å±åè®®è¯»åæ°æ®çæ¶åä¸ç¥éè¯»å°äºå ä¸ªtcpæ°æ®åï¼å ä¸ºæç¼å²æ± ï¼æä»¥åéç«¯åéæ°æ®åæ¥æ¶ç«¯å¤çæ°æ®çé¢çæ¯å¯ä»¥ä¸å¯¹ç­çï¼\n\næè¾¹çï¼ä¸å±åè®®æ¯ä¸æ¬¡è¯»åå¿å®æ¯ä¸ä¸ªæ°æ®åï¼æ²¡æç¼å²æ± ï¼\n\n\n# tcpç²åãæåé®é¢\n\ntcp æ¯ä»¥æµçæ¹å¼æ¥å¤çæ°æ®ï¼ä¸ä¸ªå®æ´çåå¯è½ä¼è¢« tcp æåæå¤ä¸ªåè¿è¡åéï¼ä¹å¯è½æå°çå°è£æä¸ä¸ªå¤§çæ°æ®ååéã\n\n\nåéæ¹ï¼å³é­nagleç®æ³ãæ¥æ¶æ¹ï¼æ²¡æ³å¤çï¼åªè½äº¤ç»åºç¨å±æ¥è¿è¡å¤ç\n\nåºç¨å±ï¼\n\n * ä½¿ç¨æ åçåºç¨å±åè®®ï¼httpï¼httpsç­ï¼æ¥å°è£è¦ä¼ è¾çä¸å®é¿çæ°æ®å\n * å¨æ¯æ¡æ°æ®çå°¾é¨æ·»å ç¹æ®å­ç¬¦ï¼å¦æéå°ç¹æ®å­ç¬¦è¡¨æå½æ¡æ°æ®æ¥åå®æ¯\n * å¨åéæ°æ®åæ·»å åå¤´ï¼æ°æ®æ ¼å¼ä¸ºï¼æ°æ®å¤´+æ°æ®å\n\n\nnettyçè§£å³æ¹æ¡ï¼\n\n * æ¶æ¯å®é¿ï¼fixedlengthframedecoder\n * åå°¾å¢å ç¹æ®å­ç¬¦åå²ï¼\n   * è¡åéç¬¦ç±»ï¼linebasedframedecoder\n   * èªå®ä¹åéç¬¦ç±» ï¼delimiterbasedframedecoder\n * å°æ¶æ¯åä¸ºæ¶æ¯å¤´åæ¶æ¯ä½ï¼lengthfieldbasedframedecoder ç±»ãåä¸ºæå¤´é¨çæåä¸ç²åãé¿åº¦å­æ®µå¨åä¸æå¤´é¨çæåä¸ç²åãå¤æ©å±å¤´é¨çæåä¸ç²åã\n\nä¹å¯ä»¥ä½¿ç¨èªå®ä¹åè®®ï¼éè¿å­æ®µæ æåé¿åº¦ã\n\n\n# tcpä¸æ¬¡æ¡æ\n\nè¿ç¨ï¼\n\n * a å b åéè¿æ¥è¯·æ±æ¥æï¼syn=1ï¼ack=0ï¼seq=xã\n * b æ¶å°è¿æ¥è¯·æ±æ¥æï¼å¦æåæå»ºç«è¿æ¥ï¼åå a åéè¿æ¥ç¡®è®¤æ¥æï¼syn=1ï¼ack=1ï¼ack=x+1ï¼seq= yã\n * a æ¶å° b çè¿æ¥ç¡®è®¤æ¥æåï¼è¿è¦å b ååºç¡®è®¤ï¼ack=1ï¼ack= y+1ï¼seq=x+1ã\n\nç¬¬äºæ¬¡æ¡æå®æåsynå°è¢«ç½®ä¸º0ï¼ç¬¬ä¸æ¬¡æ¡æå¯ä»¥æºå¸¦æ°æ®ï¼åä¸¤æ¬¡ä¸å¯ä»¥æºå¸¦æ°æ®ã\n\nä¸ºä»ä¹éè¦ä¸æ¬¡ï¼\n\n * ä¸æ¬¡è¿æ¥æè½å¯é çåæ­¥åæ¹çåå§åºåå·ããtcpçå¯é ä¼ è¾æ¯é åæ­¥åºåå·å®ç°ï¼åºåå·è½ä¿è¯æ°æ®åä¸éå¤ãä¸ä¸¢å¼åæåºä¼ è¾ã\n * é²æ­¢éå¤çåå²è¿æ¥çå»ºç«ï¼é ææ··ä¹±ã\n * é¿åèµæºæµªè´¹ããéä¼ æåµã\n\néå¤åå²è¿æ¥å»ºç«çå·ä½åºæ¯ï¼å®¢æ·ç«¯ååéäº synï¼seq = 90ï¼ æ¥æï¼ç¶åå®¢æ·ç«¯å®æºäºï¼èä¸è¿ä¸ª syn æ¥æè¿è¢«ç½ç»é»å¡äºï¼æå¡ç«¯å¹¶æ²¡ææ¶å°ï¼æ¥çå®¢æ·ç«¯éå¯åï¼åéæ°åæå¡ç«¯å»ºç«è¿æ¥ï¼åéäº synï¼seq = 100ï¼ æ¥æï¼æ³¨æä¸æ¯éä¼  synï¼éä¼ ç syn çåºåå·æ¯ä¸æ ·çï¼ã\n\nå®¢æ·ç«¯è¿ç»­åéå¤æ¬¡ syn å»ºç«è¿æ¥çæ¥æï¼å¨ç½ç»æ¥å µæåµä¸ï¼\n\n * ä¸ä¸ªãæ§ syn æ¥æãæ¯ãææ°ç syn ã æ¥ææ©å°è¾¾äºæå¡ç«¯ï¼\n * é£ä¹æ­¤æ¶æå¡ç«¯å°±ä¼åä¸ä¸ª syn + ack æ¥æç»å®¢æ·ç«¯ï¼\n * å®¢æ·ç«¯æ¶å°åå¯ä»¥æ ¹æ®èªèº«çä¸ä¸æï¼å¤æ­è¿æ¯ä¸ä¸ªåå²è¿æ¥ï¼åºåå·è¿ææè¶æ¶ï¼ï¼é£ä¹å®¢æ·ç«¯å°±ä¼åé rst æ¥æç»æå¡ç«¯ï¼è¡¨ç¤ºä¸­æ­¢è¿ä¸æ¬¡è¿æ¥ã\n\n**å¦ææ¯ä¸¤æ¬¡æ¡æè¿æ¥ï¼å°±æ æ³é»æ­¢åå²è¿æ¥ã**ä¸¤æ¬¡æ¡æçæåµä¸ï¼ãè¢«å¨åèµ·æ¹ãå¨æ¶å° syn æ¥æåï¼å°±è¿å¥ established ç¶æï¼æå³çè¿æ¶å¯ä»¥ç»å¯¹æ¹åéæ°æ®ï¼ä½æ¯ãä¸»å¨åèµ·æ¹ãæ­¤æ¶è¿æ²¡æè¿å¥ established ç¶æï¼åè®¾è¿æ¬¡æ¯åå²è¿æ¥ï¼ãä¸»å¨åèµ·æ¹ãå¤æ­å°æ­¤æ¬¡è¿æ¥ä¸ºåå²è¿æ¥ï¼é£ä¹å°±ä¼å rst æ¥ææ¥æ­å¼è¿æ¥ï¼èãè¢«å¨åèµ·æ¹ãå¨ç¬¬ä¸æ¬¡æ¡æçæ¶åå°±è¿å¥ established ç¶æï¼æä»¥å®å¯ä»¥åéæ°æ®çï¼ä½æ¯å®å¹¶ä¸ç¥éè¿ä¸ªæ¯åå²è¿æ¥ï¼å®åªæå¨æ¶å° rst æ¥æåï¼æä¼æ­å¼è¿æ¥ã\n\nä¸¤æ¬¡æ¡æçè¯ï¼å½å®¢æ·ç«¯è¿ç»­åéå¤ä¸ªå»ºç«è¿æ¥çæ¥æï¼å¨ç½ç»é»å¡çæåµä¸ï¼ç±äºæå¡ç«¯æ¶å°åºç­åå°±å»ºç«äºè¿æ¥ï¼æä»¥ä¼é ææå¡ç«¯å¤ä¸ªè¿æ¥çå»ºç«ï¼ä»èå°è¯æ··ä¹±ã\n\n\n# tcpåæ¬¡æ¥æ\n\n * è¿ç¨ï¼\n   \n   * å®¢æ·ç«¯ååºè¿æ¥éæ¾æ¥ææ®µï¼fin=1ï¼åºå·seq=uï¼ï¼å¹¶åæ­¢ååéæ°æ®ï¼ä¸»å¨å³é­tcpè¿æ¥ï¼è¿å¥fin_wait1ï¼ç»æ­¢ç­å¾1ï¼ç¶æï¼ç­å¾æå¡ç«¯çç¡®è®¤ã\n   * æå¡ç«¯æ¶å°è¿æ¥éæ¾æ¥ææ®µåå³ååºç¡®è®¤æ¥ææ®µï¼ack=1ï¼ç¡®è®¤å·ack=u+1ï¼åºå·seq=vï¼ï¼æå¡ç«¯è¿å¥close_waitï¼å³é­ç­å¾ï¼ç¶æï¼æ­¤æ¶çtcpå¤äºåå³é­ç¶æï¼å®¢æ·ç«¯å°æå¡ç«¯çè¿æ¥éæ¾ãå®¢æ·ç«¯æ¶å°æå¡ç«¯çç¡®è®¤åï¼è¿å¥fin_wait2ï¼ç»æ­¢ç­å¾2ï¼ç¶æï¼ç­å¾æå¡ç«¯ååºçè¿æ¥éæ¾æ¥ææ®µã\n   * æå¡ç«¯æ²¡æè¦åå®¢æ·ç«¯ååºçæ°æ®ï¼æå¡ç«¯ååºè¿æ¥éæ¾æ¥ææ®µï¼fin=1ï¼ack=1ï¼åºå·seq=wï¼ç¡®è®¤å·ack=u+1ï¼ï¼æå¡ç«¯è¿å¥last_ackï¼æåç¡®è®¤ï¼ç¶æï¼ç­å¾å®¢æ·ç«¯çç¡®è®¤ã\n   * å®¢æ·ç«¯æ¶å°æå¡ç«¯çè¿æ¥éæ¾æ¥ææ®µåï¼å¯¹æ­¤ååºç¡®è®¤æ¥ææ®µï¼ack=1ï¼seq=u+1ï¼ack=w+1ï¼ï¼å®¢æ·ç«¯è¿å¥time_waitï¼æ¶é´ç­å¾ï¼ç¶æãæ­¤æ¶tcpæªéæ¾æï¼éè¦ç»è¿æ¶é´ç­å¾è®¡æ¶å¨è®¾ç½®çæ¶é´2mslåï¼å®¢æ·ç«¯æè¿å¥closedç¶æã\n   \n   \n   \n   ä¸ºä»ä¹æ¯åæ¬¡ï¼\n   \n   è¿ç±tcpçåå³é­ï¼half-closeï¼é æçãæè°çåå³é­ï¼å¶å®å°±æ¯tcpæä¾äºè¿æ¥çä¸ç«¯å¨ç»æå®çåéåè¿è½æ¥æ¶æ¥èªå¦ä¸ç«¯æ°æ®çè½åã\n   \n   ä¸ºä»ä¹éè¦ç­å¾2ä¸ªmsl\n   \n   é²æ­¢ä¸»å¨æ¥åæ¹åéçæåç¡®è®¤æ¥æï¼è¢«å¨æ¥åæ¹æ²¡è½æ¥åå°ï¼è§¦åè¢«å¨æ¥åæ¹çè¶æ¶éä¼ ï¼ä¸æ¥ä¸ååå¥½ä¸¤ä¸ª2msl\n   \n   mslï¼maximum segment lifetimeï¼ä¸ºæ¥ææå¤§çå­æ¶é´ï¼ä»æ¯ä»»ä½æ¥æå¨ç½ç»ä¸å­å¨çæé¿æ¶é´ï¼è¶è¿è¿ä¸ªæ¶é´æ¥æå°ä¼è¢«ä¸¢å¼ï¼è¢«æ¥æ¶æ¹å¤çååååéæ¹åéååºï¼ä¸æ¥ä¸åéè¦ç­å¾2åçæ¶é´\n   \n   ä¸ºä»ä¹ç¬¬äºæ¬¡æ¥æåç¬¬ä¸æ¬¡æ¥æä¸è½åå¹¶æä¸æ¬¡\n   \n   æå¡å¨éè¦ååºç­æ¥åå°äºå®¢æ·ç«¯éè¦æ­å¼çè¯·æ±ï¼ä½æ¯æå¡å¨å¯è½è¿ææ°æ®éè¦å¤çååéï¼å¹¶ä¸tcpå·æä¸ç«¯å¨ç»æå®åéåä»è½æ¥åæ°æ®çè½åï¼å æ­¤æå¡å¨è¿è½åå®¢æ·ç«¯è¿è¡åéæ°æ®\n\n\n# tcpå¯é ä¼ è¾\n\ntcpéè¿éä¼ æºå¶ãæµéæ§å¶ãæ¥å¡æ§å¶æ¥å®ç°å¯é ä¼ è¾\n\n\n# éä¼ æºå¶\n\néä¼ æºå¶     æè¿°\nè¶æ¶éä¼      è¶åºä¸å®æ¶é´æ²¡ææ¶å°ååºè§¦åéä¼ æºå¶\nå¿«ééä¼      è¿ç»­æ¶å°ä¸æ¬¡ç¸åçackè§¦åéä¼ æºå¶\nsack     tcpçå­æ®µä¸­æ·»å sackï¼æ¾ç¤ºåªäºæ°æ®è¢«æ¥æ¶å°\nd-sack   ç¨sackå­æ®µè¡¨æåªäºæ°æ®è¢«éå¤æ¥æ¶ï¼ç¨ackè¡¨æåªäºå­æ®µä¸¢å¤±ï¼å¯ä»¥ç¨æ¥æ£æµæ¯ååºä¸¢å¤±è¿æ¯è¯·æ±ä¸¢å¤±\n\ntcpè¶æ¶éä¼ åå¿«ééä¼ é½æ¯tcpåè®®å¨æ°æ®ä¼ è¾æ¶ä½¿ç¨çæºå¶ï¼ç¨äºæé«æ°æ®ä¼ è¾çå¯é æ§ãå®ä»¬çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. è§¦åæºå¶ï¼tcpè¶æ¶éä¼ æ¯å¨åéæ°æ®åç­å¾ä¸æ®µæ¶é´ï¼å¦ææªæ¶å°ç¡®è®¤åºç­ï¼å°±ä¼è§¦åéä¼ æºå¶ï¼èå¿«ééä¼ æ¯å¨æ¥æ¶å°éå¤ç¡®è®¤åºç­æ¶è§¦åçï¼è¿æå³çç½ç»åºç°æ¥å¡ï¼å¯¼è´æ°æ®åä¸¢å¤±ã\n 2. éä¼ æ¬¡æ°ï¼tcpè¶æ¶éä¼ ä¼å¨æ¯æ¬¡è¶æ¶åéä¼ æ°æ®åï¼ç´å°æ¶å°ç¡®è®¤åºç­ä¸ºæ­¢ï¼èå¿«ééä¼ åªä¼å¨æ¥æ¶å°3ä¸ªéå¤ç¡®è®¤åºç­åç«å³éä¼ æ°æ®åï¼é¿åäºç­å¾è¶æ¶æ¶é´çå»¶è¿ã\n 3. å¯¹ç½ç»æ§è½çå½±åï¼tcpè¶æ¶éä¼ ä¼å¯¼è´ç½ç»åºç°æ´å¤çæ¥å¡ï¼å ä¸ºæ¯æ¬¡éä¼ é½ä¼éæ°åéæææ°æ®åï¼èè¿äºæ°æ®åå¯è½ä¼å¢å ç½ç»æ¥å¡çç¨åº¦ãèå¿«ééä¼ éè¿åå°æ°æ®åçéä¼ æ¬¡æ°ï¼å¯ä»¥åè½»ç½ç»æ¥å¡çç¨åº¦ã\n\n\n# æµéæ§å¶åæ¥å¡æ§å¶çåºå«\n\ntcpæµéæ§å¶åæ¥å¡æ§å¶æ¯tcpåè®®ä¸­ä¸¤ä¸ªéè¦çæºå¶ï¼å®ä»¬çä¸»è¦åºå«å¦ä¸ï¼\n\n 1. ç®çä¸åï¼tcpæµéæ§å¶çç®çæ¯ç¡®ä¿åéæ¹ä¸ä¼åéä½¿æ¥æ¶æ¹æ æ³å¤çæ°æ®ï¼éè¿å¨æè°æ´åéæ¹åéçæ°æ®éï¼æ§å¶æ¥æ¶æ¹çæ¥æ¶éçï¼ä»¥è¾¾å°å¹³è¡¡åéæ¹åæ¥æ¶æ¹ä¹é´çæ°æ®æµéãæ¥å¡æ§å¶åæ¯ä¸ºäºé²æ­¢ç½ç»æ¥å¡èéåçä¸ç§æºå¶ã\n\n 2. æ§å¶å¯¹è±¡ä¸åï¼tcpæµéæ§å¶æ¯å¯¹åä¸ªè¿æ¥çåéæ¹åæ¥æ¶æ¹ä¹é´çæ°æ®æµéè¿è¡æ§å¶ï¼èæ¥å¡æ§å¶æ¯å¯¹æ´ä¸ªç½ç»çæµéè¿è¡æ§å¶ã\n\n 3. è§¦åæºå¶ä¸åï¼tcpæµéæ§å¶æ¯ç±æ¥æ¶æ¹æ¥è§¦åçï¼å½æ¥æ¶æ¹å¤çä¸è¿æ¥æ°æ®æ¶ï¼ä¼åéçªå£éåï¼window sizeï¼ï¼åè¯åéæ¹å¯ä»¥åéçæ°æ®éï¼ä»èæ§å¶åéæ¹çåééçãèæ¥å¡æ§å¶åæ¯ç±ç½ç»çæ¥å¡æåµæ¥è§¦åçï¼å½ç½ç»æ¥å¡æ¶ï¼åéæ¹ä¼æ¶å°æ¥å¡ä¿¡å·ï¼congestion signalï¼ï¼ä»èè°æ´åééçã\n\n 4. å®ç°æ¹æ³ä¸åï¼tcpæµéæ§å¶éè¿è°æ´çªå£å¤§å°æ¥æ§å¶åéæ¹çåééçãçªå£å¤§å°æ¯åéæ¹åæ¥æ¶æ¹ä¹é´çä¸ä¸ªåæ°ï¼åéæ¹å¯ä»¥æ ¹æ®çªå£å¤§å°æ¥ç¡®å®å¯ä»¥åéçæ°æ®éãèæ¥å¡æ§å¶åéç¨äºå¤ç§ç®æ³ï¼ä¾å¦tcp renoãtcp vegasç­ï¼éè¿ä¸åçç®æ³æ¥è°æ´åéæ¹çåééçï¼ä»¥é¿åç½ç»æ¥å¡ã\n\n\n# æµéæ§å¶\n\néè¿ä½¿ç¨æ»å¨çªå£æ¥è¿è¡æµéæ§å¶\n\n * æ»å¨çªå£çå¤§å°å°±æ¯æåéæ¹æ éç­å¾ç¡®è®¤åºç­ï¼èå¯ä»¥ç»§ç»­åéæ°æ®çæå¤§å¼\n\n * æ»å¨çªå£çå¤§å°æ¯ç±æ¥æ¶æ¹ççªå£å¤§å°å³å®çï¼æ¥æ¶æ¹åè¯åéæ¹èªå·±æå¤å°ç¼å²åºå¯ä»¥æ¥æ¶æ°æ®ï¼åéæ¹æ ¹æ®è¿ä¸ªæ¥æ¶ç«¯çå¤çè½åæ¥åéæ°æ®ï¼èä¸ä¼å¯¼è´æ¥æ¶ç«¯å¤çä¸è¿æ¥\n\n * åå§æ»å¨çªå£çå¤§å°=ç¼å­æ± ä¸­æ°æ®é+å¨æåå¨åçæ»å¨çªå£å¤§å°\n\næ³¨æäºé¡¹ï¼\n\n * æ¥æ¶æ¹éè¦æ´æ¹æ»å¨çªå£çå¤§å°æ¶ï¼éè¦ååéæ´æ¹å¤§å°çè¯·æ±ï¼ç¶åååæ´å¤§å°\n * å¦æçªå£å¤§å°ä¸º0çæ¶ï¼éè¦è®¾ç½®èªå¨åéè¯¢é®æ¥ææ¥è¯¢é®æ¥æ¶æ¹æ¯å¦ç¼å­æ± æå¯ç¨å¤§å°ï¼çªå£å³é­é®é¢ï¼\n * æ»å¨çªå£è¿å°çæ¶åï¼ä¸è¿è¡æ°æ®åéï¼ç­çªå£æ¢å¤å°ä¸å®å¤§å°æ¶åè¿è¡åéï¼ç³æ¶çªå£ç»¼åçï¼\n\n\n# æ¥å¡æ§å¶\n\næ ¹æ®ç½ç»ç¯å¢ï¼æ¯å¦ä¸¢åï¼ä½¿ç¨æ¥å¡çªå£è¿è¡æ¥å¡æ§å¶ï¼æ¥å¡æ§å¶ç®æ³å¦ä¸\n\n * æ¢å¯å¨\n   \n   æ¥å¡çªå£<=æ¢å¯å¨é¨éï¼æ¥å¡çªå£åææ°åå¢é¿\n\n * æ¥å¡é¿åç®æ³\n   \n   æ¥å¡çªå£>=æ¢å¯å¨é¨éï¼æ¥å¡çªå£åçº¿æ§å¢é¿\n\n * æ¥å¡åçç®æ³\n   \n   åºç°ä¸¢åæ¶ï¼\n   \n   ä½¿ç¨è¶æ¶éä¼ ï¼æ¢å¯å¨é¨é=æ¥å¡çªå£/2ï½æ¥å¡çªå£=1ï½éæ°å¯å¨æ¢å¯å¨\n   \n   ä½¿ç¨å¿«ééä¼ ï¼æ¥å¡çªå£ = æ¥å¡çªå£/2ï½æ¢å¯å¨é¨é = æ¥å¡çªå£ï½è¿å¥å¿«éæ¢å¤ç®æ³\n\n * å¿«éæ¢å¤\n   \n   æ¥å¡çªå£ = æ¢å¯å¨é¨é+3ï¼éè¿éä¼ ä¸ä¸ªåã\n   \n   å¦ææ¥æ¶å°éå¤çackçè¯ï¼é£ä¹æ¥å¡çªå£+1ï¼ç»§ç»­éä¼ \n   \n   å¦ææ¯æ°çackï¼è¿å¥æ¥å¡é¿åç®æ³\n\n\n# tcp åºåå·çä½ç¨\n\ntcpï¼ä¼ è¾æ§å¶åè®®ï¼ä¸­çåºåå·ç¨äºæ è¯tcpæ¥ææ®µä¸­çæ°æ®é¨åãæ¯ä¸ªtcpæ¥ææ®µé½åå«ä¸ä¸ªåºåå·å­æ®µï¼è¯¥å­æ®µæç¤ºäºæ¥ææ®µä¸­ç¬¬ä¸ä¸ªå­èçåºå·ãå¨åç»­çæ¥ææ®µä¸­ï¼åºåå·å°éå¢ï¼ä»¥æç¤ºä¸ä¸ä¸ªå­èçåºå·ã\n\ntcpåºåå·æ¯ä¸ä¸ª32ä½çæ ç¬¦å·æ´æ°ãå®æ¯å¨tcpè¿æ¥å»ºç«é¶æ®µç±åéæ¹éæºçæçãåºåå·çåå§å¼å¯ä»¥æ¯ä»»æå¼ï¼ä½éå¸¸æåµä¸ï¼å®æ¯éæºçæçãåºåå·çéæºæ§å¯ä»¥åå°è¿æ¥è¢«æ»å»èçæµãéæ¾ææ¬ºéªçé£é©ã\n\nå¨ä¼ è¾æ°æ®æ¶ï¼åéæ¹å°æ°æ®æåæä¸ä¸ªä¸ªtcpæ¥ææ®µï¼å¹¶å°æ¯ä¸ªæ¥ææ®µä¸­çæ°æ®é¨åæç§åºåå·éä¸ªåéãæ¥æ¶æ¹å¨æ¥æ¶å°æ¥ææ®µæ¶ï¼éè¿æ£æ¥åºåå·å­æ®µæ¥ç¡®å®æ¥æ¶å°çæ°æ®çé¡ºåºãå¦ææ¥æ¶å°çæ¥ææ®µçåºåå·ä¸æ¯æç§é¢æçé¡ºåºå°è¾¾ï¼åæ¥æ¶æ¹å¯ä»¥ä¸¢å¼è¯¥æ¥ææ®µå¹¶è¯·æ±åéæ¹éæ°åéè¯¥æ°æ®ã\n\nå¨tcpè¿æ¥ä¸­ï¼åºåå·ä¸ä»ç¨äºæ è¯æ°æ®é¨åçé¡ºåºï¼è¿ç¨äºå®ç°tcpçæµéæ§å¶åæ¥å¡æ§å¶æºå¶ãtcpè¿æ¥çæ¯ä¸ªç«¯ç¹é½ç»´æ¤ä¸ä¸ªåéçªå£åä¸ä¸ªæ¥æ¶çªå£ãåéæ¹ä½¿ç¨åºåå·ååéçªå£æ¥ç¡®å®å¯ä»¥åéçæ°æ®éï¼ä»¥é¿ååéæ¹è¿åº¦åéå¯¼è´æ¥æ¶æ¹æ æ³å¤ççæåµãæ¥æ¶æ¹ä½¿ç¨åºåå·åæ¥æ¶çªå£æ¥ç¡®å®å¯ä»¥æ¥æ¶çæ°æ®éï¼å¹¶éç¥åéæ¹çªå£å¤§å°ä»¥æ§å¶åééçï¼ä»¥é¿åç½ç»æ¥å¡ã\n\næ»ä¹ï¼tcpåºåå·æ¯tcpè¿æ¥ä¸­çéè¦ç»æé¨åï¼ç¨äºæ è¯æ°æ®é¨åçé¡ºåºåå®ç°tcpçæµéæ§å¶åæ¥å¡æ§å¶æºå¶ãå®æ¯ç±åéæ¹éæºçæç32ä½æ ç¬¦å·æ´æ°ã\n\ntcpçåºåå·æ»ç»èµ·æ¥ä¸»è¦æä»¥ä¸å ä¸ªä½ç¨ï¼\n\n 1. æ°æ®åçä¸éç»ï¼å½ä¸ä¸ªå¤§æ°æ®åè¢«åå²æå¤ä¸ªå°çtcpæ¥ææ®µè¿è¡ä¼ è¾æ¶ï¼åºåå·ç¨äºæ è¯è¿äºæ¥ææ®µä¸­çæ¯ä¸ä¸ªå­èãæ¥æ¶ç«¯éè¿æ£æ¥åºåå·ï¼å¯ä»¥åç¡®å°å°è¿äºæ¥ææ®µéæ°ç»åæå®æ´çæ°æ®åã\n 2. æ°æ®ä¼ è¾çå¯é æ§ï¼åºåå·ç¨äºè¿½è¸ªåç¡®è®¤å·²åéåå·²æ¥æ¶çæ°æ®ãæ¥æ¶ç«¯åéç¡®è®¤ï¼ackï¼æ¥æç»åéç«¯æ¶ï¼å°ç¡®è®¤çåºåå·æ¾å¥ackå­æ®µãè¿æ ·ï¼åéç«¯å°±ç¥éæ¥æ¶ç«¯å·²ç»æåæ¥æ¶å°äºè¯¥åºåå·ä¹åçæææ°æ®ã\n 3. æµéæ§å¶ï¼tcpä½¿ç¨æ»å¨çªå£æºå¶è¿è¡æµéæ§å¶ãåºåå·ä¸æ¥æ¶çªå£å¤§å°ä¸èµ·ï¼å¸®å©åéç«¯ç¡®å®å¯ä»¥åéçæ°æ®éï¼é²æ­¢æ¥æ¶ç«¯è¢«åéç«¯çæ°æ®æ·¹æ²¡ã\n 4. é²æ­¢æ§æ¥ææ®µçå¹²æ°ï¼å¨ç½ç»ä¸­ï¼æ¥æå¯è½ä¼å ä¸ºåç§åå èå»¶è¿å°è¾¾ç®çå°ãåºåå·å¯ä»¥å¸®å©æ¥æ¶ç«¯åºåæ°æ§æ¥ææ®µï¼ä»èé¿åå æ§æ¥ææ®µçéä¼ èå¼åçæ°æ®éè¯¯ã\n\n\n# æ»å¨çªå£åæ¥å¡çªå£\n\n * æ»å¨çªå£ï¼æ¥æ¶æ¹éè¿éååéæ¹èªå·±çå¯ä»¥æ¥åç¼å²åºå¤§å°ï¼è¿ä¸ªå­æ®µè¶å¤§è¯´æç½ç»ååéè¶é«ï¼ï¼ä»èæ§å¶åéæ¹çåééåº¦ã\n\n * æ¥å¡çªå£ï¼ä¸ä¸ªè¿æ¥çtcpåç«¯åªæ¯ç½ç»æè¾¹ç¼çä¸¤å°ä¸»æºï¼ä»ä»¬ä¸ç¥éæ´ä¸ªç½ç»æ¯å¦ä½å·¥ä½çï¼å æ­¤ä»ä»¬ä¸ç¥éå½¼æ­¤ä¹é´çææååéãå æ­¤ï¼ä»ä»¬å¿é¡»æ¾å°ä¸ç§æ¹æ³æ¥ç¡®å®å®ãæä»¬ç§°ä¹ä¸ºæ¥å¡çªå£ (cwnd)ãè¿æ¯å¨æä»¬å¿é¡»åæ­¢å¹¶ç­å¾ç¡®è®¤ä¹åå¯ä»¥åéçå­èæ°ãæ¥å¡çªå£æ¯å³å®ä»»ä½æ¶åå¯ä»¥ååºçå­èæ°çå ç´ ä¹ä¸ãæ¥å¡çªå£ç±åéæ¹ç»´æ¤ï¼æ¯é»æ­¢åéæ¹åæ¥æ¶æ¹ä¹é´çé¾è·¯å æµéè¿å¤èè¿è½½çä¸ç§ææ®µãè¿ä¸åºä¸åéæ¹ç»´æ¤çæ»å¨çªå£ç¸æ··æ·ï¼æ»å¨çªå£çå­å¨æ¯ä¸ºäºé²æ­¢æ¥æ¶æ¹è¿è½½ãæ¥å¡çªå£æ¯éè¿ä¼°è®¡é¾è·¯ä¸æå¤å°æ¥å¡æ¥è®¡ç®çã\n\nå±åç¹ï¼æé«ç½ç»æ§è½ã\n\nä¸åç¹ï¼\n\n * æµéæ§å¶ï¼å¨tcpè¿æ¥ä¸å®ç°å¯¹åéæµéçæ§å¶ï¼èèç¹å¯¹ç¹ä¹é´å¯¹éä¿¡éçæ§å¶ï¼ç«¯å°ç«¯ï¼å³ï¼æ§å¶åéç«¯çæ°æ®åééçï¼ä½¿æ¥æ¶ç«¯å¯ä»¥æ¥å¾åæ¥æ¶ï¼ä¿è¯ç½ç»é«æç¨³å®è¿è¡ã\n * æ¥å¡æ§å¶ï¼å¤çç½ç»æ¥å¡ç°è±¡ï¼èèç½ç»è½å¤æ¿åç°æçç½ç»è´è·ï¼å¨å±æ§åéï¼æ¶åææçè·¯ç±å¨ãä¸»æºä»¥åä¸éä½ç½ç»ä¼ è¾æ§è½æå³çå ç´ ãé²æ­¢è¿å¤çæ°æ®æ³¨å¥å°ç½ç»ï¼ä½¿ç½ç»ä¸­çè·¯ç±å¨æé¾è·¯ä¸è´è¿è½½ï¼ç¡®ä¿éä¿¡å­ç½å¯ä»¥ææä¸ºä¸»æºä¼ éåç»ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"IP",frontmatter:{title:"IP",date:"2023-03-21T20:54:06.000Z",permalink:"/pages/42791d/"},regularPath:"/04.%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/04.%E7%BD%91%E7%BB%9C%E5%B1%82/01.IP.html",relativePath:"04.è®¡ç®æºç½ç»/04.ç½ç»å±/01.IP.md",key:"v-1d611f27",path:"/pages/42791d/",headers:[{level:2,title:"IPåå",slug:"ipåå",normalizedTitle:"ipåå",charIndex:34},{level:3,title:"ABCDEç±»ç½ç»",slug:"abcdeç±»ç½ç»",normalizedTitle:"abcdeç±»ç½ç»",charIndex:140},{level:3,title:"CIDR",slug:"cidr",normalizedTitle:"cidr",charIndex:116},{level:3,title:"å­ç½æ©ç ",slug:"å­ç½æ©ç ",normalizedTitle:"å­ç½æ©ç ",charIndex:121},{level:2,title:"å¬/ç§æIP",slug:"å¬-ç§æip",normalizedTitle:"å¬/ç§æip",charIndex:523},{level:2,title:"NAT",slug:"nat",normalizedTitle:"nat",charIndex:596}],headersStr:"IPåå ABCDEç±»ç½ç» CIDR å­ç½æ©ç  å¬/ç§æIP NAT",content:"IPçä½ç¨æ¯å¨å¤æçç½ç»ç¯å¢ä¸­å°æ°æ®ååéç»æç»ç®ççä¸»æº\n\n\n# IPåå\n\nIPååçä¼å¿\n\nå¦æç½ç»å·ç¸åè¡¨ç¤ºå¨åä¸ä¸ªæ¬å°ç½ç»ä¸ï¼å¯ä»¥ç´æ¥ææ°æ®ååéå°ç®æ ä¸»æºãå¦æä¸åï¼ç½ç»å·ä¹å¯ä»¥éåè·¯ç±æ¥è¿è¡å¯»åå·¥ä½ã\n\nABCDEç±»ãCIDRãå­ç½æ©ç åå¯å¯¹IPè¿è¡åç±»ï¼\n\n\n# ABCDEç±»ç½ç»\n\nABCç±»ååä¸ºç½ç»å·+ä¸»æºå·ï¼åå«Aç±»1+7+24ï¼Bç±»2+14+16ï¼Cç±»3+21+8\n\nDç±»ç¨äºå¤æ­\n\nEç±»ä¿ç\n\nä¸»æºå·å¨ä¸º1è¡¨ç¤ºå¹¿æ­ï¼æ¬å°å¹¿æ­åç´æ¥å¹¿æ­ï¼ï¼ä¸»æºå·å¨ä¸º0è¡¨ç¤ºæä¸ªç½ç»\n\nä¼å¿ï¼ABCç±»çååï¼å¯ä»¥ä»ä»ä¾é å¤´é¨å ä½æ°å­å¤æ­åºæ¯åªç±»ç½ç»ï¼å¹¶å¯ä»¥å¾å¿«æ¾åºç½ç»å°ååä¸»æºå°å\n\nç¼ºç¹ï¼ABCç±»ä¸è½å¾å¥½çå®ç°æ¾ç¤ºç½ç»å¹éï¼Cç±»å¤ªå°ï¼Bç±»å¤ªå¤\n\n\n# CIDR\n\n32ä½å°åä»è¢«ååä¸ºç½ç»å·+ä¸»æºå·ï¼a.b.c.d/x(åxä½æ¯ç½ç»å·)\n\næç¹ï¼ç¨äºå¾å¥½çå®ç°ä¸»æºæ°ç®çåå\n\n\n# å­ç½æ©ç \n\næ¢å¯ä»¥ç¨æ¥ååç½ç»å·+ä¸»æºå·ï¼åå¯ä»¥è¿ä¸æ­¥ååä¸»æºå·ï¼ååä¸ºå­ç½ç½ç»å°å+å­ç½ä¸»æºå°å\n\nä¼å¿ï¼éè¿ååå­ç½ï¼å¯ä»¥1.èçº¦IPå°åï¼é¿åæµªè´¹ã2.æé«ç½ç»æ§è½ã3.å¯ä»¥ä¿è¯ç½ç»çå®å¨ã4.æäºæ©å¤§å°çèå´ï¼æå©äºè¦çå¤§åå°çåºåã\n\n\n# å¬/ç§æIP\n\nipconfigæ¥åºæ¥çæ¯ç§æIPï¼åªè½å¨å±åç½ä¸­ä½¿ç¨ï¼ä¸è½ä¸ç½ã\n\nç¾åº¦æç´¢åºæ¥çæ¯å±æIPï¼è½ä¸ç½ï¼ä¸è¬æ¯è¿è¥åçã\n\n\n# NAT\n\n * NATï¼Network Address Translationï¼ç½ç»å°åè½¬æ¢\n   \n   ç§æIPå¨å¯¹å¤é¨éä¿¡çæ¶åï¼å°ç§æIPè½¬åä¸ºNATè·¯ç±å¨çå¬æIPï¼è§£å³IPå°åä¸è¶³çé®é¢ã\n\n * NAPTï¼Network Address and Port Translationï¼ç½ç»å°åç«¯å£è½¬æ¢\n   \n   ç§æIPå¨å¯¹å¤é¨éä¿¡çæ¶åï¼å°ç§æIPè½¬åä¸ºNATè·¯ç±å¨çå¬æIP+ç¬ä¸æ äºçç«¯å£å·ï¼å¹¶å°ç§æIPåå¬æIP+ç«¯å£å·è®°å½å¨è½¬æ¢è¡¨ä¸­ï¼è¿æ¥ç»æä»¥ååè½¬æ¢è¡¨ä¸­å é¤ï¼\n   \n   ç¼ºç¹ï¼\n   \n   1.å¤é¨æ æ³ä¸»å¨ä¸NATåé¨æå¡å¨å»ºç«è¿æ¥ï¼å ä¸ºNAPTè½¬æ¢è¡¨æ²¡æè½¬æ¢è®°å½\n   \n   2.è½¬æ¢è¡¨ççæä¸è½¬æ¢æä½é½ä¼äº§çæ§è½çå¼é\n   \n   3.éä¿¡è¿ç¨ä¸­ï¼å¦æNATè·¯ç±å¨éå¯ï¼ææTCPè¿æ¥é½å°è¢«éå¶\n   \n   è§£å³æ¹æ³ï¼\n   \n   NATç©¿éææ¯ï¼å®¢æ·ç«¯ä¸»å¨ä»NATè®¾å¤è·åå¬æIPå°åï¼ç¶åèªå·±å»ºç«ç«¯å£æ å°æ¡ç®ï¼ç¶åç¨è¿ä¸ªæ¡ç®å¯¹å¤éä¿¡ã",normalizedContent:"ipçä½ç¨æ¯å¨å¤æçç½ç»ç¯å¢ä¸­å°æ°æ®ååéç»æç»ç®ççä¸»æº\n\n\n# ipåå\n\nipååçä¼å¿\n\nå¦æç½ç»å·ç¸åè¡¨ç¤ºå¨åä¸ä¸ªæ¬å°ç½ç»ä¸ï¼å¯ä»¥ç´æ¥ææ°æ®ååéå°ç®æ ä¸»æºãå¦æä¸åï¼ç½ç»å·ä¹å¯ä»¥éåè·¯ç±æ¥è¿è¡å¯»åå·¥ä½ã\n\nabcdeç±»ãcidrãå­ç½æ©ç åå¯å¯¹ipè¿è¡åç±»ï¼\n\n\n# abcdeç±»ç½ç»\n\nabcç±»ååä¸ºç½ç»å·+ä¸»æºå·ï¼åå«aç±»1+7+24ï¼bç±»2+14+16ï¼cç±»3+21+8\n\ndç±»ç¨äºå¤æ­\n\neç±»ä¿ç\n\nä¸»æºå·å¨ä¸º1è¡¨ç¤ºå¹¿æ­ï¼æ¬å°å¹¿æ­åç´æ¥å¹¿æ­ï¼ï¼ä¸»æºå·å¨ä¸º0è¡¨ç¤ºæä¸ªç½ç»\n\nä¼å¿ï¼abcç±»çååï¼å¯ä»¥ä»ä»ä¾é å¤´é¨å ä½æ°å­å¤æ­åºæ¯åªç±»ç½ç»ï¼å¹¶å¯ä»¥å¾å¿«æ¾åºç½ç»å°ååä¸»æºå°å\n\nç¼ºç¹ï¼abcç±»ä¸è½å¾å¥½çå®ç°æ¾ç¤ºç½ç»å¹éï¼cç±»å¤ªå°ï¼bç±»å¤ªå¤\n\n\n# cidr\n\n32ä½å°åä»è¢«ååä¸ºç½ç»å·+ä¸»æºå·ï¼a.b.c.d/x(åxä½æ¯ç½ç»å·)\n\næç¹ï¼ç¨äºå¾å¥½çå®ç°ä¸»æºæ°ç®çåå\n\n\n# å­ç½æ©ç \n\næ¢å¯ä»¥ç¨æ¥ååç½ç»å·+ä¸»æºå·ï¼åå¯ä»¥è¿ä¸æ­¥ååä¸»æºå·ï¼ååä¸ºå­ç½ç½ç»å°å+å­ç½ä¸»æºå°å\n\nä¼å¿ï¼éè¿ååå­ç½ï¼å¯ä»¥1.èçº¦ipå°åï¼é¿åæµªè´¹ã2.æé«ç½ç»æ§è½ã3.å¯ä»¥ä¿è¯ç½ç»çå®å¨ã4.æäºæ©å¤§å°çèå´ï¼æå©äºè¦çå¤§åå°çåºåã\n\n\n# å¬/ç§æip\n\nipconfigæ¥åºæ¥çæ¯ç§æipï¼åªè½å¨å±åç½ä¸­ä½¿ç¨ï¼ä¸è½ä¸ç½ã\n\nç¾åº¦æç´¢åºæ¥çæ¯å±æipï¼è½ä¸ç½ï¼ä¸è¬æ¯è¿è¥åçã\n\n\n# nat\n\n * natï¼network address translationï¼ç½ç»å°åè½¬æ¢\n   \n   ç§æipå¨å¯¹å¤é¨éä¿¡çæ¶åï¼å°ç§æipè½¬åä¸ºnatè·¯ç±å¨çå¬æipï¼è§£å³ipå°åä¸è¶³çé®é¢ã\n\n * naptï¼network address and port translationï¼ç½ç»å°åç«¯å£è½¬æ¢\n   \n   ç§æipå¨å¯¹å¤é¨éä¿¡çæ¶åï¼å°ç§æipè½¬åä¸ºnatè·¯ç±å¨çå¬æip+ç¬ä¸æ äºçç«¯å£å·ï¼å¹¶å°ç§æipåå¬æip+ç«¯å£å·è®°å½å¨è½¬æ¢è¡¨ä¸­ï¼è¿æ¥ç»æä»¥ååè½¬æ¢è¡¨ä¸­å é¤ï¼\n   \n   ç¼ºç¹ï¼\n   \n   1.å¤é¨æ æ³ä¸»å¨ä¸natåé¨æå¡å¨å»ºç«è¿æ¥ï¼å ä¸ºnaptè½¬æ¢è¡¨æ²¡æè½¬æ¢è®°å½\n   \n   2.è½¬æ¢è¡¨ççæä¸è½¬æ¢æä½é½ä¼äº§çæ§è½çå¼é\n   \n   3.éä¿¡è¿ç¨ä¸­ï¼å¦ænatè·¯ç±å¨éå¯ï¼æætcpè¿æ¥é½å°è¢«éå¶\n   \n   è§£å³æ¹æ³ï¼\n   \n   natç©¿éææ¯ï¼å®¢æ·ç«¯ä¸»å¨ä»natè®¾å¤è·åå¬æipå°åï¼ç¶åèªå·±å»ºç«ç«¯å£æ å°æ¡ç®ï¼ç¶åç¨è¿ä¸ªæ¡ç®å¯¹å¤éä¿¡ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"Ctrl+Cåçäºä»ä¹",frontmatter:{title:"Ctrl+Cåçäºä»ä¹",date:"2023-08-28T20:58:16.000Z",permalink:"/pages/0b3887/"},regularPath:"/05.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/02.Ctrl+C%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88.html",relativePath:"05.æä½ç³»ç»/02.Ctrl+Cåçäºä»ä¹.md",key:"v-8153bf3c",path:"/pages/0b3887/",headersStr:null,content:"https://www.timiguo.com/archives/209/\n\nç¨æ·æä¸Ctrl-Cï¼è¿ä¸ªé®çè¾å¥äº§çä¸ä¸ªç¡¬ä»¶ä¸­æ­ã\n\nå¦æCPUå½åæ­£å¨æ§è¡è¿ä¸ªè¿ç¨çä»£ç ï¼åè¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç æåæ§è¡ï¼CPUä»ç¨æ·æåæ¢å°åæ ¸æå¤çç¡¬ä»¶ä¸­æ­ã\n\nç»ç«¯é©±å¨ç¨åºå°Ctrl-Cè§£éæä¸ä¸ªSIGINTä¿¡å·ï¼è®°å¨è¯¥è¿ç¨çPCBä¸­ï¼ä¹å¯ä»¥è¯´åéäºä¸ä¸ªSIGINTä¿¡å·ç»è¯¥è¿ç¨ï¼ã\n\nå½æä¸ªæ¶å»è¦ä»åæ ¸è¿åå°è¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç ç»§ç»­æ§è¡ä¹åï¼é¦åå¤çPCBä¸­è®°å½çä¿¡å·ï¼åç°æä¸ä¸ªSIGINTä¿¡å·å¾å¤çï¼èè¿ä¸ªä¿¡å·çé»è®¤å¤çå¨ä½æ¯ç»æ­¢è¿ç¨ï¼æä»¥ç´æ¥ç»æ­¢è¿ç¨èä¸åè¿åå®çç¨æ·ç©ºé´ä»£ç æ§è¡ã\n\næ³¨æï¼Ctrl-Cäº§ççä¿¡å·åªè½åç»åå°è¿ç¨ãä¸ä¸ªå½ä»¤åé¢å ä¸ª&å¯ä»¥æ¾å°åå°è¿è¡ï¼è¿æ ·Shellä¸å¿ç­å¾è¿ç¨ç»æå°±å¯ä»¥æ¥åæ°çå½ä»¤ï¼å¯å¨æ°çè¿ç¨ãShellå¯ä»¥åæ¶è¿è¡ä¸ä¸ªåå°è¿ç¨åä»»æå¤ä¸ªåå°è¿ç¨ï¼åªæåå°è¿ç¨æè½æ¥å°åCtrl-Cè¿ç§æ§å¶é®äº§ççä¿¡å·ãåå°è¿ç¨å¨è¿è¡è¿ç¨ä¸­ç¨æ·éæ¶å¯è½æä¸Ctrl-Cèäº§çä¸ä¸ªä¿¡å·ï¼ä¹å°±æ¯è¯´è¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç æ§è¡å°ä»»ä½å°æ¹é½æå¯è½æ¶å°SIGINTä¿¡å·èç»æ­¢ï¼æä»¥ä¿¡å·ç¸å¯¹äºè¿ç¨çæ§å¶æµç¨æ¥è¯´æ¯å¼æ­¥ï¼Asynchronousï¼çã\n\nè½¯ä¸­æ­ä¿¡å·ï¼signalï¼åç®ç§°ä¸ºä¿¡å·ï¼ç¨æ¥éç¥è¿ç¨åçäºå¼æ­¥äºä»¶ãå¨è½¯ä»¶å±æ¬¡ä¸æ¯å¯¹ä¸­æ­æºå¶çä¸ç§æ¨¡æï¼å¨åçä¸ï¼ä¸ä¸ªè¿ç¨æ¶å°ä¸ä¸ªä¿¡å·ä¸å¤çå¨æ¶å°ä¸ä¸ªä¸­æ­è¯·æ±å¯ä»¥è¯´æ¯ä¸æ ·çãä¿¡å·æ¯è¿ç¨é´éä¿¡æºå¶ä¸­å¯ä¸çå¼æ­¥éä¿¡æºå¶ï¼ä¸ä¸ªè¿ç¨ä¸å¿éè¿ä»»ä½æä½æ¥ç­å¾ä¿¡å·çå°è¾¾ï¼äºå®ä¸ï¼è¿ç¨ä¹ä¸ç¥éä¿¡å·å°åºä»ä¹æ¶åå°è¾¾ãè¿ç¨ä¹é´å¯ä»¥äºç¸éè¿ç³»ç»è°ç¨killåéè½¯ä¸­æ­ä¿¡å·ãåæ ¸ä¹å¯ä»¥å ä¸ºåé¨äºä»¶èç»è¿ç¨åéä¿¡å·ï¼éç¥è¿ç¨åçäºæä¸ªäºä»¶ãä¿¡å·æºå¶é¤äºåºæ¬éç¥åè½å¤ï¼è¿å¯ä»¥ä¼ ééå ä¿¡æ¯ã",normalizedContent:"https://www.timiguo.com/archives/209/\n\nç¨æ·æä¸ctrl-cï¼è¿ä¸ªé®çè¾å¥äº§çä¸ä¸ªç¡¬ä»¶ä¸­æ­ã\n\nå¦æcpuå½åæ­£å¨æ§è¡è¿ä¸ªè¿ç¨çä»£ç ï¼åè¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç æåæ§è¡ï¼cpuä»ç¨æ·æåæ¢å°åæ ¸æå¤çç¡¬ä»¶ä¸­æ­ã\n\nç»ç«¯é©±å¨ç¨åºå°ctrl-cè§£éæä¸ä¸ªsigintä¿¡å·ï¼è®°å¨è¯¥è¿ç¨çpcbä¸­ï¼ä¹å¯ä»¥è¯´åéäºä¸ä¸ªsigintä¿¡å·ç»è¯¥è¿ç¨ï¼ã\n\nå½æä¸ªæ¶å»è¦ä»åæ ¸è¿åå°è¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç ç»§ç»­æ§è¡ä¹åï¼é¦åå¤çpcbä¸­è®°å½çä¿¡å·ï¼åç°æä¸ä¸ªsigintä¿¡å·å¾å¤çï¼èè¿ä¸ªä¿¡å·çé»è®¤å¤çå¨ä½æ¯ç»æ­¢è¿ç¨ï¼æä»¥ç´æ¥ç»æ­¢è¿ç¨èä¸åè¿åå®çç¨æ·ç©ºé´ä»£ç æ§è¡ã\n\næ³¨æï¼ctrl-cäº§ççä¿¡å·åªè½åç»åå°è¿ç¨ãä¸ä¸ªå½ä»¤åé¢å ä¸ª&å¯ä»¥æ¾å°åå°è¿è¡ï¼è¿æ ·shellä¸å¿ç­å¾è¿ç¨ç»æå°±å¯ä»¥æ¥åæ°çå½ä»¤ï¼å¯å¨æ°çè¿ç¨ãshellå¯ä»¥åæ¶è¿è¡ä¸ä¸ªåå°è¿ç¨åä»»æå¤ä¸ªåå°è¿ç¨ï¼åªæåå°è¿ç¨æè½æ¥å°åctrl-cè¿ç§æ§å¶é®äº§ççä¿¡å·ãåå°è¿ç¨å¨è¿è¡è¿ç¨ä¸­ç¨æ·éæ¶å¯è½æä¸ctrl-cèäº§çä¸ä¸ªä¿¡å·ï¼ä¹å°±æ¯è¯´è¯¥è¿ç¨çç¨æ·ç©ºé´ä»£ç æ§è¡å°ä»»ä½å°æ¹é½æå¯è½æ¶å°sigintä¿¡å·èç»æ­¢ï¼æä»¥ä¿¡å·ç¸å¯¹äºè¿ç¨çæ§å¶æµç¨æ¥è¯´æ¯å¼æ­¥ï¼asynchronousï¼çã\n\nè½¯ä¸­æ­ä¿¡å·ï¼signalï¼åç®ç§°ä¸ºä¿¡å·ï¼ç¨æ¥éç¥è¿ç¨åçäºå¼æ­¥äºä»¶ãå¨è½¯ä»¶å±æ¬¡ä¸æ¯å¯¹ä¸­æ­æºå¶çä¸ç§æ¨¡æï¼å¨åçä¸ï¼ä¸ä¸ªè¿ç¨æ¶å°ä¸ä¸ªä¿¡å·ä¸å¤çå¨æ¶å°ä¸ä¸ªä¸­æ­è¯·æ±å¯ä»¥è¯´æ¯ä¸æ ·çãä¿¡å·æ¯è¿ç¨é´éä¿¡æºå¶ä¸­å¯ä¸çå¼æ­¥éä¿¡æºå¶ï¼ä¸ä¸ªè¿ç¨ä¸å¿éè¿ä»»ä½æä½æ¥ç­å¾ä¿¡å·çå°è¾¾ï¼äºå®ä¸ï¼è¿ç¨ä¹ä¸ç¥éä¿¡å·å°åºä»ä¹æ¶åå°è¾¾ãè¿ç¨ä¹é´å¯ä»¥äºç¸éè¿ç³»ç»è°ç¨killåéè½¯ä¸­æ­ä¿¡å·ãåæ ¸ä¹å¯ä»¥å ä¸ºåé¨äºä»¶èç»è¿ç¨åéä¿¡å·ï¼éç¥è¿ç¨åçäºæä¸ªäºä»¶ãä¿¡å·æºå¶é¤äºåºæ¬éç¥åè½å¤ï¼è¿å¯ä»¥ä¼ ééå ä¿¡æ¯ã",charsets:{cjk:!0}},{title:"æç´¢æçä¸ºlogçæ ",frontmatter:{title:"æç´¢æçä¸ºlogçæ ",date:"2023-03-23T16:10:07.000Z",permalink:"/pages/f45a99/"},regularPath:"/06.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/01.%E6%90%9C%E7%B4%A2%E6%95%88%E7%8E%87%E4%B8%BAlog%E7%9A%84%E6%A0%91.html",relativePath:"06.æ°æ®ç»æåç®æ³/01.æç´¢æçä¸ºlogçæ .md",key:"v-8f229662",path:"/pages/f45a99/",headersStr:null,content:" 1. äºåæç´¢æ ï¼BSTï¼ï¼äºåæç´¢æ æ¯ä¸ç§å¸¸ç¨çæ å½¢æ°æ®ç»æï¼å·æè¯å¥½çæç´¢æçãå®çæ¯ä¸ªèç¹é½å·æä¸ä¸ªé®å¼ï¼ä¸èç¹çå·¦å­æ é®å¼å°äºè¯¥èç¹çé®å¼ï¼èç¹çå³å­æ é®å¼å¤§äºè¯¥èç¹çé®å¼ãå¨äºåæç´¢æ ä¸­æ¥æ¾æä¸ªåç´ æ¶ï¼æ¯æ¬¡é½å¯ä»¥æé¤ä¸åçåç´ ï¼å æ­¤æç´¢æçä¸ºå¯¹æ°çº§å«ã\n 2. å¹³è¡¡äºåæç´¢æ ï¼AVLæ ï¼ï¼å¹³è¡¡äºåæç´¢æ ä¹æ¯ä¸ç§äºåæç´¢æ ï¼å®è½å¤èªå¨å¹³è¡¡èç¹çé«åº¦ï¼ä»¥ä¿è¯æ¥è¯¢çæçãAVLæ ä¸­ä»»ä½èç¹çå·¦å³å­æ é«åº¦æå¤ç¸å·®1ï¼å æ­¤å¨AVLæ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¸ºO(log n)ã\n 3. çº¢é»æ ï¼çº¢é»æ ä¹æ¯ä¸ç§èªå¹³è¡¡çäºåæç´¢æ ï¼å·æè¯å¥½çæç´¢æçãçº¢é»æ çæ¯ä¸ªèç¹é½æä¸ä¸ªé¢è²ï¼çº¢è²æé»è²ï¼ï¼å¹¶ä¸æ»¡è¶³ä»¥ä¸å ä¸ªæ¡ä»¶ï¼ï¼1ï¼æ ¹èç¹æ¯é»è²çï¼ï¼2ï¼æ¯ä¸ªå¶å­èç¹é½æ¯é»è²çç©ºèç¹ï¼ï¼3ï¼æ¯ä¸ªçº¢è²èç¹çä¸¤ä¸ªå­èç¹é½æ¯é»è²çï¼ï¼4ï¼ä»ä»»æèç¹å°å¶æ¯ä¸ªå¶å­èç¹çææè·¯å¾é½åå«ç¸åæ°ç®çé»è²èç¹ãå¨çº¢é»æ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¸ºO(log n)ã\n 4. Bæ ï¼Bæ æ¯ä¸ç§å¤è·¯æç´¢æ ï¼æ¯ä¸ªèç¹å¯ä»¥æå¤ä¸ªå­èç¹ãBæ çæ¯ä¸ªèç¹é½åå«å¤ä¸ªå³é®å­ï¼å¹¶ä¸æç§å¤§å°æåºãå¨Bæ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¹ä¸ºO(log n)ãBæ è¢«å¹¿æ³åºç¨äºæä»¶ç³»ç»ãæ°æ®åºç³»ç»ç­é¢åã\n 5. B+æ ï¼B+ æ å¨Bæ çåºç¡ä¸ï¼ä¸ºå¶å­èç¹å¢å äºé¾è¡¨æéï¼æææ°æ®é½å­å¨å¨å¶å­èç¹ãéå¶å­èç¹ä½ä¸ºå¶å­èç¹çç´¢å¼ã",normalizedContent:" 1. äºåæç´¢æ ï¼bstï¼ï¼äºåæç´¢æ æ¯ä¸ç§å¸¸ç¨çæ å½¢æ°æ®ç»æï¼å·æè¯å¥½çæç´¢æçãå®çæ¯ä¸ªèç¹é½å·æä¸ä¸ªé®å¼ï¼ä¸èç¹çå·¦å­æ é®å¼å°äºè¯¥èç¹çé®å¼ï¼èç¹çå³å­æ é®å¼å¤§äºè¯¥èç¹çé®å¼ãå¨äºåæç´¢æ ä¸­æ¥æ¾æä¸ªåç´ æ¶ï¼æ¯æ¬¡é½å¯ä»¥æé¤ä¸åçåç´ ï¼å æ­¤æç´¢æçä¸ºå¯¹æ°çº§å«ã\n 2. å¹³è¡¡äºåæç´¢æ ï¼avlæ ï¼ï¼å¹³è¡¡äºåæç´¢æ ä¹æ¯ä¸ç§äºåæç´¢æ ï¼å®è½å¤èªå¨å¹³è¡¡èç¹çé«åº¦ï¼ä»¥ä¿è¯æ¥è¯¢çæçãavlæ ä¸­ä»»ä½èç¹çå·¦å³å­æ é«åº¦æå¤ç¸å·®1ï¼å æ­¤å¨avlæ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¸ºo(log n)ã\n 3. çº¢é»æ ï¼çº¢é»æ ä¹æ¯ä¸ç§èªå¹³è¡¡çäºåæç´¢æ ï¼å·æè¯å¥½çæç´¢æçãçº¢é»æ çæ¯ä¸ªèç¹é½æä¸ä¸ªé¢è²ï¼çº¢è²æé»è²ï¼ï¼å¹¶ä¸æ»¡è¶³ä»¥ä¸å ä¸ªæ¡ä»¶ï¼ï¼1ï¼æ ¹èç¹æ¯é»è²çï¼ï¼2ï¼æ¯ä¸ªå¶å­èç¹é½æ¯é»è²çç©ºèç¹ï¼ï¼3ï¼æ¯ä¸ªçº¢è²èç¹çä¸¤ä¸ªå­èç¹é½æ¯é»è²çï¼ï¼4ï¼ä»ä»»æèç¹å°å¶æ¯ä¸ªå¶å­èç¹çææè·¯å¾é½åå«ç¸åæ°ç®çé»è²èç¹ãå¨çº¢é»æ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¸ºo(log n)ã\n 4. bæ ï¼bæ æ¯ä¸ç§å¤è·¯æç´¢æ ï¼æ¯ä¸ªèç¹å¯ä»¥æå¤ä¸ªå­èç¹ãbæ çæ¯ä¸ªèç¹é½åå«å¤ä¸ªå³é®å­ï¼å¹¶ä¸æç§å¤§å°æåºãå¨bæ ä¸­æ¥æ¾åç´ çæ¶é´å¤æåº¦ä¹ä¸ºo(log n)ãbæ è¢«å¹¿æ³åºç¨äºæä»¶ç³»ç»ãæ°æ®åºç³»ç»ç­é¢åã\n 5. b+æ ï¼b+ æ å¨bæ çåºç¡ä¸ï¼ä¸ºå¶å­èç¹å¢å äºé¾è¡¨æéï¼æææ°æ®é½å­å¨å¨å¶å­èç¹ãéå¶å­èç¹ä½ä¸ºå¶å­èç¹çç´¢å¼ã",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"äºåæ¥æ¾",frontmatter:{title:"äºåæ¥æ¾",date:"2023-04-20T15:36:10.000Z",permalink:"/pages/37ba80/"},regularPath:"/06.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/02.%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE.html",relativePath:"06.æ°æ®ç»æåç®æ³/02.äºåæ¥æ¾.md",key:"v-8bbcfd3a",path:"/pages/37ba80/",headersStr:null,content:"public int lowerBound(int[] nums, int target) {\n  int left = 0, right = nums.length - 1; // é­åºé´ [left, right]\n  while (left <= right) { // åºé´ä¸ä¸ºç©º\n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid + 1; // [mid + 1, right]\n    else right = mid - 1; // [left, mid -  1];\n  }\n  return left; // è¿åright + 1ä¹è¡\n}\n\npublic int lowerBound2(int[] nums, int target) {\n  int left = 0, right = nums.length; //å·¦é­å³å¼åºé´ [left, right)\n  while (left < right) {\n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid + 1; // [mid + 1, right)\n    else right = mid; // [left, mid)\n  }\n  return left; // è¿å right ä¹è¡\n}\n\npublic int lowerBound3(int[] nums, int target) {\n  int left = -1, right = nums.length; // å¼åºé´ (left, right)\n  while (left + 1 < right) { \n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid; // (mid, right)\n    else right = mid; // (left, mid)\n  }\n  return right;\n}\n\n\nä¸é¢æ¨¡æ¿æ¯æ¾ >= target çç¬¬ä¸ä¸ªæ°ï¼æå·¦è¾¹ï¼\n\næ¾ > target çæ°ï¼ç­ä»·äº >= target + 1ï¼æå³è¾¹ + 1ï¼\n\næ¾ < target çæ°ï¼ç­ä»·äº >= target - 1ï¼æå·¦è¾¹ - 1ï¼\n\næ¾ <= target çæ°ï¼ç­ä»·äº > target - 1 ï¼æå³è¾¹ï¼",normalizedContent:"public int lowerbound(int[] nums, int target) {\n  int left = 0, right = nums.length - 1; // é­åºé´ [left, right]\n  while (left <= right) { // åºé´ä¸ä¸ºç©º\n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid + 1; // [mid + 1, right]\n    else right = mid - 1; // [left, mid -  1];\n  }\n  return left; // è¿åright + 1ä¹è¡\n}\n\npublic int lowerbound2(int[] nums, int target) {\n  int left = 0, right = nums.length; //å·¦é­å³å¼åºé´ [left, right)\n  while (left < right) {\n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid + 1; // [mid + 1, right)\n    else right = mid; // [left, mid)\n  }\n  return left; // è¿å right ä¹è¡\n}\n\npublic int lowerbound3(int[] nums, int target) {\n  int left = -1, right = nums.length; // å¼åºé´ (left, right)\n  while (left + 1 < right) { \n    int mid = left + right >>> 1;\n    if (nums[mid] < target) left = mid; // (mid, right)\n    else right = mid; // (left, mid)\n  }\n  return right;\n}\n\n\nä¸é¢æ¨¡æ¿æ¯æ¾ >= target çç¬¬ä¸ä¸ªæ°ï¼æå·¦è¾¹ï¼\n\næ¾ > target çæ°ï¼ç­ä»·äº >= target + 1ï¼æå³è¾¹ + 1ï¼\n\næ¾ < target çæ°ï¼ç­ä»·äº >= target - 1ï¼æå·¦è¾¹ - 1ï¼\n\næ¾ <= target çæ°ï¼ç­ä»·äº > target - 1 ï¼æå³è¾¹ï¼",charsets:{cjk:!0}},{title:"æä½ç³»ç»",frontmatter:{title:"æä½ç³»ç»",date:"2023-03-30T13:45:12.000Z",permalink:"/pages/os/"},regularPath:"/05.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/01.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html",relativePath:"05.æä½ç³»ç»/01.æä½ç³»ç».md",key:"v-45ced8ca",path:"/pages/os/",headers:[{level:2,title:"å¹¶è¡åå¹¶å",slug:"å¹¶è¡åå¹¶å",normalizedTitle:"å¹¶è¡åå¹¶å",charIndex:2},{level:2,title:"åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡",slug:"åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡",normalizedTitle:"åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡",charIndex:88},{level:2,title:"è¿ç¨åçº¿ç¨",slug:"è¿ç¨åçº¿ç¨",normalizedTitle:"è¿ç¨åçº¿ç¨",charIndex:269},{level:2,title:"æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨",slug:"æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨",normalizedTitle:"æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨",charIndex:1230},{level:2,title:"æºç¨",slug:"æºç¨",normalizedTitle:"æºç¨",charIndex:1437},{level:2,title:"è¿ç¨çç¶æè½¬æ¢",slug:"è¿ç¨çç¶æè½¬æ¢",normalizedTitle:"è¿ç¨çç¶æè½¬æ¢",charIndex:1829},{level:2,title:"è¿ç¨é´çéä¿¡æ¹å¼",slug:"è¿ç¨é´çéä¿¡æ¹å¼",normalizedTitle:"è¿ç¨é´çéä¿¡æ¹å¼",charIndex:1882},{level:2,title:"è¿ç¨è°åº¦ç®æ³",slug:"è¿ç¨è°åº¦ç®æ³",normalizedTitle:"è¿ç¨è°åº¦ç®æ³",charIndex:2726},{level:2,title:"ç¨æ·æååæ ¸æ",slug:"ç¨æ·æååæ ¸æ",normalizedTitle:"ç¨æ·æååæ ¸æ",charIndex:2838},{level:2,title:"ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢ï¼",slug:"ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢",normalizedTitle:"ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢ï¼",charIndex:3062},{level:2,title:"ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢çï¼",slug:"ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢ç",normalizedTitle:"ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢çï¼",charIndex:3160}],headersStr:"å¹¶è¡åå¹¶å åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡ è¿ç¨åçº¿ç¨ æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨ æºç¨ è¿ç¨çç¶æè½¬æ¢ è¿ç¨é´çéä¿¡æ¹å¼ è¿ç¨è°åº¦ç®æ³ ç¨æ·æååæ ¸æ ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢ï¼ ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢çï¼",content:"# å¹¶è¡åå¹¶å\n\nå¹¶è¡æ¯æä¸¤ä¸ªæèå¤ä¸ªäºä»¶å¨åä¸æ¶å»åçï¼èå¹¶åæ¯æä¸¤ä¸ªæå¤ä¸ªäºä»¶å¨åä¸æ¶é´é´éåçï¼\n\nå¹¶è¡æ¯å¨ä¸åå®ä½ä¸çå¤ä¸ªäºä»¶ï¼å¹¶åæ¯å¨åä¸å®ä½ä¸çå¤ä¸ªäºä»¶ï¼\n\n\n# åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡\n\nåæ­¥ï¼å½ä¸ä¸ªåæ­¥è°ç¨ååºåï¼è°ç¨èè¦ä¸ç´ç­å¾è¿åç»æãéç¥åï¼æè½è¿è¡åç»­çæ§è¡ã\n\nå¼æ­¥ï¼å½ä¸ä¸ªå¼æ­¥è¿ç¨è°ç¨ååºåï¼è°ç¨èä¸è½ç«å»å¾å°è¿åç»æãå®éå¤çè¿ä¸ªè°ç¨çé¨ä»¶å¨å®æåï¼éè¿ç¶æãéç¥ååè°æ¥éç¥è°ç¨èã\n\né»å¡ï¼æ¯æè°ç¨ç»æè¿ååï¼å½åçº¿ç¨ä¼è¢«æèµ·ï¼å³é»å¡ã\n\néé»å¡ï¼æ¯æå³ä½¿è°ç¨ç»ææ²¡è¿åï¼ä¹ä¸ä¼é»å¡å½åçº¿ç¨ã\n\n\n# è¿ç¨åçº¿ç¨\n\nè¿ç¨åçº¿ç¨æ¯æä½ç³»ç»ä¸­çä¸¤ä¸ªåºæ¬æ¦å¿µï¼å®ä»¬é½æ¯ç¨åºè¿è¡çåºæ¬åä½ã\n\nè¿ç¨æ¯ææ­£å¨è¿è¡çä¸ä¸ªç¨åºå®ä¾ãæ¯ä¸ªè¿ç¨é½æèªå·±çå°åç©ºé´ãæ°æ®æ ãæä»¶å¥æãç³»ç»èµæºç­ï¼å¯ä»¥ç¬ç«å°è¿è¡ãåæ­¢åè°åº¦ãæä½ç³»ç»ä¸ºæ¯ä¸ªè¿ç¨åéå¯ä¸çè¿ç¨æ è¯ç¬¦PIDï¼ç¨äºæ è¯åç®¡çè¿ç¨ãæ¯ä¸ªè¿ç¨å¯ä»¥åå«ä¸ä¸ªæå¤ä¸ªçº¿ç¨ã\n\nçº¿ç¨æ¯è¿ç¨çä¸ä¸ªæ§è¡ååãä¸ä¸ªè¿ç¨å¯ä»¥åå«å¤ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼åæ¬æå¼çæä»¶ãä¿¡å·å¤çç¨åºãç¨æ·IDåç»IDç­ãçº¿ç¨ä¸è¿ç¨ä¸åï¼çº¿ç¨æ²¡æç¬ç«çå°åç©ºé´ï¼ä¸ä¸ªè¿ç¨ä¸­çææçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å æ­¤çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å å®¹æåé«æã\n\nä¸è¿ç¨ç¸æ¯ï¼çº¿ç¨çä¼ç¹æ¯æ´å è½»éçº§åé«æï¼çº¿ç¨ä¹é´çåæ¢å¼éæ´å°ï¼å¯ä»¥æ´å¥½å°å©ç¨å¤æ ¸CPUï¼åæ¶çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å å®¹æåé«æãå æ­¤ï¼å¨å®éåºç¨ä¸­ï¼çº¿ç¨è¢«å¹¿æ³ä½¿ç¨ï¼ä¾å¦å¨Webæå¡å¨ãæ°æ®åºæå¡å¨åæä½ç³»ç»ç­ä¸­ãä½æ¯ï¼çº¿ç¨ä¹é´çå±äº«èµæºä¹ä¼å¸¦æ¥ä¸äºå®å¨æ§åç¨³å®æ§æ¹é¢çé®é¢ï¼å æ­¤å¨ä½¿ç¨æ¶éè¦å°å¿å¤çã\n\næ»ç»æ¥è¯´ï¼è¿ç¨æ¯ææ­£å¨è¿è¡çä¸ä¸ªç¨åºå®ä¾ï¼æ¥æç¬ç«çå°åç©ºé´åç³»ç»èµæºï¼èçº¿ç¨æ¯è¿ç¨çä¸ä¸ªæ§è¡ååï¼å¤ä¸ªçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å¯ä»¥æ´å é«æå°æ§è¡ä»»å¡ã\n\nåºå«ï¼\n\n 1. èµæºå ç¨ï¼ä¸ä¸ªè¿ç¨æ¥æç¬ç«çå°åç©ºé´åç³»ç»èµæºï¼åæ¬åå­ãæä»¶å¥æãè®¾å¤åä¿¡å·å¤çç­ï¼èçº¿ç¨æ¯è¿ç¨ä¸­çä¸æ¡æ§è¡è·¯å¾ï¼å®ä¸åä¸è¿ç¨åçå¶ä»çº¿ç¨å±äº«ç¸åçèµæºã\n 2. è°åº¦ååæ¢ï¼çº¿ç¨çåæ¢æ¯è¿ç¨çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼ä¸ä¸æåæ¢çå¼éæ¯è¿ç¨å°ã\n 3. éä¿¡ååæ­¥ï¼ç±äºçº¿ç¨å±äº«ç¸åçèµæºï¼çº¿ç¨ä¹é´éä¿¡ååæ­¥æ´å å®¹æåé«æãèè¿ç¨ä¹é´éä¿¡ååæ­¥éè¦ä½¿ç¨è¿ç¨é´éä¿¡(IPC)æºå¶ï¼å¦ç®¡éãä¿¡å·ãæ¶æ¯éåãå±äº«åå­ç­ï¼å®ä»¬æ¯çº¿ç¨é´éä¿¡çå¼éæ´å¤§ã\n 4. ç¨³å®æ§åå®å¨æ§ï¼ç±äºçº¿ç¨å±äº«ç¸åçèµæºï¼ä¸ä¸ªçº¿ç¨çéè¯¯å¯è½ä¼å¯¼è´æ´ä¸ªè¿ç¨å´©æºï¼èä¸ä¸ªè¿ç¨çå´©æºåªä¼å½±ååä¸è¿ç¨åçå¶ä»çº¿ç¨ãå æ­¤ï¼è¿ç¨æ¯çº¿ç¨æ´å ç¨³å®åå®å¨ã\n 5. å¹¶åæ§åå¤æ ¸å©ç¨ï¼ç±äºçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å¤ä¸ªçº¿ç¨å¯ä»¥å¹¶åå°æ§è¡åä¸è¿ç¨çä¸åä»»å¡ï¼ä»èæé«CPUçå©ç¨çãèè¿ç¨ä¹é´çå¹¶åéè¦å¨å¤ä¸ªCPUä¸è¿è¡ï¼å æ­¤è¿ç¨å¨å©ç¨å¤æ ¸CPUæ¶æ´å ææã\n\n\n# æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨\n\nè¿ç¨å¯ä»¥ä½¿å¤ä¸ªç¨åºå¹¶åæ§è¡ï¼ä»¥æé«èµæºçå©ç¨çåç³»ç»çååéï¼ä½æ¯å¶å¸¦æ¥äºä¸äºç¼ºç¹ï¼\n\n 1. è¿ç¨å¨åä¸æ¶é´åªè½å¹²ä¸ä»¶äºæï¼\n 2. è¿ç¨å¨æ§è¡çè¿ç¨ä¸­å¦æé»å¡ï¼æ´ä¸ªè¿ç¨å°±ä¼è¢«æèµ·ï¼å³ä½¿è¿ç¨ä¸­æäºå·¥ä½ä¸ä¾èµä¸ç­å¾çèµæºï¼ä»ç¶ä¸ä¼æ§è¡ã\n\nåºäºä»¥ä¸çç¼ºç¹ï¼æä½ç³»ç»å¼å¥äºæ¯è¿ç¨ç²åº¦æ´å°ççº¿ç¨ï¼ä½ä¸ºå¹¶åæ§è¡çåºæ¬åä½ï¼ä»èåå°ç¨åºå¨å¹¶åæ§è¡æ¶æä»åºçæ¶é´åç©ºé´å¼éï¼æé«å¹¶åæ§è½ã\n\n\n# æºç¨\n\næºç¨ï¼Coroutineï¼æ¯ä¸ç§è½»éçº§ççº¿ç¨ï¼ä¹ç§°ä¸ºåç¨ãå®ä¸ä¼ ç»çæä½ç³»ç»çº¿ç¨ï¼Threadï¼ä¸åï¼æä½ç³»ç»çº¿ç¨ç±æä½ç³»ç»è°åº¦åç®¡çï¼èæºç¨åç±ç¨åºæ¬èº«æ§å¶ã\n\næºç¨çç¹ç¹æ¯è½»éçº§ãé«æãç®åãæäºä½¿ç¨ãæºç¨å¯ä»¥å¨ä¸ä¸ªçº¿ç¨ä¸­æ§è¡å¤ä¸ªä»»å¡ï¼éè¿å¨ä»»å¡ä¹é´åæ¢æ¥å®ç°å¹¶ååå¼æ­¥æä½ãä¸ä¼ ç»çå¤çº¿ç¨ç¼ç¨æ¨¡åç¸æ¯ï¼æºç¨çä¼ç¹æ¯æ´å é«æãæ´å çµæ´»ãæ´å å®¹æç®¡çåè°åº¦ï¼å¹¶ä¸å¯ä»¥é¿åç±äºçº¿ç¨åæ¢èå¸¦æ¥çå¼éåç«äºæ¡ä»¶é®é¢ã\n\næºç¨å¨ç¼åå¼æ­¥ä»£ç ãç½ç»ç¼ç¨ãåè®®è§£æãç¬è«ç­é¢åä¸­å¹¿æ³åºç¨ãå¨Pythonä¸­ï¼æºç¨éè¿åç¨åºï¼Coroutine Libraryï¼æ¥å®ç°ï¼å¶ä¸­æèåçæ¯asyncioåºãå¨å¶ä»ç¼ç¨è¯­è¨ä¸­ï¼ä¾å¦GoãC++ãLuaç­ï¼ä¹é½æ¯ææºç¨çå®ç°ã\n\næ»ä¹ï¼æºç¨æ¯ä¸ç§è½»éçº§ççº¿ç¨ï¼å·æé«æãçµæ´»ãç®åç­ç¹ç¹ï¼å¯ä»¥ç¨äºå¼æ­¥ç¼ç¨ãç½ç»ç¼ç¨ãåè®®è§£æãç¬è«ç­é¢åã\n\n\n# è¿ç¨çç¶æè½¬æ¢\n\nå°±ç»ªæãè¿è¡æãé»å¡æ\n\nå°±ç»ª<--\x3eè¿è¡\n\nè¿è¡--\x3eé»å¡\n\né»å¡--\x3eå°±ç»ª\n\n\n# è¿ç¨é´çéä¿¡æ¹å¼\n\nè¿ç¨é´éä¿¡ï¼IPCï¼InterProcess Communicationï¼æ¯æå¨ä¸åè¿ç¨ä¹é´ä¼ æ­æäº¤æ¢ä¿¡æ¯ãIPC çæ¹å¼éå¸¸æç®¡éï¼åæ¬æ åç®¡éåå½åç®¡éï¼ãæ¶æ¯éåãä¿¡å·éãå±äº«å­å¨ãSocketãStreams ç­ãå¶ä¸­ Socket å Streams æ¯æä¸åä¸»æºä¸çä¸¤ä¸ªè¿ç¨ IPCã\n\nç®¡é\n\n 1. å®æ¯ååå·¥çï¼å·æåºå®çè¯»ç«¯ååç«¯ï¼\n 2. å®åªè½ç¨äºç¶å­è¿ç¨æèåå¼è¿ç¨ä¹é´çè¿ç¨çéä¿¡ï¼\n 3. å®å¯ä»¥çææ¯ä¸ç§ç¹æ®çæä»¶ï¼å¯¹äºå®çè¯»åä¹å¯ä»¥ä½¿ç¨æ®éç readãwrite ç­å½æ°ãä½æ¯å®ä¸æ¯æ®éçæä»¶ï¼å¹¶ä¸å±äºå¶ä»ä»»ä½æä»¶ç³»ç»ï¼å¹¶ä¸åªå­å¨äºåå­ä¸­ã\n\nå½åç®¡é\n\n 1. FIFO å¯ä»¥å¨æ å³çè¿ç¨ä¹é´äº¤æ¢æ°æ®ï¼ä¸æ åç®¡éä¸åï¼\n 2. FIFO æè·¯å¾åä¸ä¹ç¸å³èï¼å®ä»¥ä¸ç§ç¹æ®è®¾å¤æä»¶å½¢å¼å­å¨äºæä»¶ç³»ç»ä¸­ã\n\næ¶æ¯éå\n\n 1. æ¶æ¯éåï¼æ¯æ¶æ¯çé¾æ¥è¡¨ï¼å­æ¾å¨åæ ¸ä¸­ãä¸ä¸ªæ¶æ¯éåç±ä¸ä¸ªæ è¯ç¬¦ ID æ¥æ è¯ï¼\n 2. æ¶æ¯éåæ¯é¢åè®°å½çï¼å¶ä¸­çæ¶æ¯å·æç¹å®çæ ¼å¼ä»¥åç¹å®çä¼åçº§ï¼\n 3. æ¶æ¯éåç¬ç«äºåéä¸æ¥æ¶è¿ç¨ãè¿ç¨ç»æ­¢æ¶ï¼æ¶æ¯éååå¶åå®¹å¹¶ä¸ä¼è¢«å é¤ï¼\n 4. æ¶æ¯éåå¯ä»¥å®ç°æ¶æ¯çéæºæ¥è¯¢ï¼æ¶æ¯ä¸ä¸å®è¦ä»¥åè¿ååºçæ¬¡åºè¯»åï¼ä¹å¯ä»¥ææ¶æ¯çç±»åè¯»åã\n\nä¿¡å·é\n\n 1. ä¿¡å·éï¼semaphoreï¼æ¯ä¸ä¸ªè®¡æ°å¨ãç¨äºå®ç°è¿ç¨é´çäºæ¥ä¸åæ­¥ï¼èä¸æ¯ç¨äºå­å¨è¿ç¨é´éä¿¡æ°æ®ï¼\n 2. ä¿¡å·éç¨äºè¿ç¨é´åæ­¥ï¼è¥è¦å¨è¿ç¨é´ä¼ éæ°æ®éè¦ç»åå±äº«åå­ï¼\n 3. ä¿¡å·éåºäºæä½ç³»ç»ç PV æä½ï¼ç¨åºå¯¹ä¿¡å·éçæä½é½æ¯åå­æä½ï¼\n 4. æ¯æ¬¡å¯¹ä¿¡å·éç PV æä½ä¸ä»éäºå¯¹ä¿¡å·éå¼å  1 æå 1ï¼èä¸å¯ä»¥å åä»»ææ­£æ´æ°ï¼\n 5. æ¯æä¿¡å·éç»ã\n\nå±äº«åå­\n\n 1. å±äº«åå­ï¼Shared Memoryï¼ï¼æä¸¤ä¸ªæå¤ä¸ªè¿ç¨å±äº«ä¸ä¸ªç»å®çå­å¨åºï¼\n 2. å±äº«åå­æ¯æå¿«çä¸ç§ IPCï¼å ä¸ºè¿ç¨æ¯ç´æ¥å¯¹åå­è¿è¡å­åã\n\n\n# è¿ç¨è°åº¦ç®æ³\n\nè°åº¦ç®æ³æ¯æï¼æ ¹æ®ç³»ç»çèµæºåéç­ç¥æè§å®çèµæºåéç®æ³ã\n\nå¸¸ç¨çè°åº¦ç®æ³æï¼åæ¥åæå¡è°åº¦ç®æ³ãæ¶é´çè½®è½¬è°åº¦æ³ãç­ä½ä¸ä¼åè°åº¦ç®æ³ãæç­å©ä½æ¶é´ä¼åãé«ååºæ¯ä¼åè°åº¦ç®æ³ãä¼åçº§è°åº¦ç®æ³ç­ç­ã\n\n\n# ç¨æ·æååæ ¸æ\n\nç¨æ·æååæ ¸ææ¯æä½ç³»ç»çä¸¤ç§è¿è¡ç¶æã\n\n * åæ ¸æï¼å¤äºåæ ¸æç CPU å¯ä»¥è®¿é®ä»»æçæ°æ®ï¼åæ¬å¤å´è®¾å¤ï¼æ¯å¦ç½å¡ãç¡¬çç­ï¼å¤äºåæ ¸æç CPU å¯ä»¥ä»ä¸ä¸ªç¨åºåæ¢å°å¦å¤ä¸ä¸ªç¨åºï¼å¹¶ä¸å ç¨ CPU ä¸ä¼åçæ¢å æåµï¼ä¸è¬å¤äºç¹æçº§ 0 çç¶ææä»¬ç§°ä¹ä¸ºåæ ¸æã\n * ç¨æ·æï¼å¤äºç¨æ·æç CPU åªè½åéçè®¿é®åå­ï¼å¹¶ä¸ä¸åè®¸è®¿é®å¤å´è®¾å¤ï¼ç¨æ·æä¸ç CPU ä¸åè®¸ç¬å ï¼ä¹å°±æ¯è¯´ CPU è½å¤è¢«å¶ä»ç¨åºè·åã\n\n\n# ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢ï¼\n\nè¿ä¸ªä¸»è¦æ¯å¯¹è®¿é®è½åçéå¶ï¼è®¡ç®æºä¸­æä¸äºæ¯è¾å±é©çæä½ï¼æ¯å¦è®¾ç½®æ¶éãåå­æ¸çï¼è¿äºé½éè¦å¨åæ ¸æä¸å®æï¼å¦æéæè¿è¡è¿äºæä½ï¼é£ä½ çç³»ç»å¾å´©æºå¤å°æ¬¡ã\n\n\n# ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢çï¼\n\nææçç¨æ·è¿ç¨é½æ¯è¿è¡å¨ç¨æ·æçï¼ä½ç¨æ·ç¨åºçè®¿é®è½åæéï¼ä¸äºæ¯è¾éè¦çæ¯å¦ä»ç¡¬çè¯»åæ°æ®ï¼ä»é®çè·åæ°æ®çæä½åæ¯åæ ¸ææè½åçäºæï¼èè¿äºæ°æ®å´åå¯¹ç¨æ·ç¨åºæ¥è¯´éå¸¸éè¦ãæä»¥å°±æ¶åå°ä¸¤ç§æ¨¡å¼ä¸çè½¬æ¢ï¼å³ç¨æ·æ -> åæ ¸æ -> ç¨æ·æï¼èå¯ä¸è½å¤åè¿äºæä½çåªæç³»ç»è°ç¨ï¼èè½å¤æ§è¡ç³»ç»è°ç¨çå°±åªææä½ç³»ç»ã\n\n\n\n * é¦åç¨æ·ç¨åºä¼è°ç¨ glibc åºï¼glibc æ¯ä¸ä¸ªæ ååºï¼åæ¶ä¹æ¯ä¸å¥æ ¸å¿åºï¼åºä¸­å®ä¹äºå¾å¤å³é® APIã\n * glibc åºç¥ééå¯¹ä¸åä½ç³»ç»æè°ç¨ç³»ç»è°ç¨çæ­£ç¡®æ¹æ³ï¼å®ä¼æ ¹æ®ä½ç³»ç»æåºç¨ç¨åºçäºè¿å¶æ¥å£è®¾ç½®ç¨æ·è¿ç¨ä¼ éçåæ°ï¼æ¥åå¤ç³»ç»è°ç¨ã\n * ç¶åï¼glibc åºè°ç¨è½¯ä»¶ä¸­æ­æä»¤(SWI) ï¼è¿ä¸ªæä»¤éè¿æ´æ° CPSR å¯å­å¨å°æ¨¡å¼æ¹ä¸ºè¶çº§ç¨æ·æ¨¡å¼ï¼ç¶åè·³è½¬å°å°å 0x08 å¤ã\n * å°ç®åä¸ºæ­¢ï¼æ´ä¸ªè¿ç¨ä»å¤äºç¨æ·æä¸ï¼å¨æ§è¡ SWI æä»¤åï¼åè®¸è¿ç¨æ§è¡åæ ¸ä»£ç ï¼MMU ç°å¨åè®¸åæ ¸èæåå­è®¿é®\n * ä»å°å 0x08 å¼å§ï¼è¿ç¨æ§è¡å è½½å¹¶è·³è½¬å°ä¸­æ­å¤çç¨åºï¼è¿ä¸ªç¨åºå°±æ¯ ARM ä¸­ç vector_swi()ã\n * å¨ vector_swi() å¤ï¼ä» SWI æä»¤ä¸­æåç³»ç»è°ç¨å· SCNOï¼ç¶åä½¿ç¨ SCNO ä½ä¸ºç³»ç»è°ç¨è¡¨ sys_call_table çç´¢å¼ï¼è°è½¬å°ç³»ç»è°ç¨å½æ°ã\n * æ§è¡ç³»ç»è°ç¨å®æåï¼å°è¿åç¨æ·æ¨¡å¼å¯å­å¨ï¼ç¶ååä»¥ç¨æ·æ¨¡å¼æ§è¡ã",normalizedContent:"# å¹¶è¡åå¹¶å\n\nå¹¶è¡æ¯æä¸¤ä¸ªæèå¤ä¸ªäºä»¶å¨åä¸æ¶å»åçï¼èå¹¶åæ¯æä¸¤ä¸ªæå¤ä¸ªäºä»¶å¨åä¸æ¶é´é´éåçï¼\n\nå¹¶è¡æ¯å¨ä¸åå®ä½ä¸çå¤ä¸ªäºä»¶ï¼å¹¶åæ¯å¨åä¸å®ä½ä¸çå¤ä¸ªäºä»¶ï¼\n\n\n# åæ­¥ãå¼æ­¥ãé»å¡ãéé»å¡\n\nåæ­¥ï¼å½ä¸ä¸ªåæ­¥è°ç¨ååºåï¼è°ç¨èè¦ä¸ç´ç­å¾è¿åç»æãéç¥åï¼æè½è¿è¡åç»­çæ§è¡ã\n\nå¼æ­¥ï¼å½ä¸ä¸ªå¼æ­¥è¿ç¨è°ç¨ååºåï¼è°ç¨èä¸è½ç«å»å¾å°è¿åç»æãå®éå¤çè¿ä¸ªè°ç¨çé¨ä»¶å¨å®æåï¼éè¿ç¶æãéç¥ååè°æ¥éç¥è°ç¨èã\n\né»å¡ï¼æ¯æè°ç¨ç»æè¿ååï¼å½åçº¿ç¨ä¼è¢«æèµ·ï¼å³é»å¡ã\n\néé»å¡ï¼æ¯æå³ä½¿è°ç¨ç»ææ²¡è¿åï¼ä¹ä¸ä¼é»å¡å½åçº¿ç¨ã\n\n\n# è¿ç¨åçº¿ç¨\n\nè¿ç¨åçº¿ç¨æ¯æä½ç³»ç»ä¸­çä¸¤ä¸ªåºæ¬æ¦å¿µï¼å®ä»¬é½æ¯ç¨åºè¿è¡çåºæ¬åä½ã\n\nè¿ç¨æ¯ææ­£å¨è¿è¡çä¸ä¸ªç¨åºå®ä¾ãæ¯ä¸ªè¿ç¨é½æèªå·±çå°åç©ºé´ãæ°æ®æ ãæä»¶å¥æãç³»ç»èµæºç­ï¼å¯ä»¥ç¬ç«å°è¿è¡ãåæ­¢åè°åº¦ãæä½ç³»ç»ä¸ºæ¯ä¸ªè¿ç¨åéå¯ä¸çè¿ç¨æ è¯ç¬¦pidï¼ç¨äºæ è¯åç®¡çè¿ç¨ãæ¯ä¸ªè¿ç¨å¯ä»¥åå«ä¸ä¸ªæå¤ä¸ªçº¿ç¨ã\n\nçº¿ç¨æ¯è¿ç¨çä¸ä¸ªæ§è¡ååãä¸ä¸ªè¿ç¨å¯ä»¥åå«å¤ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼åæ¬æå¼çæä»¶ãä¿¡å·å¤çç¨åºãç¨æ·idåç»idç­ãçº¿ç¨ä¸è¿ç¨ä¸åï¼çº¿ç¨æ²¡æç¬ç«çå°åç©ºé´ï¼ä¸ä¸ªè¿ç¨ä¸­çææçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å æ­¤çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å å®¹æåé«æã\n\nä¸è¿ç¨ç¸æ¯ï¼çº¿ç¨çä¼ç¹æ¯æ´å è½»éçº§åé«æï¼çº¿ç¨ä¹é´çåæ¢å¼éæ´å°ï¼å¯ä»¥æ´å¥½å°å©ç¨å¤æ ¸cpuï¼åæ¶çº¿ç¨ä¹é´çéä¿¡ååæ­¥æ´å å®¹æåé«æãå æ­¤ï¼å¨å®éåºç¨ä¸­ï¼çº¿ç¨è¢«å¹¿æ³ä½¿ç¨ï¼ä¾å¦å¨webæå¡å¨ãæ°æ®åºæå¡å¨åæä½ç³»ç»ç­ä¸­ãä½æ¯ï¼çº¿ç¨ä¹é´çå±äº«èµæºä¹ä¼å¸¦æ¥ä¸äºå®å¨æ§åç¨³å®æ§æ¹é¢çé®é¢ï¼å æ­¤å¨ä½¿ç¨æ¶éè¦å°å¿å¤çã\n\næ»ç»æ¥è¯´ï¼è¿ç¨æ¯ææ­£å¨è¿è¡çä¸ä¸ªç¨åºå®ä¾ï¼æ¥æç¬ç«çå°åç©ºé´åç³»ç»èµæºï¼èçº¿ç¨æ¯è¿ç¨çä¸ä¸ªæ§è¡ååï¼å¤ä¸ªçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å¯ä»¥æ´å é«æå°æ§è¡ä»»å¡ã\n\nåºå«ï¼\n\n 1. èµæºå ç¨ï¼ä¸ä¸ªè¿ç¨æ¥æç¬ç«çå°åç©ºé´åç³»ç»èµæºï¼åæ¬åå­ãæä»¶å¥æãè®¾å¤åä¿¡å·å¤çç­ï¼èçº¿ç¨æ¯è¿ç¨ä¸­çä¸æ¡æ§è¡è·¯å¾ï¼å®ä¸åä¸è¿ç¨åçå¶ä»çº¿ç¨å±äº«ç¸åçèµæºã\n 2. è°åº¦ååæ¢ï¼çº¿ç¨çåæ¢æ¯è¿ç¨çåæ¢æ´å¿«ï¼å ä¸ºçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼ä¸ä¸æåæ¢çå¼éæ¯è¿ç¨å°ã\n 3. éä¿¡ååæ­¥ï¼ç±äºçº¿ç¨å±äº«ç¸åçèµæºï¼çº¿ç¨ä¹é´éä¿¡ååæ­¥æ´å å®¹æåé«æãèè¿ç¨ä¹é´éä¿¡ååæ­¥éè¦ä½¿ç¨è¿ç¨é´éä¿¡(ipc)æºå¶ï¼å¦ç®¡éãä¿¡å·ãæ¶æ¯éåãå±äº«åå­ç­ï¼å®ä»¬æ¯çº¿ç¨é´éä¿¡çå¼éæ´å¤§ã\n 4. ç¨³å®æ§åå®å¨æ§ï¼ç±äºçº¿ç¨å±äº«ç¸åçèµæºï¼ä¸ä¸ªçº¿ç¨çéè¯¯å¯è½ä¼å¯¼è´æ´ä¸ªè¿ç¨å´©æºï¼èä¸ä¸ªè¿ç¨çå´©æºåªä¼å½±ååä¸è¿ç¨åçå¶ä»çº¿ç¨ãå æ­¤ï¼è¿ç¨æ¯çº¿ç¨æ´å ç¨³å®åå®å¨ã\n 5. å¹¶åæ§åå¤æ ¸å©ç¨ï¼ç±äºçº¿ç¨å±äº«ç¸åçå°åç©ºé´åç³»ç»èµæºï¼å¤ä¸ªçº¿ç¨å¯ä»¥å¹¶åå°æ§è¡åä¸è¿ç¨çä¸åä»»å¡ï¼ä»èæé«cpuçå©ç¨çãèè¿ç¨ä¹é´çå¹¶åéè¦å¨å¤ä¸ªcpuä¸è¿è¡ï¼å æ­¤è¿ç¨å¨å©ç¨å¤æ ¸cpuæ¶æ´å ææã\n\n\n# æè¿ç¨ä¸ºä»ä¹è¿è¦æçº¿ç¨\n\nè¿ç¨å¯ä»¥ä½¿å¤ä¸ªç¨åºå¹¶åæ§è¡ï¼ä»¥æé«èµæºçå©ç¨çåç³»ç»çååéï¼ä½æ¯å¶å¸¦æ¥äºä¸äºç¼ºç¹ï¼\n\n 1. è¿ç¨å¨åä¸æ¶é´åªè½å¹²ä¸ä»¶äºæï¼\n 2. è¿ç¨å¨æ§è¡çè¿ç¨ä¸­å¦æé»å¡ï¼æ´ä¸ªè¿ç¨å°±ä¼è¢«æèµ·ï¼å³ä½¿è¿ç¨ä¸­æäºå·¥ä½ä¸ä¾èµä¸ç­å¾çèµæºï¼ä»ç¶ä¸ä¼æ§è¡ã\n\nåºäºä»¥ä¸çç¼ºç¹ï¼æä½ç³»ç»å¼å¥äºæ¯è¿ç¨ç²åº¦æ´å°ççº¿ç¨ï¼ä½ä¸ºå¹¶åæ§è¡çåºæ¬åä½ï¼ä»èåå°ç¨åºå¨å¹¶åæ§è¡æ¶æä»åºçæ¶é´åç©ºé´å¼éï¼æé«å¹¶åæ§è½ã\n\n\n# æºç¨\n\næºç¨ï¼coroutineï¼æ¯ä¸ç§è½»éçº§ççº¿ç¨ï¼ä¹ç§°ä¸ºåç¨ãå®ä¸ä¼ ç»çæä½ç³»ç»çº¿ç¨ï¼threadï¼ä¸åï¼æä½ç³»ç»çº¿ç¨ç±æä½ç³»ç»è°åº¦åç®¡çï¼èæºç¨åç±ç¨åºæ¬èº«æ§å¶ã\n\næºç¨çç¹ç¹æ¯è½»éçº§ãé«æãç®åãæäºä½¿ç¨ãæºç¨å¯ä»¥å¨ä¸ä¸ªçº¿ç¨ä¸­æ§è¡å¤ä¸ªä»»å¡ï¼éè¿å¨ä»»å¡ä¹é´åæ¢æ¥å®ç°å¹¶ååå¼æ­¥æä½ãä¸ä¼ ç»çå¤çº¿ç¨ç¼ç¨æ¨¡åç¸æ¯ï¼æºç¨çä¼ç¹æ¯æ´å é«æãæ´å çµæ´»ãæ´å å®¹æç®¡çåè°åº¦ï¼å¹¶ä¸å¯ä»¥é¿åç±äºçº¿ç¨åæ¢èå¸¦æ¥çå¼éåç«äºæ¡ä»¶é®é¢ã\n\næºç¨å¨ç¼åå¼æ­¥ä»£ç ãç½ç»ç¼ç¨ãåè®®è§£æãç¬è«ç­é¢åä¸­å¹¿æ³åºç¨ãå¨pythonä¸­ï¼æºç¨éè¿åç¨åºï¼coroutine libraryï¼æ¥å®ç°ï¼å¶ä¸­æèåçæ¯asyncioåºãå¨å¶ä»ç¼ç¨è¯­è¨ä¸­ï¼ä¾å¦goãc++ãluaç­ï¼ä¹é½æ¯ææºç¨çå®ç°ã\n\næ»ä¹ï¼æºç¨æ¯ä¸ç§è½»éçº§ççº¿ç¨ï¼å·æé«æãçµæ´»ãç®åç­ç¹ç¹ï¼å¯ä»¥ç¨äºå¼æ­¥ç¼ç¨ãç½ç»ç¼ç¨ãåè®®è§£æãç¬è«ç­é¢åã\n\n\n# è¿ç¨çç¶æè½¬æ¢\n\nå°±ç»ªæãè¿è¡æãé»å¡æ\n\nå°±ç»ª<--\x3eè¿è¡\n\nè¿è¡--\x3eé»å¡\n\né»å¡--\x3eå°±ç»ª\n\n\n# è¿ç¨é´çéä¿¡æ¹å¼\n\nè¿ç¨é´éä¿¡ï¼ipcï¼interprocess communicationï¼æ¯æå¨ä¸åè¿ç¨ä¹é´ä¼ æ­æäº¤æ¢ä¿¡æ¯ãipc çæ¹å¼éå¸¸æç®¡éï¼åæ¬æ åç®¡éåå½åç®¡éï¼ãæ¶æ¯éåãä¿¡å·éãå±äº«å­å¨ãsocketãstreams ç­ãå¶ä¸­ socket å streams æ¯æä¸åä¸»æºä¸çä¸¤ä¸ªè¿ç¨ ipcã\n\nç®¡é\n\n 1. å®æ¯ååå·¥çï¼å·æåºå®çè¯»ç«¯ååç«¯ï¼\n 2. å®åªè½ç¨äºç¶å­è¿ç¨æèåå¼è¿ç¨ä¹é´çè¿ç¨çéä¿¡ï¼\n 3. å®å¯ä»¥çææ¯ä¸ç§ç¹æ®çæä»¶ï¼å¯¹äºå®çè¯»åä¹å¯ä»¥ä½¿ç¨æ®éç readãwrite ç­å½æ°ãä½æ¯å®ä¸æ¯æ®éçæä»¶ï¼å¹¶ä¸å±äºå¶ä»ä»»ä½æä»¶ç³»ç»ï¼å¹¶ä¸åªå­å¨äºåå­ä¸­ã\n\nå½åç®¡é\n\n 1. fifo å¯ä»¥å¨æ å³çè¿ç¨ä¹é´äº¤æ¢æ°æ®ï¼ä¸æ åç®¡éä¸åï¼\n 2. fifo æè·¯å¾åä¸ä¹ç¸å³èï¼å®ä»¥ä¸ç§ç¹æ®è®¾å¤æä»¶å½¢å¼å­å¨äºæä»¶ç³»ç»ä¸­ã\n\næ¶æ¯éå\n\n 1. æ¶æ¯éåï¼æ¯æ¶æ¯çé¾æ¥è¡¨ï¼å­æ¾å¨åæ ¸ä¸­ãä¸ä¸ªæ¶æ¯éåç±ä¸ä¸ªæ è¯ç¬¦ id æ¥æ è¯ï¼\n 2. æ¶æ¯éåæ¯é¢åè®°å½çï¼å¶ä¸­çæ¶æ¯å·æç¹å®çæ ¼å¼ä»¥åç¹å®çä¼åçº§ï¼\n 3. æ¶æ¯éåç¬ç«äºåéä¸æ¥æ¶è¿ç¨ãè¿ç¨ç»æ­¢æ¶ï¼æ¶æ¯éååå¶åå®¹å¹¶ä¸ä¼è¢«å é¤ï¼\n 4. æ¶æ¯éåå¯ä»¥å®ç°æ¶æ¯çéæºæ¥è¯¢ï¼æ¶æ¯ä¸ä¸å®è¦ä»¥åè¿ååºçæ¬¡åºè¯»åï¼ä¹å¯ä»¥ææ¶æ¯çç±»åè¯»åã\n\nä¿¡å·é\n\n 1. ä¿¡å·éï¼semaphoreï¼æ¯ä¸ä¸ªè®¡æ°å¨ãç¨äºå®ç°è¿ç¨é´çäºæ¥ä¸åæ­¥ï¼èä¸æ¯ç¨äºå­å¨è¿ç¨é´éä¿¡æ°æ®ï¼\n 2. ä¿¡å·éç¨äºè¿ç¨é´åæ­¥ï¼è¥è¦å¨è¿ç¨é´ä¼ éæ°æ®éè¦ç»åå±äº«åå­ï¼\n 3. ä¿¡å·éåºäºæä½ç³»ç»ç pv æä½ï¼ç¨åºå¯¹ä¿¡å·éçæä½é½æ¯åå­æä½ï¼\n 4. æ¯æ¬¡å¯¹ä¿¡å·éç pv æä½ä¸ä»éäºå¯¹ä¿¡å·éå¼å  1 æå 1ï¼èä¸å¯ä»¥å åä»»ææ­£æ´æ°ï¼\n 5. æ¯æä¿¡å·éç»ã\n\nå±äº«åå­\n\n 1. å±äº«åå­ï¼shared memoryï¼ï¼æä¸¤ä¸ªæå¤ä¸ªè¿ç¨å±äº«ä¸ä¸ªç»å®çå­å¨åºï¼\n 2. å±äº«åå­æ¯æå¿«çä¸ç§ ipcï¼å ä¸ºè¿ç¨æ¯ç´æ¥å¯¹åå­è¿è¡å­åã\n\n\n# è¿ç¨è°åº¦ç®æ³\n\nè°åº¦ç®æ³æ¯æï¼æ ¹æ®ç³»ç»çèµæºåéç­ç¥æè§å®çèµæºåéç®æ³ã\n\nå¸¸ç¨çè°åº¦ç®æ³æï¼åæ¥åæå¡è°åº¦ç®æ³ãæ¶é´çè½®è½¬è°åº¦æ³ãç­ä½ä¸ä¼åè°åº¦ç®æ³ãæç­å©ä½æ¶é´ä¼åãé«ååºæ¯ä¼åè°åº¦ç®æ³ãä¼åçº§è°åº¦ç®æ³ç­ç­ã\n\n\n# ç¨æ·æååæ ¸æ\n\nç¨æ·æååæ ¸ææ¯æä½ç³»ç»çä¸¤ç§è¿è¡ç¶æã\n\n * åæ ¸æï¼å¤äºåæ ¸æç cpu å¯ä»¥è®¿é®ä»»æçæ°æ®ï¼åæ¬å¤å´è®¾å¤ï¼æ¯å¦ç½å¡ãç¡¬çç­ï¼å¤äºåæ ¸æç cpu å¯ä»¥ä»ä¸ä¸ªç¨åºåæ¢å°å¦å¤ä¸ä¸ªç¨åºï¼å¹¶ä¸å ç¨ cpu ä¸ä¼åçæ¢å æåµï¼ä¸è¬å¤äºç¹æçº§ 0 çç¶ææä»¬ç§°ä¹ä¸ºåæ ¸æã\n * ç¨æ·æï¼å¤äºç¨æ·æç cpu åªè½åéçè®¿é®åå­ï¼å¹¶ä¸ä¸åè®¸è®¿é®å¤å´è®¾å¤ï¼ç¨æ·æä¸ç cpu ä¸åè®¸ç¬å ï¼ä¹å°±æ¯è¯´ cpu è½å¤è¢«å¶ä»ç¨åºè·åã\n\n\n# ä¸ºä»ä¹è¦æç¨æ·æååæ ¸æå¢ï¼\n\nè¿ä¸ªä¸»è¦æ¯å¯¹è®¿é®è½åçéå¶ï¼è®¡ç®æºä¸­æä¸äºæ¯è¾å±é©çæä½ï¼æ¯å¦è®¾ç½®æ¶éãåå­æ¸çï¼è¿äºé½éè¦å¨åæ ¸æä¸å®æï¼å¦æéæè¿è¡è¿äºæä½ï¼é£ä½ çç³»ç»å¾å´©æºå¤å°æ¬¡ã\n\n\n# ç¨æ·æååæ ¸ææ¯å¦ä½åæ¢çï¼\n\nææçç¨æ·è¿ç¨é½æ¯è¿è¡å¨ç¨æ·æçï¼ä½ç¨æ·ç¨åºçè®¿é®è½åæéï¼ä¸äºæ¯è¾éè¦çæ¯å¦ä»ç¡¬çè¯»åæ°æ®ï¼ä»é®çè·åæ°æ®çæä½åæ¯åæ ¸ææè½åçäºæï¼èè¿äºæ°æ®å´åå¯¹ç¨æ·ç¨åºæ¥è¯´éå¸¸éè¦ãæä»¥å°±æ¶åå°ä¸¤ç§æ¨¡å¼ä¸çè½¬æ¢ï¼å³ç¨æ·æ -> åæ ¸æ -> ç¨æ·æï¼èå¯ä¸è½å¤åè¿äºæä½çåªæç³»ç»è°ç¨ï¼èè½å¤æ§è¡ç³»ç»è°ç¨çå°±åªææä½ç³»ç»ã\n\n\n\n * é¦åç¨æ·ç¨åºä¼è°ç¨ glibc åºï¼glibc æ¯ä¸ä¸ªæ ååºï¼åæ¶ä¹æ¯ä¸å¥æ ¸å¿åºï¼åºä¸­å®ä¹äºå¾å¤å³é® apiã\n * glibc åºç¥ééå¯¹ä¸åä½ç³»ç»æè°ç¨ç³»ç»è°ç¨çæ­£ç¡®æ¹æ³ï¼å®ä¼æ ¹æ®ä½ç³»ç»æåºç¨ç¨åºçäºè¿å¶æ¥å£è®¾ç½®ç¨æ·è¿ç¨ä¼ éçåæ°ï¼æ¥åå¤ç³»ç»è°ç¨ã\n * ç¶åï¼glibc åºè°ç¨è½¯ä»¶ä¸­æ­æä»¤(swi) ï¼è¿ä¸ªæä»¤éè¿æ´æ° cpsr å¯å­å¨å°æ¨¡å¼æ¹ä¸ºè¶çº§ç¨æ·æ¨¡å¼ï¼ç¶åè·³è½¬å°å°å 0x08 å¤ã\n * å°ç®åä¸ºæ­¢ï¼æ´ä¸ªè¿ç¨ä»å¤äºç¨æ·æä¸ï¼å¨æ§è¡ swi æä»¤åï¼åè®¸è¿ç¨æ§è¡åæ ¸ä»£ç ï¼mmu ç°å¨åè®¸åæ ¸èæåå­è®¿é®\n * ä»å°å 0x08 å¼å§ï¼è¿ç¨æ§è¡å è½½å¹¶è·³è½¬å°ä¸­æ­å¤çç¨åºï¼è¿ä¸ªç¨åºå°±æ¯ arm ä¸­ç vector_swi()ã\n * å¨ vector_swi() å¤ï¼ä» swi æä»¤ä¸­æåç³»ç»è°ç¨å· scnoï¼ç¶åä½¿ç¨ scno ä½ä¸ºç³»ç»è°ç¨è¡¨ sys_call_table çç´¢å¼ï¼è°è½¬å°ç³»ç»è°ç¨å½æ°ã\n * æ§è¡ç³»ç»è°ç¨å®æåï¼å°è¿åç¨æ·æ¨¡å¼å¯å­å¨ï¼ç¶ååä»¥ç¨æ·æ¨¡å¼æ§è¡ã",charsets:{cjk:!0}},{title:"åå­ç®¡ç",frontmatter:{title:"åå­ç®¡ç",date:"2023-09-04T21:01:14.000Z",permalink:"/pages/ceeb3f/"},regularPath:"/05.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/03.%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86.html",relativePath:"05.æä½ç³»ç»/03.åå­ç®¡ç.md",key:"v-50a497ba",path:"/pages/ceeb3f/",headers:[{level:2,title:"ä¸ºä»ä¹è¦æèæåå­",slug:"ä¸ºä»ä¹è¦æèæåå­",normalizedTitle:"ä¸ºä»ä¹è¦æèæåå­",charIndex:2},{level:2,title:"åå­åé¡µååæ®µ",slug:"åå­åé¡µååæ®µ",normalizedTitle:"åå­åé¡µååæ®µ",charIndex:541},{level:2,title:"linux çåå­ç®¡ç",slug:"linux-çåå­ç®¡ç",normalizedTitle:"linux çåå­ç®¡ç",charIndex:1324},{level:2,title:"æ®µé¡µå¼åå­ç®¡ç",slug:"æ®µé¡µå¼åå­ç®¡ç",normalizedTitle:"æ®µé¡µå¼åå­ç®¡ç",charIndex:1552},{level:2,title:"åå­åéçè¿ç¨",slug:"åå­åéçè¿ç¨",normalizedTitle:"åå­åéçè¿ç¨",charIndex:1566},{level:2,title:"å¨ 4GB ç©çåå­çæºå¨ä¸ï¼ç³è¯· 8G åå­ä¼æä¹æ ·ï¼",slug:"å¨-4gb-ç©çåå­çæºå¨ä¸-ç³è¯·-8g-åå­ä¼æä¹æ ·",normalizedTitle:"å¨ 4gb ç©çåå­çæºå¨ä¸ï¼ç³è¯· 8g åå­ä¼æä¹æ ·ï¼",charIndex:2330}],headersStr:"ä¸ºä»ä¹è¦æèæåå­ åå­åé¡µååæ®µ linux çåå­ç®¡ç æ®µé¡µå¼åå­ç®¡ç åå­åéçè¿ç¨ å¨ 4GB ç©çåå­çæºå¨ä¸ï¼ç³è¯· 8G åå­ä¼æä¹æ ·ï¼",content:"# ä¸ºä»ä¹è¦æèæåå­\n\nä¸ºäºå¨å¤è¿ç¨ç¯å¢ä¸ï¼ä½¿å¾è¿ç¨ä¹é´çåå­å°åä¸åå½±åï¼ç¸äºéç¦»ï¼äºæ¯æä½ç³»ç»å°±ä¸ºæ¯ä¸ªè¿ç¨ç¬ç«åéä¸å¥èæå°åç©ºé´ï¼æ¯ä¸ªç¨åºåªå³å¿èªå·±çèæå°åå°±å¯ä»¥ï¼å®éä¸å¤§å®¶çèæå°åé½æ¯ä¸æ ·çï¼ä½åå¸å°ç©çå°ååå­æ¯ä¸ä¸æ ·çãä½ä¸ºç¨åºï¼ä¹ä¸ç¨å³å¿ç©çå°åçäºæã\n\næ¯ä¸ªè¿ç¨é½æèªå·±çèæç©ºé´ï¼èç©çåå­åªæä¸ä¸ªï¼æä»¥å½å¯ç¨äºå¤§éçè¿ç¨ï¼ç©çåå­å¿ç¶ä¼å¾ç´§å¼ ï¼äºæ¯æä½ç³»ç»ä¼éè¿åå­äº¤æ¢ææ¯ï¼æä¸å¸¸ä½¿ç¨çåå­ææ¶å­æ¾å°ç¡¬çï¼æ¢åºï¼ï¼å¨éè¦çæ¶ååè£è½½åç©çåå­ï¼æ¢å¥ï¼ã\n\nèæåå­çä½ç¨ï¼\n\n * ç¬¬ä¸ï¼èæåå­å¯ä»¥ä½¿å¾è¿ç¨å¯¹è¿è¡åå­è¶è¿ç©çåå­å¤§å°ï¼å ä¸ºç¨åºè¿è¡ç¬¦åå±é¨æ§åçï¼CPU è®¿é®åå­ä¼æå¾ææ¾çéå¤è®¿é®çå¾åæ§ï¼å¯¹äºé£äºæ²¡æè¢«ç»å¸¸ä½¿ç¨å°çåå­ï¼æä»¬å¯ä»¥æå®æ¢åºå°ç©çåå­ä¹å¤ï¼æ¯å¦ç¡¬çä¸ç swap åºåã\n * ç¬¬äºï¼ç±äºæ¯ä¸ªè¿ç¨é½æèªå·±çé¡µè¡¨ï¼æä»¥æ¯ä¸ªè¿ç¨çèæåå­ç©ºé´å°±æ¯ç¸äºç¬ç«çãè¿ç¨ä¹æ²¡æåæ³è®¿é®å¶ä»è¿ç¨çé¡µè¡¨ï¼æä»¥è¿äºé¡µè¡¨æ¯ç§æçï¼è¿å°±è§£å³äºå¤è¿ç¨ä¹é´å°åå²çªçé®é¢ã\n * ç¬¬ä¸ï¼é¡µè¡¨éçé¡µè¡¨é¡¹ä¸­é¤äºç©çå°åä¹å¤ï¼è¿æä¸äºæ è®°å±æ§çæ¯ç¹ï¼æ¯å¦æ§å¶ä¸ä¸ªé¡µçè¯»åæéï¼æ è®°è¯¥é¡µæ¯å¦å­å¨ç­ãå¨åå­è®¿é®æ¹é¢ï¼æä½ç³»ç»æä¾äºæ´å¥½çå®å¨æ§ã\n\n\n# åå­åé¡µååæ®µ\n\né£æ¢ç¶æäºèæå°åç©ºé´ï¼é£å¿ç¶è¦æèæå°åãæ å°ãå°ç©çå°åï¼è¿ä¸ªäºæéå¸¸ç±æä½ç³»ç»æ¥ç»´æ¤ã\n\né£ä¹å¯¹äºèæå°åä¸ç©çå°åçæ å°å³ç³»ï¼å¯ä»¥æåæ®µååé¡µçæ¹å¼ï¼åæ¶ä¸¤èç»åé½æ¯å¯ä»¥çã\n\nåå­åæ®µæ¯æ ¹æ®ç¨åºçé»è¾è§åº¦ï¼åæäºæ æ®µãå æ®µãæ°æ®æ®µãä»£ç æ®µç­ï¼è¿æ ·å¯ä»¥åç¦»åºä¸åå±æ§çæ®µï¼åæ¶æ¯ä¸åè¿ç»­çç©ºé´ãåæ®µçå¥½å¤å°±æ¯è½äº§çè¿ç»­çåå­ç©ºé´ãä½æ¯æ¯ä¸ªæ®µçå¤§å°é½ä¸æ¯ç»ä¸çï¼è¿å°±ä¼å¯¼è´å¤é¨åå­ç¢çååå­äº¤æ¢æçä½çé®é¢ã\n\n> åæ®µä¸ºä»ä¹ä¼å¯¼è´åå­äº¤æ¢æçä½çé®é¢ï¼\n> \n> å¯¹äºå¤è¿ç¨çç³»ç»æ¥è¯´ï¼ç¨åæ®µçæ¹å¼ï¼å¤é¨åå­ç¢çæ¯å¾å®¹æäº§ççï¼äº§çäºå¤é¨åå­ç¢çï¼é£ä¸å¾ä¸éæ° Swap åå­åºåï¼è¿ä¸ªè¿ç¨ä¼äº§çæ§è½ç¶é¢ã\n> \n> å ä¸ºç¡¬ççè®¿é®éåº¦è¦æ¯åå­æ¢å¤ªå¤äºï¼æ¯ä¸æ¬¡åå­äº¤æ¢ï¼æä»¬é½éè¦æä¸å¤§æ®µè¿ç»­çåå­æ°æ®åå°ç¡¬çä¸ã\n\näºæ¯ï¼å°±åºç°äºåå­åé¡µï¼æèæç©ºé´åç©çç©ºé´åæå¤§å°åºå®çé¡µï¼å¦å¨ Linux ç³»ç»ä¸­ï¼æ¯ä¸é¡µçå¤§å°ä¸º 4KBãç±äºåäºé¡µåï¼å°±ä¸ä¼äº§çç»å°çåå­ç¢çï¼è§£å³äºåå­åæ®µçå¤é¨åå­ç¢çé®é¢ãåæ¶å¨åå­äº¤æ¢çæ¶åï¼åå¥ç¡¬çä¹å°±ä¸ä¸ªé¡µæå ä¸ªé¡µï¼è¿å°±å¤§å¤§æé«äºåå­äº¤æ¢çæçã\n\nåé¡µçæ¹å¼ä½¿å¾æä»¬å¨å è½½ç¨åºçæ¶åï¼ä¸åéè¦ä¸æ¬¡æ§é½æç¨åºå è½½å°ç©çåå­ä¸­ãæä»¬å®å¨å¯ä»¥å¨è¿è¡èæåå­åç©çåå­çé¡µä¹é´çæ å°ä¹åï¼å¹¶ä¸ççæé¡µå è½½å°ç©çåå­éï¼èæ¯åªæå¨ç¨åºè¿è¡ä¸­ï¼éè¦ç¨å°å¯¹åºèæåå­é¡µéé¢çæä»¤åæ°æ®æ¶ï¼åå è½½å°ç©çåå­éé¢å»ã\n\nåæ¥ï¼ä¸ºäºè§£å³ç®ååé¡µäº§ççé¡µè¡¨è¿å¤§çé®é¢ï¼å°±æäºå¤çº§é¡µè¡¨ï¼å®è§£å³äºç©ºé´ä¸çé®é¢ï¼ä½è¿å°±ä¼å¯¼è´ CPU å¨å¯»åçè¿ç¨ä¸­ï¼éè¦æå¾å¤å±è¡¨åä¸ï¼å å¤§äºæ¶é´ä¸çå¼éãäºæ¯æ ¹æ®ç¨åºçå±é¨æ§åçï¼å¨ CPU è¯çä¸­å å¥äº TLBï¼è´è´£ç¼å­æè¿å¸¸è¢«è®¿é®çé¡µè¡¨é¡¹ï¼å¤§å¤§æé«äºå°åçè½¬æ¢éåº¦ã\n\n\n\n\n\n\n\n\n# linux çåå­ç®¡ç\n\nLinux ç³»ç»ä¸»è¦éç¨äºåé¡µç®¡çï¼ä½æ¯ç±äº Intel å¤çå¨çåå±å²ï¼Linux ç³»ç»æ æ³é¿ååæ®µç®¡çãäºæ¯ Linux å°±ææææ®µçåºå°åè®¾ä¸º 0ï¼ä¹å°±æå³çææç¨åºçå°åç©ºé´é½æ¯çº¿æ§å°åç©ºé´ï¼èæå°åï¼ï¼ç¸å½äºå±è½äº CPU é»è¾å°åçæ¦å¿µï¼æä»¥æ®µåªè¢«ç¨äºè®¿é®æ§å¶ååå­ä¿æ¤ã\n\nå¦å¤ï¼Linux ç³»ç»ä¸­èæç©ºé´åå¸å¯åä¸ºç¨æ·æååæ ¸æä¸¤é¨åï¼å¶ä¸­ç¨æ·æçåå¸ï¼ä»£ç æ®µãå¨å±åéãBSSãå½æ°æ ãå åå­ãæ å°åºã\n\n\n# æ®µé¡µå¼åå­ç®¡ç\n\n\n\n\n# åå­åéçè¿ç¨\n\nåºç¨ç¨åºéè¿ malloc å½æ°ç³è¯·åå­çæ¶åï¼å®éä¸ç³è¯·çæ¯èæåå­ï¼æ­¤æ¶å¹¶ä¸ä¼åéç©çåå­ã\n\nå½åºç¨ç¨åºè¯»åäºè¿åèæåå­ï¼CPU å°±ä¼å»è®¿é®è¿ä¸ªèæåå­ï¼ è¿æ¶ä¼åç°è¿ä¸ªèæåå­æ²¡ææ å°å°ç©çåå­ï¼ CPU å°±ä¼äº§çç¼ºé¡µä¸­æ­ï¼è¿ç¨ä¼ä»ç¨æ·æåæ¢å°åæ ¸æï¼å¹¶å°ç¼ºé¡µä¸­æ­äº¤ç»åæ ¸ç Page Fault Handler ï¼ç¼ºé¡µä¸­æ­å½æ°ï¼å¤çã\n\nç¼ºé¡µä¸­æ­å¤çå½æ°ä¼çæ¯å¦æç©ºé²çç©çåå­ï¼å¦ææï¼å°±ç´æ¥åéç©çåå­ï¼å¹¶å»ºç«èæåå­ä¸ç©çåå­ä¹é´çæ å°å³ç³»ã\n\nå¦ææ²¡æç©ºé²çç©çåå­ï¼é£ä¹åæ ¸å°±ä¼å¼å§è¿è¡åæ¶åå­çå·¥ä½ï¼åæ¶çæ¹å¼ä¸»è¦æ¯ä¸¤ç§ï¼ç´æ¥åå­åæ¶ååå°åå­åæ¶ã\n\n * åå°åå­åæ¶ï¼kswapdï¼ï¼å¨ç©çåå­ç´§å¼ çæ¶åï¼ä¼å¤é kswapd åæ ¸çº¿ç¨æ¥åæ¶åå­ï¼è¿ä¸ªåæ¶åå­çè¿ç¨å¼æ­¥çï¼ä¸ä¼é»å¡è¿ç¨çæ§è¡ã\n * ç´æ¥åå­åæ¶ï¼direct reclaimï¼ï¼å¦æåå°å¼æ­¥åæ¶è·ä¸ä¸è¿ç¨åå­ç³è¯·çéåº¦ï¼å°±ä¼å¼å§ç´æ¥åæ¶ï¼è¿ä¸ªåæ¶åå­çè¿ç¨æ¯åæ­¥çï¼ä¼é»å¡è¿ç¨çæ§è¡ã\n\nå¦æç´æ¥åå­åæ¶åï¼ç©ºé²çç©çåå­ä»ç¶æ æ³æ»¡è¶³æ­¤æ¬¡ç©çåå­çç³è¯·ï¼é£ä¹åæ ¸å°±ä¼æ¾æåçå¤§æäº ââè§¦å OOM ï¼Out of Memoryï¼æºå¶ã\n\nOOM Killer æºå¶ä¼æ ¹æ®ç®æ³éæ©ä¸ä¸ªå ç¨ç©çåå­è¾é«çè¿ç¨ï¼ç¶åå°å¶ææ­»ï¼ä»¥ä¾¿éæ¾åå­èµæºï¼å¦æç©çåå­ä¾ç¶ä¸è¶³ï¼OOM Killer ä¼ç»§ç»­ææ­»å ç¨ç©çåå­è¾é«çè¿ç¨ï¼ç´å°éæ¾è¶³å¤çåå­ä½ç½®ã\n\nOOM killer ä¼æ ¹æ®æ¯ä¸ªè¿ç¨çåå­å ç¨æåµå oom_score_adj çå¼è¿è¡æåï¼å¾åæé«çè¿ç¨å°±ä¼è¢«é¦åææã\n\næä»¬å¯ä»¥éè¿è°æ´è¿ç¨ç /proc/[pid]/oom_score_adj å¼ï¼æ¥éä½è¢« OOM killer ææçæ¦çã\n\n\n# å¨ 4GB ç©çåå­çæºå¨ä¸ï¼ç³è¯· 8G åå­ä¼æä¹æ ·ï¼\n\nswap æºå¶ï¼ä¹å°±æ¯åå­äº¤æ¢ææ¯ãå½ç³»ç»çç©çåå­ä¸å¤ç¨çæ¶åï¼å°±éè¦å°ç©çåå­ä¸­çä¸é¨åç©ºé´éæ¾åºæ¥ï¼ä»¥ä¾å½åè¿è¡çç¨åºä½¿ç¨ãé£äºè¢«éæ¾çç©ºé´å¯è½æ¥èªä¸äºå¾é¿æ¶é´æ²¡æä»ä¹æä½çç¨åºï¼è¿äºè¢«éæ¾çç©ºé´ä¼è¢«ä¸´æ¶ä¿å­å°ç£çï¼ç­å°é£äºç¨åºè¦è¿è¡æ¶ï¼åä»ç£çä¸­æ¢å¤ä¿å­çæ°æ®å°åå­ä¸­ã\n\nå¦å¤ï¼å½åå­ä½¿ç¨å­å¨ååçæ¶åï¼ä¼å¼å§è§¦ååå­åæ¶è¡ä¸ºï¼ä¼æè¿äºä¸å¸¸è®¿é®çåå­ååå°ç£çä¸­ï¼ç¶åéæ¾è¿äºåå­ï¼ç»å¶ä»æ´éè¦çè¿ç¨ä½¿ç¨ãåæ¬¡è®¿é®è¿äºåå­æ¶ï¼éæ°ä»ç£çè¯»å¥åå­å°±å¯ä»¥äºã\n\nè¿ç§ï¼å°åå­æ°æ®æ¢åºç£çï¼åä»ç£çä¸­æ¢å¤æ°æ®å°åå­çè¿ç¨ï¼å°±æ¯ Swap æºå¶è´è´£çã\n\nSwap å°±æ¯æä¸åç£çç©ºé´æèæ¬å°æä»¶ï¼å½æåå­æ¥ä½¿ç¨ï¼å®åå«æ¢åºåæ¢å¥ä¸¤ä¸ªè¿ç¨ï¼\n\n * æ¢åºï¼Swap Outï¼ ï¼æ¯æè¿ç¨ææ¶ä¸ç¨çåå­æ°æ®å­å¨å°ç£çä¸­ï¼å¹¶éæ¾è¿äºæ°æ®å ç¨çåå­ï¼\n * æ¢å¥ï¼Swap Inï¼ï¼æ¯å¨è¿ç¨åæ¬¡è®¿é®è¿äºåå­çæ¶åï¼æå®ä»¬ä»ç£çè¯»å°åå­ä¸­æ¥ï¼\n\nå¨ 32 ä½æä½ç³»ç»ï¼å ä¸ºè¿ç¨çè®ºä¸æå¤§è½ç³è¯· 3 GB å¤§å°çèæåå­ï¼æä»¥ç´æ¥ç³è¯· 8G åå­ï¼ä¼ç³è¯·å¤±è´¥ã\n\nå¨ 64ä½ ä½æä½ç³»ç»ï¼å ä¸ºè¿ç¨çè®ºä¸æå¤§è½ç³è¯· 128 TB å¤§å°çèæåå­ï¼å³ä½¿ç©çåå­åªæ 4GBï¼ç³è¯· 8G åå­ä¹æ¯æ²¡é®é¢ï¼å ä¸ºç³è¯·çåå­æ¯èæåå­ãå¦æè¿åèæåå­è¢«è®¿é®äºï¼è¦çç³»ç»ææ²¡æ Swap ååºï¼\n\n * å¦ææ²¡æ Swap ååºï¼å ä¸ºç©çç©ºé´ä¸å¤ï¼è¿ç¨ä¼è¢«æä½ç³»ç»ææï¼åå æ¯ OOMï¼åå­æº¢åºï¼ï¼\n * å¦ææ Swap ååºï¼å³ä½¿ç©çåå­åªæ 4GBï¼ç¨åºä¹è½æ­£å¸¸ä½¿ç¨ 8GB çåå­ï¼è¿ç¨å¯ä»¥æ­£å¸¸è¿è¡ï¼",normalizedContent:"# ä¸ºä»ä¹è¦æèæåå­\n\nä¸ºäºå¨å¤è¿ç¨ç¯å¢ä¸ï¼ä½¿å¾è¿ç¨ä¹é´çåå­å°åä¸åå½±åï¼ç¸äºéç¦»ï¼äºæ¯æä½ç³»ç»å°±ä¸ºæ¯ä¸ªè¿ç¨ç¬ç«åéä¸å¥èæå°åç©ºé´ï¼æ¯ä¸ªç¨åºåªå³å¿èªå·±çèæå°åå°±å¯ä»¥ï¼å®éä¸å¤§å®¶çèæå°åé½æ¯ä¸æ ·çï¼ä½åå¸å°ç©çå°ååå­æ¯ä¸ä¸æ ·çãä½ä¸ºç¨åºï¼ä¹ä¸ç¨å³å¿ç©çå°åçäºæã\n\næ¯ä¸ªè¿ç¨é½æèªå·±çèæç©ºé´ï¼èç©çåå­åªæä¸ä¸ªï¼æä»¥å½å¯ç¨äºå¤§éçè¿ç¨ï¼ç©çåå­å¿ç¶ä¼å¾ç´§å¼ ï¼äºæ¯æä½ç³»ç»ä¼éè¿åå­äº¤æ¢ææ¯ï¼æä¸å¸¸ä½¿ç¨çåå­ææ¶å­æ¾å°ç¡¬çï¼æ¢åºï¼ï¼å¨éè¦çæ¶ååè£è½½åç©çåå­ï¼æ¢å¥ï¼ã\n\nèæåå­çä½ç¨ï¼\n\n * ç¬¬ä¸ï¼èæåå­å¯ä»¥ä½¿å¾è¿ç¨å¯¹è¿è¡åå­è¶è¿ç©çåå­å¤§å°ï¼å ä¸ºç¨åºè¿è¡ç¬¦åå±é¨æ§åçï¼cpu è®¿é®åå­ä¼æå¾ææ¾çéå¤è®¿é®çå¾åæ§ï¼å¯¹äºé£äºæ²¡æè¢«ç»å¸¸ä½¿ç¨å°çåå­ï¼æä»¬å¯ä»¥æå®æ¢åºå°ç©çåå­ä¹å¤ï¼æ¯å¦ç¡¬çä¸ç swap åºåã\n * ç¬¬äºï¼ç±äºæ¯ä¸ªè¿ç¨é½æèªå·±çé¡µè¡¨ï¼æä»¥æ¯ä¸ªè¿ç¨çèæåå­ç©ºé´å°±æ¯ç¸äºç¬ç«çãè¿ç¨ä¹æ²¡æåæ³è®¿é®å¶ä»è¿ç¨çé¡µè¡¨ï¼æä»¥è¿äºé¡µè¡¨æ¯ç§æçï¼è¿å°±è§£å³äºå¤è¿ç¨ä¹é´å°åå²çªçé®é¢ã\n * ç¬¬ä¸ï¼é¡µè¡¨éçé¡µè¡¨é¡¹ä¸­é¤äºç©çå°åä¹å¤ï¼è¿æä¸äºæ è®°å±æ§çæ¯ç¹ï¼æ¯å¦æ§å¶ä¸ä¸ªé¡µçè¯»åæéï¼æ è®°è¯¥é¡µæ¯å¦å­å¨ç­ãå¨åå­è®¿é®æ¹é¢ï¼æä½ç³»ç»æä¾äºæ´å¥½çå®å¨æ§ã\n\n\n# åå­åé¡µååæ®µ\n\né£æ¢ç¶æäºèæå°åç©ºé´ï¼é£å¿ç¶è¦æèæå°åãæ å°ãå°ç©çå°åï¼è¿ä¸ªäºæéå¸¸ç±æä½ç³»ç»æ¥ç»´æ¤ã\n\né£ä¹å¯¹äºèæå°åä¸ç©çå°åçæ å°å³ç³»ï¼å¯ä»¥æåæ®µååé¡µçæ¹å¼ï¼åæ¶ä¸¤èç»åé½æ¯å¯ä»¥çã\n\nåå­åæ®µæ¯æ ¹æ®ç¨åºçé»è¾è§åº¦ï¼åæäºæ æ®µãå æ®µãæ°æ®æ®µãä»£ç æ®µç­ï¼è¿æ ·å¯ä»¥åç¦»åºä¸åå±æ§çæ®µï¼åæ¶æ¯ä¸åè¿ç»­çç©ºé´ãåæ®µçå¥½å¤å°±æ¯è½äº§çè¿ç»­çåå­ç©ºé´ãä½æ¯æ¯ä¸ªæ®µçå¤§å°é½ä¸æ¯ç»ä¸çï¼è¿å°±ä¼å¯¼è´å¤é¨åå­ç¢çååå­äº¤æ¢æçä½çé®é¢ã\n\n> åæ®µä¸ºä»ä¹ä¼å¯¼è´åå­äº¤æ¢æçä½çé®é¢ï¼\n> \n> å¯¹äºå¤è¿ç¨çç³»ç»æ¥è¯´ï¼ç¨åæ®µçæ¹å¼ï¼å¤é¨åå­ç¢çæ¯å¾å®¹æäº§ççï¼äº§çäºå¤é¨åå­ç¢çï¼é£ä¸å¾ä¸éæ° swap åå­åºåï¼è¿ä¸ªè¿ç¨ä¼äº§çæ§è½ç¶é¢ã\n> \n> å ä¸ºç¡¬ççè®¿é®éåº¦è¦æ¯åå­æ¢å¤ªå¤äºï¼æ¯ä¸æ¬¡åå­äº¤æ¢ï¼æä»¬é½éè¦æä¸å¤§æ®µè¿ç»­çåå­æ°æ®åå°ç¡¬çä¸ã\n\näºæ¯ï¼å°±åºç°äºåå­åé¡µï¼æèæç©ºé´åç©çç©ºé´åæå¤§å°åºå®çé¡µï¼å¦å¨ linux ç³»ç»ä¸­ï¼æ¯ä¸é¡µçå¤§å°ä¸º 4kbãç±äºåäºé¡µåï¼å°±ä¸ä¼äº§çç»å°çåå­ç¢çï¼è§£å³äºåå­åæ®µçå¤é¨åå­ç¢çé®é¢ãåæ¶å¨åå­äº¤æ¢çæ¶åï¼åå¥ç¡¬çä¹å°±ä¸ä¸ªé¡µæå ä¸ªé¡µï¼è¿å°±å¤§å¤§æé«äºåå­äº¤æ¢çæçã\n\nåé¡µçæ¹å¼ä½¿å¾æä»¬å¨å è½½ç¨åºçæ¶åï¼ä¸åéè¦ä¸æ¬¡æ§é½æç¨åºå è½½å°ç©çåå­ä¸­ãæä»¬å®å¨å¯ä»¥å¨è¿è¡èæåå­åç©çåå­çé¡µä¹é´çæ å°ä¹åï¼å¹¶ä¸ççæé¡µå è½½å°ç©çåå­éï¼èæ¯åªæå¨ç¨åºè¿è¡ä¸­ï¼éè¦ç¨å°å¯¹åºèæåå­é¡µéé¢çæä»¤åæ°æ®æ¶ï¼åå è½½å°ç©çåå­éé¢å»ã\n\nåæ¥ï¼ä¸ºäºè§£å³ç®ååé¡µäº§ççé¡µè¡¨è¿å¤§çé®é¢ï¼å°±æäºå¤çº§é¡µè¡¨ï¼å®è§£å³äºç©ºé´ä¸çé®é¢ï¼ä½è¿å°±ä¼å¯¼è´ cpu å¨å¯»åçè¿ç¨ä¸­ï¼éè¦æå¾å¤å±è¡¨åä¸ï¼å å¤§äºæ¶é´ä¸çå¼éãäºæ¯æ ¹æ®ç¨åºçå±é¨æ§åçï¼å¨ cpu è¯çä¸­å å¥äº tlbï¼è´è´£ç¼å­æè¿å¸¸è¢«è®¿é®çé¡µè¡¨é¡¹ï¼å¤§å¤§æé«äºå°åçè½¬æ¢éåº¦ã\n\n\n\n\n\n\n\n\n# linux çåå­ç®¡ç\n\nlinux ç³»ç»ä¸»è¦éç¨äºåé¡µç®¡çï¼ä½æ¯ç±äº intel å¤çå¨çåå±å²ï¼linux ç³»ç»æ æ³é¿ååæ®µç®¡çãäºæ¯ linux å°±ææææ®µçåºå°åè®¾ä¸º 0ï¼ä¹å°±æå³çææç¨åºçå°åç©ºé´é½æ¯çº¿æ§å°åç©ºé´ï¼èæå°åï¼ï¼ç¸å½äºå±è½äº cpu é»è¾å°åçæ¦å¿µï¼æä»¥æ®µåªè¢«ç¨äºè®¿é®æ§å¶ååå­ä¿æ¤ã\n\nå¦å¤ï¼linux ç³»ç»ä¸­èæç©ºé´åå¸å¯åä¸ºç¨æ·æååæ ¸æä¸¤é¨åï¼å¶ä¸­ç¨æ·æçåå¸ï¼ä»£ç æ®µãå¨å±åéãbssãå½æ°æ ãå åå­ãæ å°åºã\n\n\n# æ®µé¡µå¼åå­ç®¡ç\n\n\n\n\n# åå­åéçè¿ç¨\n\nåºç¨ç¨åºéè¿ malloc å½æ°ç³è¯·åå­çæ¶åï¼å®éä¸ç³è¯·çæ¯èæåå­ï¼æ­¤æ¶å¹¶ä¸ä¼åéç©çåå­ã\n\nå½åºç¨ç¨åºè¯»åäºè¿åèæåå­ï¼cpu å°±ä¼å»è®¿é®è¿ä¸ªèæåå­ï¼ è¿æ¶ä¼åç°è¿ä¸ªèæåå­æ²¡ææ å°å°ç©çåå­ï¼ cpu å°±ä¼äº§çç¼ºé¡µä¸­æ­ï¼è¿ç¨ä¼ä»ç¨æ·æåæ¢å°åæ ¸æï¼å¹¶å°ç¼ºé¡µä¸­æ­äº¤ç»åæ ¸ç page fault handler ï¼ç¼ºé¡µä¸­æ­å½æ°ï¼å¤çã\n\nç¼ºé¡µä¸­æ­å¤çå½æ°ä¼çæ¯å¦æç©ºé²çç©çåå­ï¼å¦ææï¼å°±ç´æ¥åéç©çåå­ï¼å¹¶å»ºç«èæåå­ä¸ç©çåå­ä¹é´çæ å°å³ç³»ã\n\nå¦ææ²¡æç©ºé²çç©çåå­ï¼é£ä¹åæ ¸å°±ä¼å¼å§è¿è¡åæ¶åå­çå·¥ä½ï¼åæ¶çæ¹å¼ä¸»è¦æ¯ä¸¤ç§ï¼ç´æ¥åå­åæ¶ååå°åå­åæ¶ã\n\n * åå°åå­åæ¶ï¼kswapdï¼ï¼å¨ç©çåå­ç´§å¼ çæ¶åï¼ä¼å¤é kswapd åæ ¸çº¿ç¨æ¥åæ¶åå­ï¼è¿ä¸ªåæ¶åå­çè¿ç¨å¼æ­¥çï¼ä¸ä¼é»å¡è¿ç¨çæ§è¡ã\n * ç´æ¥åå­åæ¶ï¼direct reclaimï¼ï¼å¦æåå°å¼æ­¥åæ¶è·ä¸ä¸è¿ç¨åå­ç³è¯·çéåº¦ï¼å°±ä¼å¼å§ç´æ¥åæ¶ï¼è¿ä¸ªåæ¶åå­çè¿ç¨æ¯åæ­¥çï¼ä¼é»å¡è¿ç¨çæ§è¡ã\n\nå¦æç´æ¥åå­åæ¶åï¼ç©ºé²çç©çåå­ä»ç¶æ æ³æ»¡è¶³æ­¤æ¬¡ç©çåå­çç³è¯·ï¼é£ä¹åæ ¸å°±ä¼æ¾æåçå¤§æäº ââè§¦å oom ï¼out of memoryï¼æºå¶ã\n\noom killer æºå¶ä¼æ ¹æ®ç®æ³éæ©ä¸ä¸ªå ç¨ç©çåå­è¾é«çè¿ç¨ï¼ç¶åå°å¶ææ­»ï¼ä»¥ä¾¿éæ¾åå­èµæºï¼å¦æç©çåå­ä¾ç¶ä¸è¶³ï¼oom killer ä¼ç»§ç»­ææ­»å ç¨ç©çåå­è¾é«çè¿ç¨ï¼ç´å°éæ¾è¶³å¤çåå­ä½ç½®ã\n\noom killer ä¼æ ¹æ®æ¯ä¸ªè¿ç¨çåå­å ç¨æåµå oom_score_adj çå¼è¿è¡æåï¼å¾åæé«çè¿ç¨å°±ä¼è¢«é¦åææã\n\næä»¬å¯ä»¥éè¿è°æ´è¿ç¨ç /proc/[pid]/oom_score_adj å¼ï¼æ¥éä½è¢« oom killer ææçæ¦çã\n\n\n# å¨ 4gb ç©çåå­çæºå¨ä¸ï¼ç³è¯· 8g åå­ä¼æä¹æ ·ï¼\n\nswap æºå¶ï¼ä¹å°±æ¯åå­äº¤æ¢ææ¯ãå½ç³»ç»çç©çåå­ä¸å¤ç¨çæ¶åï¼å°±éè¦å°ç©çåå­ä¸­çä¸é¨åç©ºé´éæ¾åºæ¥ï¼ä»¥ä¾å½åè¿è¡çç¨åºä½¿ç¨ãé£äºè¢«éæ¾çç©ºé´å¯è½æ¥èªä¸äºå¾é¿æ¶é´æ²¡æä»ä¹æä½çç¨åºï¼è¿äºè¢«éæ¾çç©ºé´ä¼è¢«ä¸´æ¶ä¿å­å°ç£çï¼ç­å°é£äºç¨åºè¦è¿è¡æ¶ï¼åä»ç£çä¸­æ¢å¤ä¿å­çæ°æ®å°åå­ä¸­ã\n\nå¦å¤ï¼å½åå­ä½¿ç¨å­å¨ååçæ¶åï¼ä¼å¼å§è§¦ååå­åæ¶è¡ä¸ºï¼ä¼æè¿äºä¸å¸¸è®¿é®çåå­ååå°ç£çä¸­ï¼ç¶åéæ¾è¿äºåå­ï¼ç»å¶ä»æ´éè¦çè¿ç¨ä½¿ç¨ãåæ¬¡è®¿é®è¿äºåå­æ¶ï¼éæ°ä»ç£çè¯»å¥åå­å°±å¯ä»¥äºã\n\nè¿ç§ï¼å°åå­æ°æ®æ¢åºç£çï¼åä»ç£çä¸­æ¢å¤æ°æ®å°åå­çè¿ç¨ï¼å°±æ¯ swap æºå¶è´è´£çã\n\nswap å°±æ¯æä¸åç£çç©ºé´æèæ¬å°æä»¶ï¼å½æåå­æ¥ä½¿ç¨ï¼å®åå«æ¢åºåæ¢å¥ä¸¤ä¸ªè¿ç¨ï¼\n\n * æ¢åºï¼swap outï¼ ï¼æ¯æè¿ç¨ææ¶ä¸ç¨çåå­æ°æ®å­å¨å°ç£çä¸­ï¼å¹¶éæ¾è¿äºæ°æ®å ç¨çåå­ï¼\n * æ¢å¥ï¼swap inï¼ï¼æ¯å¨è¿ç¨åæ¬¡è®¿é®è¿äºåå­çæ¶åï¼æå®ä»¬ä»ç£çè¯»å°åå­ä¸­æ¥ï¼\n\nå¨ 32 ä½æä½ç³»ç»ï¼å ä¸ºè¿ç¨çè®ºä¸æå¤§è½ç³è¯· 3 gb å¤§å°çèæåå­ï¼æä»¥ç´æ¥ç³è¯· 8g åå­ï¼ä¼ç³è¯·å¤±è´¥ã\n\nå¨ 64ä½ ä½æä½ç³»ç»ï¼å ä¸ºè¿ç¨çè®ºä¸æå¤§è½ç³è¯· 128 tb å¤§å°çèæåå­ï¼å³ä½¿ç©çåå­åªæ 4gbï¼ç³è¯· 8g åå­ä¹æ¯æ²¡é®é¢ï¼å ä¸ºç³è¯·çåå­æ¯èæåå­ãå¦æè¿åèæåå­è¢«è®¿é®äºï¼è¦çç³»ç»ææ²¡æ swap ååºï¼\n\n * å¦ææ²¡æ swap ååºï¼å ä¸ºç©çç©ºé´ä¸å¤ï¼è¿ç¨ä¼è¢«æä½ç³»ç»ææï¼åå æ¯ oomï¼åå­æº¢åºï¼ï¼\n * å¦ææ swap ååºï¼å³ä½¿ç©çåå­åªæ 4gbï¼ç¨åºä¹è½æ­£å¸¸ä½¿ç¨ 8gb çåå­ï¼è¿ç¨å¯ä»¥æ­£å¸¸è¿è¡ï¼",charsets:{cjk:!0}},{title:"äºåæ ",frontmatter:{title:"äºåæ ",date:"2023-04-21T21:23:46.000Z",permalink:"/pages/d2945b/"},regularPath:"/06.%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/03.%E4%BA%8C%E5%8F%89%E6%A0%91.html",relativePath:"06.æ°æ®ç»æåç®æ³/03.äºåæ .md",key:"v-d0cbc152",path:"/pages/d2945b/",headers:[{level:2,title:"éå½éå",slug:"éå½éå",normalizedTitle:"éå½éå",charIndex:2},{level:2,title:"è¿­ä»£éåï¼æ ï¼",slug:"è¿­ä»£éå-æ ",normalizedTitle:"è¿­ä»£éåï¼æ ï¼",charIndex:594},{level:2,title:"å±åºéå",slug:"å±åºéå",normalizedTitle:"å±åºéå",charIndex:3438}],headersStr:"éå½éå è¿­ä»£éåï¼æ ï¼ å±åºéå",content:"# éå½éå\n\nclass Solution {\n    List<Integer> ans = new ArrayList<>();\n    public List<Integer> preorderTraversal(TreeNode root) {\n        if (root == null) return ans;\n        ans.add(root.val);\n        preorderTraversal(root.left);\n        preorderTraversal(root.right);\n        return ans;\n    }\n}\n\n\nclass Solution {\n    List<Integer> ans = new ArrayList<>();\n    public List<Integer> inorderTraversal(TreeNode root) {\n        if (root == null) return ans;\n        preorderTraversal(root.left);\n        ans.add(root.val);\n        preorderTraversal(root.right);\n        return ans;\n    }\n}\n\n\n\n# è¿­ä»£éåï¼æ ï¼\n\n * ååºéåé¡ºåºï¼ä¸­-å·¦-å³ï¼å¥æ é¡ºåºï¼ä¸­-å³-å·¦\n * ä¸­åºéåé¡ºåº: å·¦-ä¸­-å³ å¥æ é¡ºåºï¼ å·¦-å³ â¨\n * ååºéåé¡ºåº å·¦-å³-ä¸­ å¥æ é¡ºåºï¼ä¸­-å·¦-å³ åºæ é¡ºåºï¼ä¸­-å³-å·¦ï¼ æåç¿»è½¬ç»æ\n\nclass Solution {\n    public List<Integer> preorderTraversal(TreeNode root) {\n        List<Integer> ans = new ArrayList<>();\n        if (root == null) return ans;\n        Deque<TreeNode> d = new ArrayDeque<>();\n        d.offerLast(root);\n        while (!d.isEmpty()) {\n            TreeNode t = d.pollLast();\n            ans.add(t.val);\n            if (t.right != null) d.offerLast(t.right);\n            if (t.left != null) d.offerLast(t.left);\n        }\n        return ans;\n    }\n}\n\n\nclass Solution {\n    public List<Integer> inorderTraversal(TreeNode root) {\n        List<Integer> ans = new ArrayList<>();\n        if (root == null) return ans;\n        Deque<TreeNode> d = new ArrayDeque<>();\n        TreeNode cur = root;\n        while (cur != null || !d.isEmpty()) {\n            if (cur != null) {\n                d.offerLast(cur);\n                cur = cur.left;\n            } else {\n                TreeNode t = d.pollLast();\n                ans.add(t.val);\n                cur = t.right;\n            }\n        }\n        return ans;\n    }\n}\n\n\näºåæ çç»ä¸è¿­ä»£åæ³ï¼æ ä»·æ³ï¼å°è¦å¤ççèç¹æ¾å¥æ åï¼ç´§è·çæ¾å¥ä¸ä¸ªç©ºæéä½ä¸ºæ è®°ã\n\nclass Solution {\n    public List<Integer> preorderTraversal(TreeNode root) {\n        List<Integer> result = new LinkedList<>();\n        Stack<TreeNode> st = new Stack<>();\n        if (root != null) st.push(root);\n        while (!st.empty()) {\n            TreeNode node = st.peek();\n            if (node != null) {\n                st.pop(); // å°è¯¥èç¹å¼¹åºï¼é¿åéå¤æä½ï¼ä¸é¢åå°å³ä¸­å·¦èç¹æ·»å å°æ ä¸­\n                if (node.right!=null) st.push(node.right);  // æ·»å å³èç¹ï¼ç©ºèç¹ä¸å¥æ ï¼\n                if (node.left!=null) st.push(node.left);    // æ·»å å·¦èç¹ï¼ç©ºèç¹ä¸å¥æ ï¼\n                st.push(node);                          // æ·»å ä¸­èç¹\n                st.push(null); // ä¸­èç¹è®¿é®è¿ï¼ä½æ¯è¿æ²¡æå¤çï¼å å¥ç©ºèç¹åä¸ºæ è®°ã\n                \n            } else { // åªæéå°ç©ºèç¹çæ¶åï¼æå°ä¸ä¸ä¸ªèç¹æ¾è¿ç»æé\n                st.pop();           // å°ç©ºèç¹å¼¹åº\n                node = st.pop();\n                result.add(node.val); // å å¥å°ç»æé\n            }\n        }\n        return result;\n    }\n}\n\n\nclass Solution {\n    public List<Integer> inorderTraversal(TreeNode root) {\n        List<Integer> ans = new ArrayList<>();\n        if (root == null) return ans;\n        Deque<TreeNode> d = new LinkedList<>(); // ArrayDeuqe ä¸è½æ·»å  nullã\n        d.offerLast(root);\n        while (!d.isEmpty()) {\n            TreeNode t = d.pollLast();\n            if (t != null) {\n                if (t.right != null) d.offerLast(t.right);\n                d.offerLast(t);\n                d.offerLast(null); // ä¸­èç¹è®¿é®è¿ï¼ä½æ¯è¿æ²¡æå¤çï¼å å¥ç©ºèç¹åä¸ºæ è®°ã\n                if (t.left != null) d.offerLast(t.left);\n            } else { // åªæéå°ç©ºèç¹çæ¶åï¼æå°ä¸ä¸ä¸ªèç¹æ¾è¿ç»æé\n                t = d.pollLast();\n                ans.add(t.val);\n            }\n        }\n        return ans;\n    }\n}\n\n\n\n# å±åºéå\n\n// bfs\nclass Solution {\n    public List<List<Integer>> levelOrder(TreeNode root) {\n        List<List<Integer>> ans = new ArrayList<>();\n        if (root == null) return ans;\n        Deque<TreeNode> d = new ArrayDeque<>();\n        d.offerLast(root);\n        while (!d.isEmpty()) {\n            int n = d.size();\n            List<Integer> list = new ArrayList<>();\n            ans.add(list);\n            while (n-- > 0) {\n                TreeNode t = d.pollFirst();\n                list.add(t.val);\n                if (t.left != null) d.offerLast(t.left);\n                if (t.right != null) d.offerLast(t.right);\n            }\n        }\n        return ans;\n    }\n}\n\n\n// dfs\nclass Solution {\n    List<List<Integer>> ans = new ArrayList<>();\n    public List<List<Integer>> levelOrder(TreeNode root) {\n        dfs(root, 1);\n        return ans;\n    }\n\n    public void dfs(TreeNode root, Integer deep) {\n        if (root == null) return;\n        if (ans.size() < deep) {\n            ans.add(new ArrayList<>());\n        }\n        ans.get(deep - 1).add(root.val);\n        dfs(root.left, deep + 1);\n        dfs(root.right, deep + 1);\n    }\n}\n",normalizedContent:"# éå½éå\n\nclass solution {\n    list<integer> ans = new arraylist<>();\n    public list<integer> preordertraversal(treenode root) {\n        if (root == null) return ans;\n        ans.add(root.val);\n        preordertraversal(root.left);\n        preordertraversal(root.right);\n        return ans;\n    }\n}\n\n\nclass solution {\n    list<integer> ans = new arraylist<>();\n    public list<integer> inordertraversal(treenode root) {\n        if (root == null) return ans;\n        preordertraversal(root.left);\n        ans.add(root.val);\n        preordertraversal(root.right);\n        return ans;\n    }\n}\n\n\n\n# è¿­ä»£éåï¼æ ï¼\n\n * ååºéåé¡ºåºï¼ä¸­-å·¦-å³ï¼å¥æ é¡ºåºï¼ä¸­-å³-å·¦\n * ä¸­åºéåé¡ºåº: å·¦-ä¸­-å³ å¥æ é¡ºåºï¼ å·¦-å³ â¨\n * ååºéåé¡ºåº å·¦-å³-ä¸­ å¥æ é¡ºåºï¼ä¸­-å·¦-å³ åºæ é¡ºåºï¼ä¸­-å³-å·¦ï¼ æåç¿»è½¬ç»æ\n\nclass solution {\n    public list<integer> preordertraversal(treenode root) {\n        list<integer> ans = new arraylist<>();\n        if (root == null) return ans;\n        deque<treenode> d = new arraydeque<>();\n        d.offerlast(root);\n        while (!d.isempty()) {\n            treenode t = d.polllast();\n            ans.add(t.val);\n            if (t.right != null) d.offerlast(t.right);\n            if (t.left != null) d.offerlast(t.left);\n        }\n        return ans;\n    }\n}\n\n\nclass solution {\n    public list<integer> inordertraversal(treenode root) {\n        list<integer> ans = new arraylist<>();\n        if (root == null) return ans;\n        deque<treenode> d = new arraydeque<>();\n        treenode cur = root;\n        while (cur != null || !d.isempty()) {\n            if (cur != null) {\n                d.offerlast(cur);\n                cur = cur.left;\n            } else {\n                treenode t = d.polllast();\n                ans.add(t.val);\n                cur = t.right;\n            }\n        }\n        return ans;\n    }\n}\n\n\näºåæ çç»ä¸è¿­ä»£åæ³ï¼æ ä»·æ³ï¼å°è¦å¤ççèç¹æ¾å¥æ åï¼ç´§è·çæ¾å¥ä¸ä¸ªç©ºæéä½ä¸ºæ è®°ã\n\nclass solution {\n    public list<integer> preordertraversal(treenode root) {\n        list<integer> result = new linkedlist<>();\n        stack<treenode> st = new stack<>();\n        if (root != null) st.push(root);\n        while (!st.empty()) {\n            treenode node = st.peek();\n            if (node != null) {\n                st.pop(); // å°è¯¥èç¹å¼¹åºï¼é¿åéå¤æä½ï¼ä¸é¢åå°å³ä¸­å·¦èç¹æ·»å å°æ ä¸­\n                if (node.right!=null) st.push(node.right);  // æ·»å å³èç¹ï¼ç©ºèç¹ä¸å¥æ ï¼\n                if (node.left!=null) st.push(node.left);    // æ·»å å·¦èç¹ï¼ç©ºèç¹ä¸å¥æ ï¼\n                st.push(node);                          // æ·»å ä¸­èç¹\n                st.push(null); // ä¸­èç¹è®¿é®è¿ï¼ä½æ¯è¿æ²¡æå¤çï¼å å¥ç©ºèç¹åä¸ºæ è®°ã\n                \n            } else { // åªæéå°ç©ºèç¹çæ¶åï¼æå°ä¸ä¸ä¸ªèç¹æ¾è¿ç»æé\n                st.pop();           // å°ç©ºèç¹å¼¹åº\n                node = st.pop();\n                result.add(node.val); // å å¥å°ç»æé\n            }\n        }\n        return result;\n    }\n}\n\n\nclass solution {\n    public list<integer> inordertraversal(treenode root) {\n        list<integer> ans = new arraylist<>();\n        if (root == null) return ans;\n        deque<treenode> d = new linkedlist<>(); // arraydeuqe ä¸è½æ·»å  nullã\n        d.offerlast(root);\n        while (!d.isempty()) {\n            treenode t = d.polllast();\n            if (t != null) {\n                if (t.right != null) d.offerlast(t.right);\n                d.offerlast(t);\n                d.offerlast(null); // ä¸­èç¹è®¿é®è¿ï¼ä½æ¯è¿æ²¡æå¤çï¼å å¥ç©ºèç¹åä¸ºæ è®°ã\n                if (t.left != null) d.offerlast(t.left);\n            } else { // åªæéå°ç©ºèç¹çæ¶åï¼æå°ä¸ä¸ä¸ªèç¹æ¾è¿ç»æé\n                t = d.polllast();\n                ans.add(t.val);\n            }\n        }\n        return ans;\n    }\n}\n\n\n\n# å±åºéå\n\n// bfs\nclass solution {\n    public list<list<integer>> levelorder(treenode root) {\n        list<list<integer>> ans = new arraylist<>();\n        if (root == null) return ans;\n        deque<treenode> d = new arraydeque<>();\n        d.offerlast(root);\n        while (!d.isempty()) {\n            int n = d.size();\n            list<integer> list = new arraylist<>();\n            ans.add(list);\n            while (n-- > 0) {\n                treenode t = d.pollfirst();\n                list.add(t.val);\n                if (t.left != null) d.offerlast(t.left);\n                if (t.right != null) d.offerlast(t.right);\n            }\n        }\n        return ans;\n    }\n}\n\n\n// dfs\nclass solution {\n    list<list<integer>> ans = new arraylist<>();\n    public list<list<integer>> levelorder(treenode root) {\n        dfs(root, 1);\n        return ans;\n    }\n\n    public void dfs(treenode root, integer deep) {\n        if (root == null) return;\n        if (ans.size() < deep) {\n            ans.add(new arraylist<>());\n        }\n        ans.get(deep - 1).add(root.val);\n        dfs(root.left, deep + 1);\n        dfs(root.right, deep + 1);\n    }\n}\n",charsets:{cjk:!0}},{title:"redux",frontmatter:{title:"redux",date:"2023-03-29T19:59:44.000Z",permalink:"/pages/redux/"},regularPath:"/07.%E5%89%8D%E7%AB%AF/01.React/01.redux.html",relativePath:"07.åç«¯/01.React/01.redux.md",key:"v-d35585c0",path:"/pages/redux/",headers:[{level:2,title:"reduxåç",slug:"reduxåç",normalizedTitle:"reduxåç",charIndex:2},{level:3,title:"srcç®å½ä¸åå»º:",slug:"srcç®å½ä¸åå»º",normalizedTitle:"srcç®å½ä¸åå»º:",charIndex:235},{level:3,title:"store.js",slug:"store-js",normalizedTitle:"store.js",charIndex:260},{level:3,title:"count_reducer.js",slug:"count-reducer-js",normalizedTitle:"count_reducer.js",charIndex:274},{level:2,title:"react-reduxæä»¶åº",slug:"react-reduxæä»¶åº",normalizedTitle:"react-reduxæä»¶åº",charIndex:622}],headersStr:"reduxåç srcç®å½ä¸åå»º: store.js count_reducer.js react-reduxæä»¶åº",content:"# reduxåç\n\n\n\nreduxä¸æ¯reactæä»¶åºã\n\néä¸­ç®¡çreactåºç¨ä¸­çå¤ä¸ªç»ä»¶å±äº«çç¶æã\n\nè½ä¸ç¨å°±ä¸ç¨ã\n\nèªèº«çstateæ¯å±äºç»ä»¶æ¬èº«çã\n\nstore.dispatch(action)\n\nstore.subscribe(() => {})ï¼æ£æµreduxä¸­ç¶æçååï¼åªè¦æååï¼å°±è°ç¨\n\naction: {type:xxx, data:xxx}\n\nxxxReducer(preState, action)ï¼return æ°çç¶æå¼\n\n\n# srcç®å½ä¸åå»º:\n\n * redux\n   * store.js\n   * count_reducer.js\n   * count_action.jsï¼ä¸é¨ç¨äºåå»ºactionå¯¹è±¡ã\n   * constant.js\n\n\n# store.js\n\n * å¼å¥reduxä¸­çcreateStoreå½æ°ï¼åå»ºä¸ä¸ªstoreã\n * createStoreè°ç¨æ¶ä¼ å¥ä¸ä¸ªreducer\n * æ´é²storeå¯¹è±¡\n\n\n# count_reducer.js\n\n * reduceræ¬è´¨æ¯ä¸ä¸ªå½æ°ï¼è¾å¥preStateåactionï¼è¿åå å·¥åçç¶æã\n * reduceræä¸¤ä¸ªä½ç¨ï¼åå§åç¶æï¼å å·¥ç¶æ\n * reducerç¬¬ä¸æ¬¡è°ç¨æ¶åï¼æ¯storeèªå¨è§¦åï¼ä¼ éçpreStateæ¯undefined\n\nreduxåªè´è´£ç®¡çç¶æï¼ç¶ææ¹ååï¼é¡µé¢çéåæ¸²æéè¦èªå·±åã\n\n\n# react-reduxæä»¶åº\n\nfacebookå®æ¹åºçã\n\n\n\n * https://juejin.cn/post/7079277020521185293",normalizedContent:"# reduxåç\n\n\n\nreduxä¸æ¯reactæä»¶åºã\n\néä¸­ç®¡çreactåºç¨ä¸­çå¤ä¸ªç»ä»¶å±äº«çç¶æã\n\nè½ä¸ç¨å°±ä¸ç¨ã\n\nèªèº«çstateæ¯å±äºç»ä»¶æ¬èº«çã\n\nstore.dispatch(action)\n\nstore.subscribe(() => {})ï¼æ£æµreduxä¸­ç¶æçååï¼åªè¦æååï¼å°±è°ç¨\n\naction: {type:xxx, data:xxx}\n\nxxxreducer(prestate, action)ï¼return æ°çç¶æå¼\n\n\n# srcç®å½ä¸åå»º:\n\n * redux\n   * store.js\n   * count_reducer.js\n   * count_action.jsï¼ä¸é¨ç¨äºåå»ºactionå¯¹è±¡ã\n   * constant.js\n\n\n# store.js\n\n * å¼å¥reduxä¸­çcreatestoreå½æ°ï¼åå»ºä¸ä¸ªstoreã\n * createstoreè°ç¨æ¶ä¼ å¥ä¸ä¸ªreducer\n * æ´é²storeå¯¹è±¡\n\n\n# count_reducer.js\n\n * reduceræ¬è´¨æ¯ä¸ä¸ªå½æ°ï¼è¾å¥prestateåactionï¼è¿åå å·¥åçç¶æã\n * reduceræä¸¤ä¸ªä½ç¨ï¼åå§åç¶æï¼å å·¥ç¶æ\n * reducerç¬¬ä¸æ¬¡è°ç¨æ¶åï¼æ¯storeèªå¨è§¦åï¼ä¼ éçprestateæ¯undefined\n\nreduxåªè´è´£ç®¡çç¶æï¼ç¶ææ¹ååï¼é¡µé¢çéåæ¸²æéè¦èªå·±åã\n\n\n# react-reduxæä»¶åº\n\nfacebookå®æ¹åºçã\n\n\n\n * https://juejin.cn/post/7079277020521185293",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"æ¦å¿µ",frontmatter:{title:"æ¦å¿µ",date:"2023-03-29T20:44:51.000Z",permalink:"/pages/2d7856/"},regularPath:"/07.%E5%89%8D%E7%AB%AF/01.React/02.%E6%A6%82%E5%BF%B5.html",relativePath:"07.åç«¯/01.React/02.æ¦å¿µ.md",key:"v-957f7b90",path:"/pages/2d7856/",headers:[{level:2,title:"ES5ãES6åES2015æä»ä¹åºå«?",slug:"es5ães6åes2015æä»ä¹åºå«",normalizedTitle:"es5ães6åes2015æä»ä¹åºå«?",charIndex:2},{level:2,title:"ES5åES6çåè½åºå«",slug:"es5åes6çåè½åºå«",normalizedTitle:"es5åes6çåè½åºå«",charIndex:165},{level:2,title:"JavaScriptåTypeScriptçåºå«",slug:"javascriptåtypescriptçåºå«",normalizedTitle:"javascriptåtypescriptçåºå«",charIndex:626},{level:2,title:"letæä»ä¹ç¨ï¼æäºvarä¸ºä»ä¹è¿è¦ç¨letï¼",slug:"letæä»ä¹ç¨-æäºvarä¸ºä»ä¹è¿è¦ç¨let",normalizedTitle:"letæä»ä¹ç¨ï¼æäºvarä¸ºä»ä¹è¿è¦ç¨letï¼",charIndex:929},{level:2,title:"yarnånpm",slug:"yarnånpm",normalizedTitle:"yarnånpm",charIndex:1105}],headersStr:"ES5ãES6åES2015æä»ä¹åºå«? ES5åES6çåè½åºå« JavaScriptåTypeScriptçåºå« letæä»ä¹ç¨ï¼æäºvarä¸ºä»ä¹è¿è¦ç¨letï¼ yarnånpm",content:"# ES5ãES6åES2015æä»ä¹åºå«?\n\nES2015ç¹æå¨2015å¹´åå¸çæ°ä¸ä»£JSè¯­è¨æ åï¼ES6æ³æä¸ä¸ä»£JSè¯­è¨æ åï¼åå«ES2015ãES2016ãES2017ãES2018ç­ãç°é¶æ®µå¨ç»å¤§é¨ååºæ¯ä¸ï¼ES2015é»è®¤ç­åES6ãES5æ³æä¸ä¸ä»£è¯­è¨æ åãES2015å¯ä»¥çè§£ä¸ºES5åES6çæ¶é´åççº¿\n\n\n# ES5åES6çåè½åºå«\n\nåéå£°æï¼å¨ES5ä¸­ï¼ä½¿ç¨varå³é®å­æ¥å£°æåéï¼èå¨ES6ä¸­ï¼å¯ä»¥ä½¿ç¨letåconstå³é®å­æ¥å£°æåéãå¶ä¸­ï¼letç¨äºå£°æå¯ååéï¼constç¨äºå£°æä¸å¯ååéã\n\nç®­å¤´å½æ°ï¼ES6å¼å¥äºç®­å¤´å½æ°çæ¦å¿µï¼ä½¿å¾å½æ°çå®ä¹æ´å ç®ååæ¸æ°ãç®­å¤´å½æ°çè¯­æ³æ¯ES5ä¸­çå½æ°å®ä¹æ´å ç®æ´ã\n\nç±»ï¼å¨ES6ä¸­ï¼å¼å¥äºç±»çæ¦å¿µï¼ä½¿å¾JavaScriptä¸­çé¢åå¯¹è±¡ç¼ç¨æ´å æ¸æ°åæäºçè§£ãç±»å·æå±æ§åæ¹æ³ï¼å¹¶ä¸å¯ä»¥éè¿ç»§æ¿æ¥æ©å±åè½ã\n\næ¨¡åï¼å¨ES6ä¸­ï¼å¼å¥äºæ¨¡åçæ¦å¿µï¼å¯ä»¥å°ä»£ç åæå¤ä¸ªæ¨¡åï¼ä½¿å¾ä»£ç æ´å æ¨¡ååãå¯éç¨åæäºç»´æ¤ãæ¨¡åå¯ä»¥å¯¼åºåå¯¼å¥åéåå½æ°ã\n\nè§£æèµå¼ï¼ES6ä¸­å¼å¥äºè§£æèµå¼ï¼å¯ä»¥æ¹ä¾¿å°ä»æ°ç»åå¯¹è±¡ä¸­è·åå¼å¹¶å°å¶èµç»åéï¼ä½¿å¾ä»£ç æ´å ç®æ´åæäºçè§£ã\n\næ©å±è¿ç®ç¬¦ï¼ES6ä¸­å¼å¥äºæ©å±è¿ç®ç¬¦ï¼å¯ä»¥å°æ°ç»åå¯¹è±¡å±å¼æå¤ä¸ªå¼ï¼ä¹å¯ä»¥å°å¤ä¸ªå¼ç»åæä¸ä¸ªæ°ç»æå¯¹è±¡ã\n\nPromiseï¼ES6ä¸­å¼å¥äºPromiseçæ¦å¿µï¼å¯ä»¥æ´å æ¹ä¾¿å°è¿è¡å¼æ­¥ç¼ç¨ï¼é¿åäºåè°å°ç±çé®é¢ã\n\n\n# JavaScriptåTypeScriptçåºå«\n\n * JavaScriptæ¯ä¸ç§èæ¬è¯­è¨ï¼å¯ä»¥å¸®å©åå»ºäº¤äºå¼ç½é¡µï¼èTypeScriptæ¯JavaScriptçè¶éã\n * éè¦ç¼è¯ç±»åèæ¬ä»£ç ï¼èä¸éè¦ç¼è¯JavaScriptä»£ç ã\n * æ¯è¾TypeScriptåJSï¼TypeScriptæ¯æåååç¹æ§ï¼èJavaScriptä¸æ¯æè¯¥ç¹æ§ã\n * TypeScriptä½¿ç¨ç±»ååæ¥å£ç­æ¦å¿µæ¥æè¿°æ­£å¨ä½¿ç¨çæ°æ®ï¼èJavaScriptæ²¡æè¿æ ·çæ¦å¿µã\n * TypeScriptæ¯ä¸ä¸ªåè½å¼ºå¤§çç±»åç³»ç»ï¼åæ¬ç¨äºå¤§åé¡¹ç®çæ³ååJSç¹æ§ï¼èJavaScriptåæ¯ç¨äºå°åé¡¹ç®ççæ³éæ©ã\n\n\n# letæä»ä¹ç¨ï¼æäºvarä¸ºä»ä¹è¿è¦ç¨letï¼\n\nå¨ES6ä¹åï¼å£°æåéåªè½ç¨varï¼varæ¹å¼å£°æåéå¶å®æ¯å¾ä¸åççï¼åç¡®çè¯´ï¼æ¯å ä¸ºES5éé¢æ²¡æåçº§ä½ç¨åæ¯å¾ä¸åççãæ²¡æåçº§ä½ç¨ååæ¥å¸¦å¾å¤é¾ä»¥çè§£çé®é¢ï¼æ¯å¦forå¾ªç¯varåéæ³é²ï¼åéè¦çç­é®é¢ãletå£°æçåéæ¥æèªå·±çåçº§ä½ç¨åï¼ä¸ä¿®å¤äºvarå£°æåéå¸¦æ¥çåéæåé®é¢ã\n\n\n# yarnånpm\n\nnpm install\nnpm run dev\n\n===\nyarn \nyarn start/dev\n\n===\nnpm install === yarn \nnpm install taco --save === yarn add taco\nnpm uninstall taco --save === yarn remove taco\nnpm install taco --save-dev === yarn add taco --dev\nnpm update --save === yarn upgrade\n\n\nhttps://zhuanlan.zhihu.com/p/23493436",normalizedContent:"# es5ães6åes2015æä»ä¹åºå«?\n\nes2015ç¹æå¨2015å¹´åå¸çæ°ä¸ä»£jsè¯­è¨æ åï¼es6æ³æä¸ä¸ä»£jsè¯­è¨æ åï¼åå«es2015ães2016ães2017ães2018ç­ãç°é¶æ®µå¨ç»å¤§é¨ååºæ¯ä¸ï¼es2015é»è®¤ç­åes6ães5æ³æä¸ä¸ä»£è¯­è¨æ åães2015å¯ä»¥çè§£ä¸ºes5åes6çæ¶é´åççº¿\n\n\n# es5åes6çåè½åºå«\n\nåéå£°æï¼å¨es5ä¸­ï¼ä½¿ç¨varå³é®å­æ¥å£°æåéï¼èå¨es6ä¸­ï¼å¯ä»¥ä½¿ç¨letåconstå³é®å­æ¥å£°æåéãå¶ä¸­ï¼letç¨äºå£°æå¯ååéï¼constç¨äºå£°æä¸å¯ååéã\n\nç®­å¤´å½æ°ï¼es6å¼å¥äºç®­å¤´å½æ°çæ¦å¿µï¼ä½¿å¾å½æ°çå®ä¹æ´å ç®ååæ¸æ°ãç®­å¤´å½æ°çè¯­æ³æ¯es5ä¸­çå½æ°å®ä¹æ´å ç®æ´ã\n\nç±»ï¼å¨es6ä¸­ï¼å¼å¥äºç±»çæ¦å¿µï¼ä½¿å¾javascriptä¸­çé¢åå¯¹è±¡ç¼ç¨æ´å æ¸æ°åæäºçè§£ãç±»å·æå±æ§åæ¹æ³ï¼å¹¶ä¸å¯ä»¥éè¿ç»§æ¿æ¥æ©å±åè½ã\n\næ¨¡åï¼å¨es6ä¸­ï¼å¼å¥äºæ¨¡åçæ¦å¿µï¼å¯ä»¥å°ä»£ç åæå¤ä¸ªæ¨¡åï¼ä½¿å¾ä»£ç æ´å æ¨¡ååãå¯éç¨åæäºç»´æ¤ãæ¨¡åå¯ä»¥å¯¼åºåå¯¼å¥åéåå½æ°ã\n\nè§£æèµå¼ï¼es6ä¸­å¼å¥äºè§£æèµå¼ï¼å¯ä»¥æ¹ä¾¿å°ä»æ°ç»åå¯¹è±¡ä¸­è·åå¼å¹¶å°å¶èµç»åéï¼ä½¿å¾ä»£ç æ´å ç®æ´åæäºçè§£ã\n\næ©å±è¿ç®ç¬¦ï¼es6ä¸­å¼å¥äºæ©å±è¿ç®ç¬¦ï¼å¯ä»¥å°æ°ç»åå¯¹è±¡å±å¼æå¤ä¸ªå¼ï¼ä¹å¯ä»¥å°å¤ä¸ªå¼ç»åæä¸ä¸ªæ°ç»æå¯¹è±¡ã\n\npromiseï¼es6ä¸­å¼å¥äºpromiseçæ¦å¿µï¼å¯ä»¥æ´å æ¹ä¾¿å°è¿è¡å¼æ­¥ç¼ç¨ï¼é¿åäºåè°å°ç±çé®é¢ã\n\n\n# javascriptåtypescriptçåºå«\n\n * javascriptæ¯ä¸ç§èæ¬è¯­è¨ï¼å¯ä»¥å¸®å©åå»ºäº¤äºå¼ç½é¡µï¼ètypescriptæ¯javascriptçè¶éã\n * éè¦ç¼è¯ç±»åèæ¬ä»£ç ï¼èä¸éè¦ç¼è¯javascriptä»£ç ã\n * æ¯è¾typescriptåjsï¼typescriptæ¯æåååç¹æ§ï¼èjavascriptä¸æ¯æè¯¥ç¹æ§ã\n * typescriptä½¿ç¨ç±»ååæ¥å£ç­æ¦å¿µæ¥æè¿°æ­£å¨ä½¿ç¨çæ°æ®ï¼èjavascriptæ²¡æè¿æ ·çæ¦å¿µã\n * typescriptæ¯ä¸ä¸ªåè½å¼ºå¤§çç±»åç³»ç»ï¼åæ¬ç¨äºå¤§åé¡¹ç®çæ³ååjsç¹æ§ï¼èjavascriptåæ¯ç¨äºå°åé¡¹ç®ççæ³éæ©ã\n\n\n# letæä»ä¹ç¨ï¼æäºvarä¸ºä»ä¹è¿è¦ç¨letï¼\n\nå¨es6ä¹åï¼å£°æåéåªè½ç¨varï¼varæ¹å¼å£°æåéå¶å®æ¯å¾ä¸åççï¼åç¡®çè¯´ï¼æ¯å ä¸ºes5éé¢æ²¡æåçº§ä½ç¨åæ¯å¾ä¸åççãæ²¡æåçº§ä½ç¨ååæ¥å¸¦å¾å¤é¾ä»¥çè§£çé®é¢ï¼æ¯å¦forå¾ªç¯varåéæ³é²ï¼åéè¦çç­é®é¢ãletå£°æçåéæ¥æèªå·±çåçº§ä½ç¨åï¼ä¸ä¿®å¤äºvarå£°æåéå¸¦æ¥çåéæåé®é¢ã\n\n\n# yarnånpm\n\nnpm install\nnpm run dev\n\n===\nyarn \nyarn start/dev\n\n===\nnpm install === yarn \nnpm install taco --save === yarn add taco\nnpm uninstall taco --save === yarn remove taco\nnpm install taco --save-dev === yarn add taco --dev\nnpm update --save === yarn upgrade\n\n\nhttps://zhuanlan.zhihu.com/p/23493436",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"å¿«æ·é®",frontmatter:{title:"å¿«æ·é®",date:"2023-03-31T16:35:46.000Z",permalink:"/pages/960017/",article:!1},regularPath:"/07.%E5%89%8D%E7%AB%AF/01.React/%E5%BF%AB%E6%8D%B7%E9%94%AE.html",relativePath:"07.åç«¯/01.React/å¿«æ·é®.md",key:"v-224a9095",path:"/pages/960017/",headers:[{level:2,title:"reactå¿«æ·é®",slug:"reactå¿«æ·é®",normalizedTitle:"reactå¿«æ·é®",charIndex:2}],headersStr:"reactå¿«æ·é®",content:"# reactå¿«æ·é®\n\nrccï¼react clss component\n\nrfcï¼react function component",normalizedContent:"# reactå¿«æ·é®\n\nrccï¼react clss component\n\nrfcï¼react function component",charsets:{cjk:!0}},{title:"jså¼æ­¥ç¼ç¨",frontmatter:{title:"jså¼æ­¥ç¼ç¨",date:"2023-04-24T15:17:23.000Z",permalink:"/pages/9ba4c3/"},regularPath:"/07.%E5%89%8D%E7%AB%AF/01.js%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B.html",relativePath:"07.åç«¯/01.jså¼æ­¥ç¼ç¨.md",key:"v-70032af0",path:"/pages/9ba4c3/",headers:[{level:2,title:"Promise",slug:"promise",normalizedTitle:"promise",charIndex:2},{level:3,title:"Promise.all",slug:"promise-all",normalizedTitle:"promise.all",charIndex:354},{level:2,title:"async/await",slug:"async-await",normalizedTitle:"async/await",charIndex:544},{level:2,title:"åè°å½æ°",slug:"åè°å½æ°",normalizedTitle:"åè°å½æ°",charIndex:1767}],headersStr:"Promise Promise.all async/await åè°å½æ°",content:"# Promise\n\nPromise æ¯ JavaScript ä¸­çä¸ç§å¼æ­¥ç¼ç¨è§£å³æ¹æ¡ãå®å¯ä»¥ç¨äºè§£å³åè°å°ç±åå¤å±åµå¥çå¼æ­¥ä»£ç çé®é¢ï¼ä½¿å¾å¼æ­¥æä½æ´å ç®åãå¯è¯»æ§æ´é«ãå¯ç»´æ¤æ§æ´å¥½ã\n\nPromise ä»£è¡¨ä¸ä¸ªå°æªå®æçå¼æ­¥æä½ï¼å®æä¸ç§ç¶æï¼pendingãfulfilledãrejectedã\n\nå½å¼æ­¥æä½æåå®ææ¶ï¼Promise çç¶æåä¸º fulfilledï¼å¹¶è¿åä¸ä¸ªç»æï¼\n\nå½å¼æ­¥æä½å¤±è´¥æ¶ï¼Promise çç¶æåä¸º rejectedï¼å¹¶è¿åä¸ä¸ªéè¯¯ä¿¡æ¯ï¼\n\nå½å¼æ­¥æä½å°æªå®ææ¶ï¼Promise çç¶æä¸º pendingã\n\nPromise å¯ä»¥éè¿ .then() å .catch() æ¹æ³æ¥å¤çå¼æ­¥æä½å®ææ¶çç»ææéè¯¯ä¿¡æ¯ï¼ä»èå®ç°å¼æ­¥æä½çé¾å¼è°ç¨ã\n\nåæ¶ï¼å¯ä»¥ä½¿ç¨ Promise.all() æ¹æ³å°å¤ä¸ª Promise å¯¹è±¡ç»åæä¸ä¸ªæ°ç Promise å¯¹è±¡ï¼å¹¶å¨å¶ä¸­ä»»æä¸ä¸ª Promise å¯¹è±¡åä¸º rejected ç¶ææ¶å°±ç«å³ç»æï¼ä»èå®ç°å¤ä¸ªå¼æ­¥æä½çå¹¶è¡å¤çã\n\nå¨ä½¿ç¨ Promise è¿è¡å¼æ­¥ç¼ç¨æ¶ï¼å¯ä»¥å°å¼æ­¥æä½å°è£æä¸ä¸ªå½æ°ï¼å¹¶è¿åä¸ä¸ª Promise å¯¹è±¡ï¼ä»èä½¿å¾å¼æ­¥æä½çä½¿ç¨æ´å ç®åãå¯è¯»æ§æ´å¥½ãæ­¤å¤ï¼å¨éåä½¿ç¨ async/await è¯­æ³æ¶ï¼Promise å¯ä»¥æ´å æ¹ä¾¿å°è¿è¡å¼æ­¥æä½çè°ç¨åå¤çã\n\n\n# Promise.all\n\nå¦ææ³è¦ async å½æ°ä¸­çå¤ä¸ª await æ¹æ³å¹¶åæ§è¡ï¼å¯ä»¥ä½¿ç¨ Promise.all æ¹æ³å°è¿äº await æ¹æ³åè£æå¤ä¸ª Promise å¯¹è±¡ï¼ç¶åä½¿ç¨ Promise.all æ¹æ³ç­å¾ææ Promise å¯¹è±¡çå®æï¼å¹¶å°å®ä»¬ç resolved å¼åå¹¶ä¸ºä¸ä¸ªæ°ç»è¿åã\n\nasync function getData() {\n  const promises = [\n    fetch('https://example.com/data1.json'),\n    fetch('https://example.com/data2.json'),\n    fetch('https://example.com/data3.json')\n  ];\n  const responses = await Promise.all(promises);\n  const data = await Promise.all(responses.map(response => response.json()));\n  console.log(data);\n}\n\ngetData();\n\n\nä½¿ç¨ Promise.all æ¹æ³å¯ä»¥è®© async å½æ°ä¸­çå¤ä¸ª await æ¹æ³å¹¶åæ§è¡ï¼ä»èæé«å¼æ­¥ä»£ç çæ§è¡æçãéè¦æ³¨æçæ¯ï¼Promise.all æ¹æ³ä¼ç­å¾ææ Promise å¯¹è±¡çå®æï¼å¹¶å°å®ä»¬ç resolved å¼åå¹¶ä¸ºä¸ä¸ªæ°ç»è¿åï¼å æ­¤ï¼å¦æå¶ä¸­ä»»ä½ä¸ä¸ª Promise å¯¹è±¡è¢« rejectedï¼Promise.all æ¹æ³ä¼ç«å³è¿åä¸ä¸ª rejected ç¶æç Promise å¯¹è±¡ï¼å¹¶å°è¯¥ Promise å¯¹è±¡ç rejected å¼ä¼ éç» catch æ¹æ³å¤çã\n\nç¸æ¯ä¹ä¸ï¼å¦æå°å¤ä¸ª await æ¹æ³åå¼åæå¤ä¸ªè¯­å¥ï¼æ¯ä¸ª await æ¹æ³é½ä¼ç­å¾åä¸ä¸ª await æ¹æ³çå®æï¼ä»èå¯¼è´å¼æ­¥æä½çä¸²è¡æ§è¡ï¼æ§è¡æçè¾ä½ã\n\n\n# async/await\n\nasync å½æ°æ¯ ES2017ï¼ES8ï¼å¼å¥çæ°ç¹æ§ï¼å®åè®¸å¨å½æ°åé¢å ä¸ async å³é®å­ï¼å°æ®éå½æ°è½¬åä¸ºå¼æ­¥å½æ°ãå¼æ­¥å½æ°å¯ä»¥ä½¿ç¨ await å³é®å­ç­å¾ä¸ä¸ªå¼æ­¥æä½çå®æï¼å¹¶å°å¼æ­¥æä½çç»æè¿åç»è°ç¨èã\n\nawait æ¯ ES2017ï¼ES8ï¼å¼å¥çæ°ç¹æ§ï¼å®åªè½ç¨å¨ async å½æ°åé¨ï¼ç¨äºç­å¾ä¸ä¸ªè¿å Promise å¯¹è±¡çè¡¨è¾¾å¼å®æï¼å¹¶è¿åè¯¥ Promise å¯¹è±¡ç resolved å¼ãç®åæ¥è¯´ï¼await å¯ä»¥æåå½å async å½æ°çæ§è¡ï¼ç­å¾ä¸ä¸ªå¼æ­¥æä½å®æååç»§ç»­æ§è¡ã\n\nä½¿ç¨ await å³é®å­å¯ä»¥è®©å¼æ­¥æä½çä»£ç æ´æäºéè¯»åçè§£ï¼å ä¸ºå®å¯ä»¥å°å¼æ­¥ä»£ç è½¬åä¸ºç±»ä¼¼äºåæ­¥ä»£ç çå½¢å¼ï¼èä¸éè¦ä½¿ç¨åè°å½æ°æ Promise é¾å¼è°ç¨çæ¹å¼æ¥å¤çå¼æ­¥æä½çç»æãåæ¶ï¼await å³é®å­ä¹å¯ä»¥ç¨äºå¤çå¼æ­¥ä»£ç ä¸­çéè¯¯ï¼å¯ä»¥ä½¿ç¨ try-catch è¯­å¥æè·å¼æ­¥æä½ä¸­çéè¯¯ã\n\n// await expression\n\nasync function getData() {\n  const response = await fetch('https://example.com/data.json');\n  const data = await response.json();\n  console.log(data);\n}\n\ngetData();\n\n\n\nå¶ä¸­ï¼expression æ¯ä¸ä¸ªè¿å Promise å¯¹è±¡çè¡¨è¾¾å¼ãå¦æè¡¨è¾¾å¼ä¸æ¯ Promise å¯¹è±¡ï¼åä¼è¢«èªå¨åè£æ Promise å¯¹è±¡ï¼ç¶åè¿åä¸ä¸ª resolved ç¶æç Promise å¯¹è±¡ã\n\nawait è¡¨è¾¾å¼çæ§è¡æµç¨å¦ä¸ï¼\n\n 1. å¦æ expression æ¯ä¸ä¸ªå·²ç» resolved ç Promise å¯¹è±¡ï¼åç´æ¥è¿åè¯¥ Promise å¯¹è±¡ç resolved å¼ã\n 2. å¦æ expression æ¯ä¸ä¸ªæªå®æç Promise å¯¹è±¡ï¼å await è¡¨è¾¾å¼ä¼æåå½åå½æ°çæ§è¡ï¼ç´å° Promise å¯¹è±¡åæ resolved ç¶æï¼ç¶åè¿åè¯¥ Promise å¯¹è±¡ç resolved å¼ã\n 3. å¦æ expression æ¯ä¸ä¸ªé Promise å¯¹è±¡ï¼å await è¡¨è¾¾å¼ä¼å°è¯¥å¯¹è±¡èªå¨åè£æ resolved ç¶æç Promise å¯¹è±¡ï¼ç¶åè¿åè¯¥ Promise å¯¹è±¡ç resolved å¼ã\n\nfunction getUserInfo(userId) {\n  return new Promise((resolve, reject) => {\n    // æ¨¡æå¼æ­¥è¯·æ±ç¨æ·ä¿¡æ¯\n    setTimeout(() => {\n      const userInfo = { id: userId, name: 'Alice' };\n      if (userId === 1) {\n        resolve(userInfo);\n      } else {\n        reject(new Error('User not found'));\n      }\n    }, 1000);\n  });\n}\n\n// è°ç¨å¼æ­¥æä½å½æ°å¹¶å¤çå¼æ­¥ç»æ\ngetUserInfo(1)\n  .then(userInfo => console.log(userInfo))\n  .catch(error => console.error(error));\n\ngetUserInfo(2)\n  .then(userInfo => console.log(userInfo))\n  .catch(error => console.error(error));\n\n\n\nfunction getUserInfo(userId) {\n  return new Promise((resolve, reject) => {\n    // æ¨¡æå¼æ­¥è¯·æ±ç¨æ·ä¿¡æ¯\n    setTimeout(() => {\n      const userInfo = { id: userId, name: 'Alice' };\n      if (userId === 1) {\n        resolve(userInfo);\n      } else {\n        reject(new Error('User not found'));\n      }\n    }, 1000);\n  });\n}\n\nasync function main() {\n  try {\n    // ç­å¾å¼æ­¥æä½å®æå¹¶è·åç»æ\n    const userInfo1 = await getUserInfo(1);\n    console.log(userInfo1);\n\n    // ç­å¾å¼æ­¥æä½å®æå¹¶è·åç»æ\n    const userInfo2 = await getUserInfo(2);\n    console.log(userInfo2);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// è°ç¨å¼æ­¥æä½å½æ°å¹¶å¤çå¼æ­¥ç»æ\nmain();\n\n\n\nå¦æä¸ä½¿ç¨ async å³é®å­ï¼é£ä¹å½æ° main ä¸­çå¼æ­¥è°ç¨ getUserInfo å®éä¸æ¯åæ­¥æ§è¡çï¼å³ä¸ä¼ç­å¾å¼æ­¥æä½å®æå¹¶è¿åç»æï¼èæ¯ç´æ¥æ§è¡ä¸ä¸è¡ä»£ç ã\n\nå¨è¿ä¸ªä»£ç ä¸­ï¼æä»¬å¨è°ç¨ getUserInfo(1) å getUserInfo(2) æ¶å¹¶æ²¡æä½¿ç¨ .then() æ¹æ³æ await å³é®å­ç­å¾å¼æ­¥æä½å®æï¼èæ¯ç´æ¥æ Promise å¯¹è±¡èµå¼ç» userInfo1 å userInfo2 åéãè¿æ ·åçé®é¢å¨äºï¼ç±äºå¼æ­¥æä½çæ§è¡éè¦ä¸å®çæ¶é´ï¼è¿äºåéå®éä¸æ¯è¿æ²¡æå¾å°å¼ç Promise å¯¹è±¡ï¼èä¸æ¯æä»¬ææçç¨æ·ä¿¡æ¯å¯¹è±¡ã\n\nå æ­¤ï¼å¨ console.log(userInfo1) å console.log(userInfo2) ä¸­æå°çå®éä¸æ¯ Promise å¯¹è±¡æ¬èº«ï¼èä¸æ¯ç¨æ·ä¿¡æ¯å¯¹è±¡ãæ­¤å¤ï¼ç±äº try...catch ååªè½æè·åæ­¥ä»£ç ä¸­çå¼å¸¸ï¼å æ­¤å¦æå¼æ­¥æä½æåºå¼å¸¸ï¼æä»¬æ æ³å¨ catch åä¸­æè·è¯¥å¼å¸¸ã\n\nä¸è¿°ä»£ç è¿åå¼çåºå«ï¼\n\n{ id: 1, name: 'Alice' }\nError: User not found\n    at Timeout._onTimeout (file:///Users/billy/Projects/web/vite-project-test/src/promise-test.js:9:18)\n    at listOnTimeout (node:internal/timers:569:17)\n    at process.processTimers (node:internal/timers:512:7)\n\n\n// ä¸å  async/await\nPromise { <pending> }\nPromise { <pending> }\nfile:///Users/billy/Projects/web/vite-project-test/src/promise-test.js:9\n          reject(new Error('User not found'));\n                 ^\n\nError: User not found\n    at Timeout._onTimeout (file:///Users/billy/Projects/web/vite-project-test/src/promise-test.js:9:18)\n    at listOnTimeout (node:internal/timers:569:17)\n    at process.processTimers (node:internal/timers:512:7)\n\n\n\n\n# åè°å½æ°\n\nåè°å½æ°æ¯ä¸ç§ä¼ éå½æ°ä½ä¸ºåæ°çç¼ç¨æ¨¡å¼ãå¨ JavaScript ä¸­ï¼åè°å½æ°å¸¸å¸¸è¢«ç¨äºå¼æ­¥ç¼ç¨ï¼å°å¼æ­¥æä½çç»æéè¿åè°å½æ°ä¼ éç»ä¸ä¸ä¸ªä»»å¡ãä¾å¦ï¼ä½¿ç¨ Node.js çæä»¶è¯»åæ¹æ³ fs.readFile() è¿è¡æä»¶è¯»åæ¶ï¼å°±éè¦ä¼ å¥ä¸ä¸ªåè°å½æ°æ¥å¤çè¯»åç»æã\n\nconst fs = require('fs');\n\nfs.readFile('file.txt', 'utf8', function(err, data) {\n  if (err) throw err;\n  console.log(data);\n});\n\n\n\nå¨ä¸é¢çä»£ç ä¸­ï¼fs.readFile() æ¹æ³è¯»åæä»¶æ¶æ¯å¼æ­¥çï¼å®éè¦ä¼ å¥ä¸ä¸ªåè°å½æ°æ¥å¤çè¯»åç»æãåè°å½æ°å¨æä»¶è¯»åå®ææ¶è¢«è°ç¨ï¼ä¼ å¥ä¸¤ä¸ªåæ° err å dataï¼è¡¨ç¤ºè¯»åæä½æ¯å¦åºéä»¥åè¯»åçæä»¶åå®¹ã\n\nåè°å½æ°çç¼ºç¹æ¯ä¼äº§çåè°å°ç±é®é¢ï¼åµå¥è¿å¤çåè°å½æ°ä¼ä½¿ä»£ç åå¾é¾ä»¥éè¯»åç»´æ¤ã",normalizedContent:"# promise\n\npromise æ¯ javascript ä¸­çä¸ç§å¼æ­¥ç¼ç¨è§£å³æ¹æ¡ãå®å¯ä»¥ç¨äºè§£å³åè°å°ç±åå¤å±åµå¥çå¼æ­¥ä»£ç çé®é¢ï¼ä½¿å¾å¼æ­¥æä½æ´å ç®åãå¯è¯»æ§æ´é«ãå¯ç»´æ¤æ§æ´å¥½ã\n\npromise ä»£è¡¨ä¸ä¸ªå°æªå®æçå¼æ­¥æä½ï¼å®æä¸ç§ç¶æï¼pendingãfulfilledãrejectedã\n\nå½å¼æ­¥æä½æåå®ææ¶ï¼promise çç¶æåä¸º fulfilledï¼å¹¶è¿åä¸ä¸ªç»æï¼\n\nå½å¼æ­¥æä½å¤±è´¥æ¶ï¼promise çç¶æåä¸º rejectedï¼å¹¶è¿åä¸ä¸ªéè¯¯ä¿¡æ¯ï¼\n\nå½å¼æ­¥æä½å°æªå®ææ¶ï¼promise çç¶æä¸º pendingã\n\npromise å¯ä»¥éè¿ .then() å .catch() æ¹æ³æ¥å¤çå¼æ­¥æä½å®ææ¶çç»ææéè¯¯ä¿¡æ¯ï¼ä»èå®ç°å¼æ­¥æä½çé¾å¼è°ç¨ã\n\nåæ¶ï¼å¯ä»¥ä½¿ç¨ promise.all() æ¹æ³å°å¤ä¸ª promise å¯¹è±¡ç»åæä¸ä¸ªæ°ç promise å¯¹è±¡ï¼å¹¶å¨å¶ä¸­ä»»æä¸ä¸ª promise å¯¹è±¡åä¸º rejected ç¶ææ¶å°±ç«å³ç»æï¼ä»èå®ç°å¤ä¸ªå¼æ­¥æä½çå¹¶è¡å¤çã\n\nå¨ä½¿ç¨ promise è¿è¡å¼æ­¥ç¼ç¨æ¶ï¼å¯ä»¥å°å¼æ­¥æä½å°è£æä¸ä¸ªå½æ°ï¼å¹¶è¿åä¸ä¸ª promise å¯¹è±¡ï¼ä»èä½¿å¾å¼æ­¥æä½çä½¿ç¨æ´å ç®åãå¯è¯»æ§æ´å¥½ãæ­¤å¤ï¼å¨éåä½¿ç¨ async/await è¯­æ³æ¶ï¼promise å¯ä»¥æ´å æ¹ä¾¿å°è¿è¡å¼æ­¥æä½çè°ç¨åå¤çã\n\n\n# promise.all\n\nå¦ææ³è¦ async å½æ°ä¸­çå¤ä¸ª await æ¹æ³å¹¶åæ§è¡ï¼å¯ä»¥ä½¿ç¨ promise.all æ¹æ³å°è¿äº await æ¹æ³åè£æå¤ä¸ª promise å¯¹è±¡ï¼ç¶åä½¿ç¨ promise.all æ¹æ³ç­å¾ææ promise å¯¹è±¡çå®æï¼å¹¶å°å®ä»¬ç resolved å¼åå¹¶ä¸ºä¸ä¸ªæ°ç»è¿åã\n\nasync function getdata() {\n  const promises = [\n    fetch('https://example.com/data1.json'),\n    fetch('https://example.com/data2.json'),\n    fetch('https://example.com/data3.json')\n  ];\n  const responses = await promise.all(promises);\n  const data = await promise.all(responses.map(response => response.json()));\n  console.log(data);\n}\n\ngetdata();\n\n\nä½¿ç¨ promise.all æ¹æ³å¯ä»¥è®© async å½æ°ä¸­çå¤ä¸ª await æ¹æ³å¹¶åæ§è¡ï¼ä»èæé«å¼æ­¥ä»£ç çæ§è¡æçãéè¦æ³¨æçæ¯ï¼promise.all æ¹æ³ä¼ç­å¾ææ promise å¯¹è±¡çå®æï¼å¹¶å°å®ä»¬ç resolved å¼åå¹¶ä¸ºä¸ä¸ªæ°ç»è¿åï¼å æ­¤ï¼å¦æå¶ä¸­ä»»ä½ä¸ä¸ª promise å¯¹è±¡è¢« rejectedï¼promise.all æ¹æ³ä¼ç«å³è¿åä¸ä¸ª rejected ç¶æç promise å¯¹è±¡ï¼å¹¶å°è¯¥ promise å¯¹è±¡ç rejected å¼ä¼ éç» catch æ¹æ³å¤çã\n\nç¸æ¯ä¹ä¸ï¼å¦æå°å¤ä¸ª await æ¹æ³åå¼åæå¤ä¸ªè¯­å¥ï¼æ¯ä¸ª await æ¹æ³é½ä¼ç­å¾åä¸ä¸ª await æ¹æ³çå®æï¼ä»èå¯¼è´å¼æ­¥æä½çä¸²è¡æ§è¡ï¼æ§è¡æçè¾ä½ã\n\n\n# async/await\n\nasync å½æ°æ¯ es2017ï¼es8ï¼å¼å¥çæ°ç¹æ§ï¼å®åè®¸å¨å½æ°åé¢å ä¸ async å³é®å­ï¼å°æ®éå½æ°è½¬åä¸ºå¼æ­¥å½æ°ãå¼æ­¥å½æ°å¯ä»¥ä½¿ç¨ await å³é®å­ç­å¾ä¸ä¸ªå¼æ­¥æä½çå®æï¼å¹¶å°å¼æ­¥æä½çç»æè¿åç»è°ç¨èã\n\nawait æ¯ es2017ï¼es8ï¼å¼å¥çæ°ç¹æ§ï¼å®åªè½ç¨å¨ async å½æ°åé¨ï¼ç¨äºç­å¾ä¸ä¸ªè¿å promise å¯¹è±¡çè¡¨è¾¾å¼å®æï¼å¹¶è¿åè¯¥ promise å¯¹è±¡ç resolved å¼ãç®åæ¥è¯´ï¼await å¯ä»¥æåå½å async å½æ°çæ§è¡ï¼ç­å¾ä¸ä¸ªå¼æ­¥æä½å®æååç»§ç»­æ§è¡ã\n\nä½¿ç¨ await å³é®å­å¯ä»¥è®©å¼æ­¥æä½çä»£ç æ´æäºéè¯»åçè§£ï¼å ä¸ºå®å¯ä»¥å°å¼æ­¥ä»£ç è½¬åä¸ºç±»ä¼¼äºåæ­¥ä»£ç çå½¢å¼ï¼èä¸éè¦ä½¿ç¨åè°å½æ°æ promise é¾å¼è°ç¨çæ¹å¼æ¥å¤çå¼æ­¥æä½çç»æãåæ¶ï¼await å³é®å­ä¹å¯ä»¥ç¨äºå¤çå¼æ­¥ä»£ç ä¸­çéè¯¯ï¼å¯ä»¥ä½¿ç¨ try-catch è¯­å¥æè·å¼æ­¥æä½ä¸­çéè¯¯ã\n\n// await expression\n\nasync function getdata() {\n  const response = await fetch('https://example.com/data.json');\n  const data = await response.json();\n  console.log(data);\n}\n\ngetdata();\n\n\n\nå¶ä¸­ï¼expression æ¯ä¸ä¸ªè¿å promise å¯¹è±¡çè¡¨è¾¾å¼ãå¦æè¡¨è¾¾å¼ä¸æ¯ promise å¯¹è±¡ï¼åä¼è¢«èªå¨åè£æ promise å¯¹è±¡ï¼ç¶åè¿åä¸ä¸ª resolved ç¶æç promise å¯¹è±¡ã\n\nawait è¡¨è¾¾å¼çæ§è¡æµç¨å¦ä¸ï¼\n\n 1. å¦æ expression æ¯ä¸ä¸ªå·²ç» resolved ç promise å¯¹è±¡ï¼åç´æ¥è¿åè¯¥ promise å¯¹è±¡ç resolved å¼ã\n 2. å¦æ expression æ¯ä¸ä¸ªæªå®æç promise å¯¹è±¡ï¼å await è¡¨è¾¾å¼ä¼æåå½åå½æ°çæ§è¡ï¼ç´å° promise å¯¹è±¡åæ resolved ç¶æï¼ç¶åè¿åè¯¥ promise å¯¹è±¡ç resolved å¼ã\n 3. å¦æ expression æ¯ä¸ä¸ªé promise å¯¹è±¡ï¼å await è¡¨è¾¾å¼ä¼å°è¯¥å¯¹è±¡èªå¨åè£æ resolved ç¶æç promise å¯¹è±¡ï¼ç¶åè¿åè¯¥ promise å¯¹è±¡ç resolved å¼ã\n\nfunction getuserinfo(userid) {\n  return new promise((resolve, reject) => {\n    // æ¨¡æå¼æ­¥è¯·æ±ç¨æ·ä¿¡æ¯\n    settimeout(() => {\n      const userinfo = { id: userid, name: 'alice' };\n      if (userid === 1) {\n        resolve(userinfo);\n      } else {\n        reject(new error('user not found'));\n      }\n    }, 1000);\n  });\n}\n\n// è°ç¨å¼æ­¥æä½å½æ°å¹¶å¤çå¼æ­¥ç»æ\ngetuserinfo(1)\n  .then(userinfo => console.log(userinfo))\n  .catch(error => console.error(error));\n\ngetuserinfo(2)\n  .then(userinfo => console.log(userinfo))\n  .catch(error => console.error(error));\n\n\n\nfunction getuserinfo(userid) {\n  return new promise((resolve, reject) => {\n    // æ¨¡æå¼æ­¥è¯·æ±ç¨æ·ä¿¡æ¯\n    settimeout(() => {\n      const userinfo = { id: userid, name: 'alice' };\n      if (userid === 1) {\n        resolve(userinfo);\n      } else {\n        reject(new error('user not found'));\n      }\n    }, 1000);\n  });\n}\n\nasync function main() {\n  try {\n    // ç­å¾å¼æ­¥æä½å®æå¹¶è·åç»æ\n    const userinfo1 = await getuserinfo(1);\n    console.log(userinfo1);\n\n    // ç­å¾å¼æ­¥æä½å®æå¹¶è·åç»æ\n    const userinfo2 = await getuserinfo(2);\n    console.log(userinfo2);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n// è°ç¨å¼æ­¥æä½å½æ°å¹¶å¤çå¼æ­¥ç»æ\nmain();\n\n\n\nå¦æä¸ä½¿ç¨ async å³é®å­ï¼é£ä¹å½æ° main ä¸­çå¼æ­¥è°ç¨ getuserinfo å®éä¸æ¯åæ­¥æ§è¡çï¼å³ä¸ä¼ç­å¾å¼æ­¥æä½å®æå¹¶è¿åç»æï¼èæ¯ç´æ¥æ§è¡ä¸ä¸è¡ä»£ç ã\n\nå¨è¿ä¸ªä»£ç ä¸­ï¼æä»¬å¨è°ç¨ getuserinfo(1) å getuserinfo(2) æ¶å¹¶æ²¡æä½¿ç¨ .then() æ¹æ³æ await å³é®å­ç­å¾å¼æ­¥æä½å®æï¼èæ¯ç´æ¥æ promise å¯¹è±¡èµå¼ç» userinfo1 å userinfo2 åéãè¿æ ·åçé®é¢å¨äºï¼ç±äºå¼æ­¥æä½çæ§è¡éè¦ä¸å®çæ¶é´ï¼è¿äºåéå®éä¸æ¯è¿æ²¡æå¾å°å¼ç promise å¯¹è±¡ï¼èä¸æ¯æä»¬ææçç¨æ·ä¿¡æ¯å¯¹è±¡ã\n\nå æ­¤ï¼å¨ console.log(userinfo1) å console.log(userinfo2) ä¸­æå°çå®éä¸æ¯ promise å¯¹è±¡æ¬èº«ï¼èä¸æ¯ç¨æ·ä¿¡æ¯å¯¹è±¡ãæ­¤å¤ï¼ç±äº try...catch ååªè½æè·åæ­¥ä»£ç ä¸­çå¼å¸¸ï¼å æ­¤å¦æå¼æ­¥æä½æåºå¼å¸¸ï¼æä»¬æ æ³å¨ catch åä¸­æè·è¯¥å¼å¸¸ã\n\nä¸è¿°ä»£ç è¿åå¼çåºå«ï¼\n\n{ id: 1, name: 'alice' }\nerror: user not found\n    at timeout._ontimeout (file:///users/billy/projects/web/vite-project-test/src/promise-test.js:9:18)\n    at listontimeout (node:internal/timers:569:17)\n    at process.processtimers (node:internal/timers:512:7)\n\n\n// ä¸å  async/await\npromise { <pending> }\npromise { <pending> }\nfile:///users/billy/projects/web/vite-project-test/src/promise-test.js:9\n          reject(new error('user not found'));\n                 ^\n\nerror: user not found\n    at timeout._ontimeout (file:///users/billy/projects/web/vite-project-test/src/promise-test.js:9:18)\n    at listontimeout (node:internal/timers:569:17)\n    at process.processtimers (node:internal/timers:512:7)\n\n\n\n\n# åè°å½æ°\n\nåè°å½æ°æ¯ä¸ç§ä¼ éå½æ°ä½ä¸ºåæ°çç¼ç¨æ¨¡å¼ãå¨ javascript ä¸­ï¼åè°å½æ°å¸¸å¸¸è¢«ç¨äºå¼æ­¥ç¼ç¨ï¼å°å¼æ­¥æä½çç»æéè¿åè°å½æ°ä¼ éç»ä¸ä¸ä¸ªä»»å¡ãä¾å¦ï¼ä½¿ç¨ node.js çæä»¶è¯»åæ¹æ³ fs.readfile() è¿è¡æä»¶è¯»åæ¶ï¼å°±éè¦ä¼ å¥ä¸ä¸ªåè°å½æ°æ¥å¤çè¯»åç»æã\n\nconst fs = require('fs');\n\nfs.readfile('file.txt', 'utf8', function(err, data) {\n  if (err) throw err;\n  console.log(data);\n});\n\n\n\nå¨ä¸é¢çä»£ç ä¸­ï¼fs.readfile() æ¹æ³è¯»åæä»¶æ¶æ¯å¼æ­¥çï¼å®éè¦ä¼ å¥ä¸ä¸ªåè°å½æ°æ¥å¤çè¯»åç»æãåè°å½æ°å¨æä»¶è¯»åå®ææ¶è¢«è°ç¨ï¼ä¼ å¥ä¸¤ä¸ªåæ° err å dataï¼è¡¨ç¤ºè¯»åæä½æ¯å¦åºéä»¥åè¯»åçæä»¶åå®¹ã\n\nåè°å½æ°çç¼ºç¹æ¯ä¼äº§çåè°å°ç±é®é¢ï¼åµå¥è¿å¤çåè°å½æ°ä¼ä½¿ä»£ç åå¾é¾ä»¥éè¯»åç»´æ¤ã",charsets:{cjk:!0}},{title:"JWT",frontmatter:{title:"JWT",date:"2023-03-30T21:17:16.000Z",permalink:"/pages/jwt/"},regularPath:"/08.%E6%96%B9%E6%A1%88/01.JWT.html",relativePath:"08.æ¹æ¡/01.JWT.md",key:"v-10ca5dc4",path:"/pages/jwt/",headers:[{level:2,title:"JWTåsessionçåºå«",slug:"jwtåsessionçåºå«",normalizedTitle:"jwtåsessionçåºå«",charIndex:2},{level:2,title:"JWTçç»æ",slug:"jwtçç»æ",normalizedTitle:"jwtçç»æ",charIndex:200},{level:2,title:"å¦ä½é²æ­¢ Token è¢«ä¸²æ¹ï¼",slug:"å¦ä½é²æ­¢-token-è¢«ä¸²æ¹",normalizedTitle:"å¦ä½é²æ­¢ token è¢«ä¸²æ¹ï¼",charIndex:463}],headersStr:"JWTåsessionçåºå« JWTçç»æ å¦ä½é²æ­¢ Token è¢«ä¸²æ¹ï¼",content:'# JWTåsessionçåºå«\n\n 1. session å­å¨å¨æå¡ç«¯å ç¨æå¡å¨èµæºï¼è JWT å­å¨å¨å®¢æ·ç«¯\n 2. session å­å¨å¨ Cookie ä¸­ï¼å­å¨**ä¼ªé è·¨ç«è¯·æ±ä¼ªé æ»å»ï¼CSRFï¼**çé£é©\n 3. session åªå­å¨ä¸å°æå¡å¨ä¸ï¼é£ä¹ä¸æ¬¡è¯·æ±å°±å¿é¡»è¯·æ±è¿å°æå¡å¨ï¼ä¸å©äºåå¸å¼åºç¨\n 4. å­å¨å¨å®¢æ·ç«¯ç JWT æ¯å­å¨å¨æå¡ç«¯ç session æ´å·ææ©å±æ§\n\n\n# JWTçç»æ\n\nJWTç±ä¸é¨åç»æï¼header.payload.signature\n\nheader ä¸­æ¿è½½äºä¸¤é¨åä¿¡æ¯ï¼å£°æå å¯ç®æ³ãå£°æç±»å\n\npayload æ¯ä¸»ä½é¨åï¼æä¸ºè½½ä½ï¼æ¿è½½çææç JWT æ°æ®åï¼å®åå«ä¸ä¸ªé¨åï¼æ åå£°æãå¬å±å£°æãç§æå£°æ\n\nJWT ç Token ç¸å½æ¯ææï¼æ¯å¯ä»¥è§£å¯çï¼ä»»ä½å­å¨ payload çä¸è¥¿ï¼é½æ²¡æç§å¯å¯è¨ï¼æä»¥éç§æ°æ®ä¸è½ç­¾å tokenã\n\nsignature æ¯ç­¾è¯ä¿¡æ¯ï¼è¯¥ç­¾è¯ä¿¡æ¯æ¯éè¿headeråpayloadï¼å ä¸secretï¼éè¿ç®æ³å å¯çæã\n\n\n# å¦ä½é²æ­¢ Token è¢«ä¸²æ¹ï¼\n\nsignatureå­æ®µå°±æ¯å³é®äºï¼è½è¢«è§£å¯åºææçï¼åªæheaderåpayload\n\nåå¦é»å®¢/ä¸­é´äººä¸²æ¹äºpayloadï¼é£ä¹æå¡å¨å¯ä»¥éè¿signatureå»éªè¯æ¯å¦è¢«ç¯¡æ¹è¿ã\n\nå¨æå¡ç«¯å¨æ§è¡ä¸æ¬¡ signature = å å¯ç®æ³(header + "." + payload, å¯é¥);, ç¶åå¯¹æ¯ signature æ¯å¦ä¸è´ï¼å¦æä¸è´åè¯´ææ²¡æè¢«ç¯¡æ¹ã\n\næä»¥æå¡å¨çå¯é¥ä¸è½è¢«æ³æ¼ã\n\nåèï¼https://cnodejs.org/topic/5b0c4a7b8a4f51e140d942fc',normalizedContent:'# jwtåsessionçåºå«\n\n 1. session å­å¨å¨æå¡ç«¯å ç¨æå¡å¨èµæºï¼è jwt å­å¨å¨å®¢æ·ç«¯\n 2. session å­å¨å¨ cookie ä¸­ï¼å­å¨**ä¼ªé è·¨ç«è¯·æ±ä¼ªé æ»å»ï¼csrfï¼**çé£é©\n 3. session åªå­å¨ä¸å°æå¡å¨ä¸ï¼é£ä¹ä¸æ¬¡è¯·æ±å°±å¿é¡»è¯·æ±è¿å°æå¡å¨ï¼ä¸å©äºåå¸å¼åºç¨\n 4. å­å¨å¨å®¢æ·ç«¯ç jwt æ¯å­å¨å¨æå¡ç«¯ç session æ´å·ææ©å±æ§\n\n\n# jwtçç»æ\n\njwtç±ä¸é¨åç»æï¼header.payload.signature\n\nheader ä¸­æ¿è½½äºä¸¤é¨åä¿¡æ¯ï¼å£°æå å¯ç®æ³ãå£°æç±»å\n\npayload æ¯ä¸»ä½é¨åï¼æä¸ºè½½ä½ï¼æ¿è½½çææç jwt æ°æ®åï¼å®åå«ä¸ä¸ªé¨åï¼æ åå£°æãå¬å±å£°æãç§æå£°æ\n\njwt ç token ç¸å½æ¯ææï¼æ¯å¯ä»¥è§£å¯çï¼ä»»ä½å­å¨ payload çä¸è¥¿ï¼é½æ²¡æç§å¯å¯è¨ï¼æä»¥éç§æ°æ®ä¸è½ç­¾å tokenã\n\nsignature æ¯ç­¾è¯ä¿¡æ¯ï¼è¯¥ç­¾è¯ä¿¡æ¯æ¯éè¿headeråpayloadï¼å ä¸secretï¼éè¿ç®æ³å å¯çæã\n\n\n# å¦ä½é²æ­¢ token è¢«ä¸²æ¹ï¼\n\nsignatureå­æ®µå°±æ¯å³é®äºï¼è½è¢«è§£å¯åºææçï¼åªæheaderåpayload\n\nåå¦é»å®¢/ä¸­é´äººä¸²æ¹äºpayloadï¼é£ä¹æå¡å¨å¯ä»¥éè¿signatureå»éªè¯æ¯å¦è¢«ç¯¡æ¹è¿ã\n\nå¨æå¡ç«¯å¨æ§è¡ä¸æ¬¡ signature = å å¯ç®æ³(header + "." + payload, å¯é¥);, ç¶åå¯¹æ¯ signature æ¯å¦ä¸è´ï¼å¦æä¸è´åè¯´ææ²¡æè¢«ç¯¡æ¹ã\n\næä»¥æå¡å¨çå¯é¥ä¸è½è¢«æ³æ¼ã\n\nåèï¼https://cnodejs.org/topic/5b0c4a7b8a4f51e140d942fc',charsets:{cjk:!0}},{title:"OAuth2",frontmatter:{title:"OAuth2",date:"2023-03-30T21:32:12.000Z",permalink:"/pages/8cac0f/"},regularPath:"/08.%E6%96%B9%E6%A1%88/02.OAuth2.html",relativePath:"08.æ¹æ¡/02.OAuth2.md",key:"v-c92a649c",path:"/pages/8cac0f/",headers:[{level:2,title:"æ¥å¥Google OAuth2",slug:"æ¥å¥google-oauth2",normalizedTitle:"æ¥å¥google oauth2",charIndex:2}],headersStr:"æ¥å¥Google OAuth2",content:"# æ¥å¥Google OAuth2\n\nå¨ååç«¯åç¦»çæ¶æä¸­ï¼éå¸¸å»ºè®®å° OAuth2.0 æææµç¨çååé¨åï¼å³ç¨æ·ææï¼æ¾å¨åç«¯ï¼å°ååé¨åï¼å³è·åè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ï¼æ¾å¨åç«¯ãè¿æ ·å¯ä»¥å®ç°æ´å¥½çå®å¨æ§åå¯ç»´æ¤æ§ã\n\nå·ä½æ¥è¯´ï¼ä½ å¯ä»¥å¨åç«¯ä¸­ä½¿ç¨ Google æä¾ç JavaScript APIï¼å¨ç¨æ·ç¹å»ç»å½æé®æ¶å¼¹åº Google çææé¡µé¢ï¼è®©ç¨æ·ææä½ çåºç¨è®¿é®å¶ Google è´¦å·ãæææååï¼Google å°ä¼éå®åå°ä½ äºåæå®çåè° URLï¼éå¸¸æ¯åç«¯æä¾çä¸ä¸ª URLï¼ï¼å¹¶å¸¦ä¸ä¸ä¸ªææä»£ç ã\n\nå¨åç«¯ä¸­ï¼ä½ å¯ä»¥ä½¿ç¨ OAuth2.0 åºï¼ä¾å¦ Passport æ Grantï¼æ¥å¤ç Google çææä»£ç ï¼ä»¥è·åè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ãç¶åï¼ä½ å¯ä»¥å°ç¨æ·ä¿¡æ¯å­å¨å¨æ°æ®åºä¸­ï¼æä½¿ç¨ JWT çæä¸ä¸ªå å¯çè®¿é®ä»¤çï¼å°å¶è¿åç»åç«¯ãåç«¯å¯ä»¥å°è¿ä¸ªè®¿é®ä»¤çå­å¨å¨æ¬å°ï¼ä¾å¦ LocalStorageï¼ï¼å¹¶å¨åç»­ç API è¯·æ±ä¸­æºå¸¦è¿ä¸ªä»¤çï¼ä»¥è¯æç¨æ·çèº«ä»½ã\n\néè¦æ³¨æçæ¯ï¼OAuth2.0 æææµç¨æ¶åå°ææä¿¡æ¯ï¼ä¾å¦ Google è´¦å·çè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ï¼ï¼å æ­¤å¿é¡»éåä¸å®çå®å¨æªæ½ï¼ä»¥é²æ­¢ä¿¡æ¯æ³é²åæ»å»ãä¾å¦ï¼ä½ å¯ä»¥ä½¿ç¨ HTTPS æ¥å å¯éä¿¡ï¼ä½¿ç¨ CORS æ¥éå¶è·¨åè®¿é®ï¼ä½¿ç¨ CSRF token æ¥é²æ­¢ CSRF æ»å»ç­ã\n\n\ncodeï¼https://github.com/0xMALVEE/mern-login-system-2022",normalizedContent:"# æ¥å¥google oauth2\n\nå¨ååç«¯åç¦»çæ¶æä¸­ï¼éå¸¸å»ºè®®å° oauth2.0 æææµç¨çååé¨åï¼å³ç¨æ·ææï¼æ¾å¨åç«¯ï¼å°ååé¨åï¼å³è·åè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ï¼æ¾å¨åç«¯ãè¿æ ·å¯ä»¥å®ç°æ´å¥½çå®å¨æ§åå¯ç»´æ¤æ§ã\n\nå·ä½æ¥è¯´ï¼ä½ å¯ä»¥å¨åç«¯ä¸­ä½¿ç¨ google æä¾ç javascript apiï¼å¨ç¨æ·ç¹å»ç»å½æé®æ¶å¼¹åº google çææé¡µé¢ï¼è®©ç¨æ·ææä½ çåºç¨è®¿é®å¶ google è´¦å·ãæææååï¼google å°ä¼éå®åå°ä½ äºåæå®çåè° urlï¼éå¸¸æ¯åç«¯æä¾çä¸ä¸ª urlï¼ï¼å¹¶å¸¦ä¸ä¸ä¸ªææä»£ç ã\n\nå¨åç«¯ä¸­ï¼ä½ å¯ä»¥ä½¿ç¨ oauth2.0 åºï¼ä¾å¦ passport æ grantï¼æ¥å¤ç google çææä»£ç ï¼ä»¥è·åè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ãç¶åï¼ä½ å¯ä»¥å°ç¨æ·ä¿¡æ¯å­å¨å¨æ°æ®åºä¸­ï¼æä½¿ç¨ jwt çæä¸ä¸ªå å¯çè®¿é®ä»¤çï¼å°å¶è¿åç»åç«¯ãåç«¯å¯ä»¥å°è¿ä¸ªè®¿é®ä»¤çå­å¨å¨æ¬å°ï¼ä¾å¦ localstorageï¼ï¼å¹¶å¨åç»­ç api è¯·æ±ä¸­æºå¸¦è¿ä¸ªä»¤çï¼ä»¥è¯æç¨æ·çèº«ä»½ã\n\néè¦æ³¨æçæ¯ï¼oauth2.0 æææµç¨æ¶åå°ææä¿¡æ¯ï¼ä¾å¦ google è´¦å·çè®¿é®ä»¤çåç¨æ·ä¿¡æ¯ï¼ï¼å æ­¤å¿é¡»éåä¸å®çå®å¨æªæ½ï¼ä»¥é²æ­¢ä¿¡æ¯æ³é²åæ»å»ãä¾å¦ï¼ä½ å¯ä»¥ä½¿ç¨ https æ¥å å¯éä¿¡ï¼ä½¿ç¨ cors æ¥éå¶è·¨åè®¿é®ï¼ä½¿ç¨ csrf token æ¥é²æ­¢ csrf æ»å»ç­ã\n\n\ncodeï¼https://github.com/0xmalvee/mern-login-system-2022",charsets:{cjk:!0}},{title:"CORSçè§£å³æ¹æ¡",frontmatter:{title:"CORSçè§£å³æ¹æ¡",date:"2023-03-30T21:34:40.000Z",permalink:"/pages/fcd0f1/"},regularPath:"/08.%E6%96%B9%E6%A1%88/03.CORS%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.html",relativePath:"08.æ¹æ¡/03.CORSçè§£å³æ¹æ¡.md",key:"v-76c98d70",path:"/pages/fcd0f1/",headers:[{level:2,title:"ä½¿ç¨ä»£ç",slug:"ä½¿ç¨ä»£ç",normalizedTitle:"ä½¿ç¨ä»£ç",charIndex:118},{level:2,title:"è®¾ç½® CORS å¤´",slug:"è®¾ç½®-cors-å¤´",normalizedTitle:"è®¾ç½® cors å¤´",charIndex:242},{level:3,title:"spring cloud å¯å¨ gateway ä¸­ç»ä¸éç½®",slug:"spring-cloud-å¯å¨-gateway-ä¸­ç»ä¸éç½®",normalizedTitle:"spring cloud å¯å¨ gateway ä¸­ç»ä¸éç½®",charIndex:1024},{level:2,title:"JSONP",slug:"jsonp",normalizedTitle:"jsonp",charIndex:1557}],headersStr:"ä½¿ç¨ä»£ç è®¾ç½® CORS å¤´ spring cloud å¯å¨ gateway ä¸­ç»ä¸éç½® JSONP",content:'CORSï¼è·¨åèµæºå±äº«ï¼æ¯æµè§å¨ä¸­çä¸ç§å®å¨æºå¶ï¼ç¨äºéå¶ä»ä¸ä¸ªååä¸çç½é¡µå»è¯·æ±å¦ä¸ä¸ªååä¸çèµæºï¼ä»¥ä¿æ¤ç¨æ·çä¿¡æ¯å®å¨ãå¦æå¨åç«¯ä»£ç ä¸­ç´æ¥åéè·¨åè¯·æ±ï¼å¯è½ä¼é­å°æµè§å¨çæ¦æªï¼å¯¼è´è¯·æ±å¤±è´¥ã\n\nä»¥ä¸æ¯å ç§å¸¸è§çè§£å³æ¹æ¡ï¼\n\n\n# ä½¿ç¨ä»£ç\n\nå¯ä»¥å¨åç«¯ä»£ç ä¸­åéè¯·æ±å°åç«¯èªå·±çåç«¯æå¡å¨ï¼ç±åç«¯æå¡å¨ä»£çå°éè¦è¯·æ±çæå¡å¨ä¸ï¼è¿æ ·å°±å¯ä»¥é¿åç´æ¥å¨åç«¯åéè·¨åè¯·æ±äºãä»£ççå·ä½å®ç°å¯ä»¥ä½¿ç¨ Node.js ä¸­ç http-proxy-middleware ç­ä¸­é´ä»¶ã\n\n\n# è®¾ç½® CORS å¤´\n\nå¦æéè¦å¨åç«¯ç´æ¥åéè·¨åè¯·æ±ï¼å¯ä»¥å¨æå¡å¨ç«¯è®¾ç½® CORS å¤´æ¥åè®¸è·¨åè¯·æ±ãCORS å¤´æçæ¯ HTTP ååºå¤´ä¸­çä¸ç»å­æ®µï¼ç¨äºåç¥æµè§å¨è¯¥èµæºæ¯å¦åè®¸è·¨åè®¿é®ãä¸è¬æ¥è¯´ï¼CORS å¤´åæ¬ä»¥ä¸å­æ®µï¼\n\n * Access-Control-Allow-Originï¼æå®åè®¸è®¿é®è¯¥èµæºçååï¼\n * Access-Control-Allow-Credentialsï¼æå®æ¯å¦åè®¸åéå­è¯ä¿¡æ¯ï¼ä¾å¦ Cookieï¼\n * Access-Control-Allow-Methodsï¼æå®åè®¸ç HTTP æ¹æ³ï¼\n * Access-Control-Allow-Headersï¼æå®åè®¸çèªå®ä¹è¯·æ±å¤´ã\n\nå¨æå¡å¨ç«¯ï¼å¯ä»¥æ ¹æ®è¯·æ±å¤´ä¸­ç Origin å­æ®µæ¥å¤æ­æ¯å¦æ¯è·¨åè¯·æ±ï¼å¹¶å¨ååºå¤´ä¸­è®¾ç½®å¯¹åºç CORS å¤´ï¼ç¤ºä¾ä»£ç å¦ä¸ï¼\n\n@Configuration\npublic class WebConfig implements WebMvcConfigurer {\n  @Override\n  public void addCorsMappings(CorsRegistry registry) {\n    // åè®¸ææååè·¨åè®¿é®ï¼ä¹å¯ä»¥æ ¹æ®å®éæåµæå®åè®¸çåå\n    registry.addMapping("/api/**")\n            .allowedOrigins("*")\n            .allowedMethods("GET", "POST", "PUT", "DELETE")\n            .allowedHeaders("*")\n            .allowCredentials(true)\n            .maxAge(3600);\n  }\n}\n\n\n\n# spring cloud å¯å¨ gateway ä¸­ç»ä¸éç½®\n\n# application.properties\n\n# åè®¸è¯·æ±æ¥æºï¼èçæ¬å«allowedOriginï¼\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedOriginPatterns=*\n# åè®¸æºå¸¦çå¤´ä¿¡æ¯\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedHeaders=*\n# åè®¸çè¯·æ±æ¹å¼\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedMethods=*\n# æ¯å¦åè®¸æºå¸¦cookie\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowCredentials=true\n# è·¨åæ£æµçæææï¼ä¼åèµ·ä¸ä¸ªOPTIONè¯·æ±\nspring.cloud.gateway.globalcors.cors-configurations.[/**].maxAge=3600\n\n\n\n# JSONP\n\nJSONP æ¯ä¸ç§å©ç¨ <script> æ ç­¾æ¥å®ç°è·¨åæ°æ®ä¼ è¾çæ¹å¼ãéè¿å¨å®¢æ·ç«¯å¨æåå»º <script> æ ç­¾ï¼è®¾ç½®å¶ src å±æ§ä¸ºè·¨åç URLï¼ç¶åå¨æå¡ç«¯è¿åä¸æ®µ JavaScript ä»£ç ï¼è¯¥ä»£ç ä¼è¢«å®¢æ·ç«¯å½åèæ¬æ§è¡ãç±äº <script> æ ç­¾æ²¡æåæºç­ç¥éå¶ï¼å æ­¤å¯ä»¥ç¨æ¥è·¨åè·åæ°æ®ã\n\nJSONPï¼JSON with Paddingï¼æ¯ä¸ç§è·¨åè§£å³æ¹æ¡ï¼å®å©ç¨äº HTML ä¸­ç script æ ç­¾ä¸ååæºç­ç¥éå¶çç¹ç¹ï¼éè¿å¨å®¢æ·ç«¯å¨æåå»º script æ ç­¾ï¼å®ç°ä»å¦ä¸ä¸ªååï¼æèåä¸ä¸ªååçä¸åç«¯å£ï¼è·åæ°æ®ã\n\nå·ä½æ¥è¯´ï¼JSONP çå®ç°æµç¨å¦ä¸ï¼\n\n 1. å®¢æ·ç«¯åéè¯·æ±ï¼è¯·æ±ç URL åå«ä¸ä¸ªåè°å½æ°åï¼ä¾å¦ï¼http://example.com/data?callback=handleDataã\n 2. æå¡ç«¯æ¥æ¶è¯·æ±åï¼å°æ°æ®åè£æ JSON æ ¼å¼ï¼å¹¶ç¨åè°å½æ°ååè£¹èµ·æ¥ï¼ä¾å¦ï¼handleData({"name": "Tom", "age": 20})ã\n 3. æå¡ç«¯å°åè£¹åçæ°æ®è¿åç»å®¢æ·ç«¯ã\n 4. å®¢æ·ç«¯æ¶å°ååºåï¼ä¼å°ååºçåå®¹å½å script ä»£ç æ§è¡ï¼ä»èè°ç¨åè°å½æ°ï¼å¹¶ä¼ å¥åè£¹çæ°æ®ä½ä¸ºåæ°ã\n 5. å®¢æ·ç«¯å¨åè°å½æ°ä¸­å¤çæ°æ®ã\n\nç±äº script æ ç­¾ä¸ååæºç­ç¥éå¶ï¼å æ­¤ JSONP å¯ä»¥è·¨åè®¿é®æ°æ®ãåæ¶ï¼JSONP åªæ¯æ GET è¯·æ±ï¼ä¸éè¦æå¡å¨ç«¯æ¯æ JSONP æ ¼å¼çæ°æ®è¿åã\n\nè½ç¶ JSONP å¨è§£å³è·¨åé®é¢ä¸æ¯è¾æ¹ä¾¿ï¼ä½ä¹å­å¨ä¸äºå®å¨é£é©ï¼ä¾å¦å®¹æåå° XSS æ»å»ï¼å ä¸ºè¿åçæ°æ®æ¯å¯ä»¥è¢«æ§è¡çèæ¬ãå æ­¤ï¼ç°å¨ä¸è¬æ¨èä½¿ç¨è®¾ç½® CORS å¤´çæ¹å¼æ¥è§£å³è·¨åé®é¢ã\n\nJSONPç¤ºä¾ä»£ç ï¼\n\nfunction handleData(data) {\n  console.log(data); // å¤çè·åå°çæ°æ®\n}\n\nconst script = document.createElement(\'script\');\nscript.src = \'http://example.com/data?callback=handleData\';\ndocument.body.appendChild(script);\n\n\nconst data = {"name": "Tom", "age": 20};\nconst callback = req.query.callback;\nres.send(`${callback}(${JSON.stringify(data)})`);\n',normalizedContent:'corsï¼è·¨åèµæºå±äº«ï¼æ¯æµè§å¨ä¸­çä¸ç§å®å¨æºå¶ï¼ç¨äºéå¶ä»ä¸ä¸ªååä¸çç½é¡µå»è¯·æ±å¦ä¸ä¸ªååä¸çèµæºï¼ä»¥ä¿æ¤ç¨æ·çä¿¡æ¯å®å¨ãå¦æå¨åç«¯ä»£ç ä¸­ç´æ¥åéè·¨åè¯·æ±ï¼å¯è½ä¼é­å°æµè§å¨çæ¦æªï¼å¯¼è´è¯·æ±å¤±è´¥ã\n\nä»¥ä¸æ¯å ç§å¸¸è§çè§£å³æ¹æ¡ï¼\n\n\n# ä½¿ç¨ä»£ç\n\nå¯ä»¥å¨åç«¯ä»£ç ä¸­åéè¯·æ±å°åç«¯èªå·±çåç«¯æå¡å¨ï¼ç±åç«¯æå¡å¨ä»£çå°éè¦è¯·æ±çæå¡å¨ä¸ï¼è¿æ ·å°±å¯ä»¥é¿åç´æ¥å¨åç«¯åéè·¨åè¯·æ±äºãä»£ççå·ä½å®ç°å¯ä»¥ä½¿ç¨ node.js ä¸­ç http-proxy-middleware ç­ä¸­é´ä»¶ã\n\n\n# è®¾ç½® cors å¤´\n\nå¦æéè¦å¨åç«¯ç´æ¥åéè·¨åè¯·æ±ï¼å¯ä»¥å¨æå¡å¨ç«¯è®¾ç½® cors å¤´æ¥åè®¸è·¨åè¯·æ±ãcors å¤´æçæ¯ http ååºå¤´ä¸­çä¸ç»å­æ®µï¼ç¨äºåç¥æµè§å¨è¯¥èµæºæ¯å¦åè®¸è·¨åè®¿é®ãä¸è¬æ¥è¯´ï¼cors å¤´åæ¬ä»¥ä¸å­æ®µï¼\n\n * access-control-allow-originï¼æå®åè®¸è®¿é®è¯¥èµæºçååï¼\n * access-control-allow-credentialsï¼æå®æ¯å¦åè®¸åéå­è¯ä¿¡æ¯ï¼ä¾å¦ cookieï¼\n * access-control-allow-methodsï¼æå®åè®¸ç http æ¹æ³ï¼\n * access-control-allow-headersï¼æå®åè®¸çèªå®ä¹è¯·æ±å¤´ã\n\nå¨æå¡å¨ç«¯ï¼å¯ä»¥æ ¹æ®è¯·æ±å¤´ä¸­ç origin å­æ®µæ¥å¤æ­æ¯å¦æ¯è·¨åè¯·æ±ï¼å¹¶å¨ååºå¤´ä¸­è®¾ç½®å¯¹åºç cors å¤´ï¼ç¤ºä¾ä»£ç å¦ä¸ï¼\n\n@configuration\npublic class webconfig implements webmvcconfigurer {\n  @override\n  public void addcorsmappings(corsregistry registry) {\n    // åè®¸ææååè·¨åè®¿é®ï¼ä¹å¯ä»¥æ ¹æ®å®éæåµæå®åè®¸çåå\n    registry.addmapping("/api/**")\n            .allowedorigins("*")\n            .allowedmethods("get", "post", "put", "delete")\n            .allowedheaders("*")\n            .allowcredentials(true)\n            .maxage(3600);\n  }\n}\n\n\n\n# spring cloud å¯å¨ gateway ä¸­ç»ä¸éç½®\n\n# application.properties\n\n# åè®¸è¯·æ±æ¥æºï¼èçæ¬å«allowedoriginï¼\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedoriginpatterns=*\n# åè®¸æºå¸¦çå¤´ä¿¡æ¯\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedheaders=*\n# åè®¸çè¯·æ±æ¹å¼\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowedmethods=*\n# æ¯å¦åè®¸æºå¸¦cookie\nspring.cloud.gateway.globalcors.cors-configurations.[/**].allowcredentials=true\n# è·¨åæ£æµçæææï¼ä¼åèµ·ä¸ä¸ªoptionè¯·æ±\nspring.cloud.gateway.globalcors.cors-configurations.[/**].maxage=3600\n\n\n\n# jsonp\n\njsonp æ¯ä¸ç§å©ç¨ <script> æ ç­¾æ¥å®ç°è·¨åæ°æ®ä¼ è¾çæ¹å¼ãéè¿å¨å®¢æ·ç«¯å¨æåå»º <script> æ ç­¾ï¼è®¾ç½®å¶ src å±æ§ä¸ºè·¨åç urlï¼ç¶åå¨æå¡ç«¯è¿åä¸æ®µ javascript ä»£ç ï¼è¯¥ä»£ç ä¼è¢«å®¢æ·ç«¯å½åèæ¬æ§è¡ãç±äº <script> æ ç­¾æ²¡æåæºç­ç¥éå¶ï¼å æ­¤å¯ä»¥ç¨æ¥è·¨åè·åæ°æ®ã\n\njsonpï¼json with paddingï¼æ¯ä¸ç§è·¨åè§£å³æ¹æ¡ï¼å®å©ç¨äº html ä¸­ç script æ ç­¾ä¸ååæºç­ç¥éå¶çç¹ç¹ï¼éè¿å¨å®¢æ·ç«¯å¨æåå»º script æ ç­¾ï¼å®ç°ä»å¦ä¸ä¸ªååï¼æèåä¸ä¸ªååçä¸åç«¯å£ï¼è·åæ°æ®ã\n\nå·ä½æ¥è¯´ï¼jsonp çå®ç°æµç¨å¦ä¸ï¼\n\n 1. å®¢æ·ç«¯åéè¯·æ±ï¼è¯·æ±ç url åå«ä¸ä¸ªåè°å½æ°åï¼ä¾å¦ï¼http://example.com/data?callback=handledataã\n 2. æå¡ç«¯æ¥æ¶è¯·æ±åï¼å°æ°æ®åè£æ json æ ¼å¼ï¼å¹¶ç¨åè°å½æ°ååè£¹èµ·æ¥ï¼ä¾å¦ï¼handledata({"name": "tom", "age": 20})ã\n 3. æå¡ç«¯å°åè£¹åçæ°æ®è¿åç»å®¢æ·ç«¯ã\n 4. å®¢æ·ç«¯æ¶å°ååºåï¼ä¼å°ååºçåå®¹å½å script ä»£ç æ§è¡ï¼ä»èè°ç¨åè°å½æ°ï¼å¹¶ä¼ å¥åè£¹çæ°æ®ä½ä¸ºåæ°ã\n 5. å®¢æ·ç«¯å¨åè°å½æ°ä¸­å¤çæ°æ®ã\n\nç±äº script æ ç­¾ä¸ååæºç­ç¥éå¶ï¼å æ­¤ jsonp å¯ä»¥è·¨åè®¿é®æ°æ®ãåæ¶ï¼jsonp åªæ¯æ get è¯·æ±ï¼ä¸éè¦æå¡å¨ç«¯æ¯æ jsonp æ ¼å¼çæ°æ®è¿åã\n\nè½ç¶ jsonp å¨è§£å³è·¨åé®é¢ä¸æ¯è¾æ¹ä¾¿ï¼ä½ä¹å­å¨ä¸äºå®å¨é£é©ï¼ä¾å¦å®¹æåå° xss æ»å»ï¼å ä¸ºè¿åçæ°æ®æ¯å¯ä»¥è¢«æ§è¡çèæ¬ãå æ­¤ï¼ç°å¨ä¸è¬æ¨èä½¿ç¨è®¾ç½® cors å¤´çæ¹å¼æ¥è§£å³è·¨åé®é¢ã\n\njsonpç¤ºä¾ä»£ç ï¼\n\nfunction handledata(data) {\n  console.log(data); // å¤çè·åå°çæ°æ®\n}\n\nconst script = document.createelement(\'script\');\nscript.src = \'http://example.com/data?callback=handledata\';\ndocument.body.appendchild(script);\n\n\nconst data = {"name": "tom", "age": 20};\nconst callback = req.query.callback;\nres.send(`${callback}(${json.stringify(data)})`);\n',charsets:{cjk:!0}},{title:"çæ§ç³»ç»éåè°ç ",frontmatter:{title:"çæ§ç³»ç»éåè°ç ",date:"2023-03-31T17:01:44.000Z",permalink:"/pages/95c00f/"},regularPath:"/08.%E6%96%B9%E6%A1%88/04.%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E9%80%89%E5%9E%8B%E8%B0%83%E7%A0%94.html",relativePath:"08.æ¹æ¡/04.çæ§ç³»ç»éåè°ç .md",key:"v-ab00c88e",path:"/pages/95c00f/",headers:[{level:2,title:"çæ§ç³»ç»çä½ç¨",slug:"çæ§ç³»ç»çä½ç¨",normalizedTitle:"çæ§ç³»ç»çä½ç¨",charIndex:2},{level:2,title:"å¦ä½ä½¿ç¨çæ§ç³»ç»",slug:"å¦ä½ä½¿ç¨çæ§ç³»ç»",normalizedTitle:"å¦ä½ä½¿ç¨çæ§ç³»ç»",charIndex:91},{level:2,title:"çæ§å¯¹è±¡åææ ",slug:"çæ§å¯¹è±¡åææ ",normalizedTitle:"çæ§å¯¹è±¡åææ ",charIndex:248},{level:2,title:"ä¸»æµçæ§ç³»ç»",slug:"ä¸»æµçæ§ç³»ç»",normalizedTitle:"ä¸»æµçæ§ç³»ç»",charIndex:874},{level:2,title:"Spring Boot Admin",slug:"spring-boot-admin",normalizedTitle:"spring boot admin",charIndex:1060},{level:2,title:"éåå»ºè®®",slug:"éåå»ºè®®",normalizedTitle:"éåå»ºè®®",charIndex:1391},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1862}],headersStr:"çæ§ç³»ç»çä½ç¨ å¦ä½ä½¿ç¨çæ§ç³»ç» çæ§å¯¹è±¡åææ  ä¸»æµçæ§ç³»ç» Spring Boot Admin éåå»ºè®® åè",content:"# çæ§ç³»ç»çä½ç¨\n\n * å®æ¶ééçæ§æ°æ®\n * å®æ¶åé¦çæ§ç¶æ\n * é¢ç¥æéååè­¦\n * è¾å©å®ä½æé\n * è¾å©æ§è½è°ä¼\n * è¾å©å®¹éè§å\n * è¾å©èªå¨åè¿ç»´\n\n\n# å¦ä½ä½¿ç¨çæ§ç³»ç»\n\n * äºè§£çæ§å¯¹è±¡çå·¥ä½åç\n   * æ¯å¦æ³å¯¹JVMè¿è¡çæ§ï¼å°±å¿é¡»æ¸æ¥JVMçå åå­ç»æååå¾åæ¶æºå¶ã\n * ç¡®å®çæ§å¯¹è±¡çææ \n   * æ¯å¦æ³å¯¹æä¸ªæ¥å£è¿è¡çæ§ï¼å¯ä»¥éç¨è¯·æ±éãèæ¶ãè¶æ¶éãå¼å¸¸éç­ææ æ¥è¡¡éã\n * å®ä¹åççæ¥è­¦éå¼åç­çº§\n * å»ºç«å®åçæéå¤çæµç¨\n\n\n# çæ§å¯¹è±¡åææ \n\n * ç¡¬ä»¶çæ§\n   * çµæºãCPUãæºå¨æ¸©åº¦ãé£æãç©çç£çãraidãåå­ãç½å¡\n * æå¡å¨åºç¡çæ§\n   * CPUï¼åä¸ªCPUä»¥åæ´ä½çä½¿ç¨æåµ\n   * åå­ï¼å·²ç¨åå­ãå¯ç¨åå­\n   * ç£çï¼ç£çä½¿ç¨çãç£çè¯»åçååé\n   * ç½ç»ï¼åºå£æµéãå¥å£æµéãTCPè¿æ¥ç¶æ\n * æ°æ®åºçæ§\n   * æ°æ®åºè¿æ¥æ°\n   * QPSãTPS\n   * å¹¶è¡å¤ççä¼è¯æ°\n   * ç¼å­å½ä¸­ç\n   * ä¸»ä»æ¶å»¶\n   * éç¶æ\n   * æ¢æ¥è¯¢\n * ä¸­é´ä»¶çæ§\n   * Nginxï¼æ´»è·è¿æ¥æ°ãç­å¾ãè¿æ¥æ°ãä¸¢å¼è¿æ¥æ°ãè¯·æ±éãèæ¶ã5XXéè¯¯ç\n   * Tomcatï¼æå¤§çº¿ç¨æ°ãå½åçº¿ç¨æ°ãè¯·æ±éãèæ¶ãéè¯¯éãå åå­ä½¿ç¨æåµãGCæ¬¡æ°åèæ¶\n   * ç¼å­ï¼æåè¿æ¥æ°ãé»å¡è¿æ¥æ°ãå·²ä½¿ç¨åå­ãåå­ç¢ççãè¯·æ±éãèæ¶ãç¼å­å½ä¸­ç\n   * æ¶æ¯éåï¼è¿æ¥æ°ãéåæ°ãçæéçãæ¶è´¹éçãæ¶æ¯å ç§¯é\n * åºç¨çæ§\n   * HTTPæ¥å£ï¼URLå­æ´»ãè¯·æ±éãèæ¶ãå¼å¸¸é\n   * RPCæ¥å£ï¼è¯·æ±éãèæ¶ãè¶æ¶éãæç»é\n   * JVMï¼GCæ¬¡æ°ãGCèæ¶ãåä¸ªåå­åºåçå¤§å°ãå½åçº¿ç¨æ°ãæ­»éçº¿ç¨æ°\n   * çº¿ç¨æ± ï¼æ´»è·çº¿ç¨æ°ãä»»å¡éåå¤§å°ãä»»å¡æ§è¡èæ¶ãæç»ä»»å¡æ°\n   * è¿æ¥æ± ï¼æ»è¿æ¥æ°ãæ´»è·è¿æ¥æ°\n   * æ¥å¿çæ§ï¼è®¿é®æ¥å¿ãéè¯¯æ¥å¿\n   * ä¸å¡ææ ï¼å¦PVãè®¢åé\n\n\n# ä¸»æµçæ§ç³»ç»\n\nèççæ§ç³»ç»ï¼\n\n * Zabbix\n * Nagios\n * Cacti\n * Ganglia\n * Garafana\n\næ°ä¸ä»£çæ§ç³»ç»ï¼\n\n * Open-Falconï¼èªå¨ééï¼åªè¦å®è£äºfalcon-agentçæºå¨ï¼å°±ä¼èªå¨å¼å§ééåé¡¹ææ ï¼ä¸»å¨ä¸æ¥ï¼ä¸éè¦ç¨æ·å¨serveråä»»ä½éç½®ï¼\n * Prometheusï¼éç¨pullæ¨¡å¼ï¼\n\n\n# Spring Boot Admin\n\nå¯ä»¥çæ§spring-booté¡¹ç®çåºæ¬ä¿¡æ¯æ¯å¦ï¼Springå®¹å¨ç®¡ççææçbeanãè¯¦ç»çHealthä¿¡æ¯ãåå­ä¿¡æ¯ãJVMä¿¡æ¯ãåå¾åæ¶ä¿¡æ¯ãåç§éç½®ä¿¡æ¯ï¼æ¯å¦æ°æ®æºãç¼å­åè¡¨åå½ä¸­çï¼ç­ï¼Threads çº¿ç¨ç®¡çï¼Environment ç®¡çç­ã\n\næ¯æå¤ç§åè­¦æ¹å¼æ¥å¥ï¼å¦ä¼ä¸å¾®ä¿¡ãééãé®ä»¶ãç­ä¿¡ã\n\nå¯æ»¡è¶³spring booté¡¹ç®è½»éçº§çä½¿ç¨ã\n\nå¨SBAä¸­ï¼Serverä½ä¸ºæ³¨åä¸­å¿ï¼çæ§ææå®¢æ·ç«¯å½åçç¶æï¼æå¡ç«¯åå®¢æ·ç«¯ä¹é´éè¿/healthæ¥å£è¿è¡éä¿¡ï¼ä¾æ¬¡æ¥å¯¹å®¢æ·ç«¯è¿è¡çå¬ãæå¡ç«¯éè¿å®æ¶è½®è¯¢å®¢æ·ç«¯ç/healthæ¥å£æ¥å¯¹å®¢æ·ç«¯è¿è¡å¿ææ£æµã\n\nå®¢æ·ç«¯éè¿ Actuator è·åä¿¡æ¯ã\n\n\n# éåå»ºè®®\n\n * é¦åè¦æç¡®éæ±ï¼è¦çæ§çå¯¹è±¡æåªäºï¼æºå¨æ°éåçæ§ææ æå¤å°ï¼éè¦å·å¤ä»ä¹æ ·çåè½ã\n * ä¸è¦æ³ä¸å¼å§å°±all in oneï¼ä»ææ¬èèï¼åæç´æ¥ä½¿ç¨å¼æºçæ¹æ¡å³å¯ï¼è§£å³ä»æ å°æã\n * Zabbixå¨æå¡å¨çæ§æ¹é¢å ç»å¯¹ä¼å¿ï¼ä½å¯¹åºç¨å±çæ§å¹¶ä¸æé¿ãè¿ç¹Open-FalconåPrometheusåçæ¯è¾å¥½ã\n * æ°ä¸ä»£çæ§ç³»ç»çææ¾ä¼å¿ï¼çµæ´»çæ°æ®æ¨¡åï¼æ´æççæ¶åºæ°æ®åºï¼å¼ºå¤§çåè­¦åè½ãå¦ææ²¡æå¯¹èççæ§ç³»ç»çææ¯ç§¯ç´¯çè¯ï¼å»ºè®®ç´æ¥ä½¿ç¨Open-FalconæPrometheusã\n * Open-Falconçæ ¸å¿ä¼å¿å¨äºæ°æ®åçåè½ï¼è½æ¯ææ´å¤çæºå¨åçæ§é¡¹ï¼Prometheusåæ¯å®¹å¨çæ§æ¹é¢çæ éï¼æGoogleåk8så æã\n * ZabbixãOpen-FalconåPrometheusé½æ¯æåGrafanaåå¿«ééæï¼æ³è¦ç¾è§ä¸å¼ºå¤§çå¯è§åä½éªï¼å¯ä»¥åGrafanaè¿è¡ç»åã\n * è½»éçº§ä½¿ç¨ï¼å¯ä½¿ç¨SBAï¼å¹¶å¯å¯¹å¶æ©å±ã\n * Prometheus ä¹å¯ä»¥éæ©ä¹°é¿éäºçäº§åã\n\n\n# åè\n\n 1. https://www.daimajiaoliu.com/daima/7b7376aeb0be805\n 2. https://cloud.tencent.com/developer/article/1704555\n 3. https://xie.infoq.cn/article/e1d2ad0d57d9fc6b2bb8fd6a5\n 4. https://github.com/codecentric/spring-boot-admin",normalizedContent:"# çæ§ç³»ç»çä½ç¨\n\n * å®æ¶ééçæ§æ°æ®\n * å®æ¶åé¦çæ§ç¶æ\n * é¢ç¥æéååè­¦\n * è¾å©å®ä½æé\n * è¾å©æ§è½è°ä¼\n * è¾å©å®¹éè§å\n * è¾å©èªå¨åè¿ç»´\n\n\n# å¦ä½ä½¿ç¨çæ§ç³»ç»\n\n * äºè§£çæ§å¯¹è±¡çå·¥ä½åç\n   * æ¯å¦æ³å¯¹jvmè¿è¡çæ§ï¼å°±å¿é¡»æ¸æ¥jvmçå åå­ç»æååå¾åæ¶æºå¶ã\n * ç¡®å®çæ§å¯¹è±¡çææ \n   * æ¯å¦æ³å¯¹æä¸ªæ¥å£è¿è¡çæ§ï¼å¯ä»¥éç¨è¯·æ±éãèæ¶ãè¶æ¶éãå¼å¸¸éç­ææ æ¥è¡¡éã\n * å®ä¹åççæ¥è­¦éå¼åç­çº§\n * å»ºç«å®åçæéå¤çæµç¨\n\n\n# çæ§å¯¹è±¡åææ \n\n * ç¡¬ä»¶çæ§\n   * çµæºãcpuãæºå¨æ¸©åº¦ãé£æãç©çç£çãraidãåå­ãç½å¡\n * æå¡å¨åºç¡çæ§\n   * cpuï¼åä¸ªcpuä»¥åæ´ä½çä½¿ç¨æåµ\n   * åå­ï¼å·²ç¨åå­ãå¯ç¨åå­\n   * ç£çï¼ç£çä½¿ç¨çãç£çè¯»åçååé\n   * ç½ç»ï¼åºå£æµéãå¥å£æµéãtcpè¿æ¥ç¶æ\n * æ°æ®åºçæ§\n   * æ°æ®åºè¿æ¥æ°\n   * qpsãtps\n   * å¹¶è¡å¤ççä¼è¯æ°\n   * ç¼å­å½ä¸­ç\n   * ä¸»ä»æ¶å»¶\n   * éç¶æ\n   * æ¢æ¥è¯¢\n * ä¸­é´ä»¶çæ§\n   * nginxï¼æ´»è·è¿æ¥æ°ãç­å¾ãè¿æ¥æ°ãä¸¢å¼è¿æ¥æ°ãè¯·æ±éãèæ¶ã5xxéè¯¯ç\n   * tomcatï¼æå¤§çº¿ç¨æ°ãå½åçº¿ç¨æ°ãè¯·æ±éãèæ¶ãéè¯¯éãå åå­ä½¿ç¨æåµãgcæ¬¡æ°åèæ¶\n   * ç¼å­ï¼æåè¿æ¥æ°ãé»å¡è¿æ¥æ°ãå·²ä½¿ç¨åå­ãåå­ç¢ççãè¯·æ±éãèæ¶ãç¼å­å½ä¸­ç\n   * æ¶æ¯éåï¼è¿æ¥æ°ãéåæ°ãçæéçãæ¶è´¹éçãæ¶æ¯å ç§¯é\n * åºç¨çæ§\n   * httpæ¥å£ï¼urlå­æ´»ãè¯·æ±éãèæ¶ãå¼å¸¸é\n   * rpcæ¥å£ï¼è¯·æ±éãèæ¶ãè¶æ¶éãæç»é\n   * jvmï¼gcæ¬¡æ°ãgcèæ¶ãåä¸ªåå­åºåçå¤§å°ãå½åçº¿ç¨æ°ãæ­»éçº¿ç¨æ°\n   * çº¿ç¨æ± ï¼æ´»è·çº¿ç¨æ°ãä»»å¡éåå¤§å°ãä»»å¡æ§è¡èæ¶ãæç»ä»»å¡æ°\n   * è¿æ¥æ± ï¼æ»è¿æ¥æ°ãæ´»è·è¿æ¥æ°\n   * æ¥å¿çæ§ï¼è®¿é®æ¥å¿ãéè¯¯æ¥å¿\n   * ä¸å¡ææ ï¼å¦pvãè®¢åé\n\n\n# ä¸»æµçæ§ç³»ç»\n\nèççæ§ç³»ç»ï¼\n\n * zabbix\n * nagios\n * cacti\n * ganglia\n * garafana\n\næ°ä¸ä»£çæ§ç³»ç»ï¼\n\n * open-falconï¼èªå¨ééï¼åªè¦å®è£äºfalcon-agentçæºå¨ï¼å°±ä¼èªå¨å¼å§ééåé¡¹ææ ï¼ä¸»å¨ä¸æ¥ï¼ä¸éè¦ç¨æ·å¨serveråä»»ä½éç½®ï¼\n * prometheusï¼éç¨pullæ¨¡å¼ï¼\n\n\n# spring boot admin\n\nå¯ä»¥çæ§spring-booté¡¹ç®çåºæ¬ä¿¡æ¯æ¯å¦ï¼springå®¹å¨ç®¡ççææçbeanãè¯¦ç»çhealthä¿¡æ¯ãåå­ä¿¡æ¯ãjvmä¿¡æ¯ãåå¾åæ¶ä¿¡æ¯ãåç§éç½®ä¿¡æ¯ï¼æ¯å¦æ°æ®æºãç¼å­åè¡¨åå½ä¸­çï¼ç­ï¼threads çº¿ç¨ç®¡çï¼environment ç®¡çç­ã\n\næ¯æå¤ç§åè­¦æ¹å¼æ¥å¥ï¼å¦ä¼ä¸å¾®ä¿¡ãééãé®ä»¶ãç­ä¿¡ã\n\nå¯æ»¡è¶³spring booté¡¹ç®è½»éçº§çä½¿ç¨ã\n\nå¨sbaä¸­ï¼serverä½ä¸ºæ³¨åä¸­å¿ï¼çæ§ææå®¢æ·ç«¯å½åçç¶æï¼æå¡ç«¯åå®¢æ·ç«¯ä¹é´éè¿/healthæ¥å£è¿è¡éä¿¡ï¼ä¾æ¬¡æ¥å¯¹å®¢æ·ç«¯è¿è¡çå¬ãæå¡ç«¯éè¿å®æ¶è½®è¯¢å®¢æ·ç«¯ç/healthæ¥å£æ¥å¯¹å®¢æ·ç«¯è¿è¡å¿ææ£æµã\n\nå®¢æ·ç«¯éè¿ actuator è·åä¿¡æ¯ã\n\n\n# éåå»ºè®®\n\n * é¦åè¦æç¡®éæ±ï¼è¦çæ§çå¯¹è±¡æåªäºï¼æºå¨æ°éåçæ§ææ æå¤å°ï¼éè¦å·å¤ä»ä¹æ ·çåè½ã\n * ä¸è¦æ³ä¸å¼å§å°±all in oneï¼ä»ææ¬èèï¼åæç´æ¥ä½¿ç¨å¼æºçæ¹æ¡å³å¯ï¼è§£å³ä»æ å°æã\n * zabbixå¨æå¡å¨çæ§æ¹é¢å ç»å¯¹ä¼å¿ï¼ä½å¯¹åºç¨å±çæ§å¹¶ä¸æé¿ãè¿ç¹open-falconåprometheusåçæ¯è¾å¥½ã\n * æ°ä¸ä»£çæ§ç³»ç»çææ¾ä¼å¿ï¼çµæ´»çæ°æ®æ¨¡åï¼æ´æççæ¶åºæ°æ®åºï¼å¼ºå¤§çåè­¦åè½ãå¦ææ²¡æå¯¹èççæ§ç³»ç»çææ¯ç§¯ç´¯çè¯ï¼å»ºè®®ç´æ¥ä½¿ç¨open-falconæprometheusã\n * open-falconçæ ¸å¿ä¼å¿å¨äºæ°æ®åçåè½ï¼è½æ¯ææ´å¤çæºå¨åçæ§é¡¹ï¼prometheusåæ¯å®¹å¨çæ§æ¹é¢çæ éï¼ægoogleåk8så æã\n * zabbixãopen-falconåprometheusé½æ¯æågrafanaåå¿«ééæï¼æ³è¦ç¾è§ä¸å¼ºå¤§çå¯è§åä½éªï¼å¯ä»¥ågrafanaè¿è¡ç»åã\n * è½»éçº§ä½¿ç¨ï¼å¯ä½¿ç¨sbaï¼å¹¶å¯å¯¹å¶æ©å±ã\n * prometheus ä¹å¯ä»¥éæ©ä¹°é¿éäºçäº§åã\n\n\n# åè\n\n 1. https://www.daimajiaoliu.com/daima/7b7376aeb0be805\n 2. https://cloud.tencent.com/developer/article/1704555\n 3. https://xie.infoq.cn/article/e1d2ad0d57d9fc6b2bb8fd6a5\n 4. https://github.com/codecentric/spring-boot-admin",charsets:{cjk:!0}},{title:"Redisåå¸å¼éå®ç°",frontmatter:{title:"Redisåå¸å¼éå®ç°",date:"2023-03-31T17:10:21.000Z",permalink:"/pages/165ba8/"},regularPath:"/08.%E6%96%B9%E6%A1%88/05.redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%AE%9E%E7%8E%B0.html",relativePath:"08.æ¹æ¡/05.redisåå¸å¼éå®ç°.md",key:"v-6158f5dc",path:"/pages/165ba8/",headers:[{level:2,title:"ä»ä¹æ¯åå¸å¼éï¼",slug:"ä»ä¹æ¯åå¸å¼é",normalizedTitle:"ä»ä¹æ¯åå¸å¼éï¼",charIndex:2},{level:2,title:"åå¸å¼éçå ç§å®ç°",slug:"åå¸å¼éçå ç§å®ç°",normalizedTitle:"åå¸å¼éçå ç§å®ç°",charIndex:75},{level:2,title:"SETNXæä»¤",slug:"setnxæä»¤",normalizedTitle:"setnxæä»¤",charIndex:280},{level:2,title:"SETNXæä»¤ + EXPIREæä»¤",slug:"setnxæä»¤-expireæä»¤",normalizedTitle:"setnxæä»¤ + expireæä»¤",charIndex:495},{level:2,title:"SETæ©å±æä»¤",slug:"setæ©å±æä»¤",normalizedTitle:"setæ©å±æä»¤",charIndex:726},{level:2,title:"SETæ©å±æä»¤ + Lua",slug:"setæ©å±æä»¤-lua",normalizedTitle:"setæ©å±æä»¤ + lua",charIndex:1214},{level:2,title:"Redisson",slug:"redisson",normalizedTitle:"redisson",charIndex:1627},{level:2,title:"åºäºRediså¤æºå®ç°çRedlock",slug:"åºäºrediså¤æºå®ç°çredlock",normalizedTitle:"åºäºrediså¤æºå®ç°çredlock",charIndex:1769},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:2659}],headersStr:"ä»ä¹æ¯åå¸å¼éï¼ åå¸å¼éçå ç§å®ç° SETNXæä»¤ SETNXæä»¤ + EXPIREæä»¤ SETæ©å±æä»¤ SETæ©å±æä»¤ + Lua Redisson åºäºRediså¤æºå®ç°çRedlock åè",content:'# ä»ä¹æ¯åå¸å¼éï¼\n\nåå¸å¼éé¡¾åæä¹å°±æ¯ç¨å¨åå¸å¼ç³»ç»ä¸­ï¼ç¨äºæ§å¶åå¸å¼ç³»ç»ä¹é´åæ­¥è®¿é®å±äº«èµæºã\n\næ ¸å¿æä½ï¼å éãè§£éãé²æ­¢éè¶æ¶ã\n\n\n# åå¸å¼éçå ç§å®ç°\n\n * Memcached åå¸å¼éï¼Memecached addå½ä»¤æ¯åå­æ§çã\n * Zookeeper åå¸å¼éï¼å©ç¨Zookeeper çé¡ºåºä¸´æ¶èç¹ï¼ä¸ä¸´æ¶èç¹è¿æ¥ä¸­æ­ä¼èªå¨å é¤ï¼æ¥å®ç°åå¸å¼éãåæ¶è¿æä¾watchæºå¶ï¼å¯ä»¥å®ç°å éå¤±è´¥å°±é»å¡ä½ï¼ç´å°è·åå°éä¸ºæ­¢ã\n * Chubbyï¼Googleå®ç°çç²ç²åº¦åå¸å¼éæå¡ã\n * Redis åå¸å¼éï¼ä¸æè¯¦ç»è®¨è®ºã\n\n\n# SETNXæä»¤\n\nSETNXæä»¤åªå¨keyä¸å­å¨çæåµä¸ï¼å°keyè®¾ç½®ä¸ºvalueå¼ï¼è¥keyå­å¨ï¼åä¸åä»»ä½æä½ã\n\nkeyæ¯éçå¯ä¸æ è¯ï¼å¯ä»¥æä¸å¡éæ±éå®çèµæºå½åã\n\nSETNX lock_key lock_value\ndo something\nDEL lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼éè¶æ¶é®é¢ãå¦æè·å¾éçè¿ç¨å¨ä¸å¡å¤çè¿ç¨ä¸­åºç°äºå¼å¸¸ï¼å°å¯¼è´DELæä»¤æ æ³æ§è¡ï¼éæ æ³éæ¾ï¼è¯¥èµæºå°ä¼è¢«ä¸ç´éä½ã\n\n\n# SETNXæä»¤ + EXPIREæä»¤\n\nå æ­¤å¾å®¹ææ³å°ï¼ç»keyè®¾ç½®ä¸ä¸ªè¿ææ¶é´ãç±äºSETNXä¸æ¯æè®¾ç½®è¿ææ¶é´ï¼æä»¥éè¦é¢å¤çEXPIREæä»¤\n\nSETNX lock_key lock_value\nEXPIRE lock_key 10\ndo something\nDEL lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼SETNX å EXPIRE è¿ä¸¤ä¸ªæä½æ¯éåå­æ§çï¼ å¦æè¿ç¨å¨æ§è¡ SETNX å EXPIRE ä¹é´åçå¼å¸¸ï¼åæ ·ä¼åºç°ä¸è¿°é®é¢ã\n\n\n# SETæ©å±æä»¤\n\nä¸ºäºè§£å³ SETNX å EXPIRE ä¸¤ä¸ªæä½éåå­æ§çé®é¢ï¼å¯ä»¥ä½¿ç¨ Redis ç SET æä»¤çæ©å±åæ°ï¼ä½¿å¾ SETNX å EXPIRE è¿ä¸¤ä¸ªæä½å¯ä»¥åå­æ§è¡ã\n\nSET lock_key lock_value NX EX 10\ndo something\nDEL lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼éå¯è½å¨ä¸å¡å¤çç»æåæåéæ¾ãä»èä¹å¯è½å¯¼è´éè¢«è¯¯å ã\n\nä¸ºäºé¿åä¸è¿°æåµï¼å»ºè®®ä¸è¦å¨æ§è¡æ¶é´è¿é¿çåºæ¯ä¸­ä½¿ç¨ Redis åå¸å¼éï¼åæ¶ä¸ä¸ªæ¯è¾å®å¨çåæ³æ¯å¨æ§è¡ DEL éæ¾éä¹åå¯¹éè¿è¡å¤æ­ï¼éªè¯å½åéçææèæ¯å¦æ¯èªå·±ã\n\nå·ä½å®ç°å°±æ¯å¨å éæ¶å° value è®¾ç½®ä¸ºä¸ä¸ªå¯ä¸çéæºæ°ï¼æèçº¿ç¨ ID ï¼ï¼éæ¾éæ¶åå¤æ­éæºæ°æ¯å¦ä¸è´ï¼ç¶ååæ§è¡éæ¾æä½ï¼ç¡®ä¿ä¸ä¼éè¯¯å°éæ¾å¶å®çº¿ç¨ææçéï¼é¤éæ¯éè¿æäºè¢«æå¡å¨èªå¨éæ¾ã\n\nSET lock_key random_value nx ex 10\ndo something\nif random_value == lock_key.value\n\tDEL lock_key\n\n\n\n# SETæ©å±æä»¤ + Lua\n\nä½å¤æ­ value åå é¤ key æ¯ä¸¤ä¸ªç¬ç«çæä½ï¼å¹¶ä¸æ¯åå­æ§çï¼æä»¥è¿ä¸ªå°æ¹éè¦ä½¿ç¨ Lua èæ¬è¿è¡å¤çã\n\nif redis.call("get", KEYS[1]) == ARGV[1] then\n  return redis.call("del", KEYS[1])\nelse \n  return 0\nend\n\n\n> Redisä½¿ç¨Luaèæ¬æ¶ä¸ºä»ä¹è½ä¿è¯åå­æ§?\n> \n> Redisä½¿ç¨åä¸ä¸ªçLuaè§£éå¨ï¼æ¥è¿è¡ææçå½ä»¤ãRedisä¿è¯ä»¥ä¸ç§åå­æ§çæ¹å¼æ¥æ§è¡èæ¬ãå¨æ§è¡èæ¬æ¶ï¼ä¸ä¼æ§è¡å¶ä»èæ¬æRediså½ä»¤ãè¿ä¸ªè¯­ä¹ç±»ä¼¼äºMULTIï¼å¼å¯äºå¡ï¼/EXECï¼è§¦åäºå¡ï¼ä¸å¹¶æ§è¡äºå¡ä¸­çææå½ä»¤ï¼ãä»ææå¶ä»å®¢æ·ç«¯çè§åº¦æ¥çï¼èæ¬çææè¦ä¹ä»ç¶ä¸å¯è§ï¼è¦ä¹å·²ç»å®æã\n\nä½è¿å¹¶ä¸æ¯ä¸ä¸ªå®ç¾çæ¹æ¡ï¼åªæ¯ç¸å¯¹å®å¨ä¸ç¹ï¼å ä¸ºå®å¹¶æ²¡æå®å¨è§£å³æ§è¡è¶æ¶éè¢«æåéæ¾çé®é¢ã\n\n\n# Redisson\n\nåçï¼å¯ä»¥å©ç¨éçå¯éå¥ç¹æ§ï¼è®©è·å¾éççº¿ç¨å¼å¯ä¸ä¸ªå®æ¶å¨çå®æ¤çº¿ç¨ï¼æ¯ expireTime/3 æ§è¡ä¸æ¬¡ï¼å»æ£æ¥è¯¥çº¿ç¨çéæ¯å¦å­å¨ï¼å¦æå­å¨åå¯¹éçè¿ææ¶é´éæ°è®¾ç½®ä¸º expireTimeï¼å³å©ç¨å®æ¤çº¿ç¨å¯¹éè¿è¡âç»­å½âï¼é²æ­¢éç±äºè¿ææåéæ¾ã\n\n\n\n\n# åºäºRediså¤æºå®ç°çRedlock\n\nä»¥ä¸å ç§åºäº Redis åæºå®ç°çåå¸å¼éå¶å®é½å­å¨ä¸ä¸ªé®é¢ï¼å°±æ¯å éæ¶åªä½ç¨å¨ä¸ä¸ª Redis èç¹ä¸ï¼å³ä½¿ Redis éè¿ Sentinel ä¿è¯äºé«å¯ç¨ï¼ä½ç±äº Redis çå¤å¶æ¯å¼æ­¥çï¼Master èç¹è·åå°éåå¨æªå®ææ°æ®åæ­¥çæåµä¸åçæéè½¬ç§»ï¼æ­¤æ¶å¶ä»å®¢æ·ç«¯ä¸ççº¿ç¨ä¾ç¶å¯ä»¥è·åå°éï¼å æ­¤ä¼ä¸§å¤±éçå®å¨æ§ã\n\nå¨ Redis çåå¸å¼ç¯å¢ä¸­ï¼Redis çä½è antirez æä¾äº RedLock çç®æ³æ¥å®ç°ä¸ä¸ªåå¸å¼éï¼è¯¥ç®æ³å¤§æ¦æ¯è¿æ ·çï¼\n\nåè®¾æ Nï¼N>=5ï¼ä¸ª Redis èç¹ï¼è¿äºèç¹å®å¨äºç¸ç¬ç«ï¼ä¸å­å¨ä¸»ä»å¤å¶æèå¶ä»éç¾¤åè°æºå¶ï¼ç¡®ä¿å¨è¿ N ä¸ªèç¹ä¸ä½¿ç¨ä¸å¨ Redis åå®ä¾ä¸ç¸åçæ¹æ³è·ååéæ¾éã\n\nè·åéçè¿ç¨ï¼å®¢æ·ç«¯åºæ§è¡å¦ä¸æä½ï¼\n\n * è·åå½å Unix æ¶é´ï¼ä»¥æ¯«ç§ä¸ºåä½ã\n * æé¡ºåºä¾æ¬¡å°è¯ä» 5 ä¸ªå®ä¾ä½¿ç¨ç¸åç key åå·æå¯ä¸æ§ç valueï¼ä¾å¦ UUIDï¼è·åéãå½å Redis è¯·æ±è·åéæ¶ï¼å®¢æ·ç«¯åºè¯¥è®¾ç½®ä¸ä¸ªç½ç»è¿æ¥åååºè¶æ¶æ¶é´ï¼è¿ä¸ªè¶æ¶æ¶é´åºè¯¥å°äºéçå¤±ææ¶é´ãä¾å¦éèªå¨å¤±ææ¶é´ä¸º 10 ç§ï¼åè¶æ¶æ¶é´åºè¯¥å¨ 5-50 æ¯«ç§ä¹é´ãè¿æ ·å¯ä»¥é¿åæå¡å¨ç«¯ Redis å·²ç»ææçæåµä¸ï¼å®¢æ·ç«¯è¿å¨ä¸ç´ç­å¾ååºç»æãå¦ææå¡å¨ç«¯æ²¡æå¨è§å®æ¶é´åååºï¼å®¢æ·ç«¯åºè¯¥å°½å¿«å°è¯å»å¦å¤ä¸ä¸ª Redis å®ä¾è¯·æ±è·åéã\n * å®¢æ·ç«¯ä½¿ç¨å½åæ¶é´åå»å¼å§è·åéæ¶é´ï¼æ­¥éª¤ 1 è®°å½çæ¶é´ï¼å°±å¾å°è·åéä½¿ç¨çæ¶é´ãå½ä¸ä»å½ä»å¤§å¤æ°ï¼N/2+1ï¼è¿éæ¯ 3 ä¸ªèç¹ï¼ç Redis èç¹é½åå°éï¼å¹¶ä¸ä½¿ç¨çæ¶é´å°äºéå¤±ææ¶é´æ¶ï¼éæç®è·åæåã\n * å¦æåå°äºéï¼key ççæ­£æææ¶é´ç­äºæææ¶é´åå»è·åéæä½¿ç¨çæ¶é´ï¼æ­¥éª¤ 3 è®¡ç®çç»æï¼ã\n * å¦æå ä¸ºæäºåå ï¼è·åéå¤±è´¥ï¼æ²¡æå¨è³å° N/2+1 ä¸ª Redis å®ä¾åå°éæèåéæ¶é´å·²ç»è¶è¿äºæææ¶é´ï¼ï¼å®¢æ·ç«¯åºè¯¥å¨ææç Redis å®ä¾ä¸è¿è¡è§£éï¼ä½¿ç¨ Redis Lua èæ¬ï¼ã\n\n\n# åè\n\n 1. https://www.infoq.cn/article/dvaaj71f4fbqsxmgvdce\n\n 2. https://juejin.cn/post/6844903830442737671#heading-14',normalizedContent:'# ä»ä¹æ¯åå¸å¼éï¼\n\nåå¸å¼éé¡¾åæä¹å°±æ¯ç¨å¨åå¸å¼ç³»ç»ä¸­ï¼ç¨äºæ§å¶åå¸å¼ç³»ç»ä¹é´åæ­¥è®¿é®å±äº«èµæºã\n\næ ¸å¿æä½ï¼å éãè§£éãé²æ­¢éè¶æ¶ã\n\n\n# åå¸å¼éçå ç§å®ç°\n\n * memcached åå¸å¼éï¼memecached addå½ä»¤æ¯åå­æ§çã\n * zookeeper åå¸å¼éï¼å©ç¨zookeeper çé¡ºåºä¸´æ¶èç¹ï¼ä¸ä¸´æ¶èç¹è¿æ¥ä¸­æ­ä¼èªå¨å é¤ï¼æ¥å®ç°åå¸å¼éãåæ¶è¿æä¾watchæºå¶ï¼å¯ä»¥å®ç°å éå¤±è´¥å°±é»å¡ä½ï¼ç´å°è·åå°éä¸ºæ­¢ã\n * chubbyï¼googleå®ç°çç²ç²åº¦åå¸å¼éæå¡ã\n * redis åå¸å¼éï¼ä¸æè¯¦ç»è®¨è®ºã\n\n\n# setnxæä»¤\n\nsetnxæä»¤åªå¨keyä¸å­å¨çæåµä¸ï¼å°keyè®¾ç½®ä¸ºvalueå¼ï¼è¥keyå­å¨ï¼åä¸åä»»ä½æä½ã\n\nkeyæ¯éçå¯ä¸æ è¯ï¼å¯ä»¥æä¸å¡éæ±éå®çèµæºå½åã\n\nsetnx lock_key lock_value\ndo something\ndel lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼éè¶æ¶é®é¢ãå¦æè·å¾éçè¿ç¨å¨ä¸å¡å¤çè¿ç¨ä¸­åºç°äºå¼å¸¸ï¼å°å¯¼è´delæä»¤æ æ³æ§è¡ï¼éæ æ³éæ¾ï¼è¯¥èµæºå°ä¼è¢«ä¸ç´éä½ã\n\n\n# setnxæä»¤ + expireæä»¤\n\nå æ­¤å¾å®¹ææ³å°ï¼ç»keyè®¾ç½®ä¸ä¸ªè¿ææ¶é´ãç±äºsetnxä¸æ¯æè®¾ç½®è¿ææ¶é´ï¼æä»¥éè¦é¢å¤çexpireæä»¤\n\nsetnx lock_key lock_value\nexpire lock_key 10\ndo something\ndel lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼setnx å expire è¿ä¸¤ä¸ªæä½æ¯éåå­æ§çï¼ å¦æè¿ç¨å¨æ§è¡ setnx å expire ä¹é´åçå¼å¸¸ï¼åæ ·ä¼åºç°ä¸è¿°é®é¢ã\n\n\n# setæ©å±æä»¤\n\nä¸ºäºè§£å³ setnx å expire ä¸¤ä¸ªæä½éåå­æ§çé®é¢ï¼å¯ä»¥ä½¿ç¨ redis ç set æä»¤çæ©å±åæ°ï¼ä½¿å¾ setnx å expire è¿ä¸¤ä¸ªæä½å¯ä»¥åå­æ§è¡ã\n\nset lock_key lock_value nx ex 10\ndo something\ndel lock_key\n\n\nè¿ä¸æ¹å¼çé®é¢å¨äºï¼éå¯è½å¨ä¸å¡å¤çç»æåæåéæ¾ãä»èä¹å¯è½å¯¼è´éè¢«è¯¯å ã\n\nä¸ºäºé¿åä¸è¿°æåµï¼å»ºè®®ä¸è¦å¨æ§è¡æ¶é´è¿é¿çåºæ¯ä¸­ä½¿ç¨ redis åå¸å¼éï¼åæ¶ä¸ä¸ªæ¯è¾å®å¨çåæ³æ¯å¨æ§è¡ del éæ¾éä¹åå¯¹éè¿è¡å¤æ­ï¼éªè¯å½åéçææèæ¯å¦æ¯èªå·±ã\n\nå·ä½å®ç°å°±æ¯å¨å éæ¶å° value è®¾ç½®ä¸ºä¸ä¸ªå¯ä¸çéæºæ°ï¼æèçº¿ç¨ id ï¼ï¼éæ¾éæ¶åå¤æ­éæºæ°æ¯å¦ä¸è´ï¼ç¶ååæ§è¡éæ¾æä½ï¼ç¡®ä¿ä¸ä¼éè¯¯å°éæ¾å¶å®çº¿ç¨ææçéï¼é¤éæ¯éè¿æäºè¢«æå¡å¨èªå¨éæ¾ã\n\nset lock_key random_value nx ex 10\ndo something\nif random_value == lock_key.value\n\tdel lock_key\n\n\n\n# setæ©å±æä»¤ + lua\n\nä½å¤æ­ value åå é¤ key æ¯ä¸¤ä¸ªç¬ç«çæä½ï¼å¹¶ä¸æ¯åå­æ§çï¼æä»¥è¿ä¸ªå°æ¹éè¦ä½¿ç¨ lua èæ¬è¿è¡å¤çã\n\nif redis.call("get", keys[1]) == argv[1] then\n  return redis.call("del", keys[1])\nelse \n  return 0\nend\n\n\n> redisä½¿ç¨luaèæ¬æ¶ä¸ºä»ä¹è½ä¿è¯åå­æ§?\n> \n> redisä½¿ç¨åä¸ä¸ªçluaè§£éå¨ï¼æ¥è¿è¡ææçå½ä»¤ãredisä¿è¯ä»¥ä¸ç§åå­æ§çæ¹å¼æ¥æ§è¡èæ¬ãå¨æ§è¡èæ¬æ¶ï¼ä¸ä¼æ§è¡å¶ä»èæ¬ærediså½ä»¤ãè¿ä¸ªè¯­ä¹ç±»ä¼¼äºmultiï¼å¼å¯äºå¡ï¼/execï¼è§¦åäºå¡ï¼ä¸å¹¶æ§è¡äºå¡ä¸­çææå½ä»¤ï¼ãä»ææå¶ä»å®¢æ·ç«¯çè§åº¦æ¥çï¼èæ¬çææè¦ä¹ä»ç¶ä¸å¯è§ï¼è¦ä¹å·²ç»å®æã\n\nä½è¿å¹¶ä¸æ¯ä¸ä¸ªå®ç¾çæ¹æ¡ï¼åªæ¯ç¸å¯¹å®å¨ä¸ç¹ï¼å ä¸ºå®å¹¶æ²¡æå®å¨è§£å³æ§è¡è¶æ¶éè¢«æåéæ¾çé®é¢ã\n\n\n# redisson\n\nåçï¼å¯ä»¥å©ç¨éçå¯éå¥ç¹æ§ï¼è®©è·å¾éççº¿ç¨å¼å¯ä¸ä¸ªå®æ¶å¨çå®æ¤çº¿ç¨ï¼æ¯ expiretime/3 æ§è¡ä¸æ¬¡ï¼å»æ£æ¥è¯¥çº¿ç¨çéæ¯å¦å­å¨ï¼å¦æå­å¨åå¯¹éçè¿ææ¶é´éæ°è®¾ç½®ä¸º expiretimeï¼å³å©ç¨å®æ¤çº¿ç¨å¯¹éè¿è¡âç»­å½âï¼é²æ­¢éç±äºè¿ææåéæ¾ã\n\n\n\n\n# åºäºrediså¤æºå®ç°çredlock\n\nä»¥ä¸å ç§åºäº redis åæºå®ç°çåå¸å¼éå¶å®é½å­å¨ä¸ä¸ªé®é¢ï¼å°±æ¯å éæ¶åªä½ç¨å¨ä¸ä¸ª redis èç¹ä¸ï¼å³ä½¿ redis éè¿ sentinel ä¿è¯äºé«å¯ç¨ï¼ä½ç±äº redis çå¤å¶æ¯å¼æ­¥çï¼master èç¹è·åå°éåå¨æªå®ææ°æ®åæ­¥çæåµä¸åçæéè½¬ç§»ï¼æ­¤æ¶å¶ä»å®¢æ·ç«¯ä¸ççº¿ç¨ä¾ç¶å¯ä»¥è·åå°éï¼å æ­¤ä¼ä¸§å¤±éçå®å¨æ§ã\n\nå¨ redis çåå¸å¼ç¯å¢ä¸­ï¼redis çä½è antirez æä¾äº redlock çç®æ³æ¥å®ç°ä¸ä¸ªåå¸å¼éï¼è¯¥ç®æ³å¤§æ¦æ¯è¿æ ·çï¼\n\nåè®¾æ nï¼n>=5ï¼ä¸ª redis èç¹ï¼è¿äºèç¹å®å¨äºç¸ç¬ç«ï¼ä¸å­å¨ä¸»ä»å¤å¶æèå¶ä»éç¾¤åè°æºå¶ï¼ç¡®ä¿å¨è¿ n ä¸ªèç¹ä¸ä½¿ç¨ä¸å¨ redis åå®ä¾ä¸ç¸åçæ¹æ³è·ååéæ¾éã\n\nè·åéçè¿ç¨ï¼å®¢æ·ç«¯åºæ§è¡å¦ä¸æä½ï¼\n\n * è·åå½å unix æ¶é´ï¼ä»¥æ¯«ç§ä¸ºåä½ã\n * æé¡ºåºä¾æ¬¡å°è¯ä» 5 ä¸ªå®ä¾ä½¿ç¨ç¸åç key åå·æå¯ä¸æ§ç valueï¼ä¾å¦ uuidï¼è·åéãå½å redis è¯·æ±è·åéæ¶ï¼å®¢æ·ç«¯åºè¯¥è®¾ç½®ä¸ä¸ªç½ç»è¿æ¥åååºè¶æ¶æ¶é´ï¼è¿ä¸ªè¶æ¶æ¶é´åºè¯¥å°äºéçå¤±ææ¶é´ãä¾å¦éèªå¨å¤±ææ¶é´ä¸º 10 ç§ï¼åè¶æ¶æ¶é´åºè¯¥å¨ 5-50 æ¯«ç§ä¹é´ãè¿æ ·å¯ä»¥é¿åæå¡å¨ç«¯ redis å·²ç»ææçæåµä¸ï¼å®¢æ·ç«¯è¿å¨ä¸ç´ç­å¾ååºç»æãå¦ææå¡å¨ç«¯æ²¡æå¨è§å®æ¶é´åååºï¼å®¢æ·ç«¯åºè¯¥å°½å¿«å°è¯å»å¦å¤ä¸ä¸ª redis å®ä¾è¯·æ±è·åéã\n * å®¢æ·ç«¯ä½¿ç¨å½åæ¶é´åå»å¼å§è·åéæ¶é´ï¼æ­¥éª¤ 1 è®°å½çæ¶é´ï¼å°±å¾å°è·åéä½¿ç¨çæ¶é´ãå½ä¸ä»å½ä»å¤§å¤æ°ï¼n/2+1ï¼è¿éæ¯ 3 ä¸ªèç¹ï¼ç redis èç¹é½åå°éï¼å¹¶ä¸ä½¿ç¨çæ¶é´å°äºéå¤±ææ¶é´æ¶ï¼éæç®è·åæåã\n * å¦æåå°äºéï¼key ççæ­£æææ¶é´ç­äºæææ¶é´åå»è·åéæä½¿ç¨çæ¶é´ï¼æ­¥éª¤ 3 è®¡ç®çç»æï¼ã\n * å¦æå ä¸ºæäºåå ï¼è·åéå¤±è´¥ï¼æ²¡æå¨è³å° n/2+1 ä¸ª redis å®ä¾åå°éæèåéæ¶é´å·²ç»è¶è¿äºæææ¶é´ï¼ï¼å®¢æ·ç«¯åºè¯¥å¨ææç redis å®ä¾ä¸è¿è¡è§£éï¼ä½¿ç¨ redis lua èæ¬ï¼ã\n\n\n# åè\n\n 1. https://www.infoq.cn/article/dvaaj71f4fbqsxmgvdce\n\n 2. https://juejin.cn/post/6844903830442737671#heading-14',charsets:{cjk:!0}},{title:"Spring",frontmatter:{title:"Spring",date:"2023-03-30T22:06:46.000Z",permalink:"/pages/spring/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/01.Spring.html",relativePath:"09.Javaæ¡æ¶/01.Spring/01.Spring.md",key:"v-68d67e22",path:"/pages/spring/",headers:[{level:2,title:"IOCççè§£",slug:"iocççè§£",normalizedTitle:"iocççè§£",charIndex:2},{level:2,title:"IOCçå®ç°åç",slug:"iocçå®ç°åç",normalizedTitle:"iocçå®ç°åç",charIndex:334},{level:2,title:"AOPççè§£",slug:"aopççè§£",normalizedTitle:"aopççè§£",charIndex:957},{level:2,title:"AOPçå®ç°åç",slug:"aopçå®ç°åç",normalizedTitle:"aopçå®ç°åç",charIndex:1791},{level:2,title:"Beanççå½å¨æ",slug:"beanççå½å¨æ",normalizedTitle:"beanççå½å¨æ",charIndex:2092},{level:2,title:"Bean çä½ç¨å",slug:"bean-çä½ç¨å",normalizedTitle:"bean çä½ç¨å",charIndex:2734},{level:2,title:"åä¾Bean çå¥½å¤",slug:"åä¾bean-çå¥½å¤",normalizedTitle:"åä¾bean çå¥½å¤",charIndex:3171},{level:2,title:"åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢",slug:"åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢",normalizedTitle:"åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢",charIndex:3598},{level:2,title:"Spring äºå¡",slug:"spring-äºå¡",normalizedTitle:"spring äºå¡",charIndex:4263}],headersStr:"IOCççè§£ IOCçå®ç°åç AOPççè§£ AOPçå®ç°åç Beanççå½å¨æ Bean çä½ç¨å åä¾Bean çå¥½å¤ åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢ Spring äºå¡",content:"# IOCççè§£\n\nIOC æ¯ Inversion of Control æ§å¶åè½¬ã\n\nè½¯ä»¶ç³»ç»å¨æ²¡æå¼å¥ IOC å®¹å¨ä¹åï¼å¯¹è±¡ A ä¾èµäºå¯¹è±¡ Bï¼é£ä¹å¯¹è±¡ A å¨åå§åæèè¿è¡å°æä¸ç¹çæ¶åï¼èªå·±å¿é¡»ä¸»å¨å»åå»ºå¯¹è±¡ B æèä½¿ç¨å·²ç»åå»ºçå¯¹è±¡ Bãæ è®ºæ¯åå»ºè¿æ¯ä½¿ç¨å¯¹è±¡ Bï¼æ§å¶æé½å¨èªå·±æä¸ã\n\nè½¯ä»¶ç³»ç»å¨å¼å¥ IOC å®¹å¨ä¹åï¼è¿ç§æå½¢å°±å®å¨æ¹åäºï¼ç±äº IOC å®¹å¨çå å¥ï¼å¯¹è±¡ A ä¸å¯¹è±¡ B ä¹é´å¤±å»äºç´æ¥èç³»ï¼æä»¥ï¼å½å¯¹è±¡ A è¿è¡å°éè¦å¯¹è±¡ B çæ¶åï¼IOC å®¹å¨ä¼ä¸»å¨åå»ºä¸ä¸ªå¯¹è±¡ B æ³¨å¥å°å¯¹è±¡ A éè¦çå°æ¹ã\n\nå¯¹è±¡ A è·å¾ä¾èµå¯¹è±¡ B çè¿ç¨ï¼ç±ä¸»å¨è¡ä¸ºåä¸ºäºè¢«å¨è¡ä¸ºï¼æ§å¶æé¢ åè¿æ¥äºï¼è¿å°±æ¯âæ§å¶åè½¬âè¿ä¸ªåç§°çç±æ¥ã\n\n\n# IOCçå®ç°åç\n\nSpring IOC (Inversion of Control) çå®ç°åçåºäºä¾èµæ³¨å¥ (Dependency Injection) æ¨¡å¼ï¼å®ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼\n\n 1. éç½®ï¼éè¿ XML æä»¶æ Java éç½®ç±»ç­æ¹å¼ï¼å®ä¹ Spring Bean çéç½®ä¿¡æ¯ï¼åæ¬ç±»åãæé å½æ°åæ°ãå±æ§å¼ç­ã\n 2. å®ä¾åï¼Spring æ ¹æ®éç½®ä¿¡æ¯åå»º Bean çå®ä¾ï¼éå¸¸ä½¿ç¨ Java åå°æºå¶æ¥å®ç°ã\n 3. ä¾èµæ³¨å¥ï¼Spring æ ¹æ®éç½®ä¿¡æ¯ï¼å°åå»ºå¥½ç Bean å®ä¾æ³¨å¥å°éè¦å®çå°æ¹ï¼åæ¬æé å½æ°æ³¨å¥ãSetter æ¹æ³æ³¨å¥ç­ã\n 4. çå½å¨æç®¡çï¼Spring ç®¡ç Bean ççå½å¨æï¼åæ¬åå§ååéæ¯ç­é¶æ®µï¼å¯ä»¥å¨ Bean ä¸­å®ä¹åå§åæ¹æ³åéæ¯æ¹æ³ï¼Spring ä¼å¨ç¸åºçé¶æ®µè°ç¨å®ä»¬ã\n\nå·ä½å®ç°ä¸ï¼Spring ä½¿ç¨äºä¸ä¸ªå«å BeanFactory çå®¹å¨æ¥ç®¡çææç Beanï¼è¿ä¸ªå®¹å¨å¨åå§åæ¶ä¼è¯»åéç½®æä»¶æéç½®ç±»ï¼ç¶åæ ¹æ®éç½®ä¿¡æ¯åå»º Bean å®ä¾ï¼å¹¶å°å®ä»¬å­å¨å¨ä¸ä¸ª Map ä¸­ãå½å¶ä» Bean éè¦ä¾èµè¿äº Bean æ¶ï¼Spring ä¼ä» Map ä¸­ååºç¸åºç Bean å®ä¾ï¼å¹¶å°å®ä»¬æ³¨å¥å°éè¦å®ä»¬çå°æ¹ã\n\nSpring IOC çå®ç°åçä½¿å¾å¼åèå¯ä»¥æ´å å³æ³¨ä¸å¡é»è¾ï¼èä¸éè¦è¿å¤å³æ³¨ Bean çåå»ºåç®¡çï¼ä»èæé«äºå¼åæçåä»£ç çå¯ç»´æ¤æ§ã\n\n\n# AOPççè§£\n\nAOPï¼Aspect-Oriented Programmingï¼é¢ååé¢ç¼ç¨ï¼ï¼å¯ä»¥è¯´æ¯ OOPï¼Object-Oriented Programingï¼é¢åå¯¹è±¡ç¼ç¨ï¼çè¡¥ååå®åãOOP å¼å¥å°è£ãç»§æ¿åå¤ææ§ç­æ¦å¿µæ¥å»ºç«ä¸ç§å¯¹è±¡å±æ¬¡ç»æï¼ç¨ä»¥æ¨¡æå¬å±è¡ä¸ºçä¸ä¸ªéåãå½æä»¬éè¦ä¸ºåæ£çå¯¹è±¡å¼å¥å¬å±è¡ä¸ºçæ¶åï¼OOP åæ¾å¾æ è½ä¸ºåãä¹å°±æ¯è¯´ï¼OOP åè®¸ä½ å®ä¹ä»ä¸å°ä¸çå³ç³»ï¼ä½å¹¶ä¸éåå®ä¹ä»å·¦å°å³çå³ç³»ãä¾å¦æ¥å¿åè½ãæ¥å¿ä»£ç å¾å¾æ°´å¹³å°æ£å¸å¨ææå¯¹è±¡å±æ¬¡ä¸­ï¼èä¸å®ææ£å¸å°çå¯¹è±¡çæ ¸å¿åè½æ¯«æ å³ç³»ãå¯¹äºå¶ä»ç±»åçä»£ç ï¼å¦ï¼å®å¨æ§ãå¼å¸¸å¤çåéæçæç»­æ§ä¹æ¯å¦æ­¤ãè¿ç§æ£å¸å¨åå¤çæ å³çä»£ç è¢«ç§°ä¸ºæ¨ªåï¼cross-cuttingï¼ä»£ç ï¼å¨ OOP è®¾è®¡ä¸­ï¼å®å¯¼è´äºå¤§éä»£ç çéå¤ï¼èä¸å©äºåä¸ªæ¨¡åçéç¨ã\n\nè AOP ææ¯åæ°æ°ç¸åï¼å®å©ç¨ä¸ç§ç§°ä¸ºâæ¨ªåâçææ¯ï¼åè§£å¼å°è£çå¯¹è±¡åé¨ï¼å¹¶å°é£äºå½±åäºå¤ä¸ªç±»çå¬å±è¡ä¸ºå°è£å°ä¸ä¸ªå¯éç¨æ¨¡åï¼å¹¶å°å¶åä¸ºâAspectâï¼å³åé¢ãæè°âåé¢âï¼ç®åå°è¯´ï¼å°±æ¯å°é£äºä¸ä¸å¡æ å³ï¼å´ä¸ºä¸å¡æ¨¡åæå±åè°ç¨çé»è¾æè´£ä»»å°è£èµ·æ¥ï¼ä¾¿äºåå°ç³»ç»çéå¤ä»£ç ï¼éä½æ¨¡åé´çè¦ååº¦ï¼å¹¶æå©äºæªæ¥çå¯æä½æ§åå¯ç»´æ¤æ§ãAOP ä»£è¡¨çæ¯ä¸ä¸ªæ¨ªåçå³ç³»ï¼å¦æè¯´âå¯¹è±¡âæ¯ä¸ä¸ªç©ºå¿çåæ±ä½ï¼å¶ä¸­å°è£çæ¯å¯¹è±¡çå±æ§åè¡ä¸ºï¼é£ä¹é¢åæ¹é¢ç¼ç¨çæ¹æ³ï¼å°±ä»¿ä½ä¸æå©åï¼å°è¿äºç©ºå¿åæ±ä½åå¼ï¼ä»¥è·å¾å¶åé¨çæ¶æ¯ãèåå¼çåé¢ï¼ä¹å°±æ¯æè°çâæ¹é¢âäºãç¶åå®åä»¥å·§å¤ºå¤©åçå¦æå°è¿äºåå¼çåé¢å¤åï¼ä¸ççè¿¹ã\n\nä½¿ç¨âæ¨ªåâææ¯ï¼AOP æè½¯ä»¶ç³»ç»åä¸ºä¸¤ä¸ªé¨åï¼æ ¸å¿å³æ³¨ç¹åæ¨ªåå³æ³¨ç¹ãä¸å¡å¤ççä¸»è¦æµç¨æ¯æ ¸å¿å³æ³¨ç¹ï¼ä¸ä¹å³ç³»ä¸å¤§çé¨åæ¯æ¨ªåå³æ³¨ç¹ãæ¨ªåå³æ³¨ç¹çä¸ä¸ªç¹ç¹æ¯ï¼å®ä»¬ç»å¸¸åçå¨æ ¸å¿å³æ³¨ç¹çå¤å¤ï¼èåå¤é½åºæ¬ç¸ä¼¼ãæ¯å¦ï¼æéè®¤è¯ãæ¥å¿ãäºå¡å¤çãAOP çä½ç¨å¨äºåç¦»ç³»ç»ä¸­çåç§å³æ³¨ç¹ï¼å°æ ¸å¿å³æ³¨ç¹åæ¨ªåå³æ³¨ç¹åç¦»å¼æ¥ã\n\n\n# AOPçå®ç°åç\n\nAOP ææ³çå®ç°ä¸è¬é½æ¯åºäºä»£çæ¨¡å¼ ï¼å¨ Java ä¸­ä¸è¬éç¨ JDK å¨æä»£çæ¨¡å¼ï¼ä½æ¯æä»¬é½ç¥éï¼JDK å¨æä»£çæ¨¡å¼åªè½ä»£çæ¥å£èä¸è½ä»£çç±»ãå æ­¤ï¼Spring AOP ä¼æç§ä¸é¢ä¸¤ç§æåµè¿è¡åæ¢ï¼å ä¸º Spring AOP åæ¶æ¯æ CGLIBãASPECTJãJDK å¨æä»£çã\n\n 1. å¦æç®æ å¯¹è±¡çå®ç°ç±»å®ç°äºæ¥å£ï¼Spring AOP å°ä¼éç¨ JDK å¨æä»£çæ¥çæ AOP ä»£çç±»ï¼\n 2. å¦æç®æ å¯¹è±¡çå®ç°ç±»æ²¡æå®ç°æ¥å£ï¼Spring AOP å°ä¼éç¨ CGLIB æ¥çæ AOP ä»£çç±»ãä¸è¿è¿ä¸ªéæ©è¿ç¨å¯¹å¼åèå®å¨éæãå¼åèä¹æ éå³å¿ã\n\n\n# Beanççå½å¨æ\n\n 1. å®ä¾åï¼Spring æ ¹æ®éç½®ä¿¡æ¯åå»º Bean å®ä¾ï¼éå¸¸ä½¿ç¨ Java åå°æºå¶æ¥å®ç°ã\n 2. å±æ§èµå¼ï¼Spring æ ¹æ®éç½®ä¿¡æ¯ææ³¨è§£å°å±æ§å¼æ³¨å¥å° Bean ä¸­ã\n 3. Aware åè°ï¼Spring è°ç¨å®ç°äºç¸åºæ¥å£ç Bean çåè°æ¹æ³ï¼ä¾å¦ BeanNameAwareãBeanFactoryAwareãApplicationContextAware ç­ã\n 4. åå§åï¼Spring æ§è¡åå§åæ¹æ³ï¼è¿ä¸ªæ¹æ³å¯ä»¥éè¿éç½®æä»¶ææ³¨è§£æ¥æå®ï¼ä¸è¬ç¨äº Bean çåå§åå·¥ä½ã\n 5. åå§ååå¤çï¼Spring æ§è¡å®ç°äº BeanPostProcessor æ¥å£çç±»ç postProcessBeforeInitialization æ¹æ³å postProcessAfterInitialization æ¹æ³ï¼è¿ä¸¤ä¸ªæ¹æ³å¯ä»¥å¨ Bean åå§ååååå§ååè¿è¡ä¸äºæä½ã\n 6. ä½¿ç¨ï¼Bean å¯ä»¥è¢«ä½¿ç¨äºï¼æ§è¡ç¸å³çä¸å¡é»è¾ã\n 7. éæ¯ï¼Spring æ§è¡éæ¯æ¹æ³ï¼è¿ä¸ªæ¹æ³å¯ä»¥éè¿éç½®æä»¶ææ³¨è§£æ¥æå®ï¼ä¸è¬ç¨äºéæ¾èµæºç­æ¸çå·¥ä½ã\n\néè¦æ³¨æçæ¯ï¼ä¸æ¯ææç Bean é½éè¦å®ç°ææé¶æ®µï¼å¯ä»¥æ ¹æ®å·ä½éæ±æ¥å³å®æ¯å¦å®ç°æä¸ªé¶æ®µçåè°æ¹æ³ãèä¸ï¼Bean ççå½å¨æä¹å¯ä»¥éè¿ç¼å BeanPostProcessor çå®ç°ç±»æ¥è¿è¡èªå®ä¹ï¼è¿å¯ä»¥è®©å¼åèå¨ Bean åå§ååæåå§ååæ§è¡ä¸äºé¢å¤çæä½ã\n\n\n# Bean çä½ç¨å\n\n 1. singleton : å¯ä¸ bean å®ä¾ï¼Spring ä¸­ç bean é»è®¤é½æ¯åä¾çï¼\n 2. prototype : æ¯æ¬¡è¯·æ±é½ä¼åå»ºä¸ä¸ªæ°ç bean å®ä¾ï¼\n 3. requestï¼æ¯ä¸æ¬¡ HTTP è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ç beanï¼è¯¥ bean ä»å¨å½å HTTP request åææï¼\n 4. session : æ¯ä¸æ¬¡ HTTP è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ç beanï¼è¯¥ bean ä»å¨å½å HTTP session åææï¼\n 5. global-sessionï¼å¨å± session ä½ç¨åï¼ä»ä»å¨åºäº portlet ç web åºç¨ä¸­æææä¹ï¼Spring5 å·²ç»æ²¡æäºãPortlet æ¯è½å¤çæè¯­ä¹ä»£ç (ä¾å¦ï¼HTML)çæ®µçå°å Java Web æä»¶ãå®ä»¬åºäº portlet å®¹å¨ï¼å¯ä»¥å servlet ä¸æ ·å¤ç HTTP è¯·æ±ãä½æ¯ï¼ä¸ servlet ä¸åï¼æ¯ä¸ª portlet é½æä¸åçä¼è¯ã\n\n\n# åä¾Bean çå¥½å¤\n\nåä¾ Bean æ¯ Spring å®¹å¨ä¸­æå¸¸è§çä¸ç§ Beanï¼å¶ä¸»è¦å¥½å¤åæ¬ï¼\n\n 1. èçèµæºï¼åä¾ Bean å¨ Spring å®¹å¨ä¸­åªä¼è¢«åå»ºä¸æ¬¡ï¼è¿å¯ä»¥åå°åå»ºåéæ¯ Bean çå¼éï¼ä»èåå°åå­å CPU çä½¿ç¨ï¼æé«ç³»ç»æ§è½ã\n 2. ç»´æ¤ç¶æï¼åä¾ Bean å¯ä»¥ç»´æ¤ç¶æï¼å ä¸ºå®åªä¼è¢«åå»ºä¸æ¬¡ï¼å¯ä»¥å¨æ´ä¸ªåºç¨ç¨åºççå½å¨æä¸­ä¿æç¶æçä¸è´æ§ã\n 3. ä¾¿äºç®¡çï¼åä¾ Bean å¨æ´ä¸ªåºç¨ç¨åºä¸­é½æ¯å¯ä¸çï¼è¿ä½¿å¾å®ä»¬æäºç®¡çåç»´æ¤ï¼å ä¸ºå¨æ´ä¸ªåºç¨ç¨åºä¸­åªæä¸ä¸ªå®ä¾ã\n 4. æé«æ§è½ï¼åä¾ Bean çåå»ºåéæ¯åªä¼åçä¸æ¬¡ï¼è¿å¯ä»¥é¿åé¢ç¹å°åå»ºåéæ¯ Bean æå¸¦æ¥çæ§è½æå¤±ãåæ¶ï¼ç±äºåä¾ Bean çå®ä¾åªæä¸ä¸ªï¼å¯ä»¥é¿åéå¤çå¯¹è±¡åå»ºååå­å ç¨ã\n 5. ç®åä¾èµæ³¨å¥ï¼åä¾ Bean å¨æ´ä¸ªåºç¨ç¨åºä¸­é½æ¯å¯ä¸çï¼å æ­¤å¯ä»¥å¾æ¹ä¾¿å°è¢«æ³¨å¥å°å¶ä» Bean ä¸­ï¼ä»èç®åäºä¾èµæ³¨å¥çä»£ç ã\n\n\n# åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢\n\nåä¾ Bean å¨ Spring å®¹å¨ä¸­åªä¼åå»ºä¸æ¬¡ï¼å®ä¼å¨å®¹å¨åå§åæ¶è¢«åå»ºï¼ä¹åä¼ä¸ç´å­å¨äºå®¹å¨ä¸­ï¼ç´å°å®¹å¨è¢«éæ¯ãå ä¸ºåä¾ Bean åªæä¸ä¸ªå®ä¾ï¼æä»¥å¨å¤çº¿ç¨ç¯å¢ä¸ï¼ä¸åççº¿ç¨å¯è½ä¼åæ¶è®¿é®åä¸ä¸ªåä¾ Bean å®ä¾ï¼ä»èå¯è½å¯¼è´çº¿ç¨å®å¨é®é¢ã\n\nå¦æåä¾ Bean å­å¨å±äº«çå¯åç¶æï¼æ¯å¦å±æ§æéæåéï¼é£ä¹å¤çº¿ç¨è®¿é®è¿äºç¶ææ¶å°±ä¼å­å¨ç«äºæ¡ä»¶ï¼Race Conditionï¼åæ°æ®ä¸ä¸è´ç­é®é¢ãæ¯å¦ï¼å¨ä¸ä¸ªå¤çº¿ç¨çç¯å¢ä¸ï¼ä¸ä¸ªçº¿ç¨æ­£å¨ä¿®æ¹ Bean çæä¸ªå±æ§ï¼èå¦ä¸ä¸ªçº¿ç¨åæ¶ä¹å¨è®¿é®è¯¥å±æ§ï¼é£ä¹å°±å¯è½å¯¼è´è¯¥å±æ§å¼çä¸ç¡®å®æ§åçº¿ç¨å®å¨é®é¢ã\n\nä¸ºäºè§£å³åä¾ Bean ççº¿ç¨å®å¨é®é¢ï¼å¯ä»¥éç¨ä»¥ä¸å ç§æ¹å¼ï¼\n\n 1. é¿åå¨åä¾ Bean ä¸­å®ä¹å±äº«çå¯åç¶æï¼æèå°å±äº«çå¯åç¶æéå¶å¨æ¹æ³å±é¨åéä¸­ã\n 2. ä½¿ç¨çº¿ç¨å®å¨çæ°æ®ç»æï¼å¦ ConcurrentHashMapãConcurrentLinkedQueue ç­ï¼æ¥ä¿è¯å¤çº¿ç¨è®¿é®æ¶ççº¿ç¨å®å¨ã\n 3. å¨éè¦å±äº«ç¶æçæåµä¸ï¼ä½¿ç¨ synchronized å³é®å­æè ReentrantLock ç­æ¹å¼æ¥ä¿è¯çº¿ç¨å®å¨ã\n 4. å°åä¾ Bean æ¿æ¢æåå Beanï¼å³æ¯æ¬¡ä»å®¹å¨ä¸­è·å Bean æ¶é½ä¼åå»ºä¸ä¸ªæ°çå®ä¾ãè¿ç§æ¹å¼å¯ä»¥ä¿è¯ Bean ççº¿ç¨å®å¨ï¼ä½ä¼å¢å åå­å¼éã\n 5. å¨ç±»ä¸­å®ä¹ä¸ä¸ª ThreadLocal æååéï¼å°éè¦çå¯åæååéä¿å­å¨ ThreadLocal ä¸­ï¼æ¨èï¼ã\n\n\n# Spring äºå¡",normalizedContent:"# iocççè§£\n\nioc æ¯ inversion of control æ§å¶åè½¬ã\n\nè½¯ä»¶ç³»ç»å¨æ²¡æå¼å¥ ioc å®¹å¨ä¹åï¼å¯¹è±¡ a ä¾èµäºå¯¹è±¡ bï¼é£ä¹å¯¹è±¡ a å¨åå§åæèè¿è¡å°æä¸ç¹çæ¶åï¼èªå·±å¿é¡»ä¸»å¨å»åå»ºå¯¹è±¡ b æèä½¿ç¨å·²ç»åå»ºçå¯¹è±¡ bãæ è®ºæ¯åå»ºè¿æ¯ä½¿ç¨å¯¹è±¡ bï¼æ§å¶æé½å¨èªå·±æä¸ã\n\nè½¯ä»¶ç³»ç»å¨å¼å¥ ioc å®¹å¨ä¹åï¼è¿ç§æå½¢å°±å®å¨æ¹åäºï¼ç±äº ioc å®¹å¨çå å¥ï¼å¯¹è±¡ a ä¸å¯¹è±¡ b ä¹é´å¤±å»äºç´æ¥èç³»ï¼æä»¥ï¼å½å¯¹è±¡ a è¿è¡å°éè¦å¯¹è±¡ b çæ¶åï¼ioc å®¹å¨ä¼ä¸»å¨åå»ºä¸ä¸ªå¯¹è±¡ b æ³¨å¥å°å¯¹è±¡ a éè¦çå°æ¹ã\n\nå¯¹è±¡ a è·å¾ä¾èµå¯¹è±¡ b çè¿ç¨ï¼ç±ä¸»å¨è¡ä¸ºåä¸ºäºè¢«å¨è¡ä¸ºï¼æ§å¶æé¢ åè¿æ¥äºï¼è¿å°±æ¯âæ§å¶åè½¬âè¿ä¸ªåç§°çç±æ¥ã\n\n\n# iocçå®ç°åç\n\nspring ioc (inversion of control) çå®ç°åçåºäºä¾èµæ³¨å¥ (dependency injection) æ¨¡å¼ï¼å®ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼\n\n 1. éç½®ï¼éè¿ xml æä»¶æ java éç½®ç±»ç­æ¹å¼ï¼å®ä¹ spring bean çéç½®ä¿¡æ¯ï¼åæ¬ç±»åãæé å½æ°åæ°ãå±æ§å¼ç­ã\n 2. å®ä¾åï¼spring æ ¹æ®éç½®ä¿¡æ¯åå»º bean çå®ä¾ï¼éå¸¸ä½¿ç¨ java åå°æºå¶æ¥å®ç°ã\n 3. ä¾èµæ³¨å¥ï¼spring æ ¹æ®éç½®ä¿¡æ¯ï¼å°åå»ºå¥½ç bean å®ä¾æ³¨å¥å°éè¦å®çå°æ¹ï¼åæ¬æé å½æ°æ³¨å¥ãsetter æ¹æ³æ³¨å¥ç­ã\n 4. çå½å¨æç®¡çï¼spring ç®¡ç bean ççå½å¨æï¼åæ¬åå§ååéæ¯ç­é¶æ®µï¼å¯ä»¥å¨ bean ä¸­å®ä¹åå§åæ¹æ³åéæ¯æ¹æ³ï¼spring ä¼å¨ç¸åºçé¶æ®µè°ç¨å®ä»¬ã\n\nå·ä½å®ç°ä¸ï¼spring ä½¿ç¨äºä¸ä¸ªå«å beanfactory çå®¹å¨æ¥ç®¡çææç beanï¼è¿ä¸ªå®¹å¨å¨åå§åæ¶ä¼è¯»åéç½®æä»¶æéç½®ç±»ï¼ç¶åæ ¹æ®éç½®ä¿¡æ¯åå»º bean å®ä¾ï¼å¹¶å°å®ä»¬å­å¨å¨ä¸ä¸ª map ä¸­ãå½å¶ä» bean éè¦ä¾èµè¿äº bean æ¶ï¼spring ä¼ä» map ä¸­ååºç¸åºç bean å®ä¾ï¼å¹¶å°å®ä»¬æ³¨å¥å°éè¦å®ä»¬çå°æ¹ã\n\nspring ioc çå®ç°åçä½¿å¾å¼åèå¯ä»¥æ´å å³æ³¨ä¸å¡é»è¾ï¼èä¸éè¦è¿å¤å³æ³¨ bean çåå»ºåç®¡çï¼ä»èæé«äºå¼åæçåä»£ç çå¯ç»´æ¤æ§ã\n\n\n# aopççè§£\n\naopï¼aspect-oriented programmingï¼é¢ååé¢ç¼ç¨ï¼ï¼å¯ä»¥è¯´æ¯ oopï¼object-oriented programingï¼é¢åå¯¹è±¡ç¼ç¨ï¼çè¡¥ååå®åãoop å¼å¥å°è£ãç»§æ¿åå¤ææ§ç­æ¦å¿µæ¥å»ºç«ä¸ç§å¯¹è±¡å±æ¬¡ç»æï¼ç¨ä»¥æ¨¡æå¬å±è¡ä¸ºçä¸ä¸ªéåãå½æä»¬éè¦ä¸ºåæ£çå¯¹è±¡å¼å¥å¬å±è¡ä¸ºçæ¶åï¼oop åæ¾å¾æ è½ä¸ºåãä¹å°±æ¯è¯´ï¼oop åè®¸ä½ å®ä¹ä»ä¸å°ä¸çå³ç³»ï¼ä½å¹¶ä¸éåå®ä¹ä»å·¦å°å³çå³ç³»ãä¾å¦æ¥å¿åè½ãæ¥å¿ä»£ç å¾å¾æ°´å¹³å°æ£å¸å¨ææå¯¹è±¡å±æ¬¡ä¸­ï¼èä¸å®ææ£å¸å°çå¯¹è±¡çæ ¸å¿åè½æ¯«æ å³ç³»ãå¯¹äºå¶ä»ç±»åçä»£ç ï¼å¦ï¼å®å¨æ§ãå¼å¸¸å¤çåéæçæç»­æ§ä¹æ¯å¦æ­¤ãè¿ç§æ£å¸å¨åå¤çæ å³çä»£ç è¢«ç§°ä¸ºæ¨ªåï¼cross-cuttingï¼ä»£ç ï¼å¨ oop è®¾è®¡ä¸­ï¼å®å¯¼è´äºå¤§éä»£ç çéå¤ï¼èä¸å©äºåä¸ªæ¨¡åçéç¨ã\n\nè aop ææ¯åæ°æ°ç¸åï¼å®å©ç¨ä¸ç§ç§°ä¸ºâæ¨ªåâçææ¯ï¼åè§£å¼å°è£çå¯¹è±¡åé¨ï¼å¹¶å°é£äºå½±åäºå¤ä¸ªç±»çå¬å±è¡ä¸ºå°è£å°ä¸ä¸ªå¯éç¨æ¨¡åï¼å¹¶å°å¶åä¸ºâaspectâï¼å³åé¢ãæè°âåé¢âï¼ç®åå°è¯´ï¼å°±æ¯å°é£äºä¸ä¸å¡æ å³ï¼å´ä¸ºä¸å¡æ¨¡åæå±åè°ç¨çé»è¾æè´£ä»»å°è£èµ·æ¥ï¼ä¾¿äºåå°ç³»ç»çéå¤ä»£ç ï¼éä½æ¨¡åé´çè¦ååº¦ï¼å¹¶æå©äºæªæ¥çå¯æä½æ§åå¯ç»´æ¤æ§ãaop ä»£è¡¨çæ¯ä¸ä¸ªæ¨ªåçå³ç³»ï¼å¦æè¯´âå¯¹è±¡âæ¯ä¸ä¸ªç©ºå¿çåæ±ä½ï¼å¶ä¸­å°è£çæ¯å¯¹è±¡çå±æ§åè¡ä¸ºï¼é£ä¹é¢åæ¹é¢ç¼ç¨çæ¹æ³ï¼å°±ä»¿ä½ä¸æå©åï¼å°è¿äºç©ºå¿åæ±ä½åå¼ï¼ä»¥è·å¾å¶åé¨çæ¶æ¯ãèåå¼çåé¢ï¼ä¹å°±æ¯æè°çâæ¹é¢âäºãç¶åå®åä»¥å·§å¤ºå¤©åçå¦æå°è¿äºåå¼çåé¢å¤åï¼ä¸ççè¿¹ã\n\nä½¿ç¨âæ¨ªåâææ¯ï¼aop æè½¯ä»¶ç³»ç»åä¸ºä¸¤ä¸ªé¨åï¼æ ¸å¿å³æ³¨ç¹åæ¨ªåå³æ³¨ç¹ãä¸å¡å¤ççä¸»è¦æµç¨æ¯æ ¸å¿å³æ³¨ç¹ï¼ä¸ä¹å³ç³»ä¸å¤§çé¨åæ¯æ¨ªåå³æ³¨ç¹ãæ¨ªåå³æ³¨ç¹çä¸ä¸ªç¹ç¹æ¯ï¼å®ä»¬ç»å¸¸åçå¨æ ¸å¿å³æ³¨ç¹çå¤å¤ï¼èåå¤é½åºæ¬ç¸ä¼¼ãæ¯å¦ï¼æéè®¤è¯ãæ¥å¿ãäºå¡å¤çãaop çä½ç¨å¨äºåç¦»ç³»ç»ä¸­çåç§å³æ³¨ç¹ï¼å°æ ¸å¿å³æ³¨ç¹åæ¨ªåå³æ³¨ç¹åç¦»å¼æ¥ã\n\n\n# aopçå®ç°åç\n\naop ææ³çå®ç°ä¸è¬é½æ¯åºäºä»£çæ¨¡å¼ ï¼å¨ java ä¸­ä¸è¬éç¨ jdk å¨æä»£çæ¨¡å¼ï¼ä½æ¯æä»¬é½ç¥éï¼jdk å¨æä»£çæ¨¡å¼åªè½ä»£çæ¥å£èä¸è½ä»£çç±»ãå æ­¤ï¼spring aop ä¼æç§ä¸é¢ä¸¤ç§æåµè¿è¡åæ¢ï¼å ä¸º spring aop åæ¶æ¯æ cglibãaspectjãjdk å¨æä»£çã\n\n 1. å¦æç®æ å¯¹è±¡çå®ç°ç±»å®ç°äºæ¥å£ï¼spring aop å°ä¼éç¨ jdk å¨æä»£çæ¥çæ aop ä»£çç±»ï¼\n 2. å¦æç®æ å¯¹è±¡çå®ç°ç±»æ²¡æå®ç°æ¥å£ï¼spring aop å°ä¼éç¨ cglib æ¥çæ aop ä»£çç±»ãä¸è¿è¿ä¸ªéæ©è¿ç¨å¯¹å¼åèå®å¨éæãå¼åèä¹æ éå³å¿ã\n\n\n# beanççå½å¨æ\n\n 1. å®ä¾åï¼spring æ ¹æ®éç½®ä¿¡æ¯åå»º bean å®ä¾ï¼éå¸¸ä½¿ç¨ java åå°æºå¶æ¥å®ç°ã\n 2. å±æ§èµå¼ï¼spring æ ¹æ®éç½®ä¿¡æ¯ææ³¨è§£å°å±æ§å¼æ³¨å¥å° bean ä¸­ã\n 3. aware åè°ï¼spring è°ç¨å®ç°äºç¸åºæ¥å£ç bean çåè°æ¹æ³ï¼ä¾å¦ beannameawareãbeanfactoryawareãapplicationcontextaware ç­ã\n 4. åå§åï¼spring æ§è¡åå§åæ¹æ³ï¼è¿ä¸ªæ¹æ³å¯ä»¥éè¿éç½®æä»¶ææ³¨è§£æ¥æå®ï¼ä¸è¬ç¨äº bean çåå§åå·¥ä½ã\n 5. åå§ååå¤çï¼spring æ§è¡å®ç°äº beanpostprocessor æ¥å£çç±»ç postprocessbeforeinitialization æ¹æ³å postprocessafterinitialization æ¹æ³ï¼è¿ä¸¤ä¸ªæ¹æ³å¯ä»¥å¨ bean åå§ååååå§ååè¿è¡ä¸äºæä½ã\n 6. ä½¿ç¨ï¼bean å¯ä»¥è¢«ä½¿ç¨äºï¼æ§è¡ç¸å³çä¸å¡é»è¾ã\n 7. éæ¯ï¼spring æ§è¡éæ¯æ¹æ³ï¼è¿ä¸ªæ¹æ³å¯ä»¥éè¿éç½®æä»¶ææ³¨è§£æ¥æå®ï¼ä¸è¬ç¨äºéæ¾èµæºç­æ¸çå·¥ä½ã\n\néè¦æ³¨æçæ¯ï¼ä¸æ¯ææç bean é½éè¦å®ç°ææé¶æ®µï¼å¯ä»¥æ ¹æ®å·ä½éæ±æ¥å³å®æ¯å¦å®ç°æä¸ªé¶æ®µçåè°æ¹æ³ãèä¸ï¼bean ççå½å¨æä¹å¯ä»¥éè¿ç¼å beanpostprocessor çå®ç°ç±»æ¥è¿è¡èªå®ä¹ï¼è¿å¯ä»¥è®©å¼åèå¨ bean åå§ååæåå§ååæ§è¡ä¸äºé¢å¤çæä½ã\n\n\n# bean çä½ç¨å\n\n 1. singleton : å¯ä¸ bean å®ä¾ï¼spring ä¸­ç bean é»è®¤é½æ¯åä¾çï¼\n 2. prototype : æ¯æ¬¡è¯·æ±é½ä¼åå»ºä¸ä¸ªæ°ç bean å®ä¾ï¼\n 3. requestï¼æ¯ä¸æ¬¡ http è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ç beanï¼è¯¥ bean ä»å¨å½å http request åææï¼\n 4. session : æ¯ä¸æ¬¡ http è¯·æ±é½ä¼äº§çä¸ä¸ªæ°ç beanï¼è¯¥ bean ä»å¨å½å http session åææï¼\n 5. global-sessionï¼å¨å± session ä½ç¨åï¼ä»ä»å¨åºäº portlet ç web åºç¨ä¸­æææä¹ï¼spring5 å·²ç»æ²¡æäºãportlet æ¯è½å¤çæè¯­ä¹ä»£ç (ä¾å¦ï¼html)çæ®µçå°å java web æä»¶ãå®ä»¬åºäº portlet å®¹å¨ï¼å¯ä»¥å servlet ä¸æ ·å¤ç http è¯·æ±ãä½æ¯ï¼ä¸ servlet ä¸åï¼æ¯ä¸ª portlet é½æä¸åçä¼è¯ã\n\n\n# åä¾bean çå¥½å¤\n\nåä¾ bean æ¯ spring å®¹å¨ä¸­æå¸¸è§çä¸ç§ beanï¼å¶ä¸»è¦å¥½å¤åæ¬ï¼\n\n 1. èçèµæºï¼åä¾ bean å¨ spring å®¹å¨ä¸­åªä¼è¢«åå»ºä¸æ¬¡ï¼è¿å¯ä»¥åå°åå»ºåéæ¯ bean çå¼éï¼ä»èåå°åå­å cpu çä½¿ç¨ï¼æé«ç³»ç»æ§è½ã\n 2. ç»´æ¤ç¶æï¼åä¾ bean å¯ä»¥ç»´æ¤ç¶æï¼å ä¸ºå®åªä¼è¢«åå»ºä¸æ¬¡ï¼å¯ä»¥å¨æ´ä¸ªåºç¨ç¨åºççå½å¨æä¸­ä¿æç¶æçä¸è´æ§ã\n 3. ä¾¿äºç®¡çï¼åä¾ bean å¨æ´ä¸ªåºç¨ç¨åºä¸­é½æ¯å¯ä¸çï¼è¿ä½¿å¾å®ä»¬æäºç®¡çåç»´æ¤ï¼å ä¸ºå¨æ´ä¸ªåºç¨ç¨åºä¸­åªæä¸ä¸ªå®ä¾ã\n 4. æé«æ§è½ï¼åä¾ bean çåå»ºåéæ¯åªä¼åçä¸æ¬¡ï¼è¿å¯ä»¥é¿åé¢ç¹å°åå»ºåéæ¯ bean æå¸¦æ¥çæ§è½æå¤±ãåæ¶ï¼ç±äºåä¾ bean çå®ä¾åªæä¸ä¸ªï¼å¯ä»¥é¿åéå¤çå¯¹è±¡åå»ºååå­å ç¨ã\n 5. ç®åä¾èµæ³¨å¥ï¼åä¾ bean å¨æ´ä¸ªåºç¨ç¨åºä¸­é½æ¯å¯ä¸çï¼å æ­¤å¯ä»¥å¾æ¹ä¾¿å°è¢«æ³¨å¥å°å¶ä» bean ä¸­ï¼ä»èç®åäºä¾èµæ³¨å¥çä»£ç ã\n\n\n# åä¾beanå¯è½å¯¼è´ççº¿ç¨é®é¢\n\nåä¾ bean å¨ spring å®¹å¨ä¸­åªä¼åå»ºä¸æ¬¡ï¼å®ä¼å¨å®¹å¨åå§åæ¶è¢«åå»ºï¼ä¹åä¼ä¸ç´å­å¨äºå®¹å¨ä¸­ï¼ç´å°å®¹å¨è¢«éæ¯ãå ä¸ºåä¾ bean åªæä¸ä¸ªå®ä¾ï¼æä»¥å¨å¤çº¿ç¨ç¯å¢ä¸ï¼ä¸åççº¿ç¨å¯è½ä¼åæ¶è®¿é®åä¸ä¸ªåä¾ bean å®ä¾ï¼ä»èå¯è½å¯¼è´çº¿ç¨å®å¨é®é¢ã\n\nå¦æåä¾ bean å­å¨å±äº«çå¯åç¶æï¼æ¯å¦å±æ§æéæåéï¼é£ä¹å¤çº¿ç¨è®¿é®è¿äºç¶ææ¶å°±ä¼å­å¨ç«äºæ¡ä»¶ï¼race conditionï¼åæ°æ®ä¸ä¸è´ç­é®é¢ãæ¯å¦ï¼å¨ä¸ä¸ªå¤çº¿ç¨çç¯å¢ä¸ï¼ä¸ä¸ªçº¿ç¨æ­£å¨ä¿®æ¹ bean çæä¸ªå±æ§ï¼èå¦ä¸ä¸ªçº¿ç¨åæ¶ä¹å¨è®¿é®è¯¥å±æ§ï¼é£ä¹å°±å¯è½å¯¼è´è¯¥å±æ§å¼çä¸ç¡®å®æ§åçº¿ç¨å®å¨é®é¢ã\n\nä¸ºäºè§£å³åä¾ bean ççº¿ç¨å®å¨é®é¢ï¼å¯ä»¥éç¨ä»¥ä¸å ç§æ¹å¼ï¼\n\n 1. é¿åå¨åä¾ bean ä¸­å®ä¹å±äº«çå¯åç¶æï¼æèå°å±äº«çå¯åç¶æéå¶å¨æ¹æ³å±é¨åéä¸­ã\n 2. ä½¿ç¨çº¿ç¨å®å¨çæ°æ®ç»æï¼å¦ concurrenthashmapãconcurrentlinkedqueue ç­ï¼æ¥ä¿è¯å¤çº¿ç¨è®¿é®æ¶ççº¿ç¨å®å¨ã\n 3. å¨éè¦å±äº«ç¶æçæåµä¸ï¼ä½¿ç¨ synchronized å³é®å­æè reentrantlock ç­æ¹å¼æ¥ä¿è¯çº¿ç¨å®å¨ã\n 4. å°åä¾ bean æ¿æ¢æåå beanï¼å³æ¯æ¬¡ä»å®¹å¨ä¸­è·å bean æ¶é½ä¼åå»ºä¸ä¸ªæ°çå®ä¾ãè¿ç§æ¹å¼å¯ä»¥ä¿è¯ bean ççº¿ç¨å®å¨ï¼ä½ä¼å¢å åå­å¼éã\n 5. å¨ç±»ä¸­å®ä¹ä¸ä¸ª threadlocal æååéï¼å°éè¦çå¯åæååéä¿å­å¨ threadlocal ä¸­ï¼æ¨èï¼ã\n\n\n# spring äºå¡",charsets:{cjk:!0}},{title:"Spring boot èªå¨è£é",frontmatter:{title:"Spring boot èªå¨è£é",date:"2023-08-04T15:56:12.000Z",permalink:"/pages/581456/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/02.Spring%20boot%20%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D.html",relativePath:"09.Javaæ¡æ¶/01.Spring/02.Spring boot èªå¨è£é.md",key:"v-097ed174",path:"/pages/581456/",headers:[{level:2,title:"ä»ä¹æ¯ spring boot èªå¨è£éï¼",slug:"ä»ä¹æ¯-spring-boot-èªå¨è£é",normalizedTitle:"ä»ä¹æ¯ spring boot èªå¨è£éï¼",charIndex:22},{level:2,title:"spring boot èªå¨è£éçåçæ¯ä»ä¹ï¼",slug:"spring-boot-èªå¨è£éçåçæ¯ä»ä¹",normalizedTitle:"spring boot èªå¨è£éçåçæ¯ä»ä¹ï¼",charIndex:304},{level:2,title:"spring.factoriesåspring-autoconfigure-metadata.propertiesåºå«",slug:"spring-factoriesåspring-autoconfigure-metadata-propertiesåºå«",normalizedTitle:"spring.factoriesåspring-autoconfigure-metadata.propertiesåºå«",charIndex:701},{level:2,title:"spring 3.0ï¼å¼ç¨ spring.factories ï¼",slug:"spring-3-0-å¼ç¨-spring-factories",normalizedTitle:"spring 3.0ï¼å¼ç¨ spring.factories ï¼",charIndex:805},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1407}],headersStr:"ä»ä¹æ¯ spring boot èªå¨è£éï¼ spring boot èªå¨è£éçåçæ¯ä»ä¹ï¼ spring.factoriesåspring-autoconfigure-metadata.propertiesåºå« spring 3.0ï¼å¼ç¨ spring.factories ï¼ åè",content:"å¥½å¤æç« æ¯åå¾çå·®ãå·®é£ä¹ç¹ææã\n\n\n# ä»ä¹æ¯ spring boot èªå¨è£éï¼\n\nå®éä¸ Spring Framework æ©å°±å®ç°äºè¿ä¸ªåè½ãSpring Boot åªæ¯å¨å¶åºç¡ä¸ï¼éè¿ SPI çæ¹å¼ï¼åäºè¿ä¸æ­¥ä¼åã\n\nSpringBoot å®ä¹äºä¸å¥æ¥å£è§èï¼è¿å¥è§èè§å®ï¼SpringBoot å¨å¯å¨æ¶ä¼æ«æå¤é¨å¼ç¨ jar åä¸­çMETA-INF/spring.factoriesæä»¶ï¼å°æä»¶ä¸­éç½®çç±»åä¿¡æ¯å è½½å° Spring å®¹å¨ï¼å¹¶æ§è¡ç±»ä¸­å®ä¹çåç§æä½ãå¯¹äºå¤é¨ jar æ¥è¯´ï¼åªéè¦æç§ SpringBoot å®ä¹çæ åï¼å°±è½å°èªå·±çåè½è£ç½®è¿ SpringBootã\n\n\n# spring boot èªå¨è£éçåçæ¯ä»ä¹ï¼\n\nSpring Boot èªå¨éç½®ä¸»è¦æ¯ @EnableAutoConfiguration å®ç°çï¼@EnableAutoConfiguration æ³¨è§£å¯¼å¥ AutoConfigurationImportSelectorç±»,éè¿ selectImports æ¹æ³è°ç¨ SpringFactoriesLoader.loadFactoryNames() æ«æææå«æ META-INF/spring.factories æä»¶ç jar åï¼å° spring.factories æä»¶ä¸­ @EnableAutoConfiguration å¯¹åºçç±»æ³¨å¥å° IOC å®¹å¨ä¸­ã\n\nè¿äºå±æ§èªå¨éç½®å° IOC ä¹åå°±æ éèªå·±æå¨éç½® bean äºï¼Spring boot ä¸­ççº¦å®å¤§äºéç½®çå¿µï¼çº¦å®æ¯å°éè¦çéç½®ä»¥çº¦å®çæ¹å¼æ·»å å° IOC å®¹å¨ä¸­ã\n\n\n# spring.factoriesåspring-autoconfigure-metadata.propertiesåºå«\n\nhttps://zhuanlan.zhihu.com/p/594950918\n\n\n# spring 3.0ï¼å¼ç¨ spring.factories ï¼\n\nSpring Boot 2.7ä¸­ï¼æä¸ä¸ªä¸æ¨èä½¿ç¨çåå®¹å°±æ¯å³äº/META-INF/spring.factoriesæä»¶ï¼æä»¥å¯¹äºæèªå®ä¹Starterçå¼åèæ¥è¯´ï¼ææ¶é´è¦æç´§æè¿ä¸ååæ¹èµ·æ¥äºï¼å ä¸ºå¨Spring Boot 3å¼å§å°ç§»é¤å¯¹/META-INF/spring.factoriesçæ¯æã\n\nå·ä½ååï¼swaggerçstarterä¸ºä¾ï¼å®ç``åå®¹æ¯è¿æ ·çï¼\n\nbeforeï¼/META-INF/spring.factories\n\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\n  com.spring4all.swagger.SwaggerAutoConfiguration\n\n\nafterï¼/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.importsï¼åªéè¦åå»ºä¸ä¸ªæ°çæä»¶ï¼åå®¹çè¯åªéè¦ç´æ¥æ¾éç½®ç±»\n\ncom.spring4all.swagger.SwaggerAutoConfiguration\n\n\nhttps://blog.didispace.com/spring-factories-deprecations/\n\n\n# åè\n\n * https://www.cnblogs.com/javaguide/p/springboot-auto-config.html\n\n * https://juejin.cn/post/7162568709955911717#heading-8\n\n * https://zhuanlan.zhihu.com/p/594950918\n\n * https://blog.didispace.com/spring-factories-deprecations/",normalizedContent:"å¥½å¤æç« æ¯åå¾çå·®ãå·®é£ä¹ç¹ææã\n\n\n# ä»ä¹æ¯ spring boot èªå¨è£éï¼\n\nå®éä¸ spring framework æ©å°±å®ç°äºè¿ä¸ªåè½ãspring boot åªæ¯å¨å¶åºç¡ä¸ï¼éè¿ spi çæ¹å¼ï¼åäºè¿ä¸æ­¥ä¼åã\n\nspringboot å®ä¹äºä¸å¥æ¥å£è§èï¼è¿å¥è§èè§å®ï¼springboot å¨å¯å¨æ¶ä¼æ«æå¤é¨å¼ç¨ jar åä¸­çmeta-inf/spring.factoriesæä»¶ï¼å°æä»¶ä¸­éç½®çç±»åä¿¡æ¯å è½½å° spring å®¹å¨ï¼å¹¶æ§è¡ç±»ä¸­å®ä¹çåç§æä½ãå¯¹äºå¤é¨ jar æ¥è¯´ï¼åªéè¦æç§ springboot å®ä¹çæ åï¼å°±è½å°èªå·±çåè½è£ç½®è¿ springbootã\n\n\n# spring boot èªå¨è£éçåçæ¯ä»ä¹ï¼\n\nspring boot èªå¨éç½®ä¸»è¦æ¯ @enableautoconfiguration å®ç°çï¼@enableautoconfiguration æ³¨è§£å¯¼å¥ autoconfigurationimportselectorç±»,éè¿ selectimports æ¹æ³è°ç¨ springfactoriesloader.loadfactorynames() æ«æææå«æ meta-inf/spring.factories æä»¶ç jar åï¼å° spring.factories æä»¶ä¸­ @enableautoconfiguration å¯¹åºçç±»æ³¨å¥å° ioc å®¹å¨ä¸­ã\n\nè¿äºå±æ§èªå¨éç½®å° ioc ä¹åå°±æ éèªå·±æå¨éç½® bean äºï¼spring boot ä¸­ççº¦å®å¤§äºéç½®çå¿µï¼çº¦å®æ¯å°éè¦çéç½®ä»¥çº¦å®çæ¹å¼æ·»å å° ioc å®¹å¨ä¸­ã\n\n\n# spring.factoriesåspring-autoconfigure-metadata.propertiesåºå«\n\nhttps://zhuanlan.zhihu.com/p/594950918\n\n\n# spring 3.0ï¼å¼ç¨ spring.factories ï¼\n\nspring boot 2.7ä¸­ï¼æä¸ä¸ªä¸æ¨èä½¿ç¨çåå®¹å°±æ¯å³äº/meta-inf/spring.factoriesæä»¶ï¼æä»¥å¯¹äºæèªå®ä¹starterçå¼åèæ¥è¯´ï¼ææ¶é´è¦æç´§æè¿ä¸ååæ¹èµ·æ¥äºï¼å ä¸ºå¨spring boot 3å¼å§å°ç§»é¤å¯¹/meta-inf/spring.factoriesçæ¯æã\n\nå·ä½ååï¼swaggerçstarterä¸ºä¾ï¼å®ç``åå®¹æ¯è¿æ ·çï¼\n\nbeforeï¼/meta-inf/spring.factories\n\norg.springframework.boot.autoconfigure.enableautoconfiguration=\\\n  com.spring4all.swagger.swaggerautoconfiguration\n\n\nafterï¼/meta-inf/spring/org.springframework.boot.autoconfigure.autoconfiguration.importsï¼åªéè¦åå»ºä¸ä¸ªæ°çæä»¶ï¼åå®¹çè¯åªéè¦ç´æ¥æ¾éç½®ç±»\n\ncom.spring4all.swagger.swaggerautoconfiguration\n\n\nhttps://blog.didispace.com/spring-factories-deprecations/\n\n\n# åè\n\n * https://www.cnblogs.com/javaguide/p/springboot-auto-config.html\n\n * https://juejin.cn/post/7162568709955911717#heading-8\n\n * https://zhuanlan.zhihu.com/p/594950918\n\n * https://blog.didispace.com/spring-factories-deprecations/",charsets:{cjk:!0}},{title:"Spring IOC",frontmatter:{title:"Spring IOC",date:"2023-08-25T14:37:06.000Z",permalink:"/pages/0bf668/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/03.Spring%20IOC.html",relativePath:"09.Javaæ¡æ¶/01.Spring/03.Spring IOC.md",key:"v-629046d2",path:"/pages/0bf668/",headers:[{level:2,title:"ä»ä¹æ¯ Spring IOC",slug:"ä»ä¹æ¯-spring-ioc",normalizedTitle:"ä»ä¹æ¯ spring ioc",charIndex:2},{level:2,title:"ä»ä¹æ¯ Spring Bean",slug:"ä»ä¹æ¯-spring-bean",normalizedTitle:"ä»ä¹æ¯ spring bean",charIndex:55},{level:2,title:"IOCçéç½®æ¹å¼",slug:"iocçéç½®æ¹å¼",normalizedTitle:"iocçéç½®æ¹å¼",charIndex:214},{level:2,title:"ä¾èµæ³¨å¥çæ¹å¼",slug:"ä¾èµæ³¨å¥çæ¹å¼",normalizedTitle:"ä¾èµæ³¨å¥çæ¹å¼",charIndex:419},{level:2,title:"@Autowiredå@Resourceä»¥å@Injectç­æ³¨è§£æ³¨å¥æä½åºå«ï¼",slug:"autowiredå-resourceä»¥å-injectç­æ³¨è§£æ³¨å¥æä½åºå«",normalizedTitle:"@autowiredå@resourceä»¥å@injectç­æ³¨è§£æ³¨å¥æä½åºå«ï¼",charIndex:1193},{level:2,title:"IOC çåºå±å®ç°",slug:"ioc-çåºå±å®ç°",normalizedTitle:"ioc çåºå±å®ç°",charIndex:2343},{level:2,title:"Spring ä¸­ Bean ççå½å¨æ",slug:"spring-ä¸­-bean-ççå½å¨æ",normalizedTitle:"spring ä¸­ bean ççå½å¨æ",charIndex:2368},{level:2,title:"Spring å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",slug:"spring-å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",normalizedTitle:"spring å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",charIndex:2392}],headersStr:"ä»ä¹æ¯ Spring IOC ä»ä¹æ¯ Spring Bean IOCçéç½®æ¹å¼ ä¾èµæ³¨å¥çæ¹å¼ @Autowiredå@Resourceä»¥å@Injectç­æ³¨è§£æ³¨å¥æä½åºå«ï¼ IOC çåºå±å®ç° Spring ä¸­ Bean ççå½å¨æ Spring å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",content:"# ä»ä¹æ¯ Spring IOC\n\nIoCæ¯è®¾è®¡ææ³ï¼DIæ¯å®ç°æ¹å¼ãæ§å¶åè½¬æ¯éè¿ä¾èµæ³¨å¥å®ç°çã\n\n\n# ä»ä¹æ¯ Spring Bean\n\nIoC Containerç®¡ççæ¯Spring Beanï¼ é£ä¹Spring Beanæ¯ä»ä¹å¢ï¼\n\nSpringéé¢çbeanå°±ç±»ä¼¼æ¯å®ä¹çä¸ä¸ªç»ä»¶ï¼èè¿ä¸ªç»ä»¶çä½ç¨å°±æ¯å®ç°æä¸ªåè½çï¼è¿éæå®ä¹çbeanå°±ç¸å½äºç»äºä½ ä¸ä¸ªæ´ä¸ºç®ä¾¿çæ¹æ³æ¥è°ç¨è¿ä¸ªç»ä»¶å»å®ç°ä½ è¦å®æçåè½ã\n\n\n# IOCçéç½®æ¹å¼\n\nä¸»æµä½¿ç¨ï¼Java éç½® + æ³¨è§£éç½®\n\nä¸ç§ï¼\n\n * xml éç½®\n\n * Java éç½®\n   \n   1. åå»ºä¸ä¸ªéç½®ç±»ï¼ æ·»å @Configurationæ³¨è§£å£°æä¸ºéç½®ç±»\n   \n   2. åå»ºæ¹æ³ï¼æ¹æ³ä¸å ä¸@beanï¼è¯¥æ¹æ³ç¨äºåå»ºå®ä¾å¹¶è¿åï¼è¯¥å®ä¾åå»ºåä¼äº¤ç»springç®¡çï¼æ¹æ³åå»ºè®®ä¸å®ä¾åç¸åï¼é¦å­æ¯å°åï¼ãæ³¨ï¼å®ä¾ç±»ä¸éè¦å ä»»ä½æ³¨è§£\n\n * æ³¨è§£éç½®\n\n\n# ä¾èµæ³¨å¥çæ¹å¼\n\nä¸ç§ï¼\n\n * æé æ¹æ³æ³¨å¥ï¼å¨Spring4.xçæ¬ä¸­æ¨èçæ³¨å¥æ¹å¼ï¼\n * setteræ³¨å¥\n * åºäºæ³¨è§£çå±æ§æ³¨å¥\n\nä¸ºä»ä¹æ¨èæé å¨æ³¨å¥æ¹å¼ï¼\n\næé å¨æ³¨å¥çæ¹å¼è½å¤ä¿è¯æ³¨å¥çç»ä»¶ä¸å¯åï¼å¹¶ä¸ç¡®ä¿éè¦çä¾èµä¸ä¸ºç©ºãæ­¤å¤ï¼æé å¨æ³¨å¥çä¾èµæ»æ¯è½å¤å¨è¿åå®¢æ·ç«¯ï¼ç»ä»¶ï¼ä»£ç çæ¶åä¿è¯å®å¨åå§åçç¶æã\n\n * ä¾èµä¸å¯åï¼å¶å®è¯´çå°±æ¯finalå³é®å­ã\n * ä¾èµä¸ä¸ºç©ºï¼çå»äºæä»¬å¯¹å¶æ£æ¥ï¼ï¼å½è¦å®ä¾åUserServiceImplçæ¶åï¼ç±äºèªå·±å®ç°äºæåæ°çæé å½æ°ï¼æä»¥ä¸ä¼è°ç¨é»è®¤æé å½æ°ï¼é£ä¹å°±éè¦Springå®¹å¨ä¼ å¥æéè¦çåæ°ï¼æä»¥å°±ä¸¤ç§æåµï¼1ãæè¯¥ç±»åçåæ°->ä¼ å¥ï¼OK ã2ï¼æ è¯¥ç±»åçåæ°->æ¥éã\n * å®å¨åå§åçç¶æï¼è¿ä¸ªå¯ä»¥è·ä¸é¢çä¾èµä¸ä¸ºç©ºç»åèµ·æ¥ï¼åæé å¨ä¼ åä¹åï¼è¦ç¡®ä¿æ³¨å¥çåå®¹ä¸ä¸ºç©ºï¼é£ä¹è¯å®è¦è°ç¨ä¾èµç»ä»¶çæé æ¹æ³å®æå®ä¾åãèå¨Javaç±»å è½½å®ä¾åçè¿ç¨ä¸­ï¼æé æ¹æ³æ¯æåä¸æ­¥ï¼ä¹åå¦ææç¶ç±»ååå§åç¶ç±»ï¼ç¶åèªå·±çæååéï¼æåææ¯æé æ¹æ³ï¼ï¼æä»¥è¿åæ¥çé½æ¯åå§åä¹åçç¶æã\n\n@Service\npublic class UserServiceImpl {\n    /**\n     * user dao impl.\n     */\n    private final UserDaoImpl userDao;\n\n    /**\n     * init.\n     * @param userDaoImpl user dao impl\n     */\n    public UserServiceImpl(final UserDaoImpl userDaoImpl) {\n        this.userDao = userDaoImpl;\n    }\n}\n\n\n\n# @Autowiredå@Resourceä»¥å@Injectç­æ³¨è§£æ³¨å¥æä½åºå«ï¼\n\nä¸èå¯¹æ¯ï¼\n\n1ã@Autowiredæ¯Springèªå¸¦çï¼@Resourceæ¯JSR250è§èå®ç°çï¼@Injectæ¯JSR330è§èå®ç°ç\n\n2ã@Autowiredã@Injectç¨æ³åºæ¬ä¸æ ·ï¼ä¸åçæ¯@Injectæ²¡ærequiredå±æ§\n\n3ã@Autowiredã@Injectæ¯é»è®¤æç§ç±»åbytypeå¹éçï¼@Resourceæ¯æç§åç§°bynameå¹éç\n\n4ã@Autowiredå¦æéè¦æç§åç§°å¹ééè¦å@Qualifierä¸èµ·ä½¿ç¨ï¼@Injectå@Namedä¸èµ·ä½¿ç¨ï¼@Resourceåéè¿nameè¿è¡æå®\n\n@Autowired\n\n1ã@Autowiredæ¯Springèªå¸¦çæ³¨è§£ï¼éè¿AutowiredAnnotationBeanPostProcessor ç±»å®ç°çä¾èµæ³¨å¥\n\n2ã@Autowiredå¯ä»¥ä½ç¨å¨CONSTRUCTORãMETHODãPARAMETERãFIELDãANNOTATION_TYPE\n\n3ã@Autowiredé»è®¤æ¯æ ¹æ®ç±»åï¼byType ï¼è¿è¡èªå¨è£éç\n\n4ãå¦ææå¤ä¸ªç±»åä¸æ ·çBeanåéèï¼éè¦æå®æç§åç§°ï¼byName ï¼è¿è¡è£éï¼åéè¦éå@Qualifierã\n\næå®åç§°åï¼å¦æSpring IOCå®¹å¨ä¸­æ²¡æå¯¹åºçç»ä»¶beanæåºNoSuchBeanDefinitionExceptionãä¹å¯ä»¥å°@Autowiredä¸­requiredéç½®ä¸ºfalseï¼å¦æéç½®ä¸ºfalseä¹åï¼å½æ²¡ææ¾å°ç¸åºbeançæ¶åï¼ç³»ç»ä¸ä¼æå¼å¸¸\n\n@Resource\n\n1ã@Resourceæ¯JSR250è§èçå®ç°ï¼å¨javax.annotationåä¸\n\n2ã@Resourceå¯ä»¥ä½ç¨TYPEãFIELDãMETHODä¸\n\n3ã@Resourceæ¯é»è®¤æ ¹æ®å±æ§åç§°è¿è¡èªå¨è£éçï¼å¦ææå¤ä¸ªç±»åä¸æ ·çBeanåéèï¼åå¯ä»¥éè¿nameè¿è¡æå®è¿è¡æ³¨å¥\n\n@Target(ElementType.TYPE) #æ¥å£ãç±»ãæä¸¾ãæ³¨è§£\n@Target(ElementType.FIELD) #å­æ®µãæä¸¾çå¸¸é\n@Target(ElementType.METHOD) #æ¹æ³\n\n\n@Inject\n\n1ã@Injectæ¯JSR330 (Dependency Injection for Java)ä¸­çè§èï¼éè¦å¯¼å¥javax.inject.Inject jarå ï¼æè½å®ç°æ³¨å¥\n\n2ã@Injectå¯ä»¥ä½ç¨CONSTRUCTORãMETHODãFIELDä¸\n\n3ã@Injectæ¯æ ¹æ®ç±»åè¿è¡èªå¨è£éçï¼å¦æéè¦æåç§°è¿è¡è£éï¼åéè¦éå@Namedï¼\n\n\n# IOC çåºå±å®ç°\n\né¡¶å±è®¾è®¡ï¼\n\n\n\n\n\n\n# Spring ä¸­ Bean ççå½å¨æ\n\n\n# Spring å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",normalizedContent:"# ä»ä¹æ¯ spring ioc\n\niocæ¯è®¾è®¡ææ³ï¼diæ¯å®ç°æ¹å¼ãæ§å¶åè½¬æ¯éè¿ä¾èµæ³¨å¥å®ç°çã\n\n\n# ä»ä¹æ¯ spring bean\n\nioc containerç®¡ççæ¯spring beanï¼ é£ä¹spring beanæ¯ä»ä¹å¢ï¼\n\nspringéé¢çbeanå°±ç±»ä¼¼æ¯å®ä¹çä¸ä¸ªç»ä»¶ï¼èè¿ä¸ªç»ä»¶çä½ç¨å°±æ¯å®ç°æä¸ªåè½çï¼è¿éæå®ä¹çbeanå°±ç¸å½äºç»äºä½ ä¸ä¸ªæ´ä¸ºç®ä¾¿çæ¹æ³æ¥è°ç¨è¿ä¸ªç»ä»¶å»å®ç°ä½ è¦å®æçåè½ã\n\n\n# iocçéç½®æ¹å¼\n\nä¸»æµä½¿ç¨ï¼java éç½® + æ³¨è§£éç½®\n\nä¸ç§ï¼\n\n * xml éç½®\n\n * java éç½®\n   \n   1. åå»ºä¸ä¸ªéç½®ç±»ï¼ æ·»å @configurationæ³¨è§£å£°æä¸ºéç½®ç±»\n   \n   2. åå»ºæ¹æ³ï¼æ¹æ³ä¸å ä¸@beanï¼è¯¥æ¹æ³ç¨äºåå»ºå®ä¾å¹¶è¿åï¼è¯¥å®ä¾åå»ºåä¼äº¤ç»springç®¡çï¼æ¹æ³åå»ºè®®ä¸å®ä¾åç¸åï¼é¦å­æ¯å°åï¼ãæ³¨ï¼å®ä¾ç±»ä¸éè¦å ä»»ä½æ³¨è§£\n\n * æ³¨è§£éç½®\n\n\n# ä¾èµæ³¨å¥çæ¹å¼\n\nä¸ç§ï¼\n\n * æé æ¹æ³æ³¨å¥ï¼å¨spring4.xçæ¬ä¸­æ¨èçæ³¨å¥æ¹å¼ï¼\n * setteræ³¨å¥\n * åºäºæ³¨è§£çå±æ§æ³¨å¥\n\nä¸ºä»ä¹æ¨èæé å¨æ³¨å¥æ¹å¼ï¼\n\næé å¨æ³¨å¥çæ¹å¼è½å¤ä¿è¯æ³¨å¥çç»ä»¶ä¸å¯åï¼å¹¶ä¸ç¡®ä¿éè¦çä¾èµä¸ä¸ºç©ºãæ­¤å¤ï¼æé å¨æ³¨å¥çä¾èµæ»æ¯è½å¤å¨è¿åå®¢æ·ç«¯ï¼ç»ä»¶ï¼ä»£ç çæ¶åä¿è¯å®å¨åå§åçç¶æã\n\n * ä¾èµä¸å¯åï¼å¶å®è¯´çå°±æ¯finalå³é®å­ã\n * ä¾èµä¸ä¸ºç©ºï¼çå»äºæä»¬å¯¹å¶æ£æ¥ï¼ï¼å½è¦å®ä¾åuserserviceimplçæ¶åï¼ç±äºèªå·±å®ç°äºæåæ°çæé å½æ°ï¼æä»¥ä¸ä¼è°ç¨é»è®¤æé å½æ°ï¼é£ä¹å°±éè¦springå®¹å¨ä¼ å¥æéè¦çåæ°ï¼æä»¥å°±ä¸¤ç§æåµï¼1ãæè¯¥ç±»åçåæ°->ä¼ å¥ï¼ok ã2ï¼æ è¯¥ç±»åçåæ°->æ¥éã\n * å®å¨åå§åçç¶æï¼è¿ä¸ªå¯ä»¥è·ä¸é¢çä¾èµä¸ä¸ºç©ºç»åèµ·æ¥ï¼åæé å¨ä¼ åä¹åï¼è¦ç¡®ä¿æ³¨å¥çåå®¹ä¸ä¸ºç©ºï¼é£ä¹è¯å®è¦è°ç¨ä¾èµç»ä»¶çæé æ¹æ³å®æå®ä¾åãèå¨javaç±»å è½½å®ä¾åçè¿ç¨ä¸­ï¼æé æ¹æ³æ¯æåä¸æ­¥ï¼ä¹åå¦ææç¶ç±»ååå§åç¶ç±»ï¼ç¶åèªå·±çæååéï¼æåææ¯æé æ¹æ³ï¼ï¼æä»¥è¿åæ¥çé½æ¯åå§åä¹åçç¶æã\n\n@service\npublic class userserviceimpl {\n    /**\n     * user dao impl.\n     */\n    private final userdaoimpl userdao;\n\n    /**\n     * init.\n     * @param userdaoimpl user dao impl\n     */\n    public userserviceimpl(final userdaoimpl userdaoimpl) {\n        this.userdao = userdaoimpl;\n    }\n}\n\n\n\n# @autowiredå@resourceä»¥å@injectç­æ³¨è§£æ³¨å¥æä½åºå«ï¼\n\nä¸èå¯¹æ¯ï¼\n\n1ã@autowiredæ¯springèªå¸¦çï¼@resourceæ¯jsr250è§èå®ç°çï¼@injectæ¯jsr330è§èå®ç°ç\n\n2ã@autowiredã@injectç¨æ³åºæ¬ä¸æ ·ï¼ä¸åçæ¯@injectæ²¡ærequiredå±æ§\n\n3ã@autowiredã@injectæ¯é»è®¤æç§ç±»åbytypeå¹éçï¼@resourceæ¯æç§åç§°bynameå¹éç\n\n4ã@autowiredå¦æéè¦æç§åç§°å¹ééè¦å@qualifierä¸èµ·ä½¿ç¨ï¼@injectå@namedä¸èµ·ä½¿ç¨ï¼@resourceåéè¿nameè¿è¡æå®\n\n@autowired\n\n1ã@autowiredæ¯springèªå¸¦çæ³¨è§£ï¼éè¿autowiredannotationbeanpostprocessor ç±»å®ç°çä¾èµæ³¨å¥\n\n2ã@autowiredå¯ä»¥ä½ç¨å¨constructorãmethodãparameterãfieldãannotation_type\n\n3ã@autowiredé»è®¤æ¯æ ¹æ®ç±»åï¼bytype ï¼è¿è¡èªå¨è£éç\n\n4ãå¦ææå¤ä¸ªç±»åä¸æ ·çbeanåéèï¼éè¦æå®æç§åç§°ï¼byname ï¼è¿è¡è£éï¼åéè¦éå@qualifierã\n\næå®åç§°åï¼å¦æspring iocå®¹å¨ä¸­æ²¡æå¯¹åºçç»ä»¶beanæåºnosuchbeandefinitionexceptionãä¹å¯ä»¥å°@autowiredä¸­requiredéç½®ä¸ºfalseï¼å¦æéç½®ä¸ºfalseä¹åï¼å½æ²¡ææ¾å°ç¸åºbeançæ¶åï¼ç³»ç»ä¸ä¼æå¼å¸¸\n\n@resource\n\n1ã@resourceæ¯jsr250è§èçå®ç°ï¼å¨javax.annotationåä¸\n\n2ã@resourceå¯ä»¥ä½ç¨typeãfieldãmethodä¸\n\n3ã@resourceæ¯é»è®¤æ ¹æ®å±æ§åç§°è¿è¡èªå¨è£éçï¼å¦ææå¤ä¸ªç±»åä¸æ ·çbeanåéèï¼åå¯ä»¥éè¿nameè¿è¡æå®è¿è¡æ³¨å¥\n\n@target(elementtype.type) #æ¥å£ãç±»ãæä¸¾ãæ³¨è§£\n@target(elementtype.field) #å­æ®µãæä¸¾çå¸¸é\n@target(elementtype.method) #æ¹æ³\n\n\n@inject\n\n1ã@injectæ¯jsr330 (dependency injection for java)ä¸­çè§èï¼éè¦å¯¼å¥javax.inject.inject jarå ï¼æè½å®ç°æ³¨å¥\n\n2ã@injectå¯ä»¥ä½ç¨constructorãmethodãfieldä¸\n\n3ã@injectæ¯æ ¹æ®ç±»åè¿è¡èªå¨è£éçï¼å¦æéè¦æåç§°è¿è¡è£éï¼åéè¦éå@namedï¼\n\n\n# ioc çåºå±å®ç°\n\né¡¶å±è®¾è®¡ï¼\n\n\n\n\n\n\n# spring ä¸­ bean ççå½å¨æ\n\n\n# spring å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",charsets:{cjk:!0}},{title:"Spring AOP",frontmatter:{title:"Spring AOP",date:"2023-08-11T14:55:38.000Z",permalink:"/pages/8c1a59/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/04.%20Spring%20AOP.html",relativePath:"09.Javaæ¡æ¶/01.Spring/04. Spring AOP.md",key:"v-80c46bea",path:"/pages/8c1a59/",headers:[{level:2,title:"ä»ä¹æ¯ AOP",slug:"ä»ä¹æ¯-aop",normalizedTitle:"ä»ä¹æ¯ aop",charIndex:8},{level:2,title:"Spring AOP å AspectJ çå³ç³»",slug:"spring-aop-å-aspectj-çå³ç³»",normalizedTitle:"spring aop å aspectj çå³ç³»",charIndex:167},{level:2,title:"æ¯è¯­",slug:"æ¯è¯­",normalizedTitle:"æ¯è¯­",charIndex:1324},{level:2,title:"AOP çåºå±åçæ¯ä»ä¹ï¼",slug:"aop-çåºå±åçæ¯ä»ä¹",normalizedTitle:"aop çåºå±åçæ¯ä»ä¹ï¼",charIndex:2946},{level:3,title:"ä»ä¹æ¯ä»£çæ¨¡å¼ï¼",slug:"ä»ä¹æ¯ä»£çæ¨¡å¼",normalizedTitle:"ä»ä¹æ¯ä»£çæ¨¡å¼ï¼",charIndex:3062},{level:3,title:"ä»ä¹æ¯å¨æä»£çï¼",slug:"ä»ä¹æ¯å¨æä»£ç",normalizedTitle:"ä»ä¹æ¯å¨æä»£çï¼",charIndex:3232},{level:3,title:"ä»£çç±»åçæ¯è¾",slug:"ä»£çç±»åçæ¯è¾",normalizedTitle:"ä»£çç±»åçæ¯è¾",charIndex:3495},{level:3,title:"ä»ä¹æ¯ CGLIBï¼",slug:"ä»ä¹æ¯-cglib",normalizedTitle:"ä»ä¹æ¯ cglibï¼",charIndex:3936},{level:3,title:"ä»ä¹æ¯ JDK proxyï¼",slug:"ä»ä¹æ¯-jdk-proxy",normalizedTitle:"ä»ä¹æ¯ jdk proxyï¼",charIndex:4265},{level:2,title:"AOP çä½¿ç¨",slug:"aop-çä½¿ç¨",normalizedTitle:"aop çä½¿ç¨",charIndex:4444},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:7284}],headersStr:"ä»ä¹æ¯ AOP Spring AOP å AspectJ çå³ç³» æ¯è¯­ AOP çåºå±åçæ¯ä»ä¹ï¼ ä»ä¹æ¯ä»£çæ¨¡å¼ï¼ ä»ä¹æ¯å¨æä»£çï¼ ä»£çç±»åçæ¯è¾ ä»ä¹æ¯ CGLIBï¼ ä»ä¹æ¯ JDK proxyï¼ AOP çä½¿ç¨ åè",content:'ä½¿ç¨ï¼\n\n\n# ä»ä¹æ¯ AOP\n\né¢ååé¢ç¼ç¨ï¼ç®çæ¯è§£è¦ãå°±æ¯å°åæ£å¨åä¸ªä¸å¡é»è¾ä»£ç ä¸­ç¸åçä»£ç éè¿æ¨ªååå²çæ¹å¼æ½åå°ä¸ä¸ªç¬ç«çæ¨¡åä¸­ã\n\nAOPä»æ¨ªåè§£å³ä»£ç éå¤çé®é¢ï¼å°ä¸å¡é»è¾åç³»ç»å¤ççä»£ç è§£è¦ï¼å¦æ¥å¿æä½ãäºå¡ç®¡çãå³é­è¿æ¥ã\n\nAOPå¯ä»¥åå°å¨ç¨åºçè¿è¡æé´, ä¸ä¿®æ¹ä¸å¡ä»£ç çæåµä¸å¯¹æ¹æ³è¿è¡åè½çå¢å¼ºã\n\n\n# Spring AOP å AspectJ çå³ç³»\n\nAspectJæ¯ä¸ä¸ªjavaå®ç°çAOPæ¡æ¶ï¼å®è½å¤å¯¹javaä»£ç è¿è¡AOPç¼è¯ï¼ä¸è¬å¨ç¼è¯æè¿è¡ï¼ï¼è®©javaä»£ç å·æAspectJçAOPåè½ï¼å½ç¶éè¦ç¹æ®çç¼è¯å¨ï¼\n\nå¯ä»¥è¿æ ·è¯´AspectJæ¯ç®åå®ç°AOPæ¡æ¶ä¸­ææçï¼åè½æä¸°å¯çè¯­è¨ï¼æ´å¹¸è¿çæ¯ï¼AspectJä¸javaç¨åºå®å¨å¼å®¹ï¼å ä¹æ¯æ ç¼å³èï¼å æ­¤å¯¹äºæjavaç¼ç¨åºç¡çå·¥ç¨å¸ï¼ä¸æåä½¿ç¨é½éå¸¸å®¹æã\n\næä»¬å¯ä»¥çå°@Aspectä»¥åå¢å¼ºçå ä¸ªæ³¨è§£æ¯æ¥æºäºaspectJï¼èä¸æ¯Springåã\n\nSpring AOPåAspectJæ¯ä»ä¹å³ç³»ï¼\n\n 1. AspectJæ¯æ´å¼ºçAOPæ¡æ¶ï¼æ¯å®éæä¹çAOPæ åï¼\n 2. Springä¸ºä½ä¸åç±»ä¼¼AspectJçæ¡æ¶ï¼ Spring AOPä½¿ç¨çº¯Javaå®ç°, å®ä¸éè¦ä¸é¨çç¼è¯è¿ç¨, å®ä¸ä¸ªéè¦çååå°±æ¯æ ä¾µå¥æ§ï¼non-invasivenessï¼; Spring å°ç»å®å¨æè½ååç±»ä¼¼çæ¡æ¶ï¼åªæ¯Spring AOPä»æ¥æ²¡ææç®éè¿æä¾ä¸ç§å¨é¢çAOPè§£å³æ¹æ¡æ¥ä¸AspectJç«äºãSpringçå¼åå°ç»ç¸ä¿¡æ è®ºæ¯åºäºä»£çï¼proxy-basedï¼çæ¡æ¶å¦Spring AOPæèæ¯æççæ¡æ¶å¦AspectJé½æ¯å¾æä»·å¼çï¼ä»ä»¬ä¹é´åºè¯¥æ¯äºè¡¥èä¸æ¯ç«äºçå³ç³»ã\n 3. Springå°ç»åæ¬¢@AspectJæ³¨è§£é£æ ¼æ´èäºSpring XMLéç½®ï¼ æä»¥å¨Spring 2.0ä½¿ç¨äºåAspectJ 5ä¸æ ·çæ³¨è§£ï¼å¹¶ä½¿ç¨AspectJæ¥ååå¥ç¹è§£æåå¹éãä½æ¯ï¼AOPå¨è¿è¡æ¶ä»æ§æ¯çº¯çSpring AOPï¼å¹¶ä¸ä¾èµäºAspectJçç¼è¯å¨æèç»å¥å¨ï¼weaverï¼ã\n 4. Spring 2.5å¯¹AspectJçæ¯æï¼å¨ä¸äºç¯å¢ä¸ï¼å¢å äºå¯¹AspectJçè£è½½æ¶ç¼ç»æ¯æï¼åæ¶æä¾äºä¸ä¸ªæ°çbeanåå¥ç¹ã\n\näºè§£AspectJåºç¨å°javaä»£ç çè¿ç¨ï¼è¿ä¸ªè¿ç¨ç§°ä¸ºç»å¥ï¼ï¼å¯¹äºç»å¥è¿ä¸ªæ¦å¿µï¼å¯ä»¥ç®åçè§£ä¸ºaspect(åé¢)åºç¨å°ç®æ å½æ°(ç±»)çè¿ç¨ã\n\nå¯¹äºè¿ä¸ªè¿ç¨ï¼ä¸è¬åä¸ºå¨æç»å¥åéæç»å¥ï¼\n\n 1. å¨æç»å¥çæ¹å¼æ¯å¨è¿è¡æ¶å¨æå°è¦å¢å¼ºçä»£ç ç»å¥å°ç®æ ç±»ä¸­ï¼è¿æ ·å¾å¾æ¯éè¿å¨æä»£çææ¯å®æçï¼å¦Java JDKçå¨æä»£ç(Proxyï¼åºå±éè¿åå°å®ç°)æèCGLIBçå¨æä»£ç(åºå±éè¿ç»§æ¿å®ç°)ï¼Spring AOPéç¨çå°±æ¯åºäºè¿è¡æ¶å¢å¼ºçä»£çææ¯\n 2. ApectJéç¨çå°±æ¯éæç»å¥çæ¹å¼ãApectJä¸»è¦éç¨çæ¯ç¼è¯æç»å¥ï¼å¨è¿ä¸ªæé´ä½¿ç¨AspectJçacjç¼è¯å¨(ç±»ä¼¼javac)æaspectç±»ç¼è¯æclasså­èç åï¼å¨javaç®æ ç±»ç¼è¯æ¶ç»å¥ï¼å³åç¼è¯aspectç±»åç¼è¯ç®æ ç±»ã\n\n\n\n\n# æ¯è¯­\n\n * æ¹é¢/åé¢ï¼Aspectï¼ï¼æ¨ªåå³æ³¨ç¹çæ¨¡ååï¼æ¯å¦æ¥å¿ç»ä»¶ãå¯ä»¥è®¤ä¸ºæ¯éç¥ãå¼å¥ååå¥ç¹çç»åï¼å¨Springä¸­å¯ä»¥ä½¿ç¨Schemaå@AspectJæ¹å¼è¿è¡ç»ç»å®ç°ï¼å¨AOPä¸­è¡¨ç¤ºä¸ºå¨åªå¹²åå¹²ä»ä¹éåï¼\n * åå¥ç¹ï¼Pointcutï¼ï¼ éæ©ä¸ç»ç¸å³è¿æ¥ç¹çæ¨¡å¼ï¼å³å¯ä»¥è®¤ä¸ºè¿æ¥ç¹çéåï¼Springæ¯æperl5æ­£åè¡¨è¾¾å¼åAspectJåå¥ç¹æ¨¡å¼ï¼Springé»è®¤ä½¿ç¨AspectJè¯­æ³ï¼å¨AOPä¸­è¡¨ç¤ºä¸ºå¨åªéå¹²çéåï¼\n * éç¥ï¼Adviceï¼ï¼å¨è¿æ¥ç¹ä¸æ§è¡çè¡ä¸ºï¼éç¥æä¾äºå¨AOPä¸­éè¦å¨åå¥ç¹æéæ©çè¿æ¥ç¹å¤è¿è¡æ©å±ç°æè¡ä¸ºçææ®µï¼åæ¬åç½®éç¥ï¼before adviceï¼ãåç½®éç¥(after advice)ãç¯ç»éç¥ï¼around adviceï¼ï¼å¨Springä¸­éè¿ä»£çæ¨¡å¼å®ç°AOPï¼å¹¶éè¿æ¦æªå¨æ¨¡å¼ä»¥ç¯ç»è¿æ¥ç¹çæ¦æªå¨é¾ç»å¥éç¥ï¼å¨AOPä¸­è¡¨ç¤ºä¸ºå¹²ä»ä¹ï¼\n * ç»å¥ï¼Weavingï¼ï¼æåé¢è¿æ¥å°å¶å®çåºç¨ç¨åºç±»åæèå¯¹è±¡ä¸ï¼å¹¶åå»ºä¸ä¸ªè¢«éç¥çå¯¹è±¡ãè¿äºå¯ä»¥å¨ç¼è¯æ¶ï¼ä¾å¦ä½¿ç¨AspectJç¼è¯å¨ï¼ï¼ç±»å è½½æ¶åè¿è¡æ¶å®æãSpringåå¶ä»çº¯Java AOPæ¡æ¶ä¸æ ·ï¼å¨è¿è¡æ¶å®æç»å¥ãå¨AOPä¸­è¡¨ç¤ºä¸ºæä¹å®ç°çï¼\n * AOPä»£çï¼AOP Proxyï¼ï¼AOPæ¡æ¶ä½¿ç¨ä»£çæ¨¡å¼åå»ºçå¯¹è±¡ï¼ä»èå®ç°å¨è¿æ¥ç¹å¤æå¥éç¥ï¼å³åºç¨åé¢ï¼ï¼å°±æ¯éè¿ä»£çæ¥å¯¹ç®æ å¯¹è±¡åºç¨åé¢ãå¨Springä¸­ï¼AOPä»£çå¯ä»¥ç¨JDKå¨æä»£çæCGLIBä»£çå®ç°ï¼èéè¿æ¦æªå¨æ¨¡ååºç¨åé¢ãå¨AOPä¸­è¡¨ç¤ºä¸ºæä¹å®ç°çä¸ç§å¸åæ¹å¼ï¼\n\nåºäºXMLçå£°æå¼AspectJå­å¨ä¸äºä¸è¶³ï¼éè¦å¨Springéç½®æä»¶éç½®å¤§éçä»£ç ä¿¡æ¯ï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼Spring ä½¿ç¨äº@AspectJæ¡æ¶ä¸ºAOPçå®ç°æä¾äºä¸å¥æ³¨è§£ã\n\næ³¨è§£åç§°              è§£é\n@Aspect           ç¨æ¥å®ä¹ä¸ä¸ªåé¢ã\n@pointcut         ç¨äºå®ä¹åå¥ç¹è¡¨è¾¾å¼ãå¨ä½¿ç¨æ¶è¿éè¦å®ä¹ä¸ä¸ªåå«åå­åä»»æåæ°çæ¹æ³ç­¾åæ¥è¡¨ç¤ºåå¥ç¹åç§°ï¼è¿ä¸ªæ¹æ³ç­¾åå°±æ¯ä¸ä¸ªè¿åå¼ä¸ºvoidï¼ä¸æ¹æ³ä½ä¸ºç©ºçæ®éæ¹æ³ã\n@Before           ç¨äºå®ä¹åç½®éç¥ï¼ç¸å½äºBeforeAdviceãå¨ä½¿ç¨æ¶ï¼éå¸¸éè¦æå®ä¸ä¸ªvalueå±æ§å¼ï¼è¯¥å±æ§å¼ç¨äºæå®ä¸ä¸ªåå¥ç¹è¡¨è¾¾å¼(å¯ä»¥æ¯å·²æçåå¥ç¹ï¼ä¹å¯ä»¥ç´æ¥å®ä¹åå¥ç¹è¡¨è¾¾å¼)ã\n@AfterReturning   ç¨äºå®ä¹åç½®éç¥ï¼ç¸å½äºAfterReturningAdviceãå¨ä½¿ç¨æ¶å¯ä»¥æå®pointcut /\n                  valueåreturningå±æ§ï¼å¶ä¸­pointcut / valueè¿ä¸¤ä¸ªå±æ§çä½ç¨ä¸æ ·ï¼é½ç¨äºæå®åå¥ç¹è¡¨è¾¾å¼ã\n@Around           ç¨äºå®ä¹ç¯ç»éç¥ï¼ç¸å½äºMethodInterceptorãå¨ä½¿ç¨æ¶éè¦æå®ä¸ä¸ªvalueå±æ§ï¼è¯¥å±æ§ç¨äºæå®è¯¥éç¥è¢«æ¤å¥çåå¥ç¹ã\n@AfterThrowing    ç¨äºå®ä¹å¼å¸¸éç¥æ¥å¤çç¨åºä¸­æªå¤ççå¼å¸¸ï¼ç¸å½äºThrowAdviceãå¨ä½¿ç¨æ¶å¯æå®pointcut /\n                  valueåthrowingå±æ§ãå¶ä¸­pointcut/valueç¨äºæå®åå¥ç¹è¡¨è¾¾å¼ï¼èthrowingå±æ§å¼ç¨äºæå®-ä¸ä¸ªå½¢ååæ¥è¡¨ç¤ºAdviceæ¹æ³ä¸­å¯å®ä¹ä¸æ­¤ååçå½¢åï¼è¯¥å½¢åå¯ç¨äºè®¿é®ç®æ æ¹æ³æåºçå¼å¸¸ã\n@After            ç¨äºå®ä¹æç»final\n                  éç¥ï¼ä¸ç®¡æ¯å¦å¼å¸¸ï¼è¯¥éç¥é½ä¼æ§è¡ãä½¿ç¨æ¶éè¦æå®ä¸ä¸ªvalueå±æ§ï¼è¯¥å±æ§ç¨äºæå®è¯¥éç¥è¢«æ¤å¥çåå¥ç¹ã\n@DeclareParents   ç¨äºå®ä¹å¼ä»éç¥ï¼ç¸å½äºIntroductionInterceptor (ä¸è¦æ±ææ¡)ã\n\n\n# AOP çåºå±åçæ¯ä»ä¹ï¼\n\nAOPçåºå±æ¯éè¿springæä¾çå¨æä»£çææ¯å®ç°ç. å¨ç¨åºçè¿è¡æé´, springå¨æçæä»£çå¯¹è±¡, ä»£çå¯¹è±¡çæ¹æ³å¨æ§è¡æ¶å°±å¯ä»¥è¿è¡å¢å¼ºåè½çä»å¥, ä»èå®æç®æ å¯¹è±¡æ¹æ³çåè½å¢å¼ºã\n\n\n# ä»ä¹æ¯ä»£çæ¨¡å¼ï¼\n\nä»£çæ¨¡å¼(Proxy pattern): ä¸ºå¦ä¸ä¸ªå¯¹è±¡æä¾ä¸ä¸ªæ¿èº«æå ä½ç¬¦ä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n\n\n\næ(client)å¦æè¦ä¹°(doOperation)æ¿ï¼å¯ä»¥æ¾ä¸­ä»(proxy)ä¹°æ¿ï¼ä¸­ä»ç´æ¥ååæ¹(target)ä¹°æ¿ãä¸­ä»ååæ¹é½å®ç°ä¹°å(doOperation)çæä½ãä¸­ä»å°±æ¯ä»£ç(proxy)ã\n\n\n# ä»ä¹æ¯å¨æä»£çï¼\n\néæä»£çä¸å¨æä»£ççåºå«ä¸»è¦å¨ï¼\n\n * éæä»£çå¨ç¼è¯æ¶å°±å·²ç»å®ç°ï¼ç¼è¯å®æåä»£çç±»æ¯ä¸ä¸ªå®éçclassæä»¶\n * å¨æä»£çæ¯å¨è¿è¡æ¶å¨æçæçï¼å³ç¼è¯å®æåæ²¡æå®éçclassæä»¶ï¼èæ¯å¨è¿è¡æ¶å¨æçæç±»å­èç ï¼å¹¶å è½½å°JVMä¸­\n\nå¨æä»£çå°±æ¯ï¼å¨ç¨åºè¿è¡æï¼åå»ºç®æ å¯¹è±¡çä»£çå¯¹è±¡ï¼å¹¶å¯¹ç®æ å¯¹è±¡ä¸­çæ¹æ³è¿è¡åè½æ§å¢å¼ºçä¸ç§ææ¯ã\n\nå¨çæä»£çå¯¹è±¡çè¿ç¨ä¸­ï¼ç®æ å¯¹è±¡ä¸åï¼ä»£çå¯¹è±¡ä¸­çæ¹æ³æ¯ç®æ å¯¹è±¡æ¹æ³çå¢å¼ºæ¹æ³ãå¯ä»¥çè§£ä¸ºè¿è¡æé´ï¼å¯¹è±¡ä¸­æ¹æ³çå¨ææ¦æªï¼å¨æ¦æªæ¹æ³çååæ§è¡åè½æä½ã\n\n\n\n\n# ä»£çç±»åçæ¯è¾\n\n 1. éæä»£çå®ç°è¾ç®åï¼åªè¦ä»£çå¯¹è±¡å¯¹ç®æ å¯¹è±¡è¿è¡åè£ï¼å³å¯å®ç°å¢å¼ºåè½ï¼ä½éæä»£çåªè½ä¸ºä¸ä¸ªç®æ å¯¹è±¡æå¡ï¼å¦æç®æ å¯¹è±¡è¿å¤ï¼åä¼äº§çå¾å¤ä»£çç±»ã\n 2. JDKå¨æä»£çéè¦ç®æ å¯¹è±¡å®ç°ä¸å¡æ¥å£ï¼ä»£çç±»åªéå®ç°InvocationHandleræ¥å£ã\n 3. JDKå¨æä»£ççæçç±»ä¸º lass com.sun.proxy.$Proxy4ï¼cglibä»£ççæçç±»ä¸ºclass com.cglib.UserDao$$EnhancerByCGLIB$$552188b6ã\n 4. éæä»£çå¨ç¼è¯æ¶äº§çclasså­èç æä»¶ï¼å¯ä»¥ç´æ¥ä½¿ç¨ï¼æçé«ã\n 5. JDKå¨æä»£çå¿é¡»å®ç°InvocationHandleræ¥å£ï¼éè¿åå°ä»£çæ¹æ³ï¼æ¯è¾æ¶èç³»ç»æ§è½ï¼ä½å¯ä»¥åå°ä»£çç±»çæ°éï¼ä½¿ç¨æ´çµæ´»ã\n 6. cglibä»£çæ éå®ç°æ¥å£ï¼éè¿çæç±»å­èç å®ç°ä»£çï¼æ¯åå°ç¨å¿«ï¼ä¸å­å¨æ§è½é®é¢ï¼ä½cglibä¼ç»§æ¿ç®æ å¯¹è±¡ï¼éè¦éåæ¹æ³ï¼æä»¥ç®æ å¯¹è±¡ä¸è½ä¸ºfinalç±»ã\n\n\n# ä»ä¹æ¯ CGLIBï¼\n\nCglibæ¯ä¸ä¸ªå¼ºå¤§çãé«æ§è½çä»£ç çæåï¼å®å¹¿æ³è¢«è®¸å¤AOPæ¡æ¶ä½¿ç¨ï¼ä¸ºä»ä»¬æä¾æ¹æ³çæ¦æªã\n\nSpringAOPå°è£äºcglibï¼éè¿å¶è¿è¡å¨æä»£ççåå»ºã\n\n\n\nCGLIB æµç¨å¾ï¼\n\ncglibä»£çç±»ï¼éè¦å®ç°MethodInterceptoræ¥å£ï¼å¹¶æå®ä»£çç®æ ç±»targetã\n\n * finalæ¹æ³ä¸ºä»ä¹ä¸è½è¢«ä»£çï¼å¾æ¾ç¶finalæ¹æ³æ²¡æ³è¢«å­ç±»è¦çï¼å½ç¶ä¸è½ä»£çäºã\n * Mockitoä¸ºä»ä¹ä¸è½mockéææ¹æ³ï¼å ä¸ºmockitoä¹æ¯åºäºcglibå¨æä»£çæ¥å®ç°çï¼staticæ¹æ³ä¹ä¸è½è¢«å­ç±»è¦çï¼æä»¥æ¾ç¶ä¸è½mockãä½PowerMockå¯ä»¥mockéææ¹æ³ï¼å ä¸ºå®ç´æ¥å¨bytecodeä¸å·¥ä½ã\n\n\n\n\n# ä»ä¹æ¯ JDK proxyï¼\n\nJDKå¨æä»£çæ¯æJDKæä¾çå·¥å·ç±»Proxyå®ç°çï¼å¨æä»£çç±»æ¯å¨è¿è¡æ¶çææå®æ¥å£çä»£çç±»ï¼æ¯ä¸ªä»£çå®ä¾ï¼å®ç°éè¦ä»£ççæ¥å£ï¼é½æä¸ä¸ªå³èçè°ç¨å¤çç¨åºå¯¹è±¡ï¼æ­¤å¯¹è±¡å®ç°äºInvocationHandlerï¼æç»çä¸å¡é»è¾æ¯å¨InvocationHandlerå®ç°ç±»çinvokeæ¹æ³ä¸ãjdkä»£çä¸éè¦ä»»ä½ä¾èµã\n\n\n# AOP çä½¿ç¨\n\nSpring AOP æ¯æå¯¹XMLæ¨¡å¼ååºäº@AspectJæ³¨è§£çä¸¤ç§éç½®æ¹å¼ã\n\nä¸é¢å±ç¤ºçæ¯ä½¿ç¨ @AspectJ æ³¨è§£çæ¹å¼ï¼\n\nSpringé»è®¤å¨ç®æ ç±»å®ç°æ¥å£æ¶æ¯éè¿JDKä»£çå®ç°çï¼åªæéæ¥å£çæ¯éè¿Cglibä»£çå®ç°çã\n\n1. å®ä¹æ¥å£\npublic interface IJdkProxyService {\n\n    void doMethod1();\n\n    String doMethod2();\n\n    String doMethod3() throws Exception;\n}\n\n\n2. å®ç°ç±»\n@Service\npublic class JdkProxyDemoServiceImpl implements IJdkProxyService {\n\n    @Override\n    public void doMethod1() {\n        System.out.println("JdkProxyServiceImpl.doMethod1()");\n    }\n\n    @Override\n    public String doMethod2() {\n        System.out.println("JdkProxyServiceImpl.doMethod2()");\n        return "hello world";\n    }\n\n    @Override\n    public String doMethod3() throws Exception {\n        System.out.println("JdkProxyServiceImpl.doMethod3()");\n        throw new Exception("some exception");\n    }\n}\n\n\n3. å®ä¹åé¢\n\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.After;\nimport org.aspectj.lang.annotation.AfterReturning;\nimport org.aspectj.lang.annotation.AfterThrowing;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Before;\nimport org.aspectj.lang.annotation.Pointcut;\nimport org.springframework.context.annotation.EnableAspectJAutoProxy;\nimport org.springframework.stereotype.Component;\n\n@EnableAspectJAutoProxy\n@Component\n@Aspect\npublic class LogAspect {\n\n    /**\n     * define point cut.\n     */\n    @Pointcut("execution(* tech.pdai.springframework.service.*.*(..))")\n    private void pointCutMethod() {\n    }\n\n\n    /**\n     * ç¯ç»éç¥.\n     */\n    @Around("pointCutMethod()")\n    public Object doAround(ProceedingJoinPoint pjp) throws Throwable {\n        System.out.println("-----------------------");\n        System.out.println("ç¯ç»éç¥: è¿å¥æ¹æ³");\n        Object o = pjp.proceed();\n        System.out.println("ç¯ç»éç¥: éåºæ¹æ³");\n        return o;\n    }\n\n    /**\n     * åç½®éç¥.\n     */\n    @Before("pointCutMethod()")\n    public void doBefore() {\n        System.out.println("åç½®éç¥");\n    }\n\n\n    /**\n     * åç½®éç¥.\n     */\n    @AfterReturning(pointcut = "pointCutMethod()", returning = "result")\n    public void doAfterReturning(String result) {\n        System.out.println("åç½®éç¥, è¿åå¼: " + result);\n    }\n\n    /**\n     * å¼å¸¸éç¥.\n     */\n    @AfterThrowing(pointcut = "pointCutMethod()", throwing = "e")\n    public void doAfterThrowing(Exception e) {\n        System.out.println("å¼å¸¸éç¥, å¼å¸¸: " + e.getMessage());\n    }\n\n    /**\n     * æç»éç¥.\n     */\n    @After("pointCutMethod()")\n    public void doAfter() {\n        System.out.println("æç»éç¥");\n    }\n\n}\n\n\n4. è¾åº\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\nJdkProxyServiceImpl.doMethod1()\næç»éç¥\nç¯ç»éç¥: éåºæ¹æ³\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\nJdkProxyServiceImpl.doMethod2()\nåç½®éç¥, è¿åå¼: hello world\næç»éç¥\nç¯ç»éç¥: éåºæ¹æ³\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\nJdkProxyServiceImpl.doMethod3()\nå¼å¸¸éç¥, å¼å¸¸: some exception\næç»éç¥\n\n\n\n# åè\n\n * https://juejin.cn/post/7011728343947018248 cglibãjdk proxy ä½¿ç¨ä¾å­',normalizedContent:'ä½¿ç¨ï¼\n\n\n# ä»ä¹æ¯ aop\n\né¢ååé¢ç¼ç¨ï¼ç®çæ¯è§£è¦ãå°±æ¯å°åæ£å¨åä¸ªä¸å¡é»è¾ä»£ç ä¸­ç¸åçä»£ç éè¿æ¨ªååå²çæ¹å¼æ½åå°ä¸ä¸ªç¬ç«çæ¨¡åä¸­ã\n\naopä»æ¨ªåè§£å³ä»£ç éå¤çé®é¢ï¼å°ä¸å¡é»è¾åç³»ç»å¤ççä»£ç è§£è¦ï¼å¦æ¥å¿æä½ãäºå¡ç®¡çãå³é­è¿æ¥ã\n\naopå¯ä»¥åå°å¨ç¨åºçè¿è¡æé´, ä¸ä¿®æ¹ä¸å¡ä»£ç çæåµä¸å¯¹æ¹æ³è¿è¡åè½çå¢å¼ºã\n\n\n# spring aop å aspectj çå³ç³»\n\naspectjæ¯ä¸ä¸ªjavaå®ç°çaopæ¡æ¶ï¼å®è½å¤å¯¹javaä»£ç è¿è¡aopç¼è¯ï¼ä¸è¬å¨ç¼è¯æè¿è¡ï¼ï¼è®©javaä»£ç å·æaspectjçaopåè½ï¼å½ç¶éè¦ç¹æ®çç¼è¯å¨ï¼\n\nå¯ä»¥è¿æ ·è¯´aspectjæ¯ç®åå®ç°aopæ¡æ¶ä¸­ææçï¼åè½æä¸°å¯çè¯­è¨ï¼æ´å¹¸è¿çæ¯ï¼aspectjä¸javaç¨åºå®å¨å¼å®¹ï¼å ä¹æ¯æ ç¼å³èï¼å æ­¤å¯¹äºæjavaç¼ç¨åºç¡çå·¥ç¨å¸ï¼ä¸æåä½¿ç¨é½éå¸¸å®¹æã\n\næä»¬å¯ä»¥çå°@aspectä»¥åå¢å¼ºçå ä¸ªæ³¨è§£æ¯æ¥æºäºaspectjï¼èä¸æ¯springåã\n\nspring aopåaspectjæ¯ä»ä¹å³ç³»ï¼\n\n 1. aspectjæ¯æ´å¼ºçaopæ¡æ¶ï¼æ¯å®éæä¹çaopæ åï¼\n 2. springä¸ºä½ä¸åç±»ä¼¼aspectjçæ¡æ¶ï¼ spring aopä½¿ç¨çº¯javaå®ç°, å®ä¸éè¦ä¸é¨çç¼è¯è¿ç¨, å®ä¸ä¸ªéè¦çååå°±æ¯æ ä¾µå¥æ§ï¼non-invasivenessï¼; spring å°ç»å®å¨æè½ååç±»ä¼¼çæ¡æ¶ï¼åªæ¯spring aopä»æ¥æ²¡ææç®éè¿æä¾ä¸ç§å¨é¢çaopè§£å³æ¹æ¡æ¥ä¸aspectjç«äºãspringçå¼åå°ç»ç¸ä¿¡æ è®ºæ¯åºäºä»£çï¼proxy-basedï¼çæ¡æ¶å¦spring aopæèæ¯æççæ¡æ¶å¦aspectjé½æ¯å¾æä»·å¼çï¼ä»ä»¬ä¹é´åºè¯¥æ¯äºè¡¥èä¸æ¯ç«äºçå³ç³»ã\n 3. springå°ç»åæ¬¢@aspectjæ³¨è§£é£æ ¼æ´èäºspring xmléç½®ï¼ æä»¥å¨spring 2.0ä½¿ç¨äºåaspectj 5ä¸æ ·çæ³¨è§£ï¼å¹¶ä½¿ç¨aspectjæ¥ååå¥ç¹è§£æåå¹éãä½æ¯ï¼aopå¨è¿è¡æ¶ä»æ§æ¯çº¯çspring aopï¼å¹¶ä¸ä¾èµäºaspectjçç¼è¯å¨æèç»å¥å¨ï¼weaverï¼ã\n 4. spring 2.5å¯¹aspectjçæ¯æï¼å¨ä¸äºç¯å¢ä¸ï¼å¢å äºå¯¹aspectjçè£è½½æ¶ç¼ç»æ¯æï¼åæ¶æä¾äºä¸ä¸ªæ°çbeanåå¥ç¹ã\n\näºè§£aspectjåºç¨å°javaä»£ç çè¿ç¨ï¼è¿ä¸ªè¿ç¨ç§°ä¸ºç»å¥ï¼ï¼å¯¹äºç»å¥è¿ä¸ªæ¦å¿µï¼å¯ä»¥ç®åçè§£ä¸ºaspect(åé¢)åºç¨å°ç®æ å½æ°(ç±»)çè¿ç¨ã\n\nå¯¹äºè¿ä¸ªè¿ç¨ï¼ä¸è¬åä¸ºå¨æç»å¥åéæç»å¥ï¼\n\n 1. å¨æç»å¥çæ¹å¼æ¯å¨è¿è¡æ¶å¨æå°è¦å¢å¼ºçä»£ç ç»å¥å°ç®æ ç±»ä¸­ï¼è¿æ ·å¾å¾æ¯éè¿å¨æä»£çææ¯å®æçï¼å¦java jdkçå¨æä»£ç(proxyï¼åºå±éè¿åå°å®ç°)æècglibçå¨æä»£ç(åºå±éè¿ç»§æ¿å®ç°)ï¼spring aopéç¨çå°±æ¯åºäºè¿è¡æ¶å¢å¼ºçä»£çææ¯\n 2. apectjéç¨çå°±æ¯éæç»å¥çæ¹å¼ãapectjä¸»è¦éç¨çæ¯ç¼è¯æç»å¥ï¼å¨è¿ä¸ªæé´ä½¿ç¨aspectjçacjç¼è¯å¨(ç±»ä¼¼javac)æaspectç±»ç¼è¯æclasså­èç åï¼å¨javaç®æ ç±»ç¼è¯æ¶ç»å¥ï¼å³åç¼è¯aspectç±»åç¼è¯ç®æ ç±»ã\n\n\n\n\n# æ¯è¯­\n\n * æ¹é¢/åé¢ï¼aspectï¼ï¼æ¨ªåå³æ³¨ç¹çæ¨¡ååï¼æ¯å¦æ¥å¿ç»ä»¶ãå¯ä»¥è®¤ä¸ºæ¯éç¥ãå¼å¥ååå¥ç¹çç»åï¼å¨springä¸­å¯ä»¥ä½¿ç¨schemaå@aspectjæ¹å¼è¿è¡ç»ç»å®ç°ï¼å¨aopä¸­è¡¨ç¤ºä¸ºå¨åªå¹²åå¹²ä»ä¹éåï¼\n * åå¥ç¹ï¼pointcutï¼ï¼ éæ©ä¸ç»ç¸å³è¿æ¥ç¹çæ¨¡å¼ï¼å³å¯ä»¥è®¤ä¸ºè¿æ¥ç¹çéåï¼springæ¯æperl5æ­£åè¡¨è¾¾å¼åaspectjåå¥ç¹æ¨¡å¼ï¼springé»è®¤ä½¿ç¨aspectjè¯­æ³ï¼å¨aopä¸­è¡¨ç¤ºä¸ºå¨åªéå¹²çéåï¼\n * éç¥ï¼adviceï¼ï¼å¨è¿æ¥ç¹ä¸æ§è¡çè¡ä¸ºï¼éç¥æä¾äºå¨aopä¸­éè¦å¨åå¥ç¹æéæ©çè¿æ¥ç¹å¤è¿è¡æ©å±ç°æè¡ä¸ºçææ®µï¼åæ¬åç½®éç¥ï¼before adviceï¼ãåç½®éç¥(after advice)ãç¯ç»éç¥ï¼around adviceï¼ï¼å¨springä¸­éè¿ä»£çæ¨¡å¼å®ç°aopï¼å¹¶éè¿æ¦æªå¨æ¨¡å¼ä»¥ç¯ç»è¿æ¥ç¹çæ¦æªå¨é¾ç»å¥éç¥ï¼å¨aopä¸­è¡¨ç¤ºä¸ºå¹²ä»ä¹ï¼\n * ç»å¥ï¼weavingï¼ï¼æåé¢è¿æ¥å°å¶å®çåºç¨ç¨åºç±»åæèå¯¹è±¡ä¸ï¼å¹¶åå»ºä¸ä¸ªè¢«éç¥çå¯¹è±¡ãè¿äºå¯ä»¥å¨ç¼è¯æ¶ï¼ä¾å¦ä½¿ç¨aspectjç¼è¯å¨ï¼ï¼ç±»å è½½æ¶åè¿è¡æ¶å®æãspringåå¶ä»çº¯java aopæ¡æ¶ä¸æ ·ï¼å¨è¿è¡æ¶å®æç»å¥ãå¨aopä¸­è¡¨ç¤ºä¸ºæä¹å®ç°çï¼\n * aopä»£çï¼aop proxyï¼ï¼aopæ¡æ¶ä½¿ç¨ä»£çæ¨¡å¼åå»ºçå¯¹è±¡ï¼ä»èå®ç°å¨è¿æ¥ç¹å¤æå¥éç¥ï¼å³åºç¨åé¢ï¼ï¼å°±æ¯éè¿ä»£çæ¥å¯¹ç®æ å¯¹è±¡åºç¨åé¢ãå¨springä¸­ï¼aopä»£çå¯ä»¥ç¨jdkå¨æä»£çæcglibä»£çå®ç°ï¼èéè¿æ¦æªå¨æ¨¡ååºç¨åé¢ãå¨aopä¸­è¡¨ç¤ºä¸ºæä¹å®ç°çä¸ç§å¸åæ¹å¼ï¼\n\nåºäºxmlçå£°æå¼aspectjå­å¨ä¸äºä¸è¶³ï¼éè¦å¨springéç½®æä»¶éç½®å¤§éçä»£ç ä¿¡æ¯ï¼ä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼spring ä½¿ç¨äº@aspectjæ¡æ¶ä¸ºaopçå®ç°æä¾äºä¸å¥æ³¨è§£ã\n\næ³¨è§£åç§°              è§£é\n@aspect           ç¨æ¥å®ä¹ä¸ä¸ªåé¢ã\n@pointcut         ç¨äºå®ä¹åå¥ç¹è¡¨è¾¾å¼ãå¨ä½¿ç¨æ¶è¿éè¦å®ä¹ä¸ä¸ªåå«åå­åä»»æåæ°çæ¹æ³ç­¾åæ¥è¡¨ç¤ºåå¥ç¹åç§°ï¼è¿ä¸ªæ¹æ³ç­¾åå°±æ¯ä¸ä¸ªè¿åå¼ä¸ºvoidï¼ä¸æ¹æ³ä½ä¸ºç©ºçæ®éæ¹æ³ã\n@before           ç¨äºå®ä¹åç½®éç¥ï¼ç¸å½äºbeforeadviceãå¨ä½¿ç¨æ¶ï¼éå¸¸éè¦æå®ä¸ä¸ªvalueå±æ§å¼ï¼è¯¥å±æ§å¼ç¨äºæå®ä¸ä¸ªåå¥ç¹è¡¨è¾¾å¼(å¯ä»¥æ¯å·²æçåå¥ç¹ï¼ä¹å¯ä»¥ç´æ¥å®ä¹åå¥ç¹è¡¨è¾¾å¼)ã\n@afterreturning   ç¨äºå®ä¹åç½®éç¥ï¼ç¸å½äºafterreturningadviceãå¨ä½¿ç¨æ¶å¯ä»¥æå®pointcut /\n                  valueåreturningå±æ§ï¼å¶ä¸­pointcut / valueè¿ä¸¤ä¸ªå±æ§çä½ç¨ä¸æ ·ï¼é½ç¨äºæå®åå¥ç¹è¡¨è¾¾å¼ã\n@around           ç¨äºå®ä¹ç¯ç»éç¥ï¼ç¸å½äºmethodinterceptorãå¨ä½¿ç¨æ¶éè¦æå®ä¸ä¸ªvalueå±æ§ï¼è¯¥å±æ§ç¨äºæå®è¯¥éç¥è¢«æ¤å¥çåå¥ç¹ã\n@afterthrowing    ç¨äºå®ä¹å¼å¸¸éç¥æ¥å¤çç¨åºä¸­æªå¤ççå¼å¸¸ï¼ç¸å½äºthrowadviceãå¨ä½¿ç¨æ¶å¯æå®pointcut /\n                  valueåthrowingå±æ§ãå¶ä¸­pointcut/valueç¨äºæå®åå¥ç¹è¡¨è¾¾å¼ï¼èthrowingå±æ§å¼ç¨äºæå®-ä¸ä¸ªå½¢ååæ¥è¡¨ç¤ºadviceæ¹æ³ä¸­å¯å®ä¹ä¸æ­¤ååçå½¢åï¼è¯¥å½¢åå¯ç¨äºè®¿é®ç®æ æ¹æ³æåºçå¼å¸¸ã\n@after            ç¨äºå®ä¹æç»final\n                  éç¥ï¼ä¸ç®¡æ¯å¦å¼å¸¸ï¼è¯¥éç¥é½ä¼æ§è¡ãä½¿ç¨æ¶éè¦æå®ä¸ä¸ªvalueå±æ§ï¼è¯¥å±æ§ç¨äºæå®è¯¥éç¥è¢«æ¤å¥çåå¥ç¹ã\n@declareparents   ç¨äºå®ä¹å¼ä»éç¥ï¼ç¸å½äºintroductioninterceptor (ä¸è¦æ±ææ¡)ã\n\n\n# aop çåºå±åçæ¯ä»ä¹ï¼\n\naopçåºå±æ¯éè¿springæä¾çå¨æä»£çææ¯å®ç°ç. å¨ç¨åºçè¿è¡æé´, springå¨æçæä»£çå¯¹è±¡, ä»£çå¯¹è±¡çæ¹æ³å¨æ§è¡æ¶å°±å¯ä»¥è¿è¡å¢å¼ºåè½çä»å¥, ä»èå®æç®æ å¯¹è±¡æ¹æ³çåè½å¢å¼ºã\n\n\n# ä»ä¹æ¯ä»£çæ¨¡å¼ï¼\n\nä»£çæ¨¡å¼(proxy pattern): ä¸ºå¦ä¸ä¸ªå¯¹è±¡æä¾ä¸ä¸ªæ¿èº«æå ä½ç¬¦ä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n\n\n\næ(client)å¦æè¦ä¹°(dooperation)æ¿ï¼å¯ä»¥æ¾ä¸­ä»(proxy)ä¹°æ¿ï¼ä¸­ä»ç´æ¥ååæ¹(target)ä¹°æ¿ãä¸­ä»ååæ¹é½å®ç°ä¹°å(dooperation)çæä½ãä¸­ä»å°±æ¯ä»£ç(proxy)ã\n\n\n# ä»ä¹æ¯å¨æä»£çï¼\n\néæä»£çä¸å¨æä»£ççåºå«ä¸»è¦å¨ï¼\n\n * éæä»£çå¨ç¼è¯æ¶å°±å·²ç»å®ç°ï¼ç¼è¯å®æåä»£çç±»æ¯ä¸ä¸ªå®éçclassæä»¶\n * å¨æä»£çæ¯å¨è¿è¡æ¶å¨æçæçï¼å³ç¼è¯å®æåæ²¡æå®éçclassæä»¶ï¼èæ¯å¨è¿è¡æ¶å¨æçæç±»å­èç ï¼å¹¶å è½½å°jvmä¸­\n\nå¨æä»£çå°±æ¯ï¼å¨ç¨åºè¿è¡æï¼åå»ºç®æ å¯¹è±¡çä»£çå¯¹è±¡ï¼å¹¶å¯¹ç®æ å¯¹è±¡ä¸­çæ¹æ³è¿è¡åè½æ§å¢å¼ºçä¸ç§ææ¯ã\n\nå¨çæä»£çå¯¹è±¡çè¿ç¨ä¸­ï¼ç®æ å¯¹è±¡ä¸åï¼ä»£çå¯¹è±¡ä¸­çæ¹æ³æ¯ç®æ å¯¹è±¡æ¹æ³çå¢å¼ºæ¹æ³ãå¯ä»¥çè§£ä¸ºè¿è¡æé´ï¼å¯¹è±¡ä¸­æ¹æ³çå¨ææ¦æªï¼å¨æ¦æªæ¹æ³çååæ§è¡åè½æä½ã\n\n\n\n\n# ä»£çç±»åçæ¯è¾\n\n 1. éæä»£çå®ç°è¾ç®åï¼åªè¦ä»£çå¯¹è±¡å¯¹ç®æ å¯¹è±¡è¿è¡åè£ï¼å³å¯å®ç°å¢å¼ºåè½ï¼ä½éæä»£çåªè½ä¸ºä¸ä¸ªç®æ å¯¹è±¡æå¡ï¼å¦æç®æ å¯¹è±¡è¿å¤ï¼åä¼äº§çå¾å¤ä»£çç±»ã\n 2. jdkå¨æä»£çéè¦ç®æ å¯¹è±¡å®ç°ä¸å¡æ¥å£ï¼ä»£çç±»åªéå®ç°invocationhandleræ¥å£ã\n 3. jdkå¨æä»£ççæçç±»ä¸º lass com.sun.proxy.$proxy4ï¼cglibä»£ççæçç±»ä¸ºclass com.cglib.userdao$$enhancerbycglib$$552188b6ã\n 4. éæä»£çå¨ç¼è¯æ¶äº§çclasså­èç æä»¶ï¼å¯ä»¥ç´æ¥ä½¿ç¨ï¼æçé«ã\n 5. jdkå¨æä»£çå¿é¡»å®ç°invocationhandleræ¥å£ï¼éè¿åå°ä»£çæ¹æ³ï¼æ¯è¾æ¶èç³»ç»æ§è½ï¼ä½å¯ä»¥åå°ä»£çç±»çæ°éï¼ä½¿ç¨æ´çµæ´»ã\n 6. cglibä»£çæ éå®ç°æ¥å£ï¼éè¿çæç±»å­èç å®ç°ä»£çï¼æ¯åå°ç¨å¿«ï¼ä¸å­å¨æ§è½é®é¢ï¼ä½cglibä¼ç»§æ¿ç®æ å¯¹è±¡ï¼éè¦éåæ¹æ³ï¼æä»¥ç®æ å¯¹è±¡ä¸è½ä¸ºfinalç±»ã\n\n\n# ä»ä¹æ¯ cglibï¼\n\ncglibæ¯ä¸ä¸ªå¼ºå¤§çãé«æ§è½çä»£ç çæåï¼å®å¹¿æ³è¢«è®¸å¤aopæ¡æ¶ä½¿ç¨ï¼ä¸ºä»ä»¬æä¾æ¹æ³çæ¦æªã\n\nspringaopå°è£äºcglibï¼éè¿å¶è¿è¡å¨æä»£ççåå»ºã\n\n\n\ncglib æµç¨å¾ï¼\n\ncglibä»£çç±»ï¼éè¦å®ç°methodinterceptoræ¥å£ï¼å¹¶æå®ä»£çç®æ ç±»targetã\n\n * finalæ¹æ³ä¸ºä»ä¹ä¸è½è¢«ä»£çï¼å¾æ¾ç¶finalæ¹æ³æ²¡æ³è¢«å­ç±»è¦çï¼å½ç¶ä¸è½ä»£çäºã\n * mockitoä¸ºä»ä¹ä¸è½mockéææ¹æ³ï¼å ä¸ºmockitoä¹æ¯åºäºcglibå¨æä»£çæ¥å®ç°çï¼staticæ¹æ³ä¹ä¸è½è¢«å­ç±»è¦çï¼æä»¥æ¾ç¶ä¸è½mockãä½powermockå¯ä»¥mockéææ¹æ³ï¼å ä¸ºå®ç´æ¥å¨bytecodeä¸å·¥ä½ã\n\n\n\n\n# ä»ä¹æ¯ jdk proxyï¼\n\njdkå¨æä»£çæ¯æjdkæä¾çå·¥å·ç±»proxyå®ç°çï¼å¨æä»£çç±»æ¯å¨è¿è¡æ¶çææå®æ¥å£çä»£çç±»ï¼æ¯ä¸ªä»£çå®ä¾ï¼å®ç°éè¦ä»£ççæ¥å£ï¼é½æä¸ä¸ªå³èçè°ç¨å¤çç¨åºå¯¹è±¡ï¼æ­¤å¯¹è±¡å®ç°äºinvocationhandlerï¼æç»çä¸å¡é»è¾æ¯å¨invocationhandlerå®ç°ç±»çinvokeæ¹æ³ä¸ãjdkä»£çä¸éè¦ä»»ä½ä¾èµã\n\n\n# aop çä½¿ç¨\n\nspring aop æ¯æå¯¹xmlæ¨¡å¼ååºäº@aspectjæ³¨è§£çä¸¤ç§éç½®æ¹å¼ã\n\nä¸é¢å±ç¤ºçæ¯ä½¿ç¨ @aspectj æ³¨è§£çæ¹å¼ï¼\n\nspringé»è®¤å¨ç®æ ç±»å®ç°æ¥å£æ¶æ¯éè¿jdkä»£çå®ç°çï¼åªæéæ¥å£çæ¯éè¿cglibä»£çå®ç°çã\n\n1. å®ä¹æ¥å£\npublic interface ijdkproxyservice {\n\n    void domethod1();\n\n    string domethod2();\n\n    string domethod3() throws exception;\n}\n\n\n2. å®ç°ç±»\n@service\npublic class jdkproxydemoserviceimpl implements ijdkproxyservice {\n\n    @override\n    public void domethod1() {\n        system.out.println("jdkproxyserviceimpl.domethod1()");\n    }\n\n    @override\n    public string domethod2() {\n        system.out.println("jdkproxyserviceimpl.domethod2()");\n        return "hello world";\n    }\n\n    @override\n    public string domethod3() throws exception {\n        system.out.println("jdkproxyserviceimpl.domethod3()");\n        throw new exception("some exception");\n    }\n}\n\n\n3. å®ä¹åé¢\n\nimport org.aspectj.lang.proceedingjoinpoint;\nimport org.aspectj.lang.annotation.after;\nimport org.aspectj.lang.annotation.afterreturning;\nimport org.aspectj.lang.annotation.afterthrowing;\nimport org.aspectj.lang.annotation.around;\nimport org.aspectj.lang.annotation.aspect;\nimport org.aspectj.lang.annotation.before;\nimport org.aspectj.lang.annotation.pointcut;\nimport org.springframework.context.annotation.enableaspectjautoproxy;\nimport org.springframework.stereotype.component;\n\n@enableaspectjautoproxy\n@component\n@aspect\npublic class logaspect {\n\n    /**\n     * define point cut.\n     */\n    @pointcut("execution(* tech.pdai.springframework.service.*.*(..))")\n    private void pointcutmethod() {\n    }\n\n\n    /**\n     * ç¯ç»éç¥.\n     */\n    @around("pointcutmethod()")\n    public object doaround(proceedingjoinpoint pjp) throws throwable {\n        system.out.println("-----------------------");\n        system.out.println("ç¯ç»éç¥: è¿å¥æ¹æ³");\n        object o = pjp.proceed();\n        system.out.println("ç¯ç»éç¥: éåºæ¹æ³");\n        return o;\n    }\n\n    /**\n     * åç½®éç¥.\n     */\n    @before("pointcutmethod()")\n    public void dobefore() {\n        system.out.println("åç½®éç¥");\n    }\n\n\n    /**\n     * åç½®éç¥.\n     */\n    @afterreturning(pointcut = "pointcutmethod()", returning = "result")\n    public void doafterreturning(string result) {\n        system.out.println("åç½®éç¥, è¿åå¼: " + result);\n    }\n\n    /**\n     * å¼å¸¸éç¥.\n     */\n    @afterthrowing(pointcut = "pointcutmethod()", throwing = "e")\n    public void doafterthrowing(exception e) {\n        system.out.println("å¼å¸¸éç¥, å¼å¸¸: " + e.getmessage());\n    }\n\n    /**\n     * æç»éç¥.\n     */\n    @after("pointcutmethod()")\n    public void doafter() {\n        system.out.println("æç»éç¥");\n    }\n\n}\n\n\n4. è¾åº\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\njdkproxyserviceimpl.domethod1()\næç»éç¥\nç¯ç»éç¥: éåºæ¹æ³\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\njdkproxyserviceimpl.domethod2()\nåç½®éç¥, è¿åå¼: hello world\næç»éç¥\nç¯ç»éç¥: éåºæ¹æ³\n-----------------------\nç¯ç»éç¥: è¿å¥æ¹æ³\nåç½®éç¥\njdkproxyserviceimpl.domethod3()\nå¼å¸¸éç¥, å¼å¸¸: some exception\næç»éç¥\n\n\n\n# åè\n\n * https://juejin.cn/post/7011728343947018248 cglibãjdk proxy ä½¿ç¨ä¾å­',charsets:{cjk:!0}},{title:"Spring MVC",frontmatter:{title:"Spring MVC",date:"2023-08-25T14:36:01.000Z",permalink:"/pages/c3ac4e/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/05.Spring%20MVC.html",relativePath:"09.Javaæ¡æ¶/01.Spring/05.Spring MVC.md",key:"v-1f84369c",path:"/pages/c3ac4e/",headers:[{level:2,title:"ä»ä¹æ¯ MVC",slug:"ä»ä¹æ¯-mvc",normalizedTitle:"ä»ä¹æ¯ mvc",charIndex:2},{level:2,title:"Spring MVC çè¯·æ±æµç¨",slug:"spring-mvc-çè¯·æ±æµç¨",normalizedTitle:"spring mvc çè¯·æ±æµç¨",charIndex:324}],headersStr:"ä»ä¹æ¯ MVC Spring MVC çè¯·æ±æµç¨",content:"# ä»ä¹æ¯ MVC\n\nMVCè±ææ¯Model View Controllerï¼æ¯æ¨¡å(model)ï¼è§å¾(view)ï¼æ§å¶å¨(controller)çç¼©åï¼ä¸ç§è½¯ä»¶è®¾è®¡è§èãæ¬è´¨ä¸ä¹æ¯ä¸ç§è§£è¦ã\n\nç¨ä¸ç§ä¸å¡é»è¾ãæ°æ®ãçé¢æ¾ç¤ºåç¦»çæ¹æ³ï¼å°ä¸å¡é»è¾èéå°ä¸ä¸ªé¨ä»¶éé¢ï¼å¨æ¹è¿çé¢æ¶ï¼ä¸éè¦éæ°ç¼åä¸å¡é»è¾ã\n\n\n\n * Modelï¼æ¨¡åï¼æ¯åºç¨ç¨åºä¸­ç¨äºå¤çåºç¨ç¨åºæ°æ®é»è¾çé¨åãéå¸¸æ¨¡åå¯¹è±¡è´è´£å¨æ°æ®åºä¸­å­åæ°æ®ã\n * Viewï¼è§å¾ï¼æ¯åºç¨ç¨åºä¸­å¤çæ°æ®æ¾ç¤ºçé¨åãéå¸¸è§å¾æ¯ä¾æ®æ¨¡åæ°æ®åå»ºçã\n * Controllerï¼æ§å¶å¨ï¼æ¯åºç¨ç¨åºä¸­å¤çç¨æ·äº¤äºçé¨åãéå¸¸æ§å¶å¨è´è´£ä»è§å¾è¯»åæ°æ®ï¼æ§å¶ç¨æ·è¾å¥ï¼å¹¶åæ¨¡ååéæ°æ®ã\n\n\n# Spring MVC çè¯·æ±æµç¨\n\n\n\næ ¸å¿æ¶æçå·ä½æµç¨æ­¥éª¤å¦ä¸ï¼\n\n 1. é¦åç¨æ·åéè¯·æ±ââ>DispatcherServletï¼åç«¯æ§å¶å¨æ¶å°è¯·æ±åèªå·±ä¸è¿è¡å¤çï¼èæ¯å§æç»å¶ä»çè§£æå¨è¿è¡å¤çï¼ä½ä¸ºç»ä¸è®¿é®ç¹ï¼è¿è¡å¨å±çæµç¨æ§å¶ï¼\n 2. DispatcherServletââ>HandlerMappingï¼ HandlerMapping å°ä¼æè¯·æ±æ å°ä¸º HandlerExecutionChain å¯¹è±¡ï¼åå«ä¸ ä¸ªHandler å¤çå¨ï¼é¡µé¢æ§å¶å¨ï¼å¯¹è±¡ãå¤ä¸ªHandlerInterceptor æ¦æªå¨ï¼å¯¹è±¡ï¼éè¿è¿ç§ç­ç¥æ¨¡å¼ï¼å¾å®¹ææ·»å æ°çæ å°ç­ç¥ï¼\n 3. DispatcherServletââ>HandlerAdapterï¼HandlerAdapter å°ä¼æå¤çå¨åè£ä¸ºééå¨ï¼ä»èæ¯æå¤ç§ç±»åçå¤çå¨ï¼ å³ééå¨è®¾è®¡æ¨¡å¼çåºç¨ï¼ä»èå¾å®¹ææ¯æå¾å¤ç±»åçå¤çå¨ï¼\n 4. HandlerAdapterââ>å¤çå¨åè½å¤çæ¹æ³çè°ç¨ï¼HandlerAdapter å°ä¼æ ¹æ®ééçç»æè°ç¨çæ­£çå¤çå¨çåè½å¤ çæ¹æ³ï¼å®æåè½å¤çï¼å¹¶è¿åä¸ä¸ªModelAndView å¯¹è±¡ï¼åå«æ¨¡åæ°æ®ãé»è¾è§å¾åï¼ï¼\n 5. ModelAndView çé»è¾è§å¾åââ> ViewResolverï¼ViewResolver å°æé»è¾è§å¾åè§£æä¸ºå·ä½çViewï¼éè¿è¿ç§ç­ ç¥æ¨¡å¼ï¼å¾å®¹ææ´æ¢å¶ä»è§å¾ææ¯ï¼\n 6. Viewââ>æ¸²æï¼View ä¼æ ¹æ®ä¼ è¿æ¥çModel æ¨¡åæ°æ®è¿è¡æ¸²æï¼æ­¤å¤çModel å®éæ¯ä¸ä¸ªMap æ°æ®ç»æï¼å æ­¤ å¾å®¹ææ¯æå¶ä»è§å¾ææ¯ï¼\n 7. è¿åæ§å¶æç»DispatcherServletï¼ç±DispatcherServlet è¿åååºç»ç¨æ·ï¼å°æ­¤ä¸ä¸ªæµç¨ç»æã",normalizedContent:"# ä»ä¹æ¯ mvc\n\nmvcè±ææ¯model view controllerï¼æ¯æ¨¡å(model)ï¼è§å¾(view)ï¼æ§å¶å¨(controller)çç¼©åï¼ä¸ç§è½¯ä»¶è®¾è®¡è§èãæ¬è´¨ä¸ä¹æ¯ä¸ç§è§£è¦ã\n\nç¨ä¸ç§ä¸å¡é»è¾ãæ°æ®ãçé¢æ¾ç¤ºåç¦»çæ¹æ³ï¼å°ä¸å¡é»è¾èéå°ä¸ä¸ªé¨ä»¶éé¢ï¼å¨æ¹è¿çé¢æ¶ï¼ä¸éè¦éæ°ç¼åä¸å¡é»è¾ã\n\n\n\n * modelï¼æ¨¡åï¼æ¯åºç¨ç¨åºä¸­ç¨äºå¤çåºç¨ç¨åºæ°æ®é»è¾çé¨åãéå¸¸æ¨¡åå¯¹è±¡è´è´£å¨æ°æ®åºä¸­å­åæ°æ®ã\n * viewï¼è§å¾ï¼æ¯åºç¨ç¨åºä¸­å¤çæ°æ®æ¾ç¤ºçé¨åãéå¸¸è§å¾æ¯ä¾æ®æ¨¡åæ°æ®åå»ºçã\n * controllerï¼æ§å¶å¨ï¼æ¯åºç¨ç¨åºä¸­å¤çç¨æ·äº¤äºçé¨åãéå¸¸æ§å¶å¨è´è´£ä»è§å¾è¯»åæ°æ®ï¼æ§å¶ç¨æ·è¾å¥ï¼å¹¶åæ¨¡ååéæ°æ®ã\n\n\n# spring mvc çè¯·æ±æµç¨\n\n\n\næ ¸å¿æ¶æçå·ä½æµç¨æ­¥éª¤å¦ä¸ï¼\n\n 1. é¦åç¨æ·åéè¯·æ±ââ>dispatcherservletï¼åç«¯æ§å¶å¨æ¶å°è¯·æ±åèªå·±ä¸è¿è¡å¤çï¼èæ¯å§æç»å¶ä»çè§£æå¨è¿è¡å¤çï¼ä½ä¸ºç»ä¸è®¿é®ç¹ï¼è¿è¡å¨å±çæµç¨æ§å¶ï¼\n 2. dispatcherservletââ>handlermappingï¼ handlermapping å°ä¼æè¯·æ±æ å°ä¸º handlerexecutionchain å¯¹è±¡ï¼åå«ä¸ ä¸ªhandler å¤çå¨ï¼é¡µé¢æ§å¶å¨ï¼å¯¹è±¡ãå¤ä¸ªhandlerinterceptor æ¦æªå¨ï¼å¯¹è±¡ï¼éè¿è¿ç§ç­ç¥æ¨¡å¼ï¼å¾å®¹ææ·»å æ°çæ å°ç­ç¥ï¼\n 3. dispatcherservletââ>handleradapterï¼handleradapter å°ä¼æå¤çå¨åè£ä¸ºééå¨ï¼ä»èæ¯æå¤ç§ç±»åçå¤çå¨ï¼ å³ééå¨è®¾è®¡æ¨¡å¼çåºç¨ï¼ä»èå¾å®¹ææ¯æå¾å¤ç±»åçå¤çå¨ï¼\n 4. handleradapterââ>å¤çå¨åè½å¤çæ¹æ³çè°ç¨ï¼handleradapter å°ä¼æ ¹æ®ééçç»æè°ç¨çæ­£çå¤çå¨çåè½å¤ çæ¹æ³ï¼å®æåè½å¤çï¼å¹¶è¿åä¸ä¸ªmodelandview å¯¹è±¡ï¼åå«æ¨¡åæ°æ®ãé»è¾è§å¾åï¼ï¼\n 5. modelandview çé»è¾è§å¾åââ> viewresolverï¼viewresolver å°æé»è¾è§å¾åè§£æä¸ºå·ä½çviewï¼éè¿è¿ç§ç­ ç¥æ¨¡å¼ï¼å¾å®¹ææ´æ¢å¶ä»è§å¾ææ¯ï¼\n 6. viewââ>æ¸²æï¼view ä¼æ ¹æ®ä¼ è¿æ¥çmodel æ¨¡åæ°æ®è¿è¡æ¸²æï¼æ­¤å¤çmodel å®éæ¯ä¸ä¸ªmap æ°æ®ç»æï¼å æ­¤ å¾å®¹ææ¯æå¶ä»è§å¾ææ¯ï¼\n 7. è¿åæ§å¶æç»dispatcherservletï¼ç±dispatcherservlet è¿åååºç»ç¨æ·ï¼å°æ­¤ä¸ä¸ªæµç¨ç»æã",charsets:{cjk:!0}},{title:"Spring boot starter",frontmatter:{title:"Spring boot starter",date:"2023-08-31T22:51:18.000Z",permalink:"/pages/e00296/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/06.Spring%20boot%20starter.html",relativePath:"09.Javaæ¡æ¶/01.Spring/06.Spring boot starter.md",key:"v-e7bc6886",path:"/pages/e00296/",headers:[{level:2,title:"èªå®ä¹ Spring Boot Starter",slug:"èªå®ä¹-spring-boot-starter",normalizedTitle:"èªå®ä¹ spring boot starter",charIndex:2},{level:2,title:"spring boot èªå¨è£é",slug:"spring-boot-èªå¨è£é",normalizedTitle:"spring boot èªå¨è£é",charIndex:515},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:586}],headersStr:"èªå®ä¹ Spring Boot Starter spring boot èªå¨è£é åè",content:"# èªå®ä¹ Spring Boot Starter\n\nå®æ¹å½åç©ºé´ï¼\n\n * åç¼ï¼spring-boot-starter-\n * æ¨¡å¼ï¼spring-boot-starter-æ¨¡åå\n * ä¸¾ä¾ï¼spring-boot-starter-webãspring-boot-starter-jdbc\n\nèªå®ä¹å½åç©ºé´ï¼\n\n * åç¼ï¼-spring-boot-starter\n * æ¨¡å¼ï¼æ¨¡å-spring-boot-starter\n * ä¸¾ä¾ï¼demo-spring-boot-starter\n\nå®ä¹starteréè¦çéç½®ï¼\n\næ ¹æ®springbootçèªå¨éç½®åçï¼å¯ç¥èªå®ä¹starteréè¦\n\n * ä¸ä¸ªxxxxAutoConfigurartionçéç½®æ¨¡å\n * ä¸ä¸ªxxxxProperties:å°è£éç½®æä»¶ä¸­ç¸å³å±æ§\n * éè¦ä¸ä¸ªMETA-INF/spring.factoriesæä»¶æ¥æè¿°éç½®æä»¶å·¥åç±»\n   * org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\com.start.DemoAutoConfiguration\n\n\n# spring boot èªå¨è£é\n\n[02.Spring boot èªå¨è£é.md](02.Spring boot èªå¨è£é.md)\n\n\n# åè\n\n * https://pdai.tech/md/spring/springboot/springboot-y-starter.html\n\n * https://developer.aliyun.com/article/795773 è¿ä¸ªå¾å¥½çè§£",normalizedContent:"# èªå®ä¹ spring boot starter\n\nå®æ¹å½åç©ºé´ï¼\n\n * åç¼ï¼spring-boot-starter-\n * æ¨¡å¼ï¼spring-boot-starter-æ¨¡åå\n * ä¸¾ä¾ï¼spring-boot-starter-webãspring-boot-starter-jdbc\n\nèªå®ä¹å½åç©ºé´ï¼\n\n * åç¼ï¼-spring-boot-starter\n * æ¨¡å¼ï¼æ¨¡å-spring-boot-starter\n * ä¸¾ä¾ï¼demo-spring-boot-starter\n\nå®ä¹starteréè¦çéç½®ï¼\n\næ ¹æ®springbootçèªå¨éç½®åçï¼å¯ç¥èªå®ä¹starteréè¦\n\n * ä¸ä¸ªxxxxautoconfigurartionçéç½®æ¨¡å\n * ä¸ä¸ªxxxxproperties:å°è£éç½®æä»¶ä¸­ç¸å³å±æ§\n * éè¦ä¸ä¸ªmeta-inf/spring.factoriesæä»¶æ¥æè¿°éç½®æä»¶å·¥åç±»\n   * org.springframework.boot.autoconfigure.enableautoconfiguration=\\com.start.demoautoconfiguration\n\n\n# spring boot èªå¨è£é\n\n[02.spring boot èªå¨è£é.md](02.spring boot èªå¨è£é.md)\n\n\n# åè\n\n * https://pdai.tech/md/spring/springboot/springboot-y-starter.html\n\n * https://developer.aliyun.com/article/795773 è¿ä¸ªå¾å¥½çè§£",charsets:{cjk:!0}},{title:"BeanFactoryåFactoryBean",frontmatter:{title:"BeanFactoryåFactoryBean",date:"2023-08-31T23:22:43.000Z",permalink:"/pages/643d4f/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/07.BeanFactory%E5%92%8CFactoryBean.html",relativePath:"09.Javaæ¡æ¶/01.Spring/07.BeanFactoryåFactoryBean.md",key:"v-603745ce",path:"/pages/643d4f/",headers:[{level:2,title:"BeanFactory",slug:"beanfactory",normalizedTitle:"beanfactory",charIndex:2},{level:2,title:"FactoryBean",slug:"factorybean",normalizedTitle:"factorybean",charIndex:476},{level:3,title:"FactoryBean å¨ Mybatis ä¸­çåºç¨",slug:"factorybean-å¨-mybatis-ä¸­çåºç¨",normalizedTitle:"factorybean å¨ mybatis ä¸­çåºç¨",charIndex:798},{level:2,title:"äºèçåºå«",slug:"äºèçåºå«",normalizedTitle:"äºèçåºå«",charIndex:1269},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1759}],headersStr:"BeanFactory FactoryBean FactoryBean å¨ Mybatis ä¸­çåºç¨ äºèçåºå« åè",content:"# BeanFactory\n\nBeanFactoryæ¯ä¸ä¸ªæ¥å£ï¼å®æ¯Springä¸­å·¥åçé¡¶å±è§èï¼æ¯Spring Iocå®¹å¨çæ ¸å¿æ¥å£ï¼å®ä¹äºIOCå®¹å¨çæåºæ¬å½¢å¼ï¼å¹¶æä¾äºIOCå®¹å¨åºéµå®ççæåºæ¬çæ¥å£ï¼èè´£åæ¬å®ä¾åãå®ä½ãéç½®åºç¨ç¨åºä¸­çå¯¹è±¡ä»¥åå»ºç«è¿äºå¯¹è±¡ä¹é´çä¾èµã\n\nå®å®ä¹äºgetBean()ãcontainsBean()ç­ç®¡çBeançéç¨æ¹æ³ã\n\nBeanFacotryæ¯springä¸­æ¯è¾åå§çFactoryãåå§çBeanFactoryæ æ³æ¯æspringçè®¸å¤æä»¶ï¼å¦AOPåè½ãWebåºç¨ç­ã\n\nSpringçå®¹å¨é½æ¯å®çå·ä½å®ç°å¦ï¼\n\n * DefaultListableBeanFactory\n * XmlBeanFactory\n * ApplicationContextï¼ApplicationContextæ¥å£ç±BeanFactoryæ¥å£æ´¾çèæ¥ï¼ApplicationContextåå«BeanFactoryçææåè½ï¼éå¸¸å»ºè®®æ¯BeanFactoryä¼åã\n\nè¿äºå®ç°ç±»åä»ä¸åçç»´åº¦åå«æä¸åçæ©å±ã\n\n\n# FactoryBean\n\né¦åå®æ¯ä¸ä¸ªBeanï¼ä½åä¸ä»ä»æ¯ä¸ä¸ªBeanãå®æ¯ä¸ä¸ªè½çäº§æä¿®é¥°å¯¹è±¡çæçå·¥åBeanï¼ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çå·¥åæ¨¡å¼åè£é¥°å¨æ¨¡å¼ã\n\næ¹æ³ï¼\n\n * getObjectï¼èªå®ä¹åå»ºå¯¹è±¡çè¿ç¨ï¼newï¼åå°ï¼å¨æä»£çï¼\n * isSingleton\n * getObjectType\n\nSpring å¯¹å®ç°äºFactoryBeanæ¥å£çBeanè¿è¡äºç¹æ®å¤çã\n\nä¸»è¦è¡¨ç°ä¸º:\n\n1ãFactoryBeanæ¬èº«æ¯ä¸ªBean 2ãè¯å¾è·åFactoryBeanæ¶ï¼å¾å°çæ¯ FactoryBean ç getObject() è¿åçå¯¹è±¡ 3ãå¯ä»¥éè¿ â&â+ânameâ å¾å°FactoryBean æ¬ä½å¯¹è±¡\n\n\n# FactoryBean å¨ Mybatis ä¸­çåºç¨\n\nä½¿ç¨è¿Spring Bootçåå­¦é½ç¥éï¼å½æä»¬éè¦æ«æMapperçæ¶åï¼éè¦æ·»å @MapperScanæ³¨è§£å®æå¯¹Mapperå¯¹è±¡çæ«æï¼@MapperScanå¯¼å¥MapperScannerRegistrarç±»å®ææ«æã\n\nä½æ¯Mapperç±»é½æ¯æ¥å£ï¼æ æ³è¢«å®ä¾åï¼é£ä¹ä¸ºä»ä¹å¨Springä¸­è½å¤ç´æ¥æ³¨å¥Mapperå¯¹è±¡å¢ï¼\n\nå®éä¸Mybatisæ¯éè¿FactoryBeanå¯¹è±¡åå»ºMapperå¯¹è±¡çä»£çå¯¹è±¡ï¼å®æMapperæ¥å£çæ³¨å¥ã\n\nMybatiséè¿JDKå¨æä»£ççæ¹å¼ï¼åå»ºMapperæ¥å£çä»£çå¯¹è±¡ï¼å¹¶éè¿æ¥å£å£°æçæ¹æ³æ¥æ¾å¹¶æ§è¡SQLã\n\nhttps://juejin.cn/post/6844903878949863431#heading-2\n\nhttps://www.skypyb.com/2019/08/jishu/979/ çåï¼è¿ä¸ç¥éFactoryBeanæå¥ç¨ï¼æ¢å¯»FactoryBeançç©¶æå¥¥ä¹ä¹ä»Spring+MyBatisæ«ææºç è¯´èµ·\n\n\n# äºèçåºå«\n\nspring çæ ¸å¿æ¯ IOC å®¹å¨ï¼IOC å®¹å¨æ¬è´¨ä¸å°±æ¯ bean çå®¹å¨ï¼æèæ¯ä¸ä¸ª bean çå·¥åãè½å¤æ´å·æä»¬å£°æçéç½®ææ³¨è§£å»è¿è¡ bean çå è½½ååå§åãç¶åéè¿ beanFactory çäº§æä»¬éè¦çåç§åæ ·ç beanã\n\nBeanFactory æ¯ææ Spring Bean å®¹å¨çé¡¶çº§æ¥å£ï¼å®ä¸º Spring çå®¹å¨å®ä¹äºä¸å¥è§èï¼å¹¶æä¾å getBean è¿æ ·çæ¹æ³ä»å®¹å¨ä¸­è·åæå®ç bean å®ä¾ã\n\nè FactoryBean æ¯ä¸ä¸ªå·¥å beanï¼å®ä¹æ¯ä¸ä¸ªæ¥å£ï¼å¶ä¸»è¦è½åæ¯å¨æçå»çææä¸ç±»åç Bean çå®ä¾ï¼ä¹å°±æ¯æä»¬å¯ä»¥èªå®ä¹ä¸ä¸ª Beanï¼å¹¶å è½½å° IOC å®¹å¨ä¸­ãå¶ä¸­æä¸ä¸ªéè¦çæ¹æ³ getObject()ï¼å°±æ¯ç¨æ¥å®ç°å¨ææå»º bean çä¸ä¸ªè¿ç¨\n\nç¸åç¹ï¼é½æ¯ç¨æ¥åå»º bean çã\n\nä¸åç¹ï¼æ¯ç¨ BeanFactory åå»ºå¯¹è±¡æ¶ï¼å¿é¡»éµå¾ªä¸¥æ ¼ççå½å¨ææµç¨ãå¦ææ³è¦ç®åèªå®ä¹æä¸ªå¯¹è±¡çåå»ºï¼åæ¶å°åå»ºå®æçå¯¹è±¡äº¤ç» spring å®¹å¨ç®¡çï¼é£ä¹éè¦å®ç° FactoryBean æ¥å£ã\n\n\n# åè\n\n * https://juejin.cn/post/6844903967600836621\n\n * https://bbs.huaweicloud.com/blogs/363939\n\n * https://www.bilibili.com/video/BV1ts4y1z7wJ/?spm_id_from=333.337.search-card.all.click&vd_source=56a32d67ac4f0ccac0c6360804c3cf67",normalizedContent:"# beanfactory\n\nbeanfactoryæ¯ä¸ä¸ªæ¥å£ï¼å®æ¯springä¸­å·¥åçé¡¶å±è§èï¼æ¯spring iocå®¹å¨çæ ¸å¿æ¥å£ï¼å®ä¹äºiocå®¹å¨çæåºæ¬å½¢å¼ï¼å¹¶æä¾äºiocå®¹å¨åºéµå®ççæåºæ¬çæ¥å£ï¼èè´£åæ¬å®ä¾åãå®ä½ãéç½®åºç¨ç¨åºä¸­çå¯¹è±¡ä»¥åå»ºç«è¿äºå¯¹è±¡ä¹é´çä¾èµã\n\nå®å®ä¹äºgetbean()ãcontainsbean()ç­ç®¡çbeançéç¨æ¹æ³ã\n\nbeanfacotryæ¯springä¸­æ¯è¾åå§çfactoryãåå§çbeanfactoryæ æ³æ¯æspringçè®¸å¤æä»¶ï¼å¦aopåè½ãwebåºç¨ç­ã\n\nspringçå®¹å¨é½æ¯å®çå·ä½å®ç°å¦ï¼\n\n * defaultlistablebeanfactory\n * xmlbeanfactory\n * applicationcontextï¼applicationcontextæ¥å£ç±beanfactoryæ¥å£æ´¾çèæ¥ï¼applicationcontextåå«beanfactoryçææåè½ï¼éå¸¸å»ºè®®æ¯beanfactoryä¼åã\n\nè¿äºå®ç°ç±»åä»ä¸åçç»´åº¦åå«æä¸åçæ©å±ã\n\n\n# factorybean\n\né¦åå®æ¯ä¸ä¸ªbeanï¼ä½åä¸ä»ä»æ¯ä¸ä¸ªbeanãå®æ¯ä¸ä¸ªè½çäº§æä¿®é¥°å¯¹è±¡çæçå·¥åbeanï¼ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çå·¥åæ¨¡å¼åè£é¥°å¨æ¨¡å¼ã\n\næ¹æ³ï¼\n\n * getobjectï¼èªå®ä¹åå»ºå¯¹è±¡çè¿ç¨ï¼newï¼åå°ï¼å¨æä»£çï¼\n * issingleton\n * getobjecttype\n\nspring å¯¹å®ç°äºfactorybeanæ¥å£çbeanè¿è¡äºç¹æ®å¤çã\n\nä¸»è¦è¡¨ç°ä¸º:\n\n1ãfactorybeanæ¬èº«æ¯ä¸ªbean 2ãè¯å¾è·åfactorybeanæ¶ï¼å¾å°çæ¯ factorybean ç getobject() è¿åçå¯¹è±¡ 3ãå¯ä»¥éè¿ â&â+ânameâ å¾å°factorybean æ¬ä½å¯¹è±¡\n\n\n# factorybean å¨ mybatis ä¸­çåºç¨\n\nä½¿ç¨è¿spring bootçåå­¦é½ç¥éï¼å½æä»¬éè¦æ«æmapperçæ¶åï¼éè¦æ·»å @mapperscanæ³¨è§£å®æå¯¹mapperå¯¹è±¡çæ«æï¼@mapperscanå¯¼å¥mapperscannerregistrarç±»å®ææ«æã\n\nä½æ¯mapperç±»é½æ¯æ¥å£ï¼æ æ³è¢«å®ä¾åï¼é£ä¹ä¸ºä»ä¹å¨springä¸­è½å¤ç´æ¥æ³¨å¥mapperå¯¹è±¡å¢ï¼\n\nå®éä¸mybatisæ¯éè¿factorybeanå¯¹è±¡åå»ºmapperå¯¹è±¡çä»£çå¯¹è±¡ï¼å®æmapperæ¥å£çæ³¨å¥ã\n\nmybatiséè¿jdkå¨æä»£ççæ¹å¼ï¼åå»ºmapperæ¥å£çä»£çå¯¹è±¡ï¼å¹¶éè¿æ¥å£å£°æçæ¹æ³æ¥æ¾å¹¶æ§è¡sqlã\n\nhttps://juejin.cn/post/6844903878949863431#heading-2\n\nhttps://www.skypyb.com/2019/08/jishu/979/ çåï¼è¿ä¸ç¥éfactorybeanæå¥ç¨ï¼æ¢å¯»factorybeançç©¶æå¥¥ä¹ä¹ä»spring+mybatisæ«ææºç è¯´èµ·\n\n\n# äºèçåºå«\n\nspring çæ ¸å¿æ¯ ioc å®¹å¨ï¼ioc å®¹å¨æ¬è´¨ä¸å°±æ¯ bean çå®¹å¨ï¼æèæ¯ä¸ä¸ª bean çå·¥åãè½å¤æ´å·æä»¬å£°æçéç½®ææ³¨è§£å»è¿è¡ bean çå è½½ååå§åãç¶åéè¿ beanfactory çäº§æä»¬éè¦çåç§åæ ·ç beanã\n\nbeanfactory æ¯ææ spring bean å®¹å¨çé¡¶çº§æ¥å£ï¼å®ä¸º spring çå®¹å¨å®ä¹äºä¸å¥è§èï¼å¹¶æä¾å getbean è¿æ ·çæ¹æ³ä»å®¹å¨ä¸­è·åæå®ç bean å®ä¾ã\n\nè factorybean æ¯ä¸ä¸ªå·¥å beanï¼å®ä¹æ¯ä¸ä¸ªæ¥å£ï¼å¶ä¸»è¦è½åæ¯å¨æçå»çææä¸ç±»åç bean çå®ä¾ï¼ä¹å°±æ¯æä»¬å¯ä»¥èªå®ä¹ä¸ä¸ª beanï¼å¹¶å è½½å° ioc å®¹å¨ä¸­ãå¶ä¸­æä¸ä¸ªéè¦çæ¹æ³ getobject()ï¼å°±æ¯ç¨æ¥å®ç°å¨ææå»º bean çä¸ä¸ªè¿ç¨\n\nç¸åç¹ï¼é½æ¯ç¨æ¥åå»º bean çã\n\nä¸åç¹ï¼æ¯ç¨ beanfactory åå»ºå¯¹è±¡æ¶ï¼å¿é¡»éµå¾ªä¸¥æ ¼ççå½å¨ææµç¨ãå¦ææ³è¦ç®åèªå®ä¹æä¸ªå¯¹è±¡çåå»ºï¼åæ¶å°åå»ºå®æçå¯¹è±¡äº¤ç» spring å®¹å¨ç®¡çï¼é£ä¹éè¦å®ç° factorybean æ¥å£ã\n\n\n# åè\n\n * https://juejin.cn/post/6844903967600836621\n\n * https://bbs.huaweicloud.com/blogs/363939\n\n * https://www.bilibili.com/video/bv1ts4y1z7wj/?spm_id_from=333.337.search-card.all.click&vd_source=56a32d67ac4f0ccac0c6360804c3cf67",charsets:{cjk:!0}},{title:"Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ",frontmatter:{title:"Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ",date:"2023-09-05T00:24:02.000Z",permalink:"/pages/329b73/"},regularPath:"/09.Java%E6%A1%86%E6%9E%B6/01.Spring/08.Spring%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98%E8%A7%A3%E5%86%B3%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96.html",relativePath:"09.Javaæ¡æ¶/01.Spring/08.Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ.md",key:"v-4ae61c39",path:"/pages/329b73/",headers:[{level:2,title:"ä¸ºä»ä¹è¦ä¸çº§ç¼å­ï¼äºçº§ä¸è¡åï¼",slug:"ä¸ºä»ä¹è¦ä¸çº§ç¼å­-äºçº§ä¸è¡å",normalizedTitle:"ä¸ºä»ä¹è¦ä¸çº§ç¼å­ï¼äºçº§ä¸è¡åï¼",charIndex:471},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1279}],headersStr:"ä¸ºä»ä¹è¦ä¸çº§ç¼å­ï¼äºçº§ä¸è¡åï¼ åè",content:"å¨ä½¿ç¨springæ¡æ¶çæ¥å¸¸å¼åä¸­ï¼beanä¹é´çå¾ªç¯ä¾èµå¤ªé¢ç¹äºï¼springå·²ç»å¸®æä»¬å»è§£å³å¾ªç¯ä¾èµé®é¢ï¼å¯¹æä»¬å¼åèæ¥è¯´æ¯æ æç¥çï¼ä¸é¢å·ä½åæä¸ä¸springæ¯å¦ä½è§£å³beanä¹é´å¾ªç¯ä¾èµï¼ä¸ºä»ä¹è¦ä½¿ç¨å°ä¸çº§ç¼å­ï¼èä¸æ¯äºçº§ç¼å­ã\n\né¦åéè¦äºè§£ä¸ä¸beanå¨springä¸­ççå½å¨æï¼beanå¨springçå è½½æµç¨ï¼æè½å¤æ´å æ¸æ°ç¥éspringæ¯å¦ä½è§£å³å¾ªç¯ä¾èµçã\n\nbean ççå½å¨æï¼\n\n 1. å®ä¾åbeanï¼åéåå­å°å\n 2. å±æ§æ³¨å¥\n 3. åå§åbeanï¼æ§è¡initæ¹æ³\n 4. éæ¯ bean\n\nä¸çº§ç¼å­ï¼å­æ¾å®å¨åå§åå¥½ç Beanï¼å¯ä»¥ç´æ¥ä½¿ç¨\n\näºçº§ç¼å­ï¼å­æ¾åå§ç Bean å¯¹è±¡ï¼å³è¿æ²¡è¿è¡èµå¼ï¼æ²¡æè¢«ä¾èµæ³¨å¥\n\nä¸çº§ç¼å­ï¼å­æ¾ Bean å·¥åå¯¹è±¡ï¼è¯¥å·¥åå¯¹è±¡è´è´£çæåå§ Bean å¯¹è±¡ï¼å¹¶å°å¶æ¾å¥å°äºçº§ç¼å­ä¸­ãä¸»è¦ç¨äºè§£å³ä»£çå¯¹è±¡çå¾ªç¯ä¾èµé®é¢ã\n\n\n\nå¶æ ¸å¿ææ³æ¯å° Bean çå®ä¾åå Bean ä¸­çå±æ§ä¾èµæ³¨å¥åç¦»å¼ã\n\nSpring æ¬èº«åªè½è§£å³åä¾å­å¨çå¾ªç¯å¼ç¨é®é¢ã\n\n\n# ä¸ºä»ä¹è¦ä¸çº§ç¼å­ï¼äºçº§ä¸è¡åï¼\n\néè¦ä¸çº§ç¼å­èä¸æ¯äºçº§ï¼æ¯ä¸ºäºéå¯¹æä»£ççæåµã\n\næ²¡æå¨æä»£ççæåµï¼å¶å®æäºçº§ç¼å­æ¿æï¼å¨ B å°è¯è·å A çæ¶åç´æ¥è¿å A çå®ä¾ï¼ä¹æ¯å¯ä»¥çã\n\nå¾ªç¯ä¾èµä¸ï¼ææ²¡æä»£çæåµä¸çåºå«å°±å¨ï¼\n\nsingletonObject = singletonFactory.getObject();\n\n\nå¨å¾ªç¯ä¾èµåççæåµä¸ B ä¸­ç A èµå¼æ¶ï¼\n\n 1. æ ä»£çï¼getObject ç´æ¥è¿ååæ¥ç Bean\n 2. æä»£çï¼getObject è¿åçæ¯ä»£çå¯¹è±¡\n\nç¶åé½æ¾å°äºçº§ç¼å­ã\n\nåè®¾å»æä¸çº§ç¼å­\n\nå»æä¸çº§ç¼å­ä¹åï¼Bean ç´æ¥åå»º earlySingletonObjectsï¼ ççå¥½åä¹å¯ä»¥ã\n\nå¦ææä»£ççæ¶åï¼å¨ earlySingletonObjects ç´æ¥æ¾ä»£çå¯¹è±¡å°±è¡äºã\n\nä½æ¯ä¼å¯¼è´ä¸ä¸ªé®é¢ï¼å¨å®ä¾åé¶æ®µå°±å¾æ§è¡åç½®å¤çå¨ï¼å¤æ­æ AnnotationAwareAspectJAutoProxyCreator å¹¶åå»ºä»£çå¯¹è±¡ã\n\nè¿ä¹ä¸æ³ï¼æ¯ä¸æ¯ä¼å¯¹ Bean ççå½å¨ææå½±åã\n\nåæ ·ï¼ååå»º singletonFactory çå¥½å¤å°±æ¯ï¼å¨çæ­£éè¦å®ä¾åçæ¶åï¼åä½¿ç¨ singletonFactory.getObject() è·å Bean æè Bean çä»£çãç¸å½äºæ¯å»¶è¿å®ä¾åã\n\nåè®¾å»æäºçº§ç¼å­\n\nå¦æå»æäºäºçº§ç¼å­ï¼åéè¦ç´æ¥å¨ singletonFactory.getObject() é¶æ®µåå§åå®æ¯ï¼å¹¶æ¾å°ä¸çº§ç¼å­ä¸­ã\n\né£æè¿ä¹ä¸ç§åºæ¯ï¼B å C é½ä¾èµäº Aã\n\nè¦ç¥éå¨æä»£ççæåµä¸ singletonFactory.getObject() è·åçæ¯ä»£çå¯¹è±¡ã\n\nèå¤æ¬¡è°ç¨ singletonFactory.getObject() è¿åçä»£çå¯¹è±¡æ¯ä¸åçï¼å°±ä¼å¯¼è´ B å C ä¾èµäºä¸åç Aã\n\n\n# åè\n\n 1. https://zhuanlan.zhihu.com/p/377878056\n 2. https://www.bilibili.com/video/BV1Sm4y1N7FD/?vd_source=56a32d67ac4f0ccac0c6360804c3cf67\n 3. https://www.pdai.tech/md/spring/spring-x-framework-ioc-source-3.html#spring%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BE%9D%E8%B5%96",normalizedContent:"å¨ä½¿ç¨springæ¡æ¶çæ¥å¸¸å¼åä¸­ï¼beanä¹é´çå¾ªç¯ä¾èµå¤ªé¢ç¹äºï¼springå·²ç»å¸®æä»¬å»è§£å³å¾ªç¯ä¾èµé®é¢ï¼å¯¹æä»¬å¼åèæ¥è¯´æ¯æ æç¥çï¼ä¸é¢å·ä½åæä¸ä¸springæ¯å¦ä½è§£å³beanä¹é´å¾ªç¯ä¾èµï¼ä¸ºä»ä¹è¦ä½¿ç¨å°ä¸çº§ç¼å­ï¼èä¸æ¯äºçº§ç¼å­ã\n\né¦åéè¦äºè§£ä¸ä¸beanå¨springä¸­ççå½å¨æï¼beanå¨springçå è½½æµç¨ï¼æè½å¤æ´å æ¸æ°ç¥éspringæ¯å¦ä½è§£å³å¾ªç¯ä¾èµçã\n\nbean ççå½å¨æï¼\n\n 1. å®ä¾åbeanï¼åéåå­å°å\n 2. å±æ§æ³¨å¥\n 3. åå§åbeanï¼æ§è¡initæ¹æ³\n 4. éæ¯ bean\n\nä¸çº§ç¼å­ï¼å­æ¾å®å¨åå§åå¥½ç beanï¼å¯ä»¥ç´æ¥ä½¿ç¨\n\näºçº§ç¼å­ï¼å­æ¾åå§ç bean å¯¹è±¡ï¼å³è¿æ²¡è¿è¡èµå¼ï¼æ²¡æè¢«ä¾èµæ³¨å¥\n\nä¸çº§ç¼å­ï¼å­æ¾ bean å·¥åå¯¹è±¡ï¼è¯¥å·¥åå¯¹è±¡è´è´£çæåå§ bean å¯¹è±¡ï¼å¹¶å°å¶æ¾å¥å°äºçº§ç¼å­ä¸­ãä¸»è¦ç¨äºè§£å³ä»£çå¯¹è±¡çå¾ªç¯ä¾èµé®é¢ã\n\n\n\nå¶æ ¸å¿ææ³æ¯å° bean çå®ä¾åå bean ä¸­çå±æ§ä¾èµæ³¨å¥åç¦»å¼ã\n\nspring æ¬èº«åªè½è§£å³åä¾å­å¨çå¾ªç¯å¼ç¨é®é¢ã\n\n\n# ä¸ºä»ä¹è¦ä¸çº§ç¼å­ï¼äºçº§ä¸è¡åï¼\n\néè¦ä¸çº§ç¼å­èä¸æ¯äºçº§ï¼æ¯ä¸ºäºéå¯¹æä»£ççæåµã\n\næ²¡æå¨æä»£ççæåµï¼å¶å®æäºçº§ç¼å­æ¿æï¼å¨ b å°è¯è·å a çæ¶åç´æ¥è¿å a çå®ä¾ï¼ä¹æ¯å¯ä»¥çã\n\nå¾ªç¯ä¾èµä¸ï¼ææ²¡æä»£çæåµä¸çåºå«å°±å¨ï¼\n\nsingletonobject = singletonfactory.getobject();\n\n\nå¨å¾ªç¯ä¾èµåççæåµä¸ b ä¸­ç a èµå¼æ¶ï¼\n\n 1. æ ä»£çï¼getobject ç´æ¥è¿ååæ¥ç bean\n 2. æä»£çï¼getobject è¿åçæ¯ä»£çå¯¹è±¡\n\nç¶åé½æ¾å°äºçº§ç¼å­ã\n\nåè®¾å»æä¸çº§ç¼å­\n\nå»æä¸çº§ç¼å­ä¹åï¼bean ç´æ¥åå»º earlysingletonobjectsï¼ ççå¥½åä¹å¯ä»¥ã\n\nå¦ææä»£ççæ¶åï¼å¨ earlysingletonobjects ç´æ¥æ¾ä»£çå¯¹è±¡å°±è¡äºã\n\nä½æ¯ä¼å¯¼è´ä¸ä¸ªé®é¢ï¼å¨å®ä¾åé¶æ®µå°±å¾æ§è¡åç½®å¤çå¨ï¼å¤æ­æ annotationawareaspectjautoproxycreator å¹¶åå»ºä»£çå¯¹è±¡ã\n\nè¿ä¹ä¸æ³ï¼æ¯ä¸æ¯ä¼å¯¹ bean ççå½å¨ææå½±åã\n\nåæ ·ï¼ååå»º singletonfactory çå¥½å¤å°±æ¯ï¼å¨çæ­£éè¦å®ä¾åçæ¶åï¼åä½¿ç¨ singletonfactory.getobject() è·å bean æè bean çä»£çãç¸å½äºæ¯å»¶è¿å®ä¾åã\n\nåè®¾å»æäºçº§ç¼å­\n\nå¦æå»æäºäºçº§ç¼å­ï¼åéè¦ç´æ¥å¨ singletonfactory.getobject() é¶æ®µåå§åå®æ¯ï¼å¹¶æ¾å°ä¸çº§ç¼å­ä¸­ã\n\né£æè¿ä¹ä¸ç§åºæ¯ï¼b å c é½ä¾èµäº aã\n\nè¦ç¥éå¨æä»£ççæåµä¸ singletonfactory.getobject() è·åçæ¯ä»£çå¯¹è±¡ã\n\nèå¤æ¬¡è°ç¨ singletonfactory.getobject() è¿åçä»£çå¯¹è±¡æ¯ä¸åçï¼å°±ä¼å¯¼è´ b å c ä¾èµäºä¸åç aã\n\n\n# åè\n\n 1. https://zhuanlan.zhihu.com/p/377878056\n 2. https://www.bilibili.com/video/bv1sm4y1n7fd/?vd_source=56a32d67ac4f0ccac0c6360804c3cf67\n 3. https://www.pdai.tech/md/spring/spring-x-framework-ioc-source-3.html#spring%e5%8d%95%e4%be%8b%e6%a8%a1%e5%bc%8f%e4%b8%8b%e7%9a%84%e5%b1%9e%e6%80%a7%e4%be%9d%e8%b5%96",charsets:{cjk:!0}},{title:"kafkaé¶æ·è´ææ¯",frontmatter:{title:"kafkaé¶æ·è´ææ¯",date:"2023-09-02T00:58:25.000Z",permalink:"/pages/40cb9b/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.Kafka/02.kafka%E9%9B%B6%E6%8B%B7%E8%B4%9D%E6%8A%80%E6%9C%AF.html",relativePath:"10.ä¸­é´ä»¶/01.Kafka/02.kafkaé¶æ·è´ææ¯.md",key:"v-01e74dde",path:"/pages/40cb9b/",headers:[{level:2,title:"å¨Javaä¸­é¶æ·è´çå®ç°",slug:"å¨javaä¸­é¶æ·è´çå®ç°",normalizedTitle:"å¨javaä¸­é¶æ·è´çå®ç°",charIndex:232},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1273}],headersStr:"å¨Javaä¸­é¶æ·è´çå®ç° åè",content:'kafkaé«æ§è½è¯»åï¼é¶æ·è´ææ¯\n\nKafkaçæ°æ®æ¯æä¹åå°æ¯ä¸ªPartitionä¸ç.logæä»¶ä¸­çï¼å æ­¤å½éè¦æ¶è´¹å·²ç»æä¹åçæ¶æ¯æ¶ï¼å¿å¿éè¦ä»ç£çä¸­å°æ°æ®è¯»åå°åå­ä¸­ï¼å¹¶éè¿ç½å¡åéç»æ¶è´¹èã\n\næè°çé¶æ·è´æ¯æå°æ°æ®å¨åæ ¸ç©ºé´ç´æ¥ä»ç£çæä»¶å¤å¶å°ç½å¡ä¸­ï¼èä¸éè¦ç»ç±ç¨æ·æçåºç¨ç¨åºä¹æãè¿æ ·æ¢å¯ä»¥æé«æ°æ®è¯»åçæ§è½ï¼ä¹è½åå°æ ¸å¿æåç¨æ·æä¹é´çä¸ä¸æåæ¢ï¼æé«æ°æ®ä¼ è¾æçãå¶æ¬è´¨æ¯éè¿DMAææ¯ï¼ä½¿CPUå¾å°è§£æ¾ï¼å®ç°æ°æ®çé«æ§è½ä¼ è¾ã\n\n\n\n\n# å¨Javaä¸­é¶æ·è´çå®ç°\n\nJavaä¸­çé¶æ·è´æ¯ä¾é java.nio.channels.FileChannelä¸­çtransferTo(long position, long count, WritableByteChannel target)æ¹æ³æ¥å®ç°çãtransferToæ¹æ³çåºå±å®ç°æ¯åºäºæä½ç³»ç»çsendfileè¿ä¸ªsystem callæ¥å®ç°çï¼æ éå°æ°æ®æ·è´å°ç¨æ·æï¼sendfileè´è´£ææ°æ®ä»æä¸ªfdï¼file descriptorï¼ä¼ è¾å°å¦ä¸ä¸ªfdãè¿æ ·å°±å®æäºé¶æ·è´çè¿ç¨ãé¶æ·è´çç¤ºä¾ä»£ç å¦ä¸æç¤ºï¼\n\nimport java.io.File;\nimport java.io.RandomAccessFile;\nimport java.net.InetSocketAddress;\nimport java.nio.channels.FileChannel;\nimport java.nio.channels.SocketChannel;\n\npublic class ZeroCopy {\n    public static void main(String[] args) throws Exception {\n        File file  = new File("xxxxxx.log");\n\n        RandomAccessFile raf = new RandomAccessFile(file, "rw");\n\n        FileChannel channel = raf.getChannel();\n\n        //Opens a socket channel and connects it to a remote address.\n        SocketChannel socketChannel = SocketChannel.open(\n                new InetSocketAddress("192.168.2.222", 9091)\n        );\n\n        //Transfers bytes from this channel\'s file to the given writable byte channel.\n        channel.transferTo(0,channel.size(), socketChannel);\n    }\n}\n\n\n\n# åè\n\nhttps://www.jianshu.com/p/0af1b4f1e164',normalizedContent:'kafkaé«æ§è½è¯»åï¼é¶æ·è´ææ¯\n\nkafkaçæ°æ®æ¯æä¹åå°æ¯ä¸ªpartitionä¸ç.logæä»¶ä¸­çï¼å æ­¤å½éè¦æ¶è´¹å·²ç»æä¹åçæ¶æ¯æ¶ï¼å¿å¿éè¦ä»ç£çä¸­å°æ°æ®è¯»åå°åå­ä¸­ï¼å¹¶éè¿ç½å¡åéç»æ¶è´¹èã\n\næè°çé¶æ·è´æ¯æå°æ°æ®å¨åæ ¸ç©ºé´ç´æ¥ä»ç£çæä»¶å¤å¶å°ç½å¡ä¸­ï¼èä¸éè¦ç»ç±ç¨æ·æçåºç¨ç¨åºä¹æãè¿æ ·æ¢å¯ä»¥æé«æ°æ®è¯»åçæ§è½ï¼ä¹è½åå°æ ¸å¿æåç¨æ·æä¹é´çä¸ä¸æåæ¢ï¼æé«æ°æ®ä¼ è¾æçãå¶æ¬è´¨æ¯éè¿dmaææ¯ï¼ä½¿cpuå¾å°è§£æ¾ï¼å®ç°æ°æ®çé«æ§è½ä¼ è¾ã\n\n\n\n\n# å¨javaä¸­é¶æ·è´çå®ç°\n\njavaä¸­çé¶æ·è´æ¯ä¾é java.nio.channels.filechannelä¸­çtransferto(long position, long count, writablebytechannel target)æ¹æ³æ¥å®ç°çãtransfertoæ¹æ³çåºå±å®ç°æ¯åºäºæä½ç³»ç»çsendfileè¿ä¸ªsystem callæ¥å®ç°çï¼æ éå°æ°æ®æ·è´å°ç¨æ·æï¼sendfileè´è´£ææ°æ®ä»æä¸ªfdï¼file descriptorï¼ä¼ è¾å°å¦ä¸ä¸ªfdãè¿æ ·å°±å®æäºé¶æ·è´çè¿ç¨ãé¶æ·è´çç¤ºä¾ä»£ç å¦ä¸æç¤ºï¼\n\nimport java.io.file;\nimport java.io.randomaccessfile;\nimport java.net.inetsocketaddress;\nimport java.nio.channels.filechannel;\nimport java.nio.channels.socketchannel;\n\npublic class zerocopy {\n    public static void main(string[] args) throws exception {\n        file file  = new file("xxxxxx.log");\n\n        randomaccessfile raf = new randomaccessfile(file, "rw");\n\n        filechannel channel = raf.getchannel();\n\n        //opens a socket channel and connects it to a remote address.\n        socketchannel socketchannel = socketchannel.open(\n                new inetsocketaddress("192.168.2.222", 9091)\n        );\n\n        //transfers bytes from this channel\'s file to the given writable byte channel.\n        channel.transferto(0,channel.size(), socketchannel);\n    }\n}\n\n\n\n# åè\n\nhttps://www.jianshu.com/p/0af1b4f1e164',charsets:{cjk:!0}},{title:"Kafkaå¤çº¿ç¨æ¶è´¹",frontmatter:{title:"Kafkaå¤çº¿ç¨æ¶è´¹",date:"2023-09-01T23:26:52.000Z",permalink:"/pages/5e6384/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.Kafka/Kafka%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%B6%88%E8%B4%B9.html",relativePath:"10.ä¸­é´ä»¶/01.Kafka/Kafkaå¤çº¿ç¨æ¶è´¹.md",key:"v-c9002668",path:"/pages/5e6384/",headersStr:null,content:"è®¾ç½®ä¸ä¸ªçå¬å¨ï¼å¯¹æäº¤çoffsetè¿è¡æåºã\n\næäº¤è¿ç»­çoffsetçæå¤§å¼ã\n\nhttps://www.bilibili.com/video/BV1iv4y1x7bg/?spm_id_from=333.337.search-card.all.click\n\nhttps://www.oomspot.com/post/injishuyushizhan20duoxianchengkaifaxiaofeizheshili",normalizedContent:"è®¾ç½®ä¸ä¸ªçå¬å¨ï¼å¯¹æäº¤çoffsetè¿è¡æåºã\n\næäº¤è¿ç»­çoffsetçæå¤§å¼ã\n\nhttps://www.bilibili.com/video/bv1iv4y1x7bg/?spm_id_from=333.337.search-card.all.click\n\nhttps://www.oomspot.com/post/injishuyushizhan20duoxianchengkaifaxiaofeizheshili",charsets:{cjk:!0}},{title:"RocketMQ",frontmatter:{title:"RocketMQ",date:"2023-03-31T14:08:22.000Z",permalink:"/pages/279572/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/02.RocketMQ.html",relativePath:"10.ä¸­é´ä»¶/02.RocketMQ.md",key:"v-129110e4",path:"/pages/279572/",headers:[{level:2,title:"RocketMQä¸­çæ¶æ¯æ¨¡å",slug:"rocketmqä¸­çæ¶æ¯æ¨¡å",normalizedTitle:"rocketmqä¸­çæ¶æ¯æ¨¡å",charIndex:2},{level:2,title:"RocketMQçæ¶æ",slug:"rocketmqçæ¶æ",normalizedTitle:"rocketmqçæ¶æ",charIndex:965},{level:2,title:"éå¤æ¶è´¹é®é¢",slug:"éå¤æ¶è´¹é®é¢",normalizedTitle:"éå¤æ¶è´¹é®é¢",charIndex:2407},{level:2,title:"å®ç°é¡ºåºæ¶è´¹",slug:"å®ç°é¡ºåºæ¶è´¹",normalizedTitle:"å®ç°é¡ºåºæ¶è´¹",charIndex:2892},{level:2,title:"æ¶æ¯å ç§¯é®é¢",slug:"æ¶æ¯å ç§¯é®é¢",normalizedTitle:"æ¶æ¯å ç§¯é®é¢",charIndex:3163},{level:2,title:"åæº¯æ¶è´¹",slug:"åæº¯æ¶è´¹",normalizedTitle:"åæº¯æ¶è´¹",charIndex:3446},{level:2,title:"åå¸å¼äºå¡",slug:"åå¸å¼äºå¡",normalizedTitle:"åå¸å¼äºå¡",charIndex:3662},{level:2,title:"RocketMQ çå·çæºå¶",slug:"rocketmq-çå·çæºå¶",normalizedTitle:"rocketmq çå·çæºå¶",charIndex:4495},{level:3,title:"åæ­¥å·çåå¼æ­¥å·ç",slug:"åæ­¥å·çåå¼æ­¥å·ç",normalizedTitle:"åæ­¥å·çåå¼æ­¥å·ç",charIndex:4514},{level:2,title:"å­å¨æºå¶",slug:"å­å¨æºå¶",normalizedTitle:"å­å¨æºå¶",charIndex:4530}],headersStr:"RocketMQä¸­çæ¶æ¯æ¨¡å RocketMQçæ¶æ éå¤æ¶è´¹é®é¢ å®ç°é¡ºåºæ¶è´¹ æ¶æ¯å ç§¯é®é¢ åæº¯æ¶è´¹ åå¸å¼äºå¡ RocketMQ çå·çæºå¶ åæ­¥å·çåå¼æ­¥å·ç å­å¨æºå¶",content:"# RocketMQä¸­çæ¶æ¯æ¨¡å\n\nRocketMQ ä¸­çæ¶æ¯æ¨¡åå°±æ¯æç§ ä¸»é¢æ¨¡åï¼åå¸è®¢éæ¨¡å¼ï¼ æå®ç°çã\n\nå¶å®å¯¹äºä¸»é¢æ¨¡åçå®ç°æ¥è¯´æ¯ä¸ªæ¶æ¯ä¸­é´ä»¶çåºå±è®¾è®¡é½æ¯ä¸ä¸æ ·çï¼å°±æ¯å¦ Kafka ä¸­ç ååº ï¼RocketMQ ä¸­ç éå ï¼RabbitMQ ä¸­ç Exchange ãæä»¬å¯ä»¥çè§£ä¸º ä¸»é¢æ¨¡å/åå¸è®¢éæ¨¡å å°±æ¯ä¸ä¸ªæ åï¼é£äºä¸­é´ä»¶åªä¸è¿ç§çè¿ä¸ªæ åå»å®ç°èå·²ã\n\n\n\nçäº§èç»ä¸­ççäº§èä¼åä¸»é¢åéæ¶æ¯ï¼è ä¸»é¢ä¸­å­å¨å¤ä¸ªéåï¼çäº§èæ¯æ¬¡çäº§æ¶æ¯ä¹åæ¯æå®ä¸»é¢ä¸­çæä¸ªéååéæ¶æ¯çã\n\næ¯ä¸ªä¸»é¢ä¸­é½æå¤ä¸ªéå(åå¸å¨ä¸åç Brokerä¸­ï¼å¦ææ¯éç¾¤çè¯ï¼Brokerååå¸å¨ä¸åçæå¡å¨ä¸­)ï¼éç¾¤æ¶è´¹æ¨¡å¼ä¸ï¼ä¸ä¸ªæ¶è´¹èéç¾¤å¤å°æºå¨å±åæ¶è´¹ä¸ä¸ª topic çå¤ä¸ªéåï¼ä¸ä¸ªéååªä¼è¢«ä¸ä¸ªæ¶è´¹èæ¶è´¹ãå¦ææä¸ªæ¶è´¹èææï¼åç»åå¶å®æ¶è´¹èä¼æ¥æ¿ææçæ¶è´¹èç»§ç»­æ¶è´¹ãå°±åä¸å¾ä¸­ Consumer1 å Consumer2 åå«å¯¹åºçä¸¤ä¸ªéåï¼è Consumer3 æ¯æ²¡æéåå¯¹åºçï¼æä»¥ä¸è¬æ¥è®²è¦æ§å¶ æ¶è´¹èç»ä¸­çæ¶è´¹èä¸ªæ°åä¸»é¢ä¸­éåä¸ªæ°ç¸å ã\n\n\næ¯ä¸ªæ¶è´¹ç»å¨æ¯ä¸ªéåä¸ç»´æ¤ä¸ä¸ªæ¶è´¹ä½ç½® ï¼ä¸ºä»ä¹å¢ï¼\n\nå ä¸ºæä»¬ååç»çä»ä»æ¯ä¸ä¸ªæ¶è´¹èç»ï¼æä»¬ç¥éå¨åå¸è®¢éæ¨¡å¼ä¸­ä¸è¬ä¼æ¶åå°å¤ä¸ªæ¶è´¹èç»ï¼èæ¯ä¸ªæ¶è´¹èç»å¨æ¯ä¸ªéåä¸­çæ¶è´¹ä½ç½®é½æ¯ä¸åçãå¦ææ­¤æ¶æå¤ä¸ªæ¶è´¹èç»ï¼é£ä¹æ¶æ¯è¢«ä¸ä¸ªæ¶è´¹èç»æ¶è´¹å®ä¹åæ¯ä¸ä¼å é¤ç(å ä¸ºå¶å®æ¶è´¹èç»ä¹éè¦å)ï¼å®ä»ä»æ¯ä¸ºæ¯ä¸ªæ¶è´¹èç»ç»´æ¤ä¸ä¸ª æ¶è´¹ä½ç§»(offset) ï¼æ¯æ¬¡æ¶è´¹èç»æ¶è´¹å®ä¼è¿åä¸ä¸ªæåçååºï¼ç¶åéååæç»´æ¤çæ¶è´¹ä½ç§»å ä¸ï¼è¿æ ·å°±ä¸ä¼åºç°ååæ¶è´¹è¿çæ¶æ¯åä¸æ¬¡è¢«æ¶è´¹äºã\n\n\n\n\nä¸ºä»ä¹ä¸ä¸ªä¸»é¢ä¸­éè¦ç»´æ¤å¤ä¸ªéå ï¼\n\nä¸ºäº æé«å¹¶åè½å ãçç¡®ï¼æ¯ä¸ªä¸»é¢ä¸­åªå­å¨ä¸ä¸ªéåä¹æ¯å¯è¡çãä½æ¯ï¼è¿æ ·çäº§èæ¯ä¸æ¯åªè½åä¸ä¸ªéååéæ¶æ¯ï¼åå ä¸ºéè¦ç»´æ¤æ¶è´¹ä½ç½®æä»¥ä¸ä¸ªéååªè½å¯¹åºä¸ä¸ªæ¶è´¹èç»ä¸­çæ¶è´¹èï¼è¿æ ·æ¯ä¸æ¯å¶ä»ç Consumer å°±æ²¡æç¨æ­¦ä¹å°äºï¼ä»è¿ä¸¤ä¸ªè§åº¦æ¥è®²ï¼å¹¶ååº¦ä¸ä¸å­å°±å°äºå¾å¤ã\n\næä»¥æ»ç»æ¥è¯´ï¼RocketMQ éè¿ä½¿ç¨å¨ä¸ä¸ª Topic ä¸­éç½®å¤ä¸ªéåå¹¶ä¸æ¯ä¸ªéåç»´æ¤æ¯ä¸ªæ¶è´¹èç»çæ¶è´¹ä½ç½® å®ç°äº ä¸»é¢æ¨¡å¼/åå¸è®¢éæ¨¡å¼ ã\n\n\n# RocketMQçæ¶æ\n\n\n\n * NameServerï¼ è· ZooKeeper å Spring Cloud ä¸­ç Eureka ï¼ä¸æ ·æ¯ä¸ä¸ª æ³¨åä¸­å¿ ï¼ä¸»è¦æä¾ä¸¤ä¸ªåè½ï¼Brokerç®¡ç å è·¯ç±ä¿¡æ¯ç®¡ç ãè¯´ç½äºå°±æ¯ Broker ä¼å°èªå·±çä¿¡æ¯æ³¨åå° NameServer ä¸­ï¼æ­¤æ¶ NameServer å°±å­æ¾äºå¾å¤ Broker çä¿¡æ¯(Brokerçè·¯ç±è¡¨)ï¼æ¶è´¹èåçäº§èå°±ä» NameServer ä¸­è·åè·¯ç±è¡¨ç¶åç§çè·¯ç±è¡¨çä¿¡æ¯åå¯¹åºç Broker è¿è¡éä¿¡(çäº§èåæ¶è´¹èå®æä¼å NameServer å»æ¥è¯¢ç¸å³ç Broker çä¿¡æ¯)ã\n * Producerï¼ æ¶æ¯åå¸çè§è²ï¼æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ã\n * Consumerï¼ æ¶æ¯æ¶è´¹çè§è²ï¼æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãæ¯æä»¥pushæ¨ï¼pullæä¸¤ç§æ¨¡å¼å¯¹æ¶æ¯è¿è¡æ¶è´¹ãåæ¶ä¹æ¯æéç¾¤æ¹å¼åå¹¿æ­æ¹å¼çæ¶è´¹ï¼å®æä¾å®æ¶æ¶æ¯è®¢éæºå¶ã\n * Brokerï¼ ä¸»è¦è´è´£æ¶æ¯çå­å¨ãæéåæ¥è¯¢ä»¥åæå¡é«å¯ç¨ä¿è¯ãå°±æ¯æ¶æ¯éåæå¡å¨ï¼çäº§èçäº§æ¶æ¯å° Broker ï¼æ¶è´¹èä» Broker æåæ¶æ¯å¹¶æ¶è´¹ã\n   * Broker ãTopic å éåçå³ç³»ãä¸é¢æè®²è§£äº Topic åéåçå³ç³»ââä¸ä¸ª Topic ä¸­å­å¨å¤ä¸ªéåï¼é£ä¹è¿ä¸ª Topic åéåå­æ¾å¨åªå¢ï¼\n   * ä¸ä¸ª Topic åå¸å¨å¤ä¸ª Brokerä¸ï¼ä¸ä¸ª Broker å¯ä»¥éç½®å¤ä¸ª Topic ï¼å®ä»¬æ¯å¤å¯¹å¤çå³ç³»ã\n   * å¦ææä¸ª Topic æ¶æ¯éå¾å¤§ï¼åºè¯¥ç»å®å¤éç½®å ä¸ªéå(ä¸æä¸­æå°äºæé«å¹¶åè½å)ï¼å¹¶ä¸ å°½éå¤åå¸å¨ä¸å Broker ä¸ï¼ä»¥åè½»æä¸ª Broker çåå ã\n\n\n\n\n\nç¬¬ä¸ãæä»¬ç Broker åäºéç¾¤å¹¶ä¸è¿è¿è¡äºä¸»ä»é¨ç½² ï¼ç±äºæ¶æ¯åå¸å¨åä¸ª Broker ä¸ï¼ä¸æ¦æä¸ª Broker å®æºï¼åè¯¥Broker ä¸çæ¶æ¯è¯»åé½ä¼åå°å½±åãæä»¥ Rocketmq æä¾äº master/slave çç»æï¼salve å®æ¶ä» master åæ­¥æ°æ®(åæ­¥å·çæèå¼æ­¥å·ç)ï¼å¦æ master å®æºï¼å slave æä¾æ¶è´¹æå¡ï¼ä½æ¯ä¸è½åå¥æ¶æ¯ (åé¢æè¿ä¼æå°å¦)ã\n\nç¬¬äºãä¸ºäºä¿è¯ HA ï¼æä»¬ç NameServer ä¹åäºéç¾¤é¨ç½²ï¼ä½æ¯è¯·æ³¨æå®æ¯ å»ä¸­å¿å çãä¹å°±æå³çå®æ²¡æä¸»èç¹ï¼ä½ å¯ä»¥å¾ææ¾å°çåº NameServer çææèç¹æ¯æ²¡æè¿è¡ Info Replicate çï¼å¨ RocketMQ ä¸­æ¯éè¿ åä¸ªBrokeråææNameServerä¿æé¿è¿æ¥ ï¼å¹¶ä¸å¨æ¯é30ç§ Broker ä¼åææ Nameserver åéå¿è·³ï¼å¿è·³åå«äºèªèº«ç Topic éç½®ä¿¡æ¯ï¼è¿ä¸ªæ­¥éª¤å°±å¯¹åºè¿ä¸é¢ç Routing Info ã\n\nç¬¬ä¸ãå¨çäº§èéè¦å Broker åéæ¶æ¯çæ¶åï¼éè¦åä» NameServer è·åå³äº Broker çè·¯ç±ä¿¡æ¯ï¼ç¶åéè¿ è½®è¯¢ çæ¹æ³å»åæ¯ä¸ªéåä¸­çäº§æ°æ®ä»¥è¾¾å° è´è½½åè¡¡ çææã\n\nç¬¬åãæ¶è´¹èéè¿ NameServer è·åææ Broker çè·¯ç±ä¿¡æ¯åï¼å Broker åé Pull è¯·æ±æ¥è·åæ¶æ¯æ°æ®ãConsumer å¯ä»¥ä»¥ä¸¤ç§æ¨¡å¼å¯å¨ââ å¹¿æ­ï¼Broadcastï¼åéç¾¤ï¼Clusterï¼ãå¹¿æ­æ¨¡å¼ä¸ï¼ä¸æ¡æ¶æ¯ä¼åéç» åä¸ä¸ªæ¶è´¹ç»ä¸­çæææ¶è´¹è ï¼éç¾¤æ¨¡å¼ä¸æ¶æ¯åªä¼åéç»ä¸ä¸ªæ¶è´¹èã\n\n\n# éå¤æ¶è´¹é®é¢\n\nè§£å³æ¹æ¡ï¼ä¿è¯æ¶è´¹å¹ç­ ãå¨ç¼ç¨ä¸­ä¸ä¸ªå¹ç­æä½çç¹ç¹æ¯å¶ä»»æå¤æ¬¡æ§è¡æäº§ççå½±ååä¸ä¸æ¬¡æ§è¡çå½±åç¸åã\n\næä»¥æä»¬éè¦ç»æä»¬çæ¶è´¹èå®ç° å¹ç­ ï¼ä¹å°±æ¯å¯¹åä¸ä¸ªæ¶æ¯çå¤çç»æï¼æ§è¡å¤å°æ¬¡é½ä¸åã\n\né£ä¹å¦ä½ç»ä¸å¡å®ç°å¹ç­å¢ï¼è¿ä¸ªè¿æ¯éè¦ç»åå·ä½çä¸å¡çãä½ å¯ä»¥ä½¿ç¨ åå¥ Redis æ¥ä¿è¯ï¼å ä¸º Redis ç key å value å°±æ¯å¤©ç¶æ¯æå¹ç­çãå½ç¶è¿æä½¿ç¨ æ°æ®åºæå¥æ³ ï¼åºäºæ°æ®åºçå¯ä¸é®æ¥ä¿è¯éå¤æ°æ®ä¸ä¼è¢«æå¥å¤æ¡ã\n\nä¸è¿æä¸»è¦çè¿æ¯éè¦ æ ¹æ®ç¹å®åºæ¯ä½¿ç¨ç¹å®çè§£å³æ¹æ¡ ï¼ä½ è¦ç¥éä½ çæ¶æ¯æ¶è´¹æ¯å¦æ¯å®å¨ä¸å¯éå¤æ¶è´¹è¿æ¯å¯ä»¥å¿åéå¤æ¶è´¹çï¼ç¶ååéæ©å¼ºæ ¡éªåå¼±æ ¡éªçæ¹å¼ãæ¯ç«å¨ CS é¢åè¿æ¯å¾å°æææ¯é¶å¼¹çè¯´æ³ã\n\nèå¨æ´ä¸ªäºèç½é¢åï¼å¹ç­ä¸ä»ä»éç¨äºæ¶æ¯éåçéå¤æ¶è´¹é®é¢ï¼è¿äºå®ç°å¹ç­çæ¹æ³ï¼ä¹åæ ·éç¨äºï¼å¨å¶ä»åºæ¯ä¸­æ¥è§£å³éå¤è¯·æ±æèéå¤è°ç¨çé®é¢ ãæ¯å¦å°HTTPæå¡è®¾è®¡æå¹ç­çï¼è§£å³åç«¯æèAPPéå¤æäº¤è¡¨åæ°æ®çé®é¢ ï¼ä¹å¯ä»¥å°ä¸ä¸ªå¾®æå¡è®¾è®¡æå¹ç­çï¼è§£å³ RPC æ¡æ¶èªå¨éè¯å¯¼è´ç éå¤è°ç¨é®é¢ ã\n\n\n# å®ç°é¡ºåºæ¶è´¹\n\nRocketMQ å¨ä¸»é¢ä¸æ¯æ åºçãå®åªæå¨éåå±é¢ææ¯ä¿è¯æåº çã\n\næ¡ä¾ï¼å¨ Producer çäº§æ¶æ¯çæ¶åä¼è¿è¡è½®è¯¢(åå³ä½ çè´è½½åè¡¡ç­ç¥)æ¥ååä¸ä¸»é¢çä¸åæ¶æ¯éååéæ¶æ¯ãå¦ææ­¤æ¶ææå ä¸ªæ¶æ¯åå«æ¯åä¸ä¸ªè®¢åçåå»ºãæ¯ä»ãåè´§ï¼å¨è½®è¯¢çç­ç¥ä¸è¿ ä¸ä¸ªæ¶æ¯ä¼è¢«åéå°ä¸åéå ï¼å ä¸ºå¨ä¸åçéåæ­¤æ¶å°±æ æ³ä½¿ç¨ RocketMQ å¸¦æ¥çéåæåºç¹æ§æ¥ä¿è¯æ¶æ¯æåºæ§äºã\n\nè§£å³æ¹æ¡ï¼å°åä¸è¯­ä¹ä¸çæ¶æ¯æ¾å¥åä¸ä¸ªéå(æ¯å¦è¿éæ¯åä¸ä¸ªè®¢å)ï¼é£æä»¬å°±å¯ä»¥ä½¿ç¨ Hashåæ¨¡æ³ æ¥ä¿è¯åä¸ä¸ªè®¢åå¨åä¸ä¸ªéåä¸­ã\n\n\n# æ¶æ¯å ç§¯é®é¢\n\näº§çæ¶æ¯å ç§¯çæ ¹æºå¶å®å°±åªæä¸¤ä¸ªï¼çäº§èçäº§å¤ªå¿«æèæ¶è´¹èæ¶è´¹å¤ªæ¢ã\n\nå¦æå½æµéå°å³°å¼çæ¶åæ¯å ä¸ºçäº§èçäº§å¤ªå¿«ï¼æä»¬å¯ä»¥ä½¿ç¨ä¸äº éæµéçº§ çæ¹æ³ï¼å½ç¶ä½ ä¹å¯ä»¥å¢å å¤ä¸ªæ¶è´¹èå®ä¾å»æ°´å¹³æ©å±å¢å æ¶è´¹è½åæ¥å¹éçäº§çæ¿å¢ã\n\nå¦ææ¶è´¹èæ¶è´¹è¿æ¢çè¯ï¼æä»¬å¯ä»¥åæ£æ¥ æ¯å¦æ¯æ¶è´¹èåºç°äºå¤§éçæ¶è´¹éè¯¯ ï¼æèæå°ä¸ä¸æ¥å¿æ¥çæ¯å¦æ¯åªä¸ä¸ªçº¿ç¨å¡æ­»ï¼åºç°äºéèµæºä¸éæ¾ç­ç­çé®é¢ã\n\nå½ç¶ï¼æå¿«éè§£å³æ¶æ¯å ç§¯é®é¢çæ¹æ³è¿æ¯å¢å æ¶è´¹èå®ä¾ï¼ä¸è¿ åæ¶ä½ è¿éè¦å¢å æ¯ä¸ªä¸»é¢çéåæ°é ãå«å¿äºå¨ RocketMQ ä¸­ï¼ä¸ä¸ªéååªä¼è¢«ä¸ä¸ªæ¶è´¹èæ¶è´¹ ã\n\n\n# åæº¯æ¶è´¹\n\nåæº¯æ¶è´¹æ¯æ Consumer å·²ç»æ¶è´¹æåçæ¶æ¯ï¼ç±äºä¸å¡ä¸éæ±éè¦éæ°æ¶è´¹ï¼å¨RocketMQ ä¸­ï¼ Broker å¨åConsumer æéæåæ¶æ¯åï¼æ¶æ¯ä»ç¶éè¦ä¿ç ãå¹¶ä¸éæ°æ¶è´¹ä¸è¬æ¯æç§æ¶é´ç»´åº¦ï¼ä¾å¦ç±äº Consumer ç³»ç»æéï¼æ¢å¤åéè¦éæ°æ¶è´¹1å°æ¶åçæ°æ®ï¼é£ä¹ Broker è¦æä¾ä¸ç§æºå¶ï¼å¯ä»¥æç§æ¶é´ç»´åº¦æ¥åéæ¶è´¹è¿åº¦ãRocketMQ æ¯ææç§æ¶é´åæº¯æ¶è´¹ï¼æ¶é´ç»´åº¦ç²¾ç¡®å°æ¯«ç§ã\n\n\n# åå¸å¼äºå¡\n\nå¨åä¸ä¸ªç³»ç»ä¸­æä»¬å¯ä»¥è½»æ¾å°å®ç°äºå¡ï¼ä½æ¯å¨åå¸å¼æ¶æä¸­ï¼æä»¬æå¾å¤æå¡æ¯é¨ç½²å¨ä¸åç³»ç»ä¹é´çï¼èä¸åæå¡ä¹é´åéè¦è¿è¡è°ç¨ãæ¯å¦æ­¤æ¶æä¸è®¢åç¶åå¢å ç§¯åï¼å¦æä¿è¯ä¸äºåå¸å¼äºå¡çè¯ï¼å°±ä¼åºç°Aç³»ç»ä¸äºè®¢åï¼ä½æ¯Bç³»ç»å¢å ç§¯åå¤±è´¥æèAç³»ç»æ²¡æä¸è®¢åï¼Bç³»ç»å´å¢å äºç§¯åã\n\nå¦ä»æ¯è¾å¸¸è§çåå¸å¼äºå¡å®ç°æ 2PCãTCC åäºå¡æ¶æ¯(half åæ¶æ¯æºå¶)ãæ¯ä¸ç§å®ç°é½æå¶ç¹å®çä½¿ç¨åºæ¯ï¼ä½æ¯ä¹æåèªçé®é¢ï¼é½ä¸æ¯å®ç¾çè§£å³æ¹æ¡ã\n\nå¨ RocketMQ ä¸­ä½¿ç¨çæ¯ äºå¡æ¶æ¯å ä¸äºå¡åæ¥æºå¶ æ¥è§£å³åå¸å¼äºå¡é®é¢çã\n\n\n\nå¨ç¬¬ä¸æ­¥åéç half æ¶æ¯ ï¼å®çæææ¯ å¨äºå¡æäº¤ä¹åï¼å¯¹äºæ¶è´¹èæ¥è¯´ï¼è¿ä¸ªæ¶æ¯æ¯ä¸å¯è§ç ã\n\nå¦ä½åå°åå¥æ¶æ¯ä½æ¯å¯¹ç¨æ·ä¸å¯è§å¢ï¼RocketMQäºå¡æ¶æ¯çåæ³æ¯ï¼å¦ææ¶æ¯æ¯halfæ¶æ¯ï¼å°å¤ä»½åæ¶æ¯çä¸»é¢ä¸æ¶æ¯æ¶è´¹éåï¼ç¶å æ¹åä¸»é¢ ä¸ºRMQ_SYS_TRANS_HALF_TOPICãç±äºæ¶è´¹ç»æªè®¢éè¯¥ä¸»é¢ï¼ææ¶è´¹ç«¯æ æ³æ¶è´¹halfç±»åçæ¶æ¯ï¼ç¶åRocketMQä¼å¼å¯ä¸ä¸ªå®æ¶ä»»å¡ï¼ä»Topicä¸ºRMQ_SYS_TRANS_HALF_TOPICä¸­æåæ¶æ¯è¿è¡æ¶è´¹ï¼æ ¹æ®çäº§èç»è·åä¸ä¸ªæå¡æä¾èåéåæ¥äºå¡ç¶æè¯·æ±ï¼æ ¹æ®äºå¡ç¶ææ¥å³å®æ¯æäº¤æåæ»æ¶æ¯ã\n\nå¦ææ²¡æä»ç¬¬5æ­¥å¼å§ç äºå¡åæ¥æºå¶ ï¼å¦æåºç°ç½è·¯æ³¢å¨ç¬¬4æ­¥æ²¡æåéæåï¼è¿æ ·å°±ä¼äº§ç MQ ä¸ç¥éæ¯ä¸æ¯éè¦ç»æ¶è´¹èæ¶è´¹çé®é¢ï¼ä»å°±åä¸ä¸ªæ å¤´èèä¸æ ·ãå¨ RocketMQ ä¸­å°±æ¯ä½¿ç¨çä¸è¿°çäºå¡åæ¥æ¥è§£å³çï¼èå¨ Kafka ä¸­éå¸¸æ¯ç´æ¥æåºä¸ä¸ªå¼å¸¸è®©ç¨æ·æ¥èªè¡è§£å³ã\n\nä½ è¿éè¦æ³¨æçæ¯ï¼å¨ MQ Server æåç³»ç»Bçæä½å·²ç»åç³»ç»Aä¸ç¸å³äºï¼ä¹å°±æ¯è¯´å¨æ¶æ¯éåä¸­çåå¸å¼äºå¡æ¯ââæ¬å°äºå¡åå­å¨æ¶æ¯å°æ¶æ¯éåææ¯åä¸ä¸ªäºå¡ãè¿æ ·ä¹å°±äº§çäºäºå¡çæç»ä¸è´æ§ï¼å ä¸ºæ´ä¸ªè¿ç¨æ¯å¼æ­¥çï¼æ¯ä¸ªç³»ç»åªè¦ä¿è¯å®èªå·±é£ä¸é¨åçäºå¡å°±è¡äºã\n\n\n# RocketMQ çå·çæºå¶\n\n\n# åæ­¥å·çåå¼æ­¥å·ç\n\n\n\n\n# å­å¨æºå¶\n\nå¨ Topic ä¸­ç éåæ¯ä»¥ä»ä¹æ ·çå½¢å¼å­å¨çï¼\n\néåä¸­çæ¶æ¯åæ¯å¦ä½è¿è¡å­å¨æä¹åçå¢ï¼\n\nRocketMQ æ¶æ¯å­å¨æ¶æä¸­çä¸å¤§è§è²ââCommitLog ãConsumeQueue å IndexFile ã\n\n * CommitLogï¼ æ¶æ¯ä¸»ä½ä»¥ååæ°æ®çå­å¨ä¸»ä½ï¼å­å¨ Producer ç«¯åå¥çæ¶æ¯ä¸»ä½åå®¹,æ¶æ¯åå®¹ä¸æ¯å®é¿çãåä¸ªæä»¶å¤§å°é»è®¤1G ï¼æä»¶åé¿åº¦ä¸º20ä½ï¼å·¦è¾¹è¡¥é¶ï¼å©ä½ä¸ºèµ·å§åç§»éï¼æ¯å¦00000000000000000000ä»£è¡¨äºç¬¬ä¸ä¸ªæä»¶ï¼èµ·å§åç§»éä¸º0ï¼æä»¶å¤§å°ä¸º1G=1073741824ï¼å½ç¬¬ä¸ä¸ªæä»¶åæ»¡äºï¼ç¬¬äºä¸ªæä»¶ä¸º00000000001073741824ï¼èµ·å§åç§»éä¸º1073741824ï¼ä»¥æ­¤ç±»æ¨ãæ¶æ¯ä¸»è¦æ¯é¡ºåºåå¥æ¥å¿æä»¶ï¼å½æä»¶æ»¡äºï¼åå¥ä¸ä¸ä¸ªæä»¶ã\n * ConsumeQueueï¼ æ¶æ¯æ¶è´¹éåï¼å¼å¥çç®çä¸»è¦æ¯æé«æ¶æ¯æ¶è´¹çæ§è½(æä»¬ååé¢ä¹è®²äº)ï¼ç±äºRocketMQ æ¯åºäºä¸»é¢ Topic çè®¢éæ¨¡å¼ï¼æ¶æ¯æ¶è´¹æ¯éå¯¹ä¸»é¢è¿è¡çï¼å¦æè¦éå commitlog æä»¶ä¸­æ ¹æ® Topic æ£ç´¢æ¶æ¯æ¯éå¸¸ä½æçãConsumer å³å¯æ ¹æ® ConsumeQueue æ¥æ¥æ¾å¾æ¶è´¹çæ¶æ¯ãå¶ä¸­ï¼ConsumeQueueï¼é»è¾æ¶è´¹éåï¼ä½ä¸ºæ¶è´¹æ¶æ¯çç´¢å¼ï¼ä¿å­äºæå® Topic ä¸çéåæ¶æ¯å¨ CommitLog ä¸­çèµ·å§ç©çåç§»é offset *ï¼æ¶æ¯å¤§å° size åæ¶æ¯ Tag ç HashCode å¼ã*consumequeue æä»¶å¯ä»¥çææ¯åºäº topic ç commitlog ç´¢å¼æä»¶ï¼æ consumequeue æä»¶å¤¹çç»ç»æ¹å¼å¦ä¸ï¼topic/queue/fileä¸å±ç»ç»ç»æï¼å·ä½å­å¨è·¯å¾ä¸ºï¼$HOME/store/consumequeue/{topic}/{queueId}/{fileName}ãåæ · consumequeue æä»¶éåå®é¿è®¾è®¡ï¼æ¯ä¸ä¸ªæ¡ç®å±20ä¸ªå­èï¼åå«ä¸º8å­èç commitlog ç©çåç§»éã4å­èçæ¶æ¯é¿åº¦ã8å­ètag hashcodeï¼åä¸ªæä»¶ç±30Wä¸ªæ¡ç®ç»æï¼å¯ä»¥åæ°ç»ä¸æ ·éæºè®¿é®æ¯ä¸ä¸ªæ¡ç®ï¼æ¯ä¸ª ConsumeQueueæä»¶å¤§å°çº¦5.72Mï¼\n * IndexFileï¼ IndexFileï¼ç´¢å¼æä»¶ï¼æä¾äºä¸ç§å¯ä»¥éè¿keyææ¶é´åºé´æ¥æ¥è¯¢æ¶æ¯çæ¹æ³ãè¿éåªåç§æ®ä¸åè¯¦ç»ä»ç»ã\n\næ»ç»æ¥è¯´ï¼æ´ä¸ªæ¶æ¯å­å¨çç»æï¼æä¸»è¦çå°±æ¯ CommitLoq å ConsumeQueue ãè ConsumeQueue ä½ å¯ä»¥å¤§æ¦çè§£ä¸º Topic ä¸­çéåã\n\n\n\nçº¢è²æ¹åä»£è¡¨è¢«åå¥çæ¶æ¯ï¼èçº¿æ¹åä»£è¡¨ç­å¾è¢«åå¥çãå·¦è¾¹ççäº§èåéæ¶æ¯ä¼æå® Topic ãQueueId åå·ä½æ¶æ¯åå®¹ï¼èå¨ Broker ä¸­ç®¡ä½ æ¯åªé¨å­æ¶æ¯ï¼ä»ç´æ¥ å¨é¨é¡ºåºå­å¨å°äº CommitLogãèæ ¹æ®çäº§èæå®ç Topic å QueueId å°è¿æ¡æ¶æ¯æ¬èº«å¨ CommitLog çåç§»(offset)ï¼æ¶æ¯æ¬èº«å¤§å°ï¼åtagçhashå¼å­å¥å¯¹åºç ConsumeQueue ç´¢å¼æä»¶ä¸­ãèå¨æ¯ä¸ªéåä¸­é½ä¿å­äº ConsumeOffset å³æ¯ä¸ªæ¶è´¹èç»çæ¶è´¹ä½ç½®(æå¨æ¶æé£éæå°äºï¼å¿äºçåå­¦å¯ä»¥åå»çä¸ä¸)ï¼èæ¶è´¹èæåæ¶æ¯è¿è¡æ¶è´¹çæ¶ååªéè¦æ ¹æ® ConsumeOffset è·åä¸ä¸ä¸ªæªè¢«æ¶è´¹çæ¶æ¯å°±è¡äºã",normalizedContent:"# rocketmqä¸­çæ¶æ¯æ¨¡å\n\nrocketmq ä¸­çæ¶æ¯æ¨¡åå°±æ¯æç§ ä¸»é¢æ¨¡åï¼åå¸è®¢éæ¨¡å¼ï¼ æå®ç°çã\n\nå¶å®å¯¹äºä¸»é¢æ¨¡åçå®ç°æ¥è¯´æ¯ä¸ªæ¶æ¯ä¸­é´ä»¶çåºå±è®¾è®¡é½æ¯ä¸ä¸æ ·çï¼å°±æ¯å¦ kafka ä¸­ç ååº ï¼rocketmq ä¸­ç éå ï¼rabbitmq ä¸­ç exchange ãæä»¬å¯ä»¥çè§£ä¸º ä¸»é¢æ¨¡å/åå¸è®¢éæ¨¡å å°±æ¯ä¸ä¸ªæ åï¼é£äºä¸­é´ä»¶åªä¸è¿ç§çè¿ä¸ªæ åå»å®ç°èå·²ã\n\n\n\nçäº§èç»ä¸­ççäº§èä¼åä¸»é¢åéæ¶æ¯ï¼è ä¸»é¢ä¸­å­å¨å¤ä¸ªéåï¼çäº§èæ¯æ¬¡çäº§æ¶æ¯ä¹åæ¯æå®ä¸»é¢ä¸­çæä¸ªéååéæ¶æ¯çã\n\næ¯ä¸ªä¸»é¢ä¸­é½æå¤ä¸ªéå(åå¸å¨ä¸åç brokerä¸­ï¼å¦ææ¯éç¾¤çè¯ï¼brokerååå¸å¨ä¸åçæå¡å¨ä¸­)ï¼éç¾¤æ¶è´¹æ¨¡å¼ä¸ï¼ä¸ä¸ªæ¶è´¹èéç¾¤å¤å°æºå¨å±åæ¶è´¹ä¸ä¸ª topic çå¤ä¸ªéåï¼ä¸ä¸ªéååªä¼è¢«ä¸ä¸ªæ¶è´¹èæ¶è´¹ãå¦ææä¸ªæ¶è´¹èææï¼åç»åå¶å®æ¶è´¹èä¼æ¥æ¿ææçæ¶è´¹èç»§ç»­æ¶è´¹ãå°±åä¸å¾ä¸­ consumer1 å consumer2 åå«å¯¹åºçä¸¤ä¸ªéåï¼è consumer3 æ¯æ²¡æéåå¯¹åºçï¼æä»¥ä¸è¬æ¥è®²è¦æ§å¶ æ¶è´¹èç»ä¸­çæ¶è´¹èä¸ªæ°åä¸»é¢ä¸­éåä¸ªæ°ç¸å ã\n\n\næ¯ä¸ªæ¶è´¹ç»å¨æ¯ä¸ªéåä¸ç»´æ¤ä¸ä¸ªæ¶è´¹ä½ç½® ï¼ä¸ºä»ä¹å¢ï¼\n\nå ä¸ºæä»¬ååç»çä»ä»æ¯ä¸ä¸ªæ¶è´¹èç»ï¼æä»¬ç¥éå¨åå¸è®¢éæ¨¡å¼ä¸­ä¸è¬ä¼æ¶åå°å¤ä¸ªæ¶è´¹èç»ï¼èæ¯ä¸ªæ¶è´¹èç»å¨æ¯ä¸ªéåä¸­çæ¶è´¹ä½ç½®é½æ¯ä¸åçãå¦ææ­¤æ¶æå¤ä¸ªæ¶è´¹èç»ï¼é£ä¹æ¶æ¯è¢«ä¸ä¸ªæ¶è´¹èç»æ¶è´¹å®ä¹åæ¯ä¸ä¼å é¤ç(å ä¸ºå¶å®æ¶è´¹èç»ä¹éè¦å)ï¼å®ä»ä»æ¯ä¸ºæ¯ä¸ªæ¶è´¹èç»ç»´æ¤ä¸ä¸ª æ¶è´¹ä½ç§»(offset) ï¼æ¯æ¬¡æ¶è´¹èç»æ¶è´¹å®ä¼è¿åä¸ä¸ªæåçååºï¼ç¶åéååæç»´æ¤çæ¶è´¹ä½ç§»å ä¸ï¼è¿æ ·å°±ä¸ä¼åºç°ååæ¶è´¹è¿çæ¶æ¯åä¸æ¬¡è¢«æ¶è´¹äºã\n\n\n\n\nä¸ºä»ä¹ä¸ä¸ªä¸»é¢ä¸­éè¦ç»´æ¤å¤ä¸ªéå ï¼\n\nä¸ºäº æé«å¹¶åè½å ãçç¡®ï¼æ¯ä¸ªä¸»é¢ä¸­åªå­å¨ä¸ä¸ªéåä¹æ¯å¯è¡çãä½æ¯ï¼è¿æ ·çäº§èæ¯ä¸æ¯åªè½åä¸ä¸ªéååéæ¶æ¯ï¼åå ä¸ºéè¦ç»´æ¤æ¶è´¹ä½ç½®æä»¥ä¸ä¸ªéååªè½å¯¹åºä¸ä¸ªæ¶è´¹èç»ä¸­çæ¶è´¹èï¼è¿æ ·æ¯ä¸æ¯å¶ä»ç consumer å°±æ²¡æç¨æ­¦ä¹å°äºï¼ä»è¿ä¸¤ä¸ªè§åº¦æ¥è®²ï¼å¹¶ååº¦ä¸ä¸å­å°±å°äºå¾å¤ã\n\næä»¥æ»ç»æ¥è¯´ï¼rocketmq éè¿ä½¿ç¨å¨ä¸ä¸ª topic ä¸­éç½®å¤ä¸ªéåå¹¶ä¸æ¯ä¸ªéåç»´æ¤æ¯ä¸ªæ¶è´¹èç»çæ¶è´¹ä½ç½® å®ç°äº ä¸»é¢æ¨¡å¼/åå¸è®¢éæ¨¡å¼ ã\n\n\n# rocketmqçæ¶æ\n\n\n\n * nameserverï¼ è· zookeeper å spring cloud ä¸­ç eureka ï¼ä¸æ ·æ¯ä¸ä¸ª æ³¨åä¸­å¿ ï¼ä¸»è¦æä¾ä¸¤ä¸ªåè½ï¼brokerç®¡ç å è·¯ç±ä¿¡æ¯ç®¡ç ãè¯´ç½äºå°±æ¯ broker ä¼å°èªå·±çä¿¡æ¯æ³¨åå° nameserver ä¸­ï¼æ­¤æ¶ nameserver å°±å­æ¾äºå¾å¤ broker çä¿¡æ¯(brokerçè·¯ç±è¡¨)ï¼æ¶è´¹èåçäº§èå°±ä» nameserver ä¸­è·åè·¯ç±è¡¨ç¶åç§çè·¯ç±è¡¨çä¿¡æ¯åå¯¹åºç broker è¿è¡éä¿¡(çäº§èåæ¶è´¹èå®æä¼å nameserver å»æ¥è¯¢ç¸å³ç broker çä¿¡æ¯)ã\n * producerï¼ æ¶æ¯åå¸çè§è²ï¼æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ã\n * consumerï¼ æ¶æ¯æ¶è´¹çè§è²ï¼æ¯æåå¸å¼éç¾¤æ¹å¼é¨ç½²ãæ¯æä»¥pushæ¨ï¼pullæä¸¤ç§æ¨¡å¼å¯¹æ¶æ¯è¿è¡æ¶è´¹ãåæ¶ä¹æ¯æéç¾¤æ¹å¼åå¹¿æ­æ¹å¼çæ¶è´¹ï¼å®æä¾å®æ¶æ¶æ¯è®¢éæºå¶ã\n * brokerï¼ ä¸»è¦è´è´£æ¶æ¯çå­å¨ãæéåæ¥è¯¢ä»¥åæå¡é«å¯ç¨ä¿è¯ãå°±æ¯æ¶æ¯éåæå¡å¨ï¼çäº§èçäº§æ¶æ¯å° broker ï¼æ¶è´¹èä» broker æåæ¶æ¯å¹¶æ¶è´¹ã\n   * broker ãtopic å éåçå³ç³»ãä¸é¢æè®²è§£äº topic åéåçå³ç³»ââä¸ä¸ª topic ä¸­å­å¨å¤ä¸ªéåï¼é£ä¹è¿ä¸ª topic åéåå­æ¾å¨åªå¢ï¼\n   * ä¸ä¸ª topic åå¸å¨å¤ä¸ª brokerä¸ï¼ä¸ä¸ª broker å¯ä»¥éç½®å¤ä¸ª topic ï¼å®ä»¬æ¯å¤å¯¹å¤çå³ç³»ã\n   * å¦ææä¸ª topic æ¶æ¯éå¾å¤§ï¼åºè¯¥ç»å®å¤éç½®å ä¸ªéå(ä¸æä¸­æå°äºæé«å¹¶åè½å)ï¼å¹¶ä¸ å°½éå¤åå¸å¨ä¸å broker ä¸ï¼ä»¥åè½»æä¸ª broker çåå ã\n\n\n\n\n\nç¬¬ä¸ãæä»¬ç broker åäºéç¾¤å¹¶ä¸è¿è¿è¡äºä¸»ä»é¨ç½² ï¼ç±äºæ¶æ¯åå¸å¨åä¸ª broker ä¸ï¼ä¸æ¦æä¸ª broker å®æºï¼åè¯¥broker ä¸çæ¶æ¯è¯»åé½ä¼åå°å½±åãæä»¥ rocketmq æä¾äº master/slave çç»æï¼salve å®æ¶ä» master åæ­¥æ°æ®(åæ­¥å·çæèå¼æ­¥å·ç)ï¼å¦æ master å®æºï¼å slave æä¾æ¶è´¹æå¡ï¼ä½æ¯ä¸è½åå¥æ¶æ¯ (åé¢æè¿ä¼æå°å¦)ã\n\nç¬¬äºãä¸ºäºä¿è¯ ha ï¼æä»¬ç nameserver ä¹åäºéç¾¤é¨ç½²ï¼ä½æ¯è¯·æ³¨æå®æ¯ å»ä¸­å¿å çãä¹å°±æå³çå®æ²¡æä¸»èç¹ï¼ä½ å¯ä»¥å¾ææ¾å°çåº nameserver çææèç¹æ¯æ²¡æè¿è¡ info replicate çï¼å¨ rocketmq ä¸­æ¯éè¿ åä¸ªbrokeråæænameserverä¿æé¿è¿æ¥ ï¼å¹¶ä¸å¨æ¯é30ç§ broker ä¼åææ nameserver åéå¿è·³ï¼å¿è·³åå«äºèªèº«ç topic éç½®ä¿¡æ¯ï¼è¿ä¸ªæ­¥éª¤å°±å¯¹åºè¿ä¸é¢ç routing info ã\n\nç¬¬ä¸ãå¨çäº§èéè¦å broker åéæ¶æ¯çæ¶åï¼éè¦åä» nameserver è·åå³äº broker çè·¯ç±ä¿¡æ¯ï¼ç¶åéè¿ è½®è¯¢ çæ¹æ³å»åæ¯ä¸ªéåä¸­çäº§æ°æ®ä»¥è¾¾å° è´è½½åè¡¡ çææã\n\nç¬¬åãæ¶è´¹èéè¿ nameserver è·åææ broker çè·¯ç±ä¿¡æ¯åï¼å broker åé pull è¯·æ±æ¥è·åæ¶æ¯æ°æ®ãconsumer å¯ä»¥ä»¥ä¸¤ç§æ¨¡å¼å¯å¨ââ å¹¿æ­ï¼broadcastï¼åéç¾¤ï¼clusterï¼ãå¹¿æ­æ¨¡å¼ä¸ï¼ä¸æ¡æ¶æ¯ä¼åéç» åä¸ä¸ªæ¶è´¹ç»ä¸­çæææ¶è´¹è ï¼éç¾¤æ¨¡å¼ä¸æ¶æ¯åªä¼åéç»ä¸ä¸ªæ¶è´¹èã\n\n\n# éå¤æ¶è´¹é®é¢\n\nè§£å³æ¹æ¡ï¼ä¿è¯æ¶è´¹å¹ç­ ãå¨ç¼ç¨ä¸­ä¸ä¸ªå¹ç­æä½çç¹ç¹æ¯å¶ä»»æå¤æ¬¡æ§è¡æäº§ççå½±ååä¸ä¸æ¬¡æ§è¡çå½±åç¸åã\n\næä»¥æä»¬éè¦ç»æä»¬çæ¶è´¹èå®ç° å¹ç­ ï¼ä¹å°±æ¯å¯¹åä¸ä¸ªæ¶æ¯çå¤çç»æï¼æ§è¡å¤å°æ¬¡é½ä¸åã\n\né£ä¹å¦ä½ç»ä¸å¡å®ç°å¹ç­å¢ï¼è¿ä¸ªè¿æ¯éè¦ç»åå·ä½çä¸å¡çãä½ å¯ä»¥ä½¿ç¨ åå¥ redis æ¥ä¿è¯ï¼å ä¸º redis ç key å value å°±æ¯å¤©ç¶æ¯æå¹ç­çãå½ç¶è¿æä½¿ç¨ æ°æ®åºæå¥æ³ ï¼åºäºæ°æ®åºçå¯ä¸é®æ¥ä¿è¯éå¤æ°æ®ä¸ä¼è¢«æå¥å¤æ¡ã\n\nä¸è¿æä¸»è¦çè¿æ¯éè¦ æ ¹æ®ç¹å®åºæ¯ä½¿ç¨ç¹å®çè§£å³æ¹æ¡ ï¼ä½ è¦ç¥éä½ çæ¶æ¯æ¶è´¹æ¯å¦æ¯å®å¨ä¸å¯éå¤æ¶è´¹è¿æ¯å¯ä»¥å¿åéå¤æ¶è´¹çï¼ç¶ååéæ©å¼ºæ ¡éªåå¼±æ ¡éªçæ¹å¼ãæ¯ç«å¨ cs é¢åè¿æ¯å¾å°æææ¯é¶å¼¹çè¯´æ³ã\n\nèå¨æ´ä¸ªäºèç½é¢åï¼å¹ç­ä¸ä»ä»éç¨äºæ¶æ¯éåçéå¤æ¶è´¹é®é¢ï¼è¿äºå®ç°å¹ç­çæ¹æ³ï¼ä¹åæ ·éç¨äºï¼å¨å¶ä»åºæ¯ä¸­æ¥è§£å³éå¤è¯·æ±æèéå¤è°ç¨çé®é¢ ãæ¯å¦å°httpæå¡è®¾è®¡æå¹ç­çï¼è§£å³åç«¯æèappéå¤æäº¤è¡¨åæ°æ®çé®é¢ ï¼ä¹å¯ä»¥å°ä¸ä¸ªå¾®æå¡è®¾è®¡æå¹ç­çï¼è§£å³ rpc æ¡æ¶èªå¨éè¯å¯¼è´ç éå¤è°ç¨é®é¢ ã\n\n\n# å®ç°é¡ºåºæ¶è´¹\n\nrocketmq å¨ä¸»é¢ä¸æ¯æ åºçãå®åªæå¨éåå±é¢ææ¯ä¿è¯æåº çã\n\næ¡ä¾ï¼å¨ producer çäº§æ¶æ¯çæ¶åä¼è¿è¡è½®è¯¢(åå³ä½ çè´è½½åè¡¡ç­ç¥)æ¥ååä¸ä¸»é¢çä¸åæ¶æ¯éååéæ¶æ¯ãå¦ææ­¤æ¶ææå ä¸ªæ¶æ¯åå«æ¯åä¸ä¸ªè®¢åçåå»ºãæ¯ä»ãåè´§ï¼å¨è½®è¯¢çç­ç¥ä¸è¿ ä¸ä¸ªæ¶æ¯ä¼è¢«åéå°ä¸åéå ï¼å ä¸ºå¨ä¸åçéåæ­¤æ¶å°±æ æ³ä½¿ç¨ rocketmq å¸¦æ¥çéåæåºç¹æ§æ¥ä¿è¯æ¶æ¯æåºæ§äºã\n\nè§£å³æ¹æ¡ï¼å°åä¸è¯­ä¹ä¸çæ¶æ¯æ¾å¥åä¸ä¸ªéå(æ¯å¦è¿éæ¯åä¸ä¸ªè®¢å)ï¼é£æä»¬å°±å¯ä»¥ä½¿ç¨ hashåæ¨¡æ³ æ¥ä¿è¯åä¸ä¸ªè®¢åå¨åä¸ä¸ªéåä¸­ã\n\n\n# æ¶æ¯å ç§¯é®é¢\n\näº§çæ¶æ¯å ç§¯çæ ¹æºå¶å®å°±åªæä¸¤ä¸ªï¼çäº§èçäº§å¤ªå¿«æèæ¶è´¹èæ¶è´¹å¤ªæ¢ã\n\nå¦æå½æµéå°å³°å¼çæ¶åæ¯å ä¸ºçäº§èçäº§å¤ªå¿«ï¼æä»¬å¯ä»¥ä½¿ç¨ä¸äº éæµéçº§ çæ¹æ³ï¼å½ç¶ä½ ä¹å¯ä»¥å¢å å¤ä¸ªæ¶è´¹èå®ä¾å»æ°´å¹³æ©å±å¢å æ¶è´¹è½åæ¥å¹éçäº§çæ¿å¢ã\n\nå¦ææ¶è´¹èæ¶è´¹è¿æ¢çè¯ï¼æä»¬å¯ä»¥åæ£æ¥ æ¯å¦æ¯æ¶è´¹èåºç°äºå¤§éçæ¶è´¹éè¯¯ ï¼æèæå°ä¸ä¸æ¥å¿æ¥çæ¯å¦æ¯åªä¸ä¸ªçº¿ç¨å¡æ­»ï¼åºç°äºéèµæºä¸éæ¾ç­ç­çé®é¢ã\n\nå½ç¶ï¼æå¿«éè§£å³æ¶æ¯å ç§¯é®é¢çæ¹æ³è¿æ¯å¢å æ¶è´¹èå®ä¾ï¼ä¸è¿ åæ¶ä½ è¿éè¦å¢å æ¯ä¸ªä¸»é¢çéåæ°é ãå«å¿äºå¨ rocketmq ä¸­ï¼ä¸ä¸ªéååªä¼è¢«ä¸ä¸ªæ¶è´¹èæ¶è´¹ ã\n\n\n# åæº¯æ¶è´¹\n\nåæº¯æ¶è´¹æ¯æ consumer å·²ç»æ¶è´¹æåçæ¶æ¯ï¼ç±äºä¸å¡ä¸éæ±éè¦éæ°æ¶è´¹ï¼å¨rocketmq ä¸­ï¼ broker å¨åconsumer æéæåæ¶æ¯åï¼æ¶æ¯ä»ç¶éè¦ä¿ç ãå¹¶ä¸éæ°æ¶è´¹ä¸è¬æ¯æç§æ¶é´ç»´åº¦ï¼ä¾å¦ç±äº consumer ç³»ç»æéï¼æ¢å¤åéè¦éæ°æ¶è´¹1å°æ¶åçæ°æ®ï¼é£ä¹ broker è¦æä¾ä¸ç§æºå¶ï¼å¯ä»¥æç§æ¶é´ç»´åº¦æ¥åéæ¶è´¹è¿åº¦ãrocketmq æ¯ææç§æ¶é´åæº¯æ¶è´¹ï¼æ¶é´ç»´åº¦ç²¾ç¡®å°æ¯«ç§ã\n\n\n# åå¸å¼äºå¡\n\nå¨åä¸ä¸ªç³»ç»ä¸­æä»¬å¯ä»¥è½»æ¾å°å®ç°äºå¡ï¼ä½æ¯å¨åå¸å¼æ¶æä¸­ï¼æä»¬æå¾å¤æå¡æ¯é¨ç½²å¨ä¸åç³»ç»ä¹é´çï¼èä¸åæå¡ä¹é´åéè¦è¿è¡è°ç¨ãæ¯å¦æ­¤æ¶æä¸è®¢åç¶åå¢å ç§¯åï¼å¦æä¿è¯ä¸äºåå¸å¼äºå¡çè¯ï¼å°±ä¼åºç°aç³»ç»ä¸äºè®¢åï¼ä½æ¯bç³»ç»å¢å ç§¯åå¤±è´¥æèaç³»ç»æ²¡æä¸è®¢åï¼bç³»ç»å´å¢å äºç§¯åã\n\nå¦ä»æ¯è¾å¸¸è§çåå¸å¼äºå¡å®ç°æ 2pcãtcc åäºå¡æ¶æ¯(half åæ¶æ¯æºå¶)ãæ¯ä¸ç§å®ç°é½æå¶ç¹å®çä½¿ç¨åºæ¯ï¼ä½æ¯ä¹æåèªçé®é¢ï¼é½ä¸æ¯å®ç¾çè§£å³æ¹æ¡ã\n\nå¨ rocketmq ä¸­ä½¿ç¨çæ¯ äºå¡æ¶æ¯å ä¸äºå¡åæ¥æºå¶ æ¥è§£å³åå¸å¼äºå¡é®é¢çã\n\n\n\nå¨ç¬¬ä¸æ­¥åéç half æ¶æ¯ ï¼å®çæææ¯ å¨äºå¡æäº¤ä¹åï¼å¯¹äºæ¶è´¹èæ¥è¯´ï¼è¿ä¸ªæ¶æ¯æ¯ä¸å¯è§ç ã\n\nå¦ä½åå°åå¥æ¶æ¯ä½æ¯å¯¹ç¨æ·ä¸å¯è§å¢ï¼rocketmqäºå¡æ¶æ¯çåæ³æ¯ï¼å¦ææ¶æ¯æ¯halfæ¶æ¯ï¼å°å¤ä»½åæ¶æ¯çä¸»é¢ä¸æ¶æ¯æ¶è´¹éåï¼ç¶å æ¹åä¸»é¢ ä¸ºrmq_sys_trans_half_topicãç±äºæ¶è´¹ç»æªè®¢éè¯¥ä¸»é¢ï¼ææ¶è´¹ç«¯æ æ³æ¶è´¹halfç±»åçæ¶æ¯ï¼ç¶årocketmqä¼å¼å¯ä¸ä¸ªå®æ¶ä»»å¡ï¼ä»topicä¸ºrmq_sys_trans_half_topicä¸­æåæ¶æ¯è¿è¡æ¶è´¹ï¼æ ¹æ®çäº§èç»è·åä¸ä¸ªæå¡æä¾èåéåæ¥äºå¡ç¶æè¯·æ±ï¼æ ¹æ®äºå¡ç¶ææ¥å³å®æ¯æäº¤æåæ»æ¶æ¯ã\n\nå¦ææ²¡æä»ç¬¬5æ­¥å¼å§ç äºå¡åæ¥æºå¶ ï¼å¦æåºç°ç½è·¯æ³¢å¨ç¬¬4æ­¥æ²¡æåéæåï¼è¿æ ·å°±ä¼äº§ç mq ä¸ç¥éæ¯ä¸æ¯éè¦ç»æ¶è´¹èæ¶è´¹çé®é¢ï¼ä»å°±åä¸ä¸ªæ å¤´èèä¸æ ·ãå¨ rocketmq ä¸­å°±æ¯ä½¿ç¨çä¸è¿°çäºå¡åæ¥æ¥è§£å³çï¼èå¨ kafka ä¸­éå¸¸æ¯ç´æ¥æåºä¸ä¸ªå¼å¸¸è®©ç¨æ·æ¥èªè¡è§£å³ã\n\nä½ è¿éè¦æ³¨æçæ¯ï¼å¨ mq server æåç³»ç»bçæä½å·²ç»åç³»ç»aä¸ç¸å³äºï¼ä¹å°±æ¯è¯´å¨æ¶æ¯éåä¸­çåå¸å¼äºå¡æ¯ââæ¬å°äºå¡åå­å¨æ¶æ¯å°æ¶æ¯éåææ¯åä¸ä¸ªäºå¡ãè¿æ ·ä¹å°±äº§çäºäºå¡çæç»ä¸è´æ§ï¼å ä¸ºæ´ä¸ªè¿ç¨æ¯å¼æ­¥çï¼æ¯ä¸ªç³»ç»åªè¦ä¿è¯å®èªå·±é£ä¸é¨åçäºå¡å°±è¡äºã\n\n\n# rocketmq çå·çæºå¶\n\n\n# åæ­¥å·çåå¼æ­¥å·ç\n\n\n\n\n# å­å¨æºå¶\n\nå¨ topic ä¸­ç éåæ¯ä»¥ä»ä¹æ ·çå½¢å¼å­å¨çï¼\n\néåä¸­çæ¶æ¯åæ¯å¦ä½è¿è¡å­å¨æä¹åçå¢ï¼\n\nrocketmq æ¶æ¯å­å¨æ¶æä¸­çä¸å¤§è§è²ââcommitlog ãconsumequeue å indexfile ã\n\n * commitlogï¼ æ¶æ¯ä¸»ä½ä»¥ååæ°æ®çå­å¨ä¸»ä½ï¼å­å¨ producer ç«¯åå¥çæ¶æ¯ä¸»ä½åå®¹,æ¶æ¯åå®¹ä¸æ¯å®é¿çãåä¸ªæä»¶å¤§å°é»è®¤1g ï¼æä»¶åé¿åº¦ä¸º20ä½ï¼å·¦è¾¹è¡¥é¶ï¼å©ä½ä¸ºèµ·å§åç§»éï¼æ¯å¦00000000000000000000ä»£è¡¨äºç¬¬ä¸ä¸ªæä»¶ï¼èµ·å§åç§»éä¸º0ï¼æä»¶å¤§å°ä¸º1g=1073741824ï¼å½ç¬¬ä¸ä¸ªæä»¶åæ»¡äºï¼ç¬¬äºä¸ªæä»¶ä¸º00000000001073741824ï¼èµ·å§åç§»éä¸º1073741824ï¼ä»¥æ­¤ç±»æ¨ãæ¶æ¯ä¸»è¦æ¯é¡ºåºåå¥æ¥å¿æä»¶ï¼å½æä»¶æ»¡äºï¼åå¥ä¸ä¸ä¸ªæä»¶ã\n * consumequeueï¼ æ¶æ¯æ¶è´¹éåï¼å¼å¥çç®çä¸»è¦æ¯æé«æ¶æ¯æ¶è´¹çæ§è½(æä»¬ååé¢ä¹è®²äº)ï¼ç±äºrocketmq æ¯åºäºä¸»é¢ topic çè®¢éæ¨¡å¼ï¼æ¶æ¯æ¶è´¹æ¯éå¯¹ä¸»é¢è¿è¡çï¼å¦æè¦éå commitlog æä»¶ä¸­æ ¹æ® topic æ£ç´¢æ¶æ¯æ¯éå¸¸ä½æçãconsumer å³å¯æ ¹æ® consumequeue æ¥æ¥æ¾å¾æ¶è´¹çæ¶æ¯ãå¶ä¸­ï¼consumequeueï¼é»è¾æ¶è´¹éåï¼ä½ä¸ºæ¶è´¹æ¶æ¯çç´¢å¼ï¼ä¿å­äºæå® topic ä¸çéåæ¶æ¯å¨ commitlog ä¸­çèµ·å§ç©çåç§»é offset *ï¼æ¶æ¯å¤§å° size åæ¶æ¯ tag ç hashcode å¼ã*consumequeue æä»¶å¯ä»¥çææ¯åºäº topic ç commitlog ç´¢å¼æä»¶ï¼æ consumequeue æä»¶å¤¹çç»ç»æ¹å¼å¦ä¸ï¼topic/queue/fileä¸å±ç»ç»ç»æï¼å·ä½å­å¨è·¯å¾ä¸ºï¼$home/store/consumequeue/{topic}/{queueid}/{filename}ãåæ · consumequeue æä»¶éåå®é¿è®¾è®¡ï¼æ¯ä¸ä¸ªæ¡ç®å±20ä¸ªå­èï¼åå«ä¸º8å­èç commitlog ç©çåç§»éã4å­èçæ¶æ¯é¿åº¦ã8å­ètag hashcodeï¼åä¸ªæä»¶ç±30wä¸ªæ¡ç®ç»æï¼å¯ä»¥åæ°ç»ä¸æ ·éæºè®¿é®æ¯ä¸ä¸ªæ¡ç®ï¼æ¯ä¸ª consumequeueæä»¶å¤§å°çº¦5.72mï¼\n * indexfileï¼ indexfileï¼ç´¢å¼æä»¶ï¼æä¾äºä¸ç§å¯ä»¥éè¿keyææ¶é´åºé´æ¥æ¥è¯¢æ¶æ¯çæ¹æ³ãè¿éåªåç§æ®ä¸åè¯¦ç»ä»ç»ã\n\næ»ç»æ¥è¯´ï¼æ´ä¸ªæ¶æ¯å­å¨çç»æï¼æä¸»è¦çå°±æ¯ commitloq å consumequeue ãè consumequeue ä½ å¯ä»¥å¤§æ¦çè§£ä¸º topic ä¸­çéåã\n\n\n\nçº¢è²æ¹åä»£è¡¨è¢«åå¥çæ¶æ¯ï¼èçº¿æ¹åä»£è¡¨ç­å¾è¢«åå¥çãå·¦è¾¹ççäº§èåéæ¶æ¯ä¼æå® topic ãqueueid åå·ä½æ¶æ¯åå®¹ï¼èå¨ broker ä¸­ç®¡ä½ æ¯åªé¨å­æ¶æ¯ï¼ä»ç´æ¥ å¨é¨é¡ºåºå­å¨å°äº commitlogãèæ ¹æ®çäº§èæå®ç topic å queueid å°è¿æ¡æ¶æ¯æ¬èº«å¨ commitlog çåç§»(offset)ï¼æ¶æ¯æ¬èº«å¤§å°ï¼åtagçhashå¼å­å¥å¯¹åºç consumequeue ç´¢å¼æä»¶ä¸­ãèå¨æ¯ä¸ªéåä¸­é½ä¿å­äº consumeoffset å³æ¯ä¸ªæ¶è´¹èç»çæ¶è´¹ä½ç½®(æå¨æ¶æé£éæå°äºï¼å¿äºçåå­¦å¯ä»¥åå»çä¸ä¸)ï¼èæ¶è´¹èæåæ¶æ¯è¿è¡æ¶è´¹çæ¶ååªéè¦æ ¹æ® consumeoffset è·åä¸ä¸ä¸ªæªè¢«æ¶è´¹çæ¶æ¯å°±è¡äºã",charsets:{cjk:!0}},{title:"Flumeå¿«éä¸æ",frontmatter:{title:"Flumeå¿«éä¸æ",date:"2023-03-31T17:05:37.000Z",permalink:"/pages/0cf9ab/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/03.Flume%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B.html",relativePath:"10.ä¸­é´ä»¶/03.Flumeå¿«éä¸æ.md",key:"v-34c41a32",path:"/pages/0cf9ab/",headers:[{level:2,title:"ä»ä¹æ¯Flume",slug:"ä»ä¹æ¯flume",normalizedTitle:"ä»ä¹æ¯flume",charIndex:2},{level:2,title:"Demo",slug:"demo",normalizedTitle:"demo",charIndex:428},{level:3,title:"å®è£ï¼éå¯¹Linuxï¼",slug:"å®è£-éå¯¹linux",normalizedTitle:"å®è£ï¼éå¯¹linuxï¼",charIndex:437},{level:3,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:539},{level:2,title:"ç»ä»¶ç§ç±»",slug:"ç»ä»¶ç§ç±»",normalizedTitle:"ç»ä»¶ç§ç±»",charIndex:1409},{level:3,title:"source",slug:"source",normalizedTitle:"source",charIndex:627},{level:3,title:"channel",slug:"channel",normalizedTitle:"channel",charIndex:699},{level:3,title:"sink",slug:"sink",normalizedTitle:"sink",charIndex:672},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:1800}],headersStr:"ä»ä¹æ¯Flume Demo å®è£ï¼éå¯¹Linuxï¼ ä½¿ç¨ ç»ä»¶ç§ç±» source channel sink åè",content:"# ä»ä¹æ¯Flume\n\n> Flume is a distributed, reliable, and available service for efficiently collecting, aggregating, and moving large amounts of log data.\n\nFlume æ¯ä¸ç§åå¸å¼ãå¯é ä¸å¯ç¨çæå¡ï¼ç¨äºé«æå°æ¶éãèååç§»å¨å¤§éæ¥å¿æ°æ®ãç±æ­¤å¯è§ï¼flumeçåºç¨åºæ¯æ¯å¤çå¤§éçæ¥å¿æ°æ®ã\n\n\n\nå¶ä¸­æ¡æ¡é¨åå°±æ¯Flumeã\nç±SourceãChannelãSinkä¸ä¸ªæ ¸å¿ç»ä»¶ç»æãæ´ä½ææä¸ä¸ªAgentã\n\nåè¯è§£éï¼\n\n * Sourceï¼æ¯è´è´£æ¥åæ°æ®å°Agentçç»ä»¶ã\n * Channelï¼ä½äºSourceåSinkä¹é´çç¼å²åºã\n * Sinkï¼è´è´£å°äºä»¶ä»ä»Channelåå¥å°å¶ä»å°æ¹ãå¯ä»¥æ¯å¦ä¸ä¸ªAgentä¹å¯ä»¥æ¯å­å¨ç³»ç»ã\n * Eventï¼Flumeä»¥äºä»¶çå½¢å¼ä¼ éæ°æ®ã\n\n\n# Demo\n\n\n# å®è£ï¼éå¯¹Linuxï¼\n\n 1. å®ç½ä¸è½½ apache-flume-1.7.0-bin.tar.gz\n 2. è§£å tar -zxf apache-flume-1.7.0-bin.tar.gz\n\n\n# ä½¿ç¨\n\nä¸»è¦æ¯éç½®ä¸ä¸ªflumeçéç½®æä»¶ï¼è¿éèµ·åexample.confï¼è§å®ä»¥å¦ä¸å½¢å¼ï¼\n\n# Name the components on this agent\na1.sources = r1 //å®ä¹äºä¸ä¸ªagent a1ï¼r1ä¸ºa1çsource\na1.sinks = k1 //k1ä¸ºa1çsink\na1.channels = c1 //c1ä¸ºa1çchannel\n\n# Describe/configure the source\na1.sources.r1.type = netcat #source r1çç±»åä¸ºnetcat\na1.sources.r1.bind = localhost #source r1ç»å®çå°å\na1.sources.r1.port = 44444 #source r1ç»å®çç«¯å£\n\n# Describe the sink\na1.sinks.k1.type = logger #sink k1çç±»å\n\n# Use a channel which buffers events in memory\na1.channels.c1.type = memory #channel c1çç±»å\na1.channels.c1.capacity = 1000 #channel c1çå®¹é\na1.channels.c1.transactionCapacity = 100 #channel c1çäºå¡å®¹é\n\n# Bind the source and sink to the channel\na1.sources.r1.channels = c1 #source r1åchannel c1ç»å®\na1.sinks.k1.channel = c1 #sink k1åchannel c1ç»å®\n\n\nå¯å¨å½ä»¤ï¼\nbin/flume-ng agent --conf conf --conf-file example.conf --name a1 -Dflume.root.logger=INFO,console\n\n\n# ç»ä»¶ç§ç±»\n\nä»¥ä¸åä¸¾çæ¯å¸¸ç¨çç»ä»¶ç±»åï¼æç¨å°å¶ä»çç±»åå¯ä»¥éè¿å®ç½ç´æ¥ç´æ¥æç´¢ç±»åæ¥çè¯¦æ\n\n\n# source\n\n * avroï¼ç¨äºæ¥æ¶ä»å¦ä¸ä¸ªflumeï¼agentï¼ä¸­æ¶å°çæ°æ®\n * execï¼ç¨äºæ¥æ¶ä»å½ä»¤ä¸­è·åçæ°æ®ï¼å¦ç»åå½ä»¤tail -fä½¿ç¨\n * netcatï¼ç¨äºæ¥æ¶ç«¯å£ä¼ æ¥çæ°æ®\n * spooling directoryï¼ç¨äºæ¥æ¶æä»¶åå¨çæ°æ®\n\n\n# channel\n\n * memory channel åå­ï¼éåº¦å¿«ï¼ä½å®æºæ¶ææ°æ®ä¸¢å¤±çé£é©\n * file channel éåº¦æ¯è¾æ¢ï¼ä½å®å¨\n * kafka channel\n\n\n# sink\n\n * avro è¾åºå°å¦ä¸ä¸ªflumeï¼agentï¼\n * hdfs è¾åºå°hdfs\n * logger æ¥å¿å½¢å¼è¾åº\n * file æä»¶å½¢å¼è½å°\n\n> To be continue...\n\n\n# åè\n\n 1. Flumeå®ç½ç¨æ·ä½¿ç¨æå",normalizedContent:"# ä»ä¹æ¯flume\n\n> flume is a distributed, reliable, and available service for efficiently collecting, aggregating, and moving large amounts of log data.\n\nflume æ¯ä¸ç§åå¸å¼ãå¯é ä¸å¯ç¨çæå¡ï¼ç¨äºé«æå°æ¶éãèååç§»å¨å¤§éæ¥å¿æ°æ®ãç±æ­¤å¯è§ï¼flumeçåºç¨åºæ¯æ¯å¤çå¤§éçæ¥å¿æ°æ®ã\n\n\n\nå¶ä¸­æ¡æ¡é¨åå°±æ¯flumeã\nç±sourceãchannelãsinkä¸ä¸ªæ ¸å¿ç»ä»¶ç»æãæ´ä½ææä¸ä¸ªagentã\n\nåè¯è§£éï¼\n\n * sourceï¼æ¯è´è´£æ¥åæ°æ®å°agentçç»ä»¶ã\n * channelï¼ä½äºsourceåsinkä¹é´çç¼å²åºã\n * sinkï¼è´è´£å°äºä»¶ä»ä»channelåå¥å°å¶ä»å°æ¹ãå¯ä»¥æ¯å¦ä¸ä¸ªagentä¹å¯ä»¥æ¯å­å¨ç³»ç»ã\n * eventï¼flumeä»¥äºä»¶çå½¢å¼ä¼ éæ°æ®ã\n\n\n# demo\n\n\n# å®è£ï¼éå¯¹linuxï¼\n\n 1. å®ç½ä¸è½½ apache-flume-1.7.0-bin.tar.gz\n 2. è§£å tar -zxf apache-flume-1.7.0-bin.tar.gz\n\n\n# ä½¿ç¨\n\nä¸»è¦æ¯éç½®ä¸ä¸ªflumeçéç½®æä»¶ï¼è¿éèµ·åexample.confï¼è§å®ä»¥å¦ä¸å½¢å¼ï¼\n\n# name the components on this agent\na1.sources = r1 //å®ä¹äºä¸ä¸ªagent a1ï¼r1ä¸ºa1çsource\na1.sinks = k1 //k1ä¸ºa1çsink\na1.channels = c1 //c1ä¸ºa1çchannel\n\n# describe/configure the source\na1.sources.r1.type = netcat #source r1çç±»åä¸ºnetcat\na1.sources.r1.bind = localhost #source r1ç»å®çå°å\na1.sources.r1.port = 44444 #source r1ç»å®çç«¯å£\n\n# describe the sink\na1.sinks.k1.type = logger #sink k1çç±»å\n\n# use a channel which buffers events in memory\na1.channels.c1.type = memory #channel c1çç±»å\na1.channels.c1.capacity = 1000 #channel c1çå®¹é\na1.channels.c1.transactioncapacity = 100 #channel c1çäºå¡å®¹é\n\n# bind the source and sink to the channel\na1.sources.r1.channels = c1 #source r1åchannel c1ç»å®\na1.sinks.k1.channel = c1 #sink k1åchannel c1ç»å®\n\n\nå¯å¨å½ä»¤ï¼\nbin/flume-ng agent --conf conf --conf-file example.conf --name a1 -dflume.root.logger=info,console\n\n\n# ç»ä»¶ç§ç±»\n\nä»¥ä¸åä¸¾çæ¯å¸¸ç¨çç»ä»¶ç±»åï¼æç¨å°å¶ä»çç±»åå¯ä»¥éè¿å®ç½ç´æ¥ç´æ¥æç´¢ç±»åæ¥çè¯¦æ\n\n\n# source\n\n * avroï¼ç¨äºæ¥æ¶ä»å¦ä¸ä¸ªflumeï¼agentï¼ä¸­æ¶å°çæ°æ®\n * execï¼ç¨äºæ¥æ¶ä»å½ä»¤ä¸­è·åçæ°æ®ï¼å¦ç»åå½ä»¤tail -fä½¿ç¨\n * netcatï¼ç¨äºæ¥æ¶ç«¯å£ä¼ æ¥çæ°æ®\n * spooling directoryï¼ç¨äºæ¥æ¶æä»¶åå¨çæ°æ®\n\n\n# channel\n\n * memory channel åå­ï¼éåº¦å¿«ï¼ä½å®æºæ¶ææ°æ®ä¸¢å¤±çé£é©\n * file channel éåº¦æ¯è¾æ¢ï¼ä½å®å¨\n * kafka channel\n\n\n# sink\n\n * avro è¾åºå°å¦ä¸ä¸ªflumeï¼agentï¼\n * hdfs è¾åºå°hdfs\n * logger æ¥å¿å½¢å¼è¾åº\n * file æä»¶å½¢å¼è½å°\n\n> to be continue...\n\n\n# åè\n\n 1. flumeå®ç½ç¨æ·ä½¿ç¨æå",charsets:{cjk:!0}},{title:"æ¶æ¯éåæ¦è¿°",frontmatter:{title:"æ¶æ¯éåæ¦è¿°",date:"2023-03-31T14:10:43.000Z",permalink:"/pages/mq/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/01.%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E6%A6%82%E8%BF%B0.html",relativePath:"10.ä¸­é´ä»¶/01.æ¶æ¯éåæ¦è¿°.md",key:"v-79517efc",path:"/pages/mq/",headers:[{level:2,title:"å¸¸ç¨MQå¯¹æ¯",slug:"å¸¸ç¨mqå¯¹æ¯",normalizedTitle:"å¸¸ç¨mqå¯¹æ¯",charIndex:239},{level:2,title:"JMSåAMQP",slug:"jmsåamqp",normalizedTitle:"jmsåamqp",charIndex:2352},{level:3,title:"JMS",slug:"jms",normalizedTitle:"jms",charIndex:482},{level:3,title:"AMQP",slug:"amqp",normalizedTitle:"amqp",charIndex:376},{level:3,title:"JMS vs AMQP",slug:"jms-vs-amqp",normalizedTitle:"jms vs amqp",charIndex:2824}],headersStr:"å¸¸ç¨MQå¯¹æ¯ JMSåAMQP JMS AMQP JMS vs AMQP",content:"æ¶æ¯éåçä¸»è¦ä½ç¨æ¯ï¼\n\n 1. è§£è¦\n 2. å¼æ­¥ãåå°ååºæéæ¶é´\n 3. åå³°\n\næ¶æ¯éåçç¼ºç¹ ï¼\n\n 1. éä½ç³»ç»çå¯ç¨æ§ï¼ç³»ç»å¼å¥çå¤é¨ä¾èµè¶å¤ï¼è¶å®¹æææï¼\n 2. ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ MQ åå¯è½éè¦ä¿è¯æ¶æ¯æ²¡æè¢«éå¤æ¶è´¹ãå¤çæ¶æ¯ä¸¢å¤±çæåµãä¿è¯æ¶æ¯ä¼ éçé¡ºåºæ§ç­ç­é®é¢ï¼\n 3. ä¸è´æ§é®é¢ï¼A ç³»ç»å¤çå®äºç´æ¥è¿åæåäºï¼ä½é®é¢æ¯ï¼è¦æ¯ BãCãD ä¸ä¸ªç³»ç»é£éï¼B å D ä¸¤ä¸ªç³»ç»ååºæåäºï¼ç»æ C ç³»ç»ååºå¤±è´¥äºï¼å°±é ææ°æ®ä¸ä¸è´äºã\n\n\n# å¸¸ç¨MQå¯¹æ¯\n\nç¹æ§     RABBITMQ                        APACHE KAFKA                 APACHE ROCKETMQ                              ACTIVEMQ\nç±»å     AMQPãSTOMPãMQTTç­å¤ç§åè®®            Pub/Subæ¶æ¯ç³»ç»                  çº¯Javaæ¶æ¯éå                                    JMSæ¶æ¯ç³»ç»\næ§è½     ç¨³å®ãæ§è½ä¸è¬ï¼éåå°è§æ¨¡åºç¨                 é«ååéãä½å»¶è¿ï¼éåå¤§è§æ¨¡åå¸å¼ç³»ç»          é«ååéãä½å»¶è¿ï¼éåå¤§è§æ¨¡åå¸å¼ç³»ç»                          æ§è½ä¸è¬ï¼éåå°è§æ¨¡åºç¨\nå¯ç¨æ§    æ¯æå¤ç§HAæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãéåéåãéç¾¤ç­        æ¯æå¤ç§HAæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãååºå¯æ¬ç­        æ¯æå¤ç§HAæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãBroker HAãNamesrv HAãå¼å°å¤æ´»ç­   æ¯æå¤ç§HAæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãéç¾¤ç­\nå¯é æ§    æ¯æäºå¡ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§        æ¯æå¯æ¬æºå¶ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§   æ¯æä¸»ä»å¤å¶ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§                   æ¯ææä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§\nç®¡çå·¥å·   æ¯æWebç®¡ççé¢ãCLIãREST APIç­å¤ç§ç®¡çå·¥å·   æ¯æWebç®¡ççé¢ãCLIç­å¤ç§ç®¡çå·¥å·         æ¯æWebç®¡ççé¢ãCLIç­å¤ç§ç®¡çå·¥å·                         æ¯æWebç®¡ççé¢ãCLIç­å¤ç§ç®¡çå·¥å·\nç¤¾åºæ¯æ   å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯                å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯             å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯                             å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯\néç¨åºæ¯   ä¸­å°è§æ¨¡åºç¨ãéè¦äºå¡æ¯æãéè¦AMQPåè®®çåºç¨       å¤§è§æ¨¡åå¸å¼ç³»ç»ãå®æ¶æ°æ®å¤çãæ¥å¿æ¶éç­        å¤§è§æ¨¡åå¸å¼ç³»ç»ãé«å¯ç¨æ§åºæ¯ãéè¦äºå¡æ¯æçåºç¨                    ä¸­å°è§æ¨¡åºç¨ãéè¦JMSåè®®çåºç¨\n\n * ååéï¼ä¸çº§ç ActiveMQ å RabbitMQ çååéï¼ActiveMQ çæ§è½æå·®ï¼è¦æ¯åä¸çº§çè³æ¯ç¾ä¸çº§ç RocketMQ å Kafka ä½ä¸ä¸ªæ°éçº§ã\n\n * å¯ç¨æ§ï¼é½å¯ä»¥å®ç°é«å¯ç¨ãActiveMQ å RabbitMQ é½æ¯åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨æ§ãRocketMQ åºäºåå¸å¼æ¶æã Kafka ä¹æ¯åå¸å¼çï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\n\n * æ¶ææ§ï¼RabbitMQ åºäº Erlang å¼åï¼æä»¥å¹¶åè½åå¾å¼ºï¼æ§è½æå¶å¥½ï¼å»¶æ¶å¾ä½ï¼è¾¾å°å¾®ç§çº§ï¼å¶ä»å ä¸ªé½æ¯ ms çº§ã\n\n * åè½æ¯æï¼Pulsar çåè½æ´å¨é¢ï¼æ¯æå¤ç§æ·ãå¤ç§æ¶è´¹æ¨¡å¼åæä¹æ§æ¨¡å¼ç­åè½ï¼æ¯ä¸ä¸ä»£äºåçåå¸å¼æ¶æ¯æµå¹³å°ã\n\n * æ¶æ¯ä¸¢å¤±ï¼ActiveMQ å RabbitMQ ä¸¢å¤±çå¯è½æ§éå¸¸ä½ï¼ KafkaãRocketMQ å Pulsar çè®ºä¸å¯ä»¥åå° 0 ä¸¢å¤±ã\n\n * ActiveMQ çç¤¾åºç®æ¯æ¯è¾æçï¼ä½æ¯è¾ç®åæ¥è¯´ï¼ActiveMQ çæ§è½æ¯è¾å·®ï¼èä¸çæ¬è¿­ä»£å¾æ¢ï¼ä¸æ¨èä½¿ç¨ï¼å·²ç»è¢«æ·æ±°äºã\n\n * RabbitMQ å¨ååéæ¹é¢è½ç¶ç¨éäº Kafka ãRocketMQ å Pulsarï¼ä½æ¯ç±äºå®åºäº Erlang å¼åï¼æä»¥å¹¶åè½åå¾å¼ºï¼æ§è½æå¶å¥½ï¼å»¶æ¶å¾ä½ï¼è¾¾å°å¾®ç§çº§ãä½æ¯ä¹å ä¸º RabbitMQ åºäº Erlang å¼åï¼æä»¥å½åå¾å°æå¬å¸æå®åå Erlang æºç çº§å«çç ç©¶åå®å¶ãå¦æä¸å¡åºæ¯å¯¹å¹¶åéè¦æ±ä¸æ¯å¤ªé«ï¼åä¸çº§ãç¾ä¸çº§ï¼ï¼é£è¿å ç§æ¶æ¯éåä¸­ï¼RabbitMQ æè®¸æ¯ä½ çé¦éã\n\n * RocketMQ å Pulsar æ¯æå¼ºä¸è´æ§ï¼å¯¹æ¶æ¯ä¸è´æ§è¦æ±æ¯è¾é«çåºæ¯å¯ä»¥ä½¿ç¨ã\n\n * RocketMQ é¿éåºåï¼Java ç³»å¼æºé¡¹ç®ï¼æºä»£ç æä»¬å¯ä»¥ç´æ¥éè¯»ï¼ç¶åå¯ä»¥å®å¶èªå·±å¬å¸ç MQï¼å¹¶ä¸ RocketMQ æé¿éå·´å·´çå®éä¸å¡åºæ¯çå®æèéªã\n\n * Kafka çç¹ç¹å¶å®å¾ææ¾ï¼å°±æ¯ä»ä»æä¾è¾å°çæ ¸å¿åè½ï¼ä½æ¯æä¾è¶é«çååéï¼ms çº§çå»¶è¿ï¼æé«çå¯ç¨æ§ä»¥åå¯é æ§ï¼èä¸åå¸å¼å¯ä»¥ä»»ææ©å±ãåæ¶ Kafka æå¥½æ¯æ¯æè¾å°ç topic æ°éå³å¯ï¼ä¿è¯å¶è¶é«ååéãKafka å¯ä¸çä¸ç¹å£å¿æ¯æå¯è½æ¶æ¯éå¤æ¶è´¹ï¼é£ä¹å¯¹æ°æ®åç¡®æ§ä¼é ææå¶è½»å¾®çå½±åï¼å¨å¤§æ°æ®é¢åä¸­ä»¥åæ¥å¿ééä¸­ï¼è¿ç¹è½»å¾®å½±åå¯ä»¥å¿½ç¥è¿ä¸ªç¹æ§å¤©ç¶éåå¤§æ°æ®å®æ¶è®¡ç®ä»¥åæ¥å¿æ¶éãå¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ Kafka æ¯ä¸åæ åçã\n\n\n# JMSåAMQP\n\n\n# JMS\n\nJMSï¼JAVA Message Service,java æ¶æ¯æå¡ï¼æ¯ Java çæ¶æ¯æå¡ï¼JMS çå®¢æ·ç«¯ä¹é´å¯ä»¥éè¿ JMS æå¡è¿è¡å¼æ­¥çæ¶æ¯ä¼ è¾ãJMS API æ¯ä¸ä¸ªæ¶æ¯æå¡çæ åæèè¯´æ¯è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº JavaEE å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nActiveMQ å°±æ¯åºäº JMS è§èå®ç°çã\n\nJMSçä¸¤ç§æ¶æ¯æ¨¡å\n\n * ç¹å°ç¹æ¨¡å¼ï¼P2Pï¼\n * åå¸/è®¢éæ¨¡å¼ï¼Pub/Subï¼ï¼éè¿topicè®¢éï¼ç±»ä¼¼å¹¿æ­\n\n\n# AMQP\n\nAMQPï¼å³ Advanced Message Queuing Protocolï¼ä¸ä¸ªæä¾ç»ä¸æ¶æ¯æå¡çåºç¨å±æ åé«çº§æ¶æ¯éååè®®ï¼äºè¿å¶åºç¨å±åè®®ï¼ï¼æ¯åºç¨å±åè®®çä¸ä¸ªå¼æ¾æ åï¼ä¸ºé¢åæ¶æ¯çä¸­é´ä»¶è®¾è®¡ï¼å¼å®¹ JMSãåºäºæ­¤åè®®çå®¢æ·ç«¯ä¸æ¶æ¯ä¸­é´ä»¶å¯ä¼ éæ¶æ¯ï¼å¹¶ä¸åå®¢æ·ç«¯/ä¸­é´ä»¶åäº§åï¼ä¸åçå¼åè¯­è¨ç­æ¡ä»¶çéå¶ã\n\nRabbitMQ å°±æ¯åºäº AMQP åè®®å®ç°çã\n\n\n# JMS vs AMQP\n\n * AMQP ä¸ºæ¶æ¯å®ä¹äºçº¿è·¯å±ï¼wire-level protocolï¼çåè®®ï¼è JMS æå®ä¹çæ¯ API è§èãå¨ Java ä½ç³»ä¸­ï¼å¤ä¸ª client åå¯ä»¥éè¿ JMS è¿è¡äº¤äºï¼ä¸éè¦åºç¨ä¿®æ¹ä»£ç ï¼ä½æ¯å¶å¯¹è·¨å¹³å°çæ¯æè¾å·®ãè AMQP å¤©ç¶å·æè·¨å¹³å°ãè·¨è¯­è¨ç¹æ§ã\n * JMS æ¯æ TextMessageãMapMessage ç­å¤æçæ¶æ¯ç±»åï¼è AMQP ä»æ¯æ byte[] æ¶æ¯ç±»åï¼å¤æçç±»åå¯åºååååéï¼ã\n * ç±äº Exchange æä¾çè·¯ç±ç®æ³ï¼AMQP å¯ä»¥æä¾å¤æ ·åçè·¯ç±æ¹å¼æ¥ä¼ éæ¶æ¯å°æ¶æ¯éåï¼è JMS ä»æ¯æ éå å ä¸»é¢/è®¢éæ¹å¼ä¸¤ç§ã",normalizedContent:"æ¶æ¯éåçä¸»è¦ä½ç¨æ¯ï¼\n\n 1. è§£è¦\n 2. å¼æ­¥ãåå°ååºæéæ¶é´\n 3. åå³°\n\næ¶æ¯éåçç¼ºç¹ ï¼\n\n 1. éä½ç³»ç»çå¯ç¨æ§ï¼ç³»ç»å¼å¥çå¤é¨ä¾èµè¶å¤ï¼è¶å®¹æææï¼\n 2. ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ mq åå¯è½éè¦ä¿è¯æ¶æ¯æ²¡æè¢«éå¤æ¶è´¹ãå¤çæ¶æ¯ä¸¢å¤±çæåµãä¿è¯æ¶æ¯ä¼ éçé¡ºåºæ§ç­ç­é®é¢ï¼\n 3. ä¸è´æ§é®é¢ï¼a ç³»ç»å¤çå®äºç´æ¥è¿åæåäºï¼ä½é®é¢æ¯ï¼è¦æ¯ bãcãd ä¸ä¸ªç³»ç»é£éï¼b å d ä¸¤ä¸ªç³»ç»ååºæåäºï¼ç»æ c ç³»ç»ååºå¤±è´¥äºï¼å°±é ææ°æ®ä¸ä¸è´äºã\n\n\n# å¸¸ç¨mqå¯¹æ¯\n\nç¹æ§     rabbitmq                        apache kafka                 apache rocketmq                              activemq\nç±»å     amqpãstompãmqttç­å¤ç§åè®®            pub/subæ¶æ¯ç³»ç»                  çº¯javaæ¶æ¯éå                                    jmsæ¶æ¯ç³»ç»\næ§è½     ç¨³å®ãæ§è½ä¸è¬ï¼éåå°è§æ¨¡åºç¨                 é«ååéãä½å»¶è¿ï¼éåå¤§è§æ¨¡åå¸å¼ç³»ç»          é«ååéãä½å»¶è¿ï¼éåå¤§è§æ¨¡åå¸å¼ç³»ç»                          æ§è½ä¸è¬ï¼éåå°è§æ¨¡åºç¨\nå¯ç¨æ§    æ¯æå¤ç§haæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãéåéåãéç¾¤ç­        æ¯æå¤ç§haæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãååºå¯æ¬ç­        æ¯æå¤ç§haæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãbroker haãnamesrv haãå¼å°å¤æ´»ç­   æ¯æå¤ç§haæºå¶ï¼åæ¬ä¸»ä»å¤å¶ãéç¾¤ç­\nå¯é æ§    æ¯æäºå¡ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§        æ¯æå¯æ¬æºå¶ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§   æ¯æä¸»ä»å¤å¶ãæä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§                   æ¯ææä¹åãæ¶æ¯ç¡®è®¤ç­æºå¶ï¼ä¿è¯æ¶æ¯å¯é æ§\nç®¡çå·¥å·   æ¯æwebç®¡ççé¢ãcliãrest apiç­å¤ç§ç®¡çå·¥å·   æ¯æwebç®¡ççé¢ãcliç­å¤ç§ç®¡çå·¥å·         æ¯æwebç®¡ççé¢ãcliç­å¤ç§ç®¡çå·¥å·                         æ¯æwebç®¡ççé¢ãcliç­å¤ç§ç®¡çå·¥å·\nç¤¾åºæ¯æ   å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯                å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯             å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯                             å¼æºç¤¾åºæ´»è·ï¼ææ¡£ä¸°å¯ï¼æä»¶ä¸°å¯\néç¨åºæ¯   ä¸­å°è§æ¨¡åºç¨ãéè¦äºå¡æ¯æãéè¦amqpåè®®çåºç¨       å¤§è§æ¨¡åå¸å¼ç³»ç»ãå®æ¶æ°æ®å¤çãæ¥å¿æ¶éç­        å¤§è§æ¨¡åå¸å¼ç³»ç»ãé«å¯ç¨æ§åºæ¯ãéè¦äºå¡æ¯æçåºç¨                    ä¸­å°è§æ¨¡åºç¨ãéè¦jmsåè®®çåºç¨\n\n * ååéï¼ä¸çº§ç activemq å rabbitmq çååéï¼activemq çæ§è½æå·®ï¼è¦æ¯åä¸çº§çè³æ¯ç¾ä¸çº§ç rocketmq å kafka ä½ä¸ä¸ªæ°éçº§ã\n\n * å¯ç¨æ§ï¼é½å¯ä»¥å®ç°é«å¯ç¨ãactivemq å rabbitmq é½æ¯åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨æ§ãrocketmq åºäºåå¸å¼æ¶æã kafka ä¹æ¯åå¸å¼çï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\n\n * æ¶ææ§ï¼rabbitmq åºäº erlang å¼åï¼æä»¥å¹¶åè½åå¾å¼ºï¼æ§è½æå¶å¥½ï¼å»¶æ¶å¾ä½ï¼è¾¾å°å¾®ç§çº§ï¼å¶ä»å ä¸ªé½æ¯ ms çº§ã\n\n * åè½æ¯æï¼pulsar çåè½æ´å¨é¢ï¼æ¯æå¤ç§æ·ãå¤ç§æ¶è´¹æ¨¡å¼åæä¹æ§æ¨¡å¼ç­åè½ï¼æ¯ä¸ä¸ä»£äºåçåå¸å¼æ¶æ¯æµå¹³å°ã\n\n * æ¶æ¯ä¸¢å¤±ï¼activemq å rabbitmq ä¸¢å¤±çå¯è½æ§éå¸¸ä½ï¼ kafkaãrocketmq å pulsar çè®ºä¸å¯ä»¥åå° 0 ä¸¢å¤±ã\n\n * activemq çç¤¾åºç®æ¯æ¯è¾æçï¼ä½æ¯è¾ç®åæ¥è¯´ï¼activemq çæ§è½æ¯è¾å·®ï¼èä¸çæ¬è¿­ä»£å¾æ¢ï¼ä¸æ¨èä½¿ç¨ï¼å·²ç»è¢«æ·æ±°äºã\n\n * rabbitmq å¨ååéæ¹é¢è½ç¶ç¨éäº kafka ãrocketmq å pulsarï¼ä½æ¯ç±äºå®åºäº erlang å¼åï¼æä»¥å¹¶åè½åå¾å¼ºï¼æ§è½æå¶å¥½ï¼å»¶æ¶å¾ä½ï¼è¾¾å°å¾®ç§çº§ãä½æ¯ä¹å ä¸º rabbitmq åºäº erlang å¼åï¼æä»¥å½åå¾å°æå¬å¸æå®åå erlang æºç çº§å«çç ç©¶åå®å¶ãå¦æä¸å¡åºæ¯å¯¹å¹¶åéè¦æ±ä¸æ¯å¤ªé«ï¼åä¸çº§ãç¾ä¸çº§ï¼ï¼é£è¿å ç§æ¶æ¯éåä¸­ï¼rabbitmq æè®¸æ¯ä½ çé¦éã\n\n * rocketmq å pulsar æ¯æå¼ºä¸è´æ§ï¼å¯¹æ¶æ¯ä¸è´æ§è¦æ±æ¯è¾é«çåºæ¯å¯ä»¥ä½¿ç¨ã\n\n * rocketmq é¿éåºåï¼java ç³»å¼æºé¡¹ç®ï¼æºä»£ç æä»¬å¯ä»¥ç´æ¥éè¯»ï¼ç¶åå¯ä»¥å®å¶èªå·±å¬å¸ç mqï¼å¹¶ä¸ rocketmq æé¿éå·´å·´çå®éä¸å¡åºæ¯çå®æèéªã\n\n * kafka çç¹ç¹å¶å®å¾ææ¾ï¼å°±æ¯ä»ä»æä¾è¾å°çæ ¸å¿åè½ï¼ä½æ¯æä¾è¶é«çååéï¼ms çº§çå»¶è¿ï¼æé«çå¯ç¨æ§ä»¥åå¯é æ§ï¼èä¸åå¸å¼å¯ä»¥ä»»ææ©å±ãåæ¶ kafka æå¥½æ¯æ¯æè¾å°ç topic æ°éå³å¯ï¼ä¿è¯å¶è¶é«ååéãkafka å¯ä¸çä¸ç¹å£å¿æ¯æå¯è½æ¶æ¯éå¤æ¶è´¹ï¼é£ä¹å¯¹æ°æ®åç¡®æ§ä¼é ææå¶è½»å¾®çå½±åï¼å¨å¤§æ°æ®é¢åä¸­ä»¥åæ¥å¿ééä¸­ï¼è¿ç¹è½»å¾®å½±åå¯ä»¥å¿½ç¥è¿ä¸ªç¹æ§å¤©ç¶éåå¤§æ°æ®å®æ¶è®¡ç®ä»¥åæ¥å¿æ¶éãå¦ææ¯å¤§æ°æ®é¢åçå®æ¶è®¡ç®ãæ¥å¿ééç­åºæ¯ï¼ç¨ kafka æ¯ä¸åæ åçã\n\n\n# jmsåamqp\n\n\n# jms\n\njmsï¼java message service,java æ¶æ¯æå¡ï¼æ¯ java çæ¶æ¯æå¡ï¼jms çå®¢æ·ç«¯ä¹é´å¯ä»¥éè¿ jms æå¡è¿è¡å¼æ­¥çæ¶æ¯ä¼ è¾ãjms api æ¯ä¸ä¸ªæ¶æ¯æå¡çæ åæèè¯´æ¯è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº javaee å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nactivemq å°±æ¯åºäº jms è§èå®ç°çã\n\njmsçä¸¤ç§æ¶æ¯æ¨¡å\n\n * ç¹å°ç¹æ¨¡å¼ï¼p2pï¼\n * åå¸/è®¢éæ¨¡å¼ï¼pub/subï¼ï¼éè¿topicè®¢éï¼ç±»ä¼¼å¹¿æ­\n\n\n# amqp\n\namqpï¼å³ advanced message queuing protocolï¼ä¸ä¸ªæä¾ç»ä¸æ¶æ¯æå¡çåºç¨å±æ åé«çº§æ¶æ¯éååè®®ï¼äºè¿å¶åºç¨å±åè®®ï¼ï¼æ¯åºç¨å±åè®®çä¸ä¸ªå¼æ¾æ åï¼ä¸ºé¢åæ¶æ¯çä¸­é´ä»¶è®¾è®¡ï¼å¼å®¹ jmsãåºäºæ­¤åè®®çå®¢æ·ç«¯ä¸æ¶æ¯ä¸­é´ä»¶å¯ä¼ éæ¶æ¯ï¼å¹¶ä¸åå®¢æ·ç«¯/ä¸­é´ä»¶åäº§åï¼ä¸åçå¼åè¯­è¨ç­æ¡ä»¶çéå¶ã\n\nrabbitmq å°±æ¯åºäº amqp åè®®å®ç°çã\n\n\n# jms vs amqp\n\n * amqp ä¸ºæ¶æ¯å®ä¹äºçº¿è·¯å±ï¼wire-level protocolï¼çåè®®ï¼è jms æå®ä¹çæ¯ api è§èãå¨ java ä½ç³»ä¸­ï¼å¤ä¸ª client åå¯ä»¥éè¿ jms è¿è¡äº¤äºï¼ä¸éè¦åºç¨ä¿®æ¹ä»£ç ï¼ä½æ¯å¶å¯¹è·¨å¹³å°çæ¯æè¾å·®ãè amqp å¤©ç¶å·æè·¨å¹³å°ãè·¨è¯­è¨ç¹æ§ã\n * jms æ¯æ textmessageãmapmessage ç­å¤æçæ¶æ¯ç±»åï¼è amqp ä»æ¯æ byte[] æ¶æ¯ç±»åï¼å¤æçç±»åå¯åºååååéï¼ã\n * ç±äº exchange æä¾çè·¯ç±ç®æ³ï¼amqp å¯ä»¥æä¾å¤æ ·åçè·¯ç±æ¹å¼æ¥ä¼ éæ¶æ¯å°æ¶æ¯éåï¼è jms ä»æ¯æ éå å ä¸»é¢/è®¢éæ¹å¼ä¸¤ç§ã",charsets:{cjk:!0}},{title:"RocketMQ å Kafka å¯¹æ¯",frontmatter:{title:"RocketMQ å Kafka å¯¹æ¯",date:"2023-07-20T22:44:48.000Z",permalink:"/pages/7c8ab7/"},regularPath:"/10.%E4%B8%AD%E9%97%B4%E4%BB%B6/04.%20RocketMQ%20%E5%92%8C%20Kafka%20%E5%AF%B9%E6%AF%94.html",relativePath:"10.ä¸­é´ä»¶/04. RocketMQ å Kafka å¯¹æ¯.md",key:"v-6bc0f08b",path:"/pages/7c8ab7/",headersStr:null,content:"æ¦å¿µå¯¹æ¯ï¼\n\nKAFKA            ROCKETMQ\nTopic            Topic\nPartition        Queue\nProducer         Producer\nConsumer         Consumer\nConsumer Group   Consumer Group\nBroker           Broker\nMessage          Message\nOffset           Offset\nLeader           Master\nFollower         Slave\nZooKeeper        Nameserver\nConnector        Producer",normalizedContent:"æ¦å¿µå¯¹æ¯ï¼\n\nkafka            rocketmq\ntopic            topic\npartition        queue\nproducer         producer\nconsumer         consumer\nconsumer group   consumer group\nbroker           broker\nmessage          message\noffset           offset\nleader           master\nfollower         slave\nzookeeper        nameserver\nconnector        producer",charsets:{cjk:!0}},{title:"Git commit message è§è",frontmatter:{title:"Git commit message è§è",date:"2023-03-20T19:39:51.000Z",permalink:"/pages/git/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/01.Git/01.Git%20commit%20message%20%E8%A7%84%E8%8C%83.html",relativePath:"100.å·¥å·/01.Git/01.Git commit message è§è.md",key:"v-c1084aa0",path:"/pages/git/",headersStr:null,content:"message typeï¼\n\n * featï¼æ°åè½ï¼featureï¼\n * fixï¼ä¿®è¡¥bug\n * perfï¼æé«ä»£ç æ§è½çåæ´\n * docsï¼ææ¡£ï¼documentationï¼\n * styleï¼ æ ¼å¼ï¼ä¸å½±åä»£ç è¿è¡çåå¨ï¼ï¼å¦æ ¼å¼åä»£ç ãå é¤ç©ºè¡\n * refactorï¼éæï¼å³ä¸æ¯æ°å¢åè½ï¼ä¹ä¸æ¯ä¿®æ¹bugçä»£ç åå¨ï¼\n * testï¼å¢å æµè¯\n * choreï¼å¶ä»ç±»åï¼å¦æå»ºè¿ç¨ãä¾èµç®¡çãè¾å©å·¥å·çåå¨\n\n\nä»£ç ç±»ï¼\n\n * feat\n * fix\n * perf\n * style\n * refactor\n\n\néä»£ç ç±»ï¼\n\n * test\n * ci\n * docs\n * chore\n\nåèï¼https://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html",normalizedContent:"message typeï¼\n\n * featï¼æ°åè½ï¼featureï¼\n * fixï¼ä¿®è¡¥bug\n * perfï¼æé«ä»£ç æ§è½çåæ´\n * docsï¼ææ¡£ï¼documentationï¼\n * styleï¼ æ ¼å¼ï¼ä¸å½±åä»£ç è¿è¡çåå¨ï¼ï¼å¦æ ¼å¼åä»£ç ãå é¤ç©ºè¡\n * refactorï¼éæï¼å³ä¸æ¯æ°å¢åè½ï¼ä¹ä¸æ¯ä¿®æ¹bugçä»£ç åå¨ï¼\n * testï¼å¢å æµè¯\n * choreï¼å¶ä»ç±»åï¼å¦æå»ºè¿ç¨ãä¾èµç®¡çãè¾å©å·¥å·çåå¨\n\n\nä»£ç ç±»ï¼\n\n * feat\n * fix\n * perf\n * style\n * refactor\n\n\néä»£ç ç±»ï¼\n\n * test\n * ci\n * docs\n * chore\n\nåèï¼https://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"åå¹¶æäº¤-rebase",frontmatter:{title:"åå¹¶æäº¤-rebase",date:"2023-03-20T19:41:38.000Z",permalink:"/pages/6f9bb5/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/01.Git/02.%E5%90%88%E5%B9%B6%E6%8F%90%E4%BA%A4-rebase.html",relativePath:"100.å·¥å·/01.Git/02.åå¹¶æäº¤-rebase.md",key:"v-4c9cf11f",path:"/pages/6f9bb5/",headers:[{level:2,title:"å¨ idea ä¸­æä½ rebase åå¹¶ commit",slug:"å¨-idea-ä¸­æä½-rebase-åå¹¶-commit",normalizedTitle:"å¨ idea ä¸­æä½ rebase åå¹¶ commit",charIndex:793}],headersStr:"å¨ idea ä¸­æä½ rebase åå¹¶ commit",content:"å¦æè§å¾ä»£ç commitâ½è¾å¤ï¼çèµ·æ¥â½è¾éæãæèè¯´ï¼æ³ç­å¼åå®â¼ä¸ªå®æ´çåè½ä¹åï¼æ¾å¨â¼ä¸ªcommitä¸­â¼èµ·æäº¤ãè¿æ¶åï¼æä»¬å¯ä»¥å¨æååå¹¶ä»£ç æèæäº¤Pull Requeståï¼æ§â¾git rebase -iåå¹¶ä¹åçææcommitã\n\n\ngit rebase -i <commit ID>\n\n-i: interactiveï¼è¿å¥å°äº¤äºçé¢ä¸­ï¼vimç¼è¾å¨ã\n\nè¿ä¸ªäº¤äºçâ¾¯ä¼â¾¸åååºç»å®<commit ID>ä¹åï¼ä¸åæ¬ï¼è¶ä¸â¾¯è¶æ°ï¼çææcommitï¼æ¯ä¸ªcommit\n\nåâ¾¯æâ¼ä¸ªæä½å½ä»¤ï¼é»è®¤æ¯pickãæä»¬å¯ä»¥éæ©ä¸åçcommitï¼å¹¶ä¿®æ¹commitåâ¾¯çå½ä»¤ï¼æ¥å¯¹è¯¥\n\ncommitæ§â¾ä¸åçåæ´æä½ã\n\n\ngit baseæ¯æçåæ´æä½ï¼\n\n * pï¼pickï¼ä¸å¯¹è¯¥commitåä»»ä½å¤ç\n * rï¼rewordï¼ä¿çè¯¥commitï¼ä½æ¯ä¿®æ¹æäº¤ä¿¡æ¯\n * eï¼editï¼ä¿çè¯¥commitï¼ä½æ¯rebaseæ¶ä¼æåï¼åè®¸ä½ ä¿®æ¹è¿ä¸ªcommit\n * sï¼squashï¼ä¿çè¯¥commitï¼ä½ä¼å°å½åcommitä¸ä¸ä¸ä¸ªcommitåå¹¶\n * fï¼fixupï¼ä¸squashç¸åï¼ä½ä¸ä¼ä¿å­å½åcommitçä¿¡æ¯\n * xï¼execï¼æ§è¡å¶ä»shellå½ä»¤\n * dï¼dropï¼å é¤è¯¥commit\n\næ¥çcommitè®°å½ï¼git log --oneline\n\ngit reset å½ä»¤ç¨äºåéçæ¬ï¼å¯ä»¥æå®éåæä¸æ¬¡çæäº¤ã\n\næ§è¡ git reset HEAD ä»¥åæ¶ä¹å git add æ·»å ï¼ä½ä¸å¸æåå«å¨ä¸ä¸æäº¤å¿«ç§ä¸­çç¼å­ã\n\n\nä¿®æ¹commit messageçä¸¤ç§æ¹æ³ï¼\n\n * git commit --amentï¼ä¿®æ¹æè¿ä¸æ¬¡commitçmessage\n * git rebase -iï¼éeï¼ä¿®æ¹ææ¬¡commitçmessage\n\n\n# å¨ idea ä¸­æä½ rebase åå¹¶ commit\n\n\n\n\n\nhttps://blog.csdn.net/oldshaui/article/details/103922368",normalizedContent:"å¦æè§å¾ä»£ç commitâ½è¾å¤ï¼çèµ·æ¥â½è¾éæãæèè¯´ï¼æ³ç­å¼åå®â¼ä¸ªå®æ´çåè½ä¹åï¼æ¾å¨â¼ä¸ªcommitä¸­â¼èµ·æäº¤ãè¿æ¶åï¼æä»¬å¯ä»¥å¨æååå¹¶ä»£ç æèæäº¤pull requeståï¼æ§â¾git rebase -iåå¹¶ä¹åçææcommitã\n\n\ngit rebase -i <commit id>\n\n-i: interactiveï¼è¿å¥å°äº¤äºçé¢ä¸­ï¼vimç¼è¾å¨ã\n\nè¿ä¸ªäº¤äºçâ¾¯ä¼â¾¸åååºç»å®<commit id>ä¹åï¼ä¸åæ¬ï¼è¶ä¸â¾¯è¶æ°ï¼çææcommitï¼æ¯ä¸ªcommit\n\nåâ¾¯æâ¼ä¸ªæä½å½ä»¤ï¼é»è®¤æ¯pickãæä»¬å¯ä»¥éæ©ä¸åçcommitï¼å¹¶ä¿®æ¹commitåâ¾¯çå½ä»¤ï¼æ¥å¯¹è¯¥\n\ncommitæ§â¾ä¸åçåæ´æä½ã\n\n\ngit baseæ¯æçåæ´æä½ï¼\n\n * pï¼pickï¼ä¸å¯¹è¯¥commitåä»»ä½å¤ç\n * rï¼rewordï¼ä¿çè¯¥commitï¼ä½æ¯ä¿®æ¹æäº¤ä¿¡æ¯\n * eï¼editï¼ä¿çè¯¥commitï¼ä½æ¯rebaseæ¶ä¼æåï¼åè®¸ä½ ä¿®æ¹è¿ä¸ªcommit\n * sï¼squashï¼ä¿çè¯¥commitï¼ä½ä¼å°å½åcommitä¸ä¸ä¸ä¸ªcommitåå¹¶\n * fï¼fixupï¼ä¸squashç¸åï¼ä½ä¸ä¼ä¿å­å½åcommitçä¿¡æ¯\n * xï¼execï¼æ§è¡å¶ä»shellå½ä»¤\n * dï¼dropï¼å é¤è¯¥commit\n\næ¥çcommitè®°å½ï¼git log --oneline\n\ngit reset å½ä»¤ç¨äºåéçæ¬ï¼å¯ä»¥æå®éåæä¸æ¬¡çæäº¤ã\n\næ§è¡ git reset head ä»¥åæ¶ä¹å git add æ·»å ï¼ä½ä¸å¸æåå«å¨ä¸ä¸æäº¤å¿«ç§ä¸­çç¼å­ã\n\n\nä¿®æ¹commit messageçä¸¤ç§æ¹æ³ï¼\n\n * git commit --amentï¼ä¿®æ¹æè¿ä¸æ¬¡commitçmessage\n * git rebase -iï¼éeï¼ä¿®æ¹ææ¬¡commitçmessage\n\n\n# å¨ idea ä¸­æä½ rebase åå¹¶ commit\n\n\n\n\n\nhttps://blog.csdn.net/oldshaui/article/details/103922368",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"git fetchä¸git pull",frontmatter:{title:"git fetchä¸git pull",date:"2023-03-30T13:37:13.000Z",permalink:"/pages/0974e8/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/01.Git/03.git%20pull%E5%92%8Cgit%20fetch.html",relativePath:"100.å·¥å·/01.Git/03.git pullågit fetch.md",key:"v-7181834a",path:"/pages/0974e8/",headersStr:null,content:"git pull = git fetch + git merge\n\ngit fetchågit pullé½æ¯Gitçæ¬æ§å¶ç³»ç»ä¸­ç¨äºä»è¿ç¨ä»åºè·åæ´æ°çå½ä»¤ï¼ä½å®ä»¬ä¹é´æä¸äºåºå«ã\n\ngit fetchä¼ä»è¿ç¨ä»åºä¸è½½ææ°çæäº¤ï¼ä½ä¸ä¼èªå¨å°è¿äºæ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãè¿æå³çä½ å¯ä»¥å¨æ¬å°ä»åºä¸­æ¥çè¿ç¨ä»åºçæ´æ°ï¼ä½å¯ä»¥éæ©ä»ä¹æ¶åå°è¿äºæ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãä½¿ç¨git fetchåï¼éè¦æå¨ä½¿ç¨git mergeægit rebaseå°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ã\n\ngit pullåä¼å¨è¿è¡git fetchå½ä»¤ä¹åèªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãè¿æå³çgit pullå½ä»¤ä¸ä»ä¼ä»è¿ç¨ä»åºä¸è½½ææ°æäº¤ï¼è¿ä¼èªå¨åå¹¶å°æ¬å°åæ¯ä¸­ãå æ­¤ï¼å¦æä½ åªæ¯æ³æ¥çè¿ç¨æ´æ°ï¼èä¸æ³ç«å³åå¹¶å°æ¬å°åæ¯ä¸­ï¼å»ºè®®ä½¿ç¨git fetchï¼èä¸æ¯git pullã\n\næ»ç»æ¥è¯´ï¼git fetchågit pullçåºå«å¨äºæ¯å¦èªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãgit fetchåªä¸è½½ææ°çæäº¤ï¼ä½ä¸ä¼èªå¨åå¹¶å°æ¬å°åæ¯ä¸­ï¼ègit pullåä¼èªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ã",normalizedContent:"git pull = git fetch + git merge\n\ngit fetchågit pullé½æ¯gitçæ¬æ§å¶ç³»ç»ä¸­ç¨äºä»è¿ç¨ä»åºè·åæ´æ°çå½ä»¤ï¼ä½å®ä»¬ä¹é´æä¸äºåºå«ã\n\ngit fetchä¼ä»è¿ç¨ä»åºä¸è½½ææ°çæäº¤ï¼ä½ä¸ä¼èªå¨å°è¿äºæ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãè¿æå³çä½ å¯ä»¥å¨æ¬å°ä»åºä¸­æ¥çè¿ç¨ä»åºçæ´æ°ï¼ä½å¯ä»¥éæ©ä»ä¹æ¶åå°è¿äºæ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãä½¿ç¨git fetchåï¼éè¦æå¨ä½¿ç¨git mergeægit rebaseå°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ã\n\ngit pullåä¼å¨è¿è¡git fetchå½ä»¤ä¹åèªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãè¿æå³çgit pullå½ä»¤ä¸ä»ä¼ä»è¿ç¨ä»åºä¸è½½ææ°æäº¤ï¼è¿ä¼èªå¨åå¹¶å°æ¬å°åæ¯ä¸­ãå æ­¤ï¼å¦æä½ åªæ¯æ³æ¥çè¿ç¨æ´æ°ï¼èä¸æ³ç«å³åå¹¶å°æ¬å°åæ¯ä¸­ï¼å»ºè®®ä½¿ç¨git fetchï¼èä¸æ¯git pullã\n\næ»ç»æ¥è¯´ï¼git fetchågit pullçåºå«å¨äºæ¯å¦èªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ãgit fetchåªä¸è½½ææ°çæäº¤ï¼ä½ä¸ä¼èªå¨åå¹¶å°æ¬å°åæ¯ä¸­ï¼ègit pullåä¼èªå¨å°è¿ç¨æ´æ°åå¹¶å°æ¬å°åæ¯ä¸­ã",charsets:{cjk:!0}},{title:"åä¾æ¨¡å¼",frontmatter:{title:"åä¾æ¨¡å¼",date:"2023-04-21T22:36:28.000Z",permalink:"/pages/c02964/"},regularPath:"/11.%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/01.%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html",relativePath:"11. è®¾è®¡æ¨¡å¼/01.åä¾æ¨¡å¼.md",key:"v-ea66ad78",path:"/pages/c02964/",headersStr:null,content:"åä¾æ¨¡å¼çä¸»è¦ä½ç¨æ¯ç¡®ä¿å¨ä¸ä¸ªè¿ç¨ä¸­åªæä¸ä¸ªå®ä¾ï¼å¯¹è±¡ï¼è¢«åå»ºåä½¿ç¨ãé¿åèµæºçæµªè´¹åå²çªï¼æé«ç³»ç»çæ§è½åç¨³å®æ§ã\n\nä¼ç¹ï¼\n\n 1. åä¾æ¨¡å¼å¯ä»¥ä¿è¯å¨ä¸ä¸ªè¿ç¨ä¸­åªæä¸ä¸ªå®ä¾è¢«åå»ºï¼é¿åäºèµæºçæµªè´¹åå²çªã\n 2. åä¾æ¨¡å¼å¯ä»¥æé«ç³»ç»çæ§è½åç¨³å®æ§ãç±äºåä¾æ¨¡å¼åªåå»ºä¸ä¸ªå®ä¾ï¼å¯ä»¥åå°å¯¹è±¡çåå»ºåéæ¯ï¼éä½ç³»ç»çå¼éãåæ¶ï¼ç±äºåä¾æ¨¡å¼åªæä¸ä¸ªå®ä¾ï¼å¯ä»¥é¿åå¤ä¸ªå®ä¾ä¹é´çç«äºåå²çªï¼æé«ç³»ç»çç¨³å®æ§ã\n 3. åä¾æ¨¡å¼å¯ä»¥æé«ä»£ç çå¯ç»´æ¤æ§åå¯æ©å±æ§ãç±äºåä¾æ¨¡å¼å°å¯¹è±¡çåå»ºåç®¡çéä¸­å¨ä¸ä¸ªç±»ä¸­ï¼å¯ä»¥æ¹ä¾¿å°å¯¹åä¾å¯¹è±¡è¿è¡ç»ä¸çç®¡çåç»´æ¤ãåæ¶ï¼ç±äºåä¾æ¨¡å¼åªæä¸ä¸ªå®ä¾ï¼å¯ä»¥æ¹ä¾¿å°å¯¹å®ä¾è¿è¡æ©å±ååçº§ã\n 4. åä¾æ¨¡å¼å¯ä»¥æé«ä»£ç çå¤ç¨æ§ãç±äºåä¾æ¨¡å¼åªåå»ºä¸ä¸ªå®ä¾ï¼å¯ä»¥å¨ä¸åçæ¨¡ååç±»ä¸­æ¹ä¾¿å°å±äº«åä¾å¯¹è±¡ï¼æé«ä»£ç çå¤ç¨æ§ã\n\nåºç¨åºæ¯ï¼\n\n 1. èµæºå±äº«ï¼æäºèµæºåªéè¦è¢«åå»ºä¸æ¬¡ï¼ä¾å¦çº¿ç¨æ± ãæ°æ®åºè¿æ¥æ± ç­ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿åªæä¸ä¸ªå®ä¾è¢«åå»ºï¼é¿åèµæºçæµªè´¹åå²çªã\n 2. éç½®ä¿¡æ¯ï¼æäºéç½®ä¿¡æ¯åªéè¦è¢«è¯»åä¸æ¬¡ï¼ä¾å¦ç³»ç»éç½®ãæ¥å¿éç½®ç­ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿éç½®ä¿¡æ¯åªè¢«è¯»åä¸æ¬¡ï¼æé«ç³»ç»æ§è½ã\n 3. æ¥å¿å¯¹è±¡ï¼ç±äºæ¥å¿å¯¹è±¡éè¦é¢ç¹å°è¢«è°ç¨ï¼å¦ææ¯æ¬¡é½åå»ºæ°çå¯¹è±¡ï¼å°ä¼å½±åç³»ç»æ§è½ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿åªæä¸ä¸ªæ¥å¿å¯¹è±¡è¢«åå»ºï¼æé«ç³»ç»æ§è½ã\n 4. çº¿ç¨æ± ï¼çº¿ç¨æ± æ¯å¤çº¿ç¨ç¼ç¨ä¸­éå¸¸å¸¸è§çä¸ç§ææ¯ï¼å®å¯ä»¥æé«ç³»ç»çå¹¶åè½åï¼é¿åçº¿ç¨çé¢ç¹åå»ºåéæ¯ãéç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿çº¿ç¨æ± åªè¢«åå»ºä¸æ¬¡ï¼é¿åèµæºçæµªè´¹ã\n\n// ä½¿ç¨ synchronized åéæ ¡éªéçæ¹æ³å®ç°åä¾æ¨¡å¼\npublic class Singleton {\n  private volatile static Singleton instance;\n  private Singleton(){}\n  public static Singleton getInstance() {\n    if (instance == null) {\n      synchronized(Singleton.class) {\n        if (instance == null) instance = new Singleton();\n      }\n    }\n    return instance;\n  }\n}\n\n\nå¦å¤ï¼éè¦æ³¨æ instance éç¨ volatile å³é®å­ä¿®é¥°ä¹æ¯å¾æå¿è¦ã å ä¸º instance = new Singleton(); è¿æ®µä»£ç å¶å®æ¯åä¸ºä¸æ­¥æ§è¡ï¼\n\n 1. ä¸º instance åéåå­ç©ºé´\n 2. åå§å instance\n 3. å° instance æååéçåå­å°å\n\nä½æ¯ç±äº JVM å·ææä»¤éæçç¹æ§ï¼æ§è¡é¡ºåºæå¯è½åæ 1 -> 3 -> 2ãæä»¤éæå¨åçº¿ç¨ç¯å¢ä¸ä¸ä¼åºç°é®é¢ï¼ä½æ¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¼å¯¼è´ä¸ä¸ªçº¿ç¨è·å¾è¿æ²¡æåå§åçå®ä¾ãä¾å¦ï¼çº¿ç¨ T1 æ§è¡äº 1 å 3ï¼æ­¤æ¶ T2 è°ç¨ getInstance() ååç° instance ä¸ä¸ºç©ºï¼å æ­¤è¿å instanceï¼ä½æ­¤æ¶ instance è¿æªè¢«åå§åã\n\nä½¿ç¨ volatile å¯ä»¥ç¦æ­¢ JVM çæä»¤éæï¼ä¿è¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¹è½æ­£å¸¸è¿è¡ã\n\nåä¾æ¨¡å¼ä¸­volatileå³é®å­å¼åçæè:\n\nhttp://www.imooc.com/article/276841\n\nç»è®ºï¼\n\nå¦ææä»¬ä½¿ç¨ä¸ä¸ªåºäºç´æ¥è®¿é®å¯¹è±¡çç¼è¯å¨ï¼å¦HotSpoté»è®¤ç¼è¯å¨ï¼ï¼ä¸å volatileå³é®å­ä¹ä¸ä¼åºç°é®é¢ã\n\nå¦ææä»¬ä½¿ç¨ä¸ä¸ªåºäºå¥ææ¹å¼è®¿é®å¯¹è±¡çç¼è¯å¨ï¼å¦Symantec JITï¼ï¼ä¸å volatileå³é®å­å¯è½ä¼å¯¼è´éæåºï¼è¿åä¸ä¸ªæªåå§åå®æçå®ä¾ã\n\n> ç½ä¸æäººè¯´ï¼è¿ç§å®ç°æ¹å¼æäºé®é¢ãå ä¸ºæä»¤éæåºï¼å¯è½ä¼å¯¼è´ IdGenerator å¯¹è±¡è¢« new åºæ¥ï¼å¹¶ä¸èµå¼ç» instance ä¹åï¼è¿æ²¡æ¥å¾ååå§åï¼æ§è¡æé å½æ°ä¸­çä»£ç é»è¾ï¼ï¼å°±è¢«å¦ä¸ä¸ªçº¿ç¨ä½¿ç¨äºã\n> \n> è¦è§£å³è¿ä¸ªé®é¢ï¼æä»¬éè¦ç» instance æååéå ä¸ volatile å³é®å­ï¼ç¦æ­¢æä»¤éæåºæè¡ãå®éä¸ï¼åªæå¾ä½çæ¬ç Java æä¼æè¿ä¸ªé®é¢ãæä»¬ç°å¨ç¨çé«çæ¬ç Java å·²ç»å¨ JDK åé¨å®ç°ä¸­è§£å³äºè¿ä¸ªé®é¢ï¼è§£å³çæ¹æ³å¾ç®åï¼åªè¦æå¯¹è±¡ new æä½ååå§åæä½è®¾è®¡ä¸ºåå­æä½ï¼å°±èªç¶è½ç¦æ­¢éæåºï¼ã\n\nä¼¼ä¹jdk8å·²ç»ç¡®ä¿newãåå§åä¸ºåå­æ§æä½ï¼ä¸ä¼åºç°JITå¯¼è´æä»¤éæçæåµã\n\n----------------------------------------\n\n//éæåé¨ç±»\npublic class Singleton {\n  private Singleton(){}\n  private static class SingletonHolder {\n    private static final Singleton instance = new Singleton();\n  }\n  \n  public static Singleton getInstance() {\n    return SingletonHolder.instance;\n  }\n}\n",normalizedContent:"åä¾æ¨¡å¼çä¸»è¦ä½ç¨æ¯ç¡®ä¿å¨ä¸ä¸ªè¿ç¨ä¸­åªæä¸ä¸ªå®ä¾ï¼å¯¹è±¡ï¼è¢«åå»ºåä½¿ç¨ãé¿åèµæºçæµªè´¹åå²çªï¼æé«ç³»ç»çæ§è½åç¨³å®æ§ã\n\nä¼ç¹ï¼\n\n 1. åä¾æ¨¡å¼å¯ä»¥ä¿è¯å¨ä¸ä¸ªè¿ç¨ä¸­åªæä¸ä¸ªå®ä¾è¢«åå»ºï¼é¿åäºèµæºçæµªè´¹åå²çªã\n 2. åä¾æ¨¡å¼å¯ä»¥æé«ç³»ç»çæ§è½åç¨³å®æ§ãç±äºåä¾æ¨¡å¼åªåå»ºä¸ä¸ªå®ä¾ï¼å¯ä»¥åå°å¯¹è±¡çåå»ºåéæ¯ï¼éä½ç³»ç»çå¼éãåæ¶ï¼ç±äºåä¾æ¨¡å¼åªæä¸ä¸ªå®ä¾ï¼å¯ä»¥é¿åå¤ä¸ªå®ä¾ä¹é´çç«äºåå²çªï¼æé«ç³»ç»çç¨³å®æ§ã\n 3. åä¾æ¨¡å¼å¯ä»¥æé«ä»£ç çå¯ç»´æ¤æ§åå¯æ©å±æ§ãç±äºåä¾æ¨¡å¼å°å¯¹è±¡çåå»ºåç®¡çéä¸­å¨ä¸ä¸ªç±»ä¸­ï¼å¯ä»¥æ¹ä¾¿å°å¯¹åä¾å¯¹è±¡è¿è¡ç»ä¸çç®¡çåç»´æ¤ãåæ¶ï¼ç±äºåä¾æ¨¡å¼åªæä¸ä¸ªå®ä¾ï¼å¯ä»¥æ¹ä¾¿å°å¯¹å®ä¾è¿è¡æ©å±ååçº§ã\n 4. åä¾æ¨¡å¼å¯ä»¥æé«ä»£ç çå¤ç¨æ§ãç±äºåä¾æ¨¡å¼åªåå»ºä¸ä¸ªå®ä¾ï¼å¯ä»¥å¨ä¸åçæ¨¡ååç±»ä¸­æ¹ä¾¿å°å±äº«åä¾å¯¹è±¡ï¼æé«ä»£ç çå¤ç¨æ§ã\n\nåºç¨åºæ¯ï¼\n\n 1. èµæºå±äº«ï¼æäºèµæºåªéè¦è¢«åå»ºä¸æ¬¡ï¼ä¾å¦çº¿ç¨æ± ãæ°æ®åºè¿æ¥æ± ç­ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿åªæä¸ä¸ªå®ä¾è¢«åå»ºï¼é¿åèµæºçæµªè´¹åå²çªã\n 2. éç½®ä¿¡æ¯ï¼æäºéç½®ä¿¡æ¯åªéè¦è¢«è¯»åä¸æ¬¡ï¼ä¾å¦ç³»ç»éç½®ãæ¥å¿éç½®ç­ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿éç½®ä¿¡æ¯åªè¢«è¯»åä¸æ¬¡ï¼æé«ç³»ç»æ§è½ã\n 3. æ¥å¿å¯¹è±¡ï¼ç±äºæ¥å¿å¯¹è±¡éè¦é¢ç¹å°è¢«è°ç¨ï¼å¦ææ¯æ¬¡é½åå»ºæ°çå¯¹è±¡ï¼å°ä¼å½±åç³»ç»æ§è½ï¼éç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿åªæä¸ä¸ªæ¥å¿å¯¹è±¡è¢«åå»ºï¼æé«ç³»ç»æ§è½ã\n 4. çº¿ç¨æ± ï¼çº¿ç¨æ± æ¯å¤çº¿ç¨ç¼ç¨ä¸­éå¸¸å¸¸è§çä¸ç§ææ¯ï¼å®å¯ä»¥æé«ç³»ç»çå¹¶åè½åï¼é¿åçº¿ç¨çé¢ç¹åå»ºåéæ¯ãéç¨åä¾æ¨¡å¼å¯ä»¥ç¡®ä¿çº¿ç¨æ± åªè¢«åå»ºä¸æ¬¡ï¼é¿åèµæºçæµªè´¹ã\n\n// ä½¿ç¨ synchronized åéæ ¡éªéçæ¹æ³å®ç°åä¾æ¨¡å¼\npublic class singleton {\n  private volatile static singleton instance;\n  private singleton(){}\n  public static singleton getinstance() {\n    if (instance == null) {\n      synchronized(singleton.class) {\n        if (instance == null) instance = new singleton();\n      }\n    }\n    return instance;\n  }\n}\n\n\nå¦å¤ï¼éè¦æ³¨æ instance éç¨ volatile å³é®å­ä¿®é¥°ä¹æ¯å¾æå¿è¦ã å ä¸º instance = new singleton(); è¿æ®µä»£ç å¶å®æ¯åä¸ºä¸æ­¥æ§è¡ï¼\n\n 1. ä¸º instance åéåå­ç©ºé´\n 2. åå§å instance\n 3. å° instance æååéçåå­å°å\n\nä½æ¯ç±äº jvm å·ææä»¤éæçç¹æ§ï¼æ§è¡é¡ºåºæå¯è½åæ 1 -> 3 -> 2ãæä»¤éæå¨åçº¿ç¨ç¯å¢ä¸ä¸ä¼åºç°é®é¢ï¼ä½æ¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¼å¯¼è´ä¸ä¸ªçº¿ç¨è·å¾è¿æ²¡æåå§åçå®ä¾ãä¾å¦ï¼çº¿ç¨ t1 æ§è¡äº 1 å 3ï¼æ­¤æ¶ t2 è°ç¨ getinstance() ååç° instance ä¸ä¸ºç©ºï¼å æ­¤è¿å instanceï¼ä½æ­¤æ¶ instance è¿æªè¢«åå§åã\n\nä½¿ç¨ volatile å¯ä»¥ç¦æ­¢ jvm çæä»¤éæï¼ä¿è¯å¨å¤çº¿ç¨ç¯å¢ä¸ä¹è½æ­£å¸¸è¿è¡ã\n\nåä¾æ¨¡å¼ä¸­volatileå³é®å­å¼åçæè:\n\nhttp://www.imooc.com/article/276841\n\nç»è®ºï¼\n\nå¦ææä»¬ä½¿ç¨ä¸ä¸ªåºäºç´æ¥è®¿é®å¯¹è±¡çç¼è¯å¨ï¼å¦hotspoté»è®¤ç¼è¯å¨ï¼ï¼ä¸å volatileå³é®å­ä¹ä¸ä¼åºç°é®é¢ã\n\nå¦ææä»¬ä½¿ç¨ä¸ä¸ªåºäºå¥ææ¹å¼è®¿é®å¯¹è±¡çç¼è¯å¨ï¼å¦symantec jitï¼ï¼ä¸å volatileå³é®å­å¯è½ä¼å¯¼è´éæåºï¼è¿åä¸ä¸ªæªåå§åå®æçå®ä¾ã\n\n> ç½ä¸æäººè¯´ï¼è¿ç§å®ç°æ¹å¼æäºé®é¢ãå ä¸ºæä»¤éæåºï¼å¯è½ä¼å¯¼è´ idgenerator å¯¹è±¡è¢« new åºæ¥ï¼å¹¶ä¸èµå¼ç» instance ä¹åï¼è¿æ²¡æ¥å¾ååå§åï¼æ§è¡æé å½æ°ä¸­çä»£ç é»è¾ï¼ï¼å°±è¢«å¦ä¸ä¸ªçº¿ç¨ä½¿ç¨äºã\n> \n> è¦è§£å³è¿ä¸ªé®é¢ï¼æä»¬éè¦ç» instance æååéå ä¸ volatile å³é®å­ï¼ç¦æ­¢æä»¤éæåºæè¡ãå®éä¸ï¼åªæå¾ä½çæ¬ç java æä¼æè¿ä¸ªé®é¢ãæä»¬ç°å¨ç¨çé«çæ¬ç java å·²ç»å¨ jdk åé¨å®ç°ä¸­è§£å³äºè¿ä¸ªé®é¢ï¼è§£å³çæ¹æ³å¾ç®åï¼åªè¦æå¯¹è±¡ new æä½ååå§åæä½è®¾è®¡ä¸ºåå­æä½ï¼å°±èªç¶è½ç¦æ­¢éæåºï¼ã\n\nä¼¼ä¹jdk8å·²ç»ç¡®ä¿newãåå§åä¸ºåå­æ§æä½ï¼ä¸ä¼åºç°jitå¯¼è´æä»¤éæçæåµã\n\n----------------------------------------\n\n//éæåé¨ç±»\npublic class singleton {\n  private singleton(){}\n  private static class singletonholder {\n    private static final singleton instance = new singleton();\n  }\n  \n  public static singleton getinstance() {\n    return singletonholder.instance;\n  }\n}\n",charsets:{cjk:!0}},{title:"Dockerå½ä»¤",frontmatter:{title:"Dockerå½ä»¤",date:"2023-03-30T13:34:56.000Z",permalink:"/pages/aa154b/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/03.Docker/01.Docker%E5%91%BD%E4%BB%A4.html",relativePath:"100.å·¥å·/03.Docker/01.Dockerå½ä»¤.md",key:"v-2ede7bc6",path:"/pages/aa154b/",headers:[{level:2,title:"dockerå½ä»¤æ»ç»",slug:"dockerå½ä»¤æ»ç»",normalizedTitle:"dockerå½ä»¤æ»ç»",charIndex:2},{level:2,title:"docker run",slug:"docker-run",normalizedTitle:"docker run",charIndex:76},{level:2,title:"demo: dockerå¯å¨redis",slug:"demo-dockerå¯å¨redis",normalizedTitle:"demo: dockerå¯å¨redis",charIndex:437}],headersStr:"dockerå½ä»¤æ»ç» docker run demo: dockerå¯å¨redis",content:"# dockerå½ä»¤æ»ç»\n\ndocker images //æ¥çéå\n\ndocker pull elasticsearch:5.6.8 //ä¸è½½éå\n\ndocker run âdi ââname=tensquare_elasticsearch âp 9200:9200 âp 9300:9300 elasticsearch:5.6.8 //åå»ºå®¹å¨\n\ndocker ps //æ¥çå·²å¯å¨å®¹å¨\n\ndocker ps -a//æ¥çææå®¹å¨\n\ndocker exec âit tensquare_elasticsearch /bin/bash //è¿å¥å®¹å¨\n\ndocker cp ik tensquare_elasticsearch:/usr/share/elasticsearch/plugins/ //æ·è´æä»¶å°å®¹å¨ä¸­\n\ndocker start id //å¯å¨ä¸ä¸ªå·²åæ­¢çå®¹å¨\n\n\n# docker run\n\n-i: äº¤äºå¼æä½\n\n-t: ç»ç«¯\n\n-d: åå°è¿è¡\n\n\n# demo: dockerå¯å¨redis\n\n 1. docker search redis\n 2. docker pull redis:latest\n 3. docker images\n 4. docker run -itd --name redis-test -p 6379:6379 redis\n 5. docker ps\n 6. docker exec -it redis-test /bin/bash",normalizedContent:"# dockerå½ä»¤æ»ç»\n\ndocker images //æ¥çéå\n\ndocker pull elasticsearch:5.6.8 //ä¸è½½éå\n\ndocker run âdi ââname=tensquare_elasticsearch âp 9200:9200 âp 9300:9300 elasticsearch:5.6.8 //åå»ºå®¹å¨\n\ndocker ps //æ¥çå·²å¯å¨å®¹å¨\n\ndocker ps -a//æ¥çææå®¹å¨\n\ndocker exec âit tensquare_elasticsearch /bin/bash //è¿å¥å®¹å¨\n\ndocker cp ik tensquare_elasticsearch:/usr/share/elasticsearch/plugins/ //æ·è´æä»¶å°å®¹å¨ä¸­\n\ndocker start id //å¯å¨ä¸ä¸ªå·²åæ­¢çå®¹å¨\n\n\n# docker run\n\n-i: äº¤äºå¼æä½\n\n-t: ç»ç«¯\n\n-d: åå°è¿è¡\n\n\n# demo: dockerå¯å¨redis\n\n 1. docker search redis\n 2. docker pull redis:latest\n 3. docker images\n 4. docker run -itd --name redis-test -p 6379:6379 redis\n 5. docker ps\n 6. docker exec -it redis-test /bin/bash",charsets:{cjk:!0}},{title:"Linuxå½ä»¤",frontmatter:{title:"Linuxå½ä»¤",date:"2023-03-31T17:32:08.000Z",permalink:"/pages/d3d9ca/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/02.Linux/02.Linux%E5%91%BD%E4%BB%A4.html",relativePath:"100.å·¥å·/02.Linux/02.Linuxå½ä»¤.md",key:"v-165dc3de",path:"/pages/d3d9ca/",headers:[{level:2,title:"ç»è®¡è¯é¢",slug:"ç»è®¡è¯é¢",normalizedTitle:"ç»è®¡è¯é¢",charIndex:2},{level:2,title:"æ­£åè¡¨è¾¾å¼",slug:"æ­£åè¡¨è¾¾å¼",normalizedTitle:"æ­£åè¡¨è¾¾å¼",charIndex:173},{level:2,title:"æ¥çç£çç©ºé´",slug:"æ¥çç£çç©ºé´",normalizedTitle:"æ¥çç£çç©ºé´",charIndex:392},{level:3,title:"æ¥çç£çæ´ä½æåµï¼åæ¬ç£çå¤§å°ï¼å·²ä½¿ç¨ï¼å¯ç¨ã",slug:"æ¥çç£çæ´ä½æåµ-åæ¬ç£çå¤§å°-å·²ä½¿ç¨-å¯ç¨ã",normalizedTitle:"æ¥çç£çæ´ä½æåµï¼åæ¬ç£çå¤§å°ï¼å·²ä½¿ç¨ï¼å¯ç¨ã",charIndex:504},{level:3,title:"è®¡ç®æä»¶å¤¹å¤§å°",slug:"è®¡ç®æä»¶å¤¹å¤§å°",normalizedTitle:"è®¡ç®æä»¶å¤¹å¤§å°",charIndex:557},{level:3,title:"ç®å½æä»¶ä»¶å ç¨è¯¦æ",slug:"ç®å½æä»¶ä»¶å ç¨è¯¦æ",normalizedTitle:"ç®å½æä»¶ä»¶å ç¨è¯¦æ",charIndex:596},{level:2,title:"æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯",slug:"æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯",normalizedTitle:"æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯",charIndex:663}],headersStr:"ç»è®¡è¯é¢ æ­£åè¡¨è¾¾å¼ æ¥çç£çç©ºé´ æ¥çç£çæ´ä½æåµï¼åæ¬ç£çå¤§å°ï¼å·²ä½¿ç¨ï¼å¯ç¨ã è®¡ç®æä»¶å¤¹å¤§å° ç®å½æä»¶ä»¶å ç¨è¯¦æ æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯",content:"# ç»è®¡è¯é¢\n\ncat words.txt | tr -s \" \" \"\\n\" | sort | uniq -c | sort -r | awk '{print $2, $1}'\n\n\ncat words.txt | xargs -n 1 | sort | uniq -c | sort -r | awk '{print $2, $1}'\n\n\n\n# æ­£åè¡¨è¾¾å¼\n\n * ^ å¼å§\n * $ ç»æ\n * [0-9] å¹éæ°å­\n * | æè\n * () å­è¡¨è¾¾å¼\n * . å¹éé¤æ¢è¡ç¬¦\\nä¹å¤çä»»ä½åå­ç¬¦\n * \\ ç¨äºè½¬ä¹\n\néå®ç¬¦ï¼è¡¨ç¤ºéå®ç¬¦åé¢å­ç¬¦åºç°çæ¬¡æ°ï¼\n\n * * åºç°æ¬¡æ°>=0\n * + åºç°æ¬¡æ°>=1\n * ? åºç°æ¬¡æ° 0 or 1, ç­ä»·{0,1}\n * {n} åºç°æ¬¡æ°=n\n * {n,} åºç°æ¬¡æ°>=n\n * {n, m} n=< åºç°æ¬¡æ°<= m\n\n\n# æ¥çç£çç©ºé´\n\ndf: disk free\n\ndu: disk usage\n\n-h, --human-readable ä½¿ç¨äººç±»å¯è¯»çæ ¼å¼(é¢è®¾å¼æ¯ä¸å è¿ä¸ªéé¡¹ç...) -sæ--summarize ä»æ¾ç¤ºæ»è®¡ã\n\n\n# æ¥çç£çæ´ä½æåµï¼åæ¬ç£çå¤§å°ï¼å·²ä½¿ç¨ï¼å¯ç¨ã\n\n * df -h\n * df -h /usr/\n\n\n# è®¡ç®æä»¶å¤¹å¤§å°\n\n * du -sh\n * du -sh /usr/\n\n\n# ç®å½æä»¶ä»¶å ç¨è¯¦æ\n\n * du --max-depth=1 -h\n * du --max-depth=1 -h /usr/\n\n\n# æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯\n\n * ll /proc/pid",normalizedContent:"# ç»è®¡è¯é¢\n\ncat words.txt | tr -s \" \" \"\\n\" | sort | uniq -c | sort -r | awk '{print $2, $1}'\n\n\ncat words.txt | xargs -n 1 | sort | uniq -c | sort -r | awk '{print $2, $1}'\n\n\n\n# æ­£åè¡¨è¾¾å¼\n\n * ^ å¼å§\n * $ ç»æ\n * [0-9] å¹éæ°å­\n * | æè\n * () å­è¡¨è¾¾å¼\n * . å¹éé¤æ¢è¡ç¬¦\\nä¹å¤çä»»ä½åå­ç¬¦\n * \\ ç¨äºè½¬ä¹\n\néå®ç¬¦ï¼è¡¨ç¤ºéå®ç¬¦åé¢å­ç¬¦åºç°çæ¬¡æ°ï¼\n\n * * åºç°æ¬¡æ°>=0\n * + åºç°æ¬¡æ°>=1\n * ? åºç°æ¬¡æ° 0 or 1, ç­ä»·{0,1}\n * {n} åºç°æ¬¡æ°=n\n * {n,} åºç°æ¬¡æ°>=n\n * {n, m} n=< åºç°æ¬¡æ°<= m\n\n\n# æ¥çç£çç©ºé´\n\ndf: disk free\n\ndu: disk usage\n\n-h, --human-readable ä½¿ç¨äººç±»å¯è¯»çæ ¼å¼(é¢è®¾å¼æ¯ä¸å è¿ä¸ªéé¡¹ç...) -sæ--summarize ä»æ¾ç¤ºæ»è®¡ã\n\n\n# æ¥çç£çæ´ä½æåµï¼åæ¬ç£çå¤§å°ï¼å·²ä½¿ç¨ï¼å¯ç¨ã\n\n * df -h\n * df -h /usr/\n\n\n# è®¡ç®æä»¶å¤¹å¤§å°\n\n * du -sh\n * du -sh /usr/\n\n\n# ç®å½æä»¶ä»¶å ç¨è¯¦æ\n\n * du --max-depth=1 -h\n * du --max-depth=1 -h /usr/\n\n\n# æ ¹æ®pidæ¥çè¿ç¨ä¿¡æ¯\n\n * ll /proc/pid",charsets:{cjk:!0}},{title:"å·¥åæ¨¡å¼",frontmatter:{title:"å·¥åæ¨¡å¼",date:"2023-09-08T00:48:05.000Z",permalink:"/pages/da6600/"},regularPath:"/11.%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/02.%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html",relativePath:"11. è®¾è®¡æ¨¡å¼/02.å·¥åæ¨¡å¼.md",key:"v-5798a127",path:"/pages/da6600/",headers:[{level:2,title:"åºç¨åºæ¯ï¼ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼ï¼",slug:"åºç¨åºæ¯-ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼",normalizedTitle:"åºç¨åºæ¯ï¼ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼ï¼",charIndex:2},{level:2,title:"å·¥åæ¨¡å¼çä¼ç¹ï¼",slug:"å·¥åæ¨¡å¼çä¼ç¹",normalizedTitle:"å·¥åæ¨¡å¼çä¼ç¹ï¼",charIndex:123},{level:2,title:"å·¥åæ¨¡å¼åç±»ï¼",slug:"å·¥åæ¨¡å¼åç±»",normalizedTitle:"å·¥åæ¨¡å¼åç±»ï¼",charIndex:171},{level:2,title:"ä»£ç ",slug:"ä»£ç ",normalizedTitle:"ä»£ç ",charIndex:63},{level:2,title:"å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«ï¼",slug:"å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«",normalizedTitle:"å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«ï¼",charIndex:2036},{level:2,title:"spring ä½¿ç¨å°çå·¥åæ¨¡å¼",slug:"spring-ä½¿ç¨å°çå·¥åæ¨¡å¼",normalizedTitle:"spring ä½¿ç¨å°çå·¥åæ¨¡å¼",charIndex:2208},{level:2,title:"DIå®¹å¨çæ ¸å¿åè½",slug:"diå®¹å¨çæ ¸å¿åè½",normalizedTitle:"diå®¹å¨çæ ¸å¿åè½",charIndex:2278},{level:2,title:"BeansFactoryä¸­çcreateBean()æ¯ä¸ä¸ªéå½å½æ°ï¼å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",slug:"beansfactoryä¸­çcreatebean-æ¯ä¸ä¸ªéå½å½æ°-å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",normalizedTitle:"beansfactoryä¸­çcreatebean()æ¯ä¸ä¸ªéå½å½æ°ï¼å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",charIndex:2440}],headersStr:"åºç¨åºæ¯ï¼ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼ï¼ å·¥åæ¨¡å¼çä¼ç¹ï¼ å·¥åæ¨¡å¼åç±»ï¼ ä»£ç  å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«ï¼ spring ä½¿ç¨å°çå·¥åæ¨¡å¼ DIå®¹å¨çæ ¸å¿åè½ BeansFactoryä¸­çcreateBean()æ¯ä¸ä¸ªéå½å½æ°ï¼å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢",content:'# åºç¨åºæ¯ï¼ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼ï¼\n\nå¦æåå»ºå¯¹è±¡é»è¾ä¸å¤æï¼ç´æ¥ç¨newå³å¯ãåå»ºé»è¾å¤æçæåµï¼\n\n * ç±»ä¼¼è§åå¹éï¼ä»£ç ä¸­å­å¨if-elseï¼å¨æçæ ¹æ®ä¸åçç±»ååå»ºä¸åçå¯¹è±¡ã\n * åä¸ªå¯¹è±¡æ¬èº«åå»ºå¤æï¼åç§ç»åï¼åå§åã\n\n\n# å·¥åæ¨¡å¼çä¼ç¹ï¼\n\n * å°è£åå\n * ä»£ç å¤ç¨\n * éç¦»å¤ææ§\n * æ§å¶å¤æåº¦\n\n\n# å·¥åæ¨¡å¼åç±»ï¼\n\n * ç®åå·¥åï¼Simple Factoryï¼ï¼ä¹å«éæå·¥åæ¹æ³ã\n   * æå¯¹è±¡çåå»ºé»è¾ç¬ç«æä¸ä¸ªå·¥åç±»ã\n   * å¦æå¯¹è±¡å¯å¤ç¨ï¼å¯ç¨mapå°å¶ç¼å­èµ·æ¥ã\n * å·¥åæ¹æ³ï¼Factory Methodï¼ï¼å°ifé»è¾å»é¤ï¼å©ç¨å¤æãä½ä½¿ç¨æ¶å¯è½åæè®¸å¤if-elseï¼å æ­¤å¯ä»¥ä¸ºå·¥åç±»ååå»ºä¸ä¸ªç®åå·¥åï¼å·¥åçå·¥åï¼ç¨æ¥åå»ºå·¥åç±»å¯¹è±¡ã\n * æ½è±¡å·¥åï¼Abstract Factoryï¼ï¼å¤æï¼ä¸å¸¸ç¨ãè®©ä¸ä¸ªå·¥åè´è´£åå»ºå¤ä¸ªä¸åçç±»åå¯¹è±¡ã\n\nå¤æåº¦æ æ³è¢«æ¶é¤ï¼åªè½è¢«è½¬ç§»ï¼\n\n * ä¸ç¨å·¥åæ¨¡å¼ï¼if-else é»è¾ãåå»ºé»è¾åä¸å¡ä»£ç è¦åå¨ä¸èµ·\n * ç®åå·¥åæ¯å°ä¸ååå»ºé»è¾æ¾å°ä¸ä¸ªå·¥åç±»ä¸­ï¼if-else é»è¾å¨è¿ä¸ªå·¥åç±»ä¸­\n * å·¥åæ¹æ³æ¯å°ä¸ååå»ºé»è¾æ¾å°ä¸åå·¥åç±»ä¸­ï¼åç¨ä¸ä¸ªå·¥åç±»çå·¥åæ¥å¾å°æä¸ªå·¥åï¼åç¨è¿ä¸ªå·¥åæ¥åå»ºï¼if-else é»è¾å¨å·¥åç±»çå·¥åä¸­\n\n\n# ä»£ç \n\n//ç®åå·¥åæ¨¡å¼ï¼æ¹æ³1\npublic class RuleConfigParserFactory {\n  public static IRuleConfigParser createParser(String configFormat) {\n    IRuleConfigParser parser = null;\n    if ("json".equalsIgnoreCase(configFormat)) {\n      parser = new JsonRuleConfigParser();\n    } else if ("xml".equalsIgnoreCase(configFormat)) {\n      parser = new XmlRuleConfigParser();\n    }...\n    return parser;\n  }\n}\n\n////ç®åå·¥åæ¨¡å¼ï¼æ¹æ³2ï¼å¯¹è±¡å¯å¤ç¨æ¶ï¼å»é¤äºif-elseï¼\npublic class RuleConfigParserFactory {\n  private static final Map<String, RuleConfigParser> cachedParsers = new HashMap<>();\n  static {\n    cachedParsers.put("json", new JsonRuleConfigParser());\n    cachedParsers.put("xml", new XmlRuleConfigParser());\n    ...\n  }\n  public static IRuleConfigParser createParser(String configFormat) {\n    IRuleConfigParser parser = cachedParsers.get(configFormat);\n    return parser;\n  }\n}\n\n\n//å·¥åæ¹æ³ï¼æ°å¢ä¸ç§parseræ¶ï¼åªéæ°å¢ä¸ä¸ªå®ç°çfactoryå°±è¡äºã\npublic interface IRuleConfigParserFactory {\n  IRuleConfigParser createParser();\n}\n\npublic class JsonRuleConfigParserFactory implements IRuleConfigParserFactory {\n  @Override\n  public IRuleConfigParser createParser() {\n    return new JsonRuleConfigParser();\n  }\n}\n...\n//ä½¿ç¨\npublic RuleConfig load(String fileExtension) {\n    IRuleConfigParserFactory parserFactory = null;\n    if ("json".equals(fileExtension)) {\n        parserFactory = new JsonRuleConfigParserFactory();\n    }...\n    IRuleConfigParser parser = parserFactory.createParser();\n    return parser.parse();\n}\n\n\n\n# å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«ï¼\n\nDIå®¹å¨åºå±çè®¾è®¡æè·¯å°±æ¯åºäºå·¥åæ¨¡å¼ãDIå®¹å¨ç¸å½äºä¸ä¸ªå¤§çå·¥åç±»ï¼è´è´£å¨ç¨åºå¯å¨æ¶ï¼æ ¹æ®éç½®äºååå»ºå¥½å¯¹è±¡ãå½ç¨åºéè¦ä½¿ç¨æä¸ªç±»çå¯¹è±¡æ¶ï¼ç´æ¥ä»å®¹å¨ä¸­è·åãå ä¸ºææä¸å å¯¹è±¡ï¼æç§°ä¸ºå®¹å¨ã\n\nå·¥åç±»åªè´è´£æä¸ªç±»æä¸ç»ç¸å³ç±»å¯¹è±¡çåå»ºãDIå®¹å¨è´è´£æ´ä¸ªåºç¨ä¸­ææç±»å¯¹è±¡çåå»ºï¼ä¸è´è´£çåå®¹ä¹æ¯è¾å¤ã\n\n\n# spring ä½¿ç¨å°çå·¥åæ¨¡å¼\n\nBeanFactory éç¨çæ¯ç®åå·¥åæ¨¡å¼ã\n\nFactoryBean éç¨çæ¯å·¥åæ¹æ³æ¨¡å¼ã\n\n\n# DIå®¹å¨çæ ¸å¿åè½\n\næ3ä¸ªæ ¸å¿åè½ï¼\n\n * éç½®è§£æãBeanConfigParserï¼è´è´£å°éç½®æä»¶è§£æä¸ºBeanDefinitionç»æã\n * å¯¹è±¡åå»ºãéè¿åå°æºå¶ï¼å°ææç±»å¯¹è±¡çåå»ºé½æ¾å¨ä¸ä¸ªå·¥åç±»ä¸­å®æï¼å¦BeansFactoryï¼æ ¹æ®BeanDefinitionåå»ºå¯¹è±¡ã\n * å¯¹è±¡çå½å¨æç®¡ç\n\n\n# BeansFactoryä¸­çcreateBean()æ¯ä¸ä¸ªéå½å½æ°ï¼å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢\n\nSpringè§£å³å¾ªç¯ä¾èµçåæ³æ¯å¤çº§ç¼å­ã\n\næé å¨åå§åæ¹å¼ï¼æ æ³è§£å³å¾ªç¯ä¾èµ\n\nsetæ³¨å¥æ¹å¼åå§åï¼æä¸¤ç§:\n\n * ç¬¬ä¸ç§ï¼åå»ºçæ¯åä¾å¯¹è±¡ï¼å¯ä»¥è§£å³ã\n * ç¬¬äºç§ï¼åå»ºçæ¯ååå¯¹è±¡ï¼ç±äºDIå®¹å¨ä¸ç¼å­å¯¹è±¡å¯¼è´æ æ³æåæ´é²ä¸ä¸ªåå»ºä¸­çå¯¹è±¡ï¼ææ æ³è§£å³ã',normalizedContent:'# åºç¨åºæ¯ï¼ä»ä¹æ¶åè¯¥ç¨å·¥åæ¨¡å¼ï¼\n\nå¦æåå»ºå¯¹è±¡é»è¾ä¸å¤æï¼ç´æ¥ç¨newå³å¯ãåå»ºé»è¾å¤æçæåµï¼\n\n * ç±»ä¼¼è§åå¹éï¼ä»£ç ä¸­å­å¨if-elseï¼å¨æçæ ¹æ®ä¸åçç±»ååå»ºä¸åçå¯¹è±¡ã\n * åä¸ªå¯¹è±¡æ¬èº«åå»ºå¤æï¼åç§ç»åï¼åå§åã\n\n\n# å·¥åæ¨¡å¼çä¼ç¹ï¼\n\n * å°è£åå\n * ä»£ç å¤ç¨\n * éç¦»å¤ææ§\n * æ§å¶å¤æåº¦\n\n\n# å·¥åæ¨¡å¼åç±»ï¼\n\n * ç®åå·¥åï¼simple factoryï¼ï¼ä¹å«éæå·¥åæ¹æ³ã\n   * æå¯¹è±¡çåå»ºé»è¾ç¬ç«æä¸ä¸ªå·¥åç±»ã\n   * å¦æå¯¹è±¡å¯å¤ç¨ï¼å¯ç¨mapå°å¶ç¼å­èµ·æ¥ã\n * å·¥åæ¹æ³ï¼factory methodï¼ï¼å°ifé»è¾å»é¤ï¼å©ç¨å¤æãä½ä½¿ç¨æ¶å¯è½åæè®¸å¤if-elseï¼å æ­¤å¯ä»¥ä¸ºå·¥åç±»ååå»ºä¸ä¸ªç®åå·¥åï¼å·¥åçå·¥åï¼ç¨æ¥åå»ºå·¥åç±»å¯¹è±¡ã\n * æ½è±¡å·¥åï¼abstract factoryï¼ï¼å¤æï¼ä¸å¸¸ç¨ãè®©ä¸ä¸ªå·¥åè´è´£åå»ºå¤ä¸ªä¸åçç±»åå¯¹è±¡ã\n\nå¤æåº¦æ æ³è¢«æ¶é¤ï¼åªè½è¢«è½¬ç§»ï¼\n\n * ä¸ç¨å·¥åæ¨¡å¼ï¼if-else é»è¾ãåå»ºé»è¾åä¸å¡ä»£ç è¦åå¨ä¸èµ·\n * ç®åå·¥åæ¯å°ä¸ååå»ºé»è¾æ¾å°ä¸ä¸ªå·¥åç±»ä¸­ï¼if-else é»è¾å¨è¿ä¸ªå·¥åç±»ä¸­\n * å·¥åæ¹æ³æ¯å°ä¸ååå»ºé»è¾æ¾å°ä¸åå·¥åç±»ä¸­ï¼åç¨ä¸ä¸ªå·¥åç±»çå·¥åæ¥å¾å°æä¸ªå·¥åï¼åç¨è¿ä¸ªå·¥åæ¥åå»ºï¼if-else é»è¾å¨å·¥åç±»çå·¥åä¸­\n\n\n# ä»£ç \n\n//ç®åå·¥åæ¨¡å¼ï¼æ¹æ³1\npublic class ruleconfigparserfactory {\n  public static iruleconfigparser createparser(string configformat) {\n    iruleconfigparser parser = null;\n    if ("json".equalsignorecase(configformat)) {\n      parser = new jsonruleconfigparser();\n    } else if ("xml".equalsignorecase(configformat)) {\n      parser = new xmlruleconfigparser();\n    }...\n    return parser;\n  }\n}\n\n////ç®åå·¥åæ¨¡å¼ï¼æ¹æ³2ï¼å¯¹è±¡å¯å¤ç¨æ¶ï¼å»é¤äºif-elseï¼\npublic class ruleconfigparserfactory {\n  private static final map<string, ruleconfigparser> cachedparsers = new hashmap<>();\n  static {\n    cachedparsers.put("json", new jsonruleconfigparser());\n    cachedparsers.put("xml", new xmlruleconfigparser());\n    ...\n  }\n  public static iruleconfigparser createparser(string configformat) {\n    iruleconfigparser parser = cachedparsers.get(configformat);\n    return parser;\n  }\n}\n\n\n//å·¥åæ¹æ³ï¼æ°å¢ä¸ç§parseræ¶ï¼åªéæ°å¢ä¸ä¸ªå®ç°çfactoryå°±è¡äºã\npublic interface iruleconfigparserfactory {\n  iruleconfigparser createparser();\n}\n\npublic class jsonruleconfigparserfactory implements iruleconfigparserfactory {\n  @override\n  public iruleconfigparser createparser() {\n    return new jsonruleconfigparser();\n  }\n}\n...\n//ä½¿ç¨\npublic ruleconfig load(string fileextension) {\n    iruleconfigparserfactory parserfactory = null;\n    if ("json".equals(fileextension)) {\n        parserfactory = new jsonruleconfigparserfactory();\n    }...\n    iruleconfigparser parser = parserfactory.createparser();\n    return parser.parse();\n}\n\n\n\n# å·¥åæ¨¡å¼ä¸ä¾èµæ³¨å¥å®¹å¨æä½åºå«ï¼\n\ndiå®¹å¨åºå±çè®¾è®¡æè·¯å°±æ¯åºäºå·¥åæ¨¡å¼ãdiå®¹å¨ç¸å½äºä¸ä¸ªå¤§çå·¥åç±»ï¼è´è´£å¨ç¨åºå¯å¨æ¶ï¼æ ¹æ®éç½®äºååå»ºå¥½å¯¹è±¡ãå½ç¨åºéè¦ä½¿ç¨æä¸ªç±»çå¯¹è±¡æ¶ï¼ç´æ¥ä»å®¹å¨ä¸­è·åãå ä¸ºææä¸å å¯¹è±¡ï¼æç§°ä¸ºå®¹å¨ã\n\nå·¥åç±»åªè´è´£æä¸ªç±»æä¸ç»ç¸å³ç±»å¯¹è±¡çåå»ºãdiå®¹å¨è´è´£æ´ä¸ªåºç¨ä¸­ææç±»å¯¹è±¡çåå»ºï¼ä¸è´è´£çåå®¹ä¹æ¯è¾å¤ã\n\n\n# spring ä½¿ç¨å°çå·¥åæ¨¡å¼\n\nbeanfactory éç¨çæ¯ç®åå·¥åæ¨¡å¼ã\n\nfactorybean éç¨çæ¯å·¥åæ¹æ³æ¨¡å¼ã\n\n\n# diå®¹å¨çæ ¸å¿åè½\n\næ3ä¸ªæ ¸å¿åè½ï¼\n\n * éç½®è§£æãbeanconfigparserï¼è´è´£å°éç½®æä»¶è§£æä¸ºbeandefinitionç»æã\n * å¯¹è±¡åå»ºãéè¿åå°æºå¶ï¼å°ææç±»å¯¹è±¡çåå»ºé½æ¾å¨ä¸ä¸ªå·¥åç±»ä¸­å®æï¼å¦beansfactoryï¼æ ¹æ®beandefinitionåå»ºå¯¹è±¡ã\n * å¯¹è±¡çå½å¨æç®¡ç\n\n\n# beansfactoryä¸­çcreatebean()æ¯ä¸ä¸ªéå½å½æ°ï¼å¦ä½è§£å³å¾ªç¯ä¾èµé®é¢\n\nspringè§£å³å¾ªç¯ä¾èµçåæ³æ¯å¤çº§ç¼å­ã\n\næé å¨åå§åæ¹å¼ï¼æ æ³è§£å³å¾ªç¯ä¾èµ\n\nsetæ³¨å¥æ¹å¼åå§åï¼æä¸¤ç§:\n\n * ç¬¬ä¸ç§ï¼åå»ºçæ¯åä¾å¯¹è±¡ï¼å¯ä»¥è§£å³ã\n * ç¬¬äºç§ï¼åå»ºçæ¯ååå¯¹è±¡ï¼ç±äºdiå®¹å¨ä¸ç¼å­å¯¹è±¡å¯¼è´æ æ³æåæ´é²ä¸ä¸ªåå»ºä¸­çå¯¹è±¡ï¼ææ æ³è§£å³ã',charsets:{cjk:!0}},{title:"AI tools",frontmatter:{title:"AI tools",date:"2023-06-01T12:45:24.000Z",permalink:"/pages/aitools/"},regularPath:"/12.AI/01.AI%20%20tools.html",relativePath:"12.AI/01.AI  tools.md",key:"v-94d81df6",path:"/pages/aitools/",headersStr:null,content:"chatgpt\n\nchatgpt official\n\nopencat\n\nchatgpt ios client\n\nOpenAI Translator\n\nchatgpt client [open source]\n\nsnackprompt\n\npromptæ¶éç½ç«\n\nflowgpt\n\npromptæ¶éç½ç«\n\ntheresanaiforthat\n\nwebsite AI aggregator\n\n- name: chatgpt\n  desc: chatgpt official\n  link: https://chat.openai.com/chat\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n- name: opencat\n  desc: chatgpt ios client\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n- name: OpenAI Translator\n  desc: chatgpt client [open source]\n  link: https://github.com/openai-translator/openai-translator\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n- name: snackprompt\n  desc: promptæ¶éç½ç«\n  link: https://snackprompt.com/\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n- name: flowgpt\n  desc: promptæ¶éç½ç«\n  link: https://flowgpt.com/\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n- name: theresanaiforthat\n  desc: website AI aggregator\n  link: https://theresanaiforthat.com/\n  bgColor: '#DFEEE7'\n  textColor: '#2A3344'\n",normalizedContent:"chatgpt\n\nchatgpt official\n\nopencat\n\nchatgpt ios client\n\nopenai translator\n\nchatgpt client [open source]\n\nsnackprompt\n\npromptæ¶éç½ç«\n\nflowgpt\n\npromptæ¶éç½ç«\n\ntheresanaiforthat\n\nwebsite ai aggregator\n\n- name: chatgpt\n  desc: chatgpt official\n  link: https://chat.openai.com/chat\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n- name: opencat\n  desc: chatgpt ios client\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n- name: openai translator\n  desc: chatgpt client [open source]\n  link: https://github.com/openai-translator/openai-translator\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n- name: snackprompt\n  desc: promptæ¶éç½ç«\n  link: https://snackprompt.com/\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n- name: flowgpt\n  desc: promptæ¶éç½ç«\n  link: https://flowgpt.com/\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n- name: theresanaiforthat\n  desc: website ai aggregator\n  link: https://theresanaiforthat.com/\n  bgcolor: '#dfeee7'\n  textcolor: '#2a3344'\n",charsets:{cjk:!0}},{title:"Linuxå¸¸ç¨å½ä»¤",frontmatter:{title:"Linuxå¸¸ç¨å½ä»¤",date:"2023-03-31T17:30:37.000Z",permalink:"/pages/linux/"},regularPath:"/100.%E5%B7%A5%E5%85%B7/02.Linux/01.Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html",relativePath:"100.å·¥å·/02.Linux/01.Linuxå¸¸ç¨å½ä»¤.md",key:"v-49c893e5",path:"/pages/linux/",headers:[{level:2,title:"æ¥çç«¯å£å ç¨",slug:"æ¥çç«¯å£å ç¨",normalizedTitle:"æ¥çç«¯å£å ç¨",charIndex:2},{level:2,title:"ææ­»è¿ç¨",slug:"ææ­»è¿ç¨",normalizedTitle:"ææ­»è¿ç¨",charIndex:303},{level:2,title:"åå°è¿è¡èæ¬",slug:"åå°è¿è¡èæ¬",normalizedTitle:"åå°è¿è¡èæ¬",charIndex:325},{level:2,title:"ps -ef",slug:"ps-ef",normalizedTitle:"ps -ef",charIndex:471},{level:2,title:"ll /proc/pid æ¥çè¿ç¨æå¨çç®å½",slug:"ll-proc-pid-æ¥çè¿ç¨æå¨çç®å½",normalizedTitle:"ll /proc/pid æ¥çè¿ç¨æå¨çç®å½",charIndex:978},{level:2,title:"å¸¸ç¨è®°å½",slug:"å¸¸ç¨è®°å½",normalizedTitle:"å¸¸ç¨è®°å½",charIndex:1005}],headersStr:"æ¥çç«¯å£å ç¨ ææ­»è¿ç¨ åå°è¿è¡èæ¬ ps -ef ll /proc/pid æ¥çè¿ç¨æå¨çç®å½ å¸¸ç¨è®°å½",content:"# æ¥çç«¯å£å ç¨\n\nlsof(list open files)ï¼å¨linuxä¸­ï¼ä¸åçæä»¶ã\n\nlsof -i tcp:8080\n\nlsof -i :8080\n\n * lsof -i:ç«¯å£å·\n\n * netstat -tunpl | grep ç«¯å£å·\n\n * * -t tcp\n   * -u udp\n   * -n æç»æ¾ç¤ºå«åï¼è½æ¾ç¤ºææ°å­çå¨è½¬åææ°å­\n   * -l listenç¶æç\n   * -p æ¾ç¤ºå»ºç«ç¸å³é¾æ¥çç¨åºå\n\n * ç¶åå°±æ¯kill -9 PID\n\nhttps://www.runoob.com/w3cnote/linux-check-port-usage.html\n\n\n# ææ­»è¿ç¨\n\nkill -9 pid\n\n\n# åå°è¿è¡èæ¬\n\n * ./xxx.sh & (ç»ç«¯éåºæ¶ï¼å°±åäº)\n * nohup ./xxx.sh & (ä¸ä¸­æ­å¨åå°è¿è¡ãæå°ä¿¡æ¯ä¼è¾åºå°å½åç®å½ä¸çnohup.outä¸­)\n * jobsæ¥çå½åshellç¯å¢ä¸­å¯å¨çä»»å¡æåµãéåºå½åç»ç«¯ï¼åéæ°æå¼æ¶ï¼jobsçä¸å°æ­£å¨è¿è¡çèæ¬ï¼ps -efå¯ä»¥çå°ã\n * ps -ef | grep xxx.sh æ¥çæ­£å¨è¿è¡èæ¬è¿ç¨\n * ctrl + cæ¯ä¸­æ­èæ¬ãctrl + zæ¯åæ¢å°åå°å¹¶æåã\n * bg number ä½¿å¶å¨åå°æ§è¡ï¼fg number åæ¢å°åå°æ§è¡ãï¼numberæ¯ä½¿ç¨jobså½ä»¤æ¥è¯¢å°çæ°å­ï¼ä¸æ¯pidï¼ã\n\n\n# ps -ef\n\nps: process status\n\n-e: all the processes with in the system, not just the ones from the current terminal\n\n-f: see a more detailed output\n\nhttps://www.baeldung.com/linux/ps-command#1-listing-all-processes\n\nps aux åps -efä¸¤èçè¾åºç»æå·®å«ä¸å¤§ï¼ä½å±ç¤ºé£æ ¼ä¸åãauxæ¯BSDé£æ ¼ï¼-efæ¯System Vé£æ ¼ãè¿æ¯æ¬¡è¦çåºå«ï¼ä¸ä¸ªå½±åä½¿ç¨çåºå«æ¯auxä¼æªæ­commandåï¼è-efä¸ä¼ãå½ç»ågrepæ¶è¿ç§åºå«ä¼å½±åå°ç»æã\n\næ¨èä½¿ç¨ps -efã\n\n\n# ll /proc/pid æ¥çè¿ç¨æå¨çç®å½\n\n\n# å¸¸ç¨è®°å½\n\n * ps -ef | grep xxx\n * source ~ï¼.bash_pro\n * tail -f xxxæä»¶\n * telnet host port\n * lsof -i tcp :8080 æ¥çç«¯å£\n * netstat -tunlp | grep 8080 æ¥çç«¯å£å ç¨\n * curl -X POST -H 'Content-Type:application/json' -H 'charset=UTF-8' -d '{\"xxx\":\"xxx\"}' http://xxxxx å¨æå¡å¨ééè¿curlè¯·æ±æ¥å£ï¼è¿å¨çäº§çæå¡å¨ä¸­å¾æç¨ã",normalizedContent:"# æ¥çç«¯å£å ç¨\n\nlsof(list open files)ï¼å¨linuxä¸­ï¼ä¸åçæä»¶ã\n\nlsof -i tcp:8080\n\nlsof -i :8080\n\n * lsof -i:ç«¯å£å·\n\n * netstat -tunpl | grep ç«¯å£å·\n\n * * -t tcp\n   * -u udp\n   * -n æç»æ¾ç¤ºå«åï¼è½æ¾ç¤ºææ°å­çå¨è½¬åææ°å­\n   * -l listenç¶æç\n   * -p æ¾ç¤ºå»ºç«ç¸å³é¾æ¥çç¨åºå\n\n * ç¶åå°±æ¯kill -9 pid\n\nhttps://www.runoob.com/w3cnote/linux-check-port-usage.html\n\n\n# ææ­»è¿ç¨\n\nkill -9 pid\n\n\n# åå°è¿è¡èæ¬\n\n * ./xxx.sh & (ç»ç«¯éåºæ¶ï¼å°±åäº)\n * nohup ./xxx.sh & (ä¸ä¸­æ­å¨åå°è¿è¡ãæå°ä¿¡æ¯ä¼è¾åºå°å½åç®å½ä¸çnohup.outä¸­)\n * jobsæ¥çå½åshellç¯å¢ä¸­å¯å¨çä»»å¡æåµãéåºå½åç»ç«¯ï¼åéæ°æå¼æ¶ï¼jobsçä¸å°æ­£å¨è¿è¡çèæ¬ï¼ps -efå¯ä»¥çå°ã\n * ps -ef | grep xxx.sh æ¥çæ­£å¨è¿è¡èæ¬è¿ç¨\n * ctrl + cæ¯ä¸­æ­èæ¬ãctrl + zæ¯åæ¢å°åå°å¹¶æåã\n * bg number ä½¿å¶å¨åå°æ§è¡ï¼fg number åæ¢å°åå°æ§è¡ãï¼numberæ¯ä½¿ç¨jobså½ä»¤æ¥è¯¢å°çæ°å­ï¼ä¸æ¯pidï¼ã\n\n\n# ps -ef\n\nps: process status\n\n-e: all the processes with in the system, not just the ones from the current terminal\n\n-f: see a more detailed output\n\nhttps://www.baeldung.com/linux/ps-command#1-listing-all-processes\n\nps aux åps -efä¸¤èçè¾åºç»æå·®å«ä¸å¤§ï¼ä½å±ç¤ºé£æ ¼ä¸åãauxæ¯bsdé£æ ¼ï¼-efæ¯system vé£æ ¼ãè¿æ¯æ¬¡è¦çåºå«ï¼ä¸ä¸ªå½±åä½¿ç¨çåºå«æ¯auxä¼æªæ­commandåï¼è-efä¸ä¼ãå½ç»ågrepæ¶è¿ç§åºå«ä¼å½±åå°ç»æã\n\næ¨èä½¿ç¨ps -efã\n\n\n# ll /proc/pid æ¥çè¿ç¨æå¨çç®å½\n\n\n# å¸¸ç¨è®°å½\n\n * ps -ef | grep xxx\n * source ~ï¼.bash_pro\n * tail -f xxxæä»¶\n * telnet host port\n * lsof -i tcp :8080 æ¥çç«¯å£\n * netstat -tunlp | grep 8080 æ¥çç«¯å£å ç¨\n * curl -x post -h 'content-type:application/json' -h 'charset=utf-8' -d '{\"xxx\":\"xxx\"}' http://xxxxx å¨æå¡å¨ééè¿curlè¯·æ±æ¥å£ï¼è¿å¨çäº§çæå¡å¨ä¸­å¾æç¨ã",charsets:{cjk:!0}},{title:"éç¾¤æ­å»ºæ»æè·¯",frontmatter:{title:"éç¾¤æ­å»ºæ»æè·¯",date:"2023-08-28T21:02:00.000Z",permalink:"/pages/e945bb/"},regularPath:"/13.%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/01.%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%80%BB%E6%80%9D%E8%B7%AF.html",relativePath:"13.ç³»ç»è®¾è®¡/01.éç¾¤æ­å»ºæ»æè·¯.md",key:"v-b28245d2",path:"/pages/e945bb/",headers:[{level:2,title:"ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯",slug:"ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯",normalizedTitle:"ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯",charIndex:2},{level:2,title:"åè",slug:"åè",normalizedTitle:"åè",charIndex:329}],headersStr:"ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯ åè",content:"# ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯\n\nå¨åå¸å¼å­å¨ä¸­éè¦æä¾ç»´æ¤èç¹åæ°æ®ä¿¡æ¯çæºå¶ï¼æè°åæ°æ®æ¯æï¼èç¹è´è´£åªäºæ°æ®ï¼æ¯å¦åºç°æéç­ç¶æä¿¡æ¯ãå¸¸è§çåæ°æ®ç»´æ¤æ¹å¼åä¸ºï¼éä¸­å¼åP2Pæ¹å¼ã\n\n 1. éä¸­å¼ï¼\n    * ä¼ç¹ ï¼åæ°æ®çæ´æ°åè¯»åï¼æ¶ææ§éå¸¸å¥½ï¼ä¸æ¦åæ°æ®åºç°äºåæ´ï¼ç«å³å°±æ´æ°å°éä¸­å¼çå­å¨ä¸­ã\n    * ç¼ºç¹ ï¼ææçåæ°æ®çæ´æ°ååå¨é¨éä¸­å¨ä¸ä¸ªå°æ¹ï¼å¯è½å¯¼è´åæ°æ®çå­å¨æååã\n 2. gossipï¼\n    * ä¼ç¹ ï¼åæ°æ®çæ´æ°æ¯è¾åæ£ï¼ä¸æ¯éä¸­å¨åä¸ä¸ªå°æ¹ï¼æ´æ°è¯·æ±ä¼ééç»­ç»­å°è¾¾ææèç¹ä¸å»æ´æ°ï¼æä¸å®çå»¶æ¶ï¼éä½äºååã\n    * ç¼ºç¹ ï¼åæ°æ®æ´æ°æå»¶æ¶ï¼å¯è½ä¼å¯¼è´éç¾¤çä¸äºæä½ä¼æä¸äºæ»åã\n\n\n# åè\n\nhttps://www.cnblogs.com/duanxz/p/15893958.html",normalizedContent:"# ç»´æ¤éç¾¤çåæ°æ®çä¸¤ç§æ¹æ¡ä»ç»åå¯¹æ¯\n\nå¨åå¸å¼å­å¨ä¸­éè¦æä¾ç»´æ¤èç¹åæ°æ®ä¿¡æ¯çæºå¶ï¼æè°åæ°æ®æ¯æï¼èç¹è´è´£åªäºæ°æ®ï¼æ¯å¦åºç°æéç­ç¶æä¿¡æ¯ãå¸¸è§çåæ°æ®ç»´æ¤æ¹å¼åä¸ºï¼éä¸­å¼åp2pæ¹å¼ã\n\n 1. éä¸­å¼ï¼\n    * ä¼ç¹ ï¼åæ°æ®çæ´æ°åè¯»åï¼æ¶ææ§éå¸¸å¥½ï¼ä¸æ¦åæ°æ®åºç°äºåæ´ï¼ç«å³å°±æ´æ°å°éä¸­å¼çå­å¨ä¸­ã\n    * ç¼ºç¹ ï¼ææçåæ°æ®çæ´æ°ååå¨é¨éä¸­å¨ä¸ä¸ªå°æ¹ï¼å¯è½å¯¼è´åæ°æ®çå­å¨æååã\n 2. gossipï¼\n    * ä¼ç¹ ï¼åæ°æ®çæ´æ°æ¯è¾åæ£ï¼ä¸æ¯éä¸­å¨åä¸ä¸ªå°æ¹ï¼æ´æ°è¯·æ±ä¼ééç»­ç»­å°è¾¾ææèç¹ä¸å»æ´æ°ï¼æä¸å®çå»¶æ¶ï¼éä½äºååã\n    * ç¼ºç¹ ï¼åæ°æ®æ´æ°æå»¶æ¶ï¼å¯è½ä¼å¯¼è´éç¾¤çä¸äºæä½ä¼æä¸äºæ»åã\n\n\n# åè\n\nhttps://www.cnblogs.com/duanxz/p/15893958.html",charsets:{cjk:!0}},{title:"QuickSort",frontmatter:{title:"QuickSort",date:"2023-03-31T22:59:14.000Z",permalink:"/pages/27d05d/"},regularPath:"/99.Code%20Snippet/01.QuickSort.html",relativePath:"99.Code Snippet/01.QuickSort.md",key:"v-153f7b50",path:"/pages/27d05d/",headersStr:null,content:"import java.util.Arrays;\nimport java.util.Random;\n\npublic class QuickSort {\n    public static void quickSort(int[] arr, int left, int right) {\n        if (left < right) {\n            int p = partition(arr, left, right);\n            quickSort(arr, 0, p - 1);\n            quickSort(arr, p + 1, right);\n        }\n    }\n\n    public static int partition(int[] arr, int left, int right) {\n        Random random = new Random();\n        int pivot = random.nextInt(right - left + 1) + left;\n        swap(arr, left, pivot);\n//        int pivot = left;\n        while (left < right) {\n            while (left < right && arr[right] >= arr[pivot]) right--;\n            while (left < right && arr[left] <= arr[pivot]) left++;\n            swap(arr, left, right);\n        }\n        swap(arr, pivot, left);\n        return left;\n    }\n\n    public static void swap(int[] arr, int i, int j) {\n        int temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n\n    public static void main(String[] args) {\n        int[] arr = {1,3,5,2,6};\n        quickSort(arr, 0, arr.length - 1);\n        Arrays.stream(arr).forEach(System.out::println);\n    }\n}\n\n",normalizedContent:"import java.util.arrays;\nimport java.util.random;\n\npublic class quicksort {\n    public static void quicksort(int[] arr, int left, int right) {\n        if (left < right) {\n            int p = partition(arr, left, right);\n            quicksort(arr, 0, p - 1);\n            quicksort(arr, p + 1, right);\n        }\n    }\n\n    public static int partition(int[] arr, int left, int right) {\n        random random = new random();\n        int pivot = random.nextint(right - left + 1) + left;\n        swap(arr, left, pivot);\n//        int pivot = left;\n        while (left < right) {\n            while (left < right && arr[right] >= arr[pivot]) right--;\n            while (left < right && arr[left] <= arr[pivot]) left++;\n            swap(arr, left, right);\n        }\n        swap(arr, pivot, left);\n        return left;\n    }\n\n    public static void swap(int[] arr, int i, int j) {\n        int temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n\n    public static void main(string[] args) {\n        int[] arr = {1,3,5,2,6};\n        quicksort(arr, 0, arr.length - 1);\n        arrays.stream(arr).foreach(system.out::println);\n    }\n}\n\n",charsets:{}},{title:"HeapSort",frontmatter:{title:"HeapSort",date:"2023-03-31T22:59:59.000Z",permalink:"/pages/dfcd0a/"},regularPath:"/99.Code%20Snippet/02.HeapSort.html",relativePath:"99.Code Snippet/02.HeapSort.md",key:"v-be922ec8",path:"/pages/dfcd0a/",headersStr:null,content:'import java.util.Arrays;\n\npublic class HeapSort {\n    public static void main(String[] args) {\n        int[] arr = {1,3,5,2,6,12};\n        heapSort(arr);\n        Arrays.stream(arr).forEach((x) -> System.out.print(x + ","));\n    }\n\n    public static void heapSort(int[] arr) {\n        int len = arr.length;\n        buildHeap(arr, len);\n        for (int i = len - 1; i >= 0; i--) {\n            swap(arr, i, 0);\n            heapify(arr, 0, --len);\n        }\n    }\n\n    public static void buildHeap(int[] arr, int len) {\n        for (int i = len / 2; i >= 0; i--) {\n            heapify(arr, i, len);\n        }\n    }\n\n    public static void heapify(int [] arr, int i, int len) {\n        int left = i * 2 + 1;\n        int right = i * 2 + 2;\n        int largest = i;\n        if (left < len && arr[left] > arr[largest]) largest = left;\n        if (right < len && arr[right] > arr[largest]) largest = right;\n        if (largest != i) {\n            swap(arr, i, largest);\n            heapify(arr, largest, len);\n        }\n    }\n\n    public static void swap(int[] arr, int i, int j) {\n        int t = arr[i];\n        arr[i] = arr[j];\n        arr[j] = t;\n    }\n}\n\n',normalizedContent:'import java.util.arrays;\n\npublic class heapsort {\n    public static void main(string[] args) {\n        int[] arr = {1,3,5,2,6,12};\n        heapsort(arr);\n        arrays.stream(arr).foreach((x) -> system.out.print(x + ","));\n    }\n\n    public static void heapsort(int[] arr) {\n        int len = arr.length;\n        buildheap(arr, len);\n        for (int i = len - 1; i >= 0; i--) {\n            swap(arr, i, 0);\n            heapify(arr, 0, --len);\n        }\n    }\n\n    public static void buildheap(int[] arr, int len) {\n        for (int i = len / 2; i >= 0; i--) {\n            heapify(arr, i, len);\n        }\n    }\n\n    public static void heapify(int [] arr, int i, int len) {\n        int left = i * 2 + 1;\n        int right = i * 2 + 2;\n        int largest = i;\n        if (left < len && arr[left] > arr[largest]) largest = left;\n        if (right < len && arr[right] > arr[largest]) largest = right;\n        if (largest != i) {\n            swap(arr, i, largest);\n            heapify(arr, largest, len);\n        }\n    }\n\n    public static void swap(int[] arr, int i, int j) {\n        int t = arr[i];\n        arr[i] = arr[j];\n        arr[j] = t;\n    }\n}\n\n',charsets:{}},{title:"Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼",frontmatter:{title:"Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼",date:"2023-03-31T23:00:48.000Z",permalink:"/pages/c708a0/"},regularPath:"/99.Code%20Snippet/03.Java%E5%AE%9E%E7%8E%B0%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E6%A8%A1%E5%BC%8F.html",relativePath:"99.Code Snippet/03.Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼.md",key:"v-af878584",path:"/pages/c708a0/",headers:[{level:2,title:"synchronized, wait, notify",slug:"synchronized-wait-notify",normalizedTitle:"synchronized, wait, notify",charIndex:2},{level:2,title:"ReentrantLock, Condiction->await signal",slug:"reentrantlock-condiction-await-signal",normalizedTitle:"reentrantlock, condiction-&gt;await signal",charIndex:null}],headersStr:"synchronized, wait, notify ReentrantLock, Condiction->await signal",content:'# synchronized, wait, notify\n\nimport java.util.LinkedList;\nimport java.util.Queue;\n\npublic class ProducerConsumer {\n    private Queue<Integer> buffer = new LinkedList<>(); // å±äº«ç¼å²åº\n    private int capacity = 5; // ç¼å²åºå®¹é\n\n    public void produce() throws InterruptedException {\n        int value = 0;\n        while (true) {\n            synchronized (this) { // è·åé\n                while (buffer.size() == capacity) { // ç¼å²åºæ»¡ï¼ç­å¾æ¶è´¹èæ¶è´¹\n                    wait();\n                }\n                buffer.add(value++);\n                System.out.println("Produced: " + value);\n                notify(); // å¤éæ¶è´¹è\n                Thread.sleep(1000); // çäº§èä¼ç 1ç§\n            }\n        }\n    }\n\n    public void consume() throws InterruptedException {\n        while (true) {\n            synchronized (this) { // è·åé\n                while (buffer.isEmpty()) { // ç¼å²åºç©ºï¼ç­å¾çäº§èçäº§\n                    wait();\n                }\n                int value = buffer.poll();\n                System.out.println("Consumed: " + value);\n                notify(); // å¤éçäº§è\n                Thread.sleep(1000); // æ¶è´¹èä¼ç 1ç§\n            }\n        }\n    }\n}\n\n\n\npublic class Main {\n    public static void main(String[] args) {\n        ProducerConsumer pc = new ProducerConsumer();\n        new Thread(() -> {\n            try {\n                pc.produce();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }).start();\n        new Thread(() -> {\n            try {\n                pc.consume();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }).start();\n    }\n}\n\n\n\n\n# ReentrantLock, Condiction->await signal\n\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.concurrent.locks.Condition;\nimport java.util.concurrent.locks.ReentrantLock;\n\npublic class ProducerConsumer2 {\n    private Queue<Integer> buffer = new LinkedList<>();\n    private int capacity = 5;\n    private ReentrantLock lock = new ReentrantLock();\n    private Condition notFull = lock.newCondition();\n    private Condition notEmpty = lock.newCondition();\n\n    public void produce() throws InterruptedException {\n        int value = 0;\n        try {\n            while (true) {\n                lock.lock();\n                while (buffer.size() == capacity) {\n                    notFull.await();\n                }\n                buffer.add(value++);\n                System.out.println("Produced:" + value);\n                notEmpty.signal();\n                Thread.sleep(1000);\n            }\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void consume() throws InterruptedException {\n        try {\n            while (true) {\n                lock.lock();\n                while (buffer.isEmpty()) {\n                    notEmpty.await();\n                }\n                int value = buffer.poll();\n                System.out.println("Consumed:" + value);\n                notFull.signal();\n                Thread.sleep(1000);\n            }\n        } finally {\n            lock.unlock();\n        }\n    }\n\n}\n',normalizedContent:'# synchronized, wait, notify\n\nimport java.util.linkedlist;\nimport java.util.queue;\n\npublic class producerconsumer {\n    private queue<integer> buffer = new linkedlist<>(); // å±äº«ç¼å²åº\n    private int capacity = 5; // ç¼å²åºå®¹é\n\n    public void produce() throws interruptedexception {\n        int value = 0;\n        while (true) {\n            synchronized (this) { // è·åé\n                while (buffer.size() == capacity) { // ç¼å²åºæ»¡ï¼ç­å¾æ¶è´¹èæ¶è´¹\n                    wait();\n                }\n                buffer.add(value++);\n                system.out.println("produced: " + value);\n                notify(); // å¤éæ¶è´¹è\n                thread.sleep(1000); // çäº§èä¼ç 1ç§\n            }\n        }\n    }\n\n    public void consume() throws interruptedexception {\n        while (true) {\n            synchronized (this) { // è·åé\n                while (buffer.isempty()) { // ç¼å²åºç©ºï¼ç­å¾çäº§èçäº§\n                    wait();\n                }\n                int value = buffer.poll();\n                system.out.println("consumed: " + value);\n                notify(); // å¤éçäº§è\n                thread.sleep(1000); // æ¶è´¹èä¼ç 1ç§\n            }\n        }\n    }\n}\n\n\n\npublic class main {\n    public static void main(string[] args) {\n        producerconsumer pc = new producerconsumer();\n        new thread(() -> {\n            try {\n                pc.produce();\n            } catch (interruptedexception e) {\n                e.printstacktrace();\n            }\n        }).start();\n        new thread(() -> {\n            try {\n                pc.consume();\n            } catch (interruptedexception e) {\n                e.printstacktrace();\n            }\n        }).start();\n    }\n}\n\n\n\n\n# reentrantlock, condiction->await signal\n\nimport java.util.linkedlist;\nimport java.util.queue;\nimport java.util.concurrent.locks.condition;\nimport java.util.concurrent.locks.reentrantlock;\n\npublic class producerconsumer2 {\n    private queue<integer> buffer = new linkedlist<>();\n    private int capacity = 5;\n    private reentrantlock lock = new reentrantlock();\n    private condition notfull = lock.newcondition();\n    private condition notempty = lock.newcondition();\n\n    public void produce() throws interruptedexception {\n        int value = 0;\n        try {\n            while (true) {\n                lock.lock();\n                while (buffer.size() == capacity) {\n                    notfull.await();\n                }\n                buffer.add(value++);\n                system.out.println("produced:" + value);\n                notempty.signal();\n                thread.sleep(1000);\n            }\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public void consume() throws interruptedexception {\n        try {\n            while (true) {\n                lock.lock();\n                while (buffer.isempty()) {\n                    notempty.await();\n                }\n                int value = buffer.poll();\n                system.out.println("consumed:" + value);\n                notfull.signal();\n                thread.sleep(1000);\n            }\n        } finally {\n            lock.unlock();\n        }\n    }\n\n}\n',charsets:{cjk:!0}},{title:"chatgpt promt engineering for develpers",frontmatter:{title:"chatgpt promt engineering for develpers",date:"2023-05-05T20:29:26.000Z",permalink:"/pages/3c8ef8/",article:!1},regularPath:"/temp/chatgpt%20promt%20engineering%20for%20develpers.html",relativePath:"temp/chatgpt promt engineering for develpers.md",key:"v-2ffbbf7d",path:"/pages/3c8ef8/",headers:[{level:2,title:"Prompting Principles",slug:"prompting-principles",normalizedTitle:"prompting principles",charIndex:138},{level:3,title:"Principle 1: Write clear and specific instructions",slug:"principle-1-write-clear-and-specific-instructions",normalizedTitle:"principle 1: write clear and specific instructions",charIndex:163},{level:3,title:"Principle 2: Give the model time to âthinkâ",slug:"principle-2-give-the-model-time-to-think",normalizedTitle:"principle 2: give the model time to âthinkâ",charIndex:217},{level:2,title:"Iterative",slug:"iterative",normalizedTitle:"iterative",charIndex:1200},{level:2,title:"Summarizing",slug:"summarizing",normalizedTitle:"summarizing",charIndex:1214},{level:2,title:"Inferring",slug:"inferring",normalizedTitle:"inferring",charIndex:1230},{level:2,title:"Transforming",slug:"transforming",normalizedTitle:"transforming",charIndex:1244},{level:2,title:"Expanding",slug:"expanding",normalizedTitle:"expanding",charIndex:1261},{level:2,title:"Chatbot",slug:"chatbot",normalizedTitle:"chatbot",charIndex:1275},{level:2,title:"Conclusion",slug:"conclusion",normalizedTitle:"conclusion",charIndex:1287}],headersStr:"Prompting Principles Principle 1: Write clear and specific instructions Principle 2: Give the model time to âthinkâ Iterative Summarizing Inferring Transforming Expanding Chatbot Conclusion",content:'two types of large language models (LLMs)\n\n * Base LLM\n * Instruction Tuned LLM\n   * RLHF: Reinforcement Learning with Human Feedback\n\n\n# Prompting Principles\n\n * Principle 1: Write clear and specific instructions\n * Principle 2: Give the model time to âthinkâ\n\n\n# Principle 1: Write clear and specific instructions\n\n * Tactic 1: Use delimiters to clearly indicate distinct parts of the input\n   \n   * Delimiters can be anything like: ```, """, < >, <tag></tag>, :\n\n * Tactic 2: Ask for a structured output\n   \n   * JSON or Html\n\n * Tactic 3: Ask the model to check whether conditions are satisfied\n\ntext = f""" \nxxx\n"""\n\nprompt = f"""\nYou will be provided with text delimited by triple quotes. \nIf it contains a sequence of instructions, \\ \nre-write those instructions in the following format:\n\nStep 1 - ...\nStep 2 - â¦\nâ¦\nStep N - â¦\n\nIf the text does not contain a sequence of instructions, \\ \nthen simply write \\"No steps provided.\\"\n\n\\"\\"\\"{text}\\"\\"\\"\n"""\n\n\n * Tactic 4: "Few-shot" prompting\n\n\n# Principle 2: Give the model time to âthinkâ\n\n * Tactic 1: Specify the steps required to complete a task\n\n * Tactic 2: Instruct the model to work out its own solution before rushing to a conclusion\n\n\n# Iterative\n\n\n# Summarizing\n\n\n# Inferring\n\n\n# Transforming\n\n\n# Expanding\n\n\n# Chatbot\n\n\n# Conclusion',normalizedContent:'two types of large language models (llms)\n\n * base llm\n * instruction tuned llm\n   * rlhf: reinforcement learning with human feedback\n\n\n# prompting principles\n\n * principle 1: write clear and specific instructions\n * principle 2: give the model time to âthinkâ\n\n\n# principle 1: write clear and specific instructions\n\n * tactic 1: use delimiters to clearly indicate distinct parts of the input\n   \n   * delimiters can be anything like: ```, """, < >, <tag></tag>, :\n\n * tactic 2: ask for a structured output\n   \n   * json or html\n\n * tactic 3: ask the model to check whether conditions are satisfied\n\ntext = f""" \nxxx\n"""\n\nprompt = f"""\nyou will be provided with text delimited by triple quotes. \nif it contains a sequence of instructions, \\ \nre-write those instructions in the following format:\n\nstep 1 - ...\nstep 2 - â¦\nâ¦\nstep n - â¦\n\nif the text does not contain a sequence of instructions, \\ \nthen simply write \\"no steps provided.\\"\n\n\\"\\"\\"{text}\\"\\"\\"\n"""\n\n\n * tactic 4: "few-shot" prompting\n\n\n# principle 2: give the model time to âthinkâ\n\n * tactic 1: specify the steps required to complete a task\n\n * tactic 2: instruct the model to work out its own solution before rushing to a conclusion\n\n\n# iterative\n\n\n# summarizing\n\n\n# inferring\n\n\n# transforming\n\n\n# expanding\n\n\n# chatbot\n\n\n# conclusion',charsets:{}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-04-19T14:34:15.000Z",permalink:"/pages/a3d6e4/",article:!1},regularPath:"/temp/gradle%E5%92%8Cmaven%E5%AF%B9%E7%85%A7.html",relativePath:"temp/gradleåmavenå¯¹ç§.md",key:"v-6d33b879",path:"/pages/a3d6e4/",headers:[{level:2,title:"gradle",slug:"gradle",normalizedTitle:"gradle",charIndex:101},{level:3,title:"Gradle Wrapper",slug:"gradle-wrapper",normalizedTitle:"gradle wrapper",charIndex:2649}],headersStr:"gradle Gradle Wrapper",content:"åè½           GRADLE                                                         MAVEN\néç½®æä»¶         build.gradle                                                   pom.xml\næ·»å ä¾èµ         implementation 'groupId:artifactId:version'                    <dependency><groupId>groupId</groupId><artifactId>artifactId</artifactId><version>version</version></dependency>\næ§è¡æå»º         ./gradlew build                                                mvn clean package\nè¿è¡åºç¨ç¨åº       ./gradlew bootRun                                              mvn spring-boot:run\nåå¸å°Mavenä»åº   ./gradlew publishToMavenLocal                                  mvn deploy\næä»¶ç®¡ç         plugins { id 'java' }                                          <build><plugins><plugin><groupId>groupId</groupId><artifactId>artifactId</artifactId><version>version</version></plugin></plugins></build>\nå¤é¡¹ç®æå»º        include 'module1', 'module2'                                   <modules><module>module1</module><module>module2</module></modules>\nèªå®ä¹æå»ºä»»å¡      task myTask { ... }                                            <build><plugins><plugin><executions><execution><phase>phase</phase><goals><goal>goal</goal></goals></execution></executions></plugin></plugins></build>\nä¾èµç®¡ç         dependencies { implementation 'groupId:artifactId:version' }   <dependencies><dependency><groupId>groupId</groupId><artifactId>artifactId</artifactId><version>version</version></dependency></dependencies>\néç½®ç¯å¢åé       systemProperty 'propertyName', 'propertyValue'                 <build><plugins><plugin><configuration><systemProperties><propertyName>propertyValue</propertyName></systemProperties></configuration></plugin></plugins></build>\n\n\n# gradle\n\nGradle æ¯ä¸ç§æå»ºå·¥å·ï¼å¯ä»¥ç¨äºæå»ºãç¼è¯ãæµè¯åé¨ç½² Java é¡¹ç®ãå¨ Java ä¸­ä½¿ç¨ Gradle å¯ä»¥ç®åé¡¹ç®çæå»ºæµç¨ï¼å¹¶æé«æå»ºçæçåå¯ç»´æ¤æ§ã\n\nä¸é¢æ¯ Gradle å¨ Java ä¸­çä½¿ç¨æ¹æ³ï¼\n\n 1. å®è£ Gradle\n\né¦åéè¦å®è£ Gradleï¼å¯ä»¥å¨ Gradle å®ç½ä¸è½½ææ°çæ¬ç Gradleï¼æèä½¿ç¨åç®¡çå·¥å·ï¼å¦ Homebrewï¼è¿è¡å®è£ã\n\n 2. åå§å Gradle é¡¹ç®\n\nè¦ä½¿ç¨ Gradle æå»º Java é¡¹ç®ï¼éè¦åå¨é¡¹ç®ä¸­æ·»å  Gradle çéç½®æä»¶ build.gradleãå¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤åå§åä¸ä¸ªç©ºç Gradle é¡¹ç®ï¼\n\ngradle init --type java-library\n\n\nè¯¥å½ä»¤ä¼åå»ºä¸ä¸ªæ°ç Java é¡¹ç®ï¼å¹¶å¨é¡¹ç®ä¸­çæä¸ä¸ªåºæ¬ç build.gradle æä»¶ã\n\n 3. éç½® Gradle é¡¹ç®\n\nå¨ build.gradle æä»¶ä¸­éç½®é¡¹ç®çæå»ºè¿ç¨ï¼ä¾å¦æ·»å ä¾èµãå®ä¹ä»»å¡ç­ãä»¥ä¸æ¯ä¸ä¸ªç®åç build.gradle éç½®æä»¶çç¤ºä¾ï¼\n\nplugins {\n    id 'java'\n}\n\ngroup 'com.example'\nversion '1.0-SNAPSHOT'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'com.google.guava:guava:30.1-jre'\n    testImplementation 'junit:junit:4.13.2'\n}\n\ntest {\n    useJUnitPlatform()\n}\n\n\n 4. è¿è¡ Gradle ä»»å¡\n\nä½¿ç¨ Gradle è¿è¡æå»ºä»»å¡å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤ï¼\n\ngradle build\n\n\nè¯¥å½ä»¤ä¼æ§è¡é¡¹ç®ä¸­å®ä¹çææä»»å¡ï¼ä¾å¦ç¼è¯ Java ä»£ç ãè¿è¡ååæµè¯ãçæ JAR æä»¶ç­ã\n\n 5. æåæ JAR æä»¶\n\nä½¿ç¨ Gradle æå Java é¡¹ç®å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤ï¼\n\ngradle jar\n\n\nè¯¥å½ä»¤ä¼å°ç¼è¯å¥½ç Java ä»£ç æåæä¸ä¸ª JAR æä»¶ï¼å¯ä»¥éè¿è¯¥æä»¶åå¸åé¨ç½² Java åºç¨ç¨åºã\n\n\n# Gradle Wrapper\n\nGradle Wrapper æ¯ Gradle æå»ºå·¥å·ä¸­çä¸ä¸ªåè½ï¼å¯ä»¥ç¨äºèªå¨ä¸è½½åå®è£ Gradle å¹¶è¿è¡æå»ºä»»å¡ãGradle Wrapper æ¯ä¸ä¸ªå½ä»¤è¡èæ¬ï¼å¯ä»¥å¨ä¸éè¦æå¨å®è£ Gradle çæåµä¸è¿è¡ Gradle æå»ºä»»å¡ãå¯ä»¥ä¿è¯é¡¹ç®ä¸­ä½¿ç¨ç Gradle çæ¬ä¸é¡¹ç®å¼åèä½¿ç¨ç Gradle çæ¬ä¸è´ã\n\néå¸¸æåµä¸ï¼å¨ä½¿ç¨ Gradle æå»ºé¡¹ç®æ¶éè¦æå¨å®è£ Gradleï¼å¹¶å¨å½ä»¤è¡ä¸­ä½¿ç¨ gradle å½ä»¤æ¥æ§è¡æå»ºä»»å¡ãä½¿ç¨ Gradle Wrapper å¯ä»¥çå»æå¨å®è£ Gradle çæ­¥éª¤ï¼å¹¶ä¸ä¿è¯é¡¹ç®ä¸­ä½¿ç¨ç Gradle çæ¬ä¸é¡¹ç®å¼åèä½¿ç¨ç Gradle çæ¬ä¸è´ã\n\nGradle Wrapper çå·¥ä½åçæ¯å¨é¡¹ç®ä¸­æ·»å ä¸äºæä»¶ï¼å¦ gradlew å gradlew.batï¼ï¼è¿äºæä»¶åå«äº Gradle Wrapper çç¸å³ä¿¡æ¯å Gradle çä¸è½½é¾æ¥ãå½å¼åèå¨é¡¹ç®ä¸­æ§è¡æå»ºä»»å¡æ¶ï¼Gradle Wrapper ä¼èªå¨æ£æ¥æ¬å°æ¯å¦å·²ç»å®è£äºæå®çæ¬ç Gradleï¼å¦ææ²¡æå®è£ï¼åä¼èªå¨ä¸è½½å¹¶å®è£è¯¥çæ¬ç Gradleï¼ç¶åä½¿ç¨ä¸è½½ç Gradle æ§è¡æå»ºä»»å¡ã\n\nGradle Wrapper çä½¿ç¨æ¹æ³å¾ç®åï¼åªéè¦å¨é¡¹ç®ä¸­æ§è¡ä»¥ä¸å½ä»¤ï¼\n\ngradle wrapper\n\n\nè¯¥å½ä»¤ä¼å¨é¡¹ç®ä¸­çæ Gradle Wrapper ç¸å³çæä»¶ï¼å¹¶èªå¨ä¸è½½å¹¶å®è£æå®çæ¬ç Gradleã\n\nç¶åå¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤æ¥æ§è¡ Gradle æå»ºä»»å¡ï¼\n\n./gradlew <task>\n\n\nå¶ä¸­ <task> æ¯éè¦æ§è¡çæå»ºä»»å¡ï¼ä¾å¦ buildãtest",normalizedContent:"åè½           gradle                                                         maven\néç½®æä»¶         build.gradle                                                   pom.xml\næ·»å ä¾èµ         implementation 'groupid:artifactid:version'                    <dependency><groupid>groupid</groupid><artifactid>artifactid</artifactid><version>version</version></dependency>\næ§è¡æå»º         ./gradlew build                                                mvn clean package\nè¿è¡åºç¨ç¨åº       ./gradlew bootrun                                              mvn spring-boot:run\nåå¸å°mavenä»åº   ./gradlew publishtomavenlocal                                  mvn deploy\næä»¶ç®¡ç         plugins { id 'java' }                                          <build><plugins><plugin><groupid>groupid</groupid><artifactid>artifactid</artifactid><version>version</version></plugin></plugins></build>\nå¤é¡¹ç®æå»º        include 'module1', 'module2'                                   <modules><module>module1</module><module>module2</module></modules>\nèªå®ä¹æå»ºä»»å¡      task mytask { ... }                                            <build><plugins><plugin><executions><execution><phase>phase</phase><goals><goal>goal</goal></goals></execution></executions></plugin></plugins></build>\nä¾èµç®¡ç         dependencies { implementation 'groupid:artifactid:version' }   <dependencies><dependency><groupid>groupid</groupid><artifactid>artifactid</artifactid><version>version</version></dependency></dependencies>\néç½®ç¯å¢åé       systemproperty 'propertyname', 'propertyvalue'                 <build><plugins><plugin><configuration><systemproperties><propertyname>propertyvalue</propertyname></systemproperties></configuration></plugin></plugins></build>\n\n\n# gradle\n\ngradle æ¯ä¸ç§æå»ºå·¥å·ï¼å¯ä»¥ç¨äºæå»ºãç¼è¯ãæµè¯åé¨ç½² java é¡¹ç®ãå¨ java ä¸­ä½¿ç¨ gradle å¯ä»¥ç®åé¡¹ç®çæå»ºæµç¨ï¼å¹¶æé«æå»ºçæçåå¯ç»´æ¤æ§ã\n\nä¸é¢æ¯ gradle å¨ java ä¸­çä½¿ç¨æ¹æ³ï¼\n\n 1. å®è£ gradle\n\né¦åéè¦å®è£ gradleï¼å¯ä»¥å¨ gradle å®ç½ä¸è½½ææ°çæ¬ç gradleï¼æèä½¿ç¨åç®¡çå·¥å·ï¼å¦ homebrewï¼è¿è¡å®è£ã\n\n 2. åå§å gradle é¡¹ç®\n\nè¦ä½¿ç¨ gradle æå»º java é¡¹ç®ï¼éè¦åå¨é¡¹ç®ä¸­æ·»å  gradle çéç½®æä»¶ build.gradleãå¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤åå§åä¸ä¸ªç©ºç gradle é¡¹ç®ï¼\n\ngradle init --type java-library\n\n\nè¯¥å½ä»¤ä¼åå»ºä¸ä¸ªæ°ç java é¡¹ç®ï¼å¹¶å¨é¡¹ç®ä¸­çæä¸ä¸ªåºæ¬ç build.gradle æä»¶ã\n\n 3. éç½® gradle é¡¹ç®\n\nå¨ build.gradle æä»¶ä¸­éç½®é¡¹ç®çæå»ºè¿ç¨ï¼ä¾å¦æ·»å ä¾èµãå®ä¹ä»»å¡ç­ãä»¥ä¸æ¯ä¸ä¸ªç®åç build.gradle éç½®æä»¶çç¤ºä¾ï¼\n\nplugins {\n    id 'java'\n}\n\ngroup 'com.example'\nversion '1.0-snapshot'\n\nrepositories {\n    mavencentral()\n}\n\ndependencies {\n    implementation 'com.google.guava:guava:30.1-jre'\n    testimplementation 'junit:junit:4.13.2'\n}\n\ntest {\n    usejunitplatform()\n}\n\n\n 4. è¿è¡ gradle ä»»å¡\n\nä½¿ç¨ gradle è¿è¡æå»ºä»»å¡å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤ï¼\n\ngradle build\n\n\nè¯¥å½ä»¤ä¼æ§è¡é¡¹ç®ä¸­å®ä¹çææä»»å¡ï¼ä¾å¦ç¼è¯ java ä»£ç ãè¿è¡ååæµè¯ãçæ jar æä»¶ç­ã\n\n 5. æåæ jar æä»¶\n\nä½¿ç¨ gradle æå java é¡¹ç®å¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤ï¼\n\ngradle jar\n\n\nè¯¥å½ä»¤ä¼å°ç¼è¯å¥½ç java ä»£ç æåæä¸ä¸ª jar æä»¶ï¼å¯ä»¥éè¿è¯¥æä»¶åå¸åé¨ç½² java åºç¨ç¨åºã\n\n\n# gradle wrapper\n\ngradle wrapper æ¯ gradle æå»ºå·¥å·ä¸­çä¸ä¸ªåè½ï¼å¯ä»¥ç¨äºèªå¨ä¸è½½åå®è£ gradle å¹¶è¿è¡æå»ºä»»å¡ãgradle wrapper æ¯ä¸ä¸ªå½ä»¤è¡èæ¬ï¼å¯ä»¥å¨ä¸éè¦æå¨å®è£ gradle çæåµä¸è¿è¡ gradle æå»ºä»»å¡ãå¯ä»¥ä¿è¯é¡¹ç®ä¸­ä½¿ç¨ç gradle çæ¬ä¸é¡¹ç®å¼åèä½¿ç¨ç gradle çæ¬ä¸è´ã\n\néå¸¸æåµä¸ï¼å¨ä½¿ç¨ gradle æå»ºé¡¹ç®æ¶éè¦æå¨å®è£ gradleï¼å¹¶å¨å½ä»¤è¡ä¸­ä½¿ç¨ gradle å½ä»¤æ¥æ§è¡æå»ºä»»å¡ãä½¿ç¨ gradle wrapper å¯ä»¥çå»æå¨å®è£ gradle çæ­¥éª¤ï¼å¹¶ä¸ä¿è¯é¡¹ç®ä¸­ä½¿ç¨ç gradle çæ¬ä¸é¡¹ç®å¼åèä½¿ç¨ç gradle çæ¬ä¸è´ã\n\ngradle wrapper çå·¥ä½åçæ¯å¨é¡¹ç®ä¸­æ·»å ä¸äºæä»¶ï¼å¦ gradlew å gradlew.batï¼ï¼è¿äºæä»¶åå«äº gradle wrapper çç¸å³ä¿¡æ¯å gradle çä¸è½½é¾æ¥ãå½å¼åèå¨é¡¹ç®ä¸­æ§è¡æå»ºä»»å¡æ¶ï¼gradle wrapper ä¼èªå¨æ£æ¥æ¬å°æ¯å¦å·²ç»å®è£äºæå®çæ¬ç gradleï¼å¦ææ²¡æå®è£ï¼åä¼èªå¨ä¸è½½å¹¶å®è£è¯¥çæ¬ç gradleï¼ç¶åä½¿ç¨ä¸è½½ç gradle æ§è¡æå»ºä»»å¡ã\n\ngradle wrapper çä½¿ç¨æ¹æ³å¾ç®åï¼åªéè¦å¨é¡¹ç®ä¸­æ§è¡ä»¥ä¸å½ä»¤ï¼\n\ngradle wrapper\n\n\nè¯¥å½ä»¤ä¼å¨é¡¹ç®ä¸­çæ gradle wrapper ç¸å³çæä»¶ï¼å¹¶èªå¨ä¸è½½å¹¶å®è£æå®çæ¬ç gradleã\n\nç¶åå¯ä»¥ä½¿ç¨ä»¥ä¸å½ä»¤æ¥æ§è¡ gradle æå»ºä»»å¡ï¼\n\n./gradlew <task>\n\n\nå¶ä¸­ <task> æ¯éè¦æ§è¡çæå»ºä»»å¡ï¼ä¾å¦ buildãtest",charsets:{cjk:!0}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-04-16T15:21:47.000Z",permalink:"/pages/08f55c/",article:!1},regularPath:"/temp/jdk%E6%96%B0%E7%89%B9%E6%80%A7.html",relativePath:"temp/jdkæ°ç¹æ§.md",key:"v-365b0049",path:"/pages/08f55c/",headers:[{level:2,title:"jdk 9 æ°ç¹æ§",slug:"jdk-9-æ°ç¹æ§",normalizedTitle:"jdk 9 æ°ç¹æ§",charIndex:2},{level:3,title:"æ¨¡ååå¼å",slug:"æ¨¡ååå¼å",normalizedTitle:"æ¨¡ååå¼å",charIndex:16},{level:2,title:"jdk 10 æ°ç¹æ§",slug:"jdk-10-æ°ç¹æ§",normalizedTitle:"jdk 10 æ°ç¹æ§",charIndex:225},{level:3,title:"var å±é¨åéæ¨å¯¼",slug:"var-å±é¨åéæ¨å¯¼",normalizedTitle:"var å±é¨åéæ¨å¯¼",charIndex:240},{level:2,title:"jdk 11 æ§ç¹æ§",slug:"jdk-11-æ§ç¹æ§",normalizedTitle:"jdk 11 æ§ç¹æ§",charIndex:289},{level:3,title:"åæä»¶ç¨åº",slug:"åæä»¶ç¨åº",normalizedTitle:"åæä»¶ç¨åº",charIndex:304},{level:3,title:"æ¯æshebangèæ¬",slug:"æ¯æshebangèæ¬",normalizedTitle:"æ¯æshebangèæ¬",charIndex:369},{level:2,title:"jdk14æ°ç¹æ§",slug:"jdk14æ°ç¹æ§",normalizedTitle:"jdk14æ°ç¹æ§",charIndex:466},{level:3,title:"ææ¬å",slug:"ææ¬å",normalizedTitle:"ææ¬å",charIndex:479},{level:3,title:"instanceof å¢å¼º",slug:"instanceof-å¢å¼º",normalizedTitle:"instanceof å¢å¼º",charIndex:510},{level:2,title:"jdk16 æ°ç¹æ§",slug:"jdk16-æ°ç¹æ§",normalizedTitle:"jdk16 æ°ç¹æ§",charIndex:700},{level:3,title:"recordç±»",slug:"recordç±»",normalizedTitle:"recordç±»",charIndex:714},{level:2,title:"jdk17 æ°ç¹æ§",slug:"jdk17-æ°ç¹æ§",normalizedTitle:"jdk17 æ°ç¹æ§",charIndex:797},{level:3,title:"sealedç±»",slug:"sealedç±»",normalizedTitle:"sealedç±»",charIndex:811},{level:3,title:"switch å¢å¼º",slug:"switch-å¢å¼º",normalizedTitle:"switch å¢å¼º",charIndex:1087}],headersStr:"jdk 9 æ°ç¹æ§ æ¨¡ååå¼å jdk 10 æ°ç¹æ§ var å±é¨åéæ¨å¯¼ jdk 11 æ§ç¹æ§ åæä»¶ç¨åº æ¯æshebangèæ¬ jdk14æ°ç¹æ§ ææ¬å instanceof å¢å¼º jdk16 æ°ç¹æ§ recordç±» jdk17 æ°ç¹æ§ sealedç±» switch å¢å¼º",content:'# jdk 9 æ°ç¹æ§\n\n\n# æ¨¡ååå¼å\n\n * ä½¿ç¨ module-info.java æ¥å£°æä¸ä¸ªæ¨¡åï¼åå­æ¯åºå®çï¼å¨é¡¶å±åçåç®å½ä¸ã\n\n * ä½¿ç¨ exports å£°æå¯ä»¥è¢«å¤é¨å¼ç¨çåï¼å¯ä»¥æå¤ä¸ª exports è¯­å¥ã\n\n * ä½¿ç¨ requires å£°æä¾èµçå¤é¨æ¨¡åï¼å¯ä»¥æå¤ä¸ª requires è¯­å¥ã\n\nä¼ç¹ï¼\n\n * æ´å¥½çä»£ç éç¦»æ§åå®å¨æ§\n * æ´ç®åçä¾èµç®¡ç\n * æ´å¥½çæ§è½\n * æ´å¥½çå¯éç¨æ§åå¯æ©å±æ§\n\n\n# jdk 10 æ°ç¹æ§\n\n\n# var å±é¨åéæ¨å¯¼\n\nè¦æ±ï¼\n\n 1. å¿é¡»è½æ¨å¯¼åºå®éç±»å\n 2. åªè½ç¨äºå±é¨åé\n\n\n# jdk 11 æ§ç¹æ§\n\n\n# åæä»¶ç¨åº\n\nå¯ä»¥ç´æ¥å¨å½ä»¤è¡ä½¿ç¨ java Test.java è¿è¡åæä»¶ãèä¸ç¨javacå»ç¼è¯.classåè¿è¡ã\n\n\n# æ¯æshebangèæ¬\n\n#!ç¬¦å·å«åshebangãæ¯linuxçå½ä»¤ã\n\n#!/bin/bash è¡¨ç¤ºä»¥æ­¤å¼å¤´çæä»¶ï¼å¨æ§è¡æ¶ä¼è°ç¨/bin/bashç¨åºæ¥æ§è¡\n\n#!+jdkä½ç½®\n\n\n# jdk14æ°ç¹æ§\n\n\n# ææ¬å\n\næ¹ä¾¿åå¤è¡å­ç¬¦ä¸²\n\nç¨æ³ï¼ä½¿ç¨ä¸ä¸ªåå¼å·ã\n\n\n# instanceof å¢å¼º\n\n//jdk8\nObject a = "hello";\nif (a instanceof String) {\n  String b = (String)a;\n  System.out.println(b);\n}\n\n//jdk14\nif (a instanceof String b) {\n  System.out.println(b);\n}\n\n\n\n# jdk16 æ°ç¹æ§\n\n\n# recordç±»\n\nè· classãinterfaceåçº§\n\nåªè½åå§åä¸æ¬¡ï¼ä¸è½åä¿®æ¹ã\n\npublic record Test(String a) {}\n\n\n\n# jdk17 æ°ç¹æ§\n\n\n# sealedç±»\n\nsealed æ¯ä¸ªå³é®å­ã\n\npublic sealed class Test1 permits Test2,Test3 {}\n\npublic non-sealed class Test2 extends Test1 {}\n\npublic final class Test3 extends sealed {}\n\n\nçç¹ï¼ç±»çç»§æ¿é¾è¢«ç®¡çï¼ä½¿ç¨ sealedæ¾ç¤ºç®¡ç\n\nè§åï¼\n\n * ç¶ç±»å¦ææ¯sealedç±»ï¼åå¿é¡»è³å°æä¸ä¸ªå­ç±»ã\n * sealedç±»çå­ç±»ï¼å¿é¡»æ¯finalï¼sealedï¼non-sealed ä¹ä¸ã\n\n\n# switch å¢å¼º\n\nObject a = "hello";\nswitch (a) {\n    case String b -> System.out.println(b);\n    case Integer b -> System.out.println(b);\n    default -> System.out.println("default");\n}\n',normalizedContent:'# jdk 9 æ°ç¹æ§\n\n\n# æ¨¡ååå¼å\n\n * ä½¿ç¨ module-info.java æ¥å£°æä¸ä¸ªæ¨¡åï¼åå­æ¯åºå®çï¼å¨é¡¶å±åçåç®å½ä¸ã\n\n * ä½¿ç¨ exports å£°æå¯ä»¥è¢«å¤é¨å¼ç¨çåï¼å¯ä»¥æå¤ä¸ª exports è¯­å¥ã\n\n * ä½¿ç¨ requires å£°æä¾èµçå¤é¨æ¨¡åï¼å¯ä»¥æå¤ä¸ª requires è¯­å¥ã\n\nä¼ç¹ï¼\n\n * æ´å¥½çä»£ç éç¦»æ§åå®å¨æ§\n * æ´ç®åçä¾èµç®¡ç\n * æ´å¥½çæ§è½\n * æ´å¥½çå¯éç¨æ§åå¯æ©å±æ§\n\n\n# jdk 10 æ°ç¹æ§\n\n\n# var å±é¨åéæ¨å¯¼\n\nè¦æ±ï¼\n\n 1. å¿é¡»è½æ¨å¯¼åºå®éç±»å\n 2. åªè½ç¨äºå±é¨åé\n\n\n# jdk 11 æ§ç¹æ§\n\n\n# åæä»¶ç¨åº\n\nå¯ä»¥ç´æ¥å¨å½ä»¤è¡ä½¿ç¨ java test.java è¿è¡åæä»¶ãèä¸ç¨javacå»ç¼è¯.classåè¿è¡ã\n\n\n# æ¯æshebangèæ¬\n\n#!ç¬¦å·å«åshebangãæ¯linuxçå½ä»¤ã\n\n#!/bin/bash è¡¨ç¤ºä»¥æ­¤å¼å¤´çæä»¶ï¼å¨æ§è¡æ¶ä¼è°ç¨/bin/bashç¨åºæ¥æ§è¡\n\n#!+jdkä½ç½®\n\n\n# jdk14æ°ç¹æ§\n\n\n# ææ¬å\n\næ¹ä¾¿åå¤è¡å­ç¬¦ä¸²\n\nç¨æ³ï¼ä½¿ç¨ä¸ä¸ªåå¼å·ã\n\n\n# instanceof å¢å¼º\n\n//jdk8\nobject a = "hello";\nif (a instanceof string) {\n  string b = (string)a;\n  system.out.println(b);\n}\n\n//jdk14\nif (a instanceof string b) {\n  system.out.println(b);\n}\n\n\n\n# jdk16 æ°ç¹æ§\n\n\n# recordç±»\n\nè· classãinterfaceåçº§\n\nåªè½åå§åä¸æ¬¡ï¼ä¸è½åä¿®æ¹ã\n\npublic record test(string a) {}\n\n\n\n# jdk17 æ°ç¹æ§\n\n\n# sealedç±»\n\nsealed æ¯ä¸ªå³é®å­ã\n\npublic sealed class test1 permits test2,test3 {}\n\npublic non-sealed class test2 extends test1 {}\n\npublic final class test3 extends sealed {}\n\n\nçç¹ï¼ç±»çç»§æ¿é¾è¢«ç®¡çï¼ä½¿ç¨ sealedæ¾ç¤ºç®¡ç\n\nè§åï¼\n\n * ç¶ç±»å¦ææ¯sealedç±»ï¼åå¿é¡»è³å°æä¸ä¸ªå­ç±»ã\n * sealedç±»çå­ç±»ï¼å¿é¡»æ¯finalï¼sealedï¼non-sealed ä¹ä¸ã\n\n\n# switch å¢å¼º\n\nobject a = "hello";\nswitch (a) {\n    case string b -> system.out.println(b);\n    case integer b -> system.out.println(b);\n    default -> system.out.println("default");\n}\n',charsets:{cjk:!0}},{title:"juc-all",frontmatter:{title:"juc-all",date:"2023-05-13T20:03:24.000Z",permalink:"/pages/7a6f3c/",article:!1},regularPath:"/temp/juc-all.html",relativePath:"temp/juc-all.md",key:"v-7ba276fa",path:"/pages/7a6f3c/",headers:[{level:2,title:"Base",slug:"base",normalizedTitle:"base",charIndex:2},{level:2,title:"Locks",slug:"locks",normalizedTitle:"locks",charIndex:290},{level:3,title:"ReentrantLock",slug:"reentrantlock",normalizedTitle:"reentrantlock",charIndex:300},{level:3,title:"ReentrantReadWriteLock",slug:"reentrantreadwritelock",normalizedTitle:"reentrantreadwritelock",charIndex:1053},{level:3,title:"StampedLock",slug:"stampedlock",normalizedTitle:"stampedlock",charIndex:2573},{level:3,title:"LockSupport",slug:"locksupport",normalizedTitle:"locksupport",charIndex:3962},{level:4,title:"Thread.sleep()åObject.wait()çåºå«",slug:"thread-sleep-åobject-wait-çåºå«",normalizedTitle:"thread.sleep()åobject.wait()çåºå«",charIndex:5255},{level:4,title:"Object.wait()åCondition.await()çåºå«",slug:"object-wait-åcondition-await-çåºå«",normalizedTitle:"object.wait()åcondition.await()çåºå«",charIndex:5701},{level:4,title:"Thread.sleep()åLockSupport.park()çåºå«",slug:"thread-sleep-ålocksupport-park-çåºå«",normalizedTitle:"thread.sleep()ålocksupport.park()çåºå«",charIndex:5934},{level:4,title:"Object.wait()åLockSupport.park()çåºå«",slug:"object-wait-ålocksupport-park-çåºå«",normalizedTitle:"object.wait()ålocksupport.park()çåºå«",charIndex:6403},{level:4,title:"å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?",slug:"å¦æå¨wait-ä¹åæ§è¡äºnotify-ä¼ææ ·",normalizedTitle:"å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?",charIndex:4250},{level:4,title:"å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?",slug:"å¦æå¨park-ä¹åæ§è¡äºunpark-ä¼ææ ·",normalizedTitle:"å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?",charIndex:4280},{level:4,title:"LockSupport.park()ä¼éæ¾éèµæºå?",slug:"locksupport-park-ä¼éæ¾éèµæºå",normalizedTitle:"locksupport.park()ä¼éæ¾éèµæºå?",charIndex:4122},{level:2,title:"Tools",slug:"tools",normalizedTitle:"tools",charIndex:7131},{level:3,title:"CountDownLatch",slug:"countdownlatch",normalizedTitle:"countdownlatch",charIndex:7141},{level:3,title:"CyclicBarrier",slug:"cyclicbarrier",normalizedTitle:"cyclicbarrier",charIndex:8596},{level:3,title:"Phaser",slug:"phaser",normalizedTitle:"phaser",charIndex:10227},{level:3,title:"Semaphore",slug:"semaphore",normalizedTitle:"semaphore",charIndex:6774},{level:3,title:"Exchanger",slug:"exchanger",normalizedTitle:"exchanger",charIndex:11058},{level:2,title:"Collections",slug:"collections",normalizedTitle:"collections",charIndex:11072},{level:3,title:"Queue",slug:"queue",normalizedTitle:"queue",charIndex:768},{level:3,title:"List",slug:"list",normalizedTitle:"list",charIndex:11098},{level:3,title:"Set",slug:"set",normalizedTitle:"set",charIndex:11107},{level:3,title:"Map",slug:"map",normalizedTitle:"map",charIndex:11115},{level:2,title:"Atomic",slug:"atomic",normalizedTitle:"atomic",charIndex:11123},{level:3,title:"åºç¡ç±»å",slug:"åºç¡ç±»å",normalizedTitle:"åºç¡ç±»å",charIndex:11134},{level:3,title:"æ°ç»",slug:"æ°ç»",normalizedTitle:"æ°ç»",charIndex:11143},{level:3,title:"å¼ç¨",slug:"å¼ç¨",normalizedTitle:"å¼ç¨",charIndex:11150},{level:2,title:"Executor",slug:"executor",normalizedTitle:"executor",charIndex:11157},{level:3,title:"æ¥å£ï¼Executor",slug:"æ¥å£-executor",normalizedTitle:"æ¥å£ï¼executor",charIndex:11170},{level:3,title:"ExecutorService",slug:"executorservice",normalizedTitle:"executorservice",charIndex:11186},{level:3,title:"ScheduledExecutorService",slug:"scheduledexecutorservice",normalizedTitle:"scheduledexecutorservice",charIndex:11206},{level:3,title:"AbstractExecutorService",slug:"abstractexecutorservice",normalizedTitle:"abstractexecutorservice",charIndex:11235},{level:3,title:"FutureTask",slug:"futuretask",normalizedTitle:"futuretask",charIndex:11263},{level:3,title:"ThreadPoolExecutor",slug:"threadpoolexecutor",normalizedTitle:"threadpoolexecutor",charIndex:11278},{level:3,title:"ScheduledThreadPoolExecutor",slug:"scheduledthreadpoolexecutor",normalizedTitle:"scheduledthreadpoolexecutor",charIndex:11301},{level:3,title:"Fork/Join Framework",slug:"fork-join-framework",normalizedTitle:"fork/join framework",charIndex:11333},{level:3,title:"Executors",slug:"executors",normalizedTitle:"executors",charIndex:11357},{level:2,title:"Reference",slug:"reference",normalizedTitle:"reference",charIndex:11371}],headersStr:"Base Locks ReentrantLock ReentrantReadWriteLock StampedLock LockSupport Thread.sleep()åObject.wait()çåºå« Object.wait()åCondition.await()çåºå« Thread.sleep()åLockSupport.park()çåºå« Object.wait()åLockSupport.park()çåºå« å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·? å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·? LockSupport.park()ä¼éæ¾éèµæºå? Tools CountDownLatch CyclicBarrier Phaser Semaphore Exchanger Collections Queue List Set Map Atomic åºç¡ç±»å æ°ç» å¼ç¨ Executor æ¥å£ï¼Executor ExecutorService ScheduledExecutorService AbstractExecutorService FutureTask ThreadPoolExecutor ScheduledThreadPoolExecutor Fork/Join Framework Executors Reference",content:"# Base\n\n\n\næ¥å£ï¼Condition\n\nConditionä¸ºæ¥å£ç±»åï¼å®å° Object çè§å¨æ¹æ³(waitãnotify å notifyAll)åè§£ææªç¶ä¸åçå¯¹è±¡ï¼ä»¥ä¾¿éè¿å°è¿äºå¯¹è±¡ä¸ä»»æ Lock å®ç°ç»åä½¿ç¨ï¼ä¸ºæ¯ä¸ªå¯¹è±¡æä¾å¤ä¸ªç­å¾ set (wait-set)ãå¶ä¸­ï¼Lock æ¿ä»£äº synchronized æ¹æ³åè¯­å¥çä½¿ç¨ï¼Condition æ¿ä»£äº Object çè§å¨æ¹æ³çä½¿ç¨ãå¯ä»¥éè¿await(),signal()æ¥ä¼ç /å¤éçº¿ç¨ã\n\nCondition çå®ç°ç±»æ¯ AQS åAQLS çåé¨ç±» ConditionObject ã\n\n\n# Locks\n\n\n# ReentrantLock\n\nQuestionï¼\n\n * ä»ä¹æ¯å¯éå¥ï¼ä»ä¹æ¯å¯éå¥é? å®ç¨æ¥è§£å³ä»ä¹é®é¢?\n * ReentrantLockçæ ¸å¿æ¯AQSï¼é£ä¹å®æä¹æ¥å®ç°çï¼ç»§æ¿å? è¯´è¯´å¶ç±»åé¨ç»æå³ç³»ã\n * ReentrantLockæ¯å¦ä½å®ç°å¬å¹³éç?\n * ReentrantLockæ¯å¦ä½å®ç°éå¬å¹³éç?\n * ReentrantLocké»è®¤å®ç°çæ¯å¬å¹³è¿æ¯éå¬å¹³é?\n * ä½¿ç¨ReentrantLockå®ç°å¬å¹³åéå¬å¹³éçç¤ºä¾?\n * ReentrantLockåSynchronizedçå¯¹æ¯?\n\nReentrantLockä¸ºå¸¸ç¨ç±»ï¼å®æ¯ä¸ä¸ªå¯éå¥çäºæ¥é Lockï¼å®å·æä¸ä½¿ç¨ synchronized æ¹æ³åè¯­å¥æè®¿é®çéå¼çè§å¨éç¸åçä¸äºåºæ¬è¡ä¸ºåè¯­ä¹ï¼ä½åè½æ´å¼ºå¤§ã\n\nReentrantLock ä¸­çåé¨ç±»ï¼ReentrantLockç±»åé¨æ»å±å­å¨SyncãNonfairSyncãFairSyncä¸ä¸ªç±»ï¼NonfairSyncä¸FairSyncç±»ç»§æ¿èªSyncç±»ï¼Syncç±»ç»§æ¿èªAbstractQueuedSynchronizeræ½è±¡ç±»ã\n\nè°ç¨é¾ï¼\n\nå¬å¹³éçè°ç¨æåçæåµï¼lock:lock -> FairSync:lock ->AQS:acquire -> FairSync:tryAcquire -> AQS:hasQueuedPredecessors -> AQS:setExclusiveOwnerThread\n\nFairSync:lock å½èµæºè¢«å ç¨çæåµï¼FairSync:lock -> AQS:acquire -> FairSync:tryAcquire -> AQS:addWaiter -> AQS:acquireQueued\n\n\n# ReentrantReadWriteLock\n\nQuestionï¼\n\n * ä¸ºäºæäºReentrantLockè¿éè¦ReentrantReadWriteLock?\n * ReentrantReadWriteLockåºå±å®ç°åç?\n * ReentrantReadWriteLockåºå±è¯»åç¶æå¦ä½è®¾è®¡ç? é«16ä½ä¸ºè¯»éï¼ä½16ä½ä¸ºåé\n * è¯»éååéçæå¤§æ°éæ¯å¤å°?\n * æ¬å°çº¿ç¨è®¡æ°å¨ThreadLocalHoldCounteræ¯ç¨æ¥åä»ä¹ç?\n * ç¼å­è®¡æ°å¨HoldCounteræ¯ç¨æ¥åä»ä¹ç?\n * åéçè·åä¸éæ¾æ¯æä¹å®ç°ç?\n * è¯»éçè·åä¸éæ¾æ¯æä¹å®ç°ç?\n * ä»ä¹æ¯éçåéçº§? RentrantReadWriteLockä¸ºä»ä¹ä¸æ¯æéåçº§?\n\nReentrantReadWriteLockæ¯è¯»åéæ¥å£ReadWriteLockçå®ç°ç±»ï¼å®åæ¬Lockå­ç±»ReadLockåWriteLockãReadLockæ¯å±äº«éï¼WriteLockæ¯ç¬å éã\n\nReentrantReadWriteLock åè®¸å¤ä¸ªçº¿ç¨åæ¶ææè¯»éï¼ä½åªåè®¸ä¸ä¸ªçº¿ç¨ææåéã\n\n * è¯»éï¼å½ä¸ä¸ªçº¿ç¨è·åå°è¯»éæ¶ï¼å¶ä»çº¿ç¨ä¹å¯ä»¥è·åè¯»éï¼ä½ä¸è½è·ååéãå½æåä¸ä¸ªææè¯»éççº¿ç¨éæ¾è¯»éæ¶ï¼å¶ä»ç­å¾çåçº¿ç¨æææºä¼è·ååéã\n\n * åéï¼å½ä¸ä¸ªçº¿ç¨è·åå°åéæ¶ï¼å¶ä»çº¿ç¨æ æ³è·åè¯»éæåéï¼ç´å°åéè¢«éæ¾ã\n\n\n\nåé¨ç±»ï¼ReentrantReadWriteLockæäºä¸ªåé¨ç±»ï¼Syncç»§æ¿èªAQSãNonfairSyncç»§æ¿èªSyncç±»ãFairSyncç»§æ¿èªSyncç±»ï¼ReadLockå®ç°äºLockæ¥å£ãWriteLockä¹å®ç°äºLockæ¥å£ã\n\nSyncç±»åé¨å­å¨ä¸¤ä¸ªåé¨ç±»ï¼åå«ä¸ºHoldCounteråThreadLocalHoldCounterï¼å¶ä¸­HoldCounterä¸»è¦ä¸è¯»ééå¥ä½¿ç¨ã\n\nThreadLocalHoldCounteréåäºThreadLocalçinitialValueæ¹æ³ï¼ThreadLocalç±»å¯ä»¥å°çº¿ç¨ä¸å¯¹è±¡ç¸å³èãå¨æ²¡æè¿è¡setçæåµä¸ï¼getå°çåæ¯initialValueæ¹æ³éé¢çæçé£ä¸ªHolderCounterå¯¹è±¡ã\n\nä»ä¹æ¯éåéçº§?\n\nééçº§æçæ¯åééçº§æä¸ºè¯»éãå¦æå½åçº¿ç¨æ¥æåéï¼ç¶åå°å¶éæ¾ï¼æååè·åè¯»éï¼è¿ç§åæ®µå®æçè¿ç¨ä¸è½ç§°ä¹ä¸ºééçº§ãééçº§æ¯æææä½(å½åæ¥æç)åéï¼åè·åå°è¯»éï¼éåéæ¾(ååæ¥æç)åéçè¿ç¨ã\n\nRentrantReadWriteLockä¸æ¯æéåçº§(ææè¯»éãè·ååéï¼æåéæ¾è¯»éçè¿ç¨)ãç®çä¹æ¯ä¿è¯æ°æ®å¯è§æ§ï¼å¦æè¯»éå·²è¢«å¤ä¸ªçº¿ç¨è·åï¼å¶ä¸­ä»»æçº¿ç¨æåè·åäºåéå¹¶æ´æ°äºæ°æ®ï¼åå¶æ´æ°å¯¹å¶ä»è·åå°è¯»éççº¿ç¨æ¯ä¸å¯è§çã\n\nåºç¨åºæ¯ï¼\n\n 1. è¯»å¤åå°çæåµï¼å½è¯»æä½è¿è¿è¶è¿åæä½æ¶ï¼ä½¿ç¨è¯»åéå¯ä»¥æé«å¹¶åæ§è½ï¼åè®¸å¤ä¸ªçº¿ç¨åæ¶è·åè¯»éï¼ä»èå®ç°å¹¶åè¯»åã\n 2. ç¼å­ç³»ç»ï¼å¨ç¼å­ç³»ç»ä¸­ï¼è¯»æä½éå¸¸æ¯åæä½é¢ç¹ãä½¿ç¨è¯»åéå¯ä»¥è®©å¤ä¸ªçº¿ç¨åæ¶è¯»åç¼å­ï¼æé«è¯»åæ§è½ï¼èå¨åå¥ç¼å­æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®ä¸è´æ§ã\n 3. æ°æ®åºæä½ï¼å¨æ°æ®åºè®¿é®ä¸­ï¼è¯»æä½å¾å¾æ¯åæä½é¢ç¹ãä½¿ç¨è¯»åéå¯ä»¥æé«å¹¶ååº¦ï¼åè®¸å¤ä¸ªçº¿ç¨åæ¶è¯»åæ°æ®åºï¼èå¨åå¥æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®çå®æ´æ§ã\n 4. ä»»å¡è°åº¦å¨ï¼å¨ä»»å¡è°åº¦ç³»ç»ä¸­ï¼å¤ä¸ªä»»å¡å¯è½åæ¶è¯»åå±äº«çä»»å¡åè¡¨ï¼èå¨ä¿®æ¹ä»»å¡åè¡¨æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®çä¸è´æ§ã\n\n> todo: åé tryAcquire åè¯»é tryAcquireShared çå·ä½å®ç°ã\n\n\n# StampedLock\n\nå®æ¯java8å¨java.util.concurrent.locksæ°å¢çä¸ä¸ªAPIã\n\nReentrantReadWriteLock å¨æ²æä»»ä½è¯»åéæ¶ï¼æå¯ä»¥åå¾åå¥éï¼è¿å¯ç¨äºå®ç°äºæ²è§è¯»å(Pessimistic Reading)ï¼å³å¦ææ§è¡ä¸­è¿è¡è¯»åæ¶ï¼ç»å¸¸å¯è½æå¦ä¸æ§è¡è¦åå¥çéæ±ï¼ä¸ºäºä¿æåæ­¥ï¼ReentrantReadWriteLock çè¯»åéå®å°±å¯æ´¾ä¸ç¨åºã\n\nç¶èï¼å¦æè¯»åæ§è¡æåµå¾å¤ï¼åå¥å¾å°çæåµä¸ï¼ä½¿ç¨ ReentrantReadWriteLock å¯è½ä¼ä½¿åå¥çº¿ç¨é­éé¥¥é¥¿(Starvation)é®é¢ï¼ä¹å°±æ¯åå¥çº¿ç¨è¿è¿æ æ³ç«äºå°éå®èä¸ç´å¤äºç­å¾ç¶æã\n\nStampedLockæ§å¶éæä¸ç§æ¨¡å¼(åï¼è¯»ï¼ä¹è§è¯»)ï¼ä¸ä¸ªStampedLockç¶ææ¯ç±çæ¬åæ¨¡å¼ä¸¤ä¸ªé¨åç»æï¼éè·åæ¹æ³è¿åä¸ä¸ªæ°å­ä½ä¸ºç¥¨æ®stampï¼å®ç¨ç¸åºçéç¶æè¡¨ç¤ºå¹¶æ§å¶è®¿é®ï¼æ°å­0è¡¨ç¤ºæ²¡æåéè¢«ææè®¿é®ãå¨è¯»éä¸åä¸ºæ²è§éåä¹è§éã\n\næè°çä¹è§è¯»æ¨¡å¼ï¼ä¹å°±æ¯è¥è¯»çæä½å¾å¤ï¼åçæä½å¾å°çæåµä¸ï¼ä½ å¯ä»¥ä¹è§å°è®¤ä¸ºï¼åå¥ä¸è¯»ååæ¶åçå çå¾å°ï¼å æ­¤ä¸æ²è§å°ä½¿ç¨å®å¨çè¯»åéå®ï¼ç¨åºå¯ä»¥æ¥çè¯»åèµæä¹åï¼æ¯å¦é­å°åå¥æ§è¡çåæ´ï¼åéååç»­çæªæ½(éæ°è¯»ååæ´ä¿¡æ¯ï¼æèæåºå¼å¸¸) ï¼è¿ä¸ä¸ªå°å°æ¹è¿ï¼å¯å¤§å¹åº¦æé«ç¨åºçååéã\n\nStampedLockè¦æ¯ReentrantReadWriteLock æ¶èæ´å°ã\n\nStampedLock åæ¶æ¯æä¹è§éåæ²è§éçç¹æ§ãå¨ StampedLock ä¸­ï¼è¯»æä½ä½¿ç¨ä¹è§éçæ¹å¼è¿è¡ï¼èåæä½åä½¿ç¨æ²è§éã\n\nä¹è§è¯»åæ¯éè¿è°ç¨ tryOptimisticRead æ¹æ³å®ç°çï¼å®è¿åä¸ä¸ªæ è®°ï¼stampï¼ï¼è¡¨ç¤ºå½åæ°æ®ççæ¬å·ãå¨ä¹è§è¯»åè¿ç¨ä¸­ï¼å¦ææ²¡æåçåæä½ï¼è¯»åçæ°æ®æ¯ææçãç¶åå¯ä»¥éè¿è°ç¨ validate æ¹æ³æ¥éªè¯è¯»åæé´æ¯å¦åçäºåæä½ã\n\nå¯¹äºåæä½ï¼StampedLock ä½¿ç¨æ²è§éï¼å³éè¦è·åç¬å éæè½è¿è¡åæä½ãåæä½ä¼é»å¡å¶ä»çè¯»æä½åä¹è§è¯»åï¼ä»¥ä¿è¯æ°æ®çä¸è´æ§ã\n\nåºç¨åºæ¯ï¼\n\n 1. è¯»å¤åå°çæåµï¼StampedLock å¨è¯»å¤åå°çåºæ¯ä¸è¡¨ç°åºè²ãè¯»æä½ä¸ä¼é»å¡å¶ä»è¯»æä½ï¼æé«äºå¹¶åè¯»åçæ§è½ãå½åæä½éå¸¸å°æ¶ï¼å¯ä»¥èèä½¿ç¨ StampedLock æ¥æ¿ä»£ä¼ ç»çè¯»åéã\n 2. å¯¹è¯»æä½çé¡ºåºè¦æ±ä¸ä¸¥æ ¼çæåµï¼StampedLock åè®¸ä¹è§è¯»åï¼å³å¨æ²¡æåæä½çæåµä¸ï¼è¯»æä½å¯ä»¥æ éè·åè¯»éç´æ¥è¿è¡ãè¿ä½¿å¾è¯»æä½æ´å¿«éï¼ç¹å«éç¨äºå¯¹è¯»æä½çé¡ºåºè¦æ±ä¸ä¸¥æ ¼çåºæ¯ã\n 3. è¯»ååç¦»çæ°æ®ç»æï¼StampedLock å¯ä»¥ç¨äºè¯»ååç¦»çæ°æ®ç»æï¼ä¾å¦ç¼å­ãæ°æ®åºç­ãéè¿ä½¿ç¨ä¹è§è¯»ååæ²è§è¯»åï¼å¯ä»¥å®ç°é«æçå¹¶åè¯»åæä½ã\n 4. èªæç­å¾è¯»åï¼StampedLock æä¾äº tryOptimisticRead æ¹æ³ï¼å¯ä»¥è¿è¡èªæç­å¾è¯»åçæä½ãè¿å¨å¯¹è¯»æä½æç»­æ¶é´ç­ãè¯»çº¿ç¨æ°ç®è¾å¤çæåµä¸ï¼å¯ä»¥æé«æ§è½ã\n\néè¦æ³¨æçæ¯ï¼StampedLock å¹¶ä¸éç¨äºé¢ç¹çåæä½ï¼å ä¸ºåæä½éè¦è·åç¬å éï¼èå¶ä»è¯»æä½åä¹è§è¯»åå¯è½ä¼è¢«é»å¡ãå¨éæ©ä½¿ç¨ StampedLock æ¶ï¼éè¦æ ¹æ®å·ä½åºæ¯åéæ±è¿è¡è¯ä¼°ï¼å¹¶èèè¯»åæ¯ä¾ãå¹¶ååº¦ç­å ç´ ã\n\n\n# LockSupport\n\nQuestion:\n\n * ä¸ºä»ä¹LockSupportä¹æ¯æ ¸å¿åºç¡ç±»? AQSæ¡æ¶åå©äºä¸¤ä¸ªç±»ï¼Unsafe(æä¾CASæä½)åLockSupport(æä¾park/unparkæä½)\n * ååºåå«éè¿wait/notifyåLockSupportçpark/unparkå®ç°åæ­¥?\n * LockSupport.park()ä¼éæ¾éèµæºå? é£ä¹Condition.await()å¢?\n * Thread.sleep()ãObject.wait()ãCondition.await()ãLockSupport.park()çåºå«? éç¹\n * å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?\n * å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?\n\nThe LockSupport class in Java provides a set of low-level primitives for synchronizing threads. These primitives are designed to be used as tools for creating higher-level synchronization utilities, and are not in themselves useful for most concurrency control applications.\n\nLockSupportæ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªå·¥å·ç±»ï¼ç¨äºå®ç°çº¿ç¨çé»å¡åå¤éæä½ãå®æä¾äºä¸ç§æ¯ä¼ ç»çObject.wait()åObject.notify()æ´çµæ´»åå¯é ççº¿ç¨ç­å¾/éç¥æºå¶ã\n\nLockSupportç±»éè¿park()æ¹æ³ä½¿çº¿ç¨è¿å¥é»å¡ç¶æï¼èunpark()æ¹æ³åç¨äºå¤éè¢«é»å¡ççº¿ç¨ãç¸æ¯äºObject.wait()åObject.notify()ï¼LockSupportä¸ä¾èµäºå¯¹è±¡ççè§å¨éï¼èæ¯ç´æ¥åçº¿ç¨è¿è¡äº¤äºï¼å æ­¤å¯ä»¥å¨ä»»æä½ç½®ä½¿ç¨ã\n\nä¸å¶ä»çº¿ç¨åæ­¥å·¥å·ç¸æ¯ï¼LockSupportå·æä»¥ä¸ç¹ç¹ï¼\n\n 1. å¯ä»¥å¨ä»»æä½ç½®è¿è¡é»å¡åå¤éæä½ï¼æ éè·å¾å¯¹è±¡çéã\n 2. æ¯ä¸ªçº¿ç¨é½æ¥æä¸ä¸ªè®¸å¯(permit)ï¼permitçåå§å¼ä¸º0ï¼å½permitä¸º0æ¶ï¼è°ç¨park()æ¹æ³ä¼å¯¼è´çº¿ç¨é»å¡ï¼permitä¸º1æ¶ï¼è°ç¨park()æ¹æ³ä¸ä¼é»å¡ã\n 3. unpark()æ¹æ³å¯ä»¥æåç»çº¿ç¨ä¸ä¸ªpermitï¼ä½¿å¶ä¸ä¼è¢«park()æ¹æ³é»å¡ã\n 4. è°ç¨park()æ¹æ³ççº¿ç¨ä¸ä¼åºç°æ­»éæåµï¼å ä¸ºå³ä½¿åè°ç¨unpark()åè°ç¨park()ï¼çº¿ç¨ä¹ä¸ä¼è¢«é»å¡ã\n\nLockSupportæ¯å®ç°éåå¶ä»åæ­¥å·¥å·çåºç¡ï¼å¸¸ç¨äºä¸äºé«çº§å¹¶åæ¡æ¶åå·¥å·çåºå±å®ç°ãå®æä¾äºä¸ç§çµæ´»ãå¯é ççº¿ç¨ç­å¾/éç¥æºå¶ï¼é¿åäºä¼ ç»çwait()/notify()å¯è½åºç°çä¸äºé®é¢ï¼ä½¿çº¿ç¨çé»å¡åå¤éæä½æ´å å¯æ§ã\n\nLockSupport.park();\nLockSupport.unpark(Thread);\n\n\n# Thread.sleep()åObject.wait()çåºå«\n\né¦åï¼æä»¬åæ¥ççThread.sleep()åObject.wait()çåºå«ï¼è¿æ¯ä¸ä¸ªçå¤§è¡çé¢ç®äºï¼å¤§å®¶åºè¯¥é½è½è¯´ä¸æ¥ä¸¤ç¹ã\n\n * Thread.sleep()ä¸ä¼éæ¾å æçéï¼Object.wait()ä¼éæ¾å æçéï¼\n * Thread.sleep()å¿é¡»ä¼ å¥æ¶é´ï¼Object.wait()å¯ä¼ å¯ä¸ä¼ ï¼ä¸ä¼ è¡¨ç¤ºä¸ç´é»å¡ä¸å»ï¼\n * Thread.sleep()å°æ¶é´äºä¼èªå¨å¤éï¼ç¶åç»§ç»­æ§è¡ï¼\n * Object.wait()ä¸å¸¦æ¶é´çï¼éè¦å¦ä¸ä¸ªçº¿ç¨ä½¿ç¨Object.notify()å¤éï¼\n * Object.wait()å¸¦æ¶é´çï¼åå¦æ²¡æè¢«notifyï¼å°æ¶é´äºä¼èªå¨å¤éï¼è¿æ¶ååå¥½ä¸¤ç§æåµï¼ä¸æ¯ç«å³è·åå°äºéï¼çº¿ç¨èªç¶ä¼ç»§ç»­æ§è¡ï¼äºæ¯æ²¡æç«å³è·åéï¼çº¿ç¨è¿å¥åæ­¥éåç­å¾è·åéï¼\n\nå¶å®ï¼ä»ä»¬ä¿©æå¤§çåºå«å°±æ¯Thread.sleep()ä¸ä¼éæ¾éèµæºï¼Object.wait()ä¼éæ¾éèµæºã\n\n# Object.wait()åCondition.await()çåºå«\n\nObject.wait()åCondition.await()çåçæ¯åºæ¬ä¸è´çï¼ä¸åçæ¯Condition.await()åºå±æ¯è°ç¨LockSupport.park()æ¥å®ç°é»å¡å½åçº¿ç¨çã\n\nå®éä¸ï¼å®å¨é»å¡å½åçº¿ç¨ä¹åè¿å¹²äºä¸¤ä»¶äºï¼ä¸æ¯æå½åçº¿ç¨æ·»å å°æ¡ä»¶éåä¸­ï¼äºæ¯âå®å¨âéæ¾éï¼ä¹å°±æ¯è®©stateç¶æåéåä¸º0ï¼ç¶åææ¯è°ç¨LockSupport.park()é»å¡å½åçº¿ç¨ã\n\n# Thread.sleep()åLockSupport.park()çåºå«\n\nLockSupport.park()è¿æå ä¸ªåå¼æ¹æ³ââparkNanos()ãparkUtil()ç­ï¼æä»¬è¿éè¯´çpark()æ¹æ³ç»ç§°è¿ä¸ç±»æ¹æ³ã\n\n * ä»åè½ä¸æ¥è¯´ï¼Thread.sleep()åLockSupport.park()æ¹æ³ç±»ä¼¼ï¼é½æ¯é»å¡å½åçº¿ç¨çæ§è¡ï¼ä¸é½ä¸ä¼éæ¾å½åçº¿ç¨å æçéèµæºï¼\n * Thread.sleep()æ²¡æ³ä»å¤é¨å¤éï¼åªè½èªå·±éè¿æ¥ï¼\n * LockSupport.park()æ¹æ³å¯ä»¥è¢«å¦ä¸ä¸ªçº¿ç¨è°ç¨LockSupport.unpark()æ¹æ³å¤éï¼\n * Thread.sleep()æ¹æ³å£°æä¸æåºäºInterruptedExceptionä¸­æ­å¼å¸¸ï¼æä»¥è°ç¨èéè¦æè·è¿ä¸ªå¼å¸¸æèåæåºï¼\n * LockSupport.park()æ¹æ³ä¸éè¦æè·ä¸­æ­å¼å¸¸ï¼\n * Thread.sleep()æ¬èº«å°±æ¯ä¸ä¸ªnativeæ¹æ³ï¼\n * LockSupport.park()åºå±æ¯è°ç¨çUnsafeçnativeæ¹æ³ï¼\n\n# Object.wait()åLockSupport.park()çåºå«\n\näºèé½ä¼é»å¡å½åçº¿ç¨çè¿è¡ï¼ä»ä»¬æä»ä¹åºå«å¢?\n\n * Object.wait()æ¹æ³éè¦å¨synchronizedåä¸­æ§è¡ï¼\n * LockSupport.park()å¯ä»¥å¨ä»»æå°æ¹æ§è¡ï¼\n * Object.wait()æ¹æ³å£°ææåºäºä¸­æ­å¼å¸¸ï¼è°ç¨èéè¦æè·æèåæåºï¼\n * LockSupport.park()ä¸éè¦æè·ä¸­æ­å¼å¸¸ï¼\n * Object.wait()ä¸å¸¦è¶æ¶çï¼éè¦å¦ä¸ä¸ªçº¿ç¨æ§è¡notify()æ¥å¤éï¼ä½ä¸ä¸å®ç»§ç»­æ§è¡åç»­åå®¹ï¼\n * LockSupport.park()ä¸å¸¦è¶æ¶çï¼éè¦å¦ä¸ä¸ªçº¿ç¨æ§è¡unpark()æ¥å¤éï¼ä¸å®ä¼ç»§ç»­æ§è¡åç»­åå®¹ï¼\n\npark()/unpark()åºå±çåçæ¯âäºåä¿¡å·éâï¼ä½ å¯ä»¥æå®ç¸åæåªæä¸ä¸ªè®¸å¯è¯çSemaphoreï¼åªä¸è¿è¿ä¸ªä¿¡å·éå¨éå¤æ§è¡unpark()çæ¶åä¹ä¸ä¼åå¢å è®¸å¯è¯ï¼æå¤åªæä¸ä¸ªè®¸å¯è¯ã\n\n# å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?\n\nå¦æå½åççº¿ç¨ä¸æ¯æ­¤å¯¹è±¡éçææèï¼å´è°ç¨è¯¥å¯¹è±¡çnotify()æwait()æ¹æ³æ¶æåºIllegalMonitorStateExceptionå¼å¸¸ï¼\n\nå¦æå½åçº¿ç¨æ¯æ­¤å¯¹è±¡éçææèï¼wait()å°ä¸ç´é»å¡ï¼å ä¸ºåç»­å°æ²¡æå¶å®notify()å¤éå®ã\n\n# å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?\n\nçº¿ç¨ä¸ä¼è¢«é»å¡ï¼ç´æ¥è·³è¿park()ï¼ç»§ç»­æ§è¡åç»­åå®¹\n\n# LockSupport.park()ä¼éæ¾éèµæºå?\n\nä¸ä¼ï¼å®åªè´è´£é»å¡å½åçº¿ç¨ï¼éæ¾éèµæºå®éä¸æ¯å¨Conditionçawait()æ¹æ³ä¸­å®ç°çã\n\n\n# Tools\n\n\n# CountDownLatch\n\nquestion:\n\n * ä»ä¹æ¯CountDownLatch?\n * CountDownLatchåºå±å®ç°åç?\n * CountDownLatchä¸æ¬¡å¯ä»¥å¤éå ä¸ªä»»å¡? å¤ä¸ª\n * CountDownLatchæåªäºä¸»è¦æ¹æ³? await(),countDown()\n * CountDownLatchéç¨äºä»ä¹åºæ¯?\n\nä¸å¥è¯ï¼CountDownLatchæ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ä¸ªæå¤ä¸ªçº¿ç¨ç­å¾ä¸ç»æä½å®æååç»§ç»­æ§è¡ã\n\nCountDownLatch is a synchronization tool that allows one or more threads to wait until a set of operations has completed. It is initialized with a count, and each time the countDown() method is called, the count is decremented. When the count reaches zero, all threads that are waiting on the CountDownLatch are released.\n\nCountDownLatch can be used to solve a variety of synchronization problems. For example, it can be used to ensure that all threads in a group have finished executing before a certain task is started, or to ensure that a certain number of resources are available before a task is started.\n\nCountDownLatch latch = new CountDownLatch(5);\nlatch.countDown();\nlatch.await();\n\n\nåºç¨åºæ¯ï¼\n\n 1. å¹¶åä»»å¡çååï¼å½ä¸ä¸ªä»»å¡éè¦ç­å¾å¶ä»å¤ä¸ªä»»å¡å®æåæè½ç»§ç»­æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥å®ç°çº¿ç¨ä¹é´çååãä»»å¡ä¸­ççº¿ç¨å¯ä»¥è°ç¨ CountDownLatch ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼èå¶ä»ä»»å¡ä¸­ççº¿ç¨æ§è¡å®èªå·±çæä½åå¯ä»¥è°ç¨ CountDownLatch ç countDown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ç­å¾ä¸­ççº¿ç¨å°±ä¼è¢«å¤éã\n 2. ç­å¾èµæºåå§åï¼å½ä¸ä¸ªç¨åºéè¦ç­å¾ä¸äºèµæºåå§åå®æåæè½æ­£å¸¸è¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥å®ç°ç­å¾ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾åå§åä»»å¡å®æï¼èåå§åä»»å¡ä¸­ççº¿ç¨å¨å®æåå§ååè°ç¨ countDown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ä¸»çº¿ç¨å°±ä¼è¢«å¤éï¼å¯ä»¥å¼å§æ§è¡åç»­çé»è¾ã\n 3. æµè¯å¤çº¿ç¨æ§è½ï¼å¨æ§è½æµè¯ä¸­ï¼å¯ä»¥ä½¿ç¨ CountDownLatch æ¥æ¨¡æå¹¶ååºæ¯ãä¸»çº¿ç¨å¯ä»¥å¯å¨å¤ä¸ªå·¥ä½çº¿ç¨ï¼è¿äºå·¥ä½çº¿ç¨ä¼æ§è¡ç¸åçä»»å¡ï¼å¹¶å¨ä»»å¡å®ææ¶è°ç¨ countDown() æ¹æ³ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾ææå·¥ä½çº¿ç¨å®æï¼ä»¥ä¾¿ç»è®¡æ§è¡æ¶é´åæ§è½ææ ã\n\n\n# CyclicBarrier\n\n * ä»ä¹æ¯CyclicBarrier?\n * CyclicBarrieråºå±å®ç°åç?\n * CountDownLatchåCyclicBarrierå¯¹æ¯?\n * CyclicBarrierçæ ¸å¿å½æ°æåªäº?\n * CyclicBarrieréç¨äºä»ä¹åºæ¯?\n\nCyclicBarrierï¼å¾ªç¯å±éï¼æ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ç»çº¿ç¨å¨è¾¾å°æä¸ªå±åç¹ä¹åäºç¸ç­å¾ï¼ç¶ååæ¶ç»§ç»­æ§è¡ã\n\nCyclicBarrier çç¹ç¹å¦ä¸ï¼\n\n 1. å±åç¹ï¼CyclicBarrier å¯ä»¥è®¾ç½®ä¸ä¸ªå±åç¹ï¼å½ç­å¾ççº¿ç¨æ°è¾¾å°æå®æ°éæ¶ï¼ææçº¿ç¨å°åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n 2. å¾ªç¯ä½¿ç¨ï¼CyclicBarrier å¯ä»¥è¢«å¤æ¬¡ä½¿ç¨ãå½ææçº¿ç¨é½è¢«éæ¾åï¼CyclicBarrier ä¼è¢«éç½®ï¼å¹¶å¯ä»¥åæ¬¡ä½¿ç¨ã\n 3. ç­å¾ä¸éæ¾ï¼çº¿ç¨éè¿è°ç¨ CyclicBarrier ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼å½æå®æ°éççº¿ç¨é½è°ç¨äº await() æ¹æ³åï¼ææçº¿ç¨ä¼åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n\n// æé æ¹æ³\nCyclicBarrier(int, Runnable); // æå®å³èè¯¥CyclicBarrierççº¿ç¨æ°éï¼å¹¶ä¸å¯ä»¥æå®å¨ææçº¿ç¨é½è¿å¥å±éåçæ§è¡å¨ä½ï¼è¯¥æ§è¡å¨ä½ç±æåä¸ä¸ªè¿è¡å±éççº¿ç¨æ§è¡ã\nCyclicBarrier(int);\n\ncb.await();\n\n\nå¨ææçº¿ç¨è¿å¥å±éåä¼è°ç¨ nextGeneration()ï¼å³çæä¸ä¸ä¸ªçæ¬ï¼ææçº¿ç¨åå¯ä»¥éæ°è¿å¥å°å±éä¸­ãè¦æ³¨æbarrier.await()æ¹æ³çè°ç¨æ¬¡æ°åºè¯¥ä¸åå»ºCyclicBarrieræ¶æå®ççº¿ç¨æ°éç¸å¹éï¼ä»¥ç¡®ä¿æ­£ç¡®çåæ­¥åç­å¾è¡ä¸ºã\n\nCyclicBarrier å CountDonwLatch çå¯¹æ¯\n\n * CountDownLatchåè®¡æ°ï¼CyclicBarrierå è®¡æ°ã\n\n * CountDownLatchæ¯ä¸æ¬¡æ§çï¼CyclicBarrierå¯ä»¥éç¨ã\n\n * CountDownLatchåCyclicBarrieré½æè®©å¤ä¸ªçº¿ç¨ç­å¾åæ­¥ç¶ååå¼å§ä¸ä¸æ­¥å¨ä½çææï¼ä½æ¯CountDownLatchçä¸ä¸æ­¥çå¨ä½å®æ½èæ¯ä¸»çº¿ç¨ï¼å·æä¸å¯éå¤æ§ï¼èCyclicBarrierçä¸ä¸æ­¥å¨ä½å®æ½èè¿æ¯âå¶ä»çº¿ç¨âæ¬èº«ï¼å·æå¾å¤å¤æ¬¡å®æ½å¨ä½çç¹ç¹ã\n\n * å¯¹äºCountDownLatchï¼å¶ä»çº¿ç¨ä¸ºæ¸¸æç©å®¶ï¼æ¯å¦è±éèçï¼ä¸»çº¿ç¨ä¸ºæ§å¶æ¸¸æå¼å§ççº¿ç¨ãå¨ææçç©å®¶é½åå¤å¥½ä¹åï¼ä¸»çº¿ç¨æ¯å¤äºç­å¾ç¶æçï¼ä¹å°±æ¯æ¸¸æä¸è½å¼å§ãå½ææçç©å®¶åå¤å¥½ä¹åï¼ä¸ä¸æ­¥çå¨ä½å®æ½èä¸ºä¸»çº¿ç¨ï¼å³å¼å§æ¸¸æã\n\n * å¯¹äºCyclicBarrierï¼åè®¾æä¸å®¶å¬å¸è¦å¨ä½åå·¥è¿è¡å¢å»ºæ´»å¨ï¼æ´»å¨åå®¹ä¸ºç¿»è¶ä¸ä¸ªéç¢ç©ï¼æ¯ä¸ä¸ªäººç¿»è¶éç¢ç©æç¨çæ¶é´æ¯ä¸ä¸æ ·çãä½æ¯å¬å¸è¦æ±ææäººå¨ç¿»è¶å½åéç¢ç©ä¹ååå¼å§ç¿»è¶ä¸ä¸ä¸ªéç¢ç©ï¼ä¹å°±æ¯ææäººç¿»è¶ç¬¬ä¸ä¸ªéç¢ç©ä¹åï¼æå¼å§ç¿»è¶ç¬¬äºä¸ªï¼ä»¥æ­¤ç±»æ¨ãç±»æ¯å°ï¼æ¯ä¸ä¸ªåå·¥é½æ¯ä¸ä¸ªâå¶ä»çº¿ç¨âãå½ææäººé½ç¿»è¶çææçéç¢ç©ä¹åï¼ç¨åºæç»æãèä¸»çº¿ç¨å¯è½æ©å°±ç»æäºï¼è¿éæä»¬ä¸ç¨ç®¡ä¸»çº¿ç¨ã\n\nCyclicBarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. å¹¶è¡è®¡ç®ä»»å¡çæåä¸åå¹¶ï¼å½ä¸ä¸ªå¤§åè®¡ç®ä»»å¡å¯ä»¥è¢«æåä¸ºå¤ä¸ªå­ä»»å¡å¹¶è¡æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥ç­å¾ææå­ä»»å¡å®æååè¿è¡åå¹¶è®¡ç®ã\n 2. å¤çº¿ç¨ä»»å¡çé¶æ®µåæ­¥ï¼å½ä¸ä¸ªä»»å¡éè¦æç§é¶æ®µè¿è¡å¤æ¬¡å¹¶åæä½ï¼æ¯ä¸ªé¶æ®µéè¦ç­å¾ææçº¿ç¨é½å®æåæè½ç»§ç»­ä¸ä¸é¶æ®µï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥å®ç°é¶æ®µé´çåæ­¥ã\n 3. å¹¶åæµæ°´çº¿çæµç¨æ§å¶ï¼å½å¤ä¸ªçº¿ç¨éè¦æç§ç¹å®çæµæ°´çº¿æ¹å¼æ§è¡ä»»å¡ï¼æ¯ä¸ªçº¿ç¨å¨å®æä¸å®æä½åéè¦ç­å¾å¶ä»çº¿ç¨æè½ç»§ç»­ï¼å¯ä»¥ä½¿ç¨ CyclicBarrier æ¥å®ç°çº¿ç¨ä¹é´çåæ­¥ã\n\n\n# Phaser\n\n\n# Semaphore\n\nSemaphoreï¼ä¿¡å·éï¼æ¯Javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥ç¨äºæ§å¶å¯¹å±äº«èµæºçè®¿é®æ°éãSemaphore ç»´æ¤äºä¸ä¸ªè®¸å¯è¯æ°éï¼çº¿ç¨å¯ä»¥éè¿è·åè®¸å¯è¯æ¥è®¿é®å±äº«èµæºï¼èå½è®¸å¯è¯ä¸å¯ç¨æ¶ï¼çº¿ç¨éè¦ç­å¾å¶ä»çº¿ç¨éæ¾è®¸å¯è¯ã\n\nSemaphore çç¹ç¹å¦ä¸ï¼\n\n 1. è®¸å¯è¯æ°éï¼Semaphore éè¿ä¸ä¸ªæ´æ°æ¥è¡¨ç¤ºå¯ç¨çè®¸å¯è¯æ°éãçº¿ç¨å¯ä»¥éè¿ acquire() æ¹æ³è·åä¸ä¸ªè®¸å¯è¯ï¼è¡¨ç¤ºå ç¨äºä¸ä¸ªèµæºï¼è release() æ¹æ³åéæ¾ä¸ä¸ªè®¸å¯è¯ï¼è¡¨ç¤ºéæ¾äºä¸ä¸ªèµæºã\n 2. å¬å¹³æ§ï¼Semaphore å¯ä»¥éæ©æ¯å¦å¬å¹³å°æ§å¶è®¸å¯è¯çè·åãå¬å¹³æ§è¡¨ç¤ºç­å¾æ¶é´æé¿ççº¿ç¨å°ä¼åè·åè®¸å¯è¯ï¼èéå¬å¹³æ§åæ²¡æè¿ä¸ªä¿è¯ã\n\nSemaphore çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. æéèµæºçå¹¶åè®¿é®æ§å¶ï¼å½ç³»ç»ä¸­å­å¨æéçèµæºï¼å¦æ°æ®åºè¿æ¥ãçº¿ç¨æ± ç­ï¼å¯ä»¥ä½¿ç¨ Semaphore æ¥æ§å¶å¯¹è¿äºèµæºçå¹¶åè®¿é®æ°éï¼ä»¥é¿åèµæºè¿è½½ã\n 2. æµéæ§å¶ï¼å½éè¦éå¶æä¸ªæä½çå¹¶åæ°éï¼ä»¥æ§å¶æµéæé¿åè¿åº¦çè¯·æ±ååæ¶ï¼å¯ä»¥ä½¿ç¨ Semaphore æ¥å®ç°éæµã\n 3. çº¿ç¨æ± ç®¡çï¼Semaphore å¯ä»¥ç¨äºå®ç°çº¿ç¨æ± ä¸­çå·¥ä½çº¿ç¨æ°éæ§å¶ï¼éè¿éå¶è®¸å¯è¯æ°éï¼æ§å¶åæ¶æ§è¡çä»»å¡æ°éã\n\næ ¸å¿æ¹æ³\n\npublic Semaphore(int permits);\npublic Semaphore(int permits, boolean fair);\n\nsemaphore.acquire();\nsemaphore.acquire(int);\nsemaphore.release();\nsemaphore.release(int);\n\n\nNote: è°ç¨release()ä¼æ·»å ä»¤çï¼å¹¶ä¸ä¼ä»¥åå§åçå¤§å°ä¸ºåãSemaphoreä¸­releaseæ¹æ³çè°ç¨å¹¶æ²¡æéå¶è¦å¨acquireåè°ç¨ã\n\n\n# Exchanger\n\n\n# Collections\n\n\n# Queue\n\n\n# List\n\n\n# Set\n\n\n# Map\n\n\n# Atomic\n\n\n# åºç¡ç±»å\n\n\n# æ°ç»\n\n\n# å¼ç¨\n\n\n# Executor\n\n\n# æ¥å£ï¼Executor\n\n\n# ExecutorService\n\n\n# ScheduledExecutorService\n\n\n# AbstractExecutorService\n\n\n# FutureTask\n\n\n# ThreadPoolExecutor\n\n\n# ScheduledThreadPoolExecutor\n\n\n# Fork/Join Framework\n\n\n# Executors\n\n\n# Reference\n\nhttps://pdai.tech/md/java/thread/java-thread-x-juc-overview.html#atomic-%E5%8E%9F%E5%AD%90%E7%B1%BB",normalizedContent:"# base\n\n\n\næ¥å£ï¼condition\n\nconditionä¸ºæ¥å£ç±»åï¼å®å° object çè§å¨æ¹æ³(waitãnotify å notifyall)åè§£ææªç¶ä¸åçå¯¹è±¡ï¼ä»¥ä¾¿éè¿å°è¿äºå¯¹è±¡ä¸ä»»æ lock å®ç°ç»åä½¿ç¨ï¼ä¸ºæ¯ä¸ªå¯¹è±¡æä¾å¤ä¸ªç­å¾ set (wait-set)ãå¶ä¸­ï¼lock æ¿ä»£äº synchronized æ¹æ³åè¯­å¥çä½¿ç¨ï¼condition æ¿ä»£äº object çè§å¨æ¹æ³çä½¿ç¨ãå¯ä»¥éè¿await(),signal()æ¥ä¼ç /å¤éçº¿ç¨ã\n\ncondition çå®ç°ç±»æ¯ aqs åaqls çåé¨ç±» conditionobject ã\n\n\n# locks\n\n\n# reentrantlock\n\nquestionï¼\n\n * ä»ä¹æ¯å¯éå¥ï¼ä»ä¹æ¯å¯éå¥é? å®ç¨æ¥è§£å³ä»ä¹é®é¢?\n * reentrantlockçæ ¸å¿æ¯aqsï¼é£ä¹å®æä¹æ¥å®ç°çï¼ç»§æ¿å? è¯´è¯´å¶ç±»åé¨ç»æå³ç³»ã\n * reentrantlockæ¯å¦ä½å®ç°å¬å¹³éç?\n * reentrantlockæ¯å¦ä½å®ç°éå¬å¹³éç?\n * reentrantlocké»è®¤å®ç°çæ¯å¬å¹³è¿æ¯éå¬å¹³é?\n * ä½¿ç¨reentrantlockå®ç°å¬å¹³åéå¬å¹³éçç¤ºä¾?\n * reentrantlockåsynchronizedçå¯¹æ¯?\n\nreentrantlockä¸ºå¸¸ç¨ç±»ï¼å®æ¯ä¸ä¸ªå¯éå¥çäºæ¥é lockï¼å®å·æä¸ä½¿ç¨ synchronized æ¹æ³åè¯­å¥æè®¿é®çéå¼çè§å¨éç¸åçä¸äºåºæ¬è¡ä¸ºåè¯­ä¹ï¼ä½åè½æ´å¼ºå¤§ã\n\nreentrantlock ä¸­çåé¨ç±»ï¼reentrantlockç±»åé¨æ»å±å­å¨syncãnonfairsyncãfairsyncä¸ä¸ªç±»ï¼nonfairsyncä¸fairsyncç±»ç»§æ¿èªsyncç±»ï¼syncç±»ç»§æ¿èªabstractqueuedsynchronizeræ½è±¡ç±»ã\n\nè°ç¨é¾ï¼\n\nå¬å¹³éçè°ç¨æåçæåµï¼lock:lock -> fairsync:lock ->aqs:acquire -> fairsync:tryacquire -> aqs:hasqueuedpredecessors -> aqs:setexclusiveownerthread\n\nfairsync:lock å½èµæºè¢«å ç¨çæåµï¼fairsync:lock -> aqs:acquire -> fairsync:tryacquire -> aqs:addwaiter -> aqs:acquirequeued\n\n\n# reentrantreadwritelock\n\nquestionï¼\n\n * ä¸ºäºæäºreentrantlockè¿éè¦reentrantreadwritelock?\n * reentrantreadwritelockåºå±å®ç°åç?\n * reentrantreadwritelockåºå±è¯»åç¶æå¦ä½è®¾è®¡ç? é«16ä½ä¸ºè¯»éï¼ä½16ä½ä¸ºåé\n * è¯»éååéçæå¤§æ°éæ¯å¤å°?\n * æ¬å°çº¿ç¨è®¡æ°å¨threadlocalholdcounteræ¯ç¨æ¥åä»ä¹ç?\n * ç¼å­è®¡æ°å¨holdcounteræ¯ç¨æ¥åä»ä¹ç?\n * åéçè·åä¸éæ¾æ¯æä¹å®ç°ç?\n * è¯»éçè·åä¸éæ¾æ¯æä¹å®ç°ç?\n * ä»ä¹æ¯éçåéçº§? rentrantreadwritelockä¸ºä»ä¹ä¸æ¯æéåçº§?\n\nreentrantreadwritelockæ¯è¯»åéæ¥å£readwritelockçå®ç°ç±»ï¼å®åæ¬lockå­ç±»readlockåwritelockãreadlockæ¯å±äº«éï¼writelockæ¯ç¬å éã\n\nreentrantreadwritelock åè®¸å¤ä¸ªçº¿ç¨åæ¶ææè¯»éï¼ä½åªåè®¸ä¸ä¸ªçº¿ç¨ææåéã\n\n * è¯»éï¼å½ä¸ä¸ªçº¿ç¨è·åå°è¯»éæ¶ï¼å¶ä»çº¿ç¨ä¹å¯ä»¥è·åè¯»éï¼ä½ä¸è½è·ååéãå½æåä¸ä¸ªææè¯»éççº¿ç¨éæ¾è¯»éæ¶ï¼å¶ä»ç­å¾çåçº¿ç¨æææºä¼è·ååéã\n\n * åéï¼å½ä¸ä¸ªçº¿ç¨è·åå°åéæ¶ï¼å¶ä»çº¿ç¨æ æ³è·åè¯»éæåéï¼ç´å°åéè¢«éæ¾ã\n\n\n\nåé¨ç±»ï¼reentrantreadwritelockæäºä¸ªåé¨ç±»ï¼syncç»§æ¿èªaqsãnonfairsyncç»§æ¿èªsyncç±»ãfairsyncç»§æ¿èªsyncç±»ï¼readlockå®ç°äºlockæ¥å£ãwritelockä¹å®ç°äºlockæ¥å£ã\n\nsyncç±»åé¨å­å¨ä¸¤ä¸ªåé¨ç±»ï¼åå«ä¸ºholdcounteråthreadlocalholdcounterï¼å¶ä¸­holdcounterä¸»è¦ä¸è¯»ééå¥ä½¿ç¨ã\n\nthreadlocalholdcounteréåäºthreadlocalçinitialvalueæ¹æ³ï¼threadlocalç±»å¯ä»¥å°çº¿ç¨ä¸å¯¹è±¡ç¸å³èãå¨æ²¡æè¿è¡setçæåµä¸ï¼getå°çåæ¯initialvalueæ¹æ³éé¢çæçé£ä¸ªholdercounterå¯¹è±¡ã\n\nä»ä¹æ¯éåéçº§?\n\nééçº§æçæ¯åééçº§æä¸ºè¯»éãå¦æå½åçº¿ç¨æ¥æåéï¼ç¶åå°å¶éæ¾ï¼æååè·åè¯»éï¼è¿ç§åæ®µå®æçè¿ç¨ä¸è½ç§°ä¹ä¸ºééçº§ãééçº§æ¯æææä½(å½åæ¥æç)åéï¼åè·åå°è¯»éï¼éåéæ¾(ååæ¥æç)åéçè¿ç¨ã\n\nrentrantreadwritelockä¸æ¯æéåçº§(ææè¯»éãè·ååéï¼æåéæ¾è¯»éçè¿ç¨)ãç®çä¹æ¯ä¿è¯æ°æ®å¯è§æ§ï¼å¦æè¯»éå·²è¢«å¤ä¸ªçº¿ç¨è·åï¼å¶ä¸­ä»»æçº¿ç¨æåè·åäºåéå¹¶æ´æ°äºæ°æ®ï¼åå¶æ´æ°å¯¹å¶ä»è·åå°è¯»éççº¿ç¨æ¯ä¸å¯è§çã\n\nåºç¨åºæ¯ï¼\n\n 1. è¯»å¤åå°çæåµï¼å½è¯»æä½è¿è¿è¶è¿åæä½æ¶ï¼ä½¿ç¨è¯»åéå¯ä»¥æé«å¹¶åæ§è½ï¼åè®¸å¤ä¸ªçº¿ç¨åæ¶è·åè¯»éï¼ä»èå®ç°å¹¶åè¯»åã\n 2. ç¼å­ç³»ç»ï¼å¨ç¼å­ç³»ç»ä¸­ï¼è¯»æä½éå¸¸æ¯åæä½é¢ç¹ãä½¿ç¨è¯»åéå¯ä»¥è®©å¤ä¸ªçº¿ç¨åæ¶è¯»åç¼å­ï¼æé«è¯»åæ§è½ï¼èå¨åå¥ç¼å­æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®ä¸è´æ§ã\n 3. æ°æ®åºæä½ï¼å¨æ°æ®åºè®¿é®ä¸­ï¼è¯»æä½å¾å¾æ¯åæä½é¢ç¹ãä½¿ç¨è¯»åéå¯ä»¥æé«å¹¶ååº¦ï¼åè®¸å¤ä¸ªçº¿ç¨åæ¶è¯»åæ°æ®åºï¼èå¨åå¥æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®çå®æ´æ§ã\n 4. ä»»å¡è°åº¦å¨ï¼å¨ä»»å¡è°åº¦ç³»ç»ä¸­ï¼å¤ä¸ªä»»å¡å¯è½åæ¶è¯»åå±äº«çä»»å¡åè¡¨ï¼èå¨ä¿®æ¹ä»»å¡åè¡¨æ¶éè¦ç¬å åéä»¥ä¿è¯æ°æ®çä¸è´æ§ã\n\n> todo: åé tryacquire åè¯»é tryacquireshared çå·ä½å®ç°ã\n\n\n# stampedlock\n\nå®æ¯java8å¨java.util.concurrent.locksæ°å¢çä¸ä¸ªapiã\n\nreentrantreadwritelock å¨æ²æä»»ä½è¯»åéæ¶ï¼æå¯ä»¥åå¾åå¥éï¼è¿å¯ç¨äºå®ç°äºæ²è§è¯»å(pessimistic reading)ï¼å³å¦ææ§è¡ä¸­è¿è¡è¯»åæ¶ï¼ç»å¸¸å¯è½æå¦ä¸æ§è¡è¦åå¥çéæ±ï¼ä¸ºäºä¿æåæ­¥ï¼reentrantreadwritelock çè¯»åéå®å°±å¯æ´¾ä¸ç¨åºã\n\nç¶èï¼å¦æè¯»åæ§è¡æåµå¾å¤ï¼åå¥å¾å°çæåµä¸ï¼ä½¿ç¨ reentrantreadwritelock å¯è½ä¼ä½¿åå¥çº¿ç¨é­éé¥¥é¥¿(starvation)é®é¢ï¼ä¹å°±æ¯åå¥çº¿ç¨è¿è¿æ æ³ç«äºå°éå®èä¸ç´å¤äºç­å¾ç¶æã\n\nstampedlockæ§å¶éæä¸ç§æ¨¡å¼(åï¼è¯»ï¼ä¹è§è¯»)ï¼ä¸ä¸ªstampedlockç¶ææ¯ç±çæ¬åæ¨¡å¼ä¸¤ä¸ªé¨åç»æï¼éè·åæ¹æ³è¿åä¸ä¸ªæ°å­ä½ä¸ºç¥¨æ®stampï¼å®ç¨ç¸åºçéç¶æè¡¨ç¤ºå¹¶æ§å¶è®¿é®ï¼æ°å­0è¡¨ç¤ºæ²¡æåéè¢«ææè®¿é®ãå¨è¯»éä¸åä¸ºæ²è§éåä¹è§éã\n\næè°çä¹è§è¯»æ¨¡å¼ï¼ä¹å°±æ¯è¥è¯»çæä½å¾å¤ï¼åçæä½å¾å°çæåµä¸ï¼ä½ å¯ä»¥ä¹è§å°è®¤ä¸ºï¼åå¥ä¸è¯»ååæ¶åçå çå¾å°ï¼å æ­¤ä¸æ²è§å°ä½¿ç¨å®å¨çè¯»åéå®ï¼ç¨åºå¯ä»¥æ¥çè¯»åèµæä¹åï¼æ¯å¦é­å°åå¥æ§è¡çåæ´ï¼åéååç»­çæªæ½(éæ°è¯»ååæ´ä¿¡æ¯ï¼æèæåºå¼å¸¸) ï¼è¿ä¸ä¸ªå°å°æ¹è¿ï¼å¯å¤§å¹åº¦æé«ç¨åºçååéã\n\nstampedlockè¦æ¯reentrantreadwritelock æ¶èæ´å°ã\n\nstampedlock åæ¶æ¯æä¹è§éåæ²è§éçç¹æ§ãå¨ stampedlock ä¸­ï¼è¯»æä½ä½¿ç¨ä¹è§éçæ¹å¼è¿è¡ï¼èåæä½åä½¿ç¨æ²è§éã\n\nä¹è§è¯»åæ¯éè¿è°ç¨ tryoptimisticread æ¹æ³å®ç°çï¼å®è¿åä¸ä¸ªæ è®°ï¼stampï¼ï¼è¡¨ç¤ºå½åæ°æ®ççæ¬å·ãå¨ä¹è§è¯»åè¿ç¨ä¸­ï¼å¦ææ²¡æåçåæä½ï¼è¯»åçæ°æ®æ¯ææçãç¶åå¯ä»¥éè¿è°ç¨ validate æ¹æ³æ¥éªè¯è¯»åæé´æ¯å¦åçäºåæä½ã\n\nå¯¹äºåæä½ï¼stampedlock ä½¿ç¨æ²è§éï¼å³éè¦è·åç¬å éæè½è¿è¡åæä½ãåæä½ä¼é»å¡å¶ä»çè¯»æä½åä¹è§è¯»åï¼ä»¥ä¿è¯æ°æ®çä¸è´æ§ã\n\nåºç¨åºæ¯ï¼\n\n 1. è¯»å¤åå°çæåµï¼stampedlock å¨è¯»å¤åå°çåºæ¯ä¸è¡¨ç°åºè²ãè¯»æä½ä¸ä¼é»å¡å¶ä»è¯»æä½ï¼æé«äºå¹¶åè¯»åçæ§è½ãå½åæä½éå¸¸å°æ¶ï¼å¯ä»¥èèä½¿ç¨ stampedlock æ¥æ¿ä»£ä¼ ç»çè¯»åéã\n 2. å¯¹è¯»æä½çé¡ºåºè¦æ±ä¸ä¸¥æ ¼çæåµï¼stampedlock åè®¸ä¹è§è¯»åï¼å³å¨æ²¡æåæä½çæåµä¸ï¼è¯»æä½å¯ä»¥æ éè·åè¯»éç´æ¥è¿è¡ãè¿ä½¿å¾è¯»æä½æ´å¿«éï¼ç¹å«éç¨äºå¯¹è¯»æä½çé¡ºåºè¦æ±ä¸ä¸¥æ ¼çåºæ¯ã\n 3. è¯»ååç¦»çæ°æ®ç»æï¼stampedlock å¯ä»¥ç¨äºè¯»ååç¦»çæ°æ®ç»æï¼ä¾å¦ç¼å­ãæ°æ®åºç­ãéè¿ä½¿ç¨ä¹è§è¯»ååæ²è§è¯»åï¼å¯ä»¥å®ç°é«æçå¹¶åè¯»åæä½ã\n 4. èªæç­å¾è¯»åï¼stampedlock æä¾äº tryoptimisticread æ¹æ³ï¼å¯ä»¥è¿è¡èªæç­å¾è¯»åçæä½ãè¿å¨å¯¹è¯»æä½æç»­æ¶é´ç­ãè¯»çº¿ç¨æ°ç®è¾å¤çæåµä¸ï¼å¯ä»¥æé«æ§è½ã\n\néè¦æ³¨æçæ¯ï¼stampedlock å¹¶ä¸éç¨äºé¢ç¹çåæä½ï¼å ä¸ºåæä½éè¦è·åç¬å éï¼èå¶ä»è¯»æä½åä¹è§è¯»åå¯è½ä¼è¢«é»å¡ãå¨éæ©ä½¿ç¨ stampedlock æ¶ï¼éè¦æ ¹æ®å·ä½åºæ¯åéæ±è¿è¡è¯ä¼°ï¼å¹¶èèè¯»åæ¯ä¾ãå¹¶ååº¦ç­å ç´ ã\n\n\n# locksupport\n\nquestion:\n\n * ä¸ºä»ä¹locksupportä¹æ¯æ ¸å¿åºç¡ç±»? aqsæ¡æ¶åå©äºä¸¤ä¸ªç±»ï¼unsafe(æä¾casæä½)ålocksupport(æä¾park/unparkæä½)\n * ååºåå«éè¿wait/notifyålocksupportçpark/unparkå®ç°åæ­¥?\n * locksupport.park()ä¼éæ¾éèµæºå? é£ä¹condition.await()å¢?\n * thread.sleep()ãobject.wait()ãcondition.await()ãlocksupport.park()çåºå«? éç¹\n * å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?\n * å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?\n\nthe locksupport class in java provides a set of low-level primitives for synchronizing threads. these primitives are designed to be used as tools for creating higher-level synchronization utilities, and are not in themselves useful for most concurrency control applications.\n\nlocksupportæ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªå·¥å·ç±»ï¼ç¨äºå®ç°çº¿ç¨çé»å¡åå¤éæä½ãå®æä¾äºä¸ç§æ¯ä¼ ç»çobject.wait()åobject.notify()æ´çµæ´»åå¯é ççº¿ç¨ç­å¾/éç¥æºå¶ã\n\nlocksupportç±»éè¿park()æ¹æ³ä½¿çº¿ç¨è¿å¥é»å¡ç¶æï¼èunpark()æ¹æ³åç¨äºå¤éè¢«é»å¡ççº¿ç¨ãç¸æ¯äºobject.wait()åobject.notify()ï¼locksupportä¸ä¾èµäºå¯¹è±¡ççè§å¨éï¼èæ¯ç´æ¥åçº¿ç¨è¿è¡äº¤äºï¼å æ­¤å¯ä»¥å¨ä»»æä½ç½®ä½¿ç¨ã\n\nä¸å¶ä»çº¿ç¨åæ­¥å·¥å·ç¸æ¯ï¼locksupportå·æä»¥ä¸ç¹ç¹ï¼\n\n 1. å¯ä»¥å¨ä»»æä½ç½®è¿è¡é»å¡åå¤éæä½ï¼æ éè·å¾å¯¹è±¡çéã\n 2. æ¯ä¸ªçº¿ç¨é½æ¥æä¸ä¸ªè®¸å¯(permit)ï¼permitçåå§å¼ä¸º0ï¼å½permitä¸º0æ¶ï¼è°ç¨park()æ¹æ³ä¼å¯¼è´çº¿ç¨é»å¡ï¼permitä¸º1æ¶ï¼è°ç¨park()æ¹æ³ä¸ä¼é»å¡ã\n 3. unpark()æ¹æ³å¯ä»¥æåç»çº¿ç¨ä¸ä¸ªpermitï¼ä½¿å¶ä¸ä¼è¢«park()æ¹æ³é»å¡ã\n 4. è°ç¨park()æ¹æ³ççº¿ç¨ä¸ä¼åºç°æ­»éæåµï¼å ä¸ºå³ä½¿åè°ç¨unpark()åè°ç¨park()ï¼çº¿ç¨ä¹ä¸ä¼è¢«é»å¡ã\n\nlocksupportæ¯å®ç°éåå¶ä»åæ­¥å·¥å·çåºç¡ï¼å¸¸ç¨äºä¸äºé«çº§å¹¶åæ¡æ¶åå·¥å·çåºå±å®ç°ãå®æä¾äºä¸ç§çµæ´»ãå¯é ççº¿ç¨ç­å¾/éç¥æºå¶ï¼é¿åäºä¼ ç»çwait()/notify()å¯è½åºç°çä¸äºé®é¢ï¼ä½¿çº¿ç¨çé»å¡åå¤éæä½æ´å å¯æ§ã\n\nlocksupport.park();\nlocksupport.unpark(thread);\n\n\n# thread.sleep()åobject.wait()çåºå«\n\né¦åï¼æä»¬åæ¥ççthread.sleep()åobject.wait()çåºå«ï¼è¿æ¯ä¸ä¸ªçå¤§è¡çé¢ç®äºï¼å¤§å®¶åºè¯¥é½è½è¯´ä¸æ¥ä¸¤ç¹ã\n\n * thread.sleep()ä¸ä¼éæ¾å æçéï¼object.wait()ä¼éæ¾å æçéï¼\n * thread.sleep()å¿é¡»ä¼ å¥æ¶é´ï¼object.wait()å¯ä¼ å¯ä¸ä¼ ï¼ä¸ä¼ è¡¨ç¤ºä¸ç´é»å¡ä¸å»ï¼\n * thread.sleep()å°æ¶é´äºä¼èªå¨å¤éï¼ç¶åç»§ç»­æ§è¡ï¼\n * object.wait()ä¸å¸¦æ¶é´çï¼éè¦å¦ä¸ä¸ªçº¿ç¨ä½¿ç¨object.notify()å¤éï¼\n * object.wait()å¸¦æ¶é´çï¼åå¦æ²¡æè¢«notifyï¼å°æ¶é´äºä¼èªå¨å¤éï¼è¿æ¶ååå¥½ä¸¤ç§æåµï¼ä¸æ¯ç«å³è·åå°äºéï¼çº¿ç¨èªç¶ä¼ç»§ç»­æ§è¡ï¼äºæ¯æ²¡æç«å³è·åéï¼çº¿ç¨è¿å¥åæ­¥éåç­å¾è·åéï¼\n\nå¶å®ï¼ä»ä»¬ä¿©æå¤§çåºå«å°±æ¯thread.sleep()ä¸ä¼éæ¾éèµæºï¼object.wait()ä¼éæ¾éèµæºã\n\n# object.wait()åcondition.await()çåºå«\n\nobject.wait()åcondition.await()çåçæ¯åºæ¬ä¸è´çï¼ä¸åçæ¯condition.await()åºå±æ¯è°ç¨locksupport.park()æ¥å®ç°é»å¡å½åçº¿ç¨çã\n\nå®éä¸ï¼å®å¨é»å¡å½åçº¿ç¨ä¹åè¿å¹²äºä¸¤ä»¶äºï¼ä¸æ¯æå½åçº¿ç¨æ·»å å°æ¡ä»¶éåä¸­ï¼äºæ¯âå®å¨âéæ¾éï¼ä¹å°±æ¯è®©stateç¶æåéåä¸º0ï¼ç¶åææ¯è°ç¨locksupport.park()é»å¡å½åçº¿ç¨ã\n\n# thread.sleep()ålocksupport.park()çåºå«\n\nlocksupport.park()è¿æå ä¸ªåå¼æ¹æ³ââparknanos()ãparkutil()ç­ï¼æä»¬è¿éè¯´çpark()æ¹æ³ç»ç§°è¿ä¸ç±»æ¹æ³ã\n\n * ä»åè½ä¸æ¥è¯´ï¼thread.sleep()ålocksupport.park()æ¹æ³ç±»ä¼¼ï¼é½æ¯é»å¡å½åçº¿ç¨çæ§è¡ï¼ä¸é½ä¸ä¼éæ¾å½åçº¿ç¨å æçéèµæºï¼\n * thread.sleep()æ²¡æ³ä»å¤é¨å¤éï¼åªè½èªå·±éè¿æ¥ï¼\n * locksupport.park()æ¹æ³å¯ä»¥è¢«å¦ä¸ä¸ªçº¿ç¨è°ç¨locksupport.unpark()æ¹æ³å¤éï¼\n * thread.sleep()æ¹æ³å£°æä¸æåºäºinterruptedexceptionä¸­æ­å¼å¸¸ï¼æä»¥è°ç¨èéè¦æè·è¿ä¸ªå¼å¸¸æèåæåºï¼\n * locksupport.park()æ¹æ³ä¸éè¦æè·ä¸­æ­å¼å¸¸ï¼\n * thread.sleep()æ¬èº«å°±æ¯ä¸ä¸ªnativeæ¹æ³ï¼\n * locksupport.park()åºå±æ¯è°ç¨çunsafeçnativeæ¹æ³ï¼\n\n# object.wait()ålocksupport.park()çåºå«\n\näºèé½ä¼é»å¡å½åçº¿ç¨çè¿è¡ï¼ä»ä»¬æä»ä¹åºå«å¢?\n\n * object.wait()æ¹æ³éè¦å¨synchronizedåä¸­æ§è¡ï¼\n * locksupport.park()å¯ä»¥å¨ä»»æå°æ¹æ§è¡ï¼\n * object.wait()æ¹æ³å£°ææåºäºä¸­æ­å¼å¸¸ï¼è°ç¨èéè¦æè·æèåæåºï¼\n * locksupport.park()ä¸éè¦æè·ä¸­æ­å¼å¸¸ï¼\n * object.wait()ä¸å¸¦è¶æ¶çï¼éè¦å¦ä¸ä¸ªçº¿ç¨æ§è¡notify()æ¥å¤éï¼ä½ä¸ä¸å®ç»§ç»­æ§è¡åç»­åå®¹ï¼\n * locksupport.park()ä¸å¸¦è¶æ¶çï¼éè¦å¦ä¸ä¸ªçº¿ç¨æ§è¡unpark()æ¥å¤éï¼ä¸å®ä¼ç»§ç»­æ§è¡åç»­åå®¹ï¼\n\npark()/unpark()åºå±çåçæ¯âäºåä¿¡å·éâï¼ä½ å¯ä»¥æå®ç¸åæåªæä¸ä¸ªè®¸å¯è¯çsemaphoreï¼åªä¸è¿è¿ä¸ªä¿¡å·éå¨éå¤æ§è¡unpark()çæ¶åä¹ä¸ä¼åå¢å è®¸å¯è¯ï¼æå¤åªæä¸ä¸ªè®¸å¯è¯ã\n\n# å¦æå¨wait()ä¹åæ§è¡äºnotify()ä¼ææ ·?\n\nå¦æå½åççº¿ç¨ä¸æ¯æ­¤å¯¹è±¡éçææèï¼å´è°ç¨è¯¥å¯¹è±¡çnotify()æwait()æ¹æ³æ¶æåºillegalmonitorstateexceptionå¼å¸¸ï¼\n\nå¦æå½åçº¿ç¨æ¯æ­¤å¯¹è±¡éçææèï¼wait()å°ä¸ç´é»å¡ï¼å ä¸ºåç»­å°æ²¡æå¶å®notify()å¤éå®ã\n\n# å¦æå¨park()ä¹åæ§è¡äºunpark()ä¼ææ ·?\n\nçº¿ç¨ä¸ä¼è¢«é»å¡ï¼ç´æ¥è·³è¿park()ï¼ç»§ç»­æ§è¡åç»­åå®¹\n\n# locksupport.park()ä¼éæ¾éèµæºå?\n\nä¸ä¼ï¼å®åªè´è´£é»å¡å½åçº¿ç¨ï¼éæ¾éèµæºå®éä¸æ¯å¨conditionçawait()æ¹æ³ä¸­å®ç°çã\n\n\n# tools\n\n\n# countdownlatch\n\nquestion:\n\n * ä»ä¹æ¯countdownlatch?\n * countdownlatchåºå±å®ç°åç?\n * countdownlatchä¸æ¬¡å¯ä»¥å¤éå ä¸ªä»»å¡? å¤ä¸ª\n * countdownlatchæåªäºä¸»è¦æ¹æ³? await(),countdown()\n * countdownlatchéç¨äºä»ä¹åºæ¯?\n\nä¸å¥è¯ï¼countdownlatchæ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ä¸ªæå¤ä¸ªçº¿ç¨ç­å¾ä¸ç»æä½å®æååç»§ç»­æ§è¡ã\n\ncountdownlatch is a synchronization tool that allows one or more threads to wait until a set of operations has completed. it is initialized with a count, and each time the countdown() method is called, the count is decremented. when the count reaches zero, all threads that are waiting on the countdownlatch are released.\n\ncountdownlatch can be used to solve a variety of synchronization problems. for example, it can be used to ensure that all threads in a group have finished executing before a certain task is started, or to ensure that a certain number of resources are available before a task is started.\n\ncountdownlatch latch = new countdownlatch(5);\nlatch.countdown();\nlatch.await();\n\n\nåºç¨åºæ¯ï¼\n\n 1. å¹¶åä»»å¡çååï¼å½ä¸ä¸ªä»»å¡éè¦ç­å¾å¶ä»å¤ä¸ªä»»å¡å®æåæè½ç»§ç»­æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥å®ç°çº¿ç¨ä¹é´çååãä»»å¡ä¸­ççº¿ç¨å¯ä»¥è°ç¨ countdownlatch ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼èå¶ä»ä»»å¡ä¸­ççº¿ç¨æ§è¡å®èªå·±çæä½åå¯ä»¥è°ç¨ countdownlatch ç countdown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ç­å¾ä¸­ççº¿ç¨å°±ä¼è¢«å¤éã\n 2. ç­å¾èµæºåå§åï¼å½ä¸ä¸ªç¨åºéè¦ç­å¾ä¸äºèµæºåå§åå®æåæè½æ­£å¸¸è¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥å®ç°ç­å¾ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾åå§åä»»å¡å®æï¼èåå§åä»»å¡ä¸­ççº¿ç¨å¨å®æåå§ååè°ç¨ countdown() æ¹æ³æ¥åå°è®¡æ°å¨ï¼å½è®¡æ°å¨åè³é¶æ¶ï¼ä¸»çº¿ç¨å°±ä¼è¢«å¤éï¼å¯ä»¥å¼å§æ§è¡åç»­çé»è¾ã\n 3. æµè¯å¤çº¿ç¨æ§è½ï¼å¨æ§è½æµè¯ä¸­ï¼å¯ä»¥ä½¿ç¨ countdownlatch æ¥æ¨¡æå¹¶ååºæ¯ãä¸»çº¿ç¨å¯ä»¥å¯å¨å¤ä¸ªå·¥ä½çº¿ç¨ï¼è¿äºå·¥ä½çº¿ç¨ä¼æ§è¡ç¸åçä»»å¡ï¼å¹¶å¨ä»»å¡å®ææ¶è°ç¨ countdown() æ¹æ³ãä¸»çº¿ç¨å¯ä»¥è°ç¨ await() æ¹æ³ç­å¾ææå·¥ä½çº¿ç¨å®æï¼ä»¥ä¾¿ç»è®¡æ§è¡æ¶é´åæ§è½ææ ã\n\n\n# cyclicbarrier\n\n * ä»ä¹æ¯cyclicbarrier?\n * cyclicbarrieråºå±å®ç°åç?\n * countdownlatchåcyclicbarrierå¯¹æ¯?\n * cyclicbarrierçæ ¸å¿å½æ°æåªäº?\n * cyclicbarrieréç¨äºä»ä¹åºæ¯?\n\ncyclicbarrierï¼å¾ªç¯å±éï¼æ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥è®©ä¸ç»çº¿ç¨å¨è¾¾å°æä¸ªå±åç¹ä¹åäºç¸ç­å¾ï¼ç¶ååæ¶ç»§ç»­æ§è¡ã\n\ncyclicbarrier çç¹ç¹å¦ä¸ï¼\n\n 1. å±åç¹ï¼cyclicbarrier å¯ä»¥è®¾ç½®ä¸ä¸ªå±åç¹ï¼å½ç­å¾ççº¿ç¨æ°è¾¾å°æå®æ°éæ¶ï¼ææçº¿ç¨å°åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n 2. å¾ªç¯ä½¿ç¨ï¼cyclicbarrier å¯ä»¥è¢«å¤æ¬¡ä½¿ç¨ãå½ææçº¿ç¨é½è¢«éæ¾åï¼cyclicbarrier ä¼è¢«éç½®ï¼å¹¶å¯ä»¥åæ¬¡ä½¿ç¨ã\n 3. ç­å¾ä¸éæ¾ï¼çº¿ç¨éè¿è°ç¨ cyclicbarrier ç await() æ¹æ³è¿å¥ç­å¾ç¶æï¼å½æå®æ°éççº¿ç¨é½è°ç¨äº await() æ¹æ³åï¼ææçº¿ç¨ä¼åæ¶è¢«éæ¾ï¼ç»§ç»­æ§è¡åç»­æä½ã\n\n// æé æ¹æ³\ncyclicbarrier(int, runnable); // æå®å³èè¯¥cyclicbarrierççº¿ç¨æ°éï¼å¹¶ä¸å¯ä»¥æå®å¨ææçº¿ç¨é½è¿å¥å±éåçæ§è¡å¨ä½ï¼è¯¥æ§è¡å¨ä½ç±æåä¸ä¸ªè¿è¡å±éççº¿ç¨æ§è¡ã\ncyclicbarrier(int);\n\ncb.await();\n\n\nå¨ææçº¿ç¨è¿å¥å±éåä¼è°ç¨ nextgeneration()ï¼å³çæä¸ä¸ä¸ªçæ¬ï¼ææçº¿ç¨åå¯ä»¥éæ°è¿å¥å°å±éä¸­ãè¦æ³¨æbarrier.await()æ¹æ³çè°ç¨æ¬¡æ°åºè¯¥ä¸åå»ºcyclicbarrieræ¶æå®ççº¿ç¨æ°éç¸å¹éï¼ä»¥ç¡®ä¿æ­£ç¡®çåæ­¥åç­å¾è¡ä¸ºã\n\ncyclicbarrier å countdonwlatch çå¯¹æ¯\n\n * countdownlatchåè®¡æ°ï¼cyclicbarrierå è®¡æ°ã\n\n * countdownlatchæ¯ä¸æ¬¡æ§çï¼cyclicbarrierå¯ä»¥éç¨ã\n\n * countdownlatchåcyclicbarrieré½æè®©å¤ä¸ªçº¿ç¨ç­å¾åæ­¥ç¶ååå¼å§ä¸ä¸æ­¥å¨ä½çææï¼ä½æ¯countdownlatchçä¸ä¸æ­¥çå¨ä½å®æ½èæ¯ä¸»çº¿ç¨ï¼å·æä¸å¯éå¤æ§ï¼ècyclicbarrierçä¸ä¸æ­¥å¨ä½å®æ½èè¿æ¯âå¶ä»çº¿ç¨âæ¬èº«ï¼å·æå¾å¤å¤æ¬¡å®æ½å¨ä½çç¹ç¹ã\n\n * å¯¹äºcountdownlatchï¼å¶ä»çº¿ç¨ä¸ºæ¸¸æç©å®¶ï¼æ¯å¦è±éèçï¼ä¸»çº¿ç¨ä¸ºæ§å¶æ¸¸æå¼å§ççº¿ç¨ãå¨ææçç©å®¶é½åå¤å¥½ä¹åï¼ä¸»çº¿ç¨æ¯å¤äºç­å¾ç¶æçï¼ä¹å°±æ¯æ¸¸æä¸è½å¼å§ãå½ææçç©å®¶åå¤å¥½ä¹åï¼ä¸ä¸æ­¥çå¨ä½å®æ½èä¸ºä¸»çº¿ç¨ï¼å³å¼å§æ¸¸æã\n\n * å¯¹äºcyclicbarrierï¼åè®¾æä¸å®¶å¬å¸è¦å¨ä½åå·¥è¿è¡å¢å»ºæ´»å¨ï¼æ´»å¨åå®¹ä¸ºç¿»è¶ä¸ä¸ªéç¢ç©ï¼æ¯ä¸ä¸ªäººç¿»è¶éç¢ç©æç¨çæ¶é´æ¯ä¸ä¸æ ·çãä½æ¯å¬å¸è¦æ±ææäººå¨ç¿»è¶å½åéç¢ç©ä¹ååå¼å§ç¿»è¶ä¸ä¸ä¸ªéç¢ç©ï¼ä¹å°±æ¯ææäººç¿»è¶ç¬¬ä¸ä¸ªéç¢ç©ä¹åï¼æå¼å§ç¿»è¶ç¬¬äºä¸ªï¼ä»¥æ­¤ç±»æ¨ãç±»æ¯å°ï¼æ¯ä¸ä¸ªåå·¥é½æ¯ä¸ä¸ªâå¶ä»çº¿ç¨âãå½ææäººé½ç¿»è¶çææçéç¢ç©ä¹åï¼ç¨åºæç»æãèä¸»çº¿ç¨å¯è½æ©å°±ç»æäºï¼è¿éæä»¬ä¸ç¨ç®¡ä¸»çº¿ç¨ã\n\ncyclicbarrier çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. å¹¶è¡è®¡ç®ä»»å¡çæåä¸åå¹¶ï¼å½ä¸ä¸ªå¤§åè®¡ç®ä»»å¡å¯ä»¥è¢«æåä¸ºå¤ä¸ªå­ä»»å¡å¹¶è¡æ§è¡æ¶ï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥ç­å¾ææå­ä»»å¡å®æååè¿è¡åå¹¶è®¡ç®ã\n 2. å¤çº¿ç¨ä»»å¡çé¶æ®µåæ­¥ï¼å½ä¸ä¸ªä»»å¡éè¦æç§é¶æ®µè¿è¡å¤æ¬¡å¹¶åæä½ï¼æ¯ä¸ªé¶æ®µéè¦ç­å¾ææçº¿ç¨é½å®æåæè½ç»§ç»­ä¸ä¸é¶æ®µï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥å®ç°é¶æ®µé´çåæ­¥ã\n 3. å¹¶åæµæ°´çº¿çæµç¨æ§å¶ï¼å½å¤ä¸ªçº¿ç¨éè¦æç§ç¹å®çæµæ°´çº¿æ¹å¼æ§è¡ä»»å¡ï¼æ¯ä¸ªçº¿ç¨å¨å®æä¸å®æä½åéè¦ç­å¾å¶ä»çº¿ç¨æè½ç»§ç»­ï¼å¯ä»¥ä½¿ç¨ cyclicbarrier æ¥å®ç°çº¿ç¨ä¹é´çåæ­¥ã\n\n\n# phaser\n\n\n# semaphore\n\nsemaphoreï¼ä¿¡å·éï¼æ¯javaå¹¶åç¼ç¨ä¸­çä¸ä¸ªåæ­¥å·¥å·ç±»ï¼å®å¯ä»¥ç¨äºæ§å¶å¯¹å±äº«èµæºçè®¿é®æ°éãsemaphore ç»´æ¤äºä¸ä¸ªè®¸å¯è¯æ°éï¼çº¿ç¨å¯ä»¥éè¿è·åè®¸å¯è¯æ¥è®¿é®å±äº«èµæºï¼èå½è®¸å¯è¯ä¸å¯ç¨æ¶ï¼çº¿ç¨éè¦ç­å¾å¶ä»çº¿ç¨éæ¾è®¸å¯è¯ã\n\nsemaphore çç¹ç¹å¦ä¸ï¼\n\n 1. è®¸å¯è¯æ°éï¼semaphore éè¿ä¸ä¸ªæ´æ°æ¥è¡¨ç¤ºå¯ç¨çè®¸å¯è¯æ°éãçº¿ç¨å¯ä»¥éè¿ acquire() æ¹æ³è·åä¸ä¸ªè®¸å¯è¯ï¼è¡¨ç¤ºå ç¨äºä¸ä¸ªèµæºï¼è release() æ¹æ³åéæ¾ä¸ä¸ªè®¸å¯è¯ï¼è¡¨ç¤ºéæ¾äºä¸ä¸ªèµæºã\n 2. å¬å¹³æ§ï¼semaphore å¯ä»¥éæ©æ¯å¦å¬å¹³å°æ§å¶è®¸å¯è¯çè·åãå¬å¹³æ§è¡¨ç¤ºç­å¾æ¶é´æé¿ççº¿ç¨å°ä¼åè·åè®¸å¯è¯ï¼èéå¬å¹³æ§åæ²¡æè¿ä¸ªä¿è¯ã\n\nsemaphore çåºç¨åºæ¯åæ¬ä»¥ä¸å ä¸ªæ¹é¢ï¼\n\n 1. æéèµæºçå¹¶åè®¿é®æ§å¶ï¼å½ç³»ç»ä¸­å­å¨æéçèµæºï¼å¦æ°æ®åºè¿æ¥ãçº¿ç¨æ± ç­ï¼å¯ä»¥ä½¿ç¨ semaphore æ¥æ§å¶å¯¹è¿äºèµæºçå¹¶åè®¿é®æ°éï¼ä»¥é¿åèµæºè¿è½½ã\n 2. æµéæ§å¶ï¼å½éè¦éå¶æä¸ªæä½çå¹¶åæ°éï¼ä»¥æ§å¶æµéæé¿åè¿åº¦çè¯·æ±ååæ¶ï¼å¯ä»¥ä½¿ç¨ semaphore æ¥å®ç°éæµã\n 3. çº¿ç¨æ± ç®¡çï¼semaphore å¯ä»¥ç¨äºå®ç°çº¿ç¨æ± ä¸­çå·¥ä½çº¿ç¨æ°éæ§å¶ï¼éè¿éå¶è®¸å¯è¯æ°éï¼æ§å¶åæ¶æ§è¡çä»»å¡æ°éã\n\næ ¸å¿æ¹æ³\n\npublic semaphore(int permits);\npublic semaphore(int permits, boolean fair);\n\nsemaphore.acquire();\nsemaphore.acquire(int);\nsemaphore.release();\nsemaphore.release(int);\n\n\nnote: è°ç¨release()ä¼æ·»å ä»¤çï¼å¹¶ä¸ä¼ä»¥åå§åçå¤§å°ä¸ºåãsemaphoreä¸­releaseæ¹æ³çè°ç¨å¹¶æ²¡æéå¶è¦å¨acquireåè°ç¨ã\n\n\n# exchanger\n\n\n# collections\n\n\n# queue\n\n\n# list\n\n\n# set\n\n\n# map\n\n\n# atomic\n\n\n# åºç¡ç±»å\n\n\n# æ°ç»\n\n\n# å¼ç¨\n\n\n# executor\n\n\n# æ¥å£ï¼executor\n\n\n# executorservice\n\n\n# scheduledexecutorservice\n\n\n# abstractexecutorservice\n\n\n# futuretask\n\n\n# threadpoolexecutor\n\n\n# scheduledthreadpoolexecutor\n\n\n# fork/join framework\n\n\n# executors\n\n\n# reference\n\nhttps://pdai.tech/md/java/thread/java-thread-x-juc-overview.html#atomic-%e5%8e%9f%e5%ad%90%e7%b1%bb",charsets:{cjk:!0}},{title:"lombokçå®ç°åç",frontmatter:{title:"lombokçå®ç°åç",date:"2023-05-26T20:45:27.000Z",permalink:"/pages/cf4cda/",article:!1},regularPath:"/temp/lombok%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86.html",relativePath:"temp/lombokçå®ç°åç.md",key:"v-b0095412",path:"/pages/cf4cda/",headers:[{level:2,title:"lombok çç¨æ³",slug:"lombok-çç¨æ³",normalizedTitle:"lombok çç¨æ³",charIndex:2},{level:2,title:"lombok çå®ç°åç",slug:"lombok-çå®ç°åç",normalizedTitle:"lombok çå®ç°åç",charIndex:49},{level:2,title:"æ³¨è§£çå¤çæ¶æºï¼",slug:"æ³¨è§£çå¤çæ¶æº",normalizedTitle:"æ³¨è§£çå¤çæ¶æºï¼",charIndex:1324},{level:2,title:"ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸éç¨åå°çæ¹å¼å»çæä»£ç ï¼",slug:"ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£-èä¸éç¨åå°çæ¹å¼å»çæä»£ç ",normalizedTitle:"ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸éç¨åå°çæ¹å¼å»çæä»£ç ï¼",charIndex:1721}],headersStr:"lombok çç¨æ³ lombok çå®ç°åç æ³¨è§£çå¤çæ¶æºï¼ ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸éç¨åå°çæ¹å¼å»çæä»£ç ï¼",content:"# lombok çç¨æ³\n\n 1. å®è£æä»¶\n 2. pom å å¥ä¾èµ\n 3. ä½¿ç¨æ³¨è§£\n\n\n# lombok çå®ç°åç\n\nlombok æ¯å¨ç¼è¯é¶æ®µå¤çæ³¨è§£ãå¨ç¼è¯é¶æ®µï¼å½ Java æºç è¢«æ½è±¡æè¯­æ³æ  (AST) ä¹åï¼Lombok ä¼æ ¹æ®èªå·±çæ³¨è§£å¤çå¨å¨æçä¿®æ¹ ASTï¼å¢å æ°çä»£ç  (èç¹)ï¼å¨è¿ä¸åæ§è¡ä¹åï¼åéè¿åæçæäºæç»çå­èç  (.class) æä»¶ã\n\nJava çç¼è¯è¿ç¨å¤§è´å¯ä»¥åä¸ºä¸ä¸ªé¶æ®µï¼\n\n 1. è§£æä¸å¡«åç¬¦å·è¡¨\n 2. æ³¨è§£å¤ç\n 3. åæä¸å­èç çæ\n\nJava çç¼è¯è¿ç¨ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼ï¼è¯¦ç»çï¼\n\n 1. è¯æ³åæï¼Lexical Analysisï¼ï¼å°æºä»£ç åè§£ä¸ºåºæ¬çè¯æ³ååï¼Tokensï¼ï¼å¦å³é®å­ãæ è¯ç¬¦ãè¿ç®ç¬¦ãåéç¬¦ç­ã\n 2. è¯­æ³åæï¼Syntax Analysisï¼ï¼å°è¯æ³ååç»ç»æè¯­æ³ç»æï¼å¹¶æ ¹æ®è¯­æ³è§åè¿è¡éªè¯ãè¿ä¸ªè¿ç¨æå»ºäºæ½è±¡è¯­æ³æ ï¼Abstract Syntax Treeï¼ASTï¼ã\n 3. è¯­ä¹åæï¼Semantic Analysisï¼ï¼å¯¹è¯­æ³ç»æè¿è¡è¯­ä¹æ£æ¥ï¼åæ¬ç±»åæ£æ¥ãä½ç¨åæ£æ¥ç­ãæ­¤æ­¥éª¤ç¡®ä¿ä»£ç çåæ³æ§åæ­£ç¡®æ§ã\n 4. ä¸­é´ä»£ç çæï¼Intermediate Code Generationï¼ï¼æ ¹æ®è¯­æ³ç»æåè¯­ä¹ä¿¡æ¯çæä¸­é´ä»£ç ãä¸­é´ä»£ç å¯ä»¥æ¯ä¸ç§æ½è±¡è¡¨ç¤ºå½¢å¼ï¼å¦å­èç ãä¸­é´è¯­è¨ï¼ä¾å¦Javaå­èç æLLVM IRï¼ã\n 5. ä¼åï¼Optimizationï¼ï¼å¯¹çæçä¸­é´ä»£ç è¿è¡ä¼åï¼ä»¥æé«ç¨åºçæ§è½åæçãè¿åæ¬å¸¸éæå ãæ ç¨ä»£ç æ¶é¤ãå¾ªç¯å±å¼ç­ä¼åææ¯ã\n 6. ç®æ ä»£ç çæï¼Code Generationï¼ï¼æ ¹æ®ä¼ååçä¸­é´ä»£ç çæç®æ å¹³å°ç¹å®çæºå¨ä»£ç æå¯æ§è¡æä»¶ãè¿ä¸ªè¿ç¨å°ä¸­é´ä»£ç ç¿»è¯ä¸ºå¯ä»¥å¨ç®æ å¹³å°ä¸æ§è¡çæºå¨æä»¤ã\n 7. ç¼è¯å¨é¾æ¥ï¼Compiler Linkingï¼ï¼å¦æä»£ç ä¾èµäºå¶ä»ç±»æåºï¼ç¼è¯å¨ä¼è¿è¡é¾æ¥æä½ï¼ä»¥å°ç¼è¯çä»£ç ä¸æéçç±»ååºè¿è¡å³èã\n\nè¿äºæ­¥éª¤ä¸­çå¤§é¨åå·¥ä½ç± Java ç¼è¯å¨ï¼å¦javacï¼å®æãç¼è¯è¿ç¨çæç»è¾åºæ¯å¯æ§è¡çç®æ ä»£ç æå¯é¨ç½²çå­èç æä»¶ï¼å¯ä»¥å¨ç¸åºçè¿è¡æ¶ç¯å¢ä¸­æ§è¡ã\n\nç¼è¯æ¶çæ³¨è§£å¤çæ¯å¨ Java ç¼è¯è¿ç¨çè¯­ä¹åæé¶æ®µä¹åçç¹å®é¶æ®µè¿è¡çãè¯¥é¶æ®µç§°ä¸ºæ³¨è§£å¤çå¨å¤çé¶æ®µï¼Annotation Processing Phaseï¼ã\n\nå¨è¯­ä¹åæé¶æ®µåï¼ç¼è¯å¨ä¼æ£æ¥æºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ï¼å¹¶å°è¿äºæ³¨è§£ä¿¡æ¯ä¼ éç»ç¸åºçæ³¨è§£å¤çå¨è¿è¡å¤çãæ³¨è§£å¤çå¨æ¯å¼åäººåç¼åçç¹æ®ç±»ï¼å®ç°äº javax.annotation.processing.Processor æ¥å£ï¼ç¨äºå¤çç¹å®æ³¨è§£çé»è¾ã\n\nå¨æ³¨è§£å¤çå¨å¤çé¶æ®µï¼ç¼è¯å¨ä¼è°ç¨ç¸åºçæ³¨è§£å¤çå¨ï¼ä¼ éæºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ç»å®ä»¬ãæ³¨è§£å¤çå¨å¯ä»¥è¯»åæ³¨è§£ä¿¡æ¯ãæ£æ¥åä¿®æ¹æ½è±¡è¯­æ³æ ï¼ASTï¼ï¼çæé¢å¤çä»£ç æè¿è¡å¶ä»èªå®ä¹çæä½ã\n\næ³¨è§£å¤çå¨å¤çé¶æ®µçè¾åºç»æéå¸¸æ¯çæçä»£ç æå¶ä»ç¸å³çåæ°æ®ä¿¡æ¯ãè¿äºçæçä»£ç å¯ä»¥æ¯ä¸ºäºæä¾é¢å¤çåè½ãåå°æ ·æ¿ä»£ç æä¸æ³¨è§£ç¸å³çé»è¾ãçæçä»£ç ä¼ä¸åå§æºä»£ç ä¸èµ·åä¸åç»­çç¼è¯è¿ç¨ã\n\n\n# æ³¨è§£çå¤çæ¶æºï¼\n\næ³¨è§£çå¤çæ¹å¼åå³äºæ³¨è§£çåæ³¨è§£ï¼meta-annotationï¼åæ³¨è§£å¤çå¨ï¼annotation processorï¼çå®ä¹ã\n\nå¨ Java ä¸­ï¼æä¸ç§ä¸»è¦ç±»åçæ³¨è§£å¤çæ¹å¼ï¼\n\n 1. ç¼è¯æ¶å¤çï¼ä¸äºæ³¨è§£å¨ç¼è¯æ¶ä¼è¢«ç¹å®çæ³¨è§£å¤çå¨å¤çãè¿äºæ³¨è§£å¤çå¨ä¼è¯»åæºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ï¼å¹¶çæç¸åºçä»£ç æè¿è¡å¶ä»å¤çæä½ãLombok å°±æ¯ä¸ä¸ªä½¿ç¨ç¼è¯æ¶å¤ççæ³¨è§£åºã\n 2. è¿è¡æ¶åå°å¤çï¼æäºæ³¨è§£å¨è¿è¡æ¶ä½¿ç¨åå°æºå¶è¿è¡å¤çãè¿æå³çæ³¨è§£å¨ç¼è¯æ¶ä¸ä¼äº§çç¹å®çä»£ç çæï¼èæ¯å¨è¿è¡æ¶éè¿åå°è¯»åæ³¨è§£ä¿¡æ¯å¹¶æ§è¡ç¸åºçæä½ãä¾å¦ï¼JUnit ä¸­çæµè¯æ³¨è§£ @Test å°±æ¯å¨è¿è¡æ¶éè¿åå°æºå¶æ¥è¿è¡æµè¯æ¹æ³ã\n 3. æ å¤çï¼ä¸äºæ³¨è§£å¨ç¼è¯åè¿è¡æ¶é½æ²¡æç¹å®çå¤çãè¿äºæ³¨è§£å¯è½ä»ç¨äºæä¾é¢å¤çåæ°æ®ä¿¡æ¯ï¼ä¾å¶ä»å·¥å·ææ¡æ¶ä½¿ç¨ï¼èä¸ä¼ç´æ¥å½±åä»£ç ççææè¡ä¸ºã\n\n\n# ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸éç¨åå°çæ¹å¼å»çæä»£ç ï¼\n\nLombok ä¹æä»¥éæ©å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸æ¯éç¨è¿è¡æ¶åå°çæ¹å¼å»çæä»£ç ï¼ä¸»è¦æ¯åºäºæ§è½çèèã\n\nLombok å¨ç¼è¯å¨æ¶ç´æ¥çæä»£ç ï¼é¿åäºè¿è¡æ¶åå°çå¼éãä½¿ç¨åå°çæä»£ç å¯è½ä¼å¯¼è´è¿è¡æ¶çæ§è½æèï¼ç¹å«æ¯å¨å¤§åé¡¹ç®ä¸­æé¢ç¹ä½¿ç¨çå°æ¹ãéè¿å¨ç¼è¯å¨é¶æ®µçæä»£ç ï¼Lombok å¯ä»¥ç¡®ä¿çæçä»£ç æ¯åççãé«æçï¼å¹¶ä¸ä¸æåçä»£ç ä¸æ ·æ§è½è¯å¥½ã\n\nhttps://www.cnblogs.com/vipstone/p/12597756.html",normalizedContent:"# lombok çç¨æ³\n\n 1. å®è£æä»¶\n 2. pom å å¥ä¾èµ\n 3. ä½¿ç¨æ³¨è§£\n\n\n# lombok çå®ç°åç\n\nlombok æ¯å¨ç¼è¯é¶æ®µå¤çæ³¨è§£ãå¨ç¼è¯é¶æ®µï¼å½ java æºç è¢«æ½è±¡æè¯­æ³æ  (ast) ä¹åï¼lombok ä¼æ ¹æ®èªå·±çæ³¨è§£å¤çå¨å¨æçä¿®æ¹ astï¼å¢å æ°çä»£ç  (èç¹)ï¼å¨è¿ä¸åæ§è¡ä¹åï¼åéè¿åæçæäºæç»çå­èç  (.class) æä»¶ã\n\njava çç¼è¯è¿ç¨å¤§è´å¯ä»¥åä¸ºä¸ä¸ªé¶æ®µï¼\n\n 1. è§£æä¸å¡«åç¬¦å·è¡¨\n 2. æ³¨è§£å¤ç\n 3. åæä¸å­èç çæ\n\njava çç¼è¯è¿ç¨ä¸»è¦åæ¬ä»¥ä¸å ä¸ªæ­¥éª¤ï¼ï¼è¯¦ç»çï¼\n\n 1. è¯æ³åæï¼lexical analysisï¼ï¼å°æºä»£ç åè§£ä¸ºåºæ¬çè¯æ³ååï¼tokensï¼ï¼å¦å³é®å­ãæ è¯ç¬¦ãè¿ç®ç¬¦ãåéç¬¦ç­ã\n 2. è¯­æ³åæï¼syntax analysisï¼ï¼å°è¯æ³ååç»ç»æè¯­æ³ç»æï¼å¹¶æ ¹æ®è¯­æ³è§åè¿è¡éªè¯ãè¿ä¸ªè¿ç¨æå»ºäºæ½è±¡è¯­æ³æ ï¼abstract syntax treeï¼astï¼ã\n 3. è¯­ä¹åæï¼semantic analysisï¼ï¼å¯¹è¯­æ³ç»æè¿è¡è¯­ä¹æ£æ¥ï¼åæ¬ç±»åæ£æ¥ãä½ç¨åæ£æ¥ç­ãæ­¤æ­¥éª¤ç¡®ä¿ä»£ç çåæ³æ§åæ­£ç¡®æ§ã\n 4. ä¸­é´ä»£ç çæï¼intermediate code generationï¼ï¼æ ¹æ®è¯­æ³ç»æåè¯­ä¹ä¿¡æ¯çæä¸­é´ä»£ç ãä¸­é´ä»£ç å¯ä»¥æ¯ä¸ç§æ½è±¡è¡¨ç¤ºå½¢å¼ï¼å¦å­èç ãä¸­é´è¯­è¨ï¼ä¾å¦javaå­èç ællvm irï¼ã\n 5. ä¼åï¼optimizationï¼ï¼å¯¹çæçä¸­é´ä»£ç è¿è¡ä¼åï¼ä»¥æé«ç¨åºçæ§è½åæçãè¿åæ¬å¸¸éæå ãæ ç¨ä»£ç æ¶é¤ãå¾ªç¯å±å¼ç­ä¼åææ¯ã\n 6. ç®æ ä»£ç çæï¼code generationï¼ï¼æ ¹æ®ä¼ååçä¸­é´ä»£ç çæç®æ å¹³å°ç¹å®çæºå¨ä»£ç æå¯æ§è¡æä»¶ãè¿ä¸ªè¿ç¨å°ä¸­é´ä»£ç ç¿»è¯ä¸ºå¯ä»¥å¨ç®æ å¹³å°ä¸æ§è¡çæºå¨æä»¤ã\n 7. ç¼è¯å¨é¾æ¥ï¼compiler linkingï¼ï¼å¦æä»£ç ä¾èµäºå¶ä»ç±»æåºï¼ç¼è¯å¨ä¼è¿è¡é¾æ¥æä½ï¼ä»¥å°ç¼è¯çä»£ç ä¸æéçç±»ååºè¿è¡å³èã\n\nè¿äºæ­¥éª¤ä¸­çå¤§é¨åå·¥ä½ç± java ç¼è¯å¨ï¼å¦javacï¼å®æãç¼è¯è¿ç¨çæç»è¾åºæ¯å¯æ§è¡çç®æ ä»£ç æå¯é¨ç½²çå­èç æä»¶ï¼å¯ä»¥å¨ç¸åºçè¿è¡æ¶ç¯å¢ä¸­æ§è¡ã\n\nç¼è¯æ¶çæ³¨è§£å¤çæ¯å¨ java ç¼è¯è¿ç¨çè¯­ä¹åæé¶æ®µä¹åçç¹å®é¶æ®µè¿è¡çãè¯¥é¶æ®µç§°ä¸ºæ³¨è§£å¤çå¨å¤çé¶æ®µï¼annotation processing phaseï¼ã\n\nå¨è¯­ä¹åæé¶æ®µåï¼ç¼è¯å¨ä¼æ£æ¥æºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ï¼å¹¶å°è¿äºæ³¨è§£ä¿¡æ¯ä¼ éç»ç¸åºçæ³¨è§£å¤çå¨è¿è¡å¤çãæ³¨è§£å¤çå¨æ¯å¼åäººåç¼åçç¹æ®ç±»ï¼å®ç°äº javax.annotation.processing.processor æ¥å£ï¼ç¨äºå¤çç¹å®æ³¨è§£çé»è¾ã\n\nå¨æ³¨è§£å¤çå¨å¤çé¶æ®µï¼ç¼è¯å¨ä¼è°ç¨ç¸åºçæ³¨è§£å¤çå¨ï¼ä¼ éæºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ç»å®ä»¬ãæ³¨è§£å¤çå¨å¯ä»¥è¯»åæ³¨è§£ä¿¡æ¯ãæ£æ¥åä¿®æ¹æ½è±¡è¯­æ³æ ï¼astï¼ï¼çæé¢å¤çä»£ç æè¿è¡å¶ä»èªå®ä¹çæä½ã\n\næ³¨è§£å¤çå¨å¤çé¶æ®µçè¾åºç»æéå¸¸æ¯çæçä»£ç æå¶ä»ç¸å³çåæ°æ®ä¿¡æ¯ãè¿äºçæçä»£ç å¯ä»¥æ¯ä¸ºäºæä¾é¢å¤çåè½ãåå°æ ·æ¿ä»£ç æä¸æ³¨è§£ç¸å³çé»è¾ãçæçä»£ç ä¼ä¸åå§æºä»£ç ä¸èµ·åä¸åç»­çç¼è¯è¿ç¨ã\n\n\n# æ³¨è§£çå¤çæ¶æºï¼\n\næ³¨è§£çå¤çæ¹å¼åå³äºæ³¨è§£çåæ³¨è§£ï¼meta-annotationï¼åæ³¨è§£å¤çå¨ï¼annotation processorï¼çå®ä¹ã\n\nå¨ java ä¸­ï¼æä¸ç§ä¸»è¦ç±»åçæ³¨è§£å¤çæ¹å¼ï¼\n\n 1. ç¼è¯æ¶å¤çï¼ä¸äºæ³¨è§£å¨ç¼è¯æ¶ä¼è¢«ç¹å®çæ³¨è§£å¤çå¨å¤çãè¿äºæ³¨è§£å¤çå¨ä¼è¯»åæºä»£ç ä¸­çæ³¨è§£ä¿¡æ¯ï¼å¹¶çæç¸åºçä»£ç æè¿è¡å¶ä»å¤çæä½ãlombok å°±æ¯ä¸ä¸ªä½¿ç¨ç¼è¯æ¶å¤ççæ³¨è§£åºã\n 2. è¿è¡æ¶åå°å¤çï¼æäºæ³¨è§£å¨è¿è¡æ¶ä½¿ç¨åå°æºå¶è¿è¡å¤çãè¿æå³çæ³¨è§£å¨ç¼è¯æ¶ä¸ä¼äº§çç¹å®çä»£ç çæï¼èæ¯å¨è¿è¡æ¶éè¿åå°è¯»åæ³¨è§£ä¿¡æ¯å¹¶æ§è¡ç¸åºçæä½ãä¾å¦ï¼junit ä¸­çæµè¯æ³¨è§£ @test å°±æ¯å¨è¿è¡æ¶éè¿åå°æºå¶æ¥è¿è¡æµè¯æ¹æ³ã\n 3. æ å¤çï¼ä¸äºæ³¨è§£å¨ç¼è¯åè¿è¡æ¶é½æ²¡æç¹å®çå¤çãè¿äºæ³¨è§£å¯è½ä»ç¨äºæä¾é¢å¤çåæ°æ®ä¿¡æ¯ï¼ä¾å¶ä»å·¥å·ææ¡æ¶ä½¿ç¨ï¼èä¸ä¼ç´æ¥å½±åä»£ç ççææè¡ä¸ºã\n\n\n# ä¸ºä»ä¹lombokè¦å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸éç¨åå°çæ¹å¼å»çæä»£ç ï¼\n\nlombok ä¹æä»¥éæ©å¨ç¼è¯å¨æ¶å¤çæ³¨è§£ï¼èä¸æ¯éç¨è¿è¡æ¶åå°çæ¹å¼å»çæä»£ç ï¼ä¸»è¦æ¯åºäºæ§è½çèèã\n\nlombok å¨ç¼è¯å¨æ¶ç´æ¥çæä»£ç ï¼é¿åäºè¿è¡æ¶åå°çå¼éãä½¿ç¨åå°çæä»£ç å¯è½ä¼å¯¼è´è¿è¡æ¶çæ§è½æèï¼ç¹å«æ¯å¨å¤§åé¡¹ç®ä¸­æé¢ç¹ä½¿ç¨çå°æ¹ãéè¿å¨ç¼è¯å¨é¶æ®µçæä»£ç ï¼lombok å¯ä»¥ç¡®ä¿çæçä»£ç æ¯åççãé«æçï¼å¹¶ä¸ä¸æåçä»£ç ä¸æ ·æ§è½è¯å¥½ã\n\nhttps://www.cnblogs.com/vipstone/p/12597756.html",charsets:{cjk:!0}},{title:"prompt record",frontmatter:{title:"prompt record",date:"2023-06-07T16:50:23.000Z",permalink:"/pages/252ef5/"},regularPath:"/temp/prompt%20record.html",relativePath:"temp/prompt record.md",key:"v-1689eec4",path:"/pages/252ef5/",headersStr:null,content:"good prompt for learning English:\n\n * please give a speaking prompts for practice\n * please give me 3 tongue twisters for learning",normalizedContent:"good prompt for learning english:\n\n * please give a speaking prompts for practice\n * please give me 3 tongue twisters for learning",charsets:{}},{title:"sentinel",frontmatter:{title:"sentinel",date:"2023-05-11T16:53:31.000Z",permalink:"/pages/144ecf/",article:!1},regularPath:"/temp/sentinel.html",relativePath:"temp/sentinel.md",key:"v-5aaf6e59",path:"/pages/144ecf/",headers:[{level:2,title:"Base",slug:"base",normalizedTitle:"base",charIndex:2},{level:2,title:"æä¹å",slug:"æä¹å",normalizedTitle:"æä¹å",charIndex:1193},{level:2,title:"our project stratage",slug:"our-project-stratage",normalizedTitle:"our project stratage",charIndex:1692},{level:2,title:"æ³¨æ",slug:"æ³¨æ",normalizedTitle:"æ³¨æ",charIndex:2219},{level:2,title:"todo",slug:"todo",normalizedTitle:"todo",charIndex:2633}],headersStr:"Base æä¹å our project stratage æ³¨æ todo",content:'# Base\n\nSentinel ä»¥æµéä¸ºåå¥ç¹ï¼ä»æµéæ§å¶ãçæ­éçº§ãç³»ç»è´è½½ä¿æ¤ç­å¤ä¸ªç»´åº¦ä¿æ¤æå¡çç¨³å®æ§ã\n\néçå¾®æå¡çæµè¡ï¼æå¡ä¸æå¡ä¹é´çè°ç¨ç¨³å®æ§åå¾è¶æ¥è¶éè¦ï¼\n\n1ãå½æå¡è®¿é®éè¾¾å°ä¸å®ç¨åº¦ï¼æµéæä¸ä½çæ¶åï¼è¯¥å¦ä½å¤çï¼ï¼éæµï¼\n\n2ãæå¡ä¹é´ç¸äºä¾èµï¼å½æå¡Båºç°ååºæ¶é´è¿é¿ï¼å½±åå°æå¡Açååºï¼Aè°ç¨Bï¼ï¼è¿èäº§çè¿éååºï¼ç´è³å½±åæ´ä¸ªä¾èµé¾ä¸çæææå¡ï¼éªå´©ï¼ï¼è¯¥å¦ä½å¤çï¼ï¼çæ­éçº§ï¼\n\nSentinel åä¸ºä¸¤ä¸ªé¨å:\n\n * æ ¸å¿åºï¼Java å®¢æ·ç«¯ï¼ä¸ä¾èµä»»ä½æ¡æ¶/åºï¼è½å¤è¿è¡äºææ Java è¿è¡æ¶ç¯å¢ï¼åæ¶å¯¹ Dubbo / Spring Cloud ç­æ¡æ¶ä¹æè¾å¥½çæ¯æã\n * æ§å¶å°ï¼Dashboardï¼åºäº Spring Boot å¼åï¼æååå¯ä»¥ç´æ¥è¿è¡ï¼ä¸éè¦é¢å¤ç Tomcat ç­åºç¨å®¹å¨ã\n   * java -Dserver.port=9091 -jar sentinel-dashboard-1.8.5.jar\n\néæµåç¹ï¼\n\n * httpåç¹ï¼sentinel starteré»è®¤ä¸ºææçhttpæ¥å£æä¾äºéæµåç¹\n * èªå®ä¹åç¹ï¼éè¿ @SentinelResource å®ä¹èµæºåç¹\n\næµæ§ææï¼\n\n * å¿«éå¤±è´¥\n * warm upï¼éè¿"å·å¯å¨"ï¼è®©éè¿çæµéç¼æ¢å¢å ï¼å¨ä¸å®æ¶é´åéæ¸å¢å å°éå¼ä¸éï¼ç»å·ç³»ç»ä¸ä¸ªé¢ç­çæ¶é´ï¼é¿åå·ç³»ç»è¢«åå®ãåºå±æ¯ä»¤çæ¡¶ç®æ³çå®ç°\n * æéç­å¾ï¼åéæéæ¹å¼ä¼ä¸¥æ ¼æ§å¶è¯·æ±éè¿çé´éæ¶é´ï¼ä¹å³æ¯è®©è¯·æ±ä»¥ååçéåº¦éè¿ï¼å¯¹åºçæ¯æ¼æ¡¶ç®æ³ã\n\næµæ§æ¨¡å¼ï¼\n\n * ç´æ¥æç»\n * å³èï¼å½å³èçèµæºè¾¾å°éå¼æ¶ï¼éæµèªå·±\n * é¾è·¯ï¼åªè®°å½æå®é¾è·¯ä¸çæµéï¼æå®èµæºä»å¥å£èµæºè¿æ¥çæµéï¼å¦æè¾¾å°éå¼ï¼å°±å¯ä»¥éæµï¼\n\nä¸¤ç§ç»è®¡ç±»åï¼\n\n * QPS\n * å¹¶åçº¿ç¨æ°\n\nçæ­éçº§ï¼\n\nä¸ç§çæ­ç­ç¥ï¼\n\n * å¹³åååºæ¶é´\n * å¼å¸¸æ¯ä¾\n * å¼å¸¸æ°\n\nçæ­åéçº§ï¼GPTï¼ï¼\n\nçæ­åéçº§æ¯ç¸å³çæ¦å¿µï¼ä½å®ä»¬å¹¶ä¸å®å¨ç¸åã\n\néçº§æ¯æå½ç³»ç»åºç°å¼å¸¸ãæéãé«è´è½½ç­æåµæ¶ï¼ä¸ºäºä¿è¯ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼éè¿ä¸å®çææ®µéä½ç³»ç»çæå¡è½åï¼æé«ç³»ç»çå®¹éè½åï¼é¿åç³»ç»å´©æºæèéªå´©ã\n\nçæ­æ¯æå½æå¡è°ç¨å¤±è´¥çè¶è¿ä¸å®çéå¼æ¶ï¼éè¿æ­è·¯å¨çæºå¶ï¼å°å¯¹è¯¥æå¡çè¯·æ±çæ­æèéå¶å¶è®¿é®ï¼é²æ­¢è¯·æ±ç»§ç»­è°ç¨å¤±è´¥ï¼ä»èä¿è¯æå¡çå¯ç¨æ§åç¨³å®æ§ãçæ­æºå¶å¯ä»¥åè½»ç³»ç»çè´è½½ï¼é¿åæéæ©æ£ï¼åæ¶ä¹å¯ä»¥å éæéçæ¢å¤ã\n\nå æ­¤ï¼çæ­åéçº§é½æ¯ä¸ºäºä¿è¯ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼ä½å®ä»¬çå®ç°æºå¶ååºç¨åºæ¯ä¸åãéçº§ä¸»è¦æ¯ä¸ºäºä¿è¯æ´ä½ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼é¿åéªå´©æåºï¼èçæ­ä¸»è¦æ¯ä¸ºäºä¿æ¤è¢«è°ç¨æå¡çç¨³å®æ§åå¯ç¨æ§ï¼é¿åéè¯¯çè¯·æ±ç»§ç»­åçï¼å¯¼è´æå¡çè´è½½è¿é«ãæ§è½ä¸éæèæéæ©æ£ç­é®é¢ã\n\n\n# æä¹å\n\né»è®¤æåµä¸ï¼sentinel-dashboard ä¸­çè§åæ¯å­å¨å¨å¾®æå¡ï¼ä¸æ¯dashboardçï¼æ¯å®éæ¯ä½¿ç¨å®çï¼åå­ä¸­ï¼éå¯åå°±ä¼ä¸¢å¤±ã\n\n * æ¬å°æä»¶æä¹åï¼å¨Sentinelçå¯å¨åæ°ä¸­ï¼éè¿-Dcsp.sentinel.dashboard.file=filepathæå®éç½®æä»¶çè·¯å¾\n\n * ç¨ nacos å½éç½®ä¸­å¿ï¼éè¦å¼å¥sentinel-datasource-nacosçä¾èµï¼å¹¶å¨åºç¨éç½®æä»¶ä¸­éç½®Nacosçå°ååè®¤è¯ä¿¡æ¯ãSentinelä¼èªå¨ä»Nacoså è½½è§åéç½®ä¿¡æ¯ã\n\n * ç¼ç¨æ¹å¼å è½½åæä¹åï¼å¯ä»¥éè¿ç¼ç¨æ¹å¼å è½½åæä¹åè§åéç½®ä¿¡æ¯ãå¯ä»¥ä½¿ç¨com.alibaba.csp.sentinel.datasource.Converteræ¥å£å®ç°èªå®ä¹çæ°æ®æºåè§åéç½®ä¿¡æ¯çè½¬æ¢é»è¾ãç¶åä½¿ç¨com.alibaba.csp.sentinel.datasource.ReadableDataSourceåcom.alibaba.csp.sentinel.datasource.WritableDataSourceæ¥å£æ¥å è½½åæä¹åè§åéç½®ã\n\n\n# our project stratage\n\n * ç¨ sentinelåå®æ¶çæ§ã\n\n * åæ¶å¨ gateway ç½å³è¿è¡éæµ\n\n * éæµåæ°åºè¯¥è®¾å®ï¼ç®åä¸ºç®åæ¨¡æï¼å·ä½åæ°éè¦æ ¹æ®å®éæåµè¿è¡è°ç ã\n\nå½åçè§åï¼ï¼æè§æç¹å¥æªGPTï¼\n\n 1. éå¯¹é¢è®¢ç«è½¦ç¥¨çAPIæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯åéåè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼500ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼200æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼50ä¸ªå¹¶åè¯·æ±ã\n 2. éå¯¹ç¨æ·æ³¨åçAPIæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯å°æ¶åè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼100ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼500æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼10ä¸ªå¹¶åè¯·æ±ã\n 3. éå¯¹ç«è½¦ç¥¨æ¥è¯¢çAPIæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯ç§åè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼200ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼100æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼20ä¸ªå¹¶åè¯·æ±ã\n\næ»èè¨ä¹ï¼éå¯¹é¢å®è½¦ç¥¨æ¥å£è®¾å®äºåæº QPS = 500ï¼ç¶åå°±å¿«éå¤±è´¥ãéå¯¹ route id = member è¿è¡éæµã\n\n\n# æ³¨æ\n\nçæ¬å¯¹åºï¼\n\ncom.alibaba.cloud ççæ¬å°±åæ¬äºå®åä¸é¢çstarterãæè®¸å¼å¥ alibaba çåé½éè¦æå¨æå®çæ¬ã\n\nå¦æè¿ç§æåµmavenæ æ³ä¸å°åï¼å°±åæå®çæ¬å·è®©å®å»ä¸è½½\n<dependency>\n    <groupId>com.alibaba.cloud</groupId>\n    <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>\n</dependency>\n\n<dependency>\n  <groupId>com.alibaba.cloud</groupId>\n  <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>\n  <version>2022.0.0.0-RC1</version>\n</dependency>\n\n\n\n# todo\n\néè¦ææç½ï¼ç½å³éæµåå·ä½å¾®æå¡éæµä½¿ç¨ä¸çåºå«\n\nç½å³éæµå¯éå¯¹ route id è¿è¡ç»ä¸éæµã\n\nå·ä½å¾®æå¡çéæµï¼æ´å¤æ¯å¯¹å·ä½çæä¸ªapiè¿è¡éæµã\n\nreference:\n\n * https://www.cnblogs.com/gagaxiang/p/17014134.html\n\n * https://juejin.cn/post/7018406221120045087#heading-38 more useful é¢ç»\n\n * https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E çæ¬è¯´æ',normalizedContent:'# base\n\nsentinel ä»¥æµéä¸ºåå¥ç¹ï¼ä»æµéæ§å¶ãçæ­éçº§ãç³»ç»è´è½½ä¿æ¤ç­å¤ä¸ªç»´åº¦ä¿æ¤æå¡çç¨³å®æ§ã\n\néçå¾®æå¡çæµè¡ï¼æå¡ä¸æå¡ä¹é´çè°ç¨ç¨³å®æ§åå¾è¶æ¥è¶éè¦ï¼\n\n1ãå½æå¡è®¿é®éè¾¾å°ä¸å®ç¨åº¦ï¼æµéæä¸ä½çæ¶åï¼è¯¥å¦ä½å¤çï¼ï¼éæµï¼\n\n2ãæå¡ä¹é´ç¸äºä¾èµï¼å½æå¡båºç°ååºæ¶é´è¿é¿ï¼å½±åå°æå¡açååºï¼aè°ç¨bï¼ï¼è¿èäº§çè¿éååºï¼ç´è³å½±åæ´ä¸ªä¾èµé¾ä¸çæææå¡ï¼éªå´©ï¼ï¼è¯¥å¦ä½å¤çï¼ï¼çæ­éçº§ï¼\n\nsentinel åä¸ºä¸¤ä¸ªé¨å:\n\n * æ ¸å¿åºï¼java å®¢æ·ç«¯ï¼ä¸ä¾èµä»»ä½æ¡æ¶/åºï¼è½å¤è¿è¡äºææ java è¿è¡æ¶ç¯å¢ï¼åæ¶å¯¹ dubbo / spring cloud ç­æ¡æ¶ä¹æè¾å¥½çæ¯æã\n * æ§å¶å°ï¼dashboardï¼åºäº spring boot å¼åï¼æååå¯ä»¥ç´æ¥è¿è¡ï¼ä¸éè¦é¢å¤ç tomcat ç­åºç¨å®¹å¨ã\n   * java -dserver.port=9091 -jar sentinel-dashboard-1.8.5.jar\n\néæµåç¹ï¼\n\n * httpåç¹ï¼sentinel starteré»è®¤ä¸ºææçhttpæ¥å£æä¾äºéæµåç¹\n * èªå®ä¹åç¹ï¼éè¿ @sentinelresource å®ä¹èµæºåç¹\n\næµæ§ææï¼\n\n * å¿«éå¤±è´¥\n * warm upï¼éè¿"å·å¯å¨"ï¼è®©éè¿çæµéç¼æ¢å¢å ï¼å¨ä¸å®æ¶é´åéæ¸å¢å å°éå¼ä¸éï¼ç»å·ç³»ç»ä¸ä¸ªé¢ç­çæ¶é´ï¼é¿åå·ç³»ç»è¢«åå®ãåºå±æ¯ä»¤çæ¡¶ç®æ³çå®ç°\n * æéç­å¾ï¼åéæéæ¹å¼ä¼ä¸¥æ ¼æ§å¶è¯·æ±éè¿çé´éæ¶é´ï¼ä¹å³æ¯è®©è¯·æ±ä»¥ååçéåº¦éè¿ï¼å¯¹åºçæ¯æ¼æ¡¶ç®æ³ã\n\næµæ§æ¨¡å¼ï¼\n\n * ç´æ¥æç»\n * å³èï¼å½å³èçèµæºè¾¾å°éå¼æ¶ï¼éæµèªå·±\n * é¾è·¯ï¼åªè®°å½æå®é¾è·¯ä¸çæµéï¼æå®èµæºä»å¥å£èµæºè¿æ¥çæµéï¼å¦æè¾¾å°éå¼ï¼å°±å¯ä»¥éæµï¼\n\nä¸¤ç§ç»è®¡ç±»åï¼\n\n * qps\n * å¹¶åçº¿ç¨æ°\n\nçæ­éçº§ï¼\n\nä¸ç§çæ­ç­ç¥ï¼\n\n * å¹³åååºæ¶é´\n * å¼å¸¸æ¯ä¾\n * å¼å¸¸æ°\n\nçæ­åéçº§ï¼gptï¼ï¼\n\nçæ­åéçº§æ¯ç¸å³çæ¦å¿µï¼ä½å®ä»¬å¹¶ä¸å®å¨ç¸åã\n\néçº§æ¯æå½ç³»ç»åºç°å¼å¸¸ãæéãé«è´è½½ç­æåµæ¶ï¼ä¸ºäºä¿è¯ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼éè¿ä¸å®çææ®µéä½ç³»ç»çæå¡è½åï¼æé«ç³»ç»çå®¹éè½åï¼é¿åç³»ç»å´©æºæèéªå´©ã\n\nçæ­æ¯æå½æå¡è°ç¨å¤±è´¥çè¶è¿ä¸å®çéå¼æ¶ï¼éè¿æ­è·¯å¨çæºå¶ï¼å°å¯¹è¯¥æå¡çè¯·æ±çæ­æèéå¶å¶è®¿é®ï¼é²æ­¢è¯·æ±ç»§ç»­è°ç¨å¤±è´¥ï¼ä»èä¿è¯æå¡çå¯ç¨æ§åç¨³å®æ§ãçæ­æºå¶å¯ä»¥åè½»ç³»ç»çè´è½½ï¼é¿åæéæ©æ£ï¼åæ¶ä¹å¯ä»¥å éæéçæ¢å¤ã\n\nå æ­¤ï¼çæ­åéçº§é½æ¯ä¸ºäºä¿è¯ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼ä½å®ä»¬çå®ç°æºå¶ååºç¨åºæ¯ä¸åãéçº§ä¸»è¦æ¯ä¸ºäºä¿è¯æ´ä½ç³»ç»çç¨³å®æ§åå¯ç¨æ§ï¼é¿åéªå´©æåºï¼èçæ­ä¸»è¦æ¯ä¸ºäºä¿æ¤è¢«è°ç¨æå¡çç¨³å®æ§åå¯ç¨æ§ï¼é¿åéè¯¯çè¯·æ±ç»§ç»­åçï¼å¯¼è´æå¡çè´è½½è¿é«ãæ§è½ä¸éæèæéæ©æ£ç­é®é¢ã\n\n\n# æä¹å\n\né»è®¤æåµä¸ï¼sentinel-dashboard ä¸­çè§åæ¯å­å¨å¨å¾®æå¡ï¼ä¸æ¯dashboardçï¼æ¯å®éæ¯ä½¿ç¨å®çï¼åå­ä¸­ï¼éå¯åå°±ä¼ä¸¢å¤±ã\n\n * æ¬å°æä»¶æä¹åï¼å¨sentinelçå¯å¨åæ°ä¸­ï¼éè¿-dcsp.sentinel.dashboard.file=filepathæå®éç½®æä»¶çè·¯å¾\n\n * ç¨ nacos å½éç½®ä¸­å¿ï¼éè¦å¼å¥sentinel-datasource-nacosçä¾èµï¼å¹¶å¨åºç¨éç½®æä»¶ä¸­éç½®nacosçå°ååè®¤è¯ä¿¡æ¯ãsentinelä¼èªå¨ä»nacoså è½½è§åéç½®ä¿¡æ¯ã\n\n * ç¼ç¨æ¹å¼å è½½åæä¹åï¼å¯ä»¥éè¿ç¼ç¨æ¹å¼å è½½åæä¹åè§åéç½®ä¿¡æ¯ãå¯ä»¥ä½¿ç¨com.alibaba.csp.sentinel.datasource.converteræ¥å£å®ç°èªå®ä¹çæ°æ®æºåè§åéç½®ä¿¡æ¯çè½¬æ¢é»è¾ãç¶åä½¿ç¨com.alibaba.csp.sentinel.datasource.readabledatasourceåcom.alibaba.csp.sentinel.datasource.writabledatasourceæ¥å£æ¥å è½½åæä¹åè§åéç½®ã\n\n\n# our project stratage\n\n * ç¨ sentinelåå®æ¶çæ§ã\n\n * åæ¶å¨ gateway ç½å³è¿è¡éæµ\n\n * éæµåæ°åºè¯¥è®¾å®ï¼ç®åä¸ºç®åæ¨¡æï¼å·ä½åæ°éè¦æ ¹æ®å®éæåµè¿è¡è°ç ã\n\nå½åçè§åï¼ï¼æè§æç¹å¥æªgptï¼\n\n 1. éå¯¹é¢è®¢ç«è½¦ç¥¨çapiæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯åéåè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼500ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼200æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼50ä¸ªå¹¶åè¯·æ±ã\n 2. éå¯¹ç¨æ·æ³¨åçapiæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯å°æ¶åè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼100ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼500æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼10ä¸ªå¹¶åè¯·æ±ã\n 3. éå¯¹ç«è½¦ç¥¨æ¥è¯¢çapiæ¥å£è¿è¡éæµï¼\n    * è®¾ç½®æ¯ç§åè®¸éè¿çè¯·æ±æ°éï¼ä¾å¦ï¼200ä¸ªè¯·æ±ã\n    * è®¾ç½®ä¸ä¸ªå¹³åååºæ¶é´éå¼ï¼ä¾å¦ï¼100æ¯«ç§ã\n    * è®¾ç½®ä¸ä¸ªæå¤§å¹¶åæ°ï¼ä¾å¦ï¼20ä¸ªå¹¶åè¯·æ±ã\n\næ»èè¨ä¹ï¼éå¯¹é¢å®è½¦ç¥¨æ¥å£è®¾å®äºåæº qps = 500ï¼ç¶åå°±å¿«éå¤±è´¥ãéå¯¹ route id = member è¿è¡éæµã\n\n\n# æ³¨æ\n\nçæ¬å¯¹åºï¼\n\ncom.alibaba.cloud ççæ¬å°±åæ¬äºå®åä¸é¢çstarterãæè®¸å¼å¥ alibaba çåé½éè¦æå¨æå®çæ¬ã\n\nå¦æè¿ç§æåµmavenæ æ³ä¸å°åï¼å°±åæå®çæ¬å·è®©å®å»ä¸è½½\n<dependency>\n    <groupid>com.alibaba.cloud</groupid>\n    <artifactid>spring-cloud-starter-alibaba-sentinel</artifactid>\n</dependency>\n\n<dependency>\n  <groupid>com.alibaba.cloud</groupid>\n  <artifactid>spring-cloud-starter-alibaba-sentinel</artifactid>\n  <version>2022.0.0.0-rc1</version>\n</dependency>\n\n\n\n# todo\n\néè¦ææç½ï¼ç½å³éæµåå·ä½å¾®æå¡éæµä½¿ç¨ä¸çåºå«\n\nç½å³éæµå¯éå¯¹ route id è¿è¡ç»ä¸éæµã\n\nå·ä½å¾®æå¡çéæµï¼æ´å¤æ¯å¯¹å·ä½çæä¸ªapiè¿è¡éæµã\n\nreference:\n\n * https://www.cnblogs.com/gagaxiang/p/17014134.html\n\n * https://juejin.cn/post/7018406221120045087#heading-38 more useful é¢ç»\n\n * https://github.com/alibaba/spring-cloud-alibaba/wiki/%e7%89%88%e6%9c%ac%e8%af%b4%e6%98%8e çæ¬è¯´æ',charsets:{cjk:!0}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-04-19T17:04:09.000Z",permalink:"/pages/d16eb4/",article:!1},regularPath:"/temp/spring%20data%20rest.html",relativePath:"temp/spring data rest.md",key:"v-42d727d9",path:"/pages/d16eb4/",headersStr:null,content:"Spring Data RESTæ¯åºäºSpring Dataçrepositoryä¹ä¸ï¼å¯ä»¥æ repository èªå¨è¾åºä¸ºRESTèµæºï¼ç®åæ¯æSpring Data JPAãSpring Data MongoDBãSpring Data Neo4jãSpring Data GemFireãSpring Data Cassandraç repository èªå¨è½¬æ¢æRESTæå¡ãç®åç¹è¯´ï¼Spring Data RESTææä»¬éè¦ç¼åçå¤§éRESTæ¨¡çæ¥å£åäºèªå¨åå®ç°ã\n\nhttps://cloud.tencent.com/developer/article/1172353",normalizedContent:"spring data restæ¯åºäºspring dataçrepositoryä¹ä¸ï¼å¯ä»¥æ repository èªå¨è¾åºä¸ºrestèµæºï¼ç®åæ¯æspring data jpaãspring data mongodbãspring data neo4jãspring data gemfireãspring data cassandraç repository èªå¨è½¬æ¢ærestæå¡ãç®åç¹è¯´ï¼spring data restææä»¬éè¦ç¼åçå¤§érestæ¨¡çæ¥å£åäºèªå¨åå®ç°ã\n\nhttps://cloud.tencent.com/developer/article/1172353",charsets:{cjk:!0}},{title:"spring-temp",frontmatter:{title:"spring-temp",date:"2023-06-07T10:58:15.000Z",permalink:"/pages/cfda81/"},regularPath:"/temp/spring-temp.html",relativePath:"temp/spring-temp.md",key:"v-91d0c51a",path:"/pages/cfda81/",headersStr:null,content:"spring all temp\n\nbase spring 5.x, current[2023.06.06] is spring 6.0.9\n\nSpringbootå®éä¸éè¿çº¦å®å¤§äºéç½®çæ¹å¼ï¼ä½¿ç¨xx-starterç»ä¸çå¯¹Beanè¿è¡é»è®¤åå§åï¼ç¨æ·åªéè¦å¾å°çéç½®å°±å¯ä»¥è¿è¡å¼åäºã",normalizedContent:"spring all temp\n\nbase spring 5.x, current[2023.06.06] is spring 6.0.9\n\nspringbootå®éä¸éè¿çº¦å®å¤§äºéç½®çæ¹å¼ï¼ä½¿ç¨xx-starterç»ä¸çå¯¹beanè¿è¡é»è®¤åå§åï¼ç¨æ·åªéè¦å¾å°çéç½®å°±å¯ä»¥è¿è¡å¼åäºã",charsets:{cjk:!0}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-04-16T15:38:03.000Z",permalink:"/pages/9a2825/",article:!1},regularPath:"/temp/springboot3.html",relativePath:"temp/springboot3.md",key:"v-5bbea173",path:"/pages/9a2825/",headers:[{level:2,title:"Springboot3æ°ç¹æ§ï¼æ¯æAOT",slug:"springboot3æ°ç¹æ§-æ¯æaot",normalizedTitle:"springboot3æ°ç¹æ§ï¼æ¯æaot",charIndex:2},{level:2,title:"AOTä¸JIT",slug:"aotä¸jit",normalizedTitle:"aotä¸jit",charIndex:27},{level:2,title:"JITå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢",slug:"jitå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢",normalizedTitle:"jitå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢",charIndex:279},{level:2,title:"Springboot3ä¸ä½¿ç¨GraalVMä»£æ¿JDKå®ç°AOT",slug:"springboot3ä¸ä½¿ç¨graalvmä»£æ¿jdkå®ç°aot",normalizedTitle:"springboot3ä¸ä½¿ç¨graalvmä»£æ¿jdkå®ç°aot",charIndex:688}],headersStr:"Springboot3æ°ç¹æ§ï¼æ¯æAOT AOTä¸JIT JITå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢ Springboot3ä¸ä½¿ç¨GraalVMä»£æ¿JDKå®ç°AOT",content:"# Springboot3æ°ç¹æ§ï¼æ¯æAOT\n\n\n# AOTä¸JIT\n\nJITï¼Just-in-Timeï¼å³æ¶ç¼è¯ï¼ï¼Java è·¨å¹³å°çåºç¡\n\nAOTï¼Ahead-of-Timeï¼é¢ç¼è¯ææåç¼è¯ï¼ï¼æ æ³è·¨å¹³å°\n\nAOT çä¼ç¹\n\n * å¯å¨åè¿è¡éåº¦å¿«ãä¼ ç»springbootç©ºé¡¹ç®å¯å¨æ¶é´å¤§æ¦æ¯2ç§ï¼AOT çå¯å¨æ¶é´å¤§æ¦æ¯100æ¯«ç§ã\n * æåä½ç§¯å°ã ï¼ä¸ç¨å®è£ jdkï¼å¨ Windows ç´æ¥çæ exe æä»¶ï¼ãä¸ºäºåçã\n\nAOT çç¼ºç¹\n\n * ç¼è¯åçç¨åºä¸æ¯æè·¨å¹³å°\n * ä¸æ¯æå¨æåè½ï¼å¦AOPãå ä¸ºä¸ä¼çæå­èç äºã\n\n\n# JITå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢\n\nç°è±¡ï¼ç­ç¹åºç¨éå¯åï¼åºç°ä¸å¡è¶æ¶ï¼å åéåæ¢å¤æ­£å¸¸ã\n\ngraph TD;\n\tå¼å§--\x3ejavaæä»¶;\n\tjavaæä»¶--ç¼è¯--\x3eclazzæä»¶;\n\tclazzæä»¶--æ­£å¸¸--\x3eè§£éå¨;\n\tclazzæä»¶--ç­ç¹--\x3eJITç¼è¯;\n\tè§£éå¨--\x3eç³»ç»/ç¡¬ä»¶;\n\tJITç¼è¯--\x3eç³»ç»/ç¡¬ä»¶;\n\t\n\n\nåå ï¼\n\nJVMæ··åæ§è¡æ¨¡å¼ï¼åæä»¥è§£éæ¹å¼æ§è¡ï¼æ§è¡æçæ¢ãå½æ§è¡æ¬¡æ°/é¢æ¬¡å¨å¨å¶å®éå¼åï¼è§¦åJITç¼è¯ï¼ç¼è¯åï¼ä»¥æºå¨æä»¤ç æ¹å¼æ§è¡ï¼æ§è¡æçæé«ã\n\nç»èï¼\n\nå¯å¨åæï¼åºç¨ä»¥è§£éæ§è¡ï¼æ§è¡æçä½ï¼CPUææä¸åã\n\nè§¦åJITç¼è¯ï¼CPU&loadé£é«ï¼è¯·æ±å ç§¯çº¿ç¨æ± æ»¡ï¼åºç°è¯·æ±è¶æ¶æåµã\n\nJITç¼è¯åï¼CPUéä½ï¼è¯·æ±å¤çå¿«ï¼æå¡éæ¸æ¢å¤ã\n\nè§£å³æ¹æ³ï¼\n\né¢ç­ï¼åè¯è®©ç¨åºèªå¨æ§è¡ç­ç¹ä»£ç å ç¾æ¬¡ã\n\næµéæ§å¶ï¼å¯å¨æ¶å°æµéï¼è¿è¡å åéååæ¾å°æ­£å¸¸æµéã\n\n\n# Springboot3ä¸ä½¿ç¨GraalVMä»£æ¿JDKå®ç°AOT\n\nGraalVM ä¹æ¯ oracle çã\n\næ­¥éª¤ï¼\n\n 1. GrallVM å®è£\n 2. GrallVM ç¯å¢åééç½®ï¼ä»£æ¿jdk\n 3. å®è£ native-imageï¼gu install native-image\n 4. æ¥çå®è£ç»æ gu list\n 5. GrallVM AOTæåï¼æ§è¡ mvn -Pnative native:compile\n 6. å¨ target ä¸ä¼ææ§è¡æä»¶",normalizedContent:"# springboot3æ°ç¹æ§ï¼æ¯æaot\n\n\n# aotä¸jit\n\njitï¼just-in-timeï¼å³æ¶ç¼è¯ï¼ï¼java è·¨å¹³å°çåºç¡\n\naotï¼ahead-of-timeï¼é¢ç¼è¯ææåç¼è¯ï¼ï¼æ æ³è·¨å¹³å°\n\naot çä¼ç¹\n\n * å¯å¨åè¿è¡éåº¦å¿«ãä¼ ç»springbootç©ºé¡¹ç®å¯å¨æ¶é´å¤§æ¦æ¯2ç§ï¼aot çå¯å¨æ¶é´å¤§æ¦æ¯100æ¯«ç§ã\n * æåä½ç§¯å°ã ï¼ä¸ç¨å®è£ jdkï¼å¨ windows ç´æ¥çæ exe æä»¶ï¼ãä¸ºäºåçã\n\naot çç¼ºç¹\n\n * ç¼è¯åçç¨åºä¸æ¯æè·¨å¹³å°\n * ä¸æ¯æå¨æåè½ï¼å¦aopãå ä¸ºä¸ä¼çæå­èç äºã\n\n\n# jitå¨é«å¹¶ååºæ¯ä¸­ççäº§é®é¢\n\nç°è±¡ï¼ç­ç¹åºç¨éå¯åï¼åºç°ä¸å¡è¶æ¶ï¼å åéåæ¢å¤æ­£å¸¸ã\n\ngraph td;\n\tå¼å§--\x3ejavaæä»¶;\n\tjavaæä»¶--ç¼è¯--\x3eclazzæä»¶;\n\tclazzæä»¶--æ­£å¸¸--\x3eè§£éå¨;\n\tclazzæä»¶--ç­ç¹--\x3ejitç¼è¯;\n\tè§£éå¨--\x3eç³»ç»/ç¡¬ä»¶;\n\tjitç¼è¯--\x3eç³»ç»/ç¡¬ä»¶;\n\t\n\n\nåå ï¼\n\njvmæ··åæ§è¡æ¨¡å¼ï¼åæä»¥è§£éæ¹å¼æ§è¡ï¼æ§è¡æçæ¢ãå½æ§è¡æ¬¡æ°/é¢æ¬¡å¨å¨å¶å®éå¼åï¼è§¦åjitç¼è¯ï¼ç¼è¯åï¼ä»¥æºå¨æä»¤ç æ¹å¼æ§è¡ï¼æ§è¡æçæé«ã\n\nç»èï¼\n\nå¯å¨åæï¼åºç¨ä»¥è§£éæ§è¡ï¼æ§è¡æçä½ï¼cpuææä¸åã\n\nè§¦åjitç¼è¯ï¼cpu&loadé£é«ï¼è¯·æ±å ç§¯çº¿ç¨æ± æ»¡ï¼åºç°è¯·æ±è¶æ¶æåµã\n\njitç¼è¯åï¼cpuéä½ï¼è¯·æ±å¤çå¿«ï¼æå¡éæ¸æ¢å¤ã\n\nè§£å³æ¹æ³ï¼\n\né¢ç­ï¼åè¯è®©ç¨åºèªå¨æ§è¡ç­ç¹ä»£ç å ç¾æ¬¡ã\n\næµéæ§å¶ï¼å¯å¨æ¶å°æµéï¼è¿è¡å åéååæ¾å°æ­£å¸¸æµéã\n\n\n# springboot3ä¸ä½¿ç¨graalvmä»£æ¿jdkå®ç°aot\n\ngraalvm ä¹æ¯ oracle çã\n\næ­¥éª¤ï¼\n\n 1. grallvm å®è£\n 2. grallvm ç¯å¢åééç½®ï¼ä»£æ¿jdk\n 3. å®è£ native-imageï¼gu install native-image\n 4. æ¥çå®è£ç»æ gu list\n 5. grallvm aotæåï¼æ§è¡ mvn -pnative native:compile\n 6. å¨ target ä¸ä¼ææ§è¡æä»¶",charsets:{cjk:!0}},{title:"project oriented learning",frontmatter:{title:"project oriented learning",date:"2023-05-14T17:11:09.000Z",permalink:"/pages/22b30f/",article:!1},regularPath:"/temp/tip:%20project%20oriented%20learning.html",relativePath:"temp/tip: project oriented learning.md",key:"v-372121bc",path:"/pages/22b30f/",headersStr:null,content:"project oriented learning rather than learning from textbook or course\n\nbig project in mind, break it down into smaller projects smaller goals until eventually you have these thing that feel manageable. if you don't slove, go to a resource like google, stackoverflow, chat gpt, and query ask question until you can figure it out.\n\nstep:\n\n 1. pick a project\n 2. pick a language\n 3. set up your tools\n 4. make sure your tools are working. (hello world)\n 5. iterative refinement\n 6. fall in love~",normalizedContent:"project oriented learning rather than learning from textbook or course\n\nbig project in mind, break it down into smaller projects smaller goals until eventually you have these thing that feel manageable. if you don't slove, go to a resource like google, stackoverflow, chat gpt, and query ask question until you can figure it out.\n\nstep:\n\n 1. pick a project\n 2. pick a language\n 3. set up your tools\n 4. make sure your tools are working. (hello world)\n 5. iterative refinement\n 6. fall in love~",charsets:{}},{title:"Untitled 1",frontmatter:{title:"Untitled 1",date:"2023-05-31T22:45:06.000Z",permalink:"/pages/6796b2/",article:!1},regularPath:"/temp/%E5%85%AB%E8%82%A1-mysql.html",relativePath:"temp/å«è¡-mysql.md",key:"v-4452d00c",path:"/pages/6796b2/",headers:[{level:2,title:"æä»éåå±äº«éå°±æ¯åéåè¯»éåï¼è¯»éå¯ä»¥æ¯æä»éåï¼",slug:"æä»éåå±äº«éå°±æ¯åéåè¯»éå-è¯»éå¯ä»¥æ¯æä»éå",normalizedTitle:"æä»éåå±äº«éå°±æ¯åéåè¯»éåï¼è¯»éå¯ä»¥æ¯æä»éåï¼",charIndex:2},{level:2,title:"å¿«ç§è¯»åå½åè¯»çåºå«ï¼ä»ä¹æ¯å½åè¯»ï¼è¯»çæ¯ä»ä¹æ¶åçæ°æ®ï¼",slug:"å¿«ç§è¯»åå½åè¯»çåºå«-ä»ä¹æ¯å½åè¯»-è¯»çæ¯ä»ä¹æ¶åçæ°æ®",normalizedTitle:"å¿«ç§è¯»åå½åè¯»çåºå«ï¼ä»ä¹æ¯å½åè¯»ï¼è¯»çæ¯ä»ä¹æ¶åçæ°æ®ï¼",charIndex:552},{level:2,title:"mvcc åéçå³ç³»ï¼",slug:"mvcc-åéçå³ç³»",normalizedTitle:"mvcc åéçå³ç³»ï¼",charIndex:1432},{level:2,title:"åºååçéç¦»çº§å«æ¯æä¹å®ç°çï¼å çéæ¯ä»ä¹éï¼æ¯ä¸´é´éåï¼",slug:"åºååçéç¦»çº§å«æ¯æä¹å®ç°ç-å çéæ¯ä»ä¹é-æ¯ä¸´é´éå",normalizedTitle:"åºååçéç¦»çº§å«æ¯æä¹å®ç°çï¼å çéæ¯ä»ä¹éï¼æ¯ä¸´é´éåï¼",charIndex:2163},{level:2,title:"innodb å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»åï¼",slug:"innodb-å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»å",normalizedTitle:"innodb å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»åï¼",charIndex:2424}],headersStr:"æä»éåå±äº«éå°±æ¯åéåè¯»éåï¼è¯»éå¯ä»¥æ¯æä»éåï¼ å¿«ç§è¯»åå½åè¯»çåºå«ï¼ä»ä¹æ¯å½åè¯»ï¼è¯»çæ¯ä»ä¹æ¶åçæ°æ®ï¼ mvcc åéçå³ç³»ï¼ åºååçéç¦»çº§å«æ¯æä¹å®ç°çï¼å çéæ¯ä»ä¹éï¼æ¯ä¸´é´éåï¼ innodb å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»åï¼",content:"# æä»éåå±äº«éå°±æ¯åéåè¯»éåï¼è¯»éå¯ä»¥æ¯æä»éåï¼\n\næ»çæ¥è¯´ï¼æä»éï¼Exclusive Lockï¼æ¯åéï¼ç¨äºä¿æ¤æ°æ®å¯¹è±¡çä¸è´æ§åå®æ´æ§ï¼èå±äº«éï¼Shared Lockï¼éå¸¸æ¯è¯»éï¼ç¨äºåè®¸å¤ä¸ªäºå¡å¹¶åè¯»åæ°æ®å¯¹è±¡ãå¨æäºæ°æ®åºç³»ç»ä¸­ï¼æä»éä¹å¯ä»¥è¢«ç¨ä½è¯»éã\n\n**å±äº«é Shared Lockï¼**åç§°ä¸ºè¯»éï¼è·å¾å±äº«éä¹åï¼å¯ä»¥æ¥çä½æ æ³ä¿®æ¹åå é¤æ°æ®ã\n\n**æä»é Exclusive Lockï¼**åç§°ä¸ºåéãç¬å éï¼è·å¾æä»éä¹åï¼æ¢è½è¯»æ°æ®ï¼åè½ä¿®æ¹æ°æ®ã\n\nä½¿ç¨å±äº«éï¼SELECT ... LOCK IN SHARE MODE;\n\nå½æ²¡æå¶ä»çº¿ç¨å¯¹æ¥è¯¢ç»æéä¸­çä»»ä½ä¸è¡ä½¿ç¨æä»éæ¶ï¼å¯ä»¥æåç³è¯·å±äº«éï¼å¦åä¼è¢«é»å¡ãå¶ä»çº¿ç¨ä¹å¯ä»¥è¯»åä½¿ç¨äºå±äº«éçè¡¨ï¼èä¸è¿äºçº¿ç¨è¯»åçæ¯åä¸ä¸ªçæ¬çæ°æ®ã\n\nä½¿ç¨æä»éï¼SELECT ... FOR UPDATE;\n\nå½æ²¡æå¶ä»çº¿ç¨å¯¹æ¥è¯¢ç»æéä¸­çä»»ä½ä¸è¡ä½¿ç¨æä»éæ¶ï¼å¯ä»¥æåç³è¯·æä»éï¼å¦åä¼è¢«é»å¡ã\n\nMySqlçInnoDBå¼ææ¥è¯´ï¼å¯¹äºinsertãupdateãdeleteç­æä½ãä¼èªå¨ç»æ¶åçæ°æ®å æä»éï¼å¯¹äºä¸è¬çselectè¯­å¥ï¼InnoDBä¸ä¼å ä»»ä½éï¼äºå¡å¯ä»¥éè¿ä»¥ä¸è¯­å¥ç»æ¾ç¤ºå å±äº«éææä»éã\n\n\n# å¿«ç§è¯»åå½åè¯»çåºå«ï¼ä»ä¹æ¯å½åè¯»ï¼è¯»çæ¯ä»ä¹æ¶åçæ°æ®ï¼\n\nå¿«ç§è¯»ï¼Snapshot Readï¼ï¼ä¹ç§°ä¸ºå½åè¯»ï¼æ¯åºäºæ°æ®åºçä¸è´æ§è§å¾æ¥è¯»åæ°æ®ãå®è¯»åçæ¯äºå¡å¼å§æ¶æ°æ®åºä¸­çæ°æ®å¿«ç§ï¼å³æä¸ªç¹å®æ¶å»çæ°æ®ãè¿æå³çæ è®ºå¶ä»äºå¡æ¯å¦æ­£å¨ä¿®æ¹æ°æ®ï¼å¿«ç§è¯»å§ç»è¯»åçæ¯ä¸è´çãéæçæ°æ®å¿«ç§ãå¿«ç§è¯»ä¸ä¼åå°å¶ä»å¹¶åäºå¡çä¿®æ¹æä½çå½±åï¼å æ­¤å¯ä»¥æä¾è¾é«çå¹¶åæ§è½ã\n\nå¿«ç§è¯»è¯»åçæ¯è®°å½æ°æ®çå¯è§çæ¬ï¼ä¸å éï¼ä¸å éçæ®éselectè¯­å¥é½æ¯å¿«ç§è¯»ï¼å³ä¸å éçéé»å¡è¯»ã\n\nå¿«ç§è¯»çæ§è¡æ¹å¼æ¯çæ ReadViewï¼ç´æ¥å©ç¨ MVCC æºå¶æ¥è¿è¡è¯»åï¼å¹¶ä¸ä¼å¯¹è®°å½è¿è¡å éã\n\nå½åè¯»ï¼Current Readï¼ï¼ä¹ç§°ä¸ºéå®è¯»ï¼æ¯åºäºå½åäºå¡çææ°æ°æ®æ¥è¯»åæ°æ®ãå®è¯»åçæ¯å¶ä»äºå¡å·²ç»æäº¤çææ°æ°æ®ãå½åè¯»ä¼è·åææ°çæ°æ®ï¼è¿åæ¬äºå¶ä»å¹¶åäºå¡å·²ç»æäº¤çä¿®æ¹ãå½åè¯»å¯ä»¥è¯»åå¶ä»äºå¡æåçæ´æ¹ï¼å æ­¤å¯ä»¥æä¾å®æ¶çæ°æ®ï¼ä½åæ¶ä¹å¯è½ä¼åå°å¶ä»å¹¶åäºå¡çå½±åãå¦æå¶ä»äºå¡æ­£å¨ä¿®æ¹è¢«å½åè¯»æä½ææ¶åçæ°æ®ï¼å¯è½ä¼å¯¼è´è¯»åå°ä¸ä¸è´çæ°æ®æèè¯»åæä½è¢«é»å¡ã\n\nå½åè¯»è¯»åçæ¯è®°å½æ°æ®çææ°çæ¬ï¼å¹¶ä¸éè¦åè·åå¯¹åºè®°å½çéã\n\nSELECT * FROM student LOCK IN SHARE MODE;  # å±äº«é\nSELECT * FROM student FOR UPDATE; # æä»é\nINSERT INTO student values ...  # æä»é\nDELETE FROM student WHERE ...  # æä»é\nUPDATE student SET ...  # æä»é\n\n\næ»ç»èµ·æ¥ï¼å¿«ç§è¯»æ¯åºäºäºå¡å¼å§æ¶çæ°æ®å¿«ç§è¿è¡è¯»åï¼èå½åè¯»æ¯åºäºå½åäºå¡çææ°æ°æ®è¿è¡è¯»åãå½åè¯»å¯ä»¥æä¾å®æ¶çæ°æ®ï¼ä½å¯è½åå°å¹¶åäºå¡çå½±åã\n\nMVCCå¨å¿«ç§è¯»çæåµä¸å¯ä»¥è§£å³å¹»è¯»é®é¢ï¼ä½æ¯å¨å½åè¯»çæåµä¸æ¯ä¸è½è§£å³å¹»è¯»çã\n\nhttps://cloud.tencent.com/developer/article/2123130\n\n\n# mvcc åéçå³ç³»ï¼\n\nMVCCï¼Multi-Version Concurrency Controlï¼åéæ¯æ°æ®åºä¸­å¹¶åæ§å¶çä¸¤ç§ä¸åæºå¶ã\n\nå¨MySQLæ°æ®åºçInnoDBå­å¨å¼æä¸­ï¼MVCCåéæºå¶æ¯ç¸äºéåä½¿ç¨çå¹¶åæ§å¶ç­ç¥ã\n\nInnoDBä½¿ç¨MVCCæ¥å®ç°è¯»æä½çå¹¶åæ§ãæ¯ä¸ªäºå¡å¨å¼å§æ¶ä¼åå»ºä¸ä¸ªäºå¡ç§æçæ°æ®å¿«ç§ï¼ä¹ç§°ä¸ºè¯»è§å¾ï¼ï¼è¯»æä½åªä¼è¯»åè¯¥æ°æ®å¿«ç§ä¸­çæ°æ®ãè¿æå³çå¹¶åäºå¡å¯ä»¥åæ¶è¯»ååä¸æ°æ®å¯¹è±¡ï¼èä¸ä¼äºç¸å¹²æ°ãMVCCä½¿ç¨äºçæ¬å·ååæ»æ®µï¼undo logï¼çæºå¶æ¥ç®¡çæ°æ®çæ¬ååæ»æä½ï¼ä»¥ç¡®ä¿äºå¡è¯»åçæ¯ä¸è´æ§çæ°æ®è§å¾ã\n\nåæ¶ï¼InnoDBä¹ä½¿ç¨éæºå¶æ¥ç®¡çå¹¶ååæä½ãå¨åæä½ä¸­ï¼InnoDBä¼æ ¹æ®éè¦ä½¿ç¨è¡çº§å«çéæ¥ä¿æ¤æ°æ®çä¸è´æ§ãè¯»æä½ä¸ä¼å éï¼åè®¸å¹¶åè¯»åï¼ä½åæä½å¯è½ä¼æ¶åéçè·ååéæ¾ãInnoDBæä¾äºä¸¤ç§ç±»åçéï¼å±äº«éï¼Shared Lockï¼åæä»éï¼Exclusive Lockï¼ãå±äº«éåè®¸å¤ä¸ªäºå¡åæ¶è¯»ååä¸æ°æ®å¯¹è±¡ï¼èæä»éå¨åæä½æ¶ä¼é»æ­¢å¶ä»äºå¡è¯»åæåå¥è¯¥æ°æ®å¯¹è±¡ã\n\nMVCCåéæºå¶å¨InnoDBå­å¨å¼æä¸­ååå·¥ä½ï¼ä»¥å®ç°æ°æ®çä¸è´æ§åå¹¶åæ§ãMVCCæºå¶ç¨äºè¯»æä½ï¼æä¾äºé«åº¦çå¹¶åæ§è½ï¼åè®¸å¤ä¸ªäºå¡åæ¶è¯»åæ°æ®ãéæºå¶ç¨äºåæä½ï¼éè¿éå®è¡çº§å«çèµæºæ¥ä¿æ¤æ°æ®çä¸è´æ§ï¼é¿åå¹¶åäºå¡çå²çªã\n\néè¦æ³¨æçæ¯ï¼MVCCåéçå·ä½è¡ä¸ºåä½¿ç¨æ¹å¼å¨ä¸åçéç¦»çº§å«ä¸å¯è½ä¼ææä¸åãMySQLæä¾äºå¤ä¸ªéç¦»çº§å«ï¼å¦è¯»æªæäº¤ãè¯»å·²æäº¤ãå¯éå¤è¯»åä¸²è¡åï¼ï¼æ¯ä¸ªéç¦»çº§å«å¯¹äºMVCCåéçä½¿ç¨æ¹å¼åç²åº¦å¯è½ä¼ææè°æ´ã\n\nï¼confuseï¼è¯»æä½é½ç¨MVCCäºï¼é£å±äº«éç¨å¨åªå¢ï¼ï¼\n\n\n# åºååçéç¦»çº§å«æ¯æä¹å®ç°çï¼å çéæ¯ä»ä¹éï¼æ¯ä¸´é´éåï¼\n\nä¸ºäºå®ç°åºååéç¦»çº§å«ï¼MySQLä½¿ç¨äºä¸¤ç§ç±»åçéï¼ä¸´é®éï¼Next-Key Locksï¼åé´ééï¼Gap Locksï¼ãï¼è¿éè¦é´ééåï¼ï¼\n\nä¸´é®éç¨äºä¿æ¤ç´¢å¼é®å¼åèå´ï¼é²æ­¢å¶ä»äºå¡å¯¹ç¸åçé®å¼èå´è¿è¡æå¥ãæ´æ°æå é¤æä½ãå½ä¸ä¸ªäºå¡è·åäºä¸´é®éæ¶ï¼å¶ä»äºå¡æ æ³å¯¹ç¸åçç´¢å¼é®å¼èå´è¿è¡ä¿®æ¹ï¼ä»èå®ç°äºä¸²è¡åçææã\n\né´ééç¨äºä¿æ¤ç´¢å¼é®å¼ä¹é´çé´éï¼å³ä¸å­å¨çé®å¼èå´ï¼ãå®é²æ­¢å¶ä»äºå¡å¨è¿ä¸ªé´éä¸­æå¥æ°çç´¢å¼é®å¼ï¼ä»èé¿åäºå¹»è¯»çé®é¢ã\n\n\n# innodb å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»åï¼",normalizedContent:"# æä»éåå±äº«éå°±æ¯åéåè¯»éåï¼è¯»éå¯ä»¥æ¯æä»éåï¼\n\næ»çæ¥è¯´ï¼æä»éï¼exclusive lockï¼æ¯åéï¼ç¨äºä¿æ¤æ°æ®å¯¹è±¡çä¸è´æ§åå®æ´æ§ï¼èå±äº«éï¼shared lockï¼éå¸¸æ¯è¯»éï¼ç¨äºåè®¸å¤ä¸ªäºå¡å¹¶åè¯»åæ°æ®å¯¹è±¡ãå¨æäºæ°æ®åºç³»ç»ä¸­ï¼æä»éä¹å¯ä»¥è¢«ç¨ä½è¯»éã\n\n**å±äº«é shared lockï¼**åç§°ä¸ºè¯»éï¼è·å¾å±äº«éä¹åï¼å¯ä»¥æ¥çä½æ æ³ä¿®æ¹åå é¤æ°æ®ã\n\n**æä»é exclusive lockï¼**åç§°ä¸ºåéãç¬å éï¼è·å¾æä»éä¹åï¼æ¢è½è¯»æ°æ®ï¼åè½ä¿®æ¹æ°æ®ã\n\nä½¿ç¨å±äº«éï¼select ... lock in share mode;\n\nå½æ²¡æå¶ä»çº¿ç¨å¯¹æ¥è¯¢ç»æéä¸­çä»»ä½ä¸è¡ä½¿ç¨æä»éæ¶ï¼å¯ä»¥æåç³è¯·å±äº«éï¼å¦åä¼è¢«é»å¡ãå¶ä»çº¿ç¨ä¹å¯ä»¥è¯»åä½¿ç¨äºå±äº«éçè¡¨ï¼èä¸è¿äºçº¿ç¨è¯»åçæ¯åä¸ä¸ªçæ¬çæ°æ®ã\n\nä½¿ç¨æä»éï¼select ... for update;\n\nå½æ²¡æå¶ä»çº¿ç¨å¯¹æ¥è¯¢ç»æéä¸­çä»»ä½ä¸è¡ä½¿ç¨æä»éæ¶ï¼å¯ä»¥æåç³è¯·æä»éï¼å¦åä¼è¢«é»å¡ã\n\nmysqlçinnodbå¼ææ¥è¯´ï¼å¯¹äºinsertãupdateãdeleteç­æä½ãä¼èªå¨ç»æ¶åçæ°æ®å æä»éï¼å¯¹äºä¸è¬çselectè¯­å¥ï¼innodbä¸ä¼å ä»»ä½éï¼äºå¡å¯ä»¥éè¿ä»¥ä¸è¯­å¥ç»æ¾ç¤ºå å±äº«éææä»éã\n\n\n# å¿«ç§è¯»åå½åè¯»çåºå«ï¼ä»ä¹æ¯å½åè¯»ï¼è¯»çæ¯ä»ä¹æ¶åçæ°æ®ï¼\n\nå¿«ç§è¯»ï¼snapshot readï¼ï¼ä¹ç§°ä¸ºå½åè¯»ï¼æ¯åºäºæ°æ®åºçä¸è´æ§è§å¾æ¥è¯»åæ°æ®ãå®è¯»åçæ¯äºå¡å¼å§æ¶æ°æ®åºä¸­çæ°æ®å¿«ç§ï¼å³æä¸ªç¹å®æ¶å»çæ°æ®ãè¿æå³çæ è®ºå¶ä»äºå¡æ¯å¦æ­£å¨ä¿®æ¹æ°æ®ï¼å¿«ç§è¯»å§ç»è¯»åçæ¯ä¸è´çãéæçæ°æ®å¿«ç§ãå¿«ç§è¯»ä¸ä¼åå°å¶ä»å¹¶åäºå¡çä¿®æ¹æä½çå½±åï¼å æ­¤å¯ä»¥æä¾è¾é«çå¹¶åæ§è½ã\n\nå¿«ç§è¯»è¯»åçæ¯è®°å½æ°æ®çå¯è§çæ¬ï¼ä¸å éï¼ä¸å éçæ®éselectè¯­å¥é½æ¯å¿«ç§è¯»ï¼å³ä¸å éçéé»å¡è¯»ã\n\nå¿«ç§è¯»çæ§è¡æ¹å¼æ¯çæ readviewï¼ç´æ¥å©ç¨ mvcc æºå¶æ¥è¿è¡è¯»åï¼å¹¶ä¸ä¼å¯¹è®°å½è¿è¡å éã\n\nå½åè¯»ï¼current readï¼ï¼ä¹ç§°ä¸ºéå®è¯»ï¼æ¯åºäºå½åäºå¡çææ°æ°æ®æ¥è¯»åæ°æ®ãå®è¯»åçæ¯å¶ä»äºå¡å·²ç»æäº¤çææ°æ°æ®ãå½åè¯»ä¼è·åææ°çæ°æ®ï¼è¿åæ¬äºå¶ä»å¹¶åäºå¡å·²ç»æäº¤çä¿®æ¹ãå½åè¯»å¯ä»¥è¯»åå¶ä»äºå¡æåçæ´æ¹ï¼å æ­¤å¯ä»¥æä¾å®æ¶çæ°æ®ï¼ä½åæ¶ä¹å¯è½ä¼åå°å¶ä»å¹¶åäºå¡çå½±åãå¦æå¶ä»äºå¡æ­£å¨ä¿®æ¹è¢«å½åè¯»æä½ææ¶åçæ°æ®ï¼å¯è½ä¼å¯¼è´è¯»åå°ä¸ä¸è´çæ°æ®æèè¯»åæä½è¢«é»å¡ã\n\nå½åè¯»è¯»åçæ¯è®°å½æ°æ®çææ°çæ¬ï¼å¹¶ä¸éè¦åè·åå¯¹åºè®°å½çéã\n\nselect * from student lock in share mode;  # å±äº«é\nselect * from student for update; # æä»é\ninsert into student values ...  # æä»é\ndelete from student where ...  # æä»é\nupdate student set ...  # æä»é\n\n\næ»ç»èµ·æ¥ï¼å¿«ç§è¯»æ¯åºäºäºå¡å¼å§æ¶çæ°æ®å¿«ç§è¿è¡è¯»åï¼èå½åè¯»æ¯åºäºå½åäºå¡çææ°æ°æ®è¿è¡è¯»åãå½åè¯»å¯ä»¥æä¾å®æ¶çæ°æ®ï¼ä½å¯è½åå°å¹¶åäºå¡çå½±åã\n\nmvccå¨å¿«ç§è¯»çæåµä¸å¯ä»¥è§£å³å¹»è¯»é®é¢ï¼ä½æ¯å¨å½åè¯»çæåµä¸æ¯ä¸è½è§£å³å¹»è¯»çã\n\nhttps://cloud.tencent.com/developer/article/2123130\n\n\n# mvcc åéçå³ç³»ï¼\n\nmvccï¼multi-version concurrency controlï¼åéæ¯æ°æ®åºä¸­å¹¶åæ§å¶çä¸¤ç§ä¸åæºå¶ã\n\nå¨mysqlæ°æ®åºçinnodbå­å¨å¼æä¸­ï¼mvccåéæºå¶æ¯ç¸äºéåä½¿ç¨çå¹¶åæ§å¶ç­ç¥ã\n\ninnodbä½¿ç¨mvccæ¥å®ç°è¯»æä½çå¹¶åæ§ãæ¯ä¸ªäºå¡å¨å¼å§æ¶ä¼åå»ºä¸ä¸ªäºå¡ç§æçæ°æ®å¿«ç§ï¼ä¹ç§°ä¸ºè¯»è§å¾ï¼ï¼è¯»æä½åªä¼è¯»åè¯¥æ°æ®å¿«ç§ä¸­çæ°æ®ãè¿æå³çå¹¶åäºå¡å¯ä»¥åæ¶è¯»ååä¸æ°æ®å¯¹è±¡ï¼èä¸ä¼äºç¸å¹²æ°ãmvccä½¿ç¨äºçæ¬å·ååæ»æ®µï¼undo logï¼çæºå¶æ¥ç®¡çæ°æ®çæ¬ååæ»æä½ï¼ä»¥ç¡®ä¿äºå¡è¯»åçæ¯ä¸è´æ§çæ°æ®è§å¾ã\n\nåæ¶ï¼innodbä¹ä½¿ç¨éæºå¶æ¥ç®¡çå¹¶ååæä½ãå¨åæä½ä¸­ï¼innodbä¼æ ¹æ®éè¦ä½¿ç¨è¡çº§å«çéæ¥ä¿æ¤æ°æ®çä¸è´æ§ãè¯»æä½ä¸ä¼å éï¼åè®¸å¹¶åè¯»åï¼ä½åæä½å¯è½ä¼æ¶åéçè·ååéæ¾ãinnodbæä¾äºä¸¤ç§ç±»åçéï¼å±äº«éï¼shared lockï¼åæä»éï¼exclusive lockï¼ãå±äº«éåè®¸å¤ä¸ªäºå¡åæ¶è¯»ååä¸æ°æ®å¯¹è±¡ï¼èæä»éå¨åæä½æ¶ä¼é»æ­¢å¶ä»äºå¡è¯»åæåå¥è¯¥æ°æ®å¯¹è±¡ã\n\nmvccåéæºå¶å¨innodbå­å¨å¼æä¸­ååå·¥ä½ï¼ä»¥å®ç°æ°æ®çä¸è´æ§åå¹¶åæ§ãmvccæºå¶ç¨äºè¯»æä½ï¼æä¾äºé«åº¦çå¹¶åæ§è½ï¼åè®¸å¤ä¸ªäºå¡åæ¶è¯»åæ°æ®ãéæºå¶ç¨äºåæä½ï¼éè¿éå®è¡çº§å«çèµæºæ¥ä¿æ¤æ°æ®çä¸è´æ§ï¼é¿åå¹¶åäºå¡çå²çªã\n\néè¦æ³¨æçæ¯ï¼mvccåéçå·ä½è¡ä¸ºåä½¿ç¨æ¹å¼å¨ä¸åçéç¦»çº§å«ä¸å¯è½ä¼ææä¸åãmysqlæä¾äºå¤ä¸ªéç¦»çº§å«ï¼å¦è¯»æªæäº¤ãè¯»å·²æäº¤ãå¯éå¤è¯»åä¸²è¡åï¼ï¼æ¯ä¸ªéç¦»çº§å«å¯¹äºmvccåéçä½¿ç¨æ¹å¼åç²åº¦å¯è½ä¼ææè°æ´ã\n\nï¼confuseï¼è¯»æä½é½ç¨mvccäºï¼é£å±äº«éç¨å¨åªå¢ï¼ï¼\n\n\n# åºååçéç¦»çº§å«æ¯æä¹å®ç°çï¼å çéæ¯ä»ä¹éï¼æ¯ä¸´é´éåï¼\n\nä¸ºäºå®ç°åºååéç¦»çº§å«ï¼mysqlä½¿ç¨äºä¸¤ç§ç±»åçéï¼ä¸´é®éï¼next-key locksï¼åé´ééï¼gap locksï¼ãï¼è¿éè¦é´ééåï¼ï¼\n\nä¸´é®éç¨äºä¿æ¤ç´¢å¼é®å¼åèå´ï¼é²æ­¢å¶ä»äºå¡å¯¹ç¸åçé®å¼èå´è¿è¡æå¥ãæ´æ°æå é¤æä½ãå½ä¸ä¸ªäºå¡è·åäºä¸´é®éæ¶ï¼å¶ä»äºå¡æ æ³å¯¹ç¸åçç´¢å¼é®å¼èå´è¿è¡ä¿®æ¹ï¼ä»èå®ç°äºä¸²è¡åçææã\n\né´ééç¨äºä¿æ¤ç´¢å¼é®å¼ä¹é´çé´éï¼å³ä¸å­å¨çé®å¼èå´ï¼ãå®é²æ­¢å¶ä»äºå¡å¨è¿ä¸ªé´éä¸­æå¥æ°çç´¢å¼é®å¼ï¼ä»èé¿åäºå¹»è¯»çé®é¢ã\n\n\n# innodb å¯éå¤è¯»éç¦»çº§å«ä¸è¿ä¼åçå¹»è¯»åï¼",charsets:{cjk:!0}},{title:"å°ç¥è¯",frontmatter:{title:"å°ç¥è¯",date:"2023-05-13T16:15:31.000Z",permalink:"/pages/7c006d/",article:!1},regularPath:"/temp/%E5%B0%8F%E7%9F%A5%E8%AF%86.html",relativePath:"temp/å°ç¥è¯.md",key:"v-5c5b6663",path:"/pages/7c006d/",headersStr:null,content:'java çéç½®æä»¶ï¼ä¸è¬é¤äºä½¿ç¨ xml, yaml, propertiesï¼è¿å¯ä»¥ä½¿ç¨ java class çæ¹å¼ãä¸è¬æ¡æ¶ä¼æä¾å¯¹åºçç±»è®©ä½ æ³¨å¥éç½®ã\n\nå¦ dubbo: ä¸é¢è¿ä¸ªéç½®ç±»classå°±ç­ä»·äºåå¨éç½®æä»¶ä¸­éç½® dubbo åæ°ã\n\n@Configuration\n@DubboComponentScan(basePackages = "com.alibaba.csp.sentinel.demo.service")\npublic class ProviderConfig {\n    @Bean\n    public ApplicationConfig applicationConfig() {\n        ApplicationConfig applicationConfig = new ApplicationConfig();\n        applicationConfig.setName("demo-provider");\n        return applicationConfig;\n    }\n\n    @Bean\n    public RegistryConfig registryConfig() {\n        RegistryConfig registryConfig = new RegistryConfig();\n        registryConfig.setAddress("multicast://224.5.6.7:1234");\n        return registryConfig;\n    }\n\n    @Bean\n    public ProtocolConfig protocolConfig() {\n        ProtocolConfig protocolConfig = new ProtocolConfig();\n        protocolConfig.setName("dubbo");\n        protocolConfig.setPort(25758);\n        return protocolConfig;\n    }\n}\n\n\ndubbo:\n  application:\n    name: demo-provider\n  protocol:\n    name: dubbo\n    port: 25758\n  registry:\n    address: multicast://224.5.6.7:1234\n',normalizedContent:'java çéç½®æä»¶ï¼ä¸è¬é¤äºä½¿ç¨ xml, yaml, propertiesï¼è¿å¯ä»¥ä½¿ç¨ java class çæ¹å¼ãä¸è¬æ¡æ¶ä¼æä¾å¯¹åºçç±»è®©ä½ æ³¨å¥éç½®ã\n\nå¦ dubbo: ä¸é¢è¿ä¸ªéç½®ç±»classå°±ç­ä»·äºåå¨éç½®æä»¶ä¸­éç½® dubbo åæ°ã\n\n@configuration\n@dubbocomponentscan(basepackages = "com.alibaba.csp.sentinel.demo.service")\npublic class providerconfig {\n    @bean\n    public applicationconfig applicationconfig() {\n        applicationconfig applicationconfig = new applicationconfig();\n        applicationconfig.setname("demo-provider");\n        return applicationconfig;\n    }\n\n    @bean\n    public registryconfig registryconfig() {\n        registryconfig registryconfig = new registryconfig();\n        registryconfig.setaddress("multicast://224.5.6.7:1234");\n        return registryconfig;\n    }\n\n    @bean\n    public protocolconfig protocolconfig() {\n        protocolconfig protocolconfig = new protocolconfig();\n        protocolconfig.setname("dubbo");\n        protocolconfig.setport(25758);\n        return protocolconfig;\n    }\n}\n\n\ndubbo:\n  application:\n    name: demo-provider\n  protocol:\n    name: dubbo\n    port: 25758\n  registry:\n    address: multicast://224.5.6.7:1234\n',charsets:{cjk:!0}},{title:"æ¥è¯­-promt",frontmatter:{title:"æ¥è¯­-promt",date:"2023-05-11T16:54:32.000Z",permalink:"/pages/fba198/",article:!1},regularPath:"/temp/%E6%97%A5%E8%AF%AD-promt.html",relativePath:"temp/æ¥è¯­-promt.md",key:"v-c4807e92",path:"/pages/fba198/",headersStr:null,content:"ä½ æ¯ä¸ä½ä¼ç§çæ¥è¯­èå¸ï¼æ¯å½æè¾å¥ä¸ä¸ªå¥å­ï¼ä½ éè¦å®æä»¥ä¸ä»»å¡ï¼\n\ntask1ï¼æåå¥å­ä¸­å­å¨çåè¯\n\nforeach task1'result\n\ntask1.1ï¼æ åºåè¯è¯æ§ãç½é©¬é³ãä¸­æéä¹ãè±æéä¹ãè¯æ ¹è¯ç¼èµ·æºæäºï¼å¦ææ¯å¨è¯çè¯ï¼æ åºåè¯çè¾ä¹¦åï¼ä»¥åå½åæ¯ä»ä¹å½¢æï¼ä¸è¡ä¸ä¸ª\n\ntask1.2ï¼ç¨è¿ä¸ªåè¯é ä¸ä¸ªå·¥ä½åºæ¯æ¥è¯­ä¾å¥éæ¥æç¿»è¯\n\nå°ä»¥ä¸task1ä»»å¡ç»ææä»¥ä¸Markdownæ ¼å¼æçå¾ªç¯è¾åºï¼\n\n### åè¯éä¹\n\n<task1.1 result>\n\n### åºæ¯ä¾å¥\n\n<task1.2 result>\n\nç¬¬ä¸ä¸ªå¥å­æ¯ï¼ç¡æµã®ç¬é¡ã§èããã¡ãã£ã¢",normalizedContent:"ä½ æ¯ä¸ä½ä¼ç§çæ¥è¯­èå¸ï¼æ¯å½æè¾å¥ä¸ä¸ªå¥å­ï¼ä½ éè¦å®æä»¥ä¸ä»»å¡ï¼\n\ntask1ï¼æåå¥å­ä¸­å­å¨çåè¯\n\nforeach task1'result\n\ntask1.1ï¼æ åºåè¯è¯æ§ãç½é©¬é³ãä¸­æéä¹ãè±æéä¹ãè¯æ ¹è¯ç¼èµ·æºæäºï¼å¦ææ¯å¨è¯çè¯ï¼æ åºåè¯çè¾ä¹¦åï¼ä»¥åå½åæ¯ä»ä¹å½¢æï¼ä¸è¡ä¸ä¸ª\n\ntask1.2ï¼ç¨è¿ä¸ªåè¯é ä¸ä¸ªå·¥ä½åºæ¯æ¥è¯­ä¾å¥éæ¥æç¿»è¯\n\nå°ä»¥ä¸task1ä»»å¡ç»ææä»¥ä¸markdownæ ¼å¼æçå¾ªç¯è¾åºï¼\n\n### åè¯éä¹\n\n<task1.1 result>\n\n### åºæ¯ä¾å¥\n\n<task1.2 result>\n\nç¬¬ä¸ä¸ªå¥å­æ¯ï¼ç¡æµã®ç¬é¡ã¦ãèããã¡ããã£ã¢",charsets:{cjk:!0}},{title:"Untitled",frontmatter:{title:"Untitled",date:"2023-04-16T14:14:25.000Z",permalink:"/pages/5da819/",article:!1},regularPath:"/temp/%E6%97%A5%E8%AF%AD%E5%8A%A8%E8%AF%8D.html",relativePath:"temp/æ¥è¯­å¨è¯.md",key:"v-3fb4f800",path:"/pages/5da819/",headers:[{level:2,title:"å¨è¯åç±»",slug:"å¨è¯åç±»",normalizedTitle:"å¨è¯åç±»",charIndex:2},{level:2,title:"äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯ï¼gptç­æ¡æå¾æ¹è¯ï¼",slug:"äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯-gptç­æ¡æå¾æ¹è¯",normalizedTitle:"äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯ï¼gptç­æ¡æå¾æ¹è¯ï¼",charIndex:301},{level:2,title:"å¨è¯ååè½¬ã¾ãå",slug:"å¨è¯ååè½¬ã¾ãå",normalizedTitle:"å¨è¯ååè½¬ã¾ãå",charIndex:679}],headersStr:"å¨è¯åç±» äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯ï¼gptç­æ¡æå¾æ¹è¯ï¼ å¨è¯ååè½¬ã¾ãå",content:"# å¨è¯åç±»\n\n * ä¸ç±»å¨è¯ï¼äºæ®µå¨è¯ï¼ï¼\n\nè¯å¹²+uæ®µè¯å°¾ï¼ä»¥ãããç»å°¾ï¼ãããåååä¸å¨ãããæ®µæãããæ®µä»¥åææä¸æ¯ä»¥ãããç»å°¾çå¨è¯ã\n\næä¸äºç¹æ®çäºæ®µå¨è¯ï¼å½¢æä¸å±äºä¸æ®µå¨è¯ï¼ä½å®éçè¯å½¢ååæ¯æç§äºæ®µå¨è¯ååè§å¾è¿è¡çï¼å¦ï¼ãå¸°ï¼ããï¼ããããè¦ï¼ãï¼ããããåï¼ãï¼ããããå¥ï¼ã¯ãï¼ããããèµ°ï¼ã¯ãï¼ããç­ã\n\n * äºç±»å¨è¯ï¼ä¸æ®µå¨è¯ï¼ï¼\n\nè¯å¹²+iru/eruï¼ä»¥ãããç»å°¾ï¼ãããåååå¨ãããæ®µæãããæ®µçå¨è¯ã\n\næåå ä¸ªç¹æ®çï¼å¶è¯å¹²è¯å°¾æ¯ä¸ä½çï¼å¶å®æ¯äºæ®µå¨è¯ã\n\n * ä¸ç±»å¨è¯ï¼ãµãã«åå¨è¯ï¼ï¼\n\nãµåï¼ããä»¥åä»¥ããããç»å°¾çå¨è¯ã\n\nã«åï¼æ¥ï¼ãï¼ã\n\n\n# äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯ï¼gptç­æ¡æå¾æ¹è¯ï¼\n\näºæ®µå¨è¯çè¯å¹²ä»¥äºç§ä¸åçè¾é³ç»å°¾ï¼k/g/s/t/nï¼ï¼å¦âé£²ã (nomu)âãâæ³³ã (oyogu)âãâæ¸ã (kaku)âãâæ­»ã¬ (shinu)âãâè©±ã (hanasu)âç­ã\n\nè¿äºå¨è¯å¨åå½¢æ¶ï¼æ ¹æ®å¶è¯å¹²çä¸åè¾é³ï¼éç¨ä¸åçåå½¢è§åï¼åå½¢å½¢å¼ç¸å¯¹è¾å¤ï¼ä½ä¹æ´å è§å¾åãä¾å¦ï¼å¨äºæ®µå¨è¯ä¸­ï¼ç°å¨æ¶çè¯å¹²æ¯å¨è¯è¯å¹²çæåä¸ä¸ªé³èï¼å ä¸ç¸åºçåç¼å³å¯ï¼å¦âæ¸ãâåä¸ºâæ¸ãã¾ãï¼kakimasuï¼âãâæ³³ãâåä¸ºâæ³³ãã¾ãï¼oyogimasuï¼âã\n\nä¸æ®µå¨è¯çè¯å¹²ä»¥è¾é³ç»å°¾ï¼æ¯å¦âé£ã¹ã (taberu)âãâè¦ã (miru)âãâå¯ã (neru)âç­ãè¿äºå¨è¯çåå½¢æ¯è¾ç®åï¼åªéå°è¯å¹²åé¢çâãâå»æï¼åå ä¸ç¸åºçåç¼å³å¯ï¼ä¾å¦åä¸ºå¦å®å½¢å¼æ¶å ä¸âãªãâï¼naiï¼å³å¯ã\n\n\n# å¨è¯ååè½¬ã¾ãå\n\nä¸ãäºãä¸ç±»å¨è¯ååè½¬æ¢ä¸ºã¾ãåçåå½¢è§åï¼\n\nç±»å     ååï¼è¾ä¹¦åï¼    åå½¢è§å                   ã¾ãå\nä¸ç±»å¨è¯   æ¸ãï¼ããï¼     å°è¯å°¾çãæ®µåä¸ºãæ®µï¼ç¶åå ä¸â-ã¾ãâ   æ¸ãã¾ã\näºç±»å¨è¯   é£ã¹ãï¼ãã¹ãï¼   å»ãå ä¸â-ã¾ãâ              é£ã¹ã¾ã\nä¸ç±»å¨è¯   ãã         å°âããâåä¸ºâãã¾ãâ           ãã¾ã\nä¸ç±»å¨è¯   ï¼æ¥ãï¼ãã     å°ããåãã¾ã                æ¥ã¾ã",normalizedContent:"# å¨è¯åç±»\n\n * ä¸ç±»å¨è¯ï¼äºæ®µå¨è¯ï¼ï¼\n\nè¯å¹²+uæ®µè¯å°¾ï¼ä»¥ãããç»å°¾ï¼ãããåååä¸å¨ãããæ®µæãããæ®µä»¥åææä¸æ¯ä»¥ãããç»å°¾çå¨è¯ã\n\næä¸äºç¹æ®çäºæ®µå¨è¯ï¼å½¢æä¸å±äºä¸æ®µå¨è¯ï¼ä½å®éçè¯å½¢ååæ¯æç§äºæ®µå¨è¯ååè§å¾è¿è¡çï¼å¦ï¼ãå¸°ï¼ããï¼ããããè¦ï¼ãï¼ããããåï¼ãï¼ããããå¥ï¼ã¯ãï¼ããããèµ°ï¼ã¯ãï¼ããç­ã\n\n * äºç±»å¨è¯ï¼ä¸æ®µå¨è¯ï¼ï¼\n\nè¯å¹²+iru/eruï¼ä»¥ãããç»å°¾ï¼ãããåååå¨ãããæ®µæãããæ®µçå¨è¯ã\n\næåå ä¸ªç¹æ®çï¼å¶è¯å¹²è¯å°¾æ¯ä¸ä½çï¼å¶å®æ¯äºæ®µå¨è¯ã\n\n * ä¸ç±»å¨è¯ï¼ãµãã«åå¨è¯ï¼ï¼\n\nãµåï¼ããä»¥åä»¥ããããç»å°¾çå¨è¯ã\n\nã«åï¼æ¥ï¼ãï¼ã\n\n\n# äºæ®µå¨è¯åä¸æ®µå¨è¯çå¯¹æ¯ï¼gptç­æ¡æå¾æ¹è¯ï¼\n\näºæ®µå¨è¯çè¯å¹²ä»¥äºç§ä¸åçè¾é³ç»å°¾ï¼k/g/s/t/nï¼ï¼å¦âé£²ã (nomu)âãâæ³³ãã (oyogu)âãâæ¸ã (kaku)âãâæ­»ã¬ (shinu)âãâè©±ã (hanasu)âç­ã\n\nè¿äºå¨è¯å¨åå½¢æ¶ï¼æ ¹æ®å¶è¯å¹²çä¸åè¾é³ï¼éç¨ä¸åçåå½¢è§åï¼åå½¢å½¢å¼ç¸å¯¹è¾å¤ï¼ä½ä¹æ´å è§å¾åãä¾å¦ï¼å¨äºæ®µå¨è¯ä¸­ï¼ç°å¨æ¶çè¯å¹²æ¯å¨è¯è¯å¹²çæåä¸ä¸ªé³èï¼å ä¸ç¸åºçåç¼å³å¯ï¼å¦âæ¸ãâåä¸ºâæ¸ãã¾ãï¼kakimasuï¼âãâæ³³ããâåä¸ºâæ³³ããã¾ãï¼oyogimasuï¼âã\n\nä¸æ®µå¨è¯çè¯å¹²ä»¥è¾é³ç»å°¾ï¼æ¯å¦âé£ã¸ãã (taberu)âãâè¦ã (miru)âãâå¯ã (neru)âç­ãè¿äºå¨è¯çåå½¢æ¯è¾ç®åï¼åªéå°è¯å¹²åé¢çâãâå»æï¼åå ä¸ç¸åºçåç¼å³å¯ï¼ä¾å¦åä¸ºå¦å®å½¢å¼æ¶å ä¸âãªãâï¼naiï¼å³å¯ã\n\n\n# å¨è¯ååè½¬ã¾ãå\n\nä¸ãäºãä¸ç±»å¨è¯ååè½¬æ¢ä¸ºã¾ãåçåå½¢è§åï¼\n\nç±»å     ååï¼è¾ä¹¦åï¼    åå½¢è§å                   ã¾ãå\nä¸ç±»å¨è¯   æ¸ãï¼ããï¼     å°è¯å°¾çãæ®µåä¸ºãæ®µï¼ç¶åå ä¸â-ã¾ãâ   æ¸ãã¾ã\näºç±»å¨è¯   é£ã¸ããï¼ãã¸ããï¼   å»ãå ä¸â-ã¾ãâ              é£ã¸ãã¾ã\nä¸ç±»å¨è¯   ãã         å°âããâåä¸ºâãã¾ãâ           ãã¾ã\nä¸ç±»å¨è¯   ï¼æ¥ãï¼ãã     å°ããåãã¾ã                æ¥ã¾ã",charsets:{cjk:!0}},{title:"éç¾¤ååå¸å¼",frontmatter:{title:"éç¾¤ååå¸å¼",date:"2023-05-08T20:44:52.000Z",permalink:"/pages/263c98/",article:!1},regularPath:"/temp/%E9%9B%86%E7%BE%A4%E5%92%8C%E5%88%86%E5%B8%83%E5%BC%8F.html",relativePath:"temp/éç¾¤ååå¸å¼.md",key:"v-dbde7360",path:"/pages/263c98/",headersStr:null,content:"https://developer.aliyun.com/article/44562\n\nåå¸å¼æ¯æå°ä¸åçä¸å¡åå¸å¨ä¸åçå°æ¹ï¼èéç¾¤æçæ¯å°å å°æå¡å¨éä¸­å¨ä¸èµ·ï¼å®ç°åä¸ä¸å¡ã\n\nåå¸å¼ä¸­çæ¯ä¸ä¸ªèç¹ï¼é½å¯ä»¥åéç¾¤ã èéç¾¤å¹¶ä¸ä¸å®å°±æ¯åå¸å¼çã\n\nç®åè¯´ï¼åå¸å¼æ¯ä»¥ç¼©ç­åä¸ªä»»å¡çæ§è¡æ¶é´æ¥æåæççï¼èéç¾¤åæ¯éè¿æé«åä½æ¶é´åæ§è¡çä»»å¡æ°æ¥æåæçã\n\nä¾å¦ï¼å¦æä¸ä¸ªä»»å¡ç±10ä¸ªå­ä»»å¡ç»æï¼æ¯ä¸ªå­ä»»å¡åç¬æ§è¡é1å°æ¶ï¼åå¨ä¸å°æå¡å¨ä¸æ§è¡æ¹ä»»å¡é10å°æ¶ã\n\néç¨åå¸å¼æ¹æ¡ï¼æä¾10å°æå¡å¨ï¼æ¯å°æå¡å¨åªè´è´£å¤çä¸ä¸ªå­ä»»å¡ï¼ä¸èèå­ä»»å¡é´çä¾èµå³ç³»ï¼æ§è¡å®è¿ä¸ªä»»å¡åªéä¸ä¸ªå°æ¶ã(è¿ç§å·¥ä½æ¨¡å¼çä¸ä¸ªå¸åä»£è¡¨å°±æ¯HadoopçMap/Reduceåå¸å¼è®¡ç®æ¨¡åï¼\n\nèéç¨éç¾¤æ¹æ¡ï¼åæ ·æä¾10å°æå¡å¨ï¼æ¯å°æå¡å¨é½è½ç¬ç«å¤çè¿ä¸ªä»»å¡ãåè®¾æ10ä¸ªä»»å¡åæ¶å°è¾¾ï¼10ä¸ªæå¡å¨å°åæ¶å·¥ä½ï¼10å°åï¼10ä¸ªä»»å¡åæ¶å®æï¼è¿æ ·ï¼æ´èº«æ¥çï¼è¿æ¯1å°æ¶åå®æä¸ä¸ªä»»å¡ï¼\n\nredis sentinel ç®åå¸å¼åï¼\n\nRedis Sentinelå¹¶ä¸æ¯ä¸ä¸ªä¸¥æ ¼æä¹ä¸çåå¸å¼ç³»ç»ï¼èæ¯Redisæä¾çä¸ä¸ªé«å¯ç¨æ§è§£å³æ¹æ¡ãRedis Sentineléè¿è¿è¡å¤ä¸ªRediså®ä¾æ¥æä¾æéè½¬ç§»åèªå¨æéæ¢å¤åè½ï¼ä½¿Rediså¨åçä¸»èç¹æéæ¶è½å¤èªå¨åæ¢å°å¤ç¨èç¹ã\n\nå¨Redis Sentinelä¸­ï¼ä¸ä¸ªä¸»èç¹å¯ä»¥æå¤ä¸ªå¤ç¨èç¹ï¼æ¯ä¸ªå¤ç¨èç¹é½å¯ä»¥èªå¨æ¥ç®¡ä¸»èç¹çå·¥ä½ãå½ä¸»èç¹åçæéæ¶ï¼Redis Sentinelä¼èªå¨ä»å¤ç¨èç¹ä¸­éä¸¾ä¸ä¸ªæ°çä¸»èç¹ï¼å¹¶å°æ°çä¸»èç¹ä¿¡æ¯å¹¿æ­ç»ææå®¢æ·ç«¯ãè¿æ ·ï¼å®¢æ·ç«¯å°±å¯ä»¥æ æç¥å°ç»§ç»­ä½¿ç¨Redisæå¡ï¼èæ éæå¨åæ¢ä¸»èç¹ã\n\nè½ç¶Redis Sentinelæ¬èº«ä¸æ¯ä¸ä¸ªåå¸å¼ç³»ç»ï¼ä½å®å¯ä»¥éè¿è¿è¡å¤ä¸ªRediså®ä¾æ¥æé«Redisæå¡çå¯ç¨æ§åå®¹éè½åï¼ä½¿å¾Rediséç¾¤æ´å å¥å£®åå¯é ãå æ­¤ï¼å¨æäºåºæ¯ä¸ï¼Redis Sentinelä¹å¯ä»¥è¢«çä½æ¯ä¸ç§åå¸å¼è§£å³æ¹æ¡ã",normalizedContent:"https://developer.aliyun.com/article/44562\n\nåå¸å¼æ¯æå°ä¸åçä¸å¡åå¸å¨ä¸åçå°æ¹ï¼èéç¾¤æçæ¯å°å å°æå¡å¨éä¸­å¨ä¸èµ·ï¼å®ç°åä¸ä¸å¡ã\n\nåå¸å¼ä¸­çæ¯ä¸ä¸ªèç¹ï¼é½å¯ä»¥åéç¾¤ã èéç¾¤å¹¶ä¸ä¸å®å°±æ¯åå¸å¼çã\n\nç®åè¯´ï¼åå¸å¼æ¯ä»¥ç¼©ç­åä¸ªä»»å¡çæ§è¡æ¶é´æ¥æåæççï¼èéç¾¤åæ¯éè¿æé«åä½æ¶é´åæ§è¡çä»»å¡æ°æ¥æåæçã\n\nä¾å¦ï¼å¦æä¸ä¸ªä»»å¡ç±10ä¸ªå­ä»»å¡ç»æï¼æ¯ä¸ªå­ä»»å¡åç¬æ§è¡é1å°æ¶ï¼åå¨ä¸å°æå¡å¨ä¸æ§è¡æ¹ä»»å¡é10å°æ¶ã\n\néç¨åå¸å¼æ¹æ¡ï¼æä¾10å°æå¡å¨ï¼æ¯å°æå¡å¨åªè´è´£å¤çä¸ä¸ªå­ä»»å¡ï¼ä¸èèå­ä»»å¡é´çä¾èµå³ç³»ï¼æ§è¡å®è¿ä¸ªä»»å¡åªéä¸ä¸ªå°æ¶ã(è¿ç§å·¥ä½æ¨¡å¼çä¸ä¸ªå¸åä»£è¡¨å°±æ¯hadoopçmap/reduceåå¸å¼è®¡ç®æ¨¡åï¼\n\nèéç¨éç¾¤æ¹æ¡ï¼åæ ·æä¾10å°æå¡å¨ï¼æ¯å°æå¡å¨é½è½ç¬ç«å¤çè¿ä¸ªä»»å¡ãåè®¾æ10ä¸ªä»»å¡åæ¶å°è¾¾ï¼10ä¸ªæå¡å¨å°åæ¶å·¥ä½ï¼10å°åï¼10ä¸ªä»»å¡åæ¶å®æï¼è¿æ ·ï¼æ´èº«æ¥çï¼è¿æ¯1å°æ¶åå®æä¸ä¸ªä»»å¡ï¼\n\nredis sentinel ç®åå¸å¼åï¼\n\nredis sentinelå¹¶ä¸æ¯ä¸ä¸ªä¸¥æ ¼æä¹ä¸çåå¸å¼ç³»ç»ï¼èæ¯redisæä¾çä¸ä¸ªé«å¯ç¨æ§è§£å³æ¹æ¡ãredis sentineléè¿è¿è¡å¤ä¸ªrediså®ä¾æ¥æä¾æéè½¬ç§»åèªå¨æéæ¢å¤åè½ï¼ä½¿rediså¨åçä¸»èç¹æéæ¶è½å¤èªå¨åæ¢å°å¤ç¨èç¹ã\n\nå¨redis sentinelä¸­ï¼ä¸ä¸ªä¸»èç¹å¯ä»¥æå¤ä¸ªå¤ç¨èç¹ï¼æ¯ä¸ªå¤ç¨èç¹é½å¯ä»¥èªå¨æ¥ç®¡ä¸»èç¹çå·¥ä½ãå½ä¸»èç¹åçæéæ¶ï¼redis sentinelä¼èªå¨ä»å¤ç¨èç¹ä¸­éä¸¾ä¸ä¸ªæ°çä¸»èç¹ï¼å¹¶å°æ°çä¸»èç¹ä¿¡æ¯å¹¿æ­ç»ææå®¢æ·ç«¯ãè¿æ ·ï¼å®¢æ·ç«¯å°±å¯ä»¥æ æç¥å°ç»§ç»­ä½¿ç¨redisæå¡ï¼èæ éæå¨åæ¢ä¸»èç¹ã\n\nè½ç¶redis sentinelæ¬èº«ä¸æ¯ä¸ä¸ªåå¸å¼ç³»ç»ï¼ä½å®å¯ä»¥éè¿è¿è¡å¤ä¸ªrediså®ä¾æ¥æé«redisæå¡çå¯ç¨æ§åå®¹éè½åï¼ä½¿å¾rediséç¾¤æ´å å¥å£®åå¯é ãå æ­¤ï¼å¨æäºåºæ¯ä¸ï¼redis sentinelä¹å¯ä»¥è¢«çä½æ¯ä¸ç§åå¸å¼è§£å³æ¹æ¡ã",charsets:{cjk:!0}},{title:"å½æ¡£",frontmatter:{archivesPage:!0,title:"å½æ¡£",permalink:"/archives/",article:!1},regularPath:"/@pages/archivesPage.html",relativePath:"@pages/archivesPage.md",key:"v-61301819",path:"/archives/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2023/03/17, 19:41:31",lastUpdatedTimestamp:1679053291e3},{title:"Home",frontmatter:{home:!0,heroImage:"/img/logo.gif",heroText:"Boundless Wiki",tagline:"ç¥è¯ç®¡ç",actionText:"æ»è§ â",actionLink:"/pages/home/",bannerBg:"none",features:null,postList:"detailed"},regularPath:"/",relativePath:"index.md",key:"v-262c459c",path:"/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3},{title:"ç¥è¯ä½ç³»æ»è§",frontmatter:{title:"ç¥è¯ä½ç³»æ»è§",date:"2023-03-16T23:01:35.000Z",permalink:"/pages/home/"},regularPath:"/%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%80%BB%E8%A7%88.html",relativePath:"ç¥è¯ä½ç³»æ»è§.md",key:"v-36ff78c4",path:"/pages/home/",headers:[{level:2,title:"Java",slug:"java",normalizedTitle:"java",charIndex:2},{level:2,title:"Javaæ¡æ¶",slug:"javaæ¡æ¶",normalizedTitle:"javaæ¡æ¶",charIndex:544},{level:2,title:"MySQL",slug:"mysql",normalizedTitle:"mysql",charIndex:722},{level:2,title:"Redis",slug:"redis",normalizedTitle:"redis",charIndex:759},{level:2,title:"ä¸­é´ä»¶",slug:"ä¸­é´ä»¶",normalizedTitle:"ä¸­é´ä»¶",charIndex:922},{level:2,title:"è®¡ç®æºç½ç»",slug:"è®¡ç®æºç½ç»",normalizedTitle:"è®¡ç®æºç½ç»",charIndex:1007},{level:2,title:"è®¡ç®æºç»æåç",slug:"è®¡ç®æºç»æåç",normalizedTitle:"è®¡ç®æºç»æåç",charIndex:1049},{level:2,title:"å·¥å·",slug:"å·¥å·",normalizedTitle:"å·¥å·",charIndex:1061},{level:2,title:"Linux",slug:"linux",normalizedTitle:"linux",charIndex:1107},{level:2,title:"æ¶æè®¾è®¡",slug:"æ¶æè®¾è®¡",normalizedTitle:"æ¶æè®¾è®¡",charIndex:1117},{level:2,title:"åå¸å¼",slug:"åå¸å¼",normalizedTitle:"åå¸å¼",charIndex:1126},{level:2,title:"åç«¯",slug:"åç«¯",normalizedTitle:"åç«¯",charIndex:1134},{level:2,title:"å¤§æ°æ®",slug:"å¤§æ°æ®",normalizedTitle:"å¤§æ°æ®",charIndex:1172}],headersStr:"Java Javaæ¡æ¶ MySQL Redis ä¸­é´ä»¶ è®¡ç®æºç½ç» è®¡ç®æºç»æåç å·¥å· Linux æ¶æè®¾è®¡ åå¸å¼ åç«¯ å¤§æ°æ®",content:"# Java\n\n * Javaåºç¡\n * Javaéå\n   * ArrayList\n   * HashMap\n * JVM\n   * Javaåå­æ¨¡å\n   * ç±»å è½½æºå¶\n   * JVMåå¾åæ¶\n   * Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºåï¼\n   * èææºå¯¹è±¡\n   * OutOfMemoryError\n   * å­èç å¢å¼ºææ¯\n * Java å¹¶å\n   * synchronized å volatile\n   * ReentrantLock\n   * ReentrantReadWriteLock\n   * AQS\n   * ThreadLocal\n   * ThreadPoolExecutor\n   * Semaphore\n   * CountDownLatch\n   * CyclicBarrier\n   * Atomic\n   * å¹¶åå®¹å¨ï¼\n     * ConcurrentHashMapï¼HashMap\n     * CopyOnWriteArrayListï¼List\n     * BlockingQueue\n     * ConcurrentSkipListMap\n     * ConcurrentLinkedQueueï¼LinkedList\n\n\n# Javaæ¡æ¶\n\n * Spring\n * Spring MVC\n * Spring Boot\n * Mybatis\n * Spring Cloud\n   * nacos\n   * eruka\n   * spring cloud sentinel\n   * spring cloud gateway\n   * spring cloud config\n\n\n# MySQL\n\n * ç´¢å¼\n * ä¼å\n * äºå¡\n * ååºåè¡¨\n\n\n# Redis\n\n * Redisæ°æ®ç±»å\n\n * Redisæ°æ®ç»æ\n\n * Redis æä¹å\n\n * Redisé«å¯ç¨\n   \n   * ä¸»ä»\n   \n   * sentinel\n   \n   * redis cluster\n\n * Rediså é¤ç­ç¥ååå­æ·æ±°æºå¶\n\n * ç¼å­åºæ¯é®é¢\n\n * Redisåºæ¯é¢\n\n\n# ä¸­é´ä»¶\n\n * rocketmq\n\n * dubbo\n\n * zookeeper\n\n * MongoDB\n\n * kafka\n\n * ElasticSearch\n\n\n# è®¡ç®æºç½ç»\n\n * HTTP\n\n * TCP\n\n * IP\n\n * DNS\n\n\n# è®¡ç®æºç»æåç\n\n\n# å·¥å·\n\n * maven\n\n * git\n\n * nginx\n\n * docker\n\n\n# Linux\n\n\n# æ¶æè®¾è®¡\n\n\n# åå¸å¼\n\n\n# åç«¯\n\n * javaScript\n * react\n * vue\n\n\n# å¤§æ°æ®\n\n * haddop\n * hdfs\n * mapReduce\n * spark\n * hive\n * clickHouse",normalizedContent:"# java\n\n * javaåºç¡\n * javaéå\n   * arraylist\n   * hashmap\n * jvm\n   * javaåå­æ¨¡å\n   * ç±»å è½½æºå¶\n   * jvmåå¾åæ¶\n   * javaåå­åºåï¼è¿è¡æ¶æ°æ®åºåï¼\n   * èææºå¯¹è±¡\n   * outofmemoryerror\n   * å­èç å¢å¼ºææ¯\n * java å¹¶å\n   * synchronized å volatile\n   * reentrantlock\n   * reentrantreadwritelock\n   * aqs\n   * threadlocal\n   * threadpoolexecutor\n   * semaphore\n   * countdownlatch\n   * cyclicbarrier\n   * atomic\n   * å¹¶åå®¹å¨ï¼\n     * concurrenthashmapï¼hashmap\n     * copyonwritearraylistï¼list\n     * blockingqueue\n     * concurrentskiplistmap\n     * concurrentlinkedqueueï¼linkedlist\n\n\n# javaæ¡æ¶\n\n * spring\n * spring mvc\n * spring boot\n * mybatis\n * spring cloud\n   * nacos\n   * eruka\n   * spring cloud sentinel\n   * spring cloud gateway\n   * spring cloud config\n\n\n# mysql\n\n * ç´¢å¼\n * ä¼å\n * äºå¡\n * ååºåè¡¨\n\n\n# redis\n\n * redisæ°æ®ç±»å\n\n * redisæ°æ®ç»æ\n\n * redis æä¹å\n\n * redisé«å¯ç¨\n   \n   * ä¸»ä»\n   \n   * sentinel\n   \n   * redis cluster\n\n * rediså é¤ç­ç¥ååå­æ·æ±°æºå¶\n\n * ç¼å­åºæ¯é®é¢\n\n * redisåºæ¯é¢\n\n\n# ä¸­é´ä»¶\n\n * rocketmq\n\n * dubbo\n\n * zookeeper\n\n * mongodb\n\n * kafka\n\n * elasticsearch\n\n\n# è®¡ç®æºç½ç»\n\n * http\n\n * tcp\n\n * ip\n\n * dns\n\n\n# è®¡ç®æºç»æåç\n\n\n# å·¥å·\n\n * maven\n\n * git\n\n * nginx\n\n * docker\n\n\n# linux\n\n\n# æ¶æè®¾è®¡\n\n\n# åå¸å¼\n\n\n# åç«¯\n\n * javascript\n * react\n * vue\n\n\n# å¤§æ°æ®\n\n * haddop\n * hdfs\n * mapreduce\n * spark\n * hive\n * clickhouse",charsets:{cjk:!0},lastUpdated:"2023/03/29, 21:03:43",lastUpdatedTimestamp:1680095023e3}],themeConfig:{nav:[{text:"é¦é¡µ",link:"/"},{text:"ç¥è¯ä½ç³»æ»è§",link:"/pages/home/"},{text:"Java",link:"/pages/java/",items:[{text:"Java åºç¡",link:"/pages/java/"},{text:"Java éå",link:"/pages/collection/"},{text:"Java èææº",link:"/pages/jvm/"},{text:"Java å¹¶å",link:"/pages/concurrent/"},{text:"Javaæ¡æ¶",link:"/pages/spring/",items:[{text:"Spring",link:"/pages/spring/"},{text:"Spring MVC",link:"/pages/springmvc/"},{text:"Spring Boot",link:"/pages/springboot/"},{text:"MyBatis",link:"/pages/mybatis/"}]}]},{text:"MySQL",link:"/pages/mysql/"},{text:"Redis",link:"/pages/redis/"},{text:"è®¡ç®æºåºç¡",items:[{text:"è®¡ç®æºç½ç»",link:"/pages/network/"},{text:"æä½ç³»ç»",link:"/pages/os/"}]},{text:"åç«¯",items:[{text:"React",link:"/pages/redux/"}]},{text:"ä¸­é´ä»¶",link:"/pages/mq/"},{text:"æ¹æ¡",link:"/pages/jwt/"},{text:"å·¥å·",items:[{text:"Git",link:"/pages/git/"},{text:"Linux",link:"/pages/linux/"},{text:"Docker",link:"/pages/docker/"}]},{text:"AI",link:"/pages/aitools/",items:[{text:"AI tools",link:"/pages/aitools/"}]},{text:"å½æ¡£",link:"/archives/"}],sidebarDepth:2,logo:"/img/logo.gif",repo:"egoistsh",searchMaxSuggestions:10,lastUpdated:"ä¸æ¬¡æ´æ°",sidebar:{"/01.Java/":[{title:"Javaåºç¡",collapsable:!1,children:[["01.Javaåºç¡/01.Javaæ±æ».md","Java æ±æ»","/pages/java/"],["01.Javaåºç¡/02.æ¥å£åæ½è±¡ç±»çåºå«.md","æ¥å£åæ½è±¡ç±»çåºå«","/pages/2ed256/"],["01.Javaåºç¡/03.åå°ç¸å³.md","åå°ç¸å³","/pages/66f85c/"],["01.Javaåºç¡/100.è¯­æ³è®°å½.md","è¯­æ³è®°å½","/pages/d95f75/"]]},{title:"Javaéå",collapsable:!1,children:[["02.Javaéå/01.ArrayList.md","ArrayList","/pages/collection/"],["02.Javaéå/02.HashMap.md","HashMap","/pages/d249ac/"],["02.Javaéå/03. BlockingQueue.md","BlockingQueue","/pages/86b6a3/"],["02.Javaéå/04.LinkedListåArrayDeque.md","LinkedListåArrayDeque","/pages/cbcb60/"]]},{title:"JVM",collapsable:!1,children:[["03.JVM/01.Javaåå­æ¨¡å.md","Javaåå­æ¨¡å","/pages/jvm/"],["03.JVM/02.ç±»å è½½æºå¶.md","ç±»å è½½æºå¶","/pages/7d816e/"],["03.JVM/03.JVMåå¾åæ¶.md","JVMåå¾åæ¶","/pages/a934e8/"],["03.JVM/04.Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼.md","Javaåå­åºåï¼è¿è¡æ¶æ°æ®åºï¼","/pages/8ffeca/"],["03.JVM/05.èææºå¯¹è±¡.md","èææºå¯¹è±¡","/pages/376408/"],["03.JVM/06.OutOfMemoryError.md","OutOfMemoryError","/pages/9a5ae7/"],["03.JVM/07.å¦ä½å¿«éææ¥é®é¢.md","å¦ä½å¿«éææ¥é®é¢","/pages/1a4e69/"],["03.JVM/08.JITéé¸åæ.md","JITéé¸åæ","/pages/1ee611/"],["03.JVM/100.å­èç å¢å¼ºææ¯.md","å­èç å¢å¼ºææ¯","/pages/9a3179/"],["03.JVM/101.ãæ·±å¥çè§£Javaèææºã.md","ãæ·±å¥çè§£Javaèææº-ç¬¬ä¸çã","/pages/9cc971/"]]},{title:"Javaå¹¶å",collapsable:!1,children:[["04.Javaå¹¶å/01.synchronizedåvolatile.md","synchronizedåvolatile","/pages/concurrent/"],["04.Javaå¹¶å/02.TreadLocal.md","ThreadLocal","/pages/41602c/"],["04.Javaå¹¶å/03.ReentrantLock.md","ReentranLock","/pages/d1bd01/"],["04.Javaå¹¶å/04.ConcurrentHashMap.md","ConcurrentHashMap","/pages/019d22/"],["04.Javaå¹¶å/05.ThreadPoolExecutor.md","ThreadPoolExecutor","/pages/854033/"],["04.Javaå¹¶å/06.Future & CompletableFuture.md","Future & CompletableFuture","/pages/9862ed/"],["04.Javaå¹¶å/07.ä»çº¿ç¨å°Javaçéæºå¶.md","ä»çº¿ç¨å°Javaçéæºå¶","/pages/646254/"],["04.Javaå¹¶å/08.CopyOnWriteArrayList.md","CopyOnWriteArrayList","/pages/9c98d8/"],["04.Javaå¹¶å/10.CountDownLatch.md","CountDownLatch","/pages/7c31b2/"],["04.Javaå¹¶å/11. CyclicBarrier.md","CyclicBarrier","/pages/fa1dea/"],["04.Javaå¹¶å/12.AQS.md","AQS","/pages/109178/"],["04.Javaå¹¶å/99.å¦ä½å®ç° ReentrantLockï¼.md","å¦ä½å®ç° ReentrantLockï¼","/pages/3c96b3/"],["04.Javaå¹¶å/100.å¹¶åç¼ç¨.md","å¹¶åç¼ç¨","/pages/d5fcba/"]]}],catalogue:{},"/02.MySQL/":[["00.MySQL.md","MySQL","/pages/mysql/"],["01.MySQLå­å¨å¼æ.md","MySQLå­å¨å¼æ","/pages/26cff4/"],["02.ç´¢å¼.md","ç´¢å¼","/pages/7ece7e/"],["03.äºå¡.md","äºå¡","/pages/e88566/"],["04.MySQLä¸­çlog.md","MySQLä¸­çlog","/pages/1d1ed2/"],["05.MVCCè§£å³å¹»è¯»é®é¢.md","MVCCè§£å³å¹»è¯»é®é¢","/pages/43cd7b/"],["06.æ°æ®åºä¸èå¼.md","æ°æ®åºä¸èå¼","/pages/9ed061/"],["07.MySQLæ°æ®ç±»å.md","Untitled","/pages/a4281a/"],["08.èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢.md","èå´æ¥è¯¢å¯¼è´ç´¢å¼å¤±æé®é¢","/pages/c10308/"],["09.Explainåæ.md","Explainåæ","/pages/b85e9d/"],["10.MySQLä¸­çé.md","MySQLä¸­çé","/pages/92d4ca/"],["99.MySQLå®æ45è®².md","MySQLå®æ45è®²","/pages/4f8fa0/"],["100.SQLè®°å½.md","SQLè®°å½","/pages/1b8a9e/"]],"/03.Redis/":[["01.redisæ».md","Redisæ»","/pages/redis/"],["02.redisæ°æ®ç±»å.md","Redisæ°æ®ç±»å","/pages/99d0e1/"],["03.rediså½ä»¤.md","Rediså½ä»¤","/pages/f706e8/"],["04.redisæ°æ®ç»æ.md","Redisæ°æ®ç»æ","/pages/d7a25d/"],["05.redisæä¹å.md","redisæä¹å","/pages/bc6be1/"],["06.redisé«å¯ç¨.md","Redisé«å¯ç¨","/pages/effbd9/"],["07.rediså é¤ç­ç¥ååå­æ·æ±°æºå¶.md","Rediså é¤ç­ç¥ååå­æ·æ±°æºå¶","/pages/428106/"],["08.ç¼å­å¸¸è§é®é¢.md","ç¼å­å¸¸è§é®é¢","/pages/87b330/"],["09.redisåºæ¯é¢.md","Redisåºæ¯é¢","/pages/c8420f/"],["10.redisåå¸å¼é.md","Redisåå¸å¼é","/pages/5f810a/"],["11.redisçrehash.md","redisçrehash","/pages/fafd87/"]],"/04.è®¡ç®æºç½ç»/":[{title:"åºç¡",collapsable:!1,children:[["01.åºç¡/01.ç½ç»åè®®åå±.md","ç½ç»åè®®åå±","/pages/network/"],["01.åºç¡/02.æµè§å¨å­å¨.md","æµè§å¨å­å¨","/pages/f1d55e/"],["01.åºç¡/03.ç½ç»æ»å».md","ç½ç»æ»å»","/pages/9ce3d9/"]]},{title:"åºç¨å±",collapsable:!1,children:[["02.åºç¨å±/01.httpçæ¬å¯¹æ¯.md","HTTPçæ¬å¯¹æ¯","/pages/e1cd04/"],["02.åºç¨å±/02.http.md","HTTP","/pages/f502d9/"],["02.åºç¨å±/03.https.md","HTTPS","/pages/43e2c1/"],["02.åºç¨å±/04.dns.md","DNS","/pages/524e17/"]]},{title:"ä¼ è¾å±",collapsable:!1,children:[["03.ä¼ è¾å±/01.tcp.md","TCP","/pages/5e312c/"]]},{title:"ç½ç»å±",collapsable:!1,children:[["04.ç½ç»å±/01.IP.md","IP","/pages/42791d/"]]}],"/05.æä½ç³»ç»/":[["01.æä½ç³»ç».md","æä½ç³»ç»","/pages/os/"],["02.Ctrl+Cåçäºä»ä¹.md","Ctrl+Cåçäºä»ä¹","/pages/0b3887/"],["03.åå­ç®¡ç.md","åå­ç®¡ç","/pages/ceeb3f/"]],"/06.æ°æ®ç»æåç®æ³/":[["01.æç´¢æçä¸ºlogçæ .md","æç´¢æçä¸ºlogçæ ","/pages/f45a99/"],["02.äºåæ¥æ¾.md","äºåæ¥æ¾","/pages/37ba80/"],["03.äºåæ .md","äºåæ ","/pages/d2945b/"]],"/07.åç«¯/":[["01.jså¼æ­¥ç¼ç¨.md","jså¼æ­¥ç¼ç¨","/pages/9ba4c3/"]],"/08.æ¹æ¡/":[["01.JWT.md","JWT","/pages/jwt/"],["02.OAuth2.md","OAuth2","/pages/8cac0f/"],["03.CORSçè§£å³æ¹æ¡.md","CORSçè§£å³æ¹æ¡","/pages/fcd0f1/"],["04.çæ§ç³»ç»éåè°ç .md","çæ§ç³»ç»éåè°ç ","/pages/95c00f/"],["05.redisåå¸å¼éå®ç°.md","Redisåå¸å¼éå®ç°","/pages/165ba8/"]],"/09.Javaæ¡æ¶/":[{title:"Spring",collapsable:!1,children:[["01.Spring/01.Spring.md","Spring","/pages/spring/"],["01.Spring/02.Spring boot èªå¨è£é.md","Spring boot èªå¨è£é","/pages/581456/"],["01.Spring/03.Spring IOC.md","Spring IOC","/pages/0bf668/"],["01.Spring/04. Spring AOP.md","Spring AOP","/pages/8c1a59/"],["01.Spring/05.Spring MVC.md","Spring MVC","/pages/c3ac4e/"],["01.Spring/06.Spring boot starter.md","Spring boot starter","/pages/e00296/"],["01.Spring/07.BeanFactoryåFactoryBean.md","BeanFactoryåFactoryBean","/pages/643d4f/"],["01.Spring/08.Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ.md","Springä¸çº§ç¼å­è§£å³å¾ªç¯ä¾èµ","/pages/329b73/"]]}],"/10.ä¸­é´ä»¶/":[["01.æ¶æ¯éåæ¦è¿°.md","æ¶æ¯éåæ¦è¿°","/pages/mq/"],["02.RocketMQ.md","RocketMQ","/pages/279572/"],["03.Flumeå¿«éä¸æ.md","Flumeå¿«éä¸æ","/pages/0cf9ab/"],["04. RocketMQ å Kafka å¯¹æ¯.md","RocketMQ å Kafka å¯¹æ¯","/pages/7c8ab7/"]],"/100.å·¥å·/":[{title:"Git",collapsable:!1,children:[["01.Git/01.Git commit message è§è.md","Git commit message è§è","/pages/git/"],["01.Git/02.åå¹¶æäº¤-rebase.md","åå¹¶æäº¤-rebase","/pages/6f9bb5/"],["01.Git/03.git pullågit fetch.md","git fetchä¸git pull","/pages/0974e8/"]]},{title:"Linux",collapsable:!1,children:[["02.Linux/01.Linuxå¸¸ç¨å½ä»¤.md","Linuxå¸¸ç¨å½ä»¤","/pages/linux/"],["02.Linux/02.Linuxå½ä»¤.md","Linuxå½ä»¤","/pages/d3d9ca/"]]},{title:"Docker",collapsable:!1,children:[["03.Docker/01.Dockerå½ä»¤.md","Dockerå½ä»¤","/pages/aa154b/"]]}],"/11. è®¾è®¡æ¨¡å¼/":[["01.åä¾æ¨¡å¼.md","åä¾æ¨¡å¼","/pages/c02964/"],["02.å·¥åæ¨¡å¼.md","å·¥åæ¨¡å¼","/pages/da6600/"]],"/12.AI/":[["01.AI  tools.md","AI tools","/pages/aitools/"]],"/13.ç³»ç»è®¾è®¡/":[["01.éç¾¤æ­å»ºæ»æè·¯.md","éç¾¤æ­å»ºæ»æè·¯","/pages/e945bb/"]],"/99.Code Snippet/":[["01.QuickSort.md","QuickSort","/pages/27d05d/"],["02.HeapSort.md","HeapSort","/pages/dfcd0a/"],["03.Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼.md","Javaå®ç°çäº§èæ¶è´¹èæ¨¡å¼","/pages/c708a0/"]]},updateBar:{showToArticle:!1},pageStyle:"line",category:!1,tag:!1,author:{name:"Kaze",href:"https://github.com/egoistsh"},social:{icons:[{iconClass:"icon-youjian",title:"åé®ä»¶"},{iconClass:"icon-github",title:"GitHub",link:"https://github.com/egoistsh"},{iconClass:"icon-erji",title:"å¬é³ä¹"}]},footer:{createYear:2023,copyrightInfo:"Kaze | MIT License"},htmlModules:{pageT:'\n    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>\n    <style>\n      .page-wwads{\n        width:100%!important;\n        min-height: 0;\n        margin: 0;\n      }\n      .page-wwads .wwads-img img{\n        width:80px!important;\n      }\n      .page-wwads .wwads-poweredby{\n        width: 40px;\n        position: absolute;\n        right: 25px;\n        bottom: 3px;\n      }\n      .wwads-content .wwads-text, .page-wwads .wwads-text{\n        height: 100%;\n        padding-top: 5px;\n        display: block;\n      }\n  </style>\n  '},mdEnhance:{tasklist:!0,sub:!0,sup:!0,flowchart:!0,mermaid:!0,tex:!0}}};var xl=t(94),wl=t(95),Sl=t(11);var Tl={computed:{$filterPosts(){return this.$site.pages.filter(n=>{const{frontmatter:{pageComponent:e,article:t,home:a}}=n;return!(e||!1===t||!0===a)})},$sortPosts(){return(n=this.$filterPosts).sort((n,e)=>{const t=n.frontmatter.sticky,a=e.frontmatter.sticky;return t&&a?t==a?Object(Sl.a)(n,e):t-a:t&&!a?-1:!t&&a?1:Object(Sl.a)(n,e)}),n;var n},$sortPostsByDate(){return(n=this.$filterPosts).sort((n,e)=>Object(Sl.a)(n,e)),n;var n},$groupPosts(){return function(n){const e={},t={};for(let a=0,r=n.length;a<r;a++){const{frontmatter:{categories:r,tags:o}}=n[a];"array"===Object(Sl.n)(r)&&r.forEach(t=>{t&&(e[t]||(e[t]=[]),e[t].push(n[a]))}),"array"===Object(Sl.n)(o)&&o.forEach(e=>{e&&(t[e]||(t[e]=[]),t[e].push(n[a]))})}return{categories:e,tags:t}}(this.$sortPosts)},$categoriesAndTags(){return function(n){const e=[],t=[];for(let t in n.categories)e.push({key:t,length:n.categories[t].length});for(let e in n.tags)t.push({key:e,length:n.tags[e].length});return{categories:e,tags:t}}(this.$groupPosts)}}};$t.component(xl.default),$t.component(wl.default);function Cl(n){return n.toString().padStart(2,"0")}t(243);$t.component("Badge",()=>Promise.all([t.e(0),t.e(3)]).then(t.bind(null,455))),$t.component("CodeBlock",()=>Promise.resolve().then(t.bind(null,94))),$t.component("CodeGroup",()=>Promise.resolve().then(t.bind(null,95)));t(244);var jl=[({Vue:n,options:e,router:t,siteData:a,isServer:r})=>{r||t.afterEach(()=>{var n;n=function(){setTimeout((function(){void 0===window._AdBlockInit&&function(){const n=document.getElementsByClassName("wwads-cn"),e=document.querySelector(".wwads-content");n[0]&&!e&&(n[0].innerHTML="<style>.wwads-horizontal,.wwads-vertical{background-color:#f4f8fa;padding:5px;min-height:120px;margin-top:20px;box-sizing:border-box;border-radius:3px;font-family:sans-serif;display:flex;min-width:150px;position:relative;overflow:hidden;}.wwads-horizontal{flex-wrap:wrap;justify-content:center}.wwads-vertical{flex-direction:column;align-items:center;padding-bottom:32px}.wwads-horizontal a,.wwads-vertical a{text-decoration:none}.wwads-horizontal .wwads-img,.wwads-vertical .wwads-img{margin:5px}.wwads-horizontal .wwads-content,.wwads-vertical .wwads-content{margin:5px}.wwads-horizontal .wwads-content{flex:130px}.wwads-vertical .wwads-content{margin-top:10px}.wwads-horizontal .wwads-text,.wwads-content .wwads-text{font-size:14px;line-height:1.4;color:#0e1011;-webkit-font-smoothing:antialiased}.wwads-horizontal .wwads-poweredby,.wwads-vertical .wwads-poweredby{display:block;font-size:11px;color:#a6b7bf;margin-top:1em}.wwads-vertical .wwads-poweredby{position:absolute;left:10px;bottom:10px}.wwads-horizontal .wwads-poweredby span,.wwads-vertical .wwads-poweredby span{transition:all 0.2s ease-in-out;margin-left:-1em}.wwads-horizontal .wwads-poweredby span:first-child,.wwads-vertical .wwads-poweredby span:first-child{opacity:0}.wwads-horizontal:hover .wwads-poweredby span,.wwads-vertical:hover .wwads-poweredby span{opacity:1;margin-left:0}.wwads-horizontal .wwads-hide,.wwads-vertical .wwads-hide{position:absolute;right:-23px;bottom:-23px;width:46px;height:46px;border-radius:23px;transition:all 0.3s ease-in-out;cursor:pointer;}.wwads-horizontal .wwads-hide:hover,.wwads-vertical .wwads-hide:hover{background:rgb(0 0 0 /0.05)}.wwads-horizontal .wwads-hide svg,.wwads-vertical .wwads-hide svg{position:absolute;left:10px;top:10px;fill:#a6b7bf}.wwads-horizontal .wwads-hide:hover svg,.wwads-vertical .wwads-hide:hover svg{fill:#3E4546}</style><a href='https://wwads.cn/page/whitelist-wwads' class='wwads-img' target='_blank' rel='nofollow'><img src='https://fastly.jsdelivr.net/gh/xugaoyi/image_store@master/blog/wwads.2a3pidhlh4ys.webp' width='130'></a><div class='wwads-content'><a href='https://wwads.cn/page/whitelist-wwads' class='wwads-text' target='_blank' rel='nofollow'>ä¸ºäºæ¬ç«çé¿æè¿è¥ï¼è¯·å°æä»¬çç½ç«å å¥å¹¿åæ¦æªå¨çç½ååï¼æè°¢æ¨çæ¯æï¼<span style='color: #11a8cd'>å¦ä½æ·»å ç½åå?</span></a><a href='https://wwads.cn/page/end-user-privacy' class='wwads-poweredby' title='ä¸ç»´å¹¿å ï½ è®©å¹¿åæ´ä¼éï¼ä¸æç¨' target='_blank'><span>å¹¿å</span></a></div><a class='wwads-hide' onclick='parentNode.remove()' title='éèå¹¿å'><svg xmlns='http://www.w3.org/2000/svg' width='6' height='7'><path d='M.879.672L3 2.793 5.121.672a.5.5 0 11.707.707L3.708 3.5l2.12 2.121a.5.5 0 11-.707.707l-2.12-2.12-2.122 2.12a.5.5 0 11-.707-.707l2.121-2.12L.172 1.378A.5.5 0 01.879.672z'></path></svg></a>")}()}),3e3)},"complete"===document.readyState||"interactive"===document.readyState?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n),setTimeout(()=>{const n=document.querySelector(".page-wwads");if(!n)return;const e=n.querySelector(".wwads-hide");e&&(e.onclick=()=>{n.style.display="none"}),"none"===n.style.display&&(n.style.display="flex")},900)})},({Vue:n,options:e,router:t,siteData:a})=>{a.pages.map(n=>{const{frontmatter:{date:e,author:t}}=n;"string"==typeof e&&"Z"===e.charAt(e.length-1)&&(n.frontmatter.date=function(n){n instanceof Date||(n=new Date(n));return`${n.getUTCFullYear()}-${Cl(n.getUTCMonth()+1)}-${Cl(n.getUTCDate())} ${Cl(n.getUTCHours())}:${Cl(n.getUTCMinutes())}:${Cl(n.getUTCSeconds())}`}(e)),t?n.author=t:a.themeConfig.author&&(n.author=a.themeConfig.author)}),n.mixin(Tl)},{},({Vue:n})=>{n.mixin({computed:{$dataBlock(){return this.$options.__data__block__}}})},{},{},({router:n})=>{"undefined"!=typeof window&&(window._hmt=window._hmt||[],function(){var n=document.createElement("script");n.src="https://hm.baidu.com/hm.js?01293bffa6c3962016c08ba685c79d78";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)}(),n.afterEach((function(n){_hmt.push(["_trackPageview",n.fullPath])})))}],El=[];class Al extends class{constructor(){this.store=new $t({data:{state:{}}})}$get(n){return this.store.state[n]}$set(n,e){$t.set(this.store.state,n,e)}$emit(...n){this.store.$emit(...n)}$on(...n){this.store.$on(...n)}}{}Object.assign(Al.prototype,{getPageAsyncComponent:is,getLayoutAsyncComponent:ss,getAsyncComponent:ls,getVueComponent:cs});var Il={install(n){const e=new Al;n.$vuepress=e,n.prototype.$vuepress=e}};function _l(n,e){const t=e.toLowerCase();return n.options.routes.some(n=>n.path.toLowerCase()===t)}var Ll={props:{pageKey:String,slotKey:{type:String,default:"default"}},render(n){const e=this.pageKey||this.$parent.$page.key;return ps("pageKey",e),$t.component(e)||$t.component(e,is(e)),$t.component(e)?n(e):n("")}},zl={functional:!0,props:{slotKey:String,required:!0},render:(n,{props:e,slots:t})=>n("div",{class:["content__"+e.slotKey]},t()[e.slotKey])},Pl={computed:{openInNewWindowTitle(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Bl=(t(245),t(246),Object(vl.a)(Pl,(function(){var n=this._self._c;return n("span",[n("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[n("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),n("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),n("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports),Ml={functional:!0,render(n,{parent:e,children:t}){if(e._isMounted)return t;e.$once("hook:mounted",()=>{e.$forceUpdate()})}};$t.config.productionTip=!1,$t.use(Ui),$t.use(Il),$t.mixin(function(n,e,t=$t){!function(n){n.locales&&Object.keys(n.locales).forEach(e=>{n.locales[e].path=e});Object.freeze(n)}(e),t.$vuepress.$set("siteData",e);const a=new(n(t.$vuepress.$get("siteData"))),r=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(a)),o={};return Object.keys(r).reduce((n,e)=>(e.startsWith("$")&&(n[e]=r[e].get),n),o),{computed:o}}(n=>class{setPage(n){this.__page=n}get $site(){return n}get $themeConfig(){return this.$site.themeConfig}get $frontmatter(){return this.$page.frontmatter}get $localeConfig(){const{locales:n={}}=this.$site;let e,t;for(const a in n)"/"===a?t=n[a]:0===this.$page.path.indexOf(a)&&(e=n[a]);return e||t||{}}get $siteTitle(){return this.$localeConfig.title||this.$site.title||""}get $canonicalUrl(){const{canonicalUrl:n}=this.$page.frontmatter;return"string"==typeof n&&n}get $title(){const n=this.$page,{metaTitle:e}=this.$page.frontmatter;if("string"==typeof e)return e;const t=this.$siteTitle,a=n.frontmatter.home?null:n.frontmatter.title||n.title;return t?a?a+" | "+t:t:a||"VuePress"}get $description(){const n=function(n){if(n){const e=n.filter(n=>"description"===n.name)[0];if(e)return e.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}get $lang(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}get $localePath(){return this.$localeConfig.path||"/"}get $themeLocaleConfig(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}get $page(){return this.__page?this.__page:function(n,e){for(let t=0;t<n.length;t++){const a=n[t];if(a.path.toLowerCase()===e.toLowerCase())return a}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}},kl)),$t.component("Content",Ll),$t.component("ContentSlotsDistributor",zl),$t.component("OutboundLink",Bl),$t.component("ClientOnly",Ml),$t.component("Layout",ss("Layout")),$t.component("NotFound",ss("NotFound")),$t.prototype.$withBase=function(n){const e=this.$site.base;return"/"===n.charAt(0)?e+n.slice(1):n},window.__VUEPRESS__={version:"1.9.2",hash:"85cdad2"},async function(n){const e="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:kl.routerBase||kl.base,t=new Ui({base:e,mode:"history",fallback:!1,routes:yl,scrollBehavior:(n,e,t)=>t||(n.hash?!$t.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})});!function(n){n.beforeEach((e,t,a)=>{if(_l(n,e.path))a();else if(/(\/|\.html)$/.test(e.path))if(/\/$/.test(e.path)){const t=e.path.replace(/\/$/,"")+".html";_l(n,t)?a(t):a()}else a();else{const t=e.path+"/",r=e.path+".html";_l(n,r)?a(r):_l(n,t)?a(t):a()}})}(t);const a={};try{await Promise.all(jl.filter(n=>"function"==typeof n).map(e=>e({Vue:$t,options:a,router:t,siteData:kl,isServer:n})))}catch(n){console.error(n)}return{app:new $t(Object.assign(a,{router:t,render:n=>n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},El.map(e=>n(e)))])})),router:t}}(!1).then(({app:n,router:e})=>{e.onReady(()=>{n.$mount("#app")})})}]);