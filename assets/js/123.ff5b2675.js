(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{445:function(a,t,r){"use strict";r.r(t);var s=r(7),e=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"springboot3新特性-支持aot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springboot3新特性-支持aot"}},[a._v("#")]),a._v(" Springboot3新特性：支持AOT")]),a._v(" "),t("h2",{attrs:{id:"aot与jit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aot与jit"}},[a._v("#")]),a._v(" AOT与JIT")]),a._v(" "),t("p",[a._v("JIT（Just-in-Time，即时编译），Java 跨平台的基础")]),a._v(" "),t("p",[a._v("AOT（Ahead-of-Time，预编译或提前编译），无法跨平台")]),a._v(" "),t("p",[a._v("AOT 的优点")]),a._v(" "),t("ul",[t("li",[a._v("启动和运行速度快。传统springboot空项目启动时间大概是2秒，AOT 的启动时间大概是100毫秒。")]),a._v(" "),t("li",[a._v("打包体积小。 （不用安装 jdk，在 Windows 直接生成 exe 文件）。为云原生。")])]),a._v(" "),t("p",[a._v("AOT 的缺点")]),a._v(" "),t("ul",[t("li",[a._v("编译后的程序不支持跨平台")]),a._v(" "),t("li",[a._v("不支持动态功能，如AOP。因为不会生成字节码了。")])]),a._v(" "),t("h2",{attrs:{id:"jit在高并发场景中的生产问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jit在高并发场景中的生产问题"}},[a._v("#")]),a._v(" JIT在高并发场景中的生产问题")]),a._v(" "),t("p",[a._v("现象：热点应用重启后，出现业务超时，几分钟后恢复正常。")]),a._v(" "),t("div",{staticClass:"language-mermaid extra-class"},[t("pre",{pre:!0,attrs:{class:"language-mermaid"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("graph")]),a._v(" TD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\t开始"),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v("java文件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\tjava文件"),t("span",{pre:!0,attrs:{class:"token inter-arrow-label"}},[t("span",{pre:!0,attrs:{class:"token arrow-head arrow operator"}},[a._v("--")]),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v("编译")]),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")])]),a._v("clazz文件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\tclazz文件"),t("span",{pre:!0,attrs:{class:"token inter-arrow-label"}},[t("span",{pre:!0,attrs:{class:"token arrow-head arrow operator"}},[a._v("--")]),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v("正常")]),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")])]),a._v("解释器"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\tclazz文件"),t("span",{pre:!0,attrs:{class:"token inter-arrow-label"}},[t("span",{pre:!0,attrs:{class:"token arrow-head arrow operator"}},[a._v("--")]),t("span",{pre:!0,attrs:{class:"token label property"}},[a._v("热点")]),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")])]),a._v("JIT编译"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\t解释器"),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v("系统/硬件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\tJIT编译"),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[a._v("--\x3e")]),a._v("系统/硬件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\t\n")])])]),t("p",[a._v("原因：")]),a._v(" "),t("p",[a._v("JVM混合执行模式，初期以解释方式执行，执行效率慢。当执行次数/频次叨叨制定阈值后，触发JIT编译，编译后，以机器指令码方式执行，执行效率提高。")]),a._v(" "),t("p",[a._v("细节：")]),a._v(" "),t("p",[a._v("启动初期：应用以解释执行，执行效率低，CPU有所上升。")]),a._v(" "),t("p",[a._v("触发JIT编译：CPU&load飙高，请求堆积线程池满，出现请求超时情况。")]),a._v(" "),t("p",[a._v("JIT编译后：CPU降低，请求处理快，服务逐渐恢复。")]),a._v(" "),t("p",[a._v("解决方法：")]),a._v(" "),t("p",[a._v("预热：初试让程序自动执行热点代码几百次。")]),a._v(" "),t("p",[a._v("流量控制：启动时小流量，运行几分钟后再放到正常流量。")]),a._v(" "),t("h2",{attrs:{id:"springboot3下使用graalvm代替jdk实现aot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#springboot3下使用graalvm代替jdk实现aot"}},[a._v("#")]),a._v(" Springboot3下使用GraalVM代替JDK实现AOT")]),a._v(" "),t("p",[a._v("GraalVM 也是 oracle 的。")]),a._v(" "),t("p",[a._v("步骤：")]),a._v(" "),t("ol",[t("li",[a._v("GrallVM 安装")]),a._v(" "),t("li",[a._v("GrallVM 环境变量配置，代替jdk")]),a._v(" "),t("li",[a._v("安装 native-image："),t("code",[a._v("gu install native-image")])]),a._v(" "),t("li",[a._v("查看安装结果 "),t("code",[a._v("gu list")])]),a._v(" "),t("li",[a._v("GrallVM AOT打包：执行 "),t("code",[a._v("mvn -Pnative native:compile")])]),a._v(" "),t("li",[a._v("在 target 下会有执行文件")])])])}),[],!1,null,null,null);t.default=e.exports}}]);