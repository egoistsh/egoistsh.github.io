(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{368:function(t,a,v){"use strict";v.r(a);var _=v(7),e=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"范围查询导致联合索引停止匹配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#范围查询导致联合索引停止匹配"}},[t._v("#")]),t._v(" 范围查询导致联合索引停止匹配")]),t._v(" "),a("p",[t._v("为什么范围查询会使联合索引停止匹配？")]),t._v(" "),a("p",[t._v("涉及到最左前缀匹配原理。假设建立一个联合索引 index(a, b)，会先对a进行排序，在a相等的情况下对b进行排序，如下图所示。在该索引树上，a是全局有序的，而b则处于全局无序、局部有序状态。从全局来看，b的值为1、2、1、4、1、2，只有 "),a("code",[t._v("b=2")]),t._v(" 查询条件无法直接使用该索引；从局部来看，当a的值确定时，b则是有序状态，"),a("code",[t._v("a=2 && b=4")]),t._v("可以使用该索引。所以范围查询使联合索引停止匹配的根本原因是，索引树上非首字段的有序状态依赖前一个字段相等情况，而"),a("strong",[t._v("范围查询破坏了下一个索引字段局部有序状态")]),t._v("，导致索引停止匹配。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p.ipic.vip/bwm0e3.jpg",alt:"image-20211018023009060.png"}})]),t._v(" "),a("p",[t._v("联合索引的最左匹配原则，在遇到范围查询（如 >、<）的时候，就会停止匹配，也就是范围查询的字段可以用到联合索引，但是在范围查询字段后面的字段无法用到联合索引。")]),t._v(" "),a("p",[t._v("注意，对于 >=、<=、BETWEEN、like 前缀匹配的范围查询，并不会停止匹配（是因为对于部分a等于的数据，b可以走索引去过滤）。")]),t._v(" "),a("p",[t._v("eg：select * from t_table where a >= 1 and b = 2")]),t._v(" "),a("p",[t._v("虽然在符合 a>= 1 条件的二级索引记录的范围里，b 字段的值是「无序」的，但是对于符合 a = 1 的二级索引记录的范围里，b 字段的值是「有序」的。")]),t._v(" "),a("p",[t._v("于是，在确定需要扫描的二级索引的范围时，当二级索引记录的 a 字段值为 1 时，可以通过 b = 2 条件减少需要扫描的二级索引记录范围（b 字段可以利用联合索引进行索引查询的意思）。")]),t._v(" "),a("p",[t._v("所以，这条查询语句 a 和 b 字段都用到了联合索引进行索引查询。")]),t._v(" "),a("p",[t._v("https://www.51cto.com/article/720535.html")])])}),[],!1,null,null,null);a.default=e.exports}}]);