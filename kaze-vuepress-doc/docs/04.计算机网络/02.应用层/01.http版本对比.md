---
title: HTTP版本对比
date: 2023-03-21 17:35:01
permalink: /pages/e1cd04/
---

- http/1.1
- https
- http/2
- http/3



![img](https://p.ipic.vip/yx6n9f.png)



## http1.1

优点：

- 默认使用长连接。（HTTP/1.0协议支持，但是是默认关闭的，从HTTP/1.1以后，连接默认都是长连接。）
- 支持管道（pipeline）传输，即允许浏览器同时发送多个请求，但响应还是要按序。

缺点：

- 响应要按需，可能造成队头阻塞
- 头部未经压缩。
- 没有请求优先级
- 请求只能从客户端开始，服务端只能被动响应
- 明文传输，不安全



## https

在http和tcp之间，通过增加SSL/TLS协议实现。

优点：

- 采用信息加密（混合加密），解决明文传输会被窃听的问题。
- 采用验证机制，通过摘要算法保证信息的完整性，解决了报文可能被篡改的问题。
- 采用身份证书（数字证书），将公钥放到证书中。解决可能被冒充的问题。



## http2

优点：

- 基于https的，安全有保障。
- 使用HPACK算法进行头部压缩。如果同时发送过个请求，头部是相同的，会消除重复的部分。
- 二进制格式的报文。由头信息帧+数据帧组成
- 采用数据流，每个请求或响应的所有包，称为一个数据流，用来标识同一请求。每个数据流有唯一的编号。还可以指定数据流的优先级，优先级高的服务端优先响应。
- 多路复用解决队头阻塞问题。
- 支持服务端推送。

缺点：

- 多个http请求复用一个tcp连接，如果丢包，会触发tcp重传，同一tcp下的http请求都必须等这个包。

## http3

优点：

- 把tcp协议改成udp。基于udp提出了QUIC协议。

- - udp不管顺序，不管丢包，因此不会有队头阻塞和丢包重传问题。
  - 可靠性由QUIC保证。

- TLS升级成了TLS1.3，一个RTT就可以完成握手。
- 头部压缩算法升级成了QPack

## Q & A

Q：TLS的握手阶段是再什么时候，是在TCP连接后吗？流程又是怎样的。

A：先TCP三次握手，再TLS三次握手。
